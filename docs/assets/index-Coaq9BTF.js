const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/romeinseFortenOL-CF-qWWk4.js","assets/iconStyles-CPRpmspf.js","assets/amkOL-B1n8wqc_.js","assets/layerLoaderOL-DZk8276T.js","assets/romeinsOL-zKWsd6db.js","assets/kastelenOL-DEyc6wRS.js","assets/ruinesOL-zOOrtQlp.js","assets/hunebeddenOL-BN3LmK1V.js","assets/uikavArcheoPuntenOL-6Pz4uX8W.js","assets/uikavVlakkenOL-BDHywSQu.js","assets/uikavBufferlaagOL-B465RmDL.js","assets/uikavExpertOL-Blf5fGu5.js","assets/uikavUiterwaardenOL-B9D-asx_.js","assets/speeltuinenOL-ByA0IiCq.js","assets/museaOL-CAGibvGg.js","assets/strandjesOL-BU4e0iEN.js","assets/parkenOL-BQlcE7Kw.js","assets/kringloopwinkelsOL-BvSHJk2d.js","assets/fossielenOL-2hcc6-OU.js","assets/fossielUtils-_ihEh2UN.js","assets/fossielenBelgieOL-B3z7O0-W.js","assets/fossielenDuitslandOL-Og28vJU_.js","assets/fossielenFrankrijkOL-CGEXLzfi.js","assets/bunkersOL-D_Lp2rfo.js","assets/grafheuvelsOL-DSZPSXOv.js","assets/slagveldenOL-DLJ9v0zp.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function nA(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var yS={exports:{}},lm={},_S={exports:{}},fn={};var X4;function kU(){if(X4)return fn;X4=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function m(Z){return Z===null||typeof Z!="object"?null:(Z=g&&Z[g]||Z["@@iterator"],typeof Z=="function"?Z:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,_={};function w(Z,V,Q){this.props=Z,this.context=V,this.refs=_,this.updater=Q||x}w.prototype.isReactComponent={},w.prototype.setState=function(Z,V){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,V,"setState")},w.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function T(){}T.prototype=w.prototype;function b(Z,V,Q){this.props=Z,this.context=V,this.refs=_,this.updater=Q||x}var R=b.prototype=new T;R.constructor=b,y(R,w.prototype),R.isPureReactComponent=!0;var M=Array.isArray,D=Object.prototype.hasOwnProperty,B={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function A(Z,V,Q){var ee,re={},he=null,Ve=null;if(V!=null)for(ee in V.ref!==void 0&&(Ve=V.ref),V.key!==void 0&&(he=""+V.key),V)D.call(V,ee)&&!k.hasOwnProperty(ee)&&(re[ee]=V[ee]);var Be=arguments.length-2;if(Be===1)re.children=Q;else if(1<Be){for(var ye=Array(Be),pe=0;pe<Be;pe++)ye[pe]=arguments[pe+2];re.children=ye}if(Z&&Z.defaultProps)for(ee in Be=Z.defaultProps,Be)re[ee]===void 0&&(re[ee]=Be[ee]);return{$$typeof:n,type:Z,key:he,ref:Ve,props:re,_owner:B.current}}function C(Z,V){return{$$typeof:n,type:Z.type,key:V,ref:Z.ref,props:Z.props,_owner:Z._owner}}function O(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===n}function P(Z){var V={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(Q){return V[Q]})}var z=/\/+/g;function F(Z,V){return typeof Z=="object"&&Z!==null&&Z.key!=null?P(""+Z.key):V.toString(36)}function xe(Z,V,Q,ee,re){var he=typeof Z;(he==="undefined"||he==="boolean")&&(Z=null);var Ve=!1;if(Z===null)Ve=!0;else switch(he){case"string":case"number":Ve=!0;break;case"object":switch(Z.$$typeof){case n:case e:Ve=!0}}if(Ve)return Ve=Z,re=re(Ve),Z=ee===""?"."+F(Ve,0):ee,M(re)?(Q="",Z!=null&&(Q=Z.replace(z,"$&/")+"/"),xe(re,V,Q,"",function(pe){return pe})):re!=null&&(O(re)&&(re=C(re,Q+(!re.key||Ve&&Ve.key===re.key?"":(""+re.key).replace(z,"$&/")+"/")+Z)),V.push(re)),1;if(Ve=0,ee=ee===""?".":ee+":",M(Z))for(var Be=0;Be<Z.length;Be++){he=Z[Be];var ye=ee+F(he,Be);Ve+=xe(he,V,Q,ye,re)}else if(ye=m(Z),typeof ye=="function")for(Z=ye.call(Z),Be=0;!(he=Z.next()).done;)he=he.value,ye=ee+F(he,Be++),Ve+=xe(he,V,Q,ye,re);else if(he==="object")throw V=String(Z),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return Ve}function Ce(Z,V,Q){if(Z==null)return Z;var ee=[],re=0;return xe(Z,ee,"","",function(he){return V.call(Q,he,re++)}),ee}function Ge(Z){if(Z._status===-1){var V=Z._result;V=V(),V.then(function(Q){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=Q)},function(Q){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=Q)}),Z._status===-1&&(Z._status=0,Z._result=V)}if(Z._status===1)return Z._result.default;throw Z._result}var Ne={current:null},ue={transition:null},ke={ReactCurrentDispatcher:Ne,ReactCurrentBatchConfig:ue,ReactCurrentOwner:B};function ae(){throw Error("act(...) is not supported in production builds of React.")}return fn.Children={map:Ce,forEach:function(Z,V,Q){Ce(Z,function(){V.apply(this,arguments)},Q)},count:function(Z){var V=0;return Ce(Z,function(){V++}),V},toArray:function(Z){return Ce(Z,function(V){return V})||[]},only:function(Z){if(!O(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}},fn.Component=w,fn.Fragment=t,fn.Profiler=i,fn.PureComponent=b,fn.StrictMode=r,fn.Suspense=l,fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ke,fn.act=ae,fn.cloneElement=function(Z,V,Q){if(Z==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Z+".");var ee=y({},Z.props),re=Z.key,he=Z.ref,Ve=Z._owner;if(V!=null){if(V.ref!==void 0&&(he=V.ref,Ve=B.current),V.key!==void 0&&(re=""+V.key),Z.type&&Z.type.defaultProps)var Be=Z.type.defaultProps;for(ye in V)D.call(V,ye)&&!k.hasOwnProperty(ye)&&(ee[ye]=V[ye]===void 0&&Be!==void 0?Be[ye]:V[ye])}var ye=arguments.length-2;if(ye===1)ee.children=Q;else if(1<ye){Be=Array(ye);for(var pe=0;pe<ye;pe++)Be[pe]=arguments[pe+2];ee.children=Be}return{$$typeof:n,type:Z.type,key:re,ref:he,props:ee,_owner:Ve}},fn.createContext=function(Z){return Z={$$typeof:a,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Z.Provider={$$typeof:s,_context:Z},Z.Consumer=Z},fn.createElement=A,fn.createFactory=function(Z){var V=A.bind(null,Z);return V.type=Z,V},fn.createRef=function(){return{current:null}},fn.forwardRef=function(Z){return{$$typeof:o,render:Z}},fn.isValidElement=O,fn.lazy=function(Z){return{$$typeof:h,_payload:{_status:-1,_result:Z},_init:Ge}},fn.memo=function(Z,V){return{$$typeof:c,type:Z,compare:V===void 0?null:V}},fn.startTransition=function(Z){var V=ue.transition;ue.transition={};try{Z()}finally{ue.transition=V}},fn.unstable_act=ae,fn.useCallback=function(Z,V){return Ne.current.useCallback(Z,V)},fn.useContext=function(Z){return Ne.current.useContext(Z)},fn.useDebugValue=function(){},fn.useDeferredValue=function(Z){return Ne.current.useDeferredValue(Z)},fn.useEffect=function(Z,V){return Ne.current.useEffect(Z,V)},fn.useId=function(){return Ne.current.useId()},fn.useImperativeHandle=function(Z,V,Q){return Ne.current.useImperativeHandle(Z,V,Q)},fn.useInsertionEffect=function(Z,V){return Ne.current.useInsertionEffect(Z,V)},fn.useLayoutEffect=function(Z,V){return Ne.current.useLayoutEffect(Z,V)},fn.useMemo=function(Z,V){return Ne.current.useMemo(Z,V)},fn.useReducer=function(Z,V,Q){return Ne.current.useReducer(Z,V,Q)},fn.useRef=function(Z){return Ne.current.useRef(Z)},fn.useState=function(Z){return Ne.current.useState(Z)},fn.useSyncExternalStore=function(Z,V,Q){return Ne.current.useSyncExternalStore(Z,V,Q)},fn.useTransition=function(){return Ne.current.useTransition()},fn.version="18.3.1",fn}var q4;function _1(){return q4||(q4=1,_S.exports=kU()),_S.exports}var Y4;function IU(){if(Y4)return lm;Y4=1;var n=_1(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,c){var h,g={},m=null,x=null;c!==void 0&&(m=""+c),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(x=l.ref);for(h in l)r.call(l,h)&&!s.hasOwnProperty(h)&&(g[h]=l[h]);if(o&&o.defaultProps)for(h in l=o.defaultProps,l)g[h]===void 0&&(g[h]=l[h]);return{$$typeof:e,type:o,key:m,ref:x,props:g,_owner:i.current}}return lm.Fragment=t,lm.jsx=a,lm.jsxs=a,lm}var Z4;function CU(){return Z4||(Z4=1,yS.exports=IU()),yS.exports}var f=CU(),yy={},vS={exports:{}},Ms={},wS={exports:{}},ES={};var J4;function PU(){return J4||(J4=1,(function(n){function e(ue,ke){var ae=ue.length;ue.push(ke);e:for(;0<ae;){var Z=ae-1>>>1,V=ue[Z];if(0<i(V,ke))ue[Z]=ke,ue[ae]=V,ae=Z;else break e}}function t(ue){return ue.length===0?null:ue[0]}function r(ue){if(ue.length===0)return null;var ke=ue[0],ae=ue.pop();if(ae!==ke){ue[0]=ae;e:for(var Z=0,V=ue.length,Q=V>>>1;Z<Q;){var ee=2*(Z+1)-1,re=ue[ee],he=ee+1,Ve=ue[he];if(0>i(re,ae))he<V&&0>i(Ve,re)?(ue[Z]=Ve,ue[he]=ae,Z=he):(ue[Z]=re,ue[ee]=ae,Z=ee);else if(he<V&&0>i(Ve,ae))ue[Z]=Ve,ue[he]=ae,Z=he;else break e}}return ke}function i(ue,ke){var ae=ue.sortIndex-ke.sortIndex;return ae!==0?ae:ue.id-ke.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],h=1,g=null,m=3,x=!1,y=!1,_=!1,w=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(ue){for(var ke=t(c);ke!==null;){if(ke.callback===null)r(c);else if(ke.startTime<=ue)r(c),ke.sortIndex=ke.expirationTime,e(l,ke);else break;ke=t(c)}}function M(ue){if(_=!1,R(ue),!y)if(t(l)!==null)y=!0,Ge(D);else{var ke=t(c);ke!==null&&Ne(M,ke.startTime-ue)}}function D(ue,ke){y=!1,_&&(_=!1,T(A),A=-1),x=!0;var ae=m;try{for(R(ke),g=t(l);g!==null&&(!(g.expirationTime>ke)||ue&&!P());){var Z=g.callback;if(typeof Z=="function"){g.callback=null,m=g.priorityLevel;var V=Z(g.expirationTime<=ke);ke=n.unstable_now(),typeof V=="function"?g.callback=V:g===t(l)&&r(l),R(ke)}else r(l);g=t(l)}if(g!==null)var Q=!0;else{var ee=t(c);ee!==null&&Ne(M,ee.startTime-ke),Q=!1}return Q}finally{g=null,m=ae,x=!1}}var B=!1,k=null,A=-1,C=5,O=-1;function P(){return!(n.unstable_now()-O<C)}function z(){if(k!==null){var ue=n.unstable_now();O=ue;var ke=!0;try{ke=k(!0,ue)}finally{ke?F():(B=!1,k=null)}}else B=!1}var F;if(typeof b=="function")F=function(){b(z)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,Ce=xe.port2;xe.port1.onmessage=z,F=function(){Ce.postMessage(null)}}else F=function(){w(z,0)};function Ge(ue){k=ue,B||(B=!0,F())}function Ne(ue,ke){A=w(function(){ue(n.unstable_now())},ke)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ue){ue.callback=null},n.unstable_continueExecution=function(){y||x||(y=!0,Ge(D))},n.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<ue?Math.floor(1e3/ue):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(ue){switch(m){case 1:case 2:case 3:var ke=3;break;default:ke=m}var ae=m;m=ke;try{return ue()}finally{m=ae}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ue,ke){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var ae=m;m=ue;try{return ke()}finally{m=ae}},n.unstable_scheduleCallback=function(ue,ke,ae){var Z=n.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?Z+ae:Z):ae=Z,ue){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=ae+V,ue={id:h++,callback:ke,priorityLevel:ue,startTime:ae,expirationTime:V,sortIndex:-1},ae>Z?(ue.sortIndex=ae,e(c,ue),t(l)===null&&ue===t(c)&&(_?(T(A),A=-1):_=!0,Ne(M,ae-Z))):(ue.sortIndex=V,e(l,ue),y||x||(y=!0,Ge(D))),ue},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(ue){var ke=m;return function(){var ae=m;m=ke;try{return ue.apply(this,arguments)}finally{m=ae}}}})(ES)),ES}var Q4;function NU(){return Q4||(Q4=1,wS.exports=PU()),wS.exports}var eN;function MU(){if(eN)return Ms;eN=1;var n=_1(),e=NU();function t(u){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+u,p=1;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(u,d){a(u,d),a(u+"Capture",d)}function a(u,d){for(i[u]=d,u=0;u<d.length;u++)r.add(d[u])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},g={};function m(u){return l.call(g,u)?!0:l.call(h,u)?!1:c.test(u)?g[u]=!0:(h[u]=!0,!1)}function x(u,d,p,E){if(p!==null&&p.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return E?!1:p!==null?!p.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function y(u,d,p,E){if(d===null||typeof d>"u"||x(u,d,p,E))return!0;if(E)return!1;if(p!==null)switch(p.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function _(u,d,p,E,S,I,U){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=E,this.attributeNamespace=S,this.mustUseProperty=p,this.propertyName=u,this.type=d,this.sanitizeURL=I,this.removeEmptyString=U}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){w[u]=new _(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var d=u[0];w[d]=new _(d,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){w[u]=new _(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){w[u]=new _(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){w[u]=new _(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){w[u]=new _(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){w[u]=new _(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){w[u]=new _(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){w[u]=new _(u,5,!1,u.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function b(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var d=u.replace(T,b);w[d]=new _(d,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var d=u.replace(T,b);w[d]=new _(d,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var d=u.replace(T,b);w[d]=new _(d,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){w[u]=new _(u,1,!1,u.toLowerCase(),null,!1,!1)}),w.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){w[u]=new _(u,1,!1,u.toLowerCase(),null,!0,!0)});function R(u,d,p,E){var S=w.hasOwnProperty(d)?w[d]:null;(S!==null?S.type!==0:E||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(y(d,p,S,E)&&(p=null),E||S===null?m(d)&&(p===null?u.removeAttribute(d):u.setAttribute(d,""+p)):S.mustUseProperty?u[S.propertyName]=p===null?S.type===3?!1:"":p:(d=S.attributeName,E=S.attributeNamespace,p===null?u.removeAttribute(d):(S=S.type,p=S===3||S===4&&p===!0?"":""+p,E?u.setAttributeNS(E,d,p):u.setAttribute(d,p))))}var M=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),B=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),P=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),xe=Symbol.for("react.suspense_list"),Ce=Symbol.for("react.memo"),Ge=Symbol.for("react.lazy"),Ne=Symbol.for("react.offscreen"),ue=Symbol.iterator;function ke(u){return u===null||typeof u!="object"?null:(u=ue&&u[ue]||u["@@iterator"],typeof u=="function"?u:null)}var ae=Object.assign,Z;function V(u){if(Z===void 0)try{throw Error()}catch(p){var d=p.stack.trim().match(/\n( *(at )?)/);Z=d&&d[1]||""}return`
`+Z+u}var Q=!1;function ee(u,d){if(!u||Q)return"";Q=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(Ae){var E=Ae}Reflect.construct(u,[],d)}else{try{d.call()}catch(Ae){E=Ae}u.call(d.prototype)}else{try{throw Error()}catch(Ae){E=Ae}u()}}catch(Ae){if(Ae&&E&&typeof Ae.stack=="string"){for(var S=Ae.stack.split(`
`),I=E.stack.split(`
`),U=S.length-1,se=I.length-1;1<=U&&0<=se&&S[U]!==I[se];)se--;for(;1<=U&&0<=se;U--,se--)if(S[U]!==I[se]){if(U!==1||se!==1)do if(U--,se--,0>se||S[U]!==I[se]){var oe=`
`+S[U].replace(" at new "," at ");return u.displayName&&oe.includes("<anonymous>")&&(oe=oe.replace("<anonymous>",u.displayName)),oe}while(1<=U&&0<=se);break}}}finally{Q=!1,Error.prepareStackTrace=p}return(u=u?u.displayName||u.name:"")?V(u):""}function re(u){switch(u.tag){case 5:return V(u.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return u=ee(u.type,!1),u;case 11:return u=ee(u.type.render,!1),u;case 1:return u=ee(u.type,!0),u;default:return""}}function he(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case k:return"Fragment";case B:return"Portal";case C:return"Profiler";case A:return"StrictMode";case F:return"Suspense";case xe:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case P:return(u.displayName||"Context")+".Consumer";case O:return(u._context.displayName||"Context")+".Provider";case z:var d=u.render;return u=u.displayName,u||(u=d.displayName||d.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case Ce:return d=u.displayName||null,d!==null?d:he(u.type)||"Memo";case Ge:d=u._payload,u=u._init;try{return he(u(d))}catch{}}return null}function Ve(u){var d=u.type;switch(u.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=d.render,u=u.displayName||u.name||"",d.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return he(d);case 8:return d===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function Be(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function ye(u){var d=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function pe(u){var d=ye(u)?"checked":"value",p=Object.getOwnPropertyDescriptor(u.constructor.prototype,d),E=""+u[d];if(!u.hasOwnProperty(d)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,I=p.set;return Object.defineProperty(u,d,{configurable:!0,get:function(){return S.call(this)},set:function(U){E=""+U,I.call(this,U)}}),Object.defineProperty(u,d,{enumerable:p.enumerable}),{getValue:function(){return E},setValue:function(U){E=""+U},stopTracking:function(){u._valueTracker=null,delete u[d]}}}}function Fe(u){u._valueTracker||(u._valueTracker=pe(u))}function Et(u){if(!u)return!1;var d=u._valueTracker;if(!d)return!0;var p=d.getValue(),E="";return u&&(E=ye(u)?u.checked?"true":"false":u.value),u=E,u!==p?(d.setValue(u),!0):!1}function Ft(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function Dt(u,d){var p=d.checked;return ae({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??u._wrapperState.initialChecked})}function Xt(u,d){var p=d.defaultValue==null?"":d.defaultValue,E=d.checked!=null?d.checked:d.defaultChecked;p=Be(d.value!=null?d.value:p),u._wrapperState={initialChecked:E,initialValue:p,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function en(u,d){d=d.checked,d!=null&&R(u,"checked",d,!1)}function ot(u,d){en(u,d);var p=Be(d.value),E=d.type;if(p!=null)E==="number"?(p===0&&u.value===""||u.value!=p)&&(u.value=""+p):u.value!==""+p&&(u.value=""+p);else if(E==="submit"||E==="reset"){u.removeAttribute("value");return}d.hasOwnProperty("value")?dn(u,d.type,p):d.hasOwnProperty("defaultValue")&&dn(u,d.type,Be(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(u.defaultChecked=!!d.defaultChecked)}function tr(u,d,p){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var E=d.type;if(!(E!=="submit"&&E!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+u._wrapperState.initialValue,p||d===u.value||(u.value=d),u.defaultValue=d}p=u.name,p!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,p!==""&&(u.name=p)}function dn(u,d,p){(d!=="number"||Ft(u.ownerDocument)!==u)&&(p==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+p&&(u.defaultValue=""+p))}var un=Array.isArray;function sr(u,d,p,E){if(u=u.options,d){d={};for(var S=0;S<p.length;S++)d["$"+p[S]]=!0;for(p=0;p<u.length;p++)S=d.hasOwnProperty("$"+u[p].value),u[p].selected!==S&&(u[p].selected=S),S&&E&&(u[p].defaultSelected=!0)}else{for(p=""+Be(p),d=null,S=0;S<u.length;S++){if(u[S].value===p){u[S].selected=!0,E&&(u[S].defaultSelected=!0);return}d!==null||u[S].disabled||(d=u[S])}d!==null&&(d.selected=!0)}}function Mi(u,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return ae({},d,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function Bn(u,d){var p=d.value;if(p==null){if(p=d.children,d=d.defaultValue,p!=null){if(d!=null)throw Error(t(92));if(un(p)){if(1<p.length)throw Error(t(93));p=p[0]}d=p}d==null&&(d=""),p=d}u._wrapperState={initialValue:Be(p)}}function Sr(u,d){var p=Be(d.value),E=Be(d.defaultValue);p!=null&&(p=""+p,p!==u.value&&(u.value=p),d.defaultValue==null&&u.defaultValue!==p&&(u.defaultValue=p)),E!=null&&(u.defaultValue=""+E)}function oi(u){var d=u.textContent;d===u._wrapperState.initialValue&&d!==""&&d!==null&&(u.value=d)}function _t(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xn(u,d){return u==null||u==="http://www.w3.org/1999/xhtml"?_t(d):u==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var An,Tt=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,p,E,S){MSApp.execUnsafeLocalFunction(function(){return u(d,p,E,S)})}:u})(function(u,d){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=d;else{for(An=An||document.createElement("div"),An.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=An.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;d.firstChild;)u.appendChild(d.firstChild)}});function an(u,d){if(d){var p=u.firstChild;if(p&&p===u.lastChild&&p.nodeType===3){p.nodeValue=d;return}}u.textContent=d}var Mt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Zi=["Webkit","ms","Moz","O"];Object.keys(Mt).forEach(function(u){Zi.forEach(function(d){d=d+u.charAt(0).toUpperCase()+u.substring(1),Mt[d]=Mt[u]})});function Mr(u,d,p){return d==null||typeof d=="boolean"||d===""?"":p||typeof d!="number"||d===0||Mt.hasOwnProperty(u)&&Mt[u]?(""+d).trim():d+"px"}function li(u,d){u=u.style;for(var p in d)if(d.hasOwnProperty(p)){var E=p.indexOf("--")===0,S=Mr(p,d[p],E);p==="float"&&(p="cssFloat"),E?u.setProperty(p,S):u[p]=S}}var rn=ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Tr(u,d){if(d){if(rn[u]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,u));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function je(u,d){if(u.indexOf("-")===-1)return typeof d.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function ve(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var jt=null,L=null,ut=null;function W(u){if(u=Kg(u)){if(typeof jt!="function")throw Error(t(280));var d=u.stateNode;d&&(d=Mx(d),jt(u.stateNode,u.type,d))}}function ie(u){L?ut?ut.push(u):ut=[u]:L=u}function Pe(){if(L){var u=L,d=ut;if(ut=L=null,W(u),d)for(u=0;u<d.length;u++)W(d[u])}}function q(u,d){return u(d)}function ce(){}var Re=!1;function ze(u,d,p){if(Re)return u(d,p);Re=!0;try{return q(u,d,p)}finally{Re=!1,(L!==null||ut!==null)&&(ce(),Pe())}}function Me(u,d){var p=u.stateNode;if(p===null)return null;var E=Mx(p);if(E===null)return null;p=E[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(E=!E.disabled)||(u=u.type,E=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!E;break e;default:u=!1}if(u)return null;if(p&&typeof p!="function")throw Error(t(231,d,typeof p));return p}var He=!1;if(o)try{var $e={};Object.defineProperty($e,"passive",{get:function(){He=!0}}),window.addEventListener("test",$e,$e),window.removeEventListener("test",$e,$e)}catch{He=!1}function xt(u,d,p,E,S,I,U,se,oe){var Ae=Array.prototype.slice.call(arguments,3);try{d.apply(p,Ae)}catch(qe){this.onError(qe)}}var Rt=!1,Ht=null,G=!1,J=null,X={onError:function(u){Rt=!0,Ht=u}};function Y(u,d,p,E,S,I,U,se,oe){Rt=!1,Ht=null,xt.apply(X,arguments)}function te(u,d,p,E,S,I,U,se,oe){if(Y.apply(this,arguments),Rt){if(Rt){var Ae=Ht;Rt=!1,Ht=null}else throw Error(t(198));G||(G=!0,J=Ae)}}function ne(u){var d=u,p=u;if(u.alternate)for(;d.return;)d=d.return;else{u=d;do d=u,(d.flags&4098)!==0&&(p=d.return),u=d.return;while(u)}return d.tag===3?p:null}function Ee(u){if(u.tag===13){var d=u.memoizedState;if(d===null&&(u=u.alternate,u!==null&&(d=u.memoizedState)),d!==null)return d.dehydrated}return null}function Oe(u){if(ne(u)!==u)throw Error(t(188))}function we(u){var d=u.alternate;if(!d){if(d=ne(u),d===null)throw Error(t(188));return d!==u?null:u}for(var p=u,E=d;;){var S=p.return;if(S===null)break;var I=S.alternate;if(I===null){if(E=S.return,E!==null){p=E;continue}break}if(S.child===I.child){for(I=S.child;I;){if(I===p)return Oe(S),u;if(I===E)return Oe(S),d;I=I.sibling}throw Error(t(188))}if(p.return!==E.return)p=S,E=I;else{for(var U=!1,se=S.child;se;){if(se===p){U=!0,p=S,E=I;break}if(se===E){U=!0,E=S,p=I;break}se=se.sibling}if(!U){for(se=I.child;se;){if(se===p){U=!0,p=I,E=S;break}if(se===E){U=!0,E=I,p=S;break}se=se.sibling}if(!U)throw Error(t(189))}}if(p.alternate!==E)throw Error(t(190))}if(p.tag!==3)throw Error(t(188));return p.stateNode.current===p?u:d}function Te(u){return u=we(u),u!==null?be(u):null}function be(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var d=be(u);if(d!==null)return d;u=u.sibling}return null}var Ye=e.unstable_scheduleCallback,it=e.unstable_cancelCallback,pt=e.unstable_shouldYield,Ze=e.unstable_requestPaint,Je=e.unstable_now,qt=e.unstable_getCurrentPriorityLevel,Gn=e.unstable_ImmediatePriority,Wn=e.unstable_UserBlockingPriority,pr=e.unstable_NormalPriority,Ya=e.unstable_LowPriority,_a=e.unstable_IdlePriority,Zs=null,Gr=null;function Sc(u){if(Gr&&typeof Gr.onCommitFiberRoot=="function")try{Gr.onCommitFiberRoot(Zs,u,void 0,(u.current.flags&128)===128)}catch{}}var br=Math.clz32?Math.clz32:eh,Co=Math.log,va=Math.LN2;function eh(u){return u>>>=0,u===0?32:31-(Co(u)/va|0)|0}var Po=64,Tc=4194304;function Ln(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function El(u,d){var p=u.pendingLanes;if(p===0)return 0;var E=0,S=u.suspendedLanes,I=u.pingedLanes,U=p&268435455;if(U!==0){var se=U&~S;se!==0?E=Ln(se):(I&=U,I!==0&&(E=Ln(I)))}else U=p&~S,U!==0?E=Ln(U):I!==0&&(E=Ln(I));if(E===0)return 0;if(d!==0&&d!==E&&(d&S)===0&&(S=E&-E,I=d&-d,S>=I||S===16&&(I&4194240)!==0))return d;if((E&4)!==0&&(E|=p&16),d=u.entangledLanes,d!==0)for(u=u.entanglements,d&=E;0<d;)p=31-br(d),S=1<<p,E|=u[p],d&=~S;return E}function th(u,d){switch(u){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nh(u,d){for(var p=u.suspendedLanes,E=u.pingedLanes,S=u.expirationTimes,I=u.pendingLanes;0<I;){var U=31-br(I),se=1<<U,oe=S[U];oe===-1?((se&p)===0||(se&E)!==0)&&(S[U]=th(se,d)):oe<=d&&(u.expiredLanes|=se),I&=~se}}function Rg(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function Ag(){var u=Po;return Po<<=1,(Po&4194240)===0&&(Po=64),u}function kg(u){for(var d=[],p=0;31>p;p++)d.push(u);return d}function rh(u,d,p){u.pendingLanes|=d,d!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,d=31-br(d),u[d]=p}function YE(u,d){var p=u.pendingLanes&~d;u.pendingLanes=d,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=d,u.mutableReadLanes&=d,u.entangledLanes&=d,d=u.entanglements;var E=u.eventTimes;for(u=u.expirationTimes;0<p;){var S=31-br(p),I=1<<S;d[S]=0,E[S]=-1,u[S]=-1,p&=~I}}function Ig(u,d){var p=u.entangledLanes|=d;for(u=u.entanglements;p;){var E=31-br(p),S=1<<E;S&d|u[E]&d&&(u[E]|=d),p&=~S}}var En=0;function No(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var Cg,Wd,Pg,Ng,Mg,Mo=!1,Hd=[],Lo=null,Oo=null,Li=null,ih=new Map,Sl=new Map,Js=[],xx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bc(u,d){switch(u){case"focusin":case"focusout":Lo=null;break;case"dragenter":case"dragleave":Oo=null;break;case"mouseover":case"mouseout":Li=null;break;case"pointerover":case"pointerout":ih.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sl.delete(d.pointerId)}}function Za(u,d,p,E,S,I){return u===null||u.nativeEvent!==I?(u={blockedOn:d,domEventName:p,eventSystemFlags:E,nativeEvent:I,targetContainers:[S]},d!==null&&(d=Kg(d),d!==null&&Wd(d)),u):(u.eventSystemFlags|=E,d=u.targetContainers,S!==null&&d.indexOf(S)===-1&&d.push(S),u)}function yx(u,d,p,E,S){switch(d){case"focusin":return Lo=Za(Lo,u,d,p,E,S),!0;case"dragenter":return Oo=Za(Oo,u,d,p,E,S),!0;case"mouseover":return Li=Za(Li,u,d,p,E,S),!0;case"pointerover":var I=S.pointerId;return ih.set(I,Za(ih.get(I)||null,u,d,p,E,S)),!0;case"gotpointercapture":return I=S.pointerId,Sl.set(I,Za(Sl.get(I)||null,u,d,p,E,S)),!0}return!1}function Kd(u){var d=lh(u.target);if(d!==null){var p=ne(d);if(p!==null){if(d=p.tag,d===13){if(d=Ee(p),d!==null){u.blockedOn=d,Mg(u.priority,function(){Pg(p)});return}}else if(d===3&&p.stateNode.current.memoizedState.isDehydrated){u.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}u.blockedOn=null}function ar(u){if(u.blockedOn!==null)return!1;for(var d=u.targetContainers;0<d.length;){var p=Xd(u.domEventName,u.eventSystemFlags,d[0],u.nativeEvent);if(p===null){p=u.nativeEvent;var E=new p.constructor(p.type,p);_e=E,p.target.dispatchEvent(E),_e=null}else return d=Kg(p),d!==null&&Wd(d),u.blockedOn=p,!1;d.shift()}return!0}function _x(u,d,p){ar(u)&&p.delete(d)}function ZE(){Mo=!1,Lo!==null&&ar(Lo)&&(Lo=null),Oo!==null&&ar(Oo)&&(Oo=null),Li!==null&&ar(Li)&&(Li=null),ih.forEach(_x),Sl.forEach(_x)}function Rc(u,d){u.blockedOn===d&&(u.blockedOn=null,Mo||(Mo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,ZE)))}function Ac(u){function d(S){return Rc(S,u)}if(0<Hd.length){Rc(Hd[0],u);for(var p=1;p<Hd.length;p++){var E=Hd[p];E.blockedOn===u&&(E.blockedOn=null)}}for(Lo!==null&&Rc(Lo,u),Oo!==null&&Rc(Oo,u),Li!==null&&Rc(Li,u),ih.forEach(d),Sl.forEach(d),p=0;p<Js.length;p++)E=Js[p],E.blockedOn===u&&(E.blockedOn=null);for(;0<Js.length&&(p=Js[0],p.blockedOn===null);)Kd(p),p.blockedOn===null&&Js.shift()}var Tl=M.ReactCurrentBatchConfig,bl=!0;function Do(u,d,p,E){var S=En,I=Tl.transition;Tl.transition=null;try{En=1,Lg(u,d,p,E)}finally{En=S,Tl.transition=I}}function vx(u,d,p,E){var S=En,I=Tl.transition;Tl.transition=null;try{En=4,Lg(u,d,p,E)}finally{En=S,Tl.transition=I}}function Lg(u,d,p,E){if(bl){var S=Xd(u,d,p,E);if(S===null)l2(u,d,E,jo,p),bc(u,E);else if(yx(S,u,d,p,E))E.stopPropagation();else if(bc(u,E),d&4&&-1<xx.indexOf(u)){for(;S!==null;){var I=Kg(S);if(I!==null&&Cg(I),I=Xd(u,d,p,E),I===null&&l2(u,d,E,jo,p),I===S)break;S=I}S!==null&&E.stopPropagation()}else l2(u,d,E,null,p)}}var jo=null;function Xd(u,d,p,E){if(jo=null,u=ve(E),u=lh(u),u!==null)if(d=ne(u),d===null)u=null;else if(p=d.tag,p===13){if(u=Ee(d),u!==null)return u;u=null}else if(p===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;u=null}else d!==u&&(u=null);return jo=u,null}function qd(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qt()){case Gn:return 1;case Wn:return 4;case pr:case Ya:return 16;case _a:return 536870912;default:return 16}default:return 16}}var Qs=null,Yd=null,Rl=null;function wx(){if(Rl)return Rl;var u,d=Yd,p=d.length,E,S="value"in Qs?Qs.value:Qs.textContent,I=S.length;for(u=0;u<p&&d[u]===S[u];u++);var U=p-u;for(E=1;E<=U&&d[p-E]===S[I-E];E++);return Rl=S.slice(u,1<E?1-E:void 0)}function sh(u){var d=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&d===13&&(u=13)):u=d,u===10&&(u=13),32<=u||u===13?u:0}function Fo(){return!0}function Og(){return!1}function Ji(u){function d(p,E,S,I,U){this._reactName=p,this._targetInst=S,this.type=E,this.nativeEvent=I,this.target=U,this.currentTarget=null;for(var se in u)u.hasOwnProperty(se)&&(p=u[se],this[se]=p?p(I):I[se]);return this.isDefaultPrevented=(I.defaultPrevented!=null?I.defaultPrevented:I.returnValue===!1)?Fo:Og,this.isPropagationStopped=Og,this}return ae(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Fo)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Fo)},persist:function(){},isPersistent:Fo}),d}var Vo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ah=Ji(Vo),kc=ae({},Vo,{view:0,detail:0}),Zd=Ji(kc),Jd,Qd,ea,oh=ae({},kc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sn,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==ea&&(ea&&u.type==="mousemove"?(Jd=u.screenX-ea.screenX,Qd=u.screenY-ea.screenY):Qd=Jd=0,ea=u),Jd)},movementY:function(u){return"movementY"in u?u.movementY:Qd}}),Dg=Ji(oh),Ex=ae({},oh,{dataTransfer:0}),Sx=Ji(Ex),ef=ae({},kc,{relatedTarget:0}),Oi=Ji(ef),Tx=ae({},Vo,{animationName:0,elapsedTime:0,pseudoElement:0}),bx=Ji(Tx),Ic=ae({},Vo,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),v=Ji(Ic),N=ae({},Vo,{data:0}),j=Ji(N),K={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ge={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ie={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lt(u){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(u):(u=Ie[u])?!!d[u]:!1}function sn(){return lt}var zr=ae({},kc,{key:function(u){if(u.key){var d=K[u.key]||u.key;if(d!=="Unidentified")return d}return u.type==="keypress"?(u=sh(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?ge[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sn,charCode:function(u){return u.type==="keypress"?sh(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?sh(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Hn=Ji(zr),qr=ae({},oh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ta=Ji(qr),Al=ae({},kc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sn}),Bo=Ji(Al),Go=ae({},Vo,{propertyName:0,elapsedTime:0,pseudoElement:0}),tf=Ji(Go),jg=ae({},oh,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),Ez=Ji(jg),Sz=[9,13,27,32],JE=o&&"CompositionEvent"in window,Fg=null;o&&"documentMode"in document&&(Fg=document.documentMode);var Tz=o&&"TextEvent"in window&&!Fg,BC=o&&(!JE||Fg&&8<Fg&&11>=Fg),GC=" ",zC=!1;function UC(u,d){switch(u){case"keyup":return Sz.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $C(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var nf=!1;function bz(u,d){switch(u){case"compositionend":return $C(d);case"keypress":return d.which!==32?null:(zC=!0,GC);case"textInput":return u=d.data,u===GC&&zC?null:u;default:return null}}function Rz(u,d){if(nf)return u==="compositionend"||!JE&&UC(u,d)?(u=wx(),Rl=Yd=Qs=null,nf=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return BC&&d.locale!=="ko"?null:d.data;default:return null}}var Az={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function WC(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d==="input"?!!Az[u.type]:d==="textarea"}function HC(u,d,p,E){ie(E),d=Cx(d,"onChange"),0<d.length&&(p=new ah("onChange","change",null,p,E),u.push({event:p,listeners:d}))}var Vg=null,Bg=null;function kz(u){uP(u,0)}function Rx(u){var d=lf(u);if(Et(d))return u}function Iz(u,d){if(u==="change")return d}var KC=!1;if(o){var QE;if(o){var e2="oninput"in document;if(!e2){var XC=document.createElement("div");XC.setAttribute("oninput","return;"),e2=typeof XC.oninput=="function"}QE=e2}else QE=!1;KC=QE&&(!document.documentMode||9<document.documentMode)}function qC(){Vg&&(Vg.detachEvent("onpropertychange",YC),Bg=Vg=null)}function YC(u){if(u.propertyName==="value"&&Rx(Bg)){var d=[];HC(d,Bg,u,ve(u)),ze(kz,d)}}function Cz(u,d,p){u==="focusin"?(qC(),Vg=d,Bg=p,Vg.attachEvent("onpropertychange",YC)):u==="focusout"&&qC()}function Pz(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return Rx(Bg)}function Nz(u,d){if(u==="click")return Rx(d)}function Mz(u,d){if(u==="input"||u==="change")return Rx(d)}function Lz(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var Ja=typeof Object.is=="function"?Object.is:Lz;function Gg(u,d){if(Ja(u,d))return!0;if(typeof u!="object"||u===null||typeof d!="object"||d===null)return!1;var p=Object.keys(u),E=Object.keys(d);if(p.length!==E.length)return!1;for(E=0;E<p.length;E++){var S=p[E];if(!l.call(d,S)||!Ja(u[S],d[S]))return!1}return!0}function ZC(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function JC(u,d){var p=ZC(u);u=0;for(var E;p;){if(p.nodeType===3){if(E=u+p.textContent.length,u<=d&&E>=d)return{node:p,offset:d-u};u=E}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=ZC(p)}}function QC(u,d){return u&&d?u===d?!0:u&&u.nodeType===3?!1:d&&d.nodeType===3?QC(u,d.parentNode):"contains"in u?u.contains(d):u.compareDocumentPosition?!!(u.compareDocumentPosition(d)&16):!1:!1}function eP(){for(var u=window,d=Ft();d instanceof u.HTMLIFrameElement;){try{var p=typeof d.contentWindow.location.href=="string"}catch{p=!1}if(p)u=d.contentWindow;else break;d=Ft(u.document)}return d}function t2(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d&&(d==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||d==="textarea"||u.contentEditable==="true")}function Oz(u){var d=eP(),p=u.focusedElem,E=u.selectionRange;if(d!==p&&p&&p.ownerDocument&&QC(p.ownerDocument.documentElement,p)){if(E!==null&&t2(p)){if(d=E.start,u=E.end,u===void 0&&(u=d),"selectionStart"in p)p.selectionStart=d,p.selectionEnd=Math.min(u,p.value.length);else if(u=(d=p.ownerDocument||document)&&d.defaultView||window,u.getSelection){u=u.getSelection();var S=p.textContent.length,I=Math.min(E.start,S);E=E.end===void 0?I:Math.min(E.end,S),!u.extend&&I>E&&(S=E,E=I,I=S),S=JC(p,I);var U=JC(p,E);S&&U&&(u.rangeCount!==1||u.anchorNode!==S.node||u.anchorOffset!==S.offset||u.focusNode!==U.node||u.focusOffset!==U.offset)&&(d=d.createRange(),d.setStart(S.node,S.offset),u.removeAllRanges(),I>E?(u.addRange(d),u.extend(U.node,U.offset)):(d.setEnd(U.node,U.offset),u.addRange(d)))}}for(d=[],u=p;u=u.parentNode;)u.nodeType===1&&d.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<d.length;p++)u=d[p],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var Dz=o&&"documentMode"in document&&11>=document.documentMode,rf=null,n2=null,zg=null,r2=!1;function tP(u,d,p){var E=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;r2||rf==null||rf!==Ft(E)||(E=rf,"selectionStart"in E&&t2(E)?E={start:E.selectionStart,end:E.selectionEnd}:(E=(E.ownerDocument&&E.ownerDocument.defaultView||window).getSelection(),E={anchorNode:E.anchorNode,anchorOffset:E.anchorOffset,focusNode:E.focusNode,focusOffset:E.focusOffset}),zg&&Gg(zg,E)||(zg=E,E=Cx(n2,"onSelect"),0<E.length&&(d=new ah("onSelect","select",null,d,p),u.push({event:d,listeners:E}),d.target=rf)))}function Ax(u,d){var p={};return p[u.toLowerCase()]=d.toLowerCase(),p["Webkit"+u]="webkit"+d,p["Moz"+u]="moz"+d,p}var sf={animationend:Ax("Animation","AnimationEnd"),animationiteration:Ax("Animation","AnimationIteration"),animationstart:Ax("Animation","AnimationStart"),transitionend:Ax("Transition","TransitionEnd")},i2={},nP={};o&&(nP=document.createElement("div").style,"AnimationEvent"in window||(delete sf.animationend.animation,delete sf.animationiteration.animation,delete sf.animationstart.animation),"TransitionEvent"in window||delete sf.transitionend.transition);function kx(u){if(i2[u])return i2[u];if(!sf[u])return u;var d=sf[u],p;for(p in d)if(d.hasOwnProperty(p)&&p in nP)return i2[u]=d[p];return u}var rP=kx("animationend"),iP=kx("animationiteration"),sP=kx("animationstart"),aP=kx("transitionend"),oP=new Map,lP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cc(u,d){oP.set(u,d),s(d,[u])}for(var s2=0;s2<lP.length;s2++){var a2=lP[s2],jz=a2.toLowerCase(),Fz=a2[0].toUpperCase()+a2.slice(1);Cc(jz,"on"+Fz)}Cc(rP,"onAnimationEnd"),Cc(iP,"onAnimationIteration"),Cc(sP,"onAnimationStart"),Cc("dblclick","onDoubleClick"),Cc("focusin","onFocus"),Cc("focusout","onBlur"),Cc(aP,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ug="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vz=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ug));function cP(u,d,p){var E=u.type||"unknown-event";u.currentTarget=p,te(E,d,void 0,u),u.currentTarget=null}function uP(u,d){d=(d&4)!==0;for(var p=0;p<u.length;p++){var E=u[p],S=E.event;E=E.listeners;e:{var I=void 0;if(d)for(var U=E.length-1;0<=U;U--){var se=E[U],oe=se.instance,Ae=se.currentTarget;if(se=se.listener,oe!==I&&S.isPropagationStopped())break e;cP(S,se,Ae),I=oe}else for(U=0;U<E.length;U++){if(se=E[U],oe=se.instance,Ae=se.currentTarget,se=se.listener,oe!==I&&S.isPropagationStopped())break e;cP(S,se,Ae),I=oe}}}if(G)throw u=J,G=!1,J=null,u}function hr(u,d){var p=d[g2];p===void 0&&(p=d[g2]=new Set);var E=u+"__bubble";p.has(E)||(hP(d,u,2,!1),p.add(E))}function o2(u,d,p){var E=0;d&&(E|=4),hP(p,u,E,d)}var Ix="_reactListening"+Math.random().toString(36).slice(2);function $g(u){if(!u[Ix]){u[Ix]=!0,r.forEach(function(p){p!=="selectionchange"&&(Vz.has(p)||o2(p,!1,u),o2(p,!0,u))});var d=u.nodeType===9?u:u.ownerDocument;d===null||d[Ix]||(d[Ix]=!0,o2("selectionchange",!1,d))}}function hP(u,d,p,E){switch(qd(d)){case 1:var S=Do;break;case 4:S=vx;break;default:S=Lg}p=S.bind(null,d,p,u),S=void 0,!He||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(S=!0),E?S!==void 0?u.addEventListener(d,p,{capture:!0,passive:S}):u.addEventListener(d,p,!0):S!==void 0?u.addEventListener(d,p,{passive:S}):u.addEventListener(d,p,!1)}function l2(u,d,p,E,S){var I=E;if((d&1)===0&&(d&2)===0&&E!==null)e:for(;;){if(E===null)return;var U=E.tag;if(U===3||U===4){var se=E.stateNode.containerInfo;if(se===S||se.nodeType===8&&se.parentNode===S)break;if(U===4)for(U=E.return;U!==null;){var oe=U.tag;if((oe===3||oe===4)&&(oe=U.stateNode.containerInfo,oe===S||oe.nodeType===8&&oe.parentNode===S))return;U=U.return}for(;se!==null;){if(U=lh(se),U===null)return;if(oe=U.tag,oe===5||oe===6){E=I=U;continue e}se=se.parentNode}}E=E.return}ze(function(){var Ae=I,qe=ve(p),Qe=[];e:{var Ke=oP.get(u);if(Ke!==void 0){var vt=ah,At=u;switch(u){case"keypress":if(sh(p)===0)break e;case"keydown":case"keyup":vt=Hn;break;case"focusin":At="focus",vt=Oi;break;case"focusout":At="blur",vt=Oi;break;case"beforeblur":case"afterblur":vt=Oi;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":vt=Dg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":vt=Sx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":vt=Bo;break;case rP:case iP:case sP:vt=bx;break;case aP:vt=tf;break;case"scroll":vt=Zd;break;case"wheel":vt=Ez;break;case"copy":case"cut":case"paste":vt=v;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":vt=ta}var Ct=(d&4)!==0,Ur=!Ct&&u==="scroll",fe=Ct?Ke!==null?Ke+"Capture":null:Ke;Ct=[];for(var le=Ae,Se;le!==null;){Se=le;var rt=Se.stateNode;if(Se.tag===5&&rt!==null&&(Se=rt,fe!==null&&(rt=Me(le,fe),rt!=null&&Ct.push(Wg(le,rt,Se)))),Ur)break;le=le.return}0<Ct.length&&(Ke=new vt(Ke,At,null,p,qe),Qe.push({event:Ke,listeners:Ct}))}}if((d&7)===0){e:{if(Ke=u==="mouseover"||u==="pointerover",vt=u==="mouseout"||u==="pointerout",Ke&&p!==_e&&(At=p.relatedTarget||p.fromElement)&&(lh(At)||At[kl]))break e;if((vt||Ke)&&(Ke=qe.window===qe?qe:(Ke=qe.ownerDocument)?Ke.defaultView||Ke.parentWindow:window,vt?(At=p.relatedTarget||p.toElement,vt=Ae,At=At?lh(At):null,At!==null&&(Ur=ne(At),At!==Ur||At.tag!==5&&At.tag!==6)&&(At=null)):(vt=null,At=Ae),vt!==At)){if(Ct=Dg,rt="onMouseLeave",fe="onMouseEnter",le="mouse",(u==="pointerout"||u==="pointerover")&&(Ct=ta,rt="onPointerLeave",fe="onPointerEnter",le="pointer"),Ur=vt==null?Ke:lf(vt),Se=At==null?Ke:lf(At),Ke=new Ct(rt,le+"leave",vt,p,qe),Ke.target=Ur,Ke.relatedTarget=Se,rt=null,lh(qe)===Ae&&(Ct=new Ct(fe,le+"enter",At,p,qe),Ct.target=Se,Ct.relatedTarget=Ur,rt=Ct),Ur=rt,vt&&At)t:{for(Ct=vt,fe=At,le=0,Se=Ct;Se;Se=af(Se))le++;for(Se=0,rt=fe;rt;rt=af(rt))Se++;for(;0<le-Se;)Ct=af(Ct),le--;for(;0<Se-le;)fe=af(fe),Se--;for(;le--;){if(Ct===fe||fe!==null&&Ct===fe.alternate)break t;Ct=af(Ct),fe=af(fe)}Ct=null}else Ct=null;vt!==null&&dP(Qe,Ke,vt,Ct,!1),At!==null&&Ur!==null&&dP(Qe,Ur,At,Ct,!0)}}e:{if(Ke=Ae?lf(Ae):window,vt=Ke.nodeName&&Ke.nodeName.toLowerCase(),vt==="select"||vt==="input"&&Ke.type==="file")var Nt=Iz;else if(WC(Ke))if(KC)Nt=Mz;else{Nt=Pz;var zt=Cz}else(vt=Ke.nodeName)&&vt.toLowerCase()==="input"&&(Ke.type==="checkbox"||Ke.type==="radio")&&(Nt=Nz);if(Nt&&(Nt=Nt(u,Ae))){HC(Qe,Nt,p,qe);break e}zt&&zt(u,Ke,Ae),u==="focusout"&&(zt=Ke._wrapperState)&&zt.controlled&&Ke.type==="number"&&dn(Ke,"number",Ke.value)}switch(zt=Ae?lf(Ae):window,u){case"focusin":(WC(zt)||zt.contentEditable==="true")&&(rf=zt,n2=Ae,zg=null);break;case"focusout":zg=n2=rf=null;break;case"mousedown":r2=!0;break;case"contextmenu":case"mouseup":case"dragend":r2=!1,tP(Qe,p,qe);break;case"selectionchange":if(Dz)break;case"keydown":case"keyup":tP(Qe,p,qe)}var Ut;if(JE)e:{switch(u){case"compositionstart":var Yt="onCompositionStart";break e;case"compositionend":Yt="onCompositionEnd";break e;case"compositionupdate":Yt="onCompositionUpdate";break e}Yt=void 0}else nf?UC(u,p)&&(Yt="onCompositionEnd"):u==="keydown"&&p.keyCode===229&&(Yt="onCompositionStart");Yt&&(BC&&p.locale!=="ko"&&(nf||Yt!=="onCompositionStart"?Yt==="onCompositionEnd"&&nf&&(Ut=wx()):(Qs=qe,Yd="value"in Qs?Qs.value:Qs.textContent,nf=!0)),zt=Cx(Ae,Yt),0<zt.length&&(Yt=new j(Yt,u,null,p,qe),Qe.push({event:Yt,listeners:zt}),Ut?Yt.data=Ut:(Ut=$C(p),Ut!==null&&(Yt.data=Ut)))),(Ut=Tz?bz(u,p):Rz(u,p))&&(Ae=Cx(Ae,"onBeforeInput"),0<Ae.length&&(qe=new j("onBeforeInput","beforeinput",null,p,qe),Qe.push({event:qe,listeners:Ae}),qe.data=Ut))}uP(Qe,d)})}function Wg(u,d,p){return{instance:u,listener:d,currentTarget:p}}function Cx(u,d){for(var p=d+"Capture",E=[];u!==null;){var S=u,I=S.stateNode;S.tag===5&&I!==null&&(S=I,I=Me(u,p),I!=null&&E.unshift(Wg(u,I,S)),I=Me(u,d),I!=null&&E.push(Wg(u,I,S))),u=u.return}return E}function af(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function dP(u,d,p,E,S){for(var I=d._reactName,U=[];p!==null&&p!==E;){var se=p,oe=se.alternate,Ae=se.stateNode;if(oe!==null&&oe===E)break;se.tag===5&&Ae!==null&&(se=Ae,S?(oe=Me(p,I),oe!=null&&U.unshift(Wg(p,oe,se))):S||(oe=Me(p,I),oe!=null&&U.push(Wg(p,oe,se)))),p=p.return}U.length!==0&&u.push({event:d,listeners:U})}var Bz=/\r\n?/g,Gz=/\u0000|\uFFFD/g;function fP(u){return(typeof u=="string"?u:""+u).replace(Bz,`
`).replace(Gz,"")}function Px(u,d,p){if(d=fP(d),fP(u)!==d&&p)throw Error(t(425))}function Nx(){}var c2=null,u2=null;function h2(u,d){return u==="textarea"||u==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var d2=typeof setTimeout=="function"?setTimeout:void 0,zz=typeof clearTimeout=="function"?clearTimeout:void 0,gP=typeof Promise=="function"?Promise:void 0,Uz=typeof queueMicrotask=="function"?queueMicrotask:typeof gP<"u"?function(u){return gP.resolve(null).then(u).catch($z)}:d2;function $z(u){setTimeout(function(){throw u})}function f2(u,d){var p=d,E=0;do{var S=p.nextSibling;if(u.removeChild(p),S&&S.nodeType===8)if(p=S.data,p==="/$"){if(E===0){u.removeChild(S),Ac(d);return}E--}else p!=="$"&&p!=="$?"&&p!=="$!"||E++;p=S}while(p);Ac(d)}function Pc(u){for(;u!=null;u=u.nextSibling){var d=u.nodeType;if(d===1||d===3)break;if(d===8){if(d=u.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return u}function mP(u){u=u.previousSibling;for(var d=0;u;){if(u.nodeType===8){var p=u.data;if(p==="$"||p==="$!"||p==="$?"){if(d===0)return u;d--}else p==="/$"&&d++}u=u.previousSibling}return null}var of=Math.random().toString(36).slice(2),zo="__reactFiber$"+of,Hg="__reactProps$"+of,kl="__reactContainer$"+of,g2="__reactEvents$"+of,Wz="__reactListeners$"+of,Hz="__reactHandles$"+of;function lh(u){var d=u[zo];if(d)return d;for(var p=u.parentNode;p;){if(d=p[kl]||p[zo]){if(p=d.alternate,d.child!==null||p!==null&&p.child!==null)for(u=mP(u);u!==null;){if(p=u[zo])return p;u=mP(u)}return d}u=p,p=u.parentNode}return null}function Kg(u){return u=u[zo]||u[kl],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function lf(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(t(33))}function Mx(u){return u[Hg]||null}var m2=[],cf=-1;function Nc(u){return{current:u}}function dr(u){0>cf||(u.current=m2[cf],m2[cf]=null,cf--)}function cr(u,d){cf++,m2[cf]=u.current,u.current=d}var Mc={},Qi=Nc(Mc),ks=Nc(!1),ch=Mc;function uf(u,d){var p=u.type.contextTypes;if(!p)return Mc;var E=u.stateNode;if(E&&E.__reactInternalMemoizedUnmaskedChildContext===d)return E.__reactInternalMemoizedMaskedChildContext;var S={},I;for(I in p)S[I]=d[I];return E&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=d,u.__reactInternalMemoizedMaskedChildContext=S),S}function Is(u){return u=u.childContextTypes,u!=null}function Lx(){dr(ks),dr(Qi)}function pP(u,d,p){if(Qi.current!==Mc)throw Error(t(168));cr(Qi,d),cr(ks,p)}function xP(u,d,p){var E=u.stateNode;if(d=d.childContextTypes,typeof E.getChildContext!="function")return p;E=E.getChildContext();for(var S in E)if(!(S in d))throw Error(t(108,Ve(u)||"Unknown",S));return ae({},p,E)}function Ox(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||Mc,ch=Qi.current,cr(Qi,u),cr(ks,ks.current),!0}function yP(u,d,p){var E=u.stateNode;if(!E)throw Error(t(169));p?(u=xP(u,d,ch),E.__reactInternalMemoizedMergedChildContext=u,dr(ks),dr(Qi),cr(Qi,u)):dr(ks),cr(ks,p)}var Il=null,Dx=!1,p2=!1;function _P(u){Il===null?Il=[u]:Il.push(u)}function Kz(u){Dx=!0,_P(u)}function Lc(){if(!p2&&Il!==null){p2=!0;var u=0,d=En;try{var p=Il;for(En=1;u<p.length;u++){var E=p[u];do E=E(!0);while(E!==null)}Il=null,Dx=!1}catch(S){throw Il!==null&&(Il=Il.slice(u+1)),Ye(Gn,Lc),S}finally{En=d,p2=!1}}return null}var hf=[],df=0,jx=null,Fx=0,wa=[],Ea=0,uh=null,Cl=1,Pl="";function hh(u,d){hf[df++]=Fx,hf[df++]=jx,jx=u,Fx=d}function vP(u,d,p){wa[Ea++]=Cl,wa[Ea++]=Pl,wa[Ea++]=uh,uh=u;var E=Cl;u=Pl;var S=32-br(E)-1;E&=~(1<<S),p+=1;var I=32-br(d)+S;if(30<I){var U=S-S%5;I=(E&(1<<U)-1).toString(32),E>>=U,S-=U,Cl=1<<32-br(d)+S|p<<S|E,Pl=I+u}else Cl=1<<I|p<<S|E,Pl=u}function x2(u){u.return!==null&&(hh(u,1),vP(u,1,0))}function y2(u){for(;u===jx;)jx=hf[--df],hf[df]=null,Fx=hf[--df],hf[df]=null;for(;u===uh;)uh=wa[--Ea],wa[Ea]=null,Pl=wa[--Ea],wa[Ea]=null,Cl=wa[--Ea],wa[Ea]=null}var na=null,ra=null,xr=!1,Qa=null;function wP(u,d){var p=Ra(5,null,null,0);p.elementType="DELETED",p.stateNode=d,p.return=u,d=u.deletions,d===null?(u.deletions=[p],u.flags|=16):d.push(p)}function EP(u,d){switch(u.tag){case 5:var p=u.type;return d=d.nodeType!==1||p.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(u.stateNode=d,na=u,ra=Pc(d.firstChild),!0):!1;case 6:return d=u.pendingProps===""||d.nodeType!==3?null:d,d!==null?(u.stateNode=d,na=u,ra=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(p=uh!==null?{id:Cl,overflow:Pl}:null,u.memoizedState={dehydrated:d,treeContext:p,retryLane:1073741824},p=Ra(18,null,null,0),p.stateNode=d,p.return=u,u.child=p,na=u,ra=null,!0):!1;default:return!1}}function _2(u){return(u.mode&1)!==0&&(u.flags&128)===0}function v2(u){if(xr){var d=ra;if(d){var p=d;if(!EP(u,d)){if(_2(u))throw Error(t(418));d=Pc(p.nextSibling);var E=na;d&&EP(u,d)?wP(E,p):(u.flags=u.flags&-4097|2,xr=!1,na=u)}}else{if(_2(u))throw Error(t(418));u.flags=u.flags&-4097|2,xr=!1,na=u}}}function SP(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;na=u}function Vx(u){if(u!==na)return!1;if(!xr)return SP(u),xr=!0,!1;var d;if((d=u.tag!==3)&&!(d=u.tag!==5)&&(d=u.type,d=d!=="head"&&d!=="body"&&!h2(u.type,u.memoizedProps)),d&&(d=ra)){if(_2(u))throw TP(),Error(t(418));for(;d;)wP(u,d),d=Pc(d.nextSibling)}if(SP(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(t(317));e:{for(u=u.nextSibling,d=0;u;){if(u.nodeType===8){var p=u.data;if(p==="/$"){if(d===0){ra=Pc(u.nextSibling);break e}d--}else p!=="$"&&p!=="$!"&&p!=="$?"||d++}u=u.nextSibling}ra=null}}else ra=na?Pc(u.stateNode.nextSibling):null;return!0}function TP(){for(var u=ra;u;)u=Pc(u.nextSibling)}function ff(){ra=na=null,xr=!1}function w2(u){Qa===null?Qa=[u]:Qa.push(u)}var Xz=M.ReactCurrentBatchConfig;function Xg(u,d,p){if(u=p.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(t(309));var E=p.stateNode}if(!E)throw Error(t(147,u));var S=E,I=""+u;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===I?d.ref:(d=function(U){var se=S.refs;U===null?delete se[I]:se[I]=U},d._stringRef=I,d)}if(typeof u!="string")throw Error(t(284));if(!p._owner)throw Error(t(290,u))}return u}function Bx(u,d){throw u=Object.prototype.toString.call(d),Error(t(31,u==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":u))}function bP(u){var d=u._init;return d(u._payload)}function RP(u){function d(fe,le){if(u){var Se=fe.deletions;Se===null?(fe.deletions=[le],fe.flags|=16):Se.push(le)}}function p(fe,le){if(!u)return null;for(;le!==null;)d(fe,le),le=le.sibling;return null}function E(fe,le){for(fe=new Map;le!==null;)le.key!==null?fe.set(le.key,le):fe.set(le.index,le),le=le.sibling;return fe}function S(fe,le){return fe=zc(fe,le),fe.index=0,fe.sibling=null,fe}function I(fe,le,Se){return fe.index=Se,u?(Se=fe.alternate,Se!==null?(Se=Se.index,Se<le?(fe.flags|=2,le):Se):(fe.flags|=2,le)):(fe.flags|=1048576,le)}function U(fe){return u&&fe.alternate===null&&(fe.flags|=2),fe}function se(fe,le,Se,rt){return le===null||le.tag!==6?(le=dS(Se,fe.mode,rt),le.return=fe,le):(le=S(le,Se),le.return=fe,le)}function oe(fe,le,Se,rt){var Nt=Se.type;return Nt===k?qe(fe,le,Se.props.children,rt,Se.key):le!==null&&(le.elementType===Nt||typeof Nt=="object"&&Nt!==null&&Nt.$$typeof===Ge&&bP(Nt)===le.type)?(rt=S(le,Se.props),rt.ref=Xg(fe,le,Se),rt.return=fe,rt):(rt=uy(Se.type,Se.key,Se.props,null,fe.mode,rt),rt.ref=Xg(fe,le,Se),rt.return=fe,rt)}function Ae(fe,le,Se,rt){return le===null||le.tag!==4||le.stateNode.containerInfo!==Se.containerInfo||le.stateNode.implementation!==Se.implementation?(le=fS(Se,fe.mode,rt),le.return=fe,le):(le=S(le,Se.children||[]),le.return=fe,le)}function qe(fe,le,Se,rt,Nt){return le===null||le.tag!==7?(le=_h(Se,fe.mode,rt,Nt),le.return=fe,le):(le=S(le,Se),le.return=fe,le)}function Qe(fe,le,Se){if(typeof le=="string"&&le!==""||typeof le=="number")return le=dS(""+le,fe.mode,Se),le.return=fe,le;if(typeof le=="object"&&le!==null){switch(le.$$typeof){case D:return Se=uy(le.type,le.key,le.props,null,fe.mode,Se),Se.ref=Xg(fe,null,le),Se.return=fe,Se;case B:return le=fS(le,fe.mode,Se),le.return=fe,le;case Ge:var rt=le._init;return Qe(fe,rt(le._payload),Se)}if(un(le)||ke(le))return le=_h(le,fe.mode,Se,null),le.return=fe,le;Bx(fe,le)}return null}function Ke(fe,le,Se,rt){var Nt=le!==null?le.key:null;if(typeof Se=="string"&&Se!==""||typeof Se=="number")return Nt!==null?null:se(fe,le,""+Se,rt);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case D:return Se.key===Nt?oe(fe,le,Se,rt):null;case B:return Se.key===Nt?Ae(fe,le,Se,rt):null;case Ge:return Nt=Se._init,Ke(fe,le,Nt(Se._payload),rt)}if(un(Se)||ke(Se))return Nt!==null?null:qe(fe,le,Se,rt,null);Bx(fe,Se)}return null}function vt(fe,le,Se,rt,Nt){if(typeof rt=="string"&&rt!==""||typeof rt=="number")return fe=fe.get(Se)||null,se(le,fe,""+rt,Nt);if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case D:return fe=fe.get(rt.key===null?Se:rt.key)||null,oe(le,fe,rt,Nt);case B:return fe=fe.get(rt.key===null?Se:rt.key)||null,Ae(le,fe,rt,Nt);case Ge:var zt=rt._init;return vt(fe,le,Se,zt(rt._payload),Nt)}if(un(rt)||ke(rt))return fe=fe.get(Se)||null,qe(le,fe,rt,Nt,null);Bx(le,rt)}return null}function At(fe,le,Se,rt){for(var Nt=null,zt=null,Ut=le,Yt=le=0,vi=null;Ut!==null&&Yt<Se.length;Yt++){Ut.index>Yt?(vi=Ut,Ut=null):vi=Ut.sibling;var Cn=Ke(fe,Ut,Se[Yt],rt);if(Cn===null){Ut===null&&(Ut=vi);break}u&&Ut&&Cn.alternate===null&&d(fe,Ut),le=I(Cn,le,Yt),zt===null?Nt=Cn:zt.sibling=Cn,zt=Cn,Ut=vi}if(Yt===Se.length)return p(fe,Ut),xr&&hh(fe,Yt),Nt;if(Ut===null){for(;Yt<Se.length;Yt++)Ut=Qe(fe,Se[Yt],rt),Ut!==null&&(le=I(Ut,le,Yt),zt===null?Nt=Ut:zt.sibling=Ut,zt=Ut);return xr&&hh(fe,Yt),Nt}for(Ut=E(fe,Ut);Yt<Se.length;Yt++)vi=vt(Ut,fe,Yt,Se[Yt],rt),vi!==null&&(u&&vi.alternate!==null&&Ut.delete(vi.key===null?Yt:vi.key),le=I(vi,le,Yt),zt===null?Nt=vi:zt.sibling=vi,zt=vi);return u&&Ut.forEach(function(Uc){return d(fe,Uc)}),xr&&hh(fe,Yt),Nt}function Ct(fe,le,Se,rt){var Nt=ke(Se);if(typeof Nt!="function")throw Error(t(150));if(Se=Nt.call(Se),Se==null)throw Error(t(151));for(var zt=Nt=null,Ut=le,Yt=le=0,vi=null,Cn=Se.next();Ut!==null&&!Cn.done;Yt++,Cn=Se.next()){Ut.index>Yt?(vi=Ut,Ut=null):vi=Ut.sibling;var Uc=Ke(fe,Ut,Cn.value,rt);if(Uc===null){Ut===null&&(Ut=vi);break}u&&Ut&&Uc.alternate===null&&d(fe,Ut),le=I(Uc,le,Yt),zt===null?Nt=Uc:zt.sibling=Uc,zt=Uc,Ut=vi}if(Cn.done)return p(fe,Ut),xr&&hh(fe,Yt),Nt;if(Ut===null){for(;!Cn.done;Yt++,Cn=Se.next())Cn=Qe(fe,Cn.value,rt),Cn!==null&&(le=I(Cn,le,Yt),zt===null?Nt=Cn:zt.sibling=Cn,zt=Cn);return xr&&hh(fe,Yt),Nt}for(Ut=E(fe,Ut);!Cn.done;Yt++,Cn=Se.next())Cn=vt(Ut,fe,Yt,Cn.value,rt),Cn!==null&&(u&&Cn.alternate!==null&&Ut.delete(Cn.key===null?Yt:Cn.key),le=I(Cn,le,Yt),zt===null?Nt=Cn:zt.sibling=Cn,zt=Cn);return u&&Ut.forEach(function(AU){return d(fe,AU)}),xr&&hh(fe,Yt),Nt}function Ur(fe,le,Se,rt){if(typeof Se=="object"&&Se!==null&&Se.type===k&&Se.key===null&&(Se=Se.props.children),typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case D:e:{for(var Nt=Se.key,zt=le;zt!==null;){if(zt.key===Nt){if(Nt=Se.type,Nt===k){if(zt.tag===7){p(fe,zt.sibling),le=S(zt,Se.props.children),le.return=fe,fe=le;break e}}else if(zt.elementType===Nt||typeof Nt=="object"&&Nt!==null&&Nt.$$typeof===Ge&&bP(Nt)===zt.type){p(fe,zt.sibling),le=S(zt,Se.props),le.ref=Xg(fe,zt,Se),le.return=fe,fe=le;break e}p(fe,zt);break}else d(fe,zt);zt=zt.sibling}Se.type===k?(le=_h(Se.props.children,fe.mode,rt,Se.key),le.return=fe,fe=le):(rt=uy(Se.type,Se.key,Se.props,null,fe.mode,rt),rt.ref=Xg(fe,le,Se),rt.return=fe,fe=rt)}return U(fe);case B:e:{for(zt=Se.key;le!==null;){if(le.key===zt)if(le.tag===4&&le.stateNode.containerInfo===Se.containerInfo&&le.stateNode.implementation===Se.implementation){p(fe,le.sibling),le=S(le,Se.children||[]),le.return=fe,fe=le;break e}else{p(fe,le);break}else d(fe,le);le=le.sibling}le=fS(Se,fe.mode,rt),le.return=fe,fe=le}return U(fe);case Ge:return zt=Se._init,Ur(fe,le,zt(Se._payload),rt)}if(un(Se))return At(fe,le,Se,rt);if(ke(Se))return Ct(fe,le,Se,rt);Bx(fe,Se)}return typeof Se=="string"&&Se!==""||typeof Se=="number"?(Se=""+Se,le!==null&&le.tag===6?(p(fe,le.sibling),le=S(le,Se),le.return=fe,fe=le):(p(fe,le),le=dS(Se,fe.mode,rt),le.return=fe,fe=le),U(fe)):p(fe,le)}return Ur}var gf=RP(!0),AP=RP(!1),Gx=Nc(null),zx=null,mf=null,E2=null;function S2(){E2=mf=zx=null}function T2(u){var d=Gx.current;dr(Gx),u._currentValue=d}function b2(u,d,p){for(;u!==null;){var E=u.alternate;if((u.childLanes&d)!==d?(u.childLanes|=d,E!==null&&(E.childLanes|=d)):E!==null&&(E.childLanes&d)!==d&&(E.childLanes|=d),u===p)break;u=u.return}}function pf(u,d){zx=u,E2=mf=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&d)!==0&&(Cs=!0),u.firstContext=null)}function Sa(u){var d=u._currentValue;if(E2!==u)if(u={context:u,memoizedValue:d,next:null},mf===null){if(zx===null)throw Error(t(308));mf=u,zx.dependencies={lanes:0,firstContext:u}}else mf=mf.next=u;return d}var dh=null;function R2(u){dh===null?dh=[u]:dh.push(u)}function kP(u,d,p,E){var S=d.interleaved;return S===null?(p.next=p,R2(d)):(p.next=S.next,S.next=p),d.interleaved=p,Nl(u,E)}function Nl(u,d){u.lanes|=d;var p=u.alternate;for(p!==null&&(p.lanes|=d),p=u,u=u.return;u!==null;)u.childLanes|=d,p=u.alternate,p!==null&&(p.childLanes|=d),p=u,u=u.return;return p.tag===3?p.stateNode:null}var Oc=!1;function A2(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function IP(u,d){u=u.updateQueue,d.updateQueue===u&&(d.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function Ml(u,d){return{eventTime:u,lane:d,tag:0,payload:null,callback:null,next:null}}function Dc(u,d,p){var E=u.updateQueue;if(E===null)return null;if(E=E.shared,(kn&2)!==0){var S=E.pending;return S===null?d.next=d:(d.next=S.next,S.next=d),E.pending=d,Nl(u,p)}return S=E.interleaved,S===null?(d.next=d,R2(E)):(d.next=S.next,S.next=d),E.interleaved=d,Nl(u,p)}function Ux(u,d,p){if(d=d.updateQueue,d!==null&&(d=d.shared,(p&4194240)!==0)){var E=d.lanes;E&=u.pendingLanes,p|=E,d.lanes=p,Ig(u,p)}}function CP(u,d){var p=u.updateQueue,E=u.alternate;if(E!==null&&(E=E.updateQueue,p===E)){var S=null,I=null;if(p=p.firstBaseUpdate,p!==null){do{var U={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};I===null?S=I=U:I=I.next=U,p=p.next}while(p!==null);I===null?S=I=d:I=I.next=d}else S=I=d;p={baseState:E.baseState,firstBaseUpdate:S,lastBaseUpdate:I,shared:E.shared,effects:E.effects},u.updateQueue=p;return}u=p.lastBaseUpdate,u===null?p.firstBaseUpdate=d:u.next=d,p.lastBaseUpdate=d}function $x(u,d,p,E){var S=u.updateQueue;Oc=!1;var I=S.firstBaseUpdate,U=S.lastBaseUpdate,se=S.shared.pending;if(se!==null){S.shared.pending=null;var oe=se,Ae=oe.next;oe.next=null,U===null?I=Ae:U.next=Ae,U=oe;var qe=u.alternate;qe!==null&&(qe=qe.updateQueue,se=qe.lastBaseUpdate,se!==U&&(se===null?qe.firstBaseUpdate=Ae:se.next=Ae,qe.lastBaseUpdate=oe))}if(I!==null){var Qe=S.baseState;U=0,qe=Ae=oe=null,se=I;do{var Ke=se.lane,vt=se.eventTime;if((E&Ke)===Ke){qe!==null&&(qe=qe.next={eventTime:vt,lane:0,tag:se.tag,payload:se.payload,callback:se.callback,next:null});e:{var At=u,Ct=se;switch(Ke=d,vt=p,Ct.tag){case 1:if(At=Ct.payload,typeof At=="function"){Qe=At.call(vt,Qe,Ke);break e}Qe=At;break e;case 3:At.flags=At.flags&-65537|128;case 0:if(At=Ct.payload,Ke=typeof At=="function"?At.call(vt,Qe,Ke):At,Ke==null)break e;Qe=ae({},Qe,Ke);break e;case 2:Oc=!0}}se.callback!==null&&se.lane!==0&&(u.flags|=64,Ke=S.effects,Ke===null?S.effects=[se]:Ke.push(se))}else vt={eventTime:vt,lane:Ke,tag:se.tag,payload:se.payload,callback:se.callback,next:null},qe===null?(Ae=qe=vt,oe=Qe):qe=qe.next=vt,U|=Ke;if(se=se.next,se===null){if(se=S.shared.pending,se===null)break;Ke=se,se=Ke.next,Ke.next=null,S.lastBaseUpdate=Ke,S.shared.pending=null}}while(!0);if(qe===null&&(oe=Qe),S.baseState=oe,S.firstBaseUpdate=Ae,S.lastBaseUpdate=qe,d=S.shared.interleaved,d!==null){S=d;do U|=S.lane,S=S.next;while(S!==d)}else I===null&&(S.shared.lanes=0);mh|=U,u.lanes=U,u.memoizedState=Qe}}function PP(u,d,p){if(u=d.effects,d.effects=null,u!==null)for(d=0;d<u.length;d++){var E=u[d],S=E.callback;if(S!==null){if(E.callback=null,E=p,typeof S!="function")throw Error(t(191,S));S.call(E)}}}var qg={},Uo=Nc(qg),Yg=Nc(qg),Zg=Nc(qg);function fh(u){if(u===qg)throw Error(t(174));return u}function k2(u,d){switch(cr(Zg,d),cr(Yg,u),cr(Uo,qg),u=d.nodeType,u){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:xn(null,"");break;default:u=u===8?d.parentNode:d,d=u.namespaceURI||null,u=u.tagName,d=xn(d,u)}dr(Uo),cr(Uo,d)}function xf(){dr(Uo),dr(Yg),dr(Zg)}function NP(u){fh(Zg.current);var d=fh(Uo.current),p=xn(d,u.type);d!==p&&(cr(Yg,u),cr(Uo,p))}function I2(u){Yg.current===u&&(dr(Uo),dr(Yg))}var Rr=Nc(0);function Wx(u){for(var d=u;d!==null;){if(d.tag===13){var p=d.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var C2=[];function P2(){for(var u=0;u<C2.length;u++)C2[u]._workInProgressVersionPrimary=null;C2.length=0}var Hx=M.ReactCurrentDispatcher,N2=M.ReactCurrentBatchConfig,gh=0,Ar=null,ci=null,yi=null,Kx=!1,Jg=!1,Qg=0,qz=0;function es(){throw Error(t(321))}function M2(u,d){if(d===null)return!1;for(var p=0;p<d.length&&p<u.length;p++)if(!Ja(u[p],d[p]))return!1;return!0}function L2(u,d,p,E,S,I){if(gh=I,Ar=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,Hx.current=u===null||u.memoizedState===null?Qz:eU,u=p(E,S),Jg){I=0;do{if(Jg=!1,Qg=0,25<=I)throw Error(t(301));I+=1,yi=ci=null,d.updateQueue=null,Hx.current=tU,u=p(E,S)}while(Jg)}if(Hx.current=Yx,d=ci!==null&&ci.next!==null,gh=0,yi=ci=Ar=null,Kx=!1,d)throw Error(t(300));return u}function O2(){var u=Qg!==0;return Qg=0,u}function $o(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yi===null?Ar.memoizedState=yi=u:yi=yi.next=u,yi}function Ta(){if(ci===null){var u=Ar.alternate;u=u!==null?u.memoizedState:null}else u=ci.next;var d=yi===null?Ar.memoizedState:yi.next;if(d!==null)yi=d,ci=u;else{if(u===null)throw Error(t(310));ci=u,u={memoizedState:ci.memoizedState,baseState:ci.baseState,baseQueue:ci.baseQueue,queue:ci.queue,next:null},yi===null?Ar.memoizedState=yi=u:yi=yi.next=u}return yi}function em(u,d){return typeof d=="function"?d(u):d}function D2(u){var d=Ta(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=u;var E=ci,S=E.baseQueue,I=p.pending;if(I!==null){if(S!==null){var U=S.next;S.next=I.next,I.next=U}E.baseQueue=S=I,p.pending=null}if(S!==null){I=S.next,E=E.baseState;var se=U=null,oe=null,Ae=I;do{var qe=Ae.lane;if((gh&qe)===qe)oe!==null&&(oe=oe.next={lane:0,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null}),E=Ae.hasEagerState?Ae.eagerState:u(E,Ae.action);else{var Qe={lane:qe,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null};oe===null?(se=oe=Qe,U=E):oe=oe.next=Qe,Ar.lanes|=qe,mh|=qe}Ae=Ae.next}while(Ae!==null&&Ae!==I);oe===null?U=E:oe.next=se,Ja(E,d.memoizedState)||(Cs=!0),d.memoizedState=E,d.baseState=U,d.baseQueue=oe,p.lastRenderedState=E}if(u=p.interleaved,u!==null){S=u;do I=S.lane,Ar.lanes|=I,mh|=I,S=S.next;while(S!==u)}else S===null&&(p.lanes=0);return[d.memoizedState,p.dispatch]}function j2(u){var d=Ta(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=u;var E=p.dispatch,S=p.pending,I=d.memoizedState;if(S!==null){p.pending=null;var U=S=S.next;do I=u(I,U.action),U=U.next;while(U!==S);Ja(I,d.memoizedState)||(Cs=!0),d.memoizedState=I,d.baseQueue===null&&(d.baseState=I),p.lastRenderedState=I}return[I,E]}function MP(){}function LP(u,d){var p=Ar,E=Ta(),S=d(),I=!Ja(E.memoizedState,S);if(I&&(E.memoizedState=S,Cs=!0),E=E.queue,F2(jP.bind(null,p,E,u),[u]),E.getSnapshot!==d||I||yi!==null&&yi.memoizedState.tag&1){if(p.flags|=2048,tm(9,DP.bind(null,p,E,S,d),void 0,null),_i===null)throw Error(t(349));(gh&30)!==0||OP(p,d,S)}return S}function OP(u,d,p){u.flags|=16384,u={getSnapshot:d,value:p},d=Ar.updateQueue,d===null?(d={lastEffect:null,stores:null},Ar.updateQueue=d,d.stores=[u]):(p=d.stores,p===null?d.stores=[u]:p.push(u))}function DP(u,d,p,E){d.value=p,d.getSnapshot=E,FP(d)&&VP(u)}function jP(u,d,p){return p(function(){FP(d)&&VP(u)})}function FP(u){var d=u.getSnapshot;u=u.value;try{var p=d();return!Ja(u,p)}catch{return!0}}function VP(u){var d=Nl(u,1);d!==null&&ro(d,u,1,-1)}function BP(u){var d=$o();return typeof u=="function"&&(u=u()),d.memoizedState=d.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:em,lastRenderedState:u},d.queue=u,u=u.dispatch=Jz.bind(null,Ar,u),[d.memoizedState,u]}function tm(u,d,p,E){return u={tag:u,create:d,destroy:p,deps:E,next:null},d=Ar.updateQueue,d===null?(d={lastEffect:null,stores:null},Ar.updateQueue=d,d.lastEffect=u.next=u):(p=d.lastEffect,p===null?d.lastEffect=u.next=u:(E=p.next,p.next=u,u.next=E,d.lastEffect=u)),u}function GP(){return Ta().memoizedState}function Xx(u,d,p,E){var S=$o();Ar.flags|=u,S.memoizedState=tm(1|d,p,void 0,E===void 0?null:E)}function qx(u,d,p,E){var S=Ta();E=E===void 0?null:E;var I=void 0;if(ci!==null){var U=ci.memoizedState;if(I=U.destroy,E!==null&&M2(E,U.deps)){S.memoizedState=tm(d,p,I,E);return}}Ar.flags|=u,S.memoizedState=tm(1|d,p,I,E)}function zP(u,d){return Xx(8390656,8,u,d)}function F2(u,d){return qx(2048,8,u,d)}function UP(u,d){return qx(4,2,u,d)}function $P(u,d){return qx(4,4,u,d)}function WP(u,d){if(typeof d=="function")return u=u(),d(u),function(){d(null)};if(d!=null)return u=u(),d.current=u,function(){d.current=null}}function HP(u,d,p){return p=p!=null?p.concat([u]):null,qx(4,4,WP.bind(null,d,u),p)}function V2(){}function KP(u,d){var p=Ta();d=d===void 0?null:d;var E=p.memoizedState;return E!==null&&d!==null&&M2(d,E[1])?E[0]:(p.memoizedState=[u,d],u)}function XP(u,d){var p=Ta();d=d===void 0?null:d;var E=p.memoizedState;return E!==null&&d!==null&&M2(d,E[1])?E[0]:(u=u(),p.memoizedState=[u,d],u)}function qP(u,d,p){return(gh&21)===0?(u.baseState&&(u.baseState=!1,Cs=!0),u.memoizedState=p):(Ja(p,d)||(p=Ag(),Ar.lanes|=p,mh|=p,u.baseState=!0),d)}function Yz(u,d){var p=En;En=p!==0&&4>p?p:4,u(!0);var E=N2.transition;N2.transition={};try{u(!1),d()}finally{En=p,N2.transition=E}}function YP(){return Ta().memoizedState}function Zz(u,d,p){var E=Bc(u);if(p={lane:E,action:p,hasEagerState:!1,eagerState:null,next:null},ZP(u))JP(d,p);else if(p=kP(u,d,p,E),p!==null){var S=ys();ro(p,u,E,S),QP(p,d,E)}}function Jz(u,d,p){var E=Bc(u),S={lane:E,action:p,hasEagerState:!1,eagerState:null,next:null};if(ZP(u))JP(d,S);else{var I=u.alternate;if(u.lanes===0&&(I===null||I.lanes===0)&&(I=d.lastRenderedReducer,I!==null))try{var U=d.lastRenderedState,se=I(U,p);if(S.hasEagerState=!0,S.eagerState=se,Ja(se,U)){var oe=d.interleaved;oe===null?(S.next=S,R2(d)):(S.next=oe.next,oe.next=S),d.interleaved=S;return}}catch{}p=kP(u,d,S,E),p!==null&&(S=ys(),ro(p,u,E,S),QP(p,d,E))}}function ZP(u){var d=u.alternate;return u===Ar||d!==null&&d===Ar}function JP(u,d){Jg=Kx=!0;var p=u.pending;p===null?d.next=d:(d.next=p.next,p.next=d),u.pending=d}function QP(u,d,p){if((p&4194240)!==0){var E=d.lanes;E&=u.pendingLanes,p|=E,d.lanes=p,Ig(u,p)}}var Yx={readContext:Sa,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useInsertionEffect:es,useLayoutEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useMutableSource:es,useSyncExternalStore:es,useId:es,unstable_isNewReconciler:!1},Qz={readContext:Sa,useCallback:function(u,d){return $o().memoizedState=[u,d===void 0?null:d],u},useContext:Sa,useEffect:zP,useImperativeHandle:function(u,d,p){return p=p!=null?p.concat([u]):null,Xx(4194308,4,WP.bind(null,d,u),p)},useLayoutEffect:function(u,d){return Xx(4194308,4,u,d)},useInsertionEffect:function(u,d){return Xx(4,2,u,d)},useMemo:function(u,d){var p=$o();return d=d===void 0?null:d,u=u(),p.memoizedState=[u,d],u},useReducer:function(u,d,p){var E=$o();return d=p!==void 0?p(d):d,E.memoizedState=E.baseState=d,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:d},E.queue=u,u=u.dispatch=Zz.bind(null,Ar,u),[E.memoizedState,u]},useRef:function(u){var d=$o();return u={current:u},d.memoizedState=u},useState:BP,useDebugValue:V2,useDeferredValue:function(u){return $o().memoizedState=u},useTransition:function(){var u=BP(!1),d=u[0];return u=Yz.bind(null,u[1]),$o().memoizedState=u,[d,u]},useMutableSource:function(){},useSyncExternalStore:function(u,d,p){var E=Ar,S=$o();if(xr){if(p===void 0)throw Error(t(407));p=p()}else{if(p=d(),_i===null)throw Error(t(349));(gh&30)!==0||OP(E,d,p)}S.memoizedState=p;var I={value:p,getSnapshot:d};return S.queue=I,zP(jP.bind(null,E,I,u),[u]),E.flags|=2048,tm(9,DP.bind(null,E,I,p,d),void 0,null),p},useId:function(){var u=$o(),d=_i.identifierPrefix;if(xr){var p=Pl,E=Cl;p=(E&~(1<<32-br(E)-1)).toString(32)+p,d=":"+d+"R"+p,p=Qg++,0<p&&(d+="H"+p.toString(32)),d+=":"}else p=qz++,d=":"+d+"r"+p.toString(32)+":";return u.memoizedState=d},unstable_isNewReconciler:!1},eU={readContext:Sa,useCallback:KP,useContext:Sa,useEffect:F2,useImperativeHandle:HP,useInsertionEffect:UP,useLayoutEffect:$P,useMemo:XP,useReducer:D2,useRef:GP,useState:function(){return D2(em)},useDebugValue:V2,useDeferredValue:function(u){var d=Ta();return qP(d,ci.memoizedState,u)},useTransition:function(){var u=D2(em)[0],d=Ta().memoizedState;return[u,d]},useMutableSource:MP,useSyncExternalStore:LP,useId:YP,unstable_isNewReconciler:!1},tU={readContext:Sa,useCallback:KP,useContext:Sa,useEffect:F2,useImperativeHandle:HP,useInsertionEffect:UP,useLayoutEffect:$P,useMemo:XP,useReducer:j2,useRef:GP,useState:function(){return j2(em)},useDebugValue:V2,useDeferredValue:function(u){var d=Ta();return ci===null?d.memoizedState=u:qP(d,ci.memoizedState,u)},useTransition:function(){var u=j2(em)[0],d=Ta().memoizedState;return[u,d]},useMutableSource:MP,useSyncExternalStore:LP,useId:YP,unstable_isNewReconciler:!1};function eo(u,d){if(u&&u.defaultProps){d=ae({},d),u=u.defaultProps;for(var p in u)d[p]===void 0&&(d[p]=u[p]);return d}return d}function B2(u,d,p,E){d=u.memoizedState,p=p(E,d),p=p==null?d:ae({},d,p),u.memoizedState=p,u.lanes===0&&(u.updateQueue.baseState=p)}var Zx={isMounted:function(u){return(u=u._reactInternals)?ne(u)===u:!1},enqueueSetState:function(u,d,p){u=u._reactInternals;var E=ys(),S=Bc(u),I=Ml(E,S);I.payload=d,p!=null&&(I.callback=p),d=Dc(u,I,S),d!==null&&(ro(d,u,S,E),Ux(d,u,S))},enqueueReplaceState:function(u,d,p){u=u._reactInternals;var E=ys(),S=Bc(u),I=Ml(E,S);I.tag=1,I.payload=d,p!=null&&(I.callback=p),d=Dc(u,I,S),d!==null&&(ro(d,u,S,E),Ux(d,u,S))},enqueueForceUpdate:function(u,d){u=u._reactInternals;var p=ys(),E=Bc(u),S=Ml(p,E);S.tag=2,d!=null&&(S.callback=d),d=Dc(u,S,E),d!==null&&(ro(d,u,E,p),Ux(d,u,E))}};function e4(u,d,p,E,S,I,U){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(E,I,U):d.prototype&&d.prototype.isPureReactComponent?!Gg(p,E)||!Gg(S,I):!0}function t4(u,d,p){var E=!1,S=Mc,I=d.contextType;return typeof I=="object"&&I!==null?I=Sa(I):(S=Is(d)?ch:Qi.current,E=d.contextTypes,I=(E=E!=null)?uf(u,S):Mc),d=new d(p,I),u.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=Zx,u.stateNode=d,d._reactInternals=u,E&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=S,u.__reactInternalMemoizedMaskedChildContext=I),d}function n4(u,d,p,E){u=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(p,E),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(p,E),d.state!==u&&Zx.enqueueReplaceState(d,d.state,null)}function G2(u,d,p,E){var S=u.stateNode;S.props=p,S.state=u.memoizedState,S.refs={},A2(u);var I=d.contextType;typeof I=="object"&&I!==null?S.context=Sa(I):(I=Is(d)?ch:Qi.current,S.context=uf(u,I)),S.state=u.memoizedState,I=d.getDerivedStateFromProps,typeof I=="function"&&(B2(u,d,I,p),S.state=u.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(d=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),d!==S.state&&Zx.enqueueReplaceState(S,S.state,null),$x(u,p,S,E),S.state=u.memoizedState),typeof S.componentDidMount=="function"&&(u.flags|=4194308)}function yf(u,d){try{var p="",E=d;do p+=re(E),E=E.return;while(E);var S=p}catch(I){S=`
Error generating stack: `+I.message+`
`+I.stack}return{value:u,source:d,stack:S,digest:null}}function z2(u,d,p){return{value:u,source:null,stack:p??null,digest:d??null}}function U2(u,d){try{console.error(d.value)}catch(p){setTimeout(function(){throw p})}}var nU=typeof WeakMap=="function"?WeakMap:Map;function r4(u,d,p){p=Ml(-1,p),p.tag=3,p.payload={element:null};var E=d.value;return p.callback=function(){iy||(iy=!0,iS=E),U2(u,d)},p}function i4(u,d,p){p=Ml(-1,p),p.tag=3;var E=u.type.getDerivedStateFromError;if(typeof E=="function"){var S=d.value;p.payload=function(){return E(S)},p.callback=function(){U2(u,d)}}var I=u.stateNode;return I!==null&&typeof I.componentDidCatch=="function"&&(p.callback=function(){U2(u,d),typeof E!="function"&&(Fc===null?Fc=new Set([this]):Fc.add(this));var U=d.stack;this.componentDidCatch(d.value,{componentStack:U!==null?U:""})}),p}function s4(u,d,p){var E=u.pingCache;if(E===null){E=u.pingCache=new nU;var S=new Set;E.set(d,S)}else S=E.get(d),S===void 0&&(S=new Set,E.set(d,S));S.has(p)||(S.add(p),u=pU.bind(null,u,d,p),d.then(u,u))}function a4(u){do{var d;if((d=u.tag===13)&&(d=u.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return u;u=u.return}while(u!==null);return null}function o4(u,d,p,E,S){return(u.mode&1)===0?(u===d?u.flags|=65536:(u.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(d=Ml(-1,1),d.tag=2,Dc(p,d,1))),p.lanes|=1),u):(u.flags|=65536,u.lanes=S,u)}var rU=M.ReactCurrentOwner,Cs=!1;function xs(u,d,p,E){d.child=u===null?AP(d,null,p,E):gf(d,u.child,p,E)}function l4(u,d,p,E,S){p=p.render;var I=d.ref;return pf(d,S),E=L2(u,d,p,E,I,S),p=O2(),u!==null&&!Cs?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~S,Ll(u,d,S)):(xr&&p&&x2(d),d.flags|=1,xs(u,d,E,S),d.child)}function c4(u,d,p,E,S){if(u===null){var I=p.type;return typeof I=="function"&&!hS(I)&&I.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(d.tag=15,d.type=I,u4(u,d,I,E,S)):(u=uy(p.type,null,E,d,d.mode,S),u.ref=d.ref,u.return=d,d.child=u)}if(I=u.child,(u.lanes&S)===0){var U=I.memoizedProps;if(p=p.compare,p=p!==null?p:Gg,p(U,E)&&u.ref===d.ref)return Ll(u,d,S)}return d.flags|=1,u=zc(I,E),u.ref=d.ref,u.return=d,d.child=u}function u4(u,d,p,E,S){if(u!==null){var I=u.memoizedProps;if(Gg(I,E)&&u.ref===d.ref)if(Cs=!1,d.pendingProps=E=I,(u.lanes&S)!==0)(u.flags&131072)!==0&&(Cs=!0);else return d.lanes=u.lanes,Ll(u,d,S)}return $2(u,d,p,E,S)}function h4(u,d,p){var E=d.pendingProps,S=E.children,I=u!==null?u.memoizedState:null;if(E.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},cr(vf,ia),ia|=p;else{if((p&1073741824)===0)return u=I!==null?I.baseLanes|p:p,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:u,cachePool:null,transitions:null},d.updateQueue=null,cr(vf,ia),ia|=u,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},E=I!==null?I.baseLanes:p,cr(vf,ia),ia|=E}else I!==null?(E=I.baseLanes|p,d.memoizedState=null):E=p,cr(vf,ia),ia|=E;return xs(u,d,S,p),d.child}function d4(u,d){var p=d.ref;(u===null&&p!==null||u!==null&&u.ref!==p)&&(d.flags|=512,d.flags|=2097152)}function $2(u,d,p,E,S){var I=Is(p)?ch:Qi.current;return I=uf(d,I),pf(d,S),p=L2(u,d,p,E,I,S),E=O2(),u!==null&&!Cs?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~S,Ll(u,d,S)):(xr&&E&&x2(d),d.flags|=1,xs(u,d,p,S),d.child)}function f4(u,d,p,E,S){if(Is(p)){var I=!0;Ox(d)}else I=!1;if(pf(d,S),d.stateNode===null)Qx(u,d),t4(d,p,E),G2(d,p,E,S),E=!0;else if(u===null){var U=d.stateNode,se=d.memoizedProps;U.props=se;var oe=U.context,Ae=p.contextType;typeof Ae=="object"&&Ae!==null?Ae=Sa(Ae):(Ae=Is(p)?ch:Qi.current,Ae=uf(d,Ae));var qe=p.getDerivedStateFromProps,Qe=typeof qe=="function"||typeof U.getSnapshotBeforeUpdate=="function";Qe||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(se!==E||oe!==Ae)&&n4(d,U,E,Ae),Oc=!1;var Ke=d.memoizedState;U.state=Ke,$x(d,E,U,S),oe=d.memoizedState,se!==E||Ke!==oe||ks.current||Oc?(typeof qe=="function"&&(B2(d,p,qe,E),oe=d.memoizedState),(se=Oc||e4(d,p,se,E,Ke,oe,Ae))?(Qe||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(d.flags|=4194308)):(typeof U.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=E,d.memoizedState=oe),U.props=E,U.state=oe,U.context=Ae,E=se):(typeof U.componentDidMount=="function"&&(d.flags|=4194308),E=!1)}else{U=d.stateNode,IP(u,d),se=d.memoizedProps,Ae=d.type===d.elementType?se:eo(d.type,se),U.props=Ae,Qe=d.pendingProps,Ke=U.context,oe=p.contextType,typeof oe=="object"&&oe!==null?oe=Sa(oe):(oe=Is(p)?ch:Qi.current,oe=uf(d,oe));var vt=p.getDerivedStateFromProps;(qe=typeof vt=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(se!==Qe||Ke!==oe)&&n4(d,U,E,oe),Oc=!1,Ke=d.memoizedState,U.state=Ke,$x(d,E,U,S);var At=d.memoizedState;se!==Qe||Ke!==At||ks.current||Oc?(typeof vt=="function"&&(B2(d,p,vt,E),At=d.memoizedState),(Ae=Oc||e4(d,p,Ae,E,Ke,At,oe)||!1)?(qe||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(E,At,oe),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(E,At,oe)),typeof U.componentDidUpdate=="function"&&(d.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof U.componentDidUpdate!="function"||se===u.memoizedProps&&Ke===u.memoizedState||(d.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||se===u.memoizedProps&&Ke===u.memoizedState||(d.flags|=1024),d.memoizedProps=E,d.memoizedState=At),U.props=E,U.state=At,U.context=oe,E=Ae):(typeof U.componentDidUpdate!="function"||se===u.memoizedProps&&Ke===u.memoizedState||(d.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||se===u.memoizedProps&&Ke===u.memoizedState||(d.flags|=1024),E=!1)}return W2(u,d,p,E,I,S)}function W2(u,d,p,E,S,I){d4(u,d);var U=(d.flags&128)!==0;if(!E&&!U)return S&&yP(d,p,!1),Ll(u,d,I);E=d.stateNode,rU.current=d;var se=U&&typeof p.getDerivedStateFromError!="function"?null:E.render();return d.flags|=1,u!==null&&U?(d.child=gf(d,u.child,null,I),d.child=gf(d,null,se,I)):xs(u,d,se,I),d.memoizedState=E.state,S&&yP(d,p,!0),d.child}function g4(u){var d=u.stateNode;d.pendingContext?pP(u,d.pendingContext,d.pendingContext!==d.context):d.context&&pP(u,d.context,!1),k2(u,d.containerInfo)}function m4(u,d,p,E,S){return ff(),w2(S),d.flags|=256,xs(u,d,p,E),d.child}var H2={dehydrated:null,treeContext:null,retryLane:0};function K2(u){return{baseLanes:u,cachePool:null,transitions:null}}function p4(u,d,p){var E=d.pendingProps,S=Rr.current,I=!1,U=(d.flags&128)!==0,se;if((se=U)||(se=u!==null&&u.memoizedState===null?!1:(S&2)!==0),se?(I=!0,d.flags&=-129):(u===null||u.memoizedState!==null)&&(S|=1),cr(Rr,S&1),u===null)return v2(d),u=d.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((d.mode&1)===0?d.lanes=1:u.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(U=E.children,u=E.fallback,I?(E=d.mode,I=d.child,U={mode:"hidden",children:U},(E&1)===0&&I!==null?(I.childLanes=0,I.pendingProps=U):I=hy(U,E,0,null),u=_h(u,E,p,null),I.return=d,u.return=d,I.sibling=u,d.child=I,d.child.memoizedState=K2(p),d.memoizedState=H2,u):X2(d,U));if(S=u.memoizedState,S!==null&&(se=S.dehydrated,se!==null))return iU(u,d,U,E,se,S,p);if(I){I=E.fallback,U=d.mode,S=u.child,se=S.sibling;var oe={mode:"hidden",children:E.children};return(U&1)===0&&d.child!==S?(E=d.child,E.childLanes=0,E.pendingProps=oe,d.deletions=null):(E=zc(S,oe),E.subtreeFlags=S.subtreeFlags&14680064),se!==null?I=zc(se,I):(I=_h(I,U,p,null),I.flags|=2),I.return=d,E.return=d,E.sibling=I,d.child=E,E=I,I=d.child,U=u.child.memoizedState,U=U===null?K2(p):{baseLanes:U.baseLanes|p,cachePool:null,transitions:U.transitions},I.memoizedState=U,I.childLanes=u.childLanes&~p,d.memoizedState=H2,E}return I=u.child,u=I.sibling,E=zc(I,{mode:"visible",children:E.children}),(d.mode&1)===0&&(E.lanes=p),E.return=d,E.sibling=null,u!==null&&(p=d.deletions,p===null?(d.deletions=[u],d.flags|=16):p.push(u)),d.child=E,d.memoizedState=null,E}function X2(u,d){return d=hy({mode:"visible",children:d},u.mode,0,null),d.return=u,u.child=d}function Jx(u,d,p,E){return E!==null&&w2(E),gf(d,u.child,null,p),u=X2(d,d.pendingProps.children),u.flags|=2,d.memoizedState=null,u}function iU(u,d,p,E,S,I,U){if(p)return d.flags&256?(d.flags&=-257,E=z2(Error(t(422))),Jx(u,d,U,E)):d.memoizedState!==null?(d.child=u.child,d.flags|=128,null):(I=E.fallback,S=d.mode,E=hy({mode:"visible",children:E.children},S,0,null),I=_h(I,S,U,null),I.flags|=2,E.return=d,I.return=d,E.sibling=I,d.child=E,(d.mode&1)!==0&&gf(d,u.child,null,U),d.child.memoizedState=K2(U),d.memoizedState=H2,I);if((d.mode&1)===0)return Jx(u,d,U,null);if(S.data==="$!"){if(E=S.nextSibling&&S.nextSibling.dataset,E)var se=E.dgst;return E=se,I=Error(t(419)),E=z2(I,E,void 0),Jx(u,d,U,E)}if(se=(U&u.childLanes)!==0,Cs||se){if(E=_i,E!==null){switch(U&-U){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=(S&(E.suspendedLanes|U))!==0?0:S,S!==0&&S!==I.retryLane&&(I.retryLane=S,Nl(u,S),ro(E,u,S,-1))}return uS(),E=z2(Error(t(421))),Jx(u,d,U,E)}return S.data==="$?"?(d.flags|=128,d.child=u.child,d=xU.bind(null,u),S._reactRetry=d,null):(u=I.treeContext,ra=Pc(S.nextSibling),na=d,xr=!0,Qa=null,u!==null&&(wa[Ea++]=Cl,wa[Ea++]=Pl,wa[Ea++]=uh,Cl=u.id,Pl=u.overflow,uh=d),d=X2(d,E.children),d.flags|=4096,d)}function x4(u,d,p){u.lanes|=d;var E=u.alternate;E!==null&&(E.lanes|=d),b2(u.return,d,p)}function q2(u,d,p,E,S){var I=u.memoizedState;I===null?u.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:E,tail:p,tailMode:S}:(I.isBackwards=d,I.rendering=null,I.renderingStartTime=0,I.last=E,I.tail=p,I.tailMode=S)}function y4(u,d,p){var E=d.pendingProps,S=E.revealOrder,I=E.tail;if(xs(u,d,E.children,p),E=Rr.current,(E&2)!==0)E=E&1|2,d.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=d.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&x4(u,p,d);else if(u.tag===19)x4(u,p,d);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===d)break e;for(;u.sibling===null;){if(u.return===null||u.return===d)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}E&=1}if(cr(Rr,E),(d.mode&1)===0)d.memoizedState=null;else switch(S){case"forwards":for(p=d.child,S=null;p!==null;)u=p.alternate,u!==null&&Wx(u)===null&&(S=p),p=p.sibling;p=S,p===null?(S=d.child,d.child=null):(S=p.sibling,p.sibling=null),q2(d,!1,S,p,I);break;case"backwards":for(p=null,S=d.child,d.child=null;S!==null;){if(u=S.alternate,u!==null&&Wx(u)===null){d.child=S;break}u=S.sibling,S.sibling=p,p=S,S=u}q2(d,!0,p,null,I);break;case"together":q2(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function Qx(u,d){(d.mode&1)===0&&u!==null&&(u.alternate=null,d.alternate=null,d.flags|=2)}function Ll(u,d,p){if(u!==null&&(d.dependencies=u.dependencies),mh|=d.lanes,(p&d.childLanes)===0)return null;if(u!==null&&d.child!==u.child)throw Error(t(153));if(d.child!==null){for(u=d.child,p=zc(u,u.pendingProps),d.child=p,p.return=d;u.sibling!==null;)u=u.sibling,p=p.sibling=zc(u,u.pendingProps),p.return=d;p.sibling=null}return d.child}function sU(u,d,p){switch(d.tag){case 3:g4(d),ff();break;case 5:NP(d);break;case 1:Is(d.type)&&Ox(d);break;case 4:k2(d,d.stateNode.containerInfo);break;case 10:var E=d.type._context,S=d.memoizedProps.value;cr(Gx,E._currentValue),E._currentValue=S;break;case 13:if(E=d.memoizedState,E!==null)return E.dehydrated!==null?(cr(Rr,Rr.current&1),d.flags|=128,null):(p&d.child.childLanes)!==0?p4(u,d,p):(cr(Rr,Rr.current&1),u=Ll(u,d,p),u!==null?u.sibling:null);cr(Rr,Rr.current&1);break;case 19:if(E=(p&d.childLanes)!==0,(u.flags&128)!==0){if(E)return y4(u,d,p);d.flags|=128}if(S=d.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),cr(Rr,Rr.current),E)break;return null;case 22:case 23:return d.lanes=0,h4(u,d,p)}return Ll(u,d,p)}var _4,Y2,v4,w4;_4=function(u,d){for(var p=d.child;p!==null;){if(p.tag===5||p.tag===6)u.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},Y2=function(){},v4=function(u,d,p,E){var S=u.memoizedProps;if(S!==E){u=d.stateNode,fh(Uo.current);var I=null;switch(p){case"input":S=Dt(u,S),E=Dt(u,E),I=[];break;case"select":S=ae({},S,{value:void 0}),E=ae({},E,{value:void 0}),I=[];break;case"textarea":S=Mi(u,S),E=Mi(u,E),I=[];break;default:typeof S.onClick!="function"&&typeof E.onClick=="function"&&(u.onclick=Nx)}Tr(p,E);var U;p=null;for(Ae in S)if(!E.hasOwnProperty(Ae)&&S.hasOwnProperty(Ae)&&S[Ae]!=null)if(Ae==="style"){var se=S[Ae];for(U in se)se.hasOwnProperty(U)&&(p||(p={}),p[U]="")}else Ae!=="dangerouslySetInnerHTML"&&Ae!=="children"&&Ae!=="suppressContentEditableWarning"&&Ae!=="suppressHydrationWarning"&&Ae!=="autoFocus"&&(i.hasOwnProperty(Ae)?I||(I=[]):(I=I||[]).push(Ae,null));for(Ae in E){var oe=E[Ae];if(se=S?.[Ae],E.hasOwnProperty(Ae)&&oe!==se&&(oe!=null||se!=null))if(Ae==="style")if(se){for(U in se)!se.hasOwnProperty(U)||oe&&oe.hasOwnProperty(U)||(p||(p={}),p[U]="");for(U in oe)oe.hasOwnProperty(U)&&se[U]!==oe[U]&&(p||(p={}),p[U]=oe[U])}else p||(I||(I=[]),I.push(Ae,p)),p=oe;else Ae==="dangerouslySetInnerHTML"?(oe=oe?oe.__html:void 0,se=se?se.__html:void 0,oe!=null&&se!==oe&&(I=I||[]).push(Ae,oe)):Ae==="children"?typeof oe!="string"&&typeof oe!="number"||(I=I||[]).push(Ae,""+oe):Ae!=="suppressContentEditableWarning"&&Ae!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ae)?(oe!=null&&Ae==="onScroll"&&hr("scroll",u),I||se===oe||(I=[])):(I=I||[]).push(Ae,oe))}p&&(I=I||[]).push("style",p);var Ae=I;(d.updateQueue=Ae)&&(d.flags|=4)}},w4=function(u,d,p,E){p!==E&&(d.flags|=4)};function nm(u,d){if(!xr)switch(u.tailMode){case"hidden":d=u.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?u.tail=null:p.sibling=null;break;case"collapsed":p=u.tail;for(var E=null;p!==null;)p.alternate!==null&&(E=p),p=p.sibling;E===null?d||u.tail===null?u.tail=null:u.tail.sibling=null:E.sibling=null}}function ts(u){var d=u.alternate!==null&&u.alternate.child===u.child,p=0,E=0;if(d)for(var S=u.child;S!==null;)p|=S.lanes|S.childLanes,E|=S.subtreeFlags&14680064,E|=S.flags&14680064,S.return=u,S=S.sibling;else for(S=u.child;S!==null;)p|=S.lanes|S.childLanes,E|=S.subtreeFlags,E|=S.flags,S.return=u,S=S.sibling;return u.subtreeFlags|=E,u.childLanes=p,d}function aU(u,d,p){var E=d.pendingProps;switch(y2(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ts(d),null;case 1:return Is(d.type)&&Lx(),ts(d),null;case 3:return E=d.stateNode,xf(),dr(ks),dr(Qi),P2(),E.pendingContext&&(E.context=E.pendingContext,E.pendingContext=null),(u===null||u.child===null)&&(Vx(d)?d.flags|=4:u===null||u.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Qa!==null&&(oS(Qa),Qa=null))),Y2(u,d),ts(d),null;case 5:I2(d);var S=fh(Zg.current);if(p=d.type,u!==null&&d.stateNode!=null)v4(u,d,p,E,S),u.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!E){if(d.stateNode===null)throw Error(t(166));return ts(d),null}if(u=fh(Uo.current),Vx(d)){E=d.stateNode,p=d.type;var I=d.memoizedProps;switch(E[zo]=d,E[Hg]=I,u=(d.mode&1)!==0,p){case"dialog":hr("cancel",E),hr("close",E);break;case"iframe":case"object":case"embed":hr("load",E);break;case"video":case"audio":for(S=0;S<Ug.length;S++)hr(Ug[S],E);break;case"source":hr("error",E);break;case"img":case"image":case"link":hr("error",E),hr("load",E);break;case"details":hr("toggle",E);break;case"input":Xt(E,I),hr("invalid",E);break;case"select":E._wrapperState={wasMultiple:!!I.multiple},hr("invalid",E);break;case"textarea":Bn(E,I),hr("invalid",E)}Tr(p,I),S=null;for(var U in I)if(I.hasOwnProperty(U)){var se=I[U];U==="children"?typeof se=="string"?E.textContent!==se&&(I.suppressHydrationWarning!==!0&&Px(E.textContent,se,u),S=["children",se]):typeof se=="number"&&E.textContent!==""+se&&(I.suppressHydrationWarning!==!0&&Px(E.textContent,se,u),S=["children",""+se]):i.hasOwnProperty(U)&&se!=null&&U==="onScroll"&&hr("scroll",E)}switch(p){case"input":Fe(E),tr(E,I,!0);break;case"textarea":Fe(E),oi(E);break;case"select":case"option":break;default:typeof I.onClick=="function"&&(E.onclick=Nx)}E=S,d.updateQueue=E,E!==null&&(d.flags|=4)}else{U=S.nodeType===9?S:S.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=_t(p)),u==="http://www.w3.org/1999/xhtml"?p==="script"?(u=U.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof E.is=="string"?u=U.createElement(p,{is:E.is}):(u=U.createElement(p),p==="select"&&(U=u,E.multiple?U.multiple=!0:E.size&&(U.size=E.size))):u=U.createElementNS(u,p),u[zo]=d,u[Hg]=E,_4(u,d,!1,!1),d.stateNode=u;e:{switch(U=je(p,E),p){case"dialog":hr("cancel",u),hr("close",u),S=E;break;case"iframe":case"object":case"embed":hr("load",u),S=E;break;case"video":case"audio":for(S=0;S<Ug.length;S++)hr(Ug[S],u);S=E;break;case"source":hr("error",u),S=E;break;case"img":case"image":case"link":hr("error",u),hr("load",u),S=E;break;case"details":hr("toggle",u),S=E;break;case"input":Xt(u,E),S=Dt(u,E),hr("invalid",u);break;case"option":S=E;break;case"select":u._wrapperState={wasMultiple:!!E.multiple},S=ae({},E,{value:void 0}),hr("invalid",u);break;case"textarea":Bn(u,E),S=Mi(u,E),hr("invalid",u);break;default:S=E}Tr(p,S),se=S;for(I in se)if(se.hasOwnProperty(I)){var oe=se[I];I==="style"?li(u,oe):I==="dangerouslySetInnerHTML"?(oe=oe?oe.__html:void 0,oe!=null&&Tt(u,oe)):I==="children"?typeof oe=="string"?(p!=="textarea"||oe!=="")&&an(u,oe):typeof oe=="number"&&an(u,""+oe):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(i.hasOwnProperty(I)?oe!=null&&I==="onScroll"&&hr("scroll",u):oe!=null&&R(u,I,oe,U))}switch(p){case"input":Fe(u),tr(u,E,!1);break;case"textarea":Fe(u),oi(u);break;case"option":E.value!=null&&u.setAttribute("value",""+Be(E.value));break;case"select":u.multiple=!!E.multiple,I=E.value,I!=null?sr(u,!!E.multiple,I,!1):E.defaultValue!=null&&sr(u,!!E.multiple,E.defaultValue,!0);break;default:typeof S.onClick=="function"&&(u.onclick=Nx)}switch(p){case"button":case"input":case"select":case"textarea":E=!!E.autoFocus;break e;case"img":E=!0;break e;default:E=!1}}E&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return ts(d),null;case 6:if(u&&d.stateNode!=null)w4(u,d,u.memoizedProps,E);else{if(typeof E!="string"&&d.stateNode===null)throw Error(t(166));if(p=fh(Zg.current),fh(Uo.current),Vx(d)){if(E=d.stateNode,p=d.memoizedProps,E[zo]=d,(I=E.nodeValue!==p)&&(u=na,u!==null))switch(u.tag){case 3:Px(E.nodeValue,p,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&Px(E.nodeValue,p,(u.mode&1)!==0)}I&&(d.flags|=4)}else E=(p.nodeType===9?p:p.ownerDocument).createTextNode(E),E[zo]=d,d.stateNode=E}return ts(d),null;case 13:if(dr(Rr),E=d.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(xr&&ra!==null&&(d.mode&1)!==0&&(d.flags&128)===0)TP(),ff(),d.flags|=98560,I=!1;else if(I=Vx(d),E!==null&&E.dehydrated!==null){if(u===null){if(!I)throw Error(t(318));if(I=d.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(t(317));I[zo]=d}else ff(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;ts(d),I=!1}else Qa!==null&&(oS(Qa),Qa=null),I=!0;if(!I)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=p,d):(E=E!==null,E!==(u!==null&&u.memoizedState!==null)&&E&&(d.child.flags|=8192,(d.mode&1)!==0&&(u===null||(Rr.current&1)!==0?ui===0&&(ui=3):uS())),d.updateQueue!==null&&(d.flags|=4),ts(d),null);case 4:return xf(),Y2(u,d),u===null&&$g(d.stateNode.containerInfo),ts(d),null;case 10:return T2(d.type._context),ts(d),null;case 17:return Is(d.type)&&Lx(),ts(d),null;case 19:if(dr(Rr),I=d.memoizedState,I===null)return ts(d),null;if(E=(d.flags&128)!==0,U=I.rendering,U===null)if(E)nm(I,!1);else{if(ui!==0||u!==null&&(u.flags&128)!==0)for(u=d.child;u!==null;){if(U=Wx(u),U!==null){for(d.flags|=128,nm(I,!1),E=U.updateQueue,E!==null&&(d.updateQueue=E,d.flags|=4),d.subtreeFlags=0,E=p,p=d.child;p!==null;)I=p,u=E,I.flags&=14680066,U=I.alternate,U===null?(I.childLanes=0,I.lanes=u,I.child=null,I.subtreeFlags=0,I.memoizedProps=null,I.memoizedState=null,I.updateQueue=null,I.dependencies=null,I.stateNode=null):(I.childLanes=U.childLanes,I.lanes=U.lanes,I.child=U.child,I.subtreeFlags=0,I.deletions=null,I.memoizedProps=U.memoizedProps,I.memoizedState=U.memoizedState,I.updateQueue=U.updateQueue,I.type=U.type,u=U.dependencies,I.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),p=p.sibling;return cr(Rr,Rr.current&1|2),d.child}u=u.sibling}I.tail!==null&&Je()>wf&&(d.flags|=128,E=!0,nm(I,!1),d.lanes=4194304)}else{if(!E)if(u=Wx(U),u!==null){if(d.flags|=128,E=!0,p=u.updateQueue,p!==null&&(d.updateQueue=p,d.flags|=4),nm(I,!0),I.tail===null&&I.tailMode==="hidden"&&!U.alternate&&!xr)return ts(d),null}else 2*Je()-I.renderingStartTime>wf&&p!==1073741824&&(d.flags|=128,E=!0,nm(I,!1),d.lanes=4194304);I.isBackwards?(U.sibling=d.child,d.child=U):(p=I.last,p!==null?p.sibling=U:d.child=U,I.last=U)}return I.tail!==null?(d=I.tail,I.rendering=d,I.tail=d.sibling,I.renderingStartTime=Je(),d.sibling=null,p=Rr.current,cr(Rr,E?p&1|2:p&1),d):(ts(d),null);case 22:case 23:return cS(),E=d.memoizedState!==null,u!==null&&u.memoizedState!==null!==E&&(d.flags|=8192),E&&(d.mode&1)!==0?(ia&1073741824)!==0&&(ts(d),d.subtreeFlags&6&&(d.flags|=8192)):ts(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function oU(u,d){switch(y2(d),d.tag){case 1:return Is(d.type)&&Lx(),u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 3:return xf(),dr(ks),dr(Qi),P2(),u=d.flags,(u&65536)!==0&&(u&128)===0?(d.flags=u&-65537|128,d):null;case 5:return I2(d),null;case 13:if(dr(Rr),u=d.memoizedState,u!==null&&u.dehydrated!==null){if(d.alternate===null)throw Error(t(340));ff()}return u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 19:return dr(Rr),null;case 4:return xf(),null;case 10:return T2(d.type._context),null;case 22:case 23:return cS(),null;case 24:return null;default:return null}}var ey=!1,ns=!1,lU=typeof WeakSet=="function"?WeakSet:Set,St=null;function _f(u,d){var p=u.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(E){Lr(u,d,E)}else p.current=null}function Z2(u,d,p){try{p()}catch(E){Lr(u,d,E)}}var E4=!1;function cU(u,d){if(c2=bl,u=eP(),t2(u)){if("selectionStart"in u)var p={start:u.selectionStart,end:u.selectionEnd};else e:{p=(p=u.ownerDocument)&&p.defaultView||window;var E=p.getSelection&&p.getSelection();if(E&&E.rangeCount!==0){p=E.anchorNode;var S=E.anchorOffset,I=E.focusNode;E=E.focusOffset;try{p.nodeType,I.nodeType}catch{p=null;break e}var U=0,se=-1,oe=-1,Ae=0,qe=0,Qe=u,Ke=null;t:for(;;){for(var vt;Qe!==p||S!==0&&Qe.nodeType!==3||(se=U+S),Qe!==I||E!==0&&Qe.nodeType!==3||(oe=U+E),Qe.nodeType===3&&(U+=Qe.nodeValue.length),(vt=Qe.firstChild)!==null;)Ke=Qe,Qe=vt;for(;;){if(Qe===u)break t;if(Ke===p&&++Ae===S&&(se=U),Ke===I&&++qe===E&&(oe=U),(vt=Qe.nextSibling)!==null)break;Qe=Ke,Ke=Qe.parentNode}Qe=vt}p=se===-1||oe===-1?null:{start:se,end:oe}}else p=null}p=p||{start:0,end:0}}else p=null;for(u2={focusedElem:u,selectionRange:p},bl=!1,St=d;St!==null;)if(d=St,u=d.child,(d.subtreeFlags&1028)!==0&&u!==null)u.return=d,St=u;else for(;St!==null;){d=St;try{var At=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(At!==null){var Ct=At.memoizedProps,Ur=At.memoizedState,fe=d.stateNode,le=fe.getSnapshotBeforeUpdate(d.elementType===d.type?Ct:eo(d.type,Ct),Ur);fe.__reactInternalSnapshotBeforeUpdate=le}break;case 3:var Se=d.stateNode.containerInfo;Se.nodeType===1?Se.textContent="":Se.nodeType===9&&Se.documentElement&&Se.removeChild(Se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(rt){Lr(d,d.return,rt)}if(u=d.sibling,u!==null){u.return=d.return,St=u;break}St=d.return}return At=E4,E4=!1,At}function rm(u,d,p){var E=d.updateQueue;if(E=E!==null?E.lastEffect:null,E!==null){var S=E=E.next;do{if((S.tag&u)===u){var I=S.destroy;S.destroy=void 0,I!==void 0&&Z2(d,p,I)}S=S.next}while(S!==E)}}function ty(u,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var p=d=d.next;do{if((p.tag&u)===u){var E=p.create;p.destroy=E()}p=p.next}while(p!==d)}}function J2(u){var d=u.ref;if(d!==null){var p=u.stateNode;switch(u.tag){case 5:u=p;break;default:u=p}typeof d=="function"?d(u):d.current=u}}function S4(u){var d=u.alternate;d!==null&&(u.alternate=null,S4(d)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(d=u.stateNode,d!==null&&(delete d[zo],delete d[Hg],delete d[g2],delete d[Wz],delete d[Hz])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function T4(u){return u.tag===5||u.tag===3||u.tag===4}function b4(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||T4(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function Q2(u,d,p){var E=u.tag;if(E===5||E===6)u=u.stateNode,d?p.nodeType===8?p.parentNode.insertBefore(u,d):p.insertBefore(u,d):(p.nodeType===8?(d=p.parentNode,d.insertBefore(u,p)):(d=p,d.appendChild(u)),p=p._reactRootContainer,p!=null||d.onclick!==null||(d.onclick=Nx));else if(E!==4&&(u=u.child,u!==null))for(Q2(u,d,p),u=u.sibling;u!==null;)Q2(u,d,p),u=u.sibling}function eS(u,d,p){var E=u.tag;if(E===5||E===6)u=u.stateNode,d?p.insertBefore(u,d):p.appendChild(u);else if(E!==4&&(u=u.child,u!==null))for(eS(u,d,p),u=u.sibling;u!==null;)eS(u,d,p),u=u.sibling}var Di=null,to=!1;function jc(u,d,p){for(p=p.child;p!==null;)R4(u,d,p),p=p.sibling}function R4(u,d,p){if(Gr&&typeof Gr.onCommitFiberUnmount=="function")try{Gr.onCommitFiberUnmount(Zs,p)}catch{}switch(p.tag){case 5:ns||_f(p,d);case 6:var E=Di,S=to;Di=null,jc(u,d,p),Di=E,to=S,Di!==null&&(to?(u=Di,p=p.stateNode,u.nodeType===8?u.parentNode.removeChild(p):u.removeChild(p)):Di.removeChild(p.stateNode));break;case 18:Di!==null&&(to?(u=Di,p=p.stateNode,u.nodeType===8?f2(u.parentNode,p):u.nodeType===1&&f2(u,p),Ac(u)):f2(Di,p.stateNode));break;case 4:E=Di,S=to,Di=p.stateNode.containerInfo,to=!0,jc(u,d,p),Di=E,to=S;break;case 0:case 11:case 14:case 15:if(!ns&&(E=p.updateQueue,E!==null&&(E=E.lastEffect,E!==null))){S=E=E.next;do{var I=S,U=I.destroy;I=I.tag,U!==void 0&&((I&2)!==0||(I&4)!==0)&&Z2(p,d,U),S=S.next}while(S!==E)}jc(u,d,p);break;case 1:if(!ns&&(_f(p,d),E=p.stateNode,typeof E.componentWillUnmount=="function"))try{E.props=p.memoizedProps,E.state=p.memoizedState,E.componentWillUnmount()}catch(se){Lr(p,d,se)}jc(u,d,p);break;case 21:jc(u,d,p);break;case 22:p.mode&1?(ns=(E=ns)||p.memoizedState!==null,jc(u,d,p),ns=E):jc(u,d,p);break;default:jc(u,d,p)}}function A4(u){var d=u.updateQueue;if(d!==null){u.updateQueue=null;var p=u.stateNode;p===null&&(p=u.stateNode=new lU),d.forEach(function(E){var S=yU.bind(null,u,E);p.has(E)||(p.add(E),E.then(S,S))})}}function no(u,d){var p=d.deletions;if(p!==null)for(var E=0;E<p.length;E++){var S=p[E];try{var I=u,U=d,se=U;e:for(;se!==null;){switch(se.tag){case 5:Di=se.stateNode,to=!1;break e;case 3:Di=se.stateNode.containerInfo,to=!0;break e;case 4:Di=se.stateNode.containerInfo,to=!0;break e}se=se.return}if(Di===null)throw Error(t(160));R4(I,U,S),Di=null,to=!1;var oe=S.alternate;oe!==null&&(oe.return=null),S.return=null}catch(Ae){Lr(S,d,Ae)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)k4(d,u),d=d.sibling}function k4(u,d){var p=u.alternate,E=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(no(d,u),Wo(u),E&4){try{rm(3,u,u.return),ty(3,u)}catch(Ct){Lr(u,u.return,Ct)}try{rm(5,u,u.return)}catch(Ct){Lr(u,u.return,Ct)}}break;case 1:no(d,u),Wo(u),E&512&&p!==null&&_f(p,p.return);break;case 5:if(no(d,u),Wo(u),E&512&&p!==null&&_f(p,p.return),u.flags&32){var S=u.stateNode;try{an(S,"")}catch(Ct){Lr(u,u.return,Ct)}}if(E&4&&(S=u.stateNode,S!=null)){var I=u.memoizedProps,U=p!==null?p.memoizedProps:I,se=u.type,oe=u.updateQueue;if(u.updateQueue=null,oe!==null)try{se==="input"&&I.type==="radio"&&I.name!=null&&en(S,I),je(se,U);var Ae=je(se,I);for(U=0;U<oe.length;U+=2){var qe=oe[U],Qe=oe[U+1];qe==="style"?li(S,Qe):qe==="dangerouslySetInnerHTML"?Tt(S,Qe):qe==="children"?an(S,Qe):R(S,qe,Qe,Ae)}switch(se){case"input":ot(S,I);break;case"textarea":Sr(S,I);break;case"select":var Ke=S._wrapperState.wasMultiple;S._wrapperState.wasMultiple=!!I.multiple;var vt=I.value;vt!=null?sr(S,!!I.multiple,vt,!1):Ke!==!!I.multiple&&(I.defaultValue!=null?sr(S,!!I.multiple,I.defaultValue,!0):sr(S,!!I.multiple,I.multiple?[]:"",!1))}S[Hg]=I}catch(Ct){Lr(u,u.return,Ct)}}break;case 6:if(no(d,u),Wo(u),E&4){if(u.stateNode===null)throw Error(t(162));S=u.stateNode,I=u.memoizedProps;try{S.nodeValue=I}catch(Ct){Lr(u,u.return,Ct)}}break;case 3:if(no(d,u),Wo(u),E&4&&p!==null&&p.memoizedState.isDehydrated)try{Ac(d.containerInfo)}catch(Ct){Lr(u,u.return,Ct)}break;case 4:no(d,u),Wo(u);break;case 13:no(d,u),Wo(u),S=u.child,S.flags&8192&&(I=S.memoizedState!==null,S.stateNode.isHidden=I,!I||S.alternate!==null&&S.alternate.memoizedState!==null||(rS=Je())),E&4&&A4(u);break;case 22:if(qe=p!==null&&p.memoizedState!==null,u.mode&1?(ns=(Ae=ns)||qe,no(d,u),ns=Ae):no(d,u),Wo(u),E&8192){if(Ae=u.memoizedState!==null,(u.stateNode.isHidden=Ae)&&!qe&&(u.mode&1)!==0)for(St=u,qe=u.child;qe!==null;){for(Qe=St=qe;St!==null;){switch(Ke=St,vt=Ke.child,Ke.tag){case 0:case 11:case 14:case 15:rm(4,Ke,Ke.return);break;case 1:_f(Ke,Ke.return);var At=Ke.stateNode;if(typeof At.componentWillUnmount=="function"){E=Ke,p=Ke.return;try{d=E,At.props=d.memoizedProps,At.state=d.memoizedState,At.componentWillUnmount()}catch(Ct){Lr(E,p,Ct)}}break;case 5:_f(Ke,Ke.return);break;case 22:if(Ke.memoizedState!==null){P4(Qe);continue}}vt!==null?(vt.return=Ke,St=vt):P4(Qe)}qe=qe.sibling}e:for(qe=null,Qe=u;;){if(Qe.tag===5){if(qe===null){qe=Qe;try{S=Qe.stateNode,Ae?(I=S.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none"):(se=Qe.stateNode,oe=Qe.memoizedProps.style,U=oe!=null&&oe.hasOwnProperty("display")?oe.display:null,se.style.display=Mr("display",U))}catch(Ct){Lr(u,u.return,Ct)}}}else if(Qe.tag===6){if(qe===null)try{Qe.stateNode.nodeValue=Ae?"":Qe.memoizedProps}catch(Ct){Lr(u,u.return,Ct)}}else if((Qe.tag!==22&&Qe.tag!==23||Qe.memoizedState===null||Qe===u)&&Qe.child!==null){Qe.child.return=Qe,Qe=Qe.child;continue}if(Qe===u)break e;for(;Qe.sibling===null;){if(Qe.return===null||Qe.return===u)break e;qe===Qe&&(qe=null),Qe=Qe.return}qe===Qe&&(qe=null),Qe.sibling.return=Qe.return,Qe=Qe.sibling}}break;case 19:no(d,u),Wo(u),E&4&&A4(u);break;case 21:break;default:no(d,u),Wo(u)}}function Wo(u){var d=u.flags;if(d&2){try{e:{for(var p=u.return;p!==null;){if(T4(p)){var E=p;break e}p=p.return}throw Error(t(160))}switch(E.tag){case 5:var S=E.stateNode;E.flags&32&&(an(S,""),E.flags&=-33);var I=b4(u);eS(u,I,S);break;case 3:case 4:var U=E.stateNode.containerInfo,se=b4(u);Q2(u,se,U);break;default:throw Error(t(161))}}catch(oe){Lr(u,u.return,oe)}u.flags&=-3}d&4096&&(u.flags&=-4097)}function uU(u,d,p){St=u,I4(u)}function I4(u,d,p){for(var E=(u.mode&1)!==0;St!==null;){var S=St,I=S.child;if(S.tag===22&&E){var U=S.memoizedState!==null||ey;if(!U){var se=S.alternate,oe=se!==null&&se.memoizedState!==null||ns;se=ey;var Ae=ns;if(ey=U,(ns=oe)&&!Ae)for(St=S;St!==null;)U=St,oe=U.child,U.tag===22&&U.memoizedState!==null?N4(S):oe!==null?(oe.return=U,St=oe):N4(S);for(;I!==null;)St=I,I4(I),I=I.sibling;St=S,ey=se,ns=Ae}C4(u)}else(S.subtreeFlags&8772)!==0&&I!==null?(I.return=S,St=I):C4(u)}}function C4(u){for(;St!==null;){var d=St;if((d.flags&8772)!==0){var p=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:ns||ty(5,d);break;case 1:var E=d.stateNode;if(d.flags&4&&!ns)if(p===null)E.componentDidMount();else{var S=d.elementType===d.type?p.memoizedProps:eo(d.type,p.memoizedProps);E.componentDidUpdate(S,p.memoizedState,E.__reactInternalSnapshotBeforeUpdate)}var I=d.updateQueue;I!==null&&PP(d,I,E);break;case 3:var U=d.updateQueue;if(U!==null){if(p=null,d.child!==null)switch(d.child.tag){case 5:p=d.child.stateNode;break;case 1:p=d.child.stateNode}PP(d,U,p)}break;case 5:var se=d.stateNode;if(p===null&&d.flags&4){p=se;var oe=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":oe.autoFocus&&p.focus();break;case"img":oe.src&&(p.src=oe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var Ae=d.alternate;if(Ae!==null){var qe=Ae.memoizedState;if(qe!==null){var Qe=qe.dehydrated;Qe!==null&&Ac(Qe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}ns||d.flags&512&&J2(d)}catch(Ke){Lr(d,d.return,Ke)}}if(d===u){St=null;break}if(p=d.sibling,p!==null){p.return=d.return,St=p;break}St=d.return}}function P4(u){for(;St!==null;){var d=St;if(d===u){St=null;break}var p=d.sibling;if(p!==null){p.return=d.return,St=p;break}St=d.return}}function N4(u){for(;St!==null;){var d=St;try{switch(d.tag){case 0:case 11:case 15:var p=d.return;try{ty(4,d)}catch(oe){Lr(d,p,oe)}break;case 1:var E=d.stateNode;if(typeof E.componentDidMount=="function"){var S=d.return;try{E.componentDidMount()}catch(oe){Lr(d,S,oe)}}var I=d.return;try{J2(d)}catch(oe){Lr(d,I,oe)}break;case 5:var U=d.return;try{J2(d)}catch(oe){Lr(d,U,oe)}}}catch(oe){Lr(d,d.return,oe)}if(d===u){St=null;break}var se=d.sibling;if(se!==null){se.return=d.return,St=se;break}St=d.return}}var hU=Math.ceil,ny=M.ReactCurrentDispatcher,tS=M.ReactCurrentOwner,ba=M.ReactCurrentBatchConfig,kn=0,_i=null,Yr=null,ji=0,ia=0,vf=Nc(0),ui=0,im=null,mh=0,ry=0,nS=0,sm=null,Ps=null,rS=0,wf=1/0,Ol=null,iy=!1,iS=null,Fc=null,sy=!1,Vc=null,ay=0,am=0,sS=null,oy=-1,ly=0;function ys(){return(kn&6)!==0?Je():oy!==-1?oy:oy=Je()}function Bc(u){return(u.mode&1)===0?1:(kn&2)!==0&&ji!==0?ji&-ji:Xz.transition!==null?(ly===0&&(ly=Ag()),ly):(u=En,u!==0||(u=window.event,u=u===void 0?16:qd(u.type)),u)}function ro(u,d,p,E){if(50<am)throw am=0,sS=null,Error(t(185));rh(u,p,E),((kn&2)===0||u!==_i)&&(u===_i&&((kn&2)===0&&(ry|=p),ui===4&&Gc(u,ji)),Ns(u,E),p===1&&kn===0&&(d.mode&1)===0&&(wf=Je()+500,Dx&&Lc()))}function Ns(u,d){var p=u.callbackNode;nh(u,d);var E=El(u,u===_i?ji:0);if(E===0)p!==null&&it(p),u.callbackNode=null,u.callbackPriority=0;else if(d=E&-E,u.callbackPriority!==d){if(p!=null&&it(p),d===1)u.tag===0?Kz(L4.bind(null,u)):_P(L4.bind(null,u)),Uz(function(){(kn&6)===0&&Lc()}),p=null;else{switch(No(E)){case 1:p=Gn;break;case 4:p=Wn;break;case 16:p=pr;break;case 536870912:p=_a;break;default:p=pr}p=z4(p,M4.bind(null,u))}u.callbackPriority=d,u.callbackNode=p}}function M4(u,d){if(oy=-1,ly=0,(kn&6)!==0)throw Error(t(327));var p=u.callbackNode;if(Ef()&&u.callbackNode!==p)return null;var E=El(u,u===_i?ji:0);if(E===0)return null;if((E&30)!==0||(E&u.expiredLanes)!==0||d)d=cy(u,E);else{d=E;var S=kn;kn|=2;var I=D4();(_i!==u||ji!==d)&&(Ol=null,wf=Je()+500,xh(u,d));do try{gU();break}catch(se){O4(u,se)}while(!0);S2(),ny.current=I,kn=S,Yr!==null?d=0:(_i=null,ji=0,d=ui)}if(d!==0){if(d===2&&(S=Rg(u),S!==0&&(E=S,d=aS(u,S))),d===1)throw p=im,xh(u,0),Gc(u,E),Ns(u,Je()),p;if(d===6)Gc(u,E);else{if(S=u.current.alternate,(E&30)===0&&!dU(S)&&(d=cy(u,E),d===2&&(I=Rg(u),I!==0&&(E=I,d=aS(u,I))),d===1))throw p=im,xh(u,0),Gc(u,E),Ns(u,Je()),p;switch(u.finishedWork=S,u.finishedLanes=E,d){case 0:case 1:throw Error(t(345));case 2:yh(u,Ps,Ol);break;case 3:if(Gc(u,E),(E&130023424)===E&&(d=rS+500-Je(),10<d)){if(El(u,0)!==0)break;if(S=u.suspendedLanes,(S&E)!==E){ys(),u.pingedLanes|=u.suspendedLanes&S;break}u.timeoutHandle=d2(yh.bind(null,u,Ps,Ol),d);break}yh(u,Ps,Ol);break;case 4:if(Gc(u,E),(E&4194240)===E)break;for(d=u.eventTimes,S=-1;0<E;){var U=31-br(E);I=1<<U,U=d[U],U>S&&(S=U),E&=~I}if(E=S,E=Je()-E,E=(120>E?120:480>E?480:1080>E?1080:1920>E?1920:3e3>E?3e3:4320>E?4320:1960*hU(E/1960))-E,10<E){u.timeoutHandle=d2(yh.bind(null,u,Ps,Ol),E);break}yh(u,Ps,Ol);break;case 5:yh(u,Ps,Ol);break;default:throw Error(t(329))}}}return Ns(u,Je()),u.callbackNode===p?M4.bind(null,u):null}function aS(u,d){var p=sm;return u.current.memoizedState.isDehydrated&&(xh(u,d).flags|=256),u=cy(u,d),u!==2&&(d=Ps,Ps=p,d!==null&&oS(d)),u}function oS(u){Ps===null?Ps=u:Ps.push.apply(Ps,u)}function dU(u){for(var d=u;;){if(d.flags&16384){var p=d.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var E=0;E<p.length;E++){var S=p[E],I=S.getSnapshot;S=S.value;try{if(!Ja(I(),S))return!1}catch{return!1}}}if(p=d.child,d.subtreeFlags&16384&&p!==null)p.return=d,d=p;else{if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Gc(u,d){for(d&=~nS,d&=~ry,u.suspendedLanes|=d,u.pingedLanes&=~d,u=u.expirationTimes;0<d;){var p=31-br(d),E=1<<p;u[p]=-1,d&=~E}}function L4(u){if((kn&6)!==0)throw Error(t(327));Ef();var d=El(u,0);if((d&1)===0)return Ns(u,Je()),null;var p=cy(u,d);if(u.tag!==0&&p===2){var E=Rg(u);E!==0&&(d=E,p=aS(u,E))}if(p===1)throw p=im,xh(u,0),Gc(u,d),Ns(u,Je()),p;if(p===6)throw Error(t(345));return u.finishedWork=u.current.alternate,u.finishedLanes=d,yh(u,Ps,Ol),Ns(u,Je()),null}function lS(u,d){var p=kn;kn|=1;try{return u(d)}finally{kn=p,kn===0&&(wf=Je()+500,Dx&&Lc())}}function ph(u){Vc!==null&&Vc.tag===0&&(kn&6)===0&&Ef();var d=kn;kn|=1;var p=ba.transition,E=En;try{if(ba.transition=null,En=1,u)return u()}finally{En=E,ba.transition=p,kn=d,(kn&6)===0&&Lc()}}function cS(){ia=vf.current,dr(vf)}function xh(u,d){u.finishedWork=null,u.finishedLanes=0;var p=u.timeoutHandle;if(p!==-1&&(u.timeoutHandle=-1,zz(p)),Yr!==null)for(p=Yr.return;p!==null;){var E=p;switch(y2(E),E.tag){case 1:E=E.type.childContextTypes,E!=null&&Lx();break;case 3:xf(),dr(ks),dr(Qi),P2();break;case 5:I2(E);break;case 4:xf();break;case 13:dr(Rr);break;case 19:dr(Rr);break;case 10:T2(E.type._context);break;case 22:case 23:cS()}p=p.return}if(_i=u,Yr=u=zc(u.current,null),ji=ia=d,ui=0,im=null,nS=ry=mh=0,Ps=sm=null,dh!==null){for(d=0;d<dh.length;d++)if(p=dh[d],E=p.interleaved,E!==null){p.interleaved=null;var S=E.next,I=p.pending;if(I!==null){var U=I.next;I.next=S,E.next=U}p.pending=E}dh=null}return u}function O4(u,d){do{var p=Yr;try{if(S2(),Hx.current=Yx,Kx){for(var E=Ar.memoizedState;E!==null;){var S=E.queue;S!==null&&(S.pending=null),E=E.next}Kx=!1}if(gh=0,yi=ci=Ar=null,Jg=!1,Qg=0,tS.current=null,p===null||p.return===null){ui=1,im=d,Yr=null;break}e:{var I=u,U=p.return,se=p,oe=d;if(d=ji,se.flags|=32768,oe!==null&&typeof oe=="object"&&typeof oe.then=="function"){var Ae=oe,qe=se,Qe=qe.tag;if((qe.mode&1)===0&&(Qe===0||Qe===11||Qe===15)){var Ke=qe.alternate;Ke?(qe.updateQueue=Ke.updateQueue,qe.memoizedState=Ke.memoizedState,qe.lanes=Ke.lanes):(qe.updateQueue=null,qe.memoizedState=null)}var vt=a4(U);if(vt!==null){vt.flags&=-257,o4(vt,U,se,I,d),vt.mode&1&&s4(I,Ae,d),d=vt,oe=Ae;var At=d.updateQueue;if(At===null){var Ct=new Set;Ct.add(oe),d.updateQueue=Ct}else At.add(oe);break e}else{if((d&1)===0){s4(I,Ae,d),uS();break e}oe=Error(t(426))}}else if(xr&&se.mode&1){var Ur=a4(U);if(Ur!==null){(Ur.flags&65536)===0&&(Ur.flags|=256),o4(Ur,U,se,I,d),w2(yf(oe,se));break e}}I=oe=yf(oe,se),ui!==4&&(ui=2),sm===null?sm=[I]:sm.push(I),I=U;do{switch(I.tag){case 3:I.flags|=65536,d&=-d,I.lanes|=d;var fe=r4(I,oe,d);CP(I,fe);break e;case 1:se=oe;var le=I.type,Se=I.stateNode;if((I.flags&128)===0&&(typeof le.getDerivedStateFromError=="function"||Se!==null&&typeof Se.componentDidCatch=="function"&&(Fc===null||!Fc.has(Se)))){I.flags|=65536,d&=-d,I.lanes|=d;var rt=i4(I,se,d);CP(I,rt);break e}}I=I.return}while(I!==null)}F4(p)}catch(Nt){d=Nt,Yr===p&&p!==null&&(Yr=p=p.return);continue}break}while(!0)}function D4(){var u=ny.current;return ny.current=Yx,u===null?Yx:u}function uS(){(ui===0||ui===3||ui===2)&&(ui=4),_i===null||(mh&268435455)===0&&(ry&268435455)===0||Gc(_i,ji)}function cy(u,d){var p=kn;kn|=2;var E=D4();(_i!==u||ji!==d)&&(Ol=null,xh(u,d));do try{fU();break}catch(S){O4(u,S)}while(!0);if(S2(),kn=p,ny.current=E,Yr!==null)throw Error(t(261));return _i=null,ji=0,ui}function fU(){for(;Yr!==null;)j4(Yr)}function gU(){for(;Yr!==null&&!pt();)j4(Yr)}function j4(u){var d=G4(u.alternate,u,ia);u.memoizedProps=u.pendingProps,d===null?F4(u):Yr=d,tS.current=null}function F4(u){var d=u;do{var p=d.alternate;if(u=d.return,(d.flags&32768)===0){if(p=aU(p,d,ia),p!==null){Yr=p;return}}else{if(p=oU(p,d),p!==null){p.flags&=32767,Yr=p;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{ui=6,Yr=null;return}}if(d=d.sibling,d!==null){Yr=d;return}Yr=d=u}while(d!==null);ui===0&&(ui=5)}function yh(u,d,p){var E=En,S=ba.transition;try{ba.transition=null,En=1,mU(u,d,p,E)}finally{ba.transition=S,En=E}return null}function mU(u,d,p,E){do Ef();while(Vc!==null);if((kn&6)!==0)throw Error(t(327));p=u.finishedWork;var S=u.finishedLanes;if(p===null)return null;if(u.finishedWork=null,u.finishedLanes=0,p===u.current)throw Error(t(177));u.callbackNode=null,u.callbackPriority=0;var I=p.lanes|p.childLanes;if(YE(u,I),u===_i&&(Yr=_i=null,ji=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||sy||(sy=!0,z4(pr,function(){return Ef(),null})),I=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||I){I=ba.transition,ba.transition=null;var U=En;En=1;var se=kn;kn|=4,tS.current=null,cU(u,p),k4(p,u),Oz(u2),bl=!!c2,u2=c2=null,u.current=p,uU(p),Ze(),kn=se,En=U,ba.transition=I}else u.current=p;if(sy&&(sy=!1,Vc=u,ay=S),I=u.pendingLanes,I===0&&(Fc=null),Sc(p.stateNode),Ns(u,Je()),d!==null)for(E=u.onRecoverableError,p=0;p<d.length;p++)S=d[p],E(S.value,{componentStack:S.stack,digest:S.digest});if(iy)throw iy=!1,u=iS,iS=null,u;return(ay&1)!==0&&u.tag!==0&&Ef(),I=u.pendingLanes,(I&1)!==0?u===sS?am++:(am=0,sS=u):am=0,Lc(),null}function Ef(){if(Vc!==null){var u=No(ay),d=ba.transition,p=En;try{if(ba.transition=null,En=16>u?16:u,Vc===null)var E=!1;else{if(u=Vc,Vc=null,ay=0,(kn&6)!==0)throw Error(t(331));var S=kn;for(kn|=4,St=u.current;St!==null;){var I=St,U=I.child;if((St.flags&16)!==0){var se=I.deletions;if(se!==null){for(var oe=0;oe<se.length;oe++){var Ae=se[oe];for(St=Ae;St!==null;){var qe=St;switch(qe.tag){case 0:case 11:case 15:rm(8,qe,I)}var Qe=qe.child;if(Qe!==null)Qe.return=qe,St=Qe;else for(;St!==null;){qe=St;var Ke=qe.sibling,vt=qe.return;if(S4(qe),qe===Ae){St=null;break}if(Ke!==null){Ke.return=vt,St=Ke;break}St=vt}}}var At=I.alternate;if(At!==null){var Ct=At.child;if(Ct!==null){At.child=null;do{var Ur=Ct.sibling;Ct.sibling=null,Ct=Ur}while(Ct!==null)}}St=I}}if((I.subtreeFlags&2064)!==0&&U!==null)U.return=I,St=U;else e:for(;St!==null;){if(I=St,(I.flags&2048)!==0)switch(I.tag){case 0:case 11:case 15:rm(9,I,I.return)}var fe=I.sibling;if(fe!==null){fe.return=I.return,St=fe;break e}St=I.return}}var le=u.current;for(St=le;St!==null;){U=St;var Se=U.child;if((U.subtreeFlags&2064)!==0&&Se!==null)Se.return=U,St=Se;else e:for(U=le;St!==null;){if(se=St,(se.flags&2048)!==0)try{switch(se.tag){case 0:case 11:case 15:ty(9,se)}}catch(Nt){Lr(se,se.return,Nt)}if(se===U){St=null;break e}var rt=se.sibling;if(rt!==null){rt.return=se.return,St=rt;break e}St=se.return}}if(kn=S,Lc(),Gr&&typeof Gr.onPostCommitFiberRoot=="function")try{Gr.onPostCommitFiberRoot(Zs,u)}catch{}E=!0}return E}finally{En=p,ba.transition=d}}return!1}function V4(u,d,p){d=yf(p,d),d=r4(u,d,1),u=Dc(u,d,1),d=ys(),u!==null&&(rh(u,1,d),Ns(u,d))}function Lr(u,d,p){if(u.tag===3)V4(u,u,p);else for(;d!==null;){if(d.tag===3){V4(d,u,p);break}else if(d.tag===1){var E=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(Fc===null||!Fc.has(E))){u=yf(p,u),u=i4(d,u,1),d=Dc(d,u,1),u=ys(),d!==null&&(rh(d,1,u),Ns(d,u));break}}d=d.return}}function pU(u,d,p){var E=u.pingCache;E!==null&&E.delete(d),d=ys(),u.pingedLanes|=u.suspendedLanes&p,_i===u&&(ji&p)===p&&(ui===4||ui===3&&(ji&130023424)===ji&&500>Je()-rS?xh(u,0):nS|=p),Ns(u,d)}function B4(u,d){d===0&&((u.mode&1)===0?d=1:(d=Tc,Tc<<=1,(Tc&130023424)===0&&(Tc=4194304)));var p=ys();u=Nl(u,d),u!==null&&(rh(u,d,p),Ns(u,p))}function xU(u){var d=u.memoizedState,p=0;d!==null&&(p=d.retryLane),B4(u,p)}function yU(u,d){var p=0;switch(u.tag){case 13:var E=u.stateNode,S=u.memoizedState;S!==null&&(p=S.retryLane);break;case 19:E=u.stateNode;break;default:throw Error(t(314))}E!==null&&E.delete(d),B4(u,p)}var G4;G4=function(u,d,p){if(u!==null)if(u.memoizedProps!==d.pendingProps||ks.current)Cs=!0;else{if((u.lanes&p)===0&&(d.flags&128)===0)return Cs=!1,sU(u,d,p);Cs=(u.flags&131072)!==0}else Cs=!1,xr&&(d.flags&1048576)!==0&&vP(d,Fx,d.index);switch(d.lanes=0,d.tag){case 2:var E=d.type;Qx(u,d),u=d.pendingProps;var S=uf(d,Qi.current);pf(d,p),S=L2(null,d,E,u,S,p);var I=O2();return d.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,Is(E)?(I=!0,Ox(d)):I=!1,d.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,A2(d),S.updater=Zx,d.stateNode=S,S._reactInternals=d,G2(d,E,u,p),d=W2(null,d,E,!0,I,p)):(d.tag=0,xr&&I&&x2(d),xs(null,d,S,p),d=d.child),d;case 16:E=d.elementType;e:{switch(Qx(u,d),u=d.pendingProps,S=E._init,E=S(E._payload),d.type=E,S=d.tag=vU(E),u=eo(E,u),S){case 0:d=$2(null,d,E,u,p);break e;case 1:d=f4(null,d,E,u,p);break e;case 11:d=l4(null,d,E,u,p);break e;case 14:d=c4(null,d,E,eo(E.type,u),p);break e}throw Error(t(306,E,""))}return d;case 0:return E=d.type,S=d.pendingProps,S=d.elementType===E?S:eo(E,S),$2(u,d,E,S,p);case 1:return E=d.type,S=d.pendingProps,S=d.elementType===E?S:eo(E,S),f4(u,d,E,S,p);case 3:e:{if(g4(d),u===null)throw Error(t(387));E=d.pendingProps,I=d.memoizedState,S=I.element,IP(u,d),$x(d,E,null,p);var U=d.memoizedState;if(E=U.element,I.isDehydrated)if(I={element:E,isDehydrated:!1,cache:U.cache,pendingSuspenseBoundaries:U.pendingSuspenseBoundaries,transitions:U.transitions},d.updateQueue.baseState=I,d.memoizedState=I,d.flags&256){S=yf(Error(t(423)),d),d=m4(u,d,E,p,S);break e}else if(E!==S){S=yf(Error(t(424)),d),d=m4(u,d,E,p,S);break e}else for(ra=Pc(d.stateNode.containerInfo.firstChild),na=d,xr=!0,Qa=null,p=AP(d,null,E,p),d.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(ff(),E===S){d=Ll(u,d,p);break e}xs(u,d,E,p)}d=d.child}return d;case 5:return NP(d),u===null&&v2(d),E=d.type,S=d.pendingProps,I=u!==null?u.memoizedProps:null,U=S.children,h2(E,S)?U=null:I!==null&&h2(E,I)&&(d.flags|=32),d4(u,d),xs(u,d,U,p),d.child;case 6:return u===null&&v2(d),null;case 13:return p4(u,d,p);case 4:return k2(d,d.stateNode.containerInfo),E=d.pendingProps,u===null?d.child=gf(d,null,E,p):xs(u,d,E,p),d.child;case 11:return E=d.type,S=d.pendingProps,S=d.elementType===E?S:eo(E,S),l4(u,d,E,S,p);case 7:return xs(u,d,d.pendingProps,p),d.child;case 8:return xs(u,d,d.pendingProps.children,p),d.child;case 12:return xs(u,d,d.pendingProps.children,p),d.child;case 10:e:{if(E=d.type._context,S=d.pendingProps,I=d.memoizedProps,U=S.value,cr(Gx,E._currentValue),E._currentValue=U,I!==null)if(Ja(I.value,U)){if(I.children===S.children&&!ks.current){d=Ll(u,d,p);break e}}else for(I=d.child,I!==null&&(I.return=d);I!==null;){var se=I.dependencies;if(se!==null){U=I.child;for(var oe=se.firstContext;oe!==null;){if(oe.context===E){if(I.tag===1){oe=Ml(-1,p&-p),oe.tag=2;var Ae=I.updateQueue;if(Ae!==null){Ae=Ae.shared;var qe=Ae.pending;qe===null?oe.next=oe:(oe.next=qe.next,qe.next=oe),Ae.pending=oe}}I.lanes|=p,oe=I.alternate,oe!==null&&(oe.lanes|=p),b2(I.return,p,d),se.lanes|=p;break}oe=oe.next}}else if(I.tag===10)U=I.type===d.type?null:I.child;else if(I.tag===18){if(U=I.return,U===null)throw Error(t(341));U.lanes|=p,se=U.alternate,se!==null&&(se.lanes|=p),b2(U,p,d),U=I.sibling}else U=I.child;if(U!==null)U.return=I;else for(U=I;U!==null;){if(U===d){U=null;break}if(I=U.sibling,I!==null){I.return=U.return,U=I;break}U=U.return}I=U}xs(u,d,S.children,p),d=d.child}return d;case 9:return S=d.type,E=d.pendingProps.children,pf(d,p),S=Sa(S),E=E(S),d.flags|=1,xs(u,d,E,p),d.child;case 14:return E=d.type,S=eo(E,d.pendingProps),S=eo(E.type,S),c4(u,d,E,S,p);case 15:return u4(u,d,d.type,d.pendingProps,p);case 17:return E=d.type,S=d.pendingProps,S=d.elementType===E?S:eo(E,S),Qx(u,d),d.tag=1,Is(E)?(u=!0,Ox(d)):u=!1,pf(d,p),t4(d,E,S),G2(d,E,S,p),W2(null,d,E,!0,u,p);case 19:return y4(u,d,p);case 22:return h4(u,d,p)}throw Error(t(156,d.tag))};function z4(u,d){return Ye(u,d)}function _U(u,d,p,E){this.tag=u,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ra(u,d,p,E){return new _U(u,d,p,E)}function hS(u){return u=u.prototype,!(!u||!u.isReactComponent)}function vU(u){if(typeof u=="function")return hS(u)?1:0;if(u!=null){if(u=u.$$typeof,u===z)return 11;if(u===Ce)return 14}return 2}function zc(u,d){var p=u.alternate;return p===null?(p=Ra(u.tag,d,u.key,u.mode),p.elementType=u.elementType,p.type=u.type,p.stateNode=u.stateNode,p.alternate=u,u.alternate=p):(p.pendingProps=d,p.type=u.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=u.flags&14680064,p.childLanes=u.childLanes,p.lanes=u.lanes,p.child=u.child,p.memoizedProps=u.memoizedProps,p.memoizedState=u.memoizedState,p.updateQueue=u.updateQueue,d=u.dependencies,p.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},p.sibling=u.sibling,p.index=u.index,p.ref=u.ref,p}function uy(u,d,p,E,S,I){var U=2;if(E=u,typeof u=="function")hS(u)&&(U=1);else if(typeof u=="string")U=5;else e:switch(u){case k:return _h(p.children,S,I,d);case A:U=8,S|=8;break;case C:return u=Ra(12,p,d,S|2),u.elementType=C,u.lanes=I,u;case F:return u=Ra(13,p,d,S),u.elementType=F,u.lanes=I,u;case xe:return u=Ra(19,p,d,S),u.elementType=xe,u.lanes=I,u;case Ne:return hy(p,S,I,d);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case O:U=10;break e;case P:U=9;break e;case z:U=11;break e;case Ce:U=14;break e;case Ge:U=16,E=null;break e}throw Error(t(130,u==null?u:typeof u,""))}return d=Ra(U,p,d,S),d.elementType=u,d.type=E,d.lanes=I,d}function _h(u,d,p,E){return u=Ra(7,u,E,d),u.lanes=p,u}function hy(u,d,p,E){return u=Ra(22,u,E,d),u.elementType=Ne,u.lanes=p,u.stateNode={isHidden:!1},u}function dS(u,d,p){return u=Ra(6,u,null,d),u.lanes=p,u}function fS(u,d,p){return d=Ra(4,u.children!==null?u.children:[],u.key,d),d.lanes=p,d.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},d}function wU(u,d,p,E,S){this.tag=d,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kg(0),this.expirationTimes=kg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kg(0),this.identifierPrefix=E,this.onRecoverableError=S,this.mutableSourceEagerHydrationData=null}function gS(u,d,p,E,S,I,U,se,oe){return u=new wU(u,d,p,se,oe),d===1?(d=1,I===!0&&(d|=8)):d=0,I=Ra(3,null,null,d),u.current=I,I.stateNode=u,I.memoizedState={element:E,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},A2(I),u}function EU(u,d,p){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:E==null?null:""+E,children:u,containerInfo:d,implementation:p}}function U4(u){if(!u)return Mc;u=u._reactInternals;e:{if(ne(u)!==u||u.tag!==1)throw Error(t(170));var d=u;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(Is(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(u.tag===1){var p=u.type;if(Is(p))return xP(u,p,d)}return d}function $4(u,d,p,E,S,I,U,se,oe){return u=gS(p,E,!0,u,S,I,U,se,oe),u.context=U4(null),p=u.current,E=ys(),S=Bc(p),I=Ml(E,S),I.callback=d??null,Dc(p,I,S),u.current.lanes=S,rh(u,S,E),Ns(u,E),u}function dy(u,d,p,E){var S=d.current,I=ys(),U=Bc(S);return p=U4(p),d.context===null?d.context=p:d.pendingContext=p,d=Ml(I,U),d.payload={element:u},E=E===void 0?null:E,E!==null&&(d.callback=E),u=Dc(S,d,U),u!==null&&(ro(u,S,U,I),Ux(u,S,U)),U}function fy(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function W4(u,d){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var p=u.retryLane;u.retryLane=p!==0&&p<d?p:d}}function mS(u,d){W4(u,d),(u=u.alternate)&&W4(u,d)}function SU(){return null}var H4=typeof reportError=="function"?reportError:function(u){console.error(u)};function pS(u){this._internalRoot=u}gy.prototype.render=pS.prototype.render=function(u){var d=this._internalRoot;if(d===null)throw Error(t(409));dy(u,d,null,null)},gy.prototype.unmount=pS.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var d=u.containerInfo;ph(function(){dy(null,u,null,null)}),d[kl]=null}};function gy(u){this._internalRoot=u}gy.prototype.unstable_scheduleHydration=function(u){if(u){var d=Ng();u={blockedOn:null,target:u,priority:d};for(var p=0;p<Js.length&&d!==0&&d<Js[p].priority;p++);Js.splice(p,0,u),p===0&&Kd(u)}};function xS(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function my(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function K4(){}function TU(u,d,p,E,S){if(S){if(typeof E=="function"){var I=E;E=function(){var Ae=fy(U);I.call(Ae)}}var U=$4(d,E,u,0,null,!1,!1,"",K4);return u._reactRootContainer=U,u[kl]=U.current,$g(u.nodeType===8?u.parentNode:u),ph(),U}for(;S=u.lastChild;)u.removeChild(S);if(typeof E=="function"){var se=E;E=function(){var Ae=fy(oe);se.call(Ae)}}var oe=gS(u,0,!1,null,null,!1,!1,"",K4);return u._reactRootContainer=oe,u[kl]=oe.current,$g(u.nodeType===8?u.parentNode:u),ph(function(){dy(d,oe,p,E)}),oe}function py(u,d,p,E,S){var I=p._reactRootContainer;if(I){var U=I;if(typeof S=="function"){var se=S;S=function(){var oe=fy(U);se.call(oe)}}dy(d,U,u,S)}else U=TU(p,d,u,S,E);return fy(U)}Cg=function(u){switch(u.tag){case 3:var d=u.stateNode;if(d.current.memoizedState.isDehydrated){var p=Ln(d.pendingLanes);p!==0&&(Ig(d,p|1),Ns(d,Je()),(kn&6)===0&&(wf=Je()+500,Lc()))}break;case 13:ph(function(){var E=Nl(u,1);if(E!==null){var S=ys();ro(E,u,1,S)}}),mS(u,1)}},Wd=function(u){if(u.tag===13){var d=Nl(u,134217728);if(d!==null){var p=ys();ro(d,u,134217728,p)}mS(u,134217728)}},Pg=function(u){if(u.tag===13){var d=Bc(u),p=Nl(u,d);if(p!==null){var E=ys();ro(p,u,d,E)}mS(u,d)}},Ng=function(){return En},Mg=function(u,d){var p=En;try{return En=u,d()}finally{En=p}},jt=function(u,d,p){switch(d){case"input":if(ot(u,p),d=p.name,p.type==="radio"&&d!=null){for(p=u;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<p.length;d++){var E=p[d];if(E!==u&&E.form===u.form){var S=Mx(E);if(!S)throw Error(t(90));Et(E),ot(E,S)}}}break;case"textarea":Sr(u,p);break;case"select":d=p.value,d!=null&&sr(u,!!p.multiple,d,!1)}},q=lS,ce=ph;var bU={usingClientEntryPoint:!1,Events:[Kg,lf,Mx,ie,Pe,lS]},om={findFiberByHostInstance:lh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RU={bundleType:om.bundleType,version:om.version,rendererPackageName:om.rendererPackageName,rendererConfig:om.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=Te(u),u===null?null:u.stateNode},findFiberByHostInstance:om.findFiberByHostInstance||SU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xy.isDisabled&&xy.supportsFiber)try{Zs=xy.inject(RU),Gr=xy}catch{}}return Ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bU,Ms.createPortal=function(u,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xS(d))throw Error(t(200));return EU(u,d,null,p)},Ms.createRoot=function(u,d){if(!xS(u))throw Error(t(299));var p=!1,E="",S=H4;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(E=d.identifierPrefix),d.onRecoverableError!==void 0&&(S=d.onRecoverableError)),d=gS(u,1,!1,null,null,p,!1,E,S),u[kl]=d.current,$g(u.nodeType===8?u.parentNode:u),new pS(d)},Ms.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var d=u._reactInternals;if(d===void 0)throw typeof u.render=="function"?Error(t(188)):(u=Object.keys(u).join(","),Error(t(268,u)));return u=Te(d),u=u===null?null:u.stateNode,u},Ms.flushSync=function(u){return ph(u)},Ms.hydrate=function(u,d,p){if(!my(d))throw Error(t(200));return py(null,u,d,!0,p)},Ms.hydrateRoot=function(u,d,p){if(!xS(u))throw Error(t(405));var E=p!=null&&p.hydratedSources||null,S=!1,I="",U=H4;if(p!=null&&(p.unstable_strictMode===!0&&(S=!0),p.identifierPrefix!==void 0&&(I=p.identifierPrefix),p.onRecoverableError!==void 0&&(U=p.onRecoverableError)),d=$4(d,null,u,1,p??null,S,!1,I,U),u[kl]=d.current,$g(u),E)for(u=0;u<E.length;u++)p=E[u],S=p._getVersion,S=S(p._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[p,S]:d.mutableSourceEagerHydrationData.push(p,S);return new gy(d)},Ms.render=function(u,d,p){if(!my(d))throw Error(t(200));return py(null,u,d,!1,p)},Ms.unmountComponentAtNode=function(u){if(!my(u))throw Error(t(40));return u._reactRootContainer?(ph(function(){py(null,null,u,!1,function(){u._reactRootContainer=null,u[kl]=null})}),!0):!1},Ms.unstable_batchedUpdates=lS,Ms.unstable_renderSubtreeIntoContainer=function(u,d,p,E){if(!my(p))throw Error(t(200));if(u==null||u._reactInternals===void 0)throw Error(t(38));return py(u,d,p,!1,E)},Ms.version="18.3.1-next-f1338f8080-20240426",Ms}var tN;function LU(){if(tN)return vS.exports;tN=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),vS.exports=MU(),vS.exports}var nN;function OU(){if(nN)return yy;nN=1;var n=LU();return yy.createRoot=n.createRoot,yy.hydrateRoot=n.hydrateRoot,yy}var DU=OU();const jU=nA(DU);var H=_1();const FU=nA(H),Ds={ADD:"add",REMOVE:"remove"},N0={PROPERTYCHANGE:"propertychange"},Kt={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class v1{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function VU(n,e,t){let r,i;t=t||Xl;let s=0,a=n.length,o=!1;for(;s<a;)r=s+(a-s>>1),i=+t(n[r],e),i<0?s=r+1:(a=r,o=!i);return o?s:~s}function Xl(n,e){return n>e?1:n<e?-1:0}function RD(n,e){return n<e?1:n>e?-1:0}function vw(n,e,t){if(n[0]<=e)return 0;const r=n.length;if(e<=n[r-1])return r-1;if(typeof t=="function"){for(let i=1;i<r;++i){const s=n[i];if(s===e)return i;if(s<e)return t(e,n[i-1],s)>0?i-1:i}return r-1}if(t>0){for(let i=1;i<r;++i)if(n[i]<e)return i-1;return r-1}if(t<0){for(let i=1;i<r;++i)if(n[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(n[i]==e)return i;if(n[i]<e)return n[i-1]-e<e-n[i]?i-1:i}return r-1}function BU(n,e,t){for(;e<t;){const r=n[e];n[e]=n[t],n[t]=r,++e,--t}}function zn(n,e){const t=Array.isArray(e)?e:[e],r=t.length;for(let i=0;i<r;i++)n[n.length]=t[i]}function gc(n,e){const t=n.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function GU(n,e,t){const r=e||Xl;return n.every(function(i,s){if(s===0)return!0;const a=r(n[s-1],i);return!(a>0||a===0)})}function vp(){return!0}function ww(){return!1}function wp(){}function AD(n){let e,t,r;return function(){const i=Array.prototype.slice.call(arguments);return(!t||this!==r||!gc(i,t))&&(r=this,t=i,e=n.apply(this,arguments)),e}}function kD(n){function e(){let t;try{t=n()}catch(r){return Promise.reject(r)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function lg(n){for(const e in n)delete n[e]}function id(n){let e;for(e in n)return!1;return!e}class yl{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let cg=class extends v1{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(t)||i.push(t)}dispatchEvent(e){const t=typeof e=="string",r=t?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const s=t?new yl(e):e;s.target||(s.target=this.eventTarget_||this);const a=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});r in a||(a[r]=0,o[r]=0),++a[r];let l;for(let c=0,h=i.length;c<h;++c)if("handleEvent"in i[c]?l=i[c].handleEvent(s):l=i[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--a[r]===0){let c=o[r];for(delete o[r];c--;)this.removeEventListener(r,wp);delete a[r]}return l}disposeInternal(){this.listeners_&&lg(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(t);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=wp,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}};function gn(n,e,t,r,i){if(i){const a=t;t=function(o){return n.removeEventListener(e,t),a.call(r??this,o)}}else r&&r!==n&&(t=t.bind(r));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function D_(n,e,t,r){return gn(n,e,t,r,!0)}function or(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),lg(n))}class w1 extends cg{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Kt.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=gn(this,e[s],t);return i}return gn(this,e,t)}onceInternal(e,t){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let s=0;s<i;++s)r[s]=D_(this,e[s],t)}else r=D_(this,e,t);return t.ol_key=r,r}unInternal(e,t){const r=t.ol_key;if(r)zU(r);else if(Array.isArray(e))for(let i=0,s=e.length;i<s;++i)this.removeEventListener(e[i],t);else this.removeEventListener(e,t)}}w1.prototype.on;w1.prototype.once;w1.prototype.un;function zU(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)or(n[e]);else or(n)}function Wt(){throw new Error("Unimplemented abstract method.")}let UU=0;function Gt(n){return n.ol_uid||(n.ol_uid=String(++UU))}class rN extends yl{constructor(e,t,r){super(e),this.key=t,this.oldValue=r}}class _l extends w1{constructor(e){super(),this.on,this.once,this.un,Gt(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new rN(r,e,t)),r=N0.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new rN(r,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,r){const i=this.values_||(this.values_={});if(r)i[e]=t;else{const s=i[e];i[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const r in e)this.set(r,e[r],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],id(this.values_)&&(this.values_=null),t||this.notify(e,r)}}}const iN={LENGTH:"length"};class _y extends yl{constructor(e,t,r){super(e),this.element=t,this.index=r}}class La extends _l{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,r=e.length;t<r;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)e(t[r],r,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(iN.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new _y(Ds.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)if(t[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new _y(Ds.REMOVE,t,e)),t}setAt(e,t){const r=this.getLength();if(e>=r){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const i=this.array_[e];this.array_[e]=t,this.dispatchEvent(new _y(Ds.REMOVE,i,e)),this.dispatchEvent(new _y(Ds.ADD,t,e))}updateLength_(){this.set(iN.LENGTH,this.array_.length)}assertUnique_(e,t){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===e&&i!==t)throw new Error("Duplicate item added to a unique collection")}}function Rn(n,e){if(!n)throw new Error(e)}let _r=class ID extends _l{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new ID(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(or(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=gn(e,Kt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?$U(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function $U(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(Rn(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const Ei={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function ab(n){const e=$s();for(let t=0,r=n.length;t<r;++t)Bm(e,n[t]);return e}function M0(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function CD(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function Ad(n,e,t){let r,i;return e<n[0]?r=n[0]-e:n[2]<e?r=e-n[2]:r=0,t<n[1]?i=n[1]-t:n[3]<t?i=t-n[3]:i=0,r*r+i*i}function rc(n,e){return rA(n,e[0],e[1])}function cu(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function rA(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function ob(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=e[0],o=e[1];let l=Ei.UNKNOWN;return a<t?l=l|Ei.LEFT:a>i&&(l=l|Ei.RIGHT),o<r?l=l|Ei.BELOW:o>s&&(l=l|Ei.ABOVE),l===Ei.UNKNOWN&&(l=Ei.INTERSECTING),l}function $s(){return[1/0,1/0,-1/0,-1/0]}function Pu(n,e,t,r,i){return i?(i[0]=n,i[1]=e,i[2]=t,i[3]=r,i):[n,e,t,r]}function E1(n){return Pu(1/0,1/0,-1/0,-1/0,n)}function PD(n,e){const t=n[0],r=n[1];return Pu(t,r,t,r,e)}function iA(n,e,t,r,i){const s=E1(i);return MD(s,n,e,t,r)}function sd(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function ND(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function Bm(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function MD(n,e,t,r,i){for(;t<r;t+=i)WU(n,e[t],e[t+1]);return n}function WU(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function LD(n,e){let t;return t=e(Ew(n)),t||(t=e(Sw(n)),t)||(t=e(Tw(n)),t)||(t=e(kd(n)),t)?t:!1}function lb(n){let e=0;return Id(n)||(e=mn(n)*ti(n)),e}function Ew(n){return[n[0],n[1]]}function Sw(n){return[n[2],n[1]]}function dl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function HU(n,e){let t;if(e==="bottom-left")t=Ew(n);else if(e==="bottom-right")t=Sw(n);else if(e==="top-left")t=kd(n);else if(e==="top-right")t=Tw(n);else throw new Error("Invalid corner");return t}function j_(n,e,t,r,i){const[s,a,o,l,c,h,g,m]=sA(n,e,t,r);return Pu(Math.min(s,o,c,g),Math.min(a,l,h,m),Math.max(s,o,c,g),Math.max(a,l,h,m),i)}function sA(n,e,t,r){const i=e*r[0]/2,s=e*r[1]/2,a=Math.cos(t),o=Math.sin(t),l=i*a,c=i*o,h=s*a,g=s*o,m=n[0],x=n[1];return[m-l+g,x-c-h,m-l-g,x-c+h,m+l-g,x+c+h,m+l+g,x+c-h,m-l+g,x-c-h]}function ti(n){return n[3]-n[1]}function Va(n,e,t){const r=t||$s();return Es(n,e)?(n[0]>e[0]?r[0]=n[0]:r[0]=e[0],n[1]>e[1]?r[1]=n[1]:r[1]=e[1],n[2]<e[2]?r[2]=n[2]:r[2]=e[2],n[3]<e[3]?r[3]=n[3]:r[3]=e[3]):E1(r),r}function kd(n){return[n[0],n[3]]}function Tw(n){return[n[2],n[3]]}function mn(n){return n[2]-n[0]}function Es(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Id(n){return n[2]<n[0]||n[3]<n[1]}function KU(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function XU(n,e,t){let r=!1;const i=ob(n,e),s=ob(n,t);if(i===Ei.INTERSECTING||s===Ei.INTERSECTING)r=!0;else{const a=n[0],o=n[1],l=n[2],c=n[3],h=e[0],g=e[1],m=t[0],x=t[1],y=(x-g)/(m-h);let _,w;s&Ei.ABOVE&&!(i&Ei.ABOVE)&&(_=m-(x-c)/y,r=_>=a&&_<=l),!r&&s&Ei.RIGHT&&!(i&Ei.RIGHT)&&(w=x-(m-l)*y,r=w>=o&&w<=c),!r&&s&Ei.BELOW&&!(i&Ei.BELOW)&&(_=m-(x-o)/y,r=_>=a&&_<=l),!r&&s&Ei.LEFT&&!(i&Ei.LEFT)&&(w=x-(m-a)*y,r=w>=o&&w<=c)}return r}function OD(n,e){const t=e.getExtent(),r=dl(n);if(e.canWrapX()&&(r[0]<t[0]||r[0]>=t[2])){const i=mn(t),a=Math.floor((r[0]-t[0])/i)*i;n[0]-=a,n[2]-=a}return n}function DD(n,e,t){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[r[0],n[1],r[2],n[3]]];OD(n,e);const i=mn(r);if(mn(n)>i&&!t)return[[r[0],n[1],r[2],n[3]]];if(n[0]<r[0])return[[n[0]+i,n[1],r[2],n[3]],[r[0],n[1],n[2],n[3]]];if(n[2]>r[2])return[[n[0],n[1],r[2],n[3]],[r[0],n[1],n[2]-i,n[3]]]}return[n]}function ur(n,e,t){return Math.min(Math.max(n,e),t)}function qU(n,e,t,r,i,s){const a=i-t,o=s-r;if(a!==0||o!==0){const l=((n-t)*a+(e-r)*o)/(a*a+o*o);l>1?(t=i,r=s):l>0&&(t+=a*l,r+=o*l)}return Yh(n,e,t,r)}function Yh(n,e,t,r){const i=t-n,s=r-e;return i*i+s*s}function YU(n){const e=n.length;for(let r=0;r<e;r++){let i=r,s=Math.abs(n[r][r]);for(let o=r+1;o<e;o++){const l=Math.abs(n[o][r]);l>s&&(s=l,i=o)}if(s===0)return null;const a=n[i];n[i]=n[r],n[r]=a;for(let o=r+1;o<e;o++){const l=-n[o][r]/n[r][r];for(let c=r;c<e+1;c++)r==c?n[o][c]=0:n[o][c]+=l*n[r][c]}}const t=new Array(e);for(let r=e-1;r>=0;r--){t[r]=n[r][e]/n[r][r];for(let i=r-1;i>=0;i--)n[i][e]-=n[i][r]*t[r]}return t}function sN(n){return n*180/Math.PI}function ql(n){return n*Math.PI/180}function wu(n,e){const t=n%e;return t*e<0?t+e:t}function la(n,e,t){return n+t*(e-n)}function S1(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function F_(n,e){return Math.round(S1(n,e))}function vy(n,e){return Math.floor(S1(n,e))}function uu(n,e){return Math.ceil(S1(n,e))}function cb(n,e,t){if(n>=e&&n<t)return n;const r=t-e;return((n-e)%r+r)%r+e}function cm(n,e,t){const r=""+n;let i=r.indexOf(".");return i=i===-1?r.length:i,i>e?r:new Array(1+e-i).join("0")+r}function jD(n,e){const t=(""+n).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(t.length,r.length);i++){const s=parseInt(t[i]||"0",10),a=parseInt(r[i]||"0",10);if(s>a)return 1;if(a>s)return-1}return 0}function ZU(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function V_(n,e){let t=!0;for(let r=n.length-1;r>=0;--r)if(n[r]!=e[r]){t=!1;break}return t}function aA(n,e){const t=Math.cos(e),r=Math.sin(e),i=n[0]*t-n[1]*r,s=n[1]*t+n[0]*r;return n[0]=i,n[1]=s,n}function JU(n,e){return n[0]*=e,n[1]*=e,n}function FD(n,e){if(e.canWrapX()){const t=mn(e.getExtent()),r=VD(n,e,t);r&&(n[0]-=r*t)}return n}function VD(n,e,t){const r=e.getExtent();let i=0;return e.canWrapX()&&(n[0]<r[0]||n[0]>r[2])&&(t=t||mn(r),i=Math.floor((n[0]-r[0])/t)),i}function BD(...n){console.warn(...n)}const L0={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let bw=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||L0[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const T1=6378137,r0=Math.PI*T1,QU=[-r0,-r0,r0,r0],e$=[-180,-85,180,85],wy=T1*Math.log(Math.tan(Math.PI/2));class Sf extends bw{constructor(e){super({code:e,units:"m",extent:QU,global:!0,worldExtent:e$,getPointResolution:function(t,r){return t/Math.cosh(r[1]/T1)}})}}const aN=[new Sf("EPSG:3857"),new Sf("EPSG:102100"),new Sf("EPSG:102113"),new Sf("EPSG:900913"),new Sf("http://www.opengis.net/def/crs/EPSG/0/3857"),new Sf("http://www.opengis.net/gml/srs/epsg.xml#3857")];function t$(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r){e[s]=r0*n[s]/180;let a=T1*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));a>wy?a=wy:a<-wy&&(a=-wy),e[s+1]=a}return e}function n$(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r)e[s]=180*n[s]/r0,e[s+1]=360*Math.atan(Math.exp(n[s+1]/T1))/Math.PI-90;return e}const r$=6378137,oN=[-180,-90,180,90],i$=Math.PI*r$/180;class vh extends bw{constructor(e,t){super({code:e,units:"degrees",extent:oN,axisOrientation:t,global:!0,metersPerUnit:i$,worldExtent:oN})}}const lN=[new vh("CRS:84"),new vh("EPSG:4326","neu"),new vh("urn:ogc:def:crs:OGC:1.3:CRS84"),new vh("urn:ogc:def:crs:OGC:2:84"),new vh("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new vh("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new vh("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let ub={};function o_(n){return ub[n]||ub[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function s$(n,e){ub[n]=e}let m0={};function ad(n,e,t){const r=n.getCode(),i=e.getCode();r in m0||(m0[r]={}),m0[r][i]=t}function l_(n,e){return n in m0&&e in m0[n]?m0[n][e]:null}const B_=.9996,Ba=.00669438,Rw=Ba*Ba,Aw=Rw*Ba,Bh=Ba/(1-Ba),cN=Math.sqrt(1-Ba),O0=(1-cN)/(1+cN),GD=O0*O0,oA=GD*O0,lA=oA*O0,zD=lA*O0,UD=1-Ba/4-3*Rw/64-5*Aw/256,a$=3*Ba/8+3*Rw/32+45*Aw/1024,o$=15*Rw/256+45*Aw/1024,l$=35*Aw/3072,c$=3/2*O0-27/32*oA+269/512*zD,u$=21/16*GD-55/32*lA,h$=151/96*oA-417/128*zD,d$=1097/512*lA,G_=6378137;function f$(n,e,t){const r=n-5e5,a=(t.north?e:e-1e7)/B_/(G_*UD),o=a+c$*Math.sin(2*a)+u$*Math.sin(4*a)+h$*Math.sin(6*a)+d$*Math.sin(8*a),l=Math.sin(o),c=l*l,h=Math.cos(o),g=l/h,m=g*g,x=m*m,y=1-Ba*c,_=Math.sqrt(1-Ba*c),w=G_/_,T=(1-Ba)/y,b=Bh*h**2,R=b*b,M=r/(w*B_),D=M*M,B=D*M,k=B*M,A=k*M,C=A*M,O=o-g/T*(D/2-k/24*(5+3*m+10*b-4*R-9*Bh))+C/720*(61+90*m+298*b+45*x-252*Bh-3*R);let P=(M-B/6*(1+2*m+b)+A/120*(5-2*b+28*m-3*R+8*Bh+24*x))/h;return P=cb(P+ql($D(t.number)),-Math.PI,Math.PI),[sN(P),sN(O)]}const uN=-80,hN=84,g$=-180,m$=180;function p$(n,e,t){n=cb(n,g$,m$),e<uN?e=uN:e>hN&&(e=hN);const r=ql(e),i=Math.sin(r),s=Math.cos(r),a=i/s,o=a*a,l=o*o,c=ql(n),h=$D(t.number),g=ql(h),m=G_/Math.sqrt(1-Ba*i**2),x=Bh*s**2,y=s*cb(c-g,-Math.PI,Math.PI),_=y*y,w=_*y,T=w*y,b=T*y,R=b*y,M=G_*(UD*r-a$*Math.sin(2*r)+o$*Math.sin(4*r)-l$*Math.sin(6*r)),D=B_*m*(y+w/6*(1-o+x)+b/120*(5-18*o+l+72*x-58*Bh))+5e5;let B=B_*(M+m*a*(_/2+T/24*(5-o+9*x+4*x**2)+R/720*(61-58*o+l+600*x-330*Bh)));return t.north||(B+=1e7),[D,B]}function $D(n){return(n-1)*6-180+3}const x$=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function WD(n){let e=0;for(const i of x$){const s=n.match(i);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,r=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(r=!0,t=e-32600),t?{number:t,north:r}:null}function dN(n,e){return function(t,r,i,s){const a=t.length;i=i>1?i:2,s=s??i,r||(i>2?r=t.slice():r=new Array(a));for(let o=0;o<a;o+=s){const l=t[o],c=t[o+1],h=n(l,c,e);r[o]=h[0],r[o+1]=h[1]}return r}}function y$(n){return WD(n)?new bw({code:n,units:"m"}):null}function _$(n){const e=WD(n.getCode());return e?{forward:dN(p$,e),inverse:dN(f$,e)}:null}const v$=63710088e-1;function fN(n,e,t){t=t||v$;const r=ql(n[1]),i=ql(e[1]),s=(i-r)/2,a=ql(e[0]-n[0])/2,o=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(i);return 2*t*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}const w$=[_$],E$=[y$];let hb=!0;function HD(n){hb=!1}function cA(n,e){if(e!==void 0){for(let t=0,r=n.length;t<r;++t)e[t]=n[t];e=e}else e=n.slice();return e}function z_(n){s$(n.getCode(),n),ad(n,n,cA)}function S$(n){n.forEach(z_)}function ir(n){if(typeof n!="string")return n;const e=o_(n);if(e)return e;for(const t of E$){const r=t(n);if(r)return r}return null}function U_(n,e,t,r){n=ir(n);let i;const s=n.getPointResolutionFunc();if(s){if(i=s(e,t),r&&r!==n.getUnits()){const a=n.getMetersPerUnit();a&&(i=i*a/L0[r])}}else{const a=n.getUnits();if(a=="degrees"&&!r||r=="degrees")i=e;else{const o=hA(n,ir("EPSG:4326"));if(!o&&a!=="degrees")i=e*n.getMetersPerUnit();else{let c=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];c=o(c,c,2);const h=fN(c.slice(0,2),c.slice(2,4)),g=fN(c.slice(4,6),c.slice(6,8));i=(h+g)/2}const l=r?L0[r]:n.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function db(n){S$(n),n.forEach(function(e){n.forEach(function(t){e!==t&&ad(e,t,cA)})})}function T$(n,e,t,r){n.forEach(function(i){e.forEach(function(s){ad(i,s,t),ad(s,i,r)})})}function uA(n,e){return n?typeof n=="string"?ir(n):n:ir(e)}function fb(n){return(function(e,t,r,i){const s=e.length;r=r!==void 0?r:2,i=i??r,t=t!==void 0?t:new Array(s);for(let a=0;a<s;a+=i){const o=n(e.slice(a,a+r)),l=o.length;for(let c=0,h=i;c<h;++c)t[a+c]=c>=l?e[a+c]:o[c]}return t})}function b$(n,e,t,r){const i=ir(n),s=ir(e);ad(i,s,fb(t)),ad(s,i,fb(r))}function kr(n,e){return HD(),b1(n,"EPSG:4326","EPSG:3857")}function Tn(n,e){const t=b1(n,"EPSG:3857","EPSG:4326"),r=t[0];return(r<-180||r>180)&&(t[0]=wu(r+180,360)-180),t}function Zh(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||hA(n,e)===cA)&&t}function hA(n,e){const t=n.getCode(),r=e.getCode();let i=l_(t,r);if(i)return i;let s=null,a=null;for(const l of w$)s||(s=l(n)),a||(a=l(e));if(!s&&!a)return null;const o="EPSG:4326";if(a)if(s)i=SS(s.inverse,a.forward);else{const l=l_(t,o);l&&(i=SS(l,a.forward))}else{const l=l_(o,r);l&&(i=SS(s.inverse,l))}return i&&(z_(n),z_(e),ad(n,e,i)),i}function SS(n,e){return function(t,r,i,s){return r=n(t,r,i,s),e(r,r,i,s)}}function Ep(n,e){const t=ir(n),r=ir(e);return hA(t,r)}function b1(n,e,t){const r=Ep(e,t);if(!r){const i=ir(e).getCode(),s=ir(t).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return r(n,void 0,n.length)}function gb(n,e){return n}function Vl(n,e){return hb&&!V_(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(hb=!1,BD("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function KD(n,e){return n}function Oa(n,e){return n}function gN(n,e,t){return function(r){let i,s;if(n.canWrapX()){const a=n.getExtent(),o=mn(a);r=r.slice(0),s=VD(r,n,o),s&&(r[0]=r[0]-s*o),r[0]=ur(r[0],a[0],a[2]),r[1]=ur(r[1],a[1],a[3]),i=t(r)}else i=t(r);return s&&e.canWrapX()&&(i[0]+=s*mn(e.getExtent())),i}}function R$(){db(aN),db(lN),T$(lN,aN,t$,n$)}R$();const dA=new Array(6);function ni(){return[1,0,0,1,0,0]}function A$(n){return Iw(n,1,0,0,1,0,0)}function kw(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=n[4],o=n[5],l=e[0],c=e[1],h=e[2],g=e[3],m=e[4],x=e[5];return n[0]=t*l+i*c,n[1]=r*l+s*c,n[2]=t*h+i*g,n[3]=r*h+s*g,n[4]=t*m+i*x+a,n[5]=r*m+s*x+o,n}function Iw(n,e,t,r,i,s,a){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n[4]=s,n[5]=a,n}function XD(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Cr(n,e){const t=e[0],r=e[1];return e[0]=n[0]*t+n[2]*r+n[4],e[1]=n[1]*t+n[3]*r+n[5],e}function k$(n,e){const t=Math.cos(e),r=Math.sin(e);return kw(n,Iw(dA,t,r,-r,t,0,0))}function mN(n,e,t){return kw(n,Iw(dA,e,0,0,t,0,0))}function qD(n,e,t){return kw(n,Iw(dA,1,0,0,1,e,t))}function $a(n,e,t,r,i,s,a,o){const l=Math.sin(s),c=Math.cos(s);return n[0]=r*c,n[1]=i*l,n[2]=-r*l,n[3]=i*c,n[4]=a*r*c-o*r*l+e,n[5]=a*i*l+o*i*c+t,n}function Sp(n,e){const t=I$(e);Rn(t!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=e[5];return n[0]=a/t,n[1]=-i/t,n[2]=-s/t,n[3]=r/t,n[4]=(s*l-a*o)/t,n[5]=-(r*l-i*o)/t,n}function I$(n){return n[0]*n[3]-n[1]*n[2]}const C$=[1e5,1e5,1e5,1e5,2,2];function P$(n){return"matrix("+n.join(", ")+")"}function mb(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function N$(n,e){const t=mb(n),r=mb(e);for(let i=0;i<6;++i)if(Math.round((t[i]-r[i])*C$[i])!==0)return!1;return!0}function rl(n,e,t,r,i,s,a){s=s||[],a=a||2;let o=0;for(let l=e;l<t;l+=r){const c=n[l],h=n[l+1];s[o++]=i[0]*c+i[2]*h+i[4],s[o++]=i[1]*c+i[3]*h+i[5];for(let g=2;g<a;g++)s[o++]=n[l+g]}return s&&s.length!=o&&(s.length=o),s}function YD(n,e,t,r,i,s,a){a=a||[];const o=Math.cos(i),l=Math.sin(i),c=s[0],h=s[1];let g=0;for(let m=e;m<t;m+=r){const x=n[m]-c,y=n[m+1]-h;a[g++]=c+x*o-y*l,a[g++]=h+x*l+y*o;for(let _=m+2;_<m+r;++_)a[g++]=n[_]}return a&&a.length!=g&&(a.length=g),a}function M$(n,e,t,r,i,s,a,o){o=o||[];const l=a[0],c=a[1];let h=0;for(let g=e;g<t;g+=r){const m=n[g]-l,x=n[g+1]-c;o[h++]=l+i*m,o[h++]=c+s*x;for(let y=g+2;y<g+r;++y)o[h++]=n[y]}return o&&o.length!=h&&(o.length=h),o}function L$(n,e,t,r,i,s,a){a=a||[];let o=0;for(let l=e;l<t;l+=r){a[o++]=n[l]+i,a[o++]=n[l+1]+s;for(let c=l+2;c<l+r;++c)a[o++]=n[c]}return a&&a.length!=o&&(a.length=o),a}const pN=ni(),O$=[NaN,NaN];class ZD extends _l{constructor(){super(),this.extent_=$s(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=AD((e,t,r)=>{if(!r)return this.getSimplifiedGeometry(t);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return Wt()}closestPointXY(e,t,r,i){return Wt()}containsXY(e,t){return this.closestPointXY(e,t,O$,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Wt()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&E1(t),this.extentRevision_=this.getRevision()}return KU(this.extent_,e)}rotate(e,t){Wt()}scale(e,t,r){Wt()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Wt()}getType(){return Wt()}applyTransform(e){Wt()}intersectsExtent(e){return Wt()}translate(e,t){Wt()}transform(e,t){const r=ir(e),i=r.getUnits()=="tile-pixels"?function(s,a,o){const l=r.getExtent(),c=r.getWorldExtent(),h=ti(c)/ti(l);$a(pN,c[0],c[3],h,-h,0,0,0);const g=rl(s,0,s.length,o,pN,a),m=Ep(r,t);return m?m(g,g,o):g}:Ep(r,t);return this.applyTransform(i),this}}class Cd extends ZD{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return iA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Wt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=xN(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){Wt()}setLayout(e,t,r){let i;if(e)i=xN(e);else{for(let s=0;s<r;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}i=t.length,e=Pd(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();YD(r,0,r.length,i,e,t,r),this.changed()}}scale(e,t,r){t===void 0&&(t=e),r||(r=dl(this.getExtent()));const i=this.getFlatCoordinates();if(i){const s=this.getStride();M$(i,0,i.length,s,e,t,r,i),this.changed()}}translate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();L$(r,0,r.length,i,e,t,r),this.changed()}}}function Pd(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function xN(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function D$(n,e,t){const r=n.getFlatCoordinates();if(!r)return null;const i=n.getStride();return rl(r,0,r.length,i,e,t)}function yN(n,e,t,r,i,s,a){const o=n[e],l=n[e+1],c=n[t]-o,h=n[t+1]-l;let g;if(c===0&&h===0)g=e;else{const m=((i-o)*c+(s-l)*h)/(c*c+h*h);if(m>1)g=t;else if(m>0){for(let x=0;x<r;++x)a[x]=la(n[e+x],n[t+x],m);a.length=r;return}else g=e}for(let m=0;m<r;++m)a[m]=n[g+m];a.length=r}function fA(n,e,t,r,i){let s=n[e],a=n[e+1];for(e+=r;e<t;e+=r){const o=n[e],l=n[e+1],c=Yh(s,a,o,l);c>i&&(i=c),s=o,a=l}return i}function gA(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=fA(n,e,o,r,i),e=o}return i}function j$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=gA(n,e,o,r,i),e=o[o.length-1]}return i}function mA(n,e,t,r,i,s,a,o,l,c,h){if(e==t)return c;let g,m;if(i===0){if(m=Yh(a,o,n[e],n[e+1]),m<c){for(g=0;g<r;++g)l[g]=n[e+g];return l.length=r,m}return c}h=h||[NaN,NaN];let x=e+r;for(;x<t;)if(yN(n,x-r,x,r,a,o,h),m=Yh(a,o,h[0],h[1]),m<c){for(c=m,g=0;g<r;++g)l[g]=h[g];l.length=r,x+=r}else x+=r*Math.max((Math.sqrt(m)-Math.sqrt(c))/i|0,1);if(s&&(yN(n,t-r,e,r,a,o,h),m=Yh(a,o,h[0],h[1]),m<c)){for(c=m,g=0;g<r;++g)l[g]=h[g];l.length=r}return c}function pA(n,e,t,r,i,s,a,o,l,c,h){h=h||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const x=t[g];c=mA(n,e,x,r,i,s,a,o,l,c,h),e=x}return c}function F$(n,e,t,r,i,s,a,o,l,c,h){h=h||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const x=t[g];c=pA(n,e,x,r,i,s,a,o,l,c,h),e=x[x.length-1]}return c}function V$(n,e,t,r){for(let i=0,s=t.length;i<s;++i)n[e++]=t[i];return e}function Cw(n,e,t,r){for(let i=0,s=t.length;i<s;++i){const a=t[i];for(let o=0;o<r;++o)n[e++]=a[o]}return e}function R1(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=Cw(n,e,t[a],r);i[s++]=l,e=l}return i.length=s,i}function JD(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=R1(n,e,t[a],r,i[s]);l.length===0&&(l[0]=e),i[s++]=l,e=l[l.length-1]}return i.length=s,i}function hu(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=e;a<t;a+=r)i[s++]=n.slice(a,a+r);return i.length=s,i}function Tp(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=hu(n,e,l,r,i[s]),e=l}return i.length=s,i}function pb(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=l.length===1&&l[0]===e?[]:Tp(n,e,l,r,i[s]),e=l[l.length-1]}return i.length=s,i}function $_(n,e,t,r,i,s,a){let o,l;const c=(t-e)/r;if(c===1)o=e;else if(c===2)o=e,l=i;else if(c!==0){let h=n[e],g=n[e+1],m=0;const x=[0];for(let w=e+r;w<t;w+=r){const T=n[w],b=n[w+1];m+=Math.sqrt((T-h)*(T-h)+(b-g)*(b-g)),x.push(m),h=T,g=b}const y=i*m,_=VU(x,y);_<0?(l=(y-x[-_-2])/(x[-_-1]-x[-_-2]),o=e+(-_-2)*r):o=e+_*r}a=a>1?a:2,s=s||new Array(a);for(let h=0;h<a;++h)s[h]=o===void 0?NaN:l===void 0?n[o+h]:la(n[o+h],n[o+r+h],l);return s}function xb(n,e,t,r,i,s){if(t==e)return null;let a;if(i<n[e+r-1])return s?(a=n.slice(e,e+r),a[r-1]=i,a):null;if(n[t-1]<i)return s?(a=n.slice(t-r,t),a[r-1]=i,a):null;if(i==n[e+r-1])return n.slice(e,e+r);let o=e/r,l=t/r;for(;o<l;){const m=o+l>>1;i<n[(m+1)*r-1]?l=m:o=m+1}const c=n[o*r-1];if(i==c)return n.slice((o-1)*r,(o-1)*r+r);const h=n[(o+1)*r-1],g=(i-c)/(h-c);a=[];for(let m=0;m<r-1;++m)a.push(la(n[(o-1)*r+m],n[o*r+m],g));return a.push(i),a}function B$(n,e,t,r,i,s,a){if(a)return xb(n,e,t[t.length-1],r,i,s);let o;if(i<n[r-1])return s?(o=n.slice(0,r),o[r-1]=i,o):null;if(n[n.length-1]<i)return s?(o=n.slice(n.length-r),o[r-1]=i,o):null;for(let l=0,c=t.length;l<c;++l){const h=t[l];if(e!=h){if(i<n[e+r-1])return null;if(i<=n[h-1])return xb(n,e,h,r,i,!1);e=h}}return null}function G$(n,e,t,r,i){return!LD(i,function(a){return!Gh(n,e,t,r,a[0],a[1])})}function Gh(n,e,t,r,i,s){let a=0,o=n[t-r],l=n[t-r+1];for(;e<t;e+=r){const c=n[e],h=n[e+1];l<=s?h>s&&(c-o)*(s-l)-(i-o)*(h-l)>0&&a++:h<=s&&(c-o)*(s-l)-(i-o)*(h-l)<0&&a--,o=c,l=h}return a!==0}function xA(n,e,t,r,i,s){if(t.length===0||!Gh(n,e,t[0],r,i,s))return!1;for(let a=1,o=t.length;a<o;++a)if(Gh(n,t[a-1],t[a],r,i,s))return!1;return!0}function z$(n,e,t,r,i,s){if(t.length===0)return!1;for(let a=0,o=t.length;a<o;++a){const l=t[a];if(xA(n,e,l,r,i,s))return!0;e=l[l.length-1]}return!1}function QD(n,e,t,r,i){let s;for(e+=r;e<t;e+=r)if(s=i(n.slice(e-r,e),n.slice(e,e+r)),s)return s;return!1}function Pw(n,e,t,r,i,s){return s=s??MD($s(),n,e,t,r),Es(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:QD(n,e,t,r,function(a,o){return XU(i,a,o)}):!1}function U$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){if(Pw(n,e,t[s],r,i))return!0;e=t[s]}return!1}function ej(n,e,t,r,i){return!!(Pw(n,e,t,r,i)||Gh(n,e,t,r,i[0],i[1])||Gh(n,e,t,r,i[0],i[3])||Gh(n,e,t,r,i[2],i[1])||Gh(n,e,t,r,i[2],i[3]))}function tj(n,e,t,r,i){if(!ej(n,e,t[0],r,i))return!1;if(t.length===1)return!0;for(let s=1,a=t.length;s<a;++s)if(G$(n,t[s-1],t[s],r,i)&&!Pw(n,t[s-1],t[s],r,i))return!1;return!0}function $$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(tj(n,e,o,r,i))return!0;e=o[o.length-1]}return!1}function yA(n,e,t,r){let i=n[e],s=n[e+1],a=0;for(let o=e+r;o<t;o+=r){const l=n[o],c=n[o+1];a+=Math.sqrt((l-i)*(l-i)+(c-s)*(c-s)),i=l,s=c}return a}function Nw(n,e,t,r,i,s,a){const o=(t-e)/r;if(o<3){for(;e<t;e+=r)s[a++]=n[e],s[a++]=n[e+1];return a}const l=new Array(o);l[0]=1,l[o-1]=1;const c=[e,t-r];let h=0;for(;c.length>0;){const g=c.pop(),m=c.pop();let x=0;const y=n[m],_=n[m+1],w=n[g],T=n[g+1];for(let b=m+r;b<g;b+=r){const R=n[b],M=n[b+1],D=qU(R,M,y,_,w,T);D>x&&(h=b,x=D)}x>i&&(l[(h-e)/r]=1,m+r<h&&c.push(m,h),h+r<g&&c.push(h,g))}for(let g=0;g<o;++g)l[g]&&(s[a++]=n[e+g*r],s[a++]=n[e+g*r+1]);return a}function nj(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l];a=Nw(n,e,h,r,i,s,a),o.push(a),e=h}return a}function bh(n,e){return e*Math.round(n/e)}function W$(n,e,t,r,i,s,a){if(e==t)return a;let o=bh(n[e],i),l=bh(n[e+1],i);e+=r,s[a++]=o,s[a++]=l;let c,h;do if(c=bh(n[e],i),h=bh(n[e+1],i),e+=r,e==t)return s[a++]=c,s[a++]=h,a;while(c==o&&h==l);for(;e<t;){const g=bh(n[e],i),m=bh(n[e+1],i);if(e+=r,g==c&&m==h)continue;const x=c-o,y=h-l,_=g-o,w=m-l;if(x*w==y*_&&(x<0&&_<x||x==_||x>0&&_>x)&&(y<0&&w<y||y==w||y>0&&w>y)){c=g,h=m;continue}s[a++]=c,s[a++]=h,o=c,l=h,c=g,h=m}return s[a++]=c,s[a++]=h,a}function _A(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l];a=W$(n,e,h,r,i,s,a),o.push(a),e=h}return a}function H$(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l],g=[];a=_A(n,e,h,r,i,s,a,g),o.push(g),e=h[h.length-1]}return a}class bi extends Cd{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){zn(this.flatCoordinates,e),this.changed()}clone(){const e=new bi(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<Ad(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(fA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),mA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,r,i))}forEachSegment(e){return QD(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,xb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return hu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return $_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return yA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=Nw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new bi(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return Pw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Cw(this.flatCoordinates,0,e,this.stride),this.changed()}}let gi=class rj extends Cd{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new rj(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){const s=this.flatCoordinates,a=Yh(e,t,s[0],s[1]);if(a<i){const o=this.stride;for(let l=0;l<o;++l)r[l]=s[l];return r.length=o,a}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return PD(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return rA(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=V$(this.flatCoordinates,0,e,this.stride),this.changed()}};const Ti={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},od=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",K$=od.includes("safari")&&!od.includes("chrom"),X$=K$&&(od.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(od)),q$=od.includes("webkit")&&!od.includes("edge"),ij=od.includes("macintosh"),Y$=typeof devicePixelRatio<"u"?devicePixelRatio:1,da=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,vA=typeof Image<"u"&&Image.prototype.decode,sj=typeof createImageBitmap=="function",aj=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),bt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Kr(n,e,t,r){let i;return t&&t.length?i=t.shift():da?i=new class extends OffscreenCanvas{style={}}(n??300,e??150):i=document.createElement("canvas"),n&&(i.width=n),e&&(i.height=e),i.getContext("2d",r)}let TS;function W_(){return TS||(TS=Kr(1,1)),TS}function Mw(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function _N(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function Z$(n){for(;n.lastChild;)n.lastChild.remove()}function J$(n,e){const t=n.childNodes;for(let r=0;;++r){const i=t[r],s=e[r];if(!i&&!s)break;if(i!==s){if(!i){n.appendChild(s);continue}if(!s){n.removeChild(i),--r;continue}n.insertBefore(s,i)}}}function oj(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const r=this.childNodes.indexOf(t);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,t,r){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,r)}})}function du(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const wA=[NaN,NaN,NaN,0];let bS;function Q$(){return bS||(bS=Kr(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),bS}const eW=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,tW=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,nW=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,rW=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Ey(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function Gm(n){throw new Error('failed to parse "'+n+'" as color')}function lj(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(tW)||n.match(eW)||n.match(nW);if(s){const a=s[4],o=100/255;return[ur(Ey(s[1],o)+.5|0,0,255),ur(Ey(s[2],o)+.5|0,0,255),ur(Ey(s[3],o)+.5|0,0,255),a!==void 0?ur(Ey(a,100),0,1):1]}Gm(n)}if(n.startsWith("#")){if(rW.test(n)){const s=n.substring(1),a=s.length<=4?1:2,o=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=a){let h=parseInt(s.substring(l,l+a),16);a===1&&(h+=h<<4),o[l/a]=h}return o[3]=o[3]/255,o}Gm(n)}const e=Q$();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&Gm(n));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return lj(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=S1(i[3]/255,3),i}function iW(n){return typeof n=="string"?n:SA(n)}const sW=1024,um={};let RS=0;function aW(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function AS(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function kS(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function IS(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function CS(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function vN(n){const e=IS(n[0]),t=IS(n[1]),r=IS(n[2]),i=CS(e*.222488403+t*.716873169+r*.06060791),s=500*(CS(e*.452247074+t*.399439023+r*.148375274)-i),a=200*(i-CS(e*.016863605+t*.117638439+r*.865350722)),o=Math.atan2(a,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+a*a),o<0?o+360:o,n[3]]}function oW(n){const e=(n[0]+16)/116,t=n[1],r=n[2]*Math.PI/180,i=kS(e),s=kS(e+t/500*Math.cos(r)),a=kS(e-t/200*Math.sin(r)),o=AS(s*3.021973625-i*1.617392459-a*.404875592),l=AS(s*-.943766287+i*1.916279586+a*.027607165),c=AS(s*.069407491-i*.22898585+a*1.159737864);return[ur(o+.5|0,0,255),ur(l+.5|0,0,255),ur(c+.5|0,0,255),n[3]]}function EA(n){if(n==="none")return wA;if(um.hasOwnProperty(n))return um[n];if(RS>=sW){let t=0;for(const r in um)(t++&3)===0&&(delete um[r],--RS)}const e=lj(n);e.length!==4&&Gm(n);for(const t of e)isNaN(t)&&Gm(n);return um[n]=e,++RS,e}function Wa(n){return Array.isArray(n)?n:EA(n)}function SA(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let r=n[2];r!=(r|0)&&(r=r+.5|0);const i=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+r+","+i+")"}class cj extends cg{constructor(e,t,r,i){super(),this.extent=e,this.pixelRatio_=r,this.resolution=t,this.state=typeof i=="function"?bt.IDLE:i,this.image_=null,this.loader=typeof i=="function"?i:null}changed(){this.dispatchEvent(Kt.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==bt.IDLE&&this.loader){this.state=bt.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;kD(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(r=>{"image"in r&&(this.image_=r.image),"extent"in r&&(this.extent=r.extent),"resolution"in r&&(this.resolution=r.resolution),"pixelRatio"in r&&(this.pixelRatio_=r.pixelRatio),(r instanceof HTMLImageElement||sj&&r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement)&&(this.image_=r),this.state=bt.LOADED}).catch(r=>{this.state=bt.ERROR,console.error(r)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function lW(n,e,t){const r=n;let i=!0,s=!1,a=!1;const o=[D_(r,Kt.LOAD,function(){a=!0,s||e()})];return r.src&&vA?(s=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(a?e():t())})):o.push(D_(r,Kt.ERROR,t)),function(){i=!1,o.forEach(or)}}function cW(n,e){return new Promise((t,r)=>{function i(){a(),t(n)}function s(){a(),r(new Error("Image load error"))}function a(){n.removeEventListener("load",i),n.removeEventListener("error",s)}n.addEventListener("load",i),n.addEventListener("error",s)})}function uj(n,e){return e&&(n.src=e),n.src&&vA?new Promise((t,r)=>n.decode().then(()=>t(n)).catch(i=>n.complete&&n.width?t(n):r(i))):cW(n)}function hj(n,e){return e&&(n.src=e),n.src&&vA&&sj?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):uj(n)}class uW{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const r=this.cache_[t];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,r){const i=PS(e,t,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,t,r){const i=PS(e,t,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,t,r,i,s){const a=PS(e,t,r),o=a in this.cache_;this.cache_[a]=i,s&&(i.getImageState()===bt.IDLE&&i.load(),i.getImageState()===bt.LOADING?i.ready().then(()=>{this.patternCache_[a]=W_().createPattern(i.getImage(1),"repeat")}):this.patternCache_[a]=W_().createPattern(i.getImage(1),"repeat")),o||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function PS(n,e,t){const r=t?Wa(t):"null";return e+":"+n+":"+r}const Da=new uW;let hm=null;class dj extends cg{constructor(e,t,r,i,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=s,this.imageState_=i===void 0?bt.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===bt.LOADED){hm||(hm=Kr(1,1,void 0,{willReadFrequently:!0})),hm.drawImage(this.image_,0,0);try{hm.getImageData(0,0,1,1),this.tainted_=!1}catch{hm=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Kt.CHANGE)}handleImageError_(){this.imageState_=bt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=bt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],r=Kr(e,t);r.fillRect(0,0,e,t),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===bt.IDLE){this.image_||this.initializeImage_(),this.imageState_=bt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&uj(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==bt.LOADED)return;const t=this.image_,r=Kr(Math.ceil(t.width*e),Math.ceil(t.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(t,0,0),r.globalCompositeOperation="multiply",r.fillStyle=iW(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===bt.LOADED||this.imageState_===bt.ERROR)e();else{const t=()=>{(this.imageState_===bt.LOADED||this.imageState_===bt.ERROR)&&(this.removeEventListener(Kt.CHANGE,t),e())};this.addEventListener(Kt.CHANGE,t)}})),this.ready_}}function H_(n,e,t,r,i,s){let a=e===void 0?void 0:Da.get(e,t,i);return a||(a=new dj(n,n&&"src"in n?n.src||void 0:e,t,r,i),Da.set(e,t,i,a,s)),s&&a&&!Da.getPattern(e,t,i)&&Da.set(e,t,i,a,s),a}function el(n){return n?Array.isArray(n)?SA(n):typeof n=="object"&&"src"in n?hW(n):n:null}function hW(n){if(!n.offset||!n.size)return Da.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Da.getPattern(e,void 0,n.color);if(t)return t;const r=Da.get(n.src,"anonymous",null);if(r.getImageState()!==bt.LOADED)return null;const i=Kr(n.size[0],n.size[1]);return i.drawImage(r.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),H_(i.canvas,e,void 0,bt.LOADED,n.color,!0),Da.getPattern(e,void 0,n.color)}class fj{drawCustom(e,t,r,i,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,r){}drawFeature(e,t,r){}drawGeometryCollection(e,t,r){}drawLineString(e,t,r){}drawMultiLineString(e,t,r){}drawMultiPoint(e,t,r){}drawMultiPolygon(e,t,r){}drawPoint(e,t,r){}drawPolygon(e,t,r){}drawText(e,t,r){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Sy="ol-hidden",A1="ol-unselectable",TA="ol-control",wN="ol-collapsed",dW=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),EN=["style","variant","weight","size","lineHeight","family"],yb={normal:400,bold:700},_b=function(n){const e=n.match(dW);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=EN.length;r<i;++r){const s=e[r+1];s!==void 0&&(t[EN[r]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in yb&&(t.weight=yb[t.weight]),t.families=t.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),t},gj="10px sans-serif",js="#000",D0="round",Yl=[],Zl=0,j0="round",bp=10,Rp="#000",Ap="center",K_="middle",zh=[0,0,0,0],kp=1,zf=new _l;let dm=null,SN;const vb={},fW=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function gW(n,e,t){return`${n} ${e} 16px "${t}"`}const mW=(function(){let e,t;async function r(s){await t.ready;const a=await t.load(s);if(a.length===0)return!1;const o=_b(s),l=o.families[0].toLowerCase(),c=o.weight;return a.some(h=>{const g=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),m=yb[h.weight]||h.weight;return g===l&&h.style===o.style&&m==c})}async function i(){await t.ready;let s=!0;const a=zf.getProperties(),o=Object.keys(a).filter(l=>a[l]<100);for(let l=o.length-1;l>=0;--l){const c=o[l];let h=a[c];h<100&&(await r(c)?(lg(vb),zf.set(c,100)):(h+=10,zf.set(c,h,!0),h<100&&(s=!1)))}e=void 0,s||(e=setTimeout(i,100))}return async function(s){t||(t=da?self.fonts:document.fonts);const a=_b(s);if(!a)return;const o=a.families;let l=!1;for(const c of o){if(fW.has(c))continue;const h=gW(a.style,a.weight,c);zf.get(h)===void 0&&(zf.set(h,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(i,100))}})(),pW=(function(){let n;return function(e){let t=vb[e];if(t==null){if(da){const r=_b(e),i=mj(e,"g");t=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);vb[e]=t}return t}})();function mj(n,e){return dm||(dm=Kr(1,1)),n!=SN&&(dm.font=n,SN=dm.font),dm.measureText(e)}function pj(n,e){return mj(n,e).width}function TN(n,e,t){if(e in t)return t[e];const r=e.split(`
`).reduce((i,s)=>Math.max(i,pj(n,s)),0);return t[e]=r,r}function xW(n,e){const t=[],r=[],i=[];let s=0,a=0,o=0,l=0;for(let c=0,h=e.length;c<=h;c+=2){const g=e[c];if(g===`
`||c===h){s=Math.max(s,a),i.push(a),a=0,o+=l,l=0;continue}const m=e[c+1]||n.font,x=pj(m,g);t.push(x),a+=x;const y=pW(m);r.push(y),l=Math.max(l,y)}return{width:s,height:o,widths:t,heights:r,lineWidths:i}}function yW(n,e,t,r,i,s,a,o,l,c,h){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=g=>g.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),r.contextInstructions?(n.translate(l,c),n.scale(h[0],h[1]),_W(r,n)):h[0]<0||h[1]<0?(n.translate(l,c),n.scale(h[0],h[1]),n.drawImage(r,i,s,a,o,0,0,a,o)):n.drawImage(r,i,s,a,o,l,c,a*h[0],o*h[1]),n.restore()}function _W(n,e){const t=n.contextInstructions;for(let r=0,i=t.length;r<i;r+=2)Array.isArray(t[r+1])?e[t[r]].apply(e,t[r+1]):e[t[r]]=t[r+1]}class vW extends fj{constructor(e,t,r,i,s,a,o){super(),this.context_=e,this.pixelRatio_=t,this.extent_=r,this.transform_=i,this.transformRotation_=i?S1(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=a,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=ni()}drawImages_(e,t,r,i){if(!this.image_)return;const s=rl(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_,o=this.tmpLocalTransform_,l=a.globalAlpha;this.imageOpacity_!=1&&(a.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,g=s.length;h<g;h+=2){const m=s[h]-this.imageAnchorX_,x=s[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const y=m+this.imageAnchorX_,_=x+this.imageAnchorY_;$a(o,y,_,1,1,c,-y,-_),a.save(),a.transform.apply(a,o),a.translate(y,_),a.scale(this.imageScale_[0],this.imageScale_[1]),a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),a.restore()}else a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,m,x,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(a.globalAlpha=l)}drawText_(e,t,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=rl(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_;let o=this.textRotation_;for(this.transformRotation_===0&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);t<r;t+=i){const l=s[t]+this.textOffsetX_,c=s[t+1]+this.textOffsetY_;o!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(a.save(),a.translate(l-this.textOffsetX_,c-this.textOffsetY_),a.rotate(o),a.translate(this.textOffsetX_,this.textOffsetY_),a.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&a.strokeText(this.text_,0,0),this.textFillState_&&a.fillText(this.text_,0,0),a.restore()):(this.textStrokeState_&&a.strokeText(this.text_,l,c),this.textFillState_&&a.fillText(this.text_,l,c))}}moveToLineTo_(e,t,r,i,s){const a=this.context_,o=rl(e,t,r,i,this.transform_,this.pixelCoordinates_);a.moveTo(o[0],o[1]);let l=o.length;s&&(l-=2);for(let c=2;c<l;c+=2)a.lineTo(o[c],o[c+1]);return s&&a.closePath(),r}drawRings_(e,t,r,i){for(let s=0,a=r.length;s<a;++s)t=this.moveToLineTo_(e,t,r[s],i,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Es(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=D$(e,this.transform_,this.pixelCoordinates_),r=t[2]-t[0],i=t[3]-t[1],s=Math.sqrt(r*r+i*i),a=this.context_;a.beginPath(),a.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const r=t.getGeometryFunction()(e);r&&(this.setStyle(t),this.drawGeometry(r))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let r=0,i=t.length;r<i;++r)this.drawGeometry(t[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Es(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(Es(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let s=0;const a=e.getEnds(),o=e.getStride();r.beginPath();for(let l=0,c=a.length;l<c;++l)s=this.moveToLineTo_(i,s,a[l],o,!1);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Es(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Es(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getOrientedFlatCoordinates();let i=0;const s=e.getEndss(),a=e.getStride();t.beginPath();for(let o=0,l=s.length;o<l;++o){const c=s[o];i=this.drawRings_(r,i,c,a)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,t.lineCap=e.lineCap),gc(r.lineDash,e.lineDash)||t.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:Ap;r?(r.font!=e.font&&(r.font=e.font,t.font=e.font),r.textAlign!=i&&(r.textAlign=i,t.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=i,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:el(r||js)}}if(!t)this.strokeState_=null;else{const r=t.getColor(),i=t.getLineCap(),s=t.getLineDash(),a=t.getLineDashOffset(),o=t.getLineJoin(),l=t.getWidth(),c=t.getMiterLimit(),h=s||Yl;this.strokeState_={lineCap:i!==void 0?i:D0,lineDash:this.pixelRatio_===1?h:h.map(g=>g*this.pixelRatio_),lineDashOffset:(a||Zl)*this.pixelRatio_,lineJoin:o!==void 0?o:j0,lineWidth:(l!==void 0?l:kp)*this.pixelRatio_,miterLimit:c!==void 0?c:bp,strokeStyle:el(r||Rp)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=t[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const a=e.getScaleArray();this.imageScale_=[a[0]*this.pixelRatio_/r,a[1]*this.pixelRatio_/r],this.imageWidth_=t[0]*r}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const x=t.getColor();this.textFillState_={fillStyle:el(x||js)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const x=r.getColor(),y=r.getLineCap(),_=r.getLineDash(),w=r.getLineDashOffset(),T=r.getLineJoin(),b=r.getWidth(),R=r.getMiterLimit();this.textStrokeState_={lineCap:y!==void 0?y:D0,lineDash:_||Yl,lineDashOffset:w||Zl,lineJoin:T!==void 0?T:j0,lineWidth:b!==void 0?b:kp,miterLimit:R!==void 0?R:bp,strokeStyle:el(x||Rp)}}const i=e.getFont(),s=e.getOffsetX(),a=e.getOffsetY(),o=e.getRotateWithView(),l=e.getRotation(),c=e.getScaleArray(),h=e.getText(),g=e.getTextAlign(),m=e.getTextBaseline();this.textState_={font:i!==void 0?i:gj,textAlign:g!==void 0?g:Ap,textBaseline:m!==void 0?m:K_},this.text_=h!==void 0?Array.isArray(h)?h.reduce((x,y,_)=>x+=_%2?" ":y,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=a!==void 0?this.pixelRatio_*a:0,this.textRotateWithView_=o!==void 0?o:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const wW=.5,xj={Point:IW,LineString:RW,Polygon:PW,MultiPoint:CW,MultiLineString:AW,MultiPolygon:kW,GeometryCollection:bW,Circle:SW};function EW(n,e){return parseInt(Gt(n),10)-parseInt(Gt(e),10)}function bN(n,e){const t=yj(n,e);return t*t}function yj(n,e){return wW*n/e}function SW(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,a),l.drawCircle(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r)}}function RN(n,e,t,r,i,s,a,o){const l=[],c=t.getImage();if(c){let m=!0;const x=c.getImageState();x==bt.LOADED||x==bt.ERROR?m=!1:x==bt.IDLE&&c.load(),m&&l.push(c.ready())}const h=t.getFill();h&&h.loading()&&l.push(h.ready());const g=l.length>0;return g&&Promise.all(l).then(()=>i(null)),TW(n,e,t,r,s,a,o),g}function TW(n,e,t,r,i,s,a){const o=t.getGeometryFunction()(e);if(!o)return;const l=o.simplifyTransformed(r,i);if(t.getRenderer())_j(n,l,t,e,a);else{const h=xj[l.getType()];h(n,l,t,e,a,s)}}function _j(n,e,t,r,i){if(e.getType()=="GeometryCollection"){const a=e.getGeometries();for(let o=0,l=a.length;o<l;++o)_j(n,a[o],t,r,i);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,r,t.getRenderer(),t.getHitDetectionRenderer(),i)}function bW(n,e,t,r,i,s){const a=e.getGeometriesArray();let o,l;for(o=0,l=a.length;o<l;++o){const c=xj[a[o].getType()];c(n,a[o],t,r,i,s)}}function RW(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function AW(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawMultiLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function kW(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(a||s){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawMultiPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}function IW(n,e,t,r,i,s){const a=t.getImage(),o=t.getText(),l=o&&o.getText(),c=s&&a&&l?{}:void 0;if(a){if(a.getImageState()!=bt.LOADED)return;const h=n.getBuilder(t.getZIndex(),"Image");h.setImageStyle(a,c),h.drawPoint(e,r,i)}if(l){const h=n.getBuilder(t.getZIndex(),"Text");h.setTextStyle(o,c),h.drawText(e,r,i)}}function CW(n,e,t,r,i,s){const a=t.getImage(),o=a&&a.getOpacity()!==0,l=t.getText(),c=l&&l.getText(),h=s&&o&&c?{}:void 0;if(o){if(a.getImageState()!=bt.LOADED)return;const g=n.getBuilder(t.getZIndex(),"Image");g.setImageStyle(a,h),g.drawMultiPoint(e,r,i)}if(c){const g=n.getBuilder(t.getZIndex(),"Text");g.setTextStyle(l,h),g.drawText(e,r,i)}}function PW(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}let NW=!1;function MW(n,e,t,r,i,s,a){const o=new XMLHttpRequest;o.open("GET",typeof n=="function"?n(t,r,i):n,!0),e.getType()=="arraybuffer"&&(o.responseType="arraybuffer"),o.withCredentials=NW,o.onload=function(l){if(!o.status||o.status>=200&&o.status<300){const c=e.getType();try{let h;c=="text"||c=="json"?h=o.responseText:c=="xml"?h=o.responseXML||o.responseText:c=="arraybuffer"&&(h=o.response),h?s(e.readFeatures(h,{extent:t,featureProjection:i}),e.readProjection(h)):a()}catch{a()}}else a()},o.onerror=a,o.send()}function AN(n,e){return function(t,r,i,s,a){MW(n,e,t,r,i,(o,l)=>{this.addFeatures(o),s!==void 0&&s(o)},()=>{this.changed(),a!==void 0&&a()})}}function LW(n,e){return[[-1/0,-1/0,1/0,1/0]]}function vj(n,e,t,r){const i=[];let s=$s();for(let a=0,o=t.length;a<o;++a){const l=t[a];s=iA(n,e,l[0],r),i.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return i}function bA(n,e,t,r,i,s,a){let o,l,c,h,g,m,x;const y=i[s+1],_=[];for(let b=0,R=t.length;b<R;++b){const M=t[b];for(h=n[M-r],m=n[M-r+1],o=e;o<M;o+=r)g=n[o],x=n[o+1],(y<=m&&x<=y||m<=y&&y<=x)&&(c=(y-m)/(x-m)*(g-h)+h,_.push(c)),h=g,m=x}let w=NaN,T=-1/0;for(_.sort(Xl),h=_[0],o=1,l=_.length;o<l;++o){g=_[o];const b=Math.abs(g-h);b>T&&(c=(h+g)/2,xA(n,e,t,r,c,y)&&(w=c,T=b)),h=g}return isNaN(w)&&(w=i[s]),a?(a.push(w,y,T),a):[w,y,T]}function wj(n,e,t,r,i){let s=[];for(let a=0,o=t.length;a<o;++a){const l=t[a];s=bA(n,e,l,r,i,2*a,s),e=l[l.length-1]}return s}function OW(n,e,t,r){for(;e<t-r;){for(let i=0;i<r;++i){const s=n[e+i];n[e+i]=n[t-r+i],n[t-r+i]=s}e+=r,t-=r}}function RA(n,e,t,r){let i=0,s=n[t-r],a=n[t-r+1];for(;e<t;e+=r){const o=n[e],l=n[e+1];i+=(o-s)*(l+a),s=o,a=l}return i===0?void 0:i>0}function AA(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=RA(n,e,o,r);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=o}return!0}function Ej(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(!AA(n,e,o,r,i))return!1;o.length&&(e=o[o.length-1])}return!0}function X_(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=RA(n,e,o,r);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&OW(n,e,o,r),e=o}return e}function wb(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s)e=X_(n,e,t[s],r,i);return e}function Sj(n,e){const t=[];let r=0,i=0,s;for(let a=0,o=e.length;a<o;++a){const l=e[a],c=RA(n,r,l,2);if(s===void 0&&(s=c),c===s)t.push(e.slice(i,a+1));else{if(t.length===0)continue;t[t.length-1].push(e[i])}i=a+1,r=l}return t}class _o extends ZD{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(or),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let t=0,r=e.length;t<r;++t)this.changeEventsKeys_.push(gn(e[t],Kt.CHANGE,this.changed,this))}clone(){const e=new _o(NS(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<Ad(this.getExtent(),e,t))return i;const s=this.geometries_;for(let a=0,o=s.length;a<o;++a)i=s[a].closestPointXY(e,t,r,i);return i}containsXY(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)if(r[i].containsXY(e,t))return!0;return!1}computeExtent(e){E1(e);const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)ND(e,t[r].getExtent());return e}getGeometries(){return NS(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],r=this.geometries_;let i=!1;for(let s=0,a=r.length;s<a;++s){const o=r[s],l=o.getSimplifiedGeometry(e);t.push(l),l!==o&&(i=!0)}return i?new _o(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].rotate(e,t);this.changed()}scale(e,t,r){r||(r=dl(this.getExtent()));const i=this.geometries_;for(let s=0,a=i.length;s<a;++s)i[s].scale(e,t,r);this.changed()}setGeometries(e){this.setGeometriesArray(NS(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()}translate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function NS(n){return n.map(e=>e.clone())}function Tj(n,e,t,r){let i=0;const s=n[t-r],a=n[t-r+1];let o=0,l=0;for(;e<t;e+=r){const c=n[e]-s,h=n[e+1]-a;i+=l*c-o*h,o=c,l=h}return i/2}function bj(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=Tj(n,e,o,r),e=o}return i}function DW(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=bj(n,e,o,r),e=o[o.length-1]}return i}class Ip extends Cd{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Ip(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,r,i){return i<Ad(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(fA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),mA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,r,i))}getArea(){return Tj(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return hu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=Nw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Ip(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Cw(this.flatCoordinates,0,e,this.stride),this.changed()}}class ic extends Cd{constructor(e,t,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&r)this.setFlatCoordinates(t,e),this.ends_=r;else{const i=e,s=[],a=[];for(let l=0,c=i.length;l<c;++l){const h=i[l];zn(s,h.getFlatCoordinates()),a.push(s.length)}const o=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(o,s),this.ends_=a}}appendLineString(e){zn(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new ic(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<Ad(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(gA(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),pA(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,r,i))}getCoordinateAtM(e,t,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,r=r!==void 0?r:!1,B$(this.flatCoordinates,0,this.ends_,this.stride,e,t,r))}getCoordinates(){return Tp(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new bi(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,r=this.layout,i=[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a],c=new bi(e.slice(s,l),r);i.push(c),s=l}return i}getLength(){const e=this.ends_;let t=0,r=0;for(let i=0,s=e.length;i<s;++i)r+=yA(this.flatCoordinates,t,e[i],this.stride),t=e[i];return r}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let r=0;const i=this.ends_,s=this.stride;for(let a=0,o=i.length;a<o;++a){const l=i[a],c=$_(t,r,l,s,.5);zn(e,c),r=l}return e}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=nj(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,r),new ic(t,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return U$(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=R1(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}class Nd extends Cd{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){zn(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new Nd(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<Ad(this.getExtent(),e,t))return i;const s=this.flatCoordinates,a=this.stride;for(let o=0,l=s.length;o<l;o+=a){const c=Yh(e,t,s[o],s[o+1]);if(c<i){i=c;for(let h=0;h<a;++h)r[h]=s[o+h];r.length=a}}return i}getCoordinates(){return hu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new gi(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,r=this.stride,i=[];for(let s=0,a=e.length;s<a;s+=r){const o=new gi(e.slice(s,s+r),t);i.push(o)}return i}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,r=this.stride;for(let i=0,s=t.length;i<s;i+=r){const a=t[i],o=t[i+1];if(rA(e,a,o))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Cw(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ha extends Cd{constructor(e,t,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&r?(this.setFlatCoordinates(t,e),this.ends_=r):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?zn(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Ha(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<Ad(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(gA(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),pA(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return xA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return bj(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),X_(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Tp(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=dl(this.getExtent());this.flatInteriorPoint_=bA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new gi(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Ip(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,r=this.ends_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a],c=new Ip(t.slice(s,l),e);i.push(c),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;AA(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=X_(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=_A(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,r),new Ha(t,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return tj(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=R1(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function kN(n){if(Id(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],r=n[2],i=n[3],s=[e,t,e,i,r,i,r,t,e,t];return new Ha(s,"XY",[s.length])}class ld extends Cd{constructor(e,t,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){const i=e,s=[],a=[];for(let o=0,l=i.length;o<l;++o){const c=i[o],h=s.length,g=c.getEnds();for(let m=0,x=g.length;m<x;++m)g[m]+=h;zn(s,c.getFlatCoordinates()),a.push(g)}t=i.length===0?this.getLayout():i[0].getLayout(),e=s,r=a}t!==void 0&&r?(this.setFlatCoordinates(t,e),this.endss_=r):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const r=this.flatCoordinates.length;zn(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let i=0,s=t.length;i<s;++i)t[i]+=r}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=this.endss_[i].slice();const r=new ld(this.flatCoordinates.slice(),this.layout,t);return r.applyProperties(this),r}closestPointXY(e,t,r,i){return i<Ad(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(j$(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),F$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return z$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return DW(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),wb(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,pb(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=vj(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=wj(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Nd(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Ej(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=wb(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=H$(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,r),new ld(t,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const r=this.endss_[e].slice(),i=r[r.length-1];if(t!==0)for(let s=0,a=r.length;s<a;++s)r[s]-=t;return new Ha(this.flatCoordinates.slice(t,i),this.layout,r)}getPolygons(){const e=this.layout,t=this.flatCoordinates,r=this.endss_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a].slice(),c=l[l.length-1];if(s!==0)for(let g=0,m=l.length;g<m;++g)l[g]-=s;const h=new Ha(t.slice(s,c),e,l);i.push(h),s=c}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return $$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const r=JD(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{const i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const IN=ni();class Fs{constructor(e,t,r,i,s,a){this.styleFunction,this.extent_,this.id_=a,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=s,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?PD(this.flatCoordinates_):iA(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=dl(this.getExtent());this.flatInteriorPoints_=bA(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Sj(this.flatCoordinates_,this.ends_),t=vj(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=wj(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=$_(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const r=this.ends_;for(let i=0,s=r.length;i<s;++i){const a=r[i],o=$_(e,t,a,2,.5);zn(this.flatMidpoints_,o),t=a}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=ir(e);const t=e.getExtent(),r=e.getWorldExtent();if(t&&r){const i=ti(r)/ti(t);$a(IN,r[0],r[3],i,-i,0,0,0),rl(this.flatCoordinates_,0,this.flatCoordinates_.length,2,IN,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Fs(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=AD((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=Nw(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=nj(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=_A(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new Fs(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Fs.prototype.getFlatCoordinates=Fs.prototype.getOrientedFlatCoordinates;function Rj(n,e,t=0,r=n.length-1,i=jW){for(;r>t;){if(r-t>600){const l=r-t+1,c=e-t+1,h=Math.log(l),g=.5*Math.exp(2*h/3),m=.5*Math.sqrt(h*g*(l-g)/l)*(c-l/2<0?-1:1),x=Math.max(t,Math.floor(e-c*g/l+m)),y=Math.min(r,Math.floor(e+(l-c)*g/l+m));Rj(n,e,x,y,i)}const s=n[e];let a=t,o=r;for(fm(n,t,e),i(n[r],s)>0&&fm(n,t,r);a<o;){for(fm(n,a,o),a++,o--;i(n[a],s)<0;)a++;for(;i(n[o],s)>0;)o--}i(n[t],s)===0?fm(n,t,o):(o++,fm(n,o,r)),o<=e&&(t=o+1),e<=o&&(r=o-1)}}function fm(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function jW(n,e){return n<e?-1:n>e?1:0}let Aj=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const r=[];if(!by(e,t))return r;const i=this.toBBox,s=[];for(;t;){for(let a=0;a<t.children.length;a++){const o=t.children[a],l=t.leaf?i(o):o;by(e,l)&&(t.leaf?r.push(o):LS(e,l)?this._all(o,r):s.push(o))}t=s.pop()}return r}collides(e){let t=this.data;if(!by(e,t))return!1;const r=[];for(;t;){for(let i=0;i<t.children.length;i++){const s=t.children[i],a=t.leaf?this.toBBox(s):s;if(by(e,a)){if(t.leaf||LS(e,a))return!0;r.push(s)}}t=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const r=this.data;this.data=t,t=r}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Uf([]),this}remove(e,t){if(!e)return this;let r=this.data;const i=this.toBBox(e),s=[],a=[];let o,l,c;for(;r||s.length;){if(r||(r=s.pop(),l=s[s.length-1],o=a.pop(),c=!0),r.leaf){const h=FW(e,r.children,t);if(h!==-1)return r.children.splice(h,1),s.push(r),this._condense(s),this}!c&&!r.leaf&&LS(r,i)?(s.push(r),a.push(o),o=0,l=r,r=r.children[0]):l?(o++,r=l.children[o],c=!1):r=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,i){const s=r-t+1;let a=this._maxEntries,o;if(s<=a)return o=Uf(e.slice(t,r+1)),Tf(o,this.toBBox),o;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),o=Uf([]),o.leaf=!1,o.height=i;const l=Math.ceil(s/a),c=l*Math.ceil(Math.sqrt(a));CN(e,t,r,c,this.compareMinX);for(let h=t;h<=r;h+=c){const g=Math.min(h+c-1,r);CN(e,h,g,l,this.compareMinY);for(let m=h;m<=g;m+=l){const x=Math.min(m+l-1,g);o.children.push(this._build(e,m,x,i-1))}}return Tf(o,this.toBBox),o}_chooseSubtree(e,t,r,i){for(;i.push(t),!(t.leaf||i.length-1===r);){let s=1/0,a=1/0,o;for(let l=0;l<t.children.length;l++){const c=t.children[l],h=MS(c),g=GW(e,c)-h;g<a?(a=g,s=h<s?h:s,o=c):g===a&&h<s&&(s=h,o=c)}t=o||t.children[0]}return t}_insert(e,t,r){const i=r?e:this.toBBox(e),s=[],a=this._chooseSubtree(i,this.data,t,s);for(a.children.push(e),bm(a,i);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(i,s,t)}_split(e,t){const r=e[t],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);const a=this._chooseSplitIndex(r,s,i),o=Uf(r.children.splice(a,r.children.length-a));o.height=r.height,o.leaf=r.leaf,Tf(r,this.toBBox),Tf(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(r,o)}_splitRoot(e,t){this.data=Uf([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Tf(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let i,s=1/0,a=1/0;for(let o=t;o<=r-t;o++){const l=Tm(e,0,o,this.toBBox),c=Tm(e,o,r,this.toBBox),h=zW(l,c),g=MS(l)+MS(c);h<s?(s=h,i=o,a=g<a?g:a):h===s&&g<a&&(a=g,i=o)}return i||r-t}_chooseSplitAxis(e,t,r){const i=e.leaf?this.compareMinX:VW,s=e.leaf?this.compareMinY:BW,a=this._allDistMargin(e,t,r,i),o=this._allDistMargin(e,t,r,s);a<o&&e.children.sort(i)}_allDistMargin(e,t,r,i){e.children.sort(i);const s=this.toBBox,a=Tm(e,0,t,s),o=Tm(e,r-t,r,s);let l=Ty(a)+Ty(o);for(let c=t;c<r-t;c++){const h=e.children[c];bm(a,e.leaf?s(h):h),l+=Ty(a)}for(let c=r-t-1;c>=t;c--){const h=e.children[c];bm(o,e.leaf?s(h):h),l+=Ty(o)}return l}_adjustParentBBoxes(e,t,r){for(let i=r;i>=0;i--)bm(t[i],e)}_condense(e){for(let t=e.length-1,r;t>=0;t--)e[t].children.length===0?t>0?(r=e[t-1].children,r.splice(r.indexOf(e[t]),1)):this.clear():Tf(e[t],this.toBBox)}};function FW(n,e,t){if(!t)return e.indexOf(n);for(let r=0;r<e.length;r++)if(t(n,e[r]))return r;return-1}function Tf(n,e){Tm(n,0,n.children.length,e,n)}function Tm(n,e,t,r,i){i||(i=Uf(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=e;s<t;s++){const a=n.children[s];bm(i,n.leaf?r(a):a)}return i}function bm(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function VW(n,e){return n.minX-e.minX}function BW(n,e){return n.minY-e.minY}function MS(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function Ty(n){return n.maxX-n.minX+(n.maxY-n.minY)}function GW(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function zW(n,e){const t=Math.max(n.minX,e.minX),r=Math.max(n.minY,e.minY),i=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,i-t)*Math.max(0,s-r)}function LS(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function by(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Uf(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function CN(n,e,t,r,i){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=r)continue;const a=e+Math.ceil((t-e)/r/2)*r;Rj(n,a,e,t,i),s.push(e,a,a,t)}}class PN{constructor(e){this.rbush_=new Aj(e),this.items_={}}insert(e,t){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(r),this.items_[Gt(t)]=r}load(e,t){const r=new Array(t.length);for(let i=0,s=t.length;i<s;i++){const a=e[i],o=t[i],l={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:o};r[i]=l,this.items_[Gt(o)]=l}this.rbush_.load(r)}remove(e){const t=Gt(e),r=this.items_[t];return delete this.items_[t],this.rbush_.remove(r)!==null}update(e,t){const r=this.items_[Gt(t)],i=[r.minX,r.minY,r.maxX,r.maxY];sd(i,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let r;for(let i=0,s=e.length;i<s;i++)if(r=t(e[i]),r)return r;return r}isEmpty(){return id(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return Pu(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class kA extends _l{constructor(e){super(),this.projection=ir(e.projection),this.attributions_=NN(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(r,i){t.viewResolver=r,t.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=NN(e),this.changed()}setState(e){this.state_=e,this.changed()}}function NN(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const ss={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class $c extends yl{constructor(e,t,r){super(e),this.feature=t,this.features=r}}class mc extends kA{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=wp,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(Rn(this.format_,"`format` must be set when `url` is set"),this.loader_=AN(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:LW;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new PN:null,this.loadedExtentsRtree_=new PN,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!t&&r===void 0&&(r=new La(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=Gt(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new $c(ss.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Fs||(this.featureChangeKeys_[e]=[gn(t,Kt.CHANGE,this.handleFeatureChange_,this),gn(t,N0.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let r=!0;if(t.getId()!==void 0){const i=String(t.getId());if(!(i in this.idIndex_))this.idIndex_[i]=t;else if(t instanceof Fs){const s=this.idIndex_[i];s instanceof Fs?Array.isArray(s)?s.push(t):this.idIndex_[i]=[s,t]:r=!1}else r=!1}return r&&(Rn(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],r=[],i=[];for(let s=0,a=e.length;s<a;s++){const o=e[s],l=Gt(o);this.addToIndex_(l,o)&&r.push(o)}for(let s=0,a=r.length;s<a;s++){const o=r[s],l=Gt(o);this.setupChangeEvents_(l,o);const c=o.getGeometry();if(c){const h=c.getExtent();t.push(h),i.push(o)}else this.nullGeometryFeatures_[l]=o}if(this.featuresRtree_&&this.featuresRtree_.load(t,i),this.hasListener(ss.ADDFEATURE))for(let s=0,a=r.length;s<a;s++)this.dispatchEvent(new $c(ss.ADDFEATURE,r[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(ss.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),this.addEventListener(ss.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),e.addEventListener(Ds.ADD,r=>{t||(t=!0,this.addFeature(r.element),t=!1)}),e.addEventListener(Ds.REMOVE,r=>{t||(t=!0,this.removeFeature(r.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(or);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new $c(ss.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const s=i.getGeometry();if(s instanceof Fs||s.intersectsCoordinate(e))return t(i)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof Fs||i.intersectsExtent(e)){const s=t(r);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),id(this.nullGeometryFeatures_)||zn(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){t.push(r)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=DD(e,t);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const r=e[0],i=e[1];let s=null;const a=[NaN,NaN];let o=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||vp,this.featuresRtree_.forEachInExtent(l,function(c){if(t(c)){const h=c.getGeometry(),g=o;if(o=h instanceof Fs?0:h.closestPointXY(r,i,a,o),o<g){s=c;const m=Math.sqrt(o);l[0]=r-m,l[1]=i-m,l[2]=r+m,l[3]=i+m}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,r=Gt(t),i=t.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);else{const a=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(a,t)):this.featuresRtree_&&this.featuresRtree_.update(a,t)}const s=t.getId();if(s!==void 0){const a=s.toString();this.idIndex_[a]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[a]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new $c(ss.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:Gt(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&id(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,r){const i=this.loadedExtentsRtree_,s=this.strategy_(e,t,r);for(let a=0,o=s.length;a<o;++a){const l=s[a];i.forEachInExtent(l,function(h){return cu(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new $c(ss.FEATURESLOADSTART)),this.loader_.call(this,l,t,r,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new $c(ss.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new $c(ss.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,r=t.forEachInExtent(e,function(i){if(sd(i.extent,e))return i});r&&t.remove(r)}removeFeatures(e){let t=!1;for(let r=0,i=e.length;r<i;++r)t=this.removeFeatureInternal(e[r])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=Gt(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(or),delete this.featureChangeKeys_[t];const i=e.getId();if(i!==void 0){const s=i.toString(),a=this.idIndex_[s];a===e?delete this.idIndex_[s]:Array.isArray(a)&&(a.splice(a.indexOf(e),1),a.length===1&&(this.idIndex_[s]=a[0]))}return delete this.uidIndex_[t],this.hasListener(ss.REMOVEFEATURE)&&this.dispatchEvent(new $c(ss.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){Rn(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(AN(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class rr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new rr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=H_(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===bt.IDLE&&t.load(),t.getImageState()===bt.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?Gt(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:Wa(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Yn{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Yn({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function MN(n){return n[0]>0&&n[1]>0}function UW(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function ki(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Lw{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=ki(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Lw({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Wt()}getImage(e){return Wt()}getHitDetectionImage(){return Wt()}getPixelRatio(e){return 1}getImageState(){return Wt()}getImageSize(){return Wt()}getOrigin(){return Wt()}getSize(){return Wt()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ki(e)}listenImageChange(e){Wt()}load(){Wt()}unlistenImageChange(e){Wt()}ready(){return Promise.resolve()}}class Ow extends Lw{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?bt.LOADING:bt.LOADED,this.imageState_===bt.LOADING&&this.ready().then(()=>this.imageState_=bt.LOADED),this.render()}clone(){const e=this.getScale(),t=new Ow({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-t[0]/r[0],e[1]/2+t[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let i=Da.get(r,null,null)?.getImage(1);if(!i){const s=this.renderOptions_,a=Math.ceil(s.size*e),o=Kr(a,a);this.draw_(s,o,e),i=o.canvas,Da.set(r,null,null,new dj(i,void 0,null,bt.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,r){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){const B=i;i=s,s=B}const a=this.radius2_===void 0?this.points_:this.points_*2,o=2*Math.PI/a,l=s*Math.sin(o),c=Math.sqrt(s*s-l*l),h=i-c,g=Math.sqrt(l*l+h*h),m=g/l;if(e==="miter"&&m<=r)return m*t;const x=t/2/m,y=t/2*(h/g),w=Math.sqrt((i+x)*(i+x)+y*y)-i;if(this.radius2_===void 0||e==="bevel")return w*2;const T=i*Math.sin(o),b=Math.sqrt(i*i-T*T),R=s-b,D=Math.sqrt(T*T+R*R)/T;if(D<=r){const B=D*t/2-s-i;return 2*Math.max(w,B)}return w*2}createRenderOptions(){let e=D0,t=j0,r=0,i=null,s=0,a,o=0;this.stroke_&&(a=el(this.stroke_.getColor()??Rp),o=this.stroke_.getWidth()??kp,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??j0,e=this.stroke_.getLineCap()??D0,r=this.stroke_.getMiterLimit()??bp);const l=this.calculateLineJoinSize_(t,o,r),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:a,strokeWidth:o,size:h,lineCap:e,lineDash:i,lineDashOffset:s,lineJoin:t,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,r){if(t.scale(r,r),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let i=this.fill_.getColor();i===null&&(i=js),t.fillStyle=el(i),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=Wa(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(t=Kr(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const r=this.radius;if(t===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,a=2*Math.PI/t;for(let o=0;o<t;o++){const l=s+o*a,c=o%2===0?r:i;e.lineTo(c*Math.cos(l),c*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=js,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Ws extends Ow{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Ws({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class pn{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=LN,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new pn({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=LN,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function $W(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(Rn(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let OS=null;function kj(n,e){if(!OS){const t=new rr({color:"rgba(255,255,255,0.4)"}),r=new Yn({color:"#3399CC",width:1.25});OS=[new pn({image:new Ws({fill:t,stroke:r,radius:5}),fill:t,stroke:r})]}return OS}function LN(n){return n.getGeometry()}const WW="#333";class vo{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=ki(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new rr({color:WW}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new vo({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof rr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ki(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Qr={ANIMATING:0,INTERACTING:1},Bt={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Ry=[Bt.FILL],fu=[Bt.STROKE],Uh=[Bt.BEGIN_PATH],ON=[Bt.CLOSE_PATH];class k1 extends fj{constructor(e,t,r,i){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(r){return r*t})}appendFlatPointCoordinates(e,t){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,s=this.coordinates;let a=s.length;for(let o=0,l=e.length;o<l;o+=t)i[0]=e[o],i[1]=e[o+1],rc(r,i)&&(s[a++]=i[0],s[a++]=i[1]);return a}appendFlatLineCoordinates(e,t,r,i,s,a){const o=this.coordinates;let l=o.length;const c=this.getBufferedMaxExtent();a&&(t+=i);let h=e[t],g=e[t+1];const m=this.tmpCoordinate_;let x=!0,y,_,w;for(y=t+i;y<r;y+=i)m[0]=e[y],m[1]=e[y+1],w=ob(c,m),w!==_?(x&&(o[l++]=h,o[l++]=g,x=!1),o[l++]=m[0],o[l++]=m[1]):w===Ei.INTERSECTING?(o[l++]=m[0],o[l++]=m[1],x=!1):x=!0,h=m[0],g=m[1],_=w;return(s&&x||y===t+i)&&(o[l++]=h,o[l++]=g),l}drawCustomCoordinates_(e,t,r,i,s){for(let a=0,o=r.length;a<o;++a){const l=r[a],c=this.appendFlatLineCoordinates(e,t,l,i,!1,!1);s.push(c),t=l}return t}drawCustom(e,t,r,i,s){this.beginGeometry(e,t,s);const a=e.getType(),o=e.getStride(),l=this.coordinates.length;let c,h,g,m,x;switch(a){case"MultiPolygon":c=e.getOrientedFlatCoordinates(),m=[];const y=e.getEndss();x=0;for(let _=0,w=y.length;_<w;++_){const T=[];x=this.drawCustomCoordinates_(c,x,y[_],o,T),m.push(T)}this.instructions.push([Bt.CUSTOM,l,m,e,r,pb,s]),this.hitDetectionInstructions.push([Bt.CUSTOM,l,m,e,i||r,pb,s]);break;case"Polygon":case"MultiLineString":g=[],c=a=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),x=this.drawCustomCoordinates_(c,0,e.getEnds(),o,g),this.instructions.push([Bt.CUSTOM,l,g,e,r,Tp,s]),this.hitDetectionInstructions.push([Bt.CUSTOM,l,g,e,i||r,Tp,s]);break;case"LineString":case"Circle":c=e.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,o,!1,!1),this.instructions.push([Bt.CUSTOM,l,h,e,r,hu,s]),this.hitDetectionInstructions.push([Bt.CUSTOM,l,h,e,i||r,hu,s]);break;case"MultiPoint":c=e.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,o),h>l&&(this.instructions.push([Bt.CUSTOM,l,h,e,r,hu,s]),this.hitDetectionInstructions.push([Bt.CUSTOM,l,h,e,i||r,hu,s]));break;case"Point":c=e.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([Bt.CUSTOM,l,h,e,r,void 0,s]),this.hitDetectionInstructions.push([Bt.CUSTOM,l,h,e,i||r,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,r){this.beginGeometryInstruction1_=[Bt.BEGIN_GEOMETRY,t,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Bt.BEGIN_GEOMETRY,t,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const r=e.length;let i,s,a=-1;for(t=0;t<r;++t)i=e[t],s=i[0],s==Bt.END_GEOMETRY?a=t:s==Bt.BEGIN_GEOMETRY&&(i[2]=t,BU(this.hitDetectionInstructions,a,t),a=-1)}fillStyleToState(e,t={}){if(e){const r=e.getColor();t.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,t.fillStyle=el(r||js)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const r=e.getColor();t.strokeStyle=el(r||Rp);const i=e.getLineCap();t.lineCap=i!==void 0?i:D0;const s=e.getLineDash();t.lineDash=s?s.slice():Yl;const a=e.getLineDashOffset();t.lineDashOffset=a||Zl;const o=e.getLineJoin();t.lineJoin=o!==void 0?o:j0;const l=e.getWidth();t.lineWidth=l!==void 0?l:kp;const c=e.getMiterLimit();t.miterLimit=c!==void 0?c:bp,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(t,r)}createFill(e){const t=e.fillStyle,r=[Bt.SET_FILL_STYLE,t];return typeof t!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Bt.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,t){const r=e.strokeStyle,i=e.lineCap,s=e.lineDash,a=e.lineDashOffset,o=e.lineJoin,l=e.lineWidth,c=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||s!=e.currentLineDash&&!gc(e.currentLineDash,s)||e.currentLineDashOffset!=a||e.currentLineJoin!=o||e.currentLineWidth!=l||e.currentMiterLimit!=c)&&(t.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=s,e.currentLineDashOffset=a,e.currentLineJoin=o,e.currentLineWidth=l,e.currentMiterLimit=c)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Bt.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=CD(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;M0(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class HW extends k1{constructor(e,t,r,i){super(e,t,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,r){if(!this.image_||this.maxExtent&&!rc(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=e.getStride(),a=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([Bt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Bt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,r){if(!this.image_)return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=[];for(let l=0,c=i.length;l<c;l+=e.getStride())(!this.maxExtent||rc(this.maxExtent,i.slice(l,l+2)))&&s.push(i[l],i[l+1]);const a=this.coordinates.length,o=this.appendFlatPointCoordinates(s,2);this.instructions.push([Bt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Bt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const r=e.getAnchor(),i=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class KW extends k1{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinates_(e,t,r,i){const s=this.coordinates.length,a=this.appendFlatLineCoordinates(e,t,r,i,!1,!1),o=[Bt.MOVE_TO_LINE_TO,s,a];return this.instructions.push(o),this.hitDetectionInstructions.push(o),r}drawLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Bt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Yl,Zl],Uh);const o=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(o,0,o.length,l),this.hitDetectionInstructions.push(fu),this.endGeometry(t)}drawMultiLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Bt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Yl,Zl],Uh);const o=e.getEnds(),l=e.getFlatCoordinates(),c=e.getStride();let h=0;for(let g=0,m=o.length;g<m;++g)h=this.drawFlatCoordinates_(l,h,o[g],c);this.hitDetectionInstructions.push(fu),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(fu),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(fu),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Uh)}}class DN extends k1{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinatess_(e,t,r,i){const s=this.state,a=s.fillStyle!==void 0,o=s.strokeStyle!==void 0,l=r.length;this.instructions.push(Uh),this.hitDetectionInstructions.push(Uh);for(let c=0;c<l;++c){const h=r[c],g=this.coordinates.length,m=this.appendFlatLineCoordinates(e,t,h,i,!0,!o),x=[Bt.MOVE_TO_LINE_TO,g,m];this.instructions.push(x),this.hitDetectionInstructions.push(x),o&&(this.instructions.push(ON),this.hitDetectionInstructions.push(ON)),t=h}return a&&(this.instructions.push(Ry),this.hitDetectionInstructions.push(Ry)),o&&(this.instructions.push(fu),this.hitDetectionInstructions.push(fu)),t}drawCircle(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Bt.SET_FILL_STYLE,js]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Bt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Yl,Zl]);const o=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,l,!1,!1);const h=[Bt.CIRCLE,c];this.instructions.push(Uh,h),this.hitDetectionInstructions.push(Uh,h),i.fillStyle!==void 0&&(this.instructions.push(Ry),this.hitDetectionInstructions.push(Ry)),i.strokeStyle!==void 0&&(this.instructions.push(fu),this.hitDetectionInstructions.push(fu)),this.endGeometry(t)}drawPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Bt.SET_FILL_STYLE,js]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Bt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Yl,Zl]);const o=e.getEnds(),l=e.getOrientedFlatCoordinates(),c=e.getStride();this.drawFlatCoordinatess_(l,0,o,c),this.endGeometry(t)}drawMultiPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Bt.SET_FILL_STYLE,js]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Bt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Yl,Zl]);const o=e.getEndss(),l=e.getOrientedFlatCoordinates(),c=e.getStride();let h=0;for(let g=0,m=o.length;g<m;++g)h=this.drawFlatCoordinatess_(l,h,o[g],c);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let r=0,i=t.length;r<i;++r)t[r]=bh(t[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function XW(n,e,t,r,i){const s=[];let a=t,o=0,l=e.slice(t,2);for(;o<n&&a+i<r;){const[c,h]=l.slice(-2),g=e[a+i],m=e[a+i+1],x=Math.sqrt((g-c)*(g-c)+(m-h)*(m-h));if(o+=x,o>=n){const y=(n-o+x)/x,_=la(c,g,y),w=la(h,m,y);l.push(_,w),s.push(l),l=[_,w],o==n&&(a+=i),o=0}else if(o<n)l.push(e[a+i],e[a+i+1]),a+=i;else{const y=x-o,_=la(c,g,y/x),w=la(h,m,y/x);l.push(_,w),s.push(l),l=[_,w],o=0,a+=i}}return o>0&&s.push(l),s}function qW(n,e,t,r,i){let s=t,a=t,o=0,l=0,c=t,h,g,m,x,y,_,w,T,b,R;for(g=t;g<r;g+=i){const M=e[g],D=e[g+1];y!==void 0&&(b=M-y,R=D-_,x=Math.sqrt(b*b+R*R),w!==void 0&&(l+=m,h=Math.acos((w*b+T*R)/(m*x)),h>n&&(l>o&&(o=l,s=c,a=g),l=0,c=g-i)),m=x,w=b,T=R),y=M,_=D}return l+=x,l>o?[c,g]:[s,a]}const q_={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class YW extends k1{constructor(e,t,r,i){super(e,t,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[js]={fillStyle:js},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,r){const i=this.textFillState_,s=this.textStrokeState_,a=this.textState_;if(this.text_===""||!a||!i&&!s)return;const o=this.coordinates;let l=o.length;const c=e.getType();let h=null,g=e.getStride();if(a.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!Es(this.maxExtent,e.getExtent()))return;let m;if(h=e.getFlatCoordinates(),c=="LineString")m=[h.length];else if(c=="MultiLineString")m=e.getEnds();else if(c=="Polygon")m=e.getEnds().slice(0,1);else if(c=="MultiPolygon"){const w=e.getEndss();m=[];for(let T=0,b=w.length;T<b;++T)m.push(w[T][0])}this.beginGeometry(e,t,r);const x=a.repeat,y=x?void 0:a.textAlign;let _=0;for(let w=0,T=m.length;w<T;++w){let b;x?b=XW(x*this.resolution,h,_,m[w],g):b=[h.slice(_,m[w])];for(let R=0,M=b.length;R<M;++R){const D=b[R];let B=0,k=D.length;if(y==null){const C=qW(a.maxAngle,D,0,D.length,2);B=C[0],k=C[1]}for(let C=B;C<k;C+=g)o.push(D[C],D[C+1]);const A=o.length;_=m[w],this.drawChars_(l,A),l=A}}this.endGeometry(t)}else{let m=a.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=e.getFlatCoordinates();break;case"LineString":h=e.getFlatMidpoint();break;case"Circle":h=e.getCenter();break;case"MultiLineString":h=e.getFlatMidpoints(),g=2;break;case"Polygon":h=e.getFlatInteriorPoint(),a.overflow||m.push(h[2]/this.resolution),g=3;break;case"MultiPolygon":const M=e.getFlatInteriorPoints();h=[];for(let D=0,B=M.length;D<B;D+=3)a.overflow||m.push(M[D+2]/this.resolution),h.push(M[D],M[D+1]);if(h.length===0)return;g=2;break}const x=this.appendFlatPointCoordinates(h,g);if(x===l)return;if(m&&(x-l)/2!==h.length/g){let M=l/2;m=m.filter((D,B)=>{const k=o[(M+B)*2]===h[B*g]&&o[(M+B)*2+1]===h[B*g+1];return k||--M,k})}this.saveTextStates_();const y=a.backgroundFill?this.createFill(this.fillStyleToState(a.backgroundFill)):null,_=a.backgroundStroke?this.createStroke(this.strokeStyleToState(a.backgroundStroke)):null;this.beginGeometry(e,t,r);let w=a.padding;if(w!=zh&&(a.scale[0]<0||a.scale[1]<0)){let M=a.padding[0],D=a.padding[1],B=a.padding[2],k=a.padding[3];a.scale[0]<0&&(D=-D,k=-k),a.scale[1]<0&&(M=-M,B=-B),w=[M,D,B,k]}const T=this.pixelRatio;this.instructions.push([Bt.DRAW_IMAGE,l,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,w==zh?zh:w.map(function(M){return M*T}),y,_,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]);const b=1/T,R=y?y.slice(0):null;R&&(R[1]=js),this.hitDetectionInstructions.push([Bt.DRAW_IMAGE,l,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[b,b],NaN,this.declutterMode_,this.declutterImageWithText_,w,R,_,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?js:this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Ap,justify:t.justify,textBaseline:t.textBaseline||K_,scale:t.scale});const a=this.fillKey_;r&&(a in this.fillStates||(this.fillStates[a]={fillStyle:r.fillStyle}))}drawChars_(e,t){const r=this.textStrokeState_,i=this.textState_,s=this.strokeKey_,a=this.textKey_,o=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=q_[i.textBaseline],h=this.textOffsetY_*l,g=this.text_,m=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([Bt.DRAW_CHARS,e,t,c,i.overflow,o,i.maxAngle,l,h,s,m*l,g,a,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Bt.DRAW_CHARS,e,t,c,i.overflow,o&&js,i.maxAngle,l,h,s,m*l,g,a,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let r,i,s;if(!e)this.text_="";else{const a=e.getFill();a?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=el(a.getColor()||js)):(i=null,this.textFillState_=i);const o=e.getStroke();if(!o)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const _=o.getLineDash(),w=o.getLineDashOffset(),T=o.getWidth(),b=o.getMiterLimit();s.lineCap=o.getLineCap()||D0,s.lineDash=_?_.slice():Yl,s.lineDashOffset=w===void 0?Zl:w,s.lineJoin=o.getLineJoin()||j0,s.lineWidth=T===void 0?kp:T,s.miterLimit=b===void 0?bp:b,s.strokeStyle=el(o.getColor()||Rp)}r=this.textState_;const l=e.getFont()||gj;mW(l);const c=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||K_,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||zh,r.scale=c===void 0?[1,1]:c;const h=e.getOffsetX(),g=e.getOffsetY(),m=e.getRotateWithView(),x=e.getKeepUpright(),y=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=g===void 0?0:g,this.textRotateWithView_=m===void 0?!1:m,this.textKeepUpright_=x===void 0?!0:x,this.textRotation_=y===void 0?0:y,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:Gt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+Gt(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const ZW={Circle:DN,Default:k1,Image:HW,LineString:KW,Polygon:DN,Text:YW};class JW{constructor(e,t,r,i){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const r=this.buildersByZIndex_[t];for(const i in r){const s=r[i].finish();e[t][i]=s}}return e}getBuilder(e,t){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let s=i[t];if(s===void 0){const a=ZW[t];s=new a(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=s}return s}}function QW(n,e,t,r,i,s,a,o,l,c,h,g,m=!0){let x=n[e],y=n[e+1],_=0,w=0,T=0,b=0;function R(){_=x,w=y,e+=r,x=n[e],y=n[e+1],b+=T,T=Math.sqrt((x-_)*(x-_)+(y-w)*(y-w))}do R();while(e<t-r&&b+T<s);let M=T===0?0:(s-b)/T;const D=la(_,x,M),B=la(w,y,M),k=e-r,A=b,C=s+o*l(c,i,h);for(;e<t-r&&b+T<C;)R();M=T===0?0:(C-b)/T;const O=la(_,x,M),P=la(w,y,M);let z=!1;if(m)if(g){const Ne=[D,B,O,P];YD(Ne,0,4,2,g,Ne,Ne),z=Ne[0]>Ne[2]}else z=D>O;const F=Math.PI,xe=[],Ce=k+r===e;e=k,T=0,b=A,x=n[e],y=n[e+1];let Ge;if(Ce){R(),Ge=Math.atan2(y-w,x-_),z&&(Ge+=Ge>0?-F:F);const Ne=(O+D)/2,ue=(P+B)/2;return xe[0]=[Ne,ue,(C-s)/2,Ge,i],xe}i=i.replace(/\n/g," ");for(let Ne=0,ue=i.length;Ne<ue;){R();let ke=Math.atan2(y-w,x-_);if(z&&(ke+=ke>0?-F:F),Ge!==void 0){let re=ke-Ge;if(re+=re>F?-2*F:re<-F?2*F:0,Math.abs(re)>a)return null}Ge=ke;const ae=Ne;let Z=0;for(;Ne<ue;++Ne){const re=z?ue-Ne-1:Ne,he=o*l(c,i[re],h);if(e+r<t&&b+T<s+Z+he/2)break;Z+=he}if(Ne===ae)continue;const V=z?i.substring(ue-ae,ue-Ne):i.substring(ae,Ne);M=T===0?0:(s+Z/2-b)/T;const Q=la(_,x,M),ee=la(w,y,M);xe.push([Q,ee,Z/2,ke,V]),s+=Z}return xe}class Ij{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(W_(),{get:(e,t)=>{if(typeof W_()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,r)=>(this.push_(t,r),!0)})}push_(...e){const t=this.instructions_,r=this.zIndex+this.offset_;t[r]||(t[r]=[]),t[r].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let r=0,i=t.length;r<i;++r){const s=t[r];if(typeof s=="function"){s(e);continue}const a=t[++r];if(typeof e[s]=="function")e[s](...a);else{if(typeof a=="function"){e[s]=a(e);continue}e[s]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const bf=$s(),Wc=[],Dl=[],jl=[],Hc=[];function jN(n){return n[3].declutterBox}const FN=new RegExp("[-----]");function DS(n,e){return e==="start"?e=FN.test(n)?"right":"left":e==="end"&&(e=FN.test(n)?"left":"right"),q_[e]}function eH(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function tH(n,e,t){return t%2===0&&(n+=e),n}class nH{constructor(e,t,r,i,s){this.overlaps=r,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=ni(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new Ij:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,r,i){const s=e+t+r+i;if(this.labels_[s])return this.labels_[s];const a=i?this.strokeStates[i]:null,o=r?this.fillStates[r]:null,l=this.textStates[t],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],g=l.justify?q_[l.justify]:DS(Array.isArray(e)?e[0]:e,l.textAlign||Ap),m=i&&a.lineWidth?a.lineWidth:0,x=Array.isArray(e)?e:String(e).split(`
`).reduce(eH,[]),{width:y,height:_,widths:w,heights:T,lineWidths:b}=xW(l,x),R=y+m,M=[],D=(R+2)*h[0],B=(_+m)*h[1],k={width:D<0?Math.floor(D):Math.ceil(D),height:B<0?Math.floor(B):Math.ceil(B),contextInstructions:M};(h[0]!=1||h[1]!=1)&&M.push("scale",h),i&&(M.push("strokeStyle",a.strokeStyle),M.push("lineWidth",m),M.push("lineCap",a.lineCap),M.push("lineJoin",a.lineJoin),M.push("miterLimit",a.miterLimit),M.push("setLineDash",[a.lineDash]),M.push("lineDashOffset",a.lineDashOffset)),r&&M.push("fillStyle",o.fillStyle),M.push("textBaseline","middle"),M.push("textAlign","center");const A=.5-g;let C=g*R+A*m;const O=[],P=[];let z=0,F=0,xe=0,Ce=0,Ge;for(let Ne=0,ue=x.length;Ne<ue;Ne+=2){const ke=x[Ne];if(ke===`
`){F+=z,z=0,C=g*R+A*m,++Ce;continue}const ae=x[Ne+1]||l.font;ae!==Ge&&(i&&O.push("font",ae),r&&P.push("font",ae),Ge=ae),z=Math.max(z,T[xe]);const Z=[ke,C+A*w[xe]+g*(w[xe]-b[Ce]),.5*(m+z)+F];C+=w[xe],i&&O.push("strokeText",Z),r&&P.push("fillText",Z),++xe}return Array.prototype.push.apply(M,O),Array.prototype.push.apply(M,P),this.labels_[s]=k,k}replayTextBackground_(e,t,r,i,s,a,o){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,t),a&&(this.alignAndScaleFill_=a[2],e.fillStyle=a[1],this.fill_(e)),o&&(this.setStrokeStyle_(e,o),e.stroke())}calculateImageOrLabelDimensions_(e,t,r,i,s,a,o,l,c,h,g,m,x,y,_,w){o*=m[0],l*=m[1];let T=r-o,b=i-l;const R=s+c>e?e-c:s,M=a+h>t?t-h:a,D=y[3]+R*m[0]+y[1],B=y[0]+M*m[1]+y[2],k=T-y[3],A=b-y[0];(_||g!==0)&&(Wc[0]=k,Hc[0]=k,Wc[1]=A,Dl[1]=A,Dl[0]=k+D,jl[0]=Dl[0],jl[1]=A+B,Hc[1]=jl[1]);let C;return g!==0?(C=$a(ni(),r,i,1,1,g,-r,-i),Cr(C,Wc),Cr(C,Dl),Cr(C,jl),Cr(C,Hc),Pu(Math.min(Wc[0],Dl[0],jl[0],Hc[0]),Math.min(Wc[1],Dl[1],jl[1],Hc[1]),Math.max(Wc[0],Dl[0],jl[0],Hc[0]),Math.max(Wc[1],Dl[1],jl[1],Hc[1]),bf)):Pu(Math.min(k,k+D),Math.min(A,A+B),Math.max(k,k+D),Math.max(A,A+B),bf),x&&(T=Math.round(T),b=Math.round(b)),{drawImageX:T,drawImageY:b,drawImageW:R,drawImageH:M,originX:c,originY:h,declutterBox:{minX:bf[0],minY:bf[1],maxX:bf[2],maxY:bf[3],value:w},canvasTransform:C,scale:m}}replayImageOrLabel_(e,t,r,i,s,a,o){const l=!!(a||o),c=i.declutterBox,h=o?o[2]*i.scale[0]/2:0;return c.minX-h<=t[0]&&c.maxX+h>=0&&c.minY-h<=t[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(e,Wc,Dl,jl,Hc,a,o),yW(e,i.canvasTransform,s,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const r=Cr(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,r,i){const s=this.textStates[t],a=this.createLabel(e,t,i,r),o=this.strokeStates[r],l=this.pixelRatio,c=DS(Array.isArray(e)?e[0]:e,s.textAlign||Ap),h=q_[s.textBaseline||K_],g=o&&o.lineWidth?o.lineWidth:0,m=a.width/l-2*s.scale[0],x=c*m+2*(.5-c)*g,y=h*a.height/l+2*(.5-h)*g;return{label:a,anchorX:x,anchorY:y}}execute_(e,t,r,i,s,a,o,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&gc(r,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=rl(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),XD(this.renderedTransform_,r));let g=0;const m=i.length;let x=0,y,_,w,T,b,R,M,D,B,k,A,C,O,P=0,z=0;const F=this.coordinateCache_,xe=this.viewRotation_,Ce=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,Ge={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:xe},Ne=this.instructions!=i||this.overlaps?0:200;let ue,ke,ae,Z;for(;g<m;){const V=i[g];switch(V[0]){case Bt.BEGIN_GEOMETRY:ue=V[1],Z=V[3],ue.getGeometry()?o!==void 0&&!Es(o,Z.getExtent())?g=V[2]+1:++g:g=V[2],c&&(c.zIndex=V[4]);break;case Bt.BEGIN_PATH:P>Ne&&(this.fill_(e),P=0),z>Ne&&(e.stroke(),z=0),!P&&!z&&(e.beginPath(),b=NaN,R=NaN),++g;break;case Bt.CIRCLE:x=V[1];const ee=h[x],re=h[x+1],he=h[x+2],Ve=h[x+3],Be=he-ee,ye=Ve-re,pe=Math.sqrt(Be*Be+ye*ye);e.moveTo(ee+pe,re),e.arc(ee,re,pe,0,2*Math.PI,!0),++g;break;case Bt.CLOSE_PATH:e.closePath(),++g;break;case Bt.CUSTOM:x=V[1],y=V[2];const Fe=V[3],Et=V[4],Ft=V[5];Ge.geometry=Fe,Ge.feature=ue,g in F||(F[g]=[]);const Dt=F[g];Ft?Ft(h,x,y,2,Dt):(Dt[0]=h[x],Dt[1]=h[x+1],Dt.length=2),c&&(c.zIndex=V[6]),Et(Dt,Ge),++g;break;case Bt.DRAW_IMAGE:x=V[1],y=V[2],B=V[3],_=V[4],w=V[5];let Xt=V[6];const en=V[7],ot=V[8],tr=V[9],dn=V[10];let un=V[11];const sr=V[12];let Mi=V[13];T=V[14]||"declutter";const Bn=V[15];if(!B&&V.length>=20){k=V[19],A=V[20],C=V[21],O=V[22];const Pe=this.drawLabelWithPointPlacement_(k,A,C,O);B=Pe.label,V[3]=B;const q=V[23];_=(Pe.anchorX-q)*this.pixelRatio,V[4]=_;const ce=V[24];w=(Pe.anchorY-ce)*this.pixelRatio,V[5]=w,Xt=B.height,V[6]=Xt,Mi=B.width,V[13]=Mi}let Sr;V.length>25&&(Sr=V[25]);let oi,_t,xn;V.length>17?(oi=V[16],_t=V[17],xn=V[18]):(oi=zh,_t=null,xn=null),dn&&Ce?un+=xe:!dn&&!Ce&&(un-=xe);let An=0;for(;x<y;x+=2){if(Sr&&Sr[An++]<Mi/this.pixelRatio)continue;const Pe=this.calculateImageOrLabelDimensions_(B.width,B.height,h[x],h[x+1],Mi,Xt,_,w,ot,tr,un,sr,s,oi,!!_t||!!xn,ue),q=[e,t,B,Pe,en,_t,xn];if(l){let ce,Re,ze;if(Bn){const $e=y-x;if(!Bn[$e]){Bn[$e]={args:q,declutterMode:T};continue}const xt=Bn[$e];ce=xt.args,Re=xt.declutterMode,delete Bn[$e],ze=jN(ce)}let Me,He;if(ce&&(Re!=="declutter"||!l.collides(ze))&&(Me=!0),(T!=="declutter"||!l.collides(Pe.declutterBox))&&(He=!0),Re==="declutter"&&T==="declutter"){const $e=Me&&He;Me=$e,He=$e}Me&&(Re!=="none"&&l.insert(ze),this.replayImageOrLabel_.apply(this,ce)),He&&(T!=="none"&&l.insert(Pe.declutterBox),this.replayImageOrLabel_.apply(this,q))}else this.replayImageOrLabel_.apply(this,q)}++g;break;case Bt.DRAW_CHARS:const Tt=V[1],an=V[2],Mt=V[3],Zi=V[4];O=V[5];const Mr=V[6],li=V[7],rn=V[8];C=V[9];const Tr=V[10];k=V[11],Array.isArray(k)&&(k=k.reduce(tH,"")),A=V[12];const je=[V[13],V[13]];T=V[14]||"declutter";const _e=V[15],ve=this.textStates[A],jt=ve.font,L=[ve.scale[0]*li,ve.scale[1]*li];let ut;jt in this.widths_?ut=this.widths_[jt]:(ut={},this.widths_[jt]=ut);const W=yA(h,Tt,an,2),ie=Math.abs(L[0])*TN(jt,k,ut);if(Zi||ie<=W){const Pe=this.textStates[A].textAlign,q=(W-ie)*DS(k,Pe),ce=QW(h,Tt,an,2,k,q,Mr,Math.abs(L[0]),TN,jt,ut,Ce?0:this.viewRotation_,_e);e:if(ce){const Re=[];let ze,Me,He,$e,xt;if(C)for(ze=0,Me=ce.length;ze<Me;++ze){xt=ce[ze],He=xt[4],$e=this.createLabel(He,A,"",C),_=xt[2]+(L[0]<0?-Tr:Tr),w=Mt*$e.height+(.5-Mt)*2*Tr*L[1]/L[0]-rn;const Rt=this.calculateImageOrLabelDimensions_($e.width,$e.height,xt[0],xt[1],$e.width,$e.height,_,w,0,0,xt[3],je,!1,zh,!1,ue);if(l&&T==="declutter"&&l.collides(Rt.declutterBox))break e;Re.push([e,t,$e,Rt,1,null,null])}if(O)for(ze=0,Me=ce.length;ze<Me;++ze){xt=ce[ze],He=xt[4],$e=this.createLabel(He,A,O,""),_=xt[2],w=Mt*$e.height-rn;const Rt=this.calculateImageOrLabelDimensions_($e.width,$e.height,xt[0],xt[1],$e.width,$e.height,_,w,0,0,xt[3],je,!1,zh,!1,ue);if(l&&T==="declutter"&&l.collides(Rt.declutterBox))break e;Re.push([e,t,$e,Rt,1,null,null])}l&&T!=="none"&&l.load(Re.map(jN));for(let Rt=0,Ht=Re.length;Rt<Ht;++Rt)this.replayImageOrLabel_.apply(this,Re[Rt])}}++g;break;case Bt.END_GEOMETRY:if(a!==void 0){ue=V[1];const Pe=a(ue,Z,T);if(Pe)return Pe}++g;break;case Bt.FILL:Ne?P++:this.fill_(e),++g;break;case Bt.MOVE_TO_LINE_TO:for(x=V[1],y=V[2],ke=h[x],ae=h[x+1],e.moveTo(ke,ae),b=ke+.5|0,R=ae+.5|0,x+=2;x<y;x+=2)ke=h[x],ae=h[x+1],M=ke+.5|0,D=ae+.5|0,(x==y-2||M!==b||D!==R)&&(e.lineTo(ke,ae),b=M,R=D);++g;break;case Bt.SET_FILL_STYLE:this.alignAndScaleFill_=V[2],P&&(this.fill_(e),P=0,z&&(e.stroke(),z=0)),e.fillStyle=V[1],++g;break;case Bt.SET_STROKE_STYLE:z&&(e.stroke(),z=0),this.setStrokeStyle_(e,V),++g;break;case Bt.STROKE:Ne?z++:e.stroke(),++g;break;default:++g;break}}P&&this.fill_(e),z&&e.stroke()}execute(e,t,r,i,s,a){this.viewRotation_=i,this.execute_(e,t,r,this.instructions,s,void 0,void 0,a)}executeHitDetection(e,t,r,i,s){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,i,s)}}const Lh=["Polygon","Circle","LineString","Image","Text","Default"],Cj=["Image","Text"],rH=Lh.filter(n=>!Cj.includes(n));class iH{constructor(e,t,r,i,s,a,o){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=t,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=ni(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,o)}clip(e,t){const r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,t){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const s=e[r];for(const a in s){const o=s[a];i[a]=new nH(this.resolution_,this.pixelRatio_,this.overlaps_,o,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const r=this.executorsByZIndex_[t];for(let i=0,s=e.length;i<s;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,t,r,i,s,a){i=Math.round(i);const o=i*2+1,l=$a(this.hitDetectionTransform_,i+.5,i+.5,1/t,-1/t,-r,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=Kr(o,o));const h=this.hitDetectionContext_;h.canvas.width!==o||h.canvas.height!==o?(h.canvas.width=o,h.canvas.height=o):c||h.clearRect(0,0,o,o);let g;this.renderBuffer_!==void 0&&(g=$s(),Bm(g,e),M0(g,t*(this.renderBuffer_+i),g));const m=sH(i);let x;function y(D,B,k){const A=h.getImageData(0,0,o,o).data;for(let C=0,O=m.length;C<O;C++)if(A[m[C]]>0){if(!a||k==="none"||x!=="Image"&&x!=="Text"||a.includes(D)){const P=(m[C]-3)/4,z=i-P%o,F=i-(P/o|0),xe=s(D,B,z*z+F*F);if(xe)return xe}h.clearRect(0,0,o,o);break}}const _=Object.keys(this.executorsByZIndex_).map(Number);_.sort(Xl);let w,T,b,R,M;for(w=_.length-1;w>=0;--w){const D=_[w].toString();for(b=this.executorsByZIndex_[D],T=Lh.length-1;T>=0;--T)if(x=Lh[T],R=b[x],R!==void 0&&(M=R.executeHitDetection(h,l,r,y,g),M))return M}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const r=t[0],i=t[1],s=t[2],a=t[3],o=[r,i,r,a,s,a,s,i];return rl(o,0,8,2,e,o),o}isEmpty(){return id(this.executorsByZIndex_)}execute(e,t,r,i,s,a,o){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(o?RD:Xl),a=a||Lh;const c=Lh.length;for(let h=0,g=l.length;h<g;++h){const m=l[h].toString(),x=this.executorsByZIndex_[m];for(let y=0,_=a.length;y<_;++y){const w=a[y],T=x[w];if(T!==void 0){const b=o===null?void 0:T.getZIndexContext(),R=b?b.getContext():e,M=this.maxExtent_&&w!=="Image"&&w!=="Text";if(M&&(R.save(),this.clip(R,r)),!b||w==="Text"||w==="Image"?T.execute(R,t,r,i,s,o):b.pushFunction(D=>T.execute(D,t,r,i,s,o)),M&&R.restore(),b){b.offset();const D=l[h]*c+Lh.indexOf(w);this.deferredZIndexContexts_[D]||(this.deferredZIndexContexts_[D]=[]),this.deferredZIndexContexts_[D].push(b)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Xl);for(let r=0,i=t.length;r<i;++r)e[t[r]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[r]].length=0}}const jS={};function sH(n){if(jS[n]!==void 0)return jS[n];const e=n*2+1,t=n*n,r=new Array(t+1);for(let s=0;s<=n;++s)for(let a=0;a<=n;++a){const o=s*s+a*a;if(o>t)break;let l=r[o];l||(l=[],r[o]=l),l.push(((n+s)*e+(n+a))*4+3),s>0&&l.push(((n-s)*e+(n+a))*4+3),a>0&&(l.push(((n+s)*e+(n-a))*4+3),s>0&&l.push(((n-s)*e+(n-a))*4+3))}const i=[];for(let s=0,a=r.length;s<a;++s)r[s]&&i.push(...r[s]);return jS[n]=i,i}function VN(n,e,t,r){return t!==void 0&&r!==void 0?[t/n,r/e]:t!==void 0?t/n:r!==void 0?r/e:1}let I1=class Pj extends Lw{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const a=e.img!==void 0?e.img:null;let o=e.src;Rn(!(o!==void 0&&a),"`image` and `src` cannot be provided at the same time"),(o===void 0||o.length===0)&&a&&(o=a.src||Gt(a)),Rn(o!==void 0&&o.length>0,"A defined and non-empty `src` or `image` must be provided"),Rn(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=bt.IDLE:a!==void 0&&("complete"in a?a.complete?l=a.src?bt.LOADED:bt.IDLE:l=bt.LOADING:l=bt.LOADED),this.color_=e.color!==void 0?Wa(e.color):null,this.iconImage_=H_(a,o,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let c,h;if(e.size)[c,h]=e.size;else{const g=this.getImage(1);if(g.width&&g.height)c=g.width,h=g.height;else if(g instanceof HTMLImageElement){this.initialOptions_=e;const m=()=>{if(this.unlistenImageChange(m),!this.initialOptions_)return;const x=this.iconImage_.getSize();this.setScale(VN(x[0],x[1],e.width,e.height))};this.listenImageChange(m);return}}c!==void 0&&this.setScale(VN(c,h,e.width,e.height))}}clone(){let e,t,r;return this.initialOptions_?(t=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Pj({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),r=this.getScaleArray();return[e[0]-t[0]/r[0],e[1]+t[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),r=this.iconImage_.getSize();if(!t||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=H_(null,e,this.crossOrigin_,bt.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==bt.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==bt.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Kt.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Kt.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Jo=.5;function aH(n,e,t,r,i,s,a,o,l){const c=i,h=n[0]*Jo,g=n[1]*Jo,m=Kr(h,g);m.imageSmoothingEnabled=!1;const x=m.canvas,y=new vW(m,Jo,i,null,a,o,null),_=t.length,w=Math.floor((256*256*256-1)/_),T={};for(let R=1;R<=_;++R){const M=t[R-1],D=M.getStyleFunction()||r;if(!D)continue;let B=D(M,s);if(!B)continue;Array.isArray(B)||(B=[B]);const A=(R*w).toString(16).padStart(7,"#00000");for(let C=0,O=B.length;C<O;++C){const P=B[C],z=P.getGeometryFunction()(M);if(!z||!Es(c,z.getExtent()))continue;const F=P.clone(),xe=F.getFill();xe&&xe.setColor(A);const Ce=F.getStroke();Ce&&(Ce.setColor(A),Ce.setLineDash(null)),F.setText(void 0);const Ge=P.getImage();if(Ge){const ae=Ge.getImageSize();if(!ae)continue;const Z=Kr(ae[0],ae[1],void 0,{alpha:!1}),V=Z.canvas;Z.fillStyle=A,Z.fillRect(0,0,V.width,V.height),F.setImage(new I1({img:V,anchor:Ge.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:Ge.getOrigin(),opacity:1,size:Ge.getSize(),scale:Ge.getScale(),rotation:Ge.getRotation(),rotateWithView:Ge.getRotateWithView()}))}const Ne=F.getZIndex()||0;let ue=T[Ne];ue||(ue={},T[Ne]=ue,ue.Polygon=[],ue.Circle=[],ue.LineString=[],ue.Point=[]);const ke=z.getType();if(ke==="GeometryCollection"){const ae=z.getGeometriesArrayRecursive();for(let Z=0,V=ae.length;Z<V;++Z){const Q=ae[Z];ue[Q.getType().replace("Multi","")].push(Q,F)}}else ue[ke.replace("Multi","")].push(z,F)}}const b=Object.keys(T).map(Number).sort(Xl);for(let R=0,M=b.length;R<M;++R){const D=T[b[R]];for(const B in D){const k=D[B];for(let A=0,C=k.length;A<C;A+=2){y.setStyle(k[A+1]);for(let O=0,P=e.length;O<P;++O)y.setTransform(e[O]),y.drawGeometry(k[A])}}}return m.getImageData(0,0,x.width,x.height)}function oH(n,e,t){const r=[];if(t){const i=Math.floor(Math.round(n[0])*Jo),s=Math.floor(Math.round(n[1])*Jo),a=(ur(i,0,t.width-1)+ur(s,0,t.height-1)*t.width)*4,o=t.data[a],l=t.data[a+1],h=t.data[a+2]+256*(l+256*o),g=Math.floor((256*256*256-1)/e.length);h&&h%g===0&&r.push(e[h/g-1])}return r}class zm extends yl{constructor(e,t,r,i){super(e),this.inversePixelTransform=t,this.frameState=r,this.context=i}}const lH=5;class Nj extends w1{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=lH}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return Wt()}getData(e){return null}prepareFrame(e){return Wt()}renderFrame(e,t){return Wt()}forEachFeatureAtCoordinate(e,t,r,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===bt.LOADED||t.getState()===bt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=bt.LOADED&&t!=bt.ERROR&&e.addEventListener(Kt.CHANGE,this.boundHandleImageChange_),t==bt.IDLE&&(e.load(),t=e.getState()),t==bt.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const BN=[];let $f=null;function cH(){$f=Kr(1,1,void 0,{willReadFrequently:!0})}class IA extends Nj{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=ni(),this.pixelTransform=ni(),this.inversePixelTransform=ni(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,r){$f||cH(),$f.clearRect(0,0,1,1);let i;try{$f.drawImage(e,t,r,1,1,0,0,1,1),i=$f.getImageData(0,0,1,1).data}catch{return $f=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,t,r){const i=this.getLayer().getClassName();let s,a;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&gc(Wa(e.style.backgroundColor),Wa(r)))){const o=e.firstElementChild;du(o)&&(a=o.getContext("2d"))}if(a&&N$(a.canvas.style.transform,t)?(this.container=e,this.context=a,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=da?oj():document.createElement("div"),s.className=i;let o=s.style;o.position="absolute",o.width="100%",o.height="100%",a=Kr();const l=a.canvas;s.appendChild(l),o=l.style,o.position="absolute",o.left="0",o.transformOrigin="top left",this.container=s,this.context=a}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,t,r){const i=kd(r),s=Tw(r),a=Sw(r),o=Ew(r);Cr(t.coordinateToPixelTransform,i),Cr(t.coordinateToPixelTransform,s),Cr(t.coordinateToPixelTransform,a),Cr(t.coordinateToPixelTransform,o);const l=this.inversePixelTransform;Cr(l,i),Cr(l,s),Cr(l,a),Cr(l,o),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.clip()}prepareContainer(e,t){const r=e.extent,i=e.viewState.resolution,s=e.viewState.rotation,a=e.pixelRatio,o=Math.round(mn(r)/i*a),l=Math.round(ti(r)/i*a);$a(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,s,-o/2,-l/2),Sp(this.inversePixelTransform,this.pixelTransform);const c=P$(this.pixelTransform);if(this.useContainer(t,c,this.getBackground(e)),!this.containerReused){const h=this.context.canvas;h.width!=o||h.height!=l?(h.width=o,h.height=l):this.context.clearRect(0,0,o,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){const s=new zm(e,this.inversePixelTransform,r,t);i.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Ti.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Ti.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new Ij),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Ti.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Ti.POSTRENDER,this.context,e))}getRenderTransform(e,t,r,i,s,a,o){const l=s/2,c=a/2,h=i/t,g=-h,m=-e[0]+o,x=-e[1];return $a(this.tempTransform,l,c,h,g,-r,m,x)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class uH extends IA{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=$s(),this.wrappedRenderedExtent_=$s(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,r){const i=t.extent,s=t.viewState,a=s.center,o=s.resolution,l=s.projection,c=s.rotation,h=l.getExtent(),g=this.getLayer().getSource(),m=this.getLayer().getDeclutter(),x=t.pixelRatio,y=t.viewHints,_=!(y[Qr.ANIMATING]||y[Qr.INTERACTING]),w=this.context,T=Math.round(mn(i)/o*x),b=Math.round(ti(i)/o*x),R=g.getWrapX()&&l.canWrapX(),M=R?mn(h):null,D=R?Math.ceil((i[2]-h[2])/M)+1:1;let B=R?Math.floor((i[0]-h[0])/M):0;do{let k=this.getRenderTransform(a,o,0,x,T,b,B*M);t.declutter&&(k=k.slice(0)),e.execute(w,[w.canvas.width,w.canvas.height],k,c,_,r===void 0?Lh:r?Cj:rH,r?m&&t.declutter[m]:void 0)}while(++B<D)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Kr(this.context.canvas.width,this.context.canvas.height,BN))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Mw(this.context),BN.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,t);const s=this.context,a=this.replayGroup_;let o=a&&!a.isEmpty();if(!o&&!(this.getLayer().hasListener(Ti.PRERENDER)||this.getLayer().hasListener(Ti.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),i.projection,this.clipped_=!1,o&&r.extent&&this.clipping){const l=Oa(r.extent);o=Es(l,e.extent),this.clipped_=o&&!cu(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return o&&this.renderWorlds(a,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,s=this.renderedResolution_,a=this.renderedRotation_,o=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],g=r[0]*Jo,m=r[1]*Jo;h.push(this.getRenderTransform(i,s,a,Jo,g,m,0).slice());const x=c.getSource(),y=o.getExtent();if(x.getWrapX()&&o.canWrapX()&&!cu(y,l)){let _=l[0];const w=mn(y);let T=0,b;for(;_<y[0];)--T,b=w*T,h.push(this.getRenderTransform(i,s,a,Jo,g,m,b).slice()),_+=w;for(T=0,_=l[2];_>y[2];)++T,b=w*T,h.push(this.getRenderTransform(i,s,a,Jo,g,m,b).slice()),_-=w}this.hitDetectionImageData_=aH(r,h,this.renderedFeatures_,c.getStyleFunction(),l,s,a,bN(s,this.renderedPixelRatio_))}t(oH(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,r,i,s){if(!this.replayGroup_)return;const a=t.viewState.resolution,o=t.viewState.rotation,l=this.getLayer(),c={},h=function(m,x,y){const _=Gt(m),w=c[_];if(w){if(w!==!0&&y<w.distanceSq){if(y===0)return c[_]=!0,s.splice(s.lastIndexOf(w),1),i(m,l,x);w.geometry=x,w.distanceSq=y}}else{if(y===0)return c[_]=!0,i(m,l,x);s.push(c[_]={feature:m,layer:l,geometry:x,distanceSq:y,callback:i})}},g=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,a,o,r,h,g?t.declutter?.[g]?.all().map(m=>m.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),r=t.getSource();if(!r)return!1;const i=e.viewHints[Qr.ANIMATING],s=e.viewHints[Qr.INTERACTING],a=t.getUpdateWhileAnimating(),o=t.getUpdateWhileInteracting();if(this.ready&&!a&&i||!o&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,c=e.viewState,h=c.projection,g=c.resolution,m=e.pixelRatio,x=t.getRevision(),y=t.getRenderBuffer();let _=t.getRenderOrder();_===void 0&&(_=EW);const w=c.center.slice(),T=M0(l,y*g),b=T.slice(),R=[T.slice()],M=h.getExtent();if(r.getWrapX()&&h.canWrapX()&&!cu(M,e.extent)){const xe=mn(M),Ce=Math.max(mn(T)/2,xe);T[0]=M[0]-Ce,T[2]=M[2]+Ce,FD(w,h);const Ge=OD(R[0],h);Ge[0]<M[0]&&Ge[2]<M[2]?R.push([Ge[0]+xe,Ge[1],Ge[2]+xe,Ge[3]]):Ge[0]>M[0]&&Ge[2]>M[2]&&R.push([Ge[0]-xe,Ge[1],Ge[2]-xe,Ge[3]])}if(this.ready&&this.renderedResolution_==g&&this.renderedRevision_==x&&this.renderedRenderOrder_==_&&this.renderedFrameDeclutter_===!!e.declutter&&cu(this.wrappedRenderedExtent_,T))return gc(this.renderedExtent_,b)||(this.hitDetectionImageData_=null,this.renderedExtent_=b),this.renderedCenter_=w,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const D=new JW(yj(g,m),T,g,m);let B;for(let xe=0,Ce=R.length;xe<Ce;++xe)r.loadFeatures(R[xe],g,h);const k=bN(g,m);let A=!0;const C=(xe,Ce)=>{let Ge;const Ne=xe.getStyleFunction()||t.getStyleFunction();if(Ne&&(Ge=Ne(xe,g)),Ge){const ue=this.renderFeature(xe,k,Ge,D,B,this.getLayer().getDeclutter(),Ce);A=A&&!ue}},O=KD(T),P=r.getFeaturesInExtent(O);_&&P.sort(_);for(let xe=0,Ce=P.length;xe<Ce;++xe)C(P[xe],xe);this.renderedFeatures_=P,this.ready=A;const z=D.finish(),F=new iH(T,g,m,r.getOverlaps(),z,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=g,this.renderedRevision_=x,this.renderedRenderOrder_=_,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=b,this.wrappedRenderedExtent_=T,this.renderedCenter_=w,this.renderedProjection_=h,this.renderedPixelRatio_=m,this.replayGroup_=F,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,r,i,s,a,o){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let c=0,h=r.length;c<h;++c)l=RN(i,e,r[c],t,this.boundHandleStyleImageChange_,s,a,o)||l;else l=RN(i,e,r,t,this.boundHandleStyleImageChange_,s,a,o);return l}}let Md=0;const ei=1<<Md++,kt=1<<Md++,fi=1<<Md++,vr=1<<Md++,Hs=1<<Md++,ja=1<<Md++,Ay=Math.pow(2,Md)-1,CA={[ei]:"boolean",[kt]:"number",[fi]:"string",[vr]:"color",[Hs]:"number[]",[ja]:"size"},hH=Object.keys(CA).map(Number).sort(Xl);function dH(n){return n in CA}function i0(n){const e=[];for(const t of hH)Rm(n,t)&&e.push(CA[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Rm(n,e){return(n&e)===e}function Yo(n,e){return n===e}class di{constructor(e,t){if(!dH(e))throw new Error(`literal expressions must have a specific type, got ${i0(e)}`);this.type=e,this.value=t}}class Mj{constructor(e,t,...r){this.type=e,this.operator=t,this.args=r}}function PA(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Ii(n,e,t){switch(typeof n){case"boolean":{if(Yo(e,fi))return new di(fi,n?"true":"false");if(!Rm(e,ei))throw new Error(`got a boolean, but expected ${i0(e)}`);return new di(ei,n)}case"number":{if(Yo(e,ja))return new di(ja,ki(n));if(Yo(e,ei))return new di(ei,!!n);if(Yo(e,fi))return new di(fi,n.toString());if(!Rm(e,kt))throw new Error(`got a number, but expected ${i0(e)}`);return new di(kt,n)}case"string":{if(Yo(e,vr))return new di(vr,EA(n));if(Yo(e,ei))return new di(ei,!!n);if(!Rm(e,fi))throw new Error(`got a string, but expected ${i0(e)}`);return new di(fi,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return SH(n,e,t);for(const r of n)if(typeof r!="number")throw new Error("expected an array of numbers");if(Yo(e,ja)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new di(ja,n)}if(Yo(e,vr)){if(n.length===3)return new di(vr,[...n,1]);if(n.length===4)return new di(vr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Rm(e,Hs))throw new Error(`got an array of numbers, but expected ${i0(e)}`);return new di(Hs,n)}const me={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},fH={[me.Get]:Zt(on(1,1/0),GN),[me.Var]:Zt(on(1,1),gH),[me.Has]:Zt(on(1,1/0),GN),[me.Id]:Zt(mH,Rf),[me.Concat]:Zt(on(2,1/0),On(fi)),[me.GeometryType]:Zt(pH,Rf),[me.LineMetric]:Zt(Rf),[me.Resolution]:Zt(FS,Rf),[me.Zoom]:Zt(FS,Rf),[me.Time]:Zt(FS,Rf),[me.Any]:Zt(on(2,1/0),On(ei)),[me.All]:Zt(on(2,1/0),On(ei)),[me.Not]:Zt(on(1,1),On(ei)),[me.Equal]:Zt(on(2,2),On(Ay)),[me.NotEqual]:Zt(on(2,2),On(Ay)),[me.GreaterThan]:Zt(on(2,2),On(kt)),[me.GreaterThanOrEqualTo]:Zt(on(2,2),On(kt)),[me.LessThan]:Zt(on(2,2),On(kt)),[me.LessThanOrEqualTo]:Zt(on(2,2),On(kt)),[me.Multiply]:Zt(on(2,1/0),zN),[me.Coalesce]:Zt(on(2,1/0),zN),[me.Divide]:Zt(on(2,2),On(kt)),[me.Add]:Zt(on(2,1/0),On(kt)),[me.Subtract]:Zt(on(2,2),On(kt)),[me.Clamp]:Zt(on(3,3),On(kt)),[me.Mod]:Zt(on(2,2),On(kt)),[me.Pow]:Zt(on(2,2),On(kt)),[me.Abs]:Zt(on(1,1),On(kt)),[me.Floor]:Zt(on(1,1),On(kt)),[me.Ceil]:Zt(on(1,1),On(kt)),[me.Round]:Zt(on(1,1),On(kt)),[me.Sin]:Zt(on(1,1),On(kt)),[me.Cos]:Zt(on(1,1),On(kt)),[me.Atan]:Zt(on(1,2),On(kt)),[me.Sqrt]:Zt(on(1,1),On(kt)),[me.Match]:Zt(on(4,1/0),UN,yH),[me.Between]:Zt(on(3,3),On(kt)),[me.Interpolate]:Zt(on(6,1/0),UN,_H),[me.Case]:Zt(on(3,1/0),xH,vH),[me.In]:Zt(on(2,2),wH),[me.Number]:Zt(on(1,1/0),On(Ay)),[me.String]:Zt(on(1,1/0),On(Ay)),[me.Array]:Zt(on(1,1/0),On(kt)),[me.Color]:Zt(on(1,4),On(kt)),[me.Band]:Zt(on(1,3),On(kt)),[me.Palette]:Zt(on(2,2),EH),[me.ToString]:Zt(on(1,1),On(ei|kt|fi|vr))};function GN(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=n[s+1];switch(typeof a){case"number":{i[s]=new di(kt,a);break}case"string":{i[s]=new di(fi,a);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${a}`)}s===0&&t.properties.add(String(a))}return i}function gH(n,e,t){const r=n[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return t.variables.add(r),[new di(fi,r)]}function mH(n,e,t){t.featureId=!0}function pH(n,e,t){t.geometryType=!0}function FS(n,e,t){t.mapState=!0}function Rf(n,e,t){const r=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function on(n,e){return function(t,r,i){const s=t[0],a=t.length-1;if(n===e){if(a!==n){const o=n===1?"":"s";throw new Error(`expected ${n} argument${o} for ${s}, got ${a}`)}}else if(a<n||a>e){const o=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${o} arguments for ${s}, got ${a}`)}}}function zN(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=Ii(n[s+1],e,t);i[s]=a}return i}function On(n){return function(e,t,r){const i=e.length-1,s=new Array(i);for(let a=0;a<i;++a){const o=Ii(e[a+1],n,r);s[a]=o}return s}}function xH(n,e,t){const r=n[0],i=n.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function UN(n,e,t){const r=n[0],i=n.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function yH(n,e,t){const r=n.length-1,i=fi|kt|ei,s=Ii(n[1],i,t),a=Ii(n[n.length-1],e,t),o=new Array(r-2);for(let l=0;l<r-2;l+=2){try{const c=Ii(n[l+2],s.type,t);o[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=Ii(n[l+3],a.type,t);o[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...o,a]}function _H(n,e,t){const r=n[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const s=new di(kt,i);let a;try{a=Ii(n[2],kt,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const o=new Array(n.length-3);for(let l=0;l<o.length;l+=2){try{const c=Ii(n[l+3],kt,t);o[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=Ii(n[l+4],e,t);o[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,a,...o]}function vH(n,e,t){const r=Ii(n[n.length-1],e,t),i=new Array(n.length-1);for(let s=0;s<i.length-1;s+=2){try{const a=Ii(n[s+1],ei,t);i[s]=a}catch(a){throw new Error(`failed to parse argument ${s} of case expression: ${a.message}`)}try{const a=Ii(n[s+2],r.type,t);i[s+1]=a}catch(a){throw new Error(`failed to parse argument ${s+1} of case expression: ${a.message}`)}}return i[i.length-1]=r,i}function wH(n,e,t){let r=n[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=fi}else i=kt;const s=new Array(r.length);for(let o=0;o<s.length;o++)try{const l=Ii(r[o],i,t);s[o]=l}catch(l){throw new Error(`failed to parse haystack item ${o} for "in" expression: ${l.message}`)}return[Ii(n[1],i,t),...s]}function EH(n,e,t){let r;try{r=Ii(n[1],kt,t)}catch(a){throw new Error(`failed to parse first argument in palette expression: ${a.message}`)}const i=n[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const s=new Array(i.length);for(let a=0;a<s.length;a++){let o;try{o=Ii(i[a],vr,t)}catch(l){throw new Error(`failed to parse color at index ${a} in palette expression: ${l.message}`)}if(!(o instanceof di))throw new Error(`the palette color at index ${a} must be a literal value`);s[a]=o}return[r,...s]}function Zt(...n){return function(e,t,r){const i=e[0];let s;for(let a=0;a<n.length;a++){const o=n[a](e,t,r);if(a==n.length-1){if(!o)throw new Error("expected last argument validator to return the parsed args");s=o}}return new Mj(t,i,...s)}}function SH(n,e,t){const r=n[0],i=fH[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(n,e,t)}function NA(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return NA(n.getGeometries()[0]);default:return""}}function Lj(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function pc(n,e,t){const r=Ii(n,e,t);return bo(r)}function bo(n,e){if(n instanceof di){if(n.type===vr&&typeof n.value=="string"){const r=EA(n.value);return function(){return r}}return function(){return n.value}}const t=n.operator;switch(t){case me.Number:case me.String:case me.Coalesce:return TH(n);case me.Get:case me.Var:case me.Has:return bH(n);case me.Id:return r=>r.featureId;case me.GeometryType:return r=>r.geometryType;case me.Concat:{const r=n.args.map(i=>bo(i));return i=>"".concat(...r.map(s=>s(i).toString()))}case me.Resolution:return r=>r.resolution;case me.Any:case me.All:case me.Between:case me.In:case me.Not:return AH(n);case me.Equal:case me.NotEqual:case me.LessThan:case me.LessThanOrEqualTo:case me.GreaterThan:case me.GreaterThanOrEqualTo:return RH(n);case me.Multiply:case me.Divide:case me.Add:case me.Subtract:case me.Clamp:case me.Mod:case me.Pow:case me.Abs:case me.Floor:case me.Ceil:case me.Round:case me.Sin:case me.Cos:case me.Atan:case me.Sqrt:return kH(n);case me.Case:return IH(n);case me.Match:return CH(n);case me.Interpolate:return PH(n);case me.ToString:return NH(n);default:throw new Error(`Unsupported operator ${t}`)}}function TH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=bo(n.args[s]);switch(t){case me.Coalesce:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o<"u"&&o!==null)return o}throw new Error("Expected one of the values to be non-null")};case me.Number:case me.String:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o===t)return o}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function bH(n,e){const r=n.args[0].value;switch(n.operator){case me.Get:return i=>{const s=n.args;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;a=a[h]}return a};case me.Var:return i=>i.variables[r];case me.Has:return i=>{const s=n.args;if(!(r in i.properties))return!1;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;if(!a||!Object.hasOwn(a,h))return!1;a=a[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function RH(n,e){const t=n.operator,r=bo(n.args[0]),i=bo(n.args[1]);switch(t){case me.Equal:return s=>r(s)===i(s);case me.NotEqual:return s=>r(s)!==i(s);case me.LessThan:return s=>r(s)<i(s);case me.LessThanOrEqualTo:return s=>r(s)<=i(s);case me.GreaterThan:return s=>r(s)>i(s);case me.GreaterThanOrEqualTo:return s=>r(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function AH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=bo(n.args[s]);switch(t){case me.Any:return s=>{for(let a=0;a<r;++a)if(i[a](s))return!0;return!1};case me.All:return s=>{for(let a=0;a<r;++a)if(!i[a](s))return!1;return!0};case me.Between:return s=>{const a=i[0](s),o=i[1](s),l=i[2](s);return a>=o&&a<=l};case me.In:return s=>{const a=i[0](s);for(let o=1;o<r;++o)if(a===i[o](s))return!0;return!1};case me.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function kH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=bo(n.args[s]);switch(t){case me.Multiply:return s=>{let a=1;for(let o=0;o<r;++o)a*=i[o](s);return a};case me.Divide:return s=>i[0](s)/i[1](s);case me.Add:return s=>{let a=0;for(let o=0;o<r;++o)a+=i[o](s);return a};case me.Subtract:return s=>i[0](s)-i[1](s);case me.Clamp:return s=>{const a=i[0](s),o=i[1](s);if(a<o)return o;const l=i[2](s);return a>l?l:a};case me.Mod:return s=>i[0](s)%i[1](s);case me.Pow:return s=>Math.pow(i[0](s),i[1](s));case me.Abs:return s=>Math.abs(i[0](s));case me.Floor:return s=>Math.floor(i[0](s));case me.Ceil:return s=>Math.ceil(i[0](s));case me.Round:return s=>Math.round(i[0](s));case me.Sin:return s=>Math.sin(i[0](s));case me.Cos:return s=>Math.cos(i[0](s));case me.Atan:return r===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case me.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function IH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=bo(n.args[i]);return i=>{for(let s=0;s<t-1;s+=2)if(r[s](i))return r[s+1](i);return r[t-1](i)}}function CH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=bo(n.args[i]);return i=>{const s=r[0](i);for(let a=1;a<t-1;a+=2)if(s===r[a](i))return r[a+1](i);return r[t-1](i)}}function PH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=bo(n.args[i]);return i=>{const s=r[0](i),a=r[1](i);let o,l;for(let c=2;c<t;c+=2){const h=r[c](i);let g=r[c+1](i);const m=Array.isArray(g);if(m&&(g=aW(g)),h>=a)return c===2?g:m?MH(s,a,o,l,h,g):Am(s,a,o,l,h,g);o=h,l=g}return l}}function NH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=bo(n.args[s]);switch(t){case me.ToString:return s=>{const a=i[0](s);return n.args[0].type===vr?SA(a):a.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function Am(n,e,t,r,i,s){const a=i-t;if(a===0)return r;const o=e-t,l=n===1?o/a:(Math.pow(n,o)-1)/(Math.pow(n,a)-1);return r+l*(s-r)}function MH(n,e,t,r,i,s){if(i-t===0)return r;const o=vN(r),l=vN(s);let c=l[2]-o[2];c>180?c-=360:c<-180&&(c+=360);const h=[Am(n,e,t,o[0],i,l[0]),Am(n,e,t,o[1],i,l[1]),o[2]+Am(n,e,t,0,i,c),Am(n,e,t,r[3],i,s[3])];return oW(h)}function LH(n){return!0}function OH(n){const e=PA(),t=DH(n,e),r=Lj();return function(i,s){if(r.properties=i.getPropertiesInternal(),r.resolution=s,e.featureId){const a=i.getId();a!==void 0?r.featureId=a:r.featureId=null}return e.geometryType&&(r.geometryType=NA(i.getGeometry())),t(r)}}function $N(n){const e=PA(),t=n.length,r=new Array(t);for(let a=0;a<t;++a)r[a]=Eb(n[a],e);const i=Lj(),s=new Array(t);return function(a,o){if(i.properties=a.getPropertiesInternal(),i.resolution=o,e.featureId){const c=a.getId();c!==void 0?i.featureId=c:i.featureId=null}let l=0;for(let c=0;c<t;++c){const h=r[c](i);h&&(s[l]=h,l+=1)}return s.length=l,s}}function DH(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i){const s=n[i],a="filter"in s?pc(s.filter,ei,e):LH;let o;if(Array.isArray(s.style)){const l=s.style.length;o=new Array(l);for(let c=0;c<l;++c)o[c]=Eb(s.style[c],e)}else o=[Eb(s.style,e)];r[i]={filter:a,styles:o}}return function(i){const s=[];let a=!1;for(let o=0;o<t;++o){const l=r[o].filter;if(l(i)&&!(n[o].else&&a)){a=!0;for(const c of r[o].styles){const h=c(i);h&&s.push(h)}}}return s}}function Eb(n,e){const t=Cp(n,"",e),r=Pp(n,"",e),i=jH(n,e),s=FH(n,e),a=Vs(n,"z-index",e);if(!t&&!r&&!i&&!s&&!id(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const o=new pn;return function(l){let c=!0;if(t){const h=t(l);h&&(c=!1),o.setFill(h)}if(r){const h=r(l);h&&(c=!1),o.setStroke(h)}if(i){const h=i(l);h&&(c=!1),o.setText(h)}if(s){const h=s(l);h&&(c=!1),o.setImage(h)}return a&&o.setZIndex(a(l)),c?null:o}}function Cp(n,e,t){let r;if(e+"fill-pattern-src"in n)r=zH(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;r=MA(n,e+"fill-color",t)}if(!r)return null;const i=new rr;return function(s){const a=r(s);return a===wA?null:(i.setColor(a),i)}}function Pp(n,e,t){const r=Vs(n,e+"stroke-width",t),i=MA(n,e+"stroke-color",t);if(!r&&!i)return null;const s=Gl(n,e+"stroke-line-cap",t),a=Gl(n,e+"stroke-line-join",t),o=Oj(n,e+"stroke-line-dash",t),l=Vs(n,e+"stroke-line-dash-offset",t),c=Vs(n,e+"stroke-miter-limit",t),h=new Yn;return function(g){if(i){const m=i(g);if(m===wA)return null;h.setColor(m)}if(r&&h.setWidth(r(g)),s){const m=s(g);if(m!=="butt"&&m!=="round"&&m!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(m)}if(a){const m=a(g);if(m!=="bevel"&&m!=="round"&&m!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(m)}return o&&h.setLineDash(o(g)),l&&h.setLineDashOffset(l(g)),c&&h.setMiterLimit(c(g)),h}}function jH(n,e){const t="text-",r=Gl(n,t+"value",e);if(!r)return null;const i=Cp(n,t,e),s=Cp(n,t+"background-",e),a=Pp(n,t,e),o=Pp(n,t+"background-",e),l=Gl(n,t+"font",e),c=Vs(n,t+"max-angle",e),h=Vs(n,t+"offset-x",e),g=Vs(n,t+"offset-y",e),m=p0(n,t+"overflow",e),x=Gl(n,t+"placement",e),y=Vs(n,t+"repeat",e),_=Dw(n,t+"scale",e),w=p0(n,t+"rotate-with-view",e),T=Vs(n,t+"rotation",e),b=Gl(n,t+"align",e),R=Gl(n,t+"justify",e),M=Gl(n,t+"baseline",e),D=p0(n,t+"keep-upright",e),B=Oj(n,t+"padding",e),k=jw(n,t+"declutter-mode"),A=new vo({declutterMode:k});return function(C){if(A.setText(r(C)),i&&A.setFill(i(C)),s&&A.setBackgroundFill(s(C)),a&&A.setStroke(a(C)),o&&A.setBackgroundStroke(o(C)),l&&A.setFont(l(C)),c&&A.setMaxAngle(c(C)),h&&A.setOffsetX(h(C)),g&&A.setOffsetY(g(C)),m&&A.setOverflow(m(C)),x){const O=x(C);if(O!=="point"&&O!=="line")throw new Error("Expected point or line for text-placement");A.setPlacement(O)}if(y&&A.setRepeat(y(C)),_&&A.setScale(_(C)),w&&A.setRotateWithView(w(C)),T&&A.setRotation(T(C)),b){const O=b(C);if(O!=="left"&&O!=="center"&&O!=="right"&&O!=="end"&&O!=="start")throw new Error("Expected left, right, center, start, or end for text-align");A.setTextAlign(O)}if(R){const O=R(C);if(O!=="left"&&O!=="right"&&O!=="center")throw new Error("Expected left, right, or center for text-justify");A.setJustify(O)}if(M){const O=M(C);if(O!=="bottom"&&O!=="top"&&O!=="middle"&&O!=="alphabetic"&&O!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");A.setTextBaseline(O)}return B&&A.setPadding(B(C)),D&&A.setKeepUpright(D(C)),A}}function FH(n,e){return"icon-src"in n?VH(n,e):"shape-points"in n?BH(n,e):"circle-radius"in n?GH(n,e):null}function VH(n,e){const t="icon-",r=t+"src",i=Dj(n[r],r),s=Y_(n,t+"anchor",e),a=Dw(n,t+"scale",e),o=Vs(n,t+"opacity",e),l=Y_(n,t+"displacement",e),c=Vs(n,t+"rotation",e),h=p0(n,t+"rotate-with-view",e),g=HN(n,t+"anchor-origin"),m=KN(n,t+"anchor-x-units"),x=KN(n,t+"anchor-y-units"),y=HH(n,t+"color"),_=$H(n,t+"cross-origin"),w=WH(n,t+"offset"),T=HN(n,t+"offset-origin"),b=Z_(n,t+"width"),R=Z_(n,t+"height"),M=UH(n,t+"size"),D=jw(n,t+"declutter-mode"),B=new I1({src:i,anchorOrigin:g,anchorXUnits:m,anchorYUnits:x,color:y,crossOrigin:_,offset:w,offsetOrigin:T,height:R,width:b,size:M,declutterMode:D});return function(k){return o&&B.setOpacity(o(k)),l&&B.setDisplacement(l(k)),c&&B.setRotation(c(k)),h&&B.setRotateWithView(h(k)),a&&B.setScale(a(k)),s&&B.setAnchor(s(k)),B}}function BH(n,e){const t="shape-",r=t+"points",i=t+"radius",s=Sb(n[r],r),a=Sb(n[i],i),o=Cp(n,t,e),l=Pp(n,t,e),c=Dw(n,t+"scale",e),h=Y_(n,t+"displacement",e),g=Vs(n,t+"rotation",e),m=p0(n,t+"rotate-with-view",e),x=Z_(n,t+"radius2"),y=Z_(n,t+"angle"),_=jw(n,t+"declutter-mode"),w=new Ow({points:s,radius:a,radius2:x,angle:y,declutterMode:_});return function(T){return o&&w.setFill(o(T)),l&&w.setStroke(l(T)),h&&w.setDisplacement(h(T)),g&&w.setRotation(g(T)),m&&w.setRotateWithView(m(T)),c&&w.setScale(c(T)),w}}function GH(n,e){const t="circle-",r=Cp(n,t,e),i=Pp(n,t,e),s=Vs(n,t+"radius",e),a=Dw(n,t+"scale",e),o=Y_(n,t+"displacement",e),l=Vs(n,t+"rotation",e),c=p0(n,t+"rotate-with-view",e),h=jw(n,t+"declutter-mode"),g=new Ws({radius:5,declutterMode:h});return function(m){return s&&g.setRadius(s(m)),r&&g.setFill(r(m)),i&&g.setStroke(i(m)),o&&g.setDisplacement(o(m)),l&&g.setRotation(l(m)),c&&g.setRotateWithView(c(m)),a&&g.setScale(a(m)),g}}function Vs(n,e,t){if(!(e in n))return;const r=pc(n[e],kt,t);return function(i){return Sb(r(i),e)}}function Gl(n,e,t){if(!(e in n))return null;const r=pc(n[e],fi,t);return function(i){return Dj(r(i),e)}}function zH(n,e,t){const r=Gl(n,e+"pattern-src",t),i=WN(n,e+"pattern-offset",t),s=WN(n,e+"pattern-size",t),a=MA(n,e+"color",t);return function(o){return{src:r(o),offset:i&&i(o),size:s&&s(o),color:a&&a(o)}}}function p0(n,e,t){if(!(e in n))return null;const r=pc(n[e],ei,t);return function(i){const s=r(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function MA(n,e,t){if(!(e in n))return null;const r=pc(n[e],vr,t);return function(i){return jj(r(i),e)}}function Oj(n,e,t){if(!(e in n))return null;const r=pc(n[e],Hs,t);return function(i){return C1(r(i),e)}}function Y_(n,e,t){if(!(e in n))return null;const r=pc(n[e],Hs,t);return function(i){const s=C1(r(i),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function WN(n,e,t){if(!(e in n))return null;const r=pc(n[e],Hs,t);return function(i){return Fj(r(i),e)}}function Dw(n,e,t){if(!(e in n))return null;const r=pc(n[e],Hs|kt,t);return function(i){return KH(r(i),e)}}function Z_(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function UH(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return ki(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function $H(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function HN(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function KN(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function WH(n,e){const t=n[e];if(t!==void 0)return C1(t,e)}function jw(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function HH(n,e){const t=n[e];if(t!==void 0)return jj(t,e)}function C1(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let r=0;r<t;++r)if(typeof n[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function Dj(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function Sb(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function jj(n,e){if(typeof n=="string")return n;const t=C1(n,e),r=t.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function Fj(n,e){const t=C1(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function KH(n,e){return typeof n=="number"?n:Fj(n,e)}const io={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function XN(n,e,t){return(function(r,i,s,a,o){if(!r)return;if(!i&&!e)return r;const l=e?0:s[0]*i,c=e?0:s[1]*i,h=o?o[0]:0,g=o?o[1]:0;let m=n[0]+l/2+h,x=n[2]-l/2+h,y=n[1]+c/2+g,_=n[3]-c/2+g;m>x&&(m=(x+m)/2,x=m),y>_&&(y=(_+y)/2,_=y);let w=ur(r[0],m,x),T=ur(r[1],y,_);if(a&&t&&i){const b=30*i;w+=-b*Math.log(1+Math.max(0,m-r[0])/b)+b*Math.log(1+Math.max(0,r[0]-x)/b),T+=-b*Math.log(1+Math.max(0,y-r[1])/b)+b*Math.log(1+Math.max(0,r[1]-_)/b)}return[w,T]})}function XH(n){return n}function Vj(n){return Math.pow(n,3)}function ug(n){return 1-Vj(1-n)}function qH(n){return 3*n*n-2*n*n*n}function YH(n){return n}function LA(n,e,t,r){const i=mn(e)/t[0],s=ti(e)/t[1];return r?Math.min(n,Math.max(i,s)):Math.min(n,Math.min(i,s))}function OA(n,e,t){let r=Math.min(n,e);const i=50;return r*=Math.log(1+i*Math.max(0,n/e-1))/i+1,t&&(r=Math.max(r,t),r/=Math.log(1+i*Math.max(0,t/n-1))/i+1),ur(r,t/2,e*2)}function ZH(n,e,t,r){return e=e!==void 0?e:!0,(function(i,s,a,o){if(i!==void 0){const l=n[0],c=n[n.length-1],h=t?LA(l,t,a,r):l;if(o)return e?OA(i,h,c):ur(i,c,h);const g=Math.min(h,i),m=Math.floor(vw(n,g,s));return n[m]>h&&m<n.length-1?n[m+1]:n[m]}})}function JH(n,e,t,r,i,s){return r=r!==void 0?r:!0,t=t!==void 0?t:0,(function(a,o,l,c){if(a!==void 0){const h=i?LA(e,i,l,s):e;if(c)return r?OA(a,h,t):ur(a,t,h);const g=1e-9,m=Math.ceil(Math.log(e/h)/Math.log(n)-g),x=-o*(.5-g)+.5,y=Math.min(h,a),_=Math.floor(Math.log(e/y)/Math.log(n)+x),w=Math.max(m,_),T=e/Math.pow(n,w);return ur(T,t,h)}})}function qN(n,e,t,r,i){return t=t!==void 0?t:!0,(function(s,a,o,l){if(s!==void 0){const c=r?LA(n,r,o,i):n;return!t||!l?ur(s,e,c):OA(s,c,e)}})}function DA(n){if(n!==void 0)return 0}function YN(n){if(n!==void 0)return n}function QH(n){const e=2*Math.PI/n;return(function(t,r){if(r)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function eK(n){const e=ql(5);return(function(t,r){return r||t===void 0?t:Math.abs(t)<=e?0:t})}const tK=42,jA=256,VS=0;class Qo extends _l{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=uA(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&HD(),e.center&&(e.center=Vl(e.center,this.projection_)),e.extent&&(e.extent=Oa(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const o in io)delete t[o];this.setProperties(t,!0);const r=rK(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=nK(e),s=r.constraint,a=iK(e);this.constraints_={center:i,resolution:s,rotation:a},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),a=s/2*(i[3]-t[3]+t[1]-i[1]),o=s/2*(i[0]-t[0]+t[2]-i[2]);this.setCenterInternal([r[0]+a,r[1]-o])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let r=0;r<t.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=Vl(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=Vl(i.anchor,this.getProjection())),t[r]=i}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,r;t>1&&typeof arguments[t-1]=="function"&&(r=arguments[t-1],--t);let i=0;for(;i<t&&!this.isDef();++i){const h=arguments[i];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(i===t){r&&ky(r,!0);return}let s=Date.now(),a=this.targetCenter_.slice(),o=this.targetResolution_,l=this.targetRotation_;const c=[];for(;i<t;++i){const h=arguments[i],g={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||qH,callback:r};if(h.center&&(g.sourceCenter=a,g.targetCenter=h.center.slice(),a=g.targetCenter),h.zoom!==void 0?(g.sourceResolution=o,g.targetResolution=this.getResolutionForZoom(h.zoom),o=g.targetResolution):h.resolution&&(g.sourceResolution=o,g.targetResolution=h.resolution,o=g.targetResolution),h.rotation!==void 0){g.sourceRotation=l;const m=wu(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;g.targetRotation=l+m,l=g.targetRotation}sK(g)?g.complete=!0:s+=g.duration,c.push(g)}this.animations_.push(c),this.setHint(Qr.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Qr.ANIMATING]>0}getInteracting(){return this.hints_[Qr.INTERACTING]>0}cancelAnimations(){this.setHint(Qr.ANIMATING,-this.hints_[Qr.ANIMATING]);let e;for(let t=0,r=this.animations_.length;t<r;++t){const i=this.animations_[t];if(i[0].callback&&ky(i[0].callback,!1),!e)for(let s=0,a=i.length;s<a;++s){const o=i[s];if(!o.complete){e=o.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let s=!0;for(let a=0,o=i.length;a<o;++a){const l=i[a];if(l.complete)continue;const c=e-l.start;let h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const g=l.easing(h);if(l.sourceCenter){const m=l.sourceCenter[0],x=l.sourceCenter[1],y=l.targetCenter[0],_=l.targetCenter[1];this.nextCenter_=l.targetCenter;const w=m+g*(y-m),T=x+g*(_-x);this.targetCenter_=[w,T]}if(l.sourceResolution&&l.targetResolution){const m=g===1?l.targetResolution:l.sourceResolution+g*(l.targetResolution-l.sourceResolution);if(l.anchor){const x=this.getViewportSize_(this.getRotation()),y=this.constraints_.resolution(m,0,x,!0);this.targetCenter_=this.calculateCenterZoom(y,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const m=g===1?wu(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+g*(l.targetRotation-l.sourceRotation);if(l.anchor){const x=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(x,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=m}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[r]=null,this.setHint(Qr.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const a=i[0].callback;a&&ky(a,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-t[0],i[1]-t[1]],aA(r,e-this.getRotation()),ZU(r,t)),r}calculateCenterZoom(e,t){let r;const i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){const a=t[0]-e*(t[0]-i[0])/s,o=t[1]-e*(t[1]-i[1])/s;r=[a,o]}return r}getViewportSize_(e){const t=this.viewportSize_;if(e){const r=t[0],i=t[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&gb(e,this.getProjection())}getCenterInternal(){return this.get(io.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return KD(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();Rn(t,"The view center is not defined");const r=this.getResolution();Rn(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return Rn(i!==void 0,"The view rotation is not defined"),j_(t,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(io.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Oa(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const r=mn(e)/t[0],i=ti(e)/t[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(t/r)/Math.log(e);return(function(s){return t/Math.pow(e,s*i)})}getRotation(){return this.get(io.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/t;return(function(a){return Math.log(r/a)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const r=this.padding_;return r&&(t=[t[0]-r[1]-r[3],t[1]-r[0]-r[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const s=this.padding_;if(s){const a=this.getViewportSizeMinusPadding_();i=BS(i,this.getViewportSize_(),[a[0]/2+s[3],a[1]/2+s[0]],t,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,r,i;if(this.resolutions_){const s=vw(this.resolutions_,e,1);t=s,r=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=r/this.resolutions_[s+1]}else r=this.maxResolution_,i=this.zoomFactor_;return t+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=ur(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(r,ur(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let r;if(Rn(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){Rn(!Id(e),"Cannot fit empty extent provided as `geometry`");const i=Oa(e,this.getProjection());r=kN(i)}else if(e.getType()==="Circle"){const i=Oa(e.getExtent(),this.getProjection());r=kN(i),r.rotate(this.getRotation(),dl(i))}else r=e;this.fitInternal(r,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),r=Math.cos(t),i=Math.sin(-t),s=e.getFlatCoordinates(),a=e.getStride();let o=1/0,l=1/0,c=-1/0,h=-1/0;for(let g=0,m=s.length;g<m;g+=a){const x=s[g]*r-s[g+1]*i,y=s[g]*i+s[g+1]*r;o=Math.min(o,x),l=Math.min(l,y),c=Math.max(c,x),h=Math.max(h,y)}return[o,l,c,h]}fitInternal(e,t){t=t||{};let r=t.size;r||(r=this.getViewportSizeMinusPadding_());const i=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let a;t.minResolution!==void 0?a=t.minResolution:t.maxZoom!==void 0?a=this.getResolutionForZoom(t.maxZoom):a=0;const o=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(o,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?a:Math.max(l,a),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),h=Math.sin(c),g=Math.cos(c),m=dl(o);m[0]+=(i[1]-i[3])/2*l,m[1]+=(i[0]-i[2])/2*l;const x=m[0]*g-m[1]*h,y=m[1]*g+m[0]*h,_=this.getConstrainedCenter([x,y],l),w=t.callback?t.callback:wp;t.duration!==void 0?this.animateInternal({resolution:l,center:_,duration:t.duration,easing:t.easing},w):(this.targetResolution_=l,this.targetCenter_=_,this.applyTargetState_(!1,!0),ky(w,!0))}centerOn(e,t,r){this.centerOnInternal(Vl(e,this.getProjection()),t,r)}centerOnInternal(e,t,r){this.setCenterInternal(BS(e,t,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,r,i){let s;const a=this.padding_;if(a&&e){const o=this.getViewportSizeMinusPadding_(-r),l=BS(e,i,[o[0]/2+a[3],o[1]/2+a[0]],t,r);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=gb(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Vl(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,i,r);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Vl(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);t&&(this.targetCenter_=this.calculateCenterRotate(i,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Vl(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const r=this.getAnimating()||this.getInteracting()||t,i=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,0,s,r),o=this.constraints_.center(this.targetCenter_,a,s,r,this.calculateCenterShift(this.targetCenter_,a,i,s));this.get(io.ROTATION)!==i&&this.set(io.ROTATION,i),this.get(io.RESOLUTION)!==a&&(this.set(io.RESOLUTION,a),this.set("zoom",this.getZoom(),!0)),(!o||!this.get(io.CENTER)||!V_(this.get(io.CENTER),o))&&this.set(io.CENTER,o),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,r){e=e!==void 0?e:200;const i=t||0,s=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,i,a),l=this.constraints_.center(this.targetCenter_,o,a,!1,this.calculateCenterShift(this.targetCenter_,o,s,a));if(e===0&&!this.cancelAnchor_){this.targetResolution_=o,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==o||this.getRotation()!==s||!this.getCenterInternal()||!V_(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:o,duration:e,easing:ug,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Qr.INTERACTING,1)}endInteraction(e,t,r){r=r&&Vl(r,this.getProjection()),this.endInteractionInternal(e,t,r)}endInteractionInternal(e,t,r){this.getInteracting()&&(this.setHint(Qr.INTERACTING,-1),this.resolveConstraints(e,t,r))}getConstrainedCenter(e,t){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),r)}getConstrainedZoom(e,t){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,t))}getConstrainedResolution(e,t){t=t||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,r)}}function ky(n,e){setTimeout(function(){n(e)},0)}function nK(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return XN(n.extent,n.constrainOnlyCenter,t)}const e=uA(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,XN(t,!1,!1)}return XH}function rK(n){let e,t,r,a=n.minZoom!==void 0?n.minZoom:VS,o=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,c=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,g=n.showFullExtent!==void 0?n.showFullExtent:!1,m=uA(n.projection,"EPSG:3857"),x=m.getExtent();let y=n.constrainOnlyCenter,_=n.extent;if(!c&&!_&&m.isGlobal()&&(y=!1,_=x),n.resolutions!==void 0){const w=n.resolutions;t=w[a],r=w[o]!==void 0?w[o]:w[w.length-1],n.constrainResolution?e=ZH(w,h,!y&&_,g):e=qN(t,r,h,!y&&_,g)}else{const T=(x?Math.max(mn(x),ti(x)):360*L0.degrees/m.getMetersPerUnit())/jA/Math.pow(2,VS),b=T/Math.pow(2,28-VS);t=n.maxResolution,t!==void 0?a=0:t=T/Math.pow(l,a),r=n.minResolution,r===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?r=t/Math.pow(l,o):r=T/Math.pow(l,o):r=b),o=a+Math.floor(Math.log(t/r)/Math.log(l)),r=t/Math.pow(l,o-a),n.constrainResolution?e=JH(l,t,r,h,!y&&_,g):e=qN(t,r,h,!y&&_,g)}return{constraint:e,maxResolution:t,minResolution:r,minZoom:a,zoomFactor:l}}function iK(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?eK():t===!1?YN:typeof t=="number"?QH(t):YN}return DA}function sK(n){return!(n.sourceCenter&&n.targetCenter&&!V_(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function BS(n,e,t,r,i){const s=Math.cos(-i);let a=Math.sin(-i),o=n[0]*s-n[1]*a,l=n[1]*s+n[0]*a;o+=(e[0]/2-t[0])*r,l+=(t[1]-e[1]/2)*r,a=-a;const c=o*s-l*a,h=l*s+o*a;return[c,h]}const Dn={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Bj extends _l{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Dn.OPACITY]=e.opacity!==void 0?e.opacity:1,Rn(typeof t[Dn.OPACITY]=="number","Layer opacity must be a number"),t[Dn.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Dn.Z_INDEX]=e.zIndex,t[Dn.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Dn.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Dn.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Dn.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return t.opacity=ur(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=r===void 0&&!t.managed?1/0:r,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return Wt()}getLayerStatesArray(e){return Wt()}getExtent(){return this.get(Dn.EXTENT)}getMaxResolution(){return this.get(Dn.MAX_RESOLUTION)}getMinResolution(){return this.get(Dn.MIN_RESOLUTION)}getMinZoom(){return this.get(Dn.MIN_ZOOM)}getMaxZoom(){return this.get(Dn.MAX_ZOOM)}getOpacity(){return this.get(Dn.OPACITY)}getSourceState(){return Wt()}getVisible(){return this.get(Dn.VISIBLE)}getZIndex(){return this.get(Dn.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Dn.EXTENT,e)}setMaxResolution(e){this.set(Dn.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Dn.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Dn.MAX_ZOOM,e)}setMinZoom(e){this.set(Dn.MIN_ZOOM,e)}setOpacity(e){Rn(typeof e=="number","Layer opacity must be a number"),this.set(Dn.OPACITY,e)}setVisible(e){this.set(Dn.VISIBLE,e)}setZIndex(e){this.set(Dn.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class P1 extends Bj{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Dn.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Dn.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(or(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=gn(e,Kt.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof Qo?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&r&&(t.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(t.layerStatesArray){if(i=t.layerStatesArray.find(a=>a.layer===this),!i)return!1}else i=this.getLayerState();const s=this.getExtent();return FA(i,t.viewState)&&(!s||Es(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const r=e instanceof Qo?e.getViewStateAndExtent():e;let i=t(r);return Array.isArray(i)||(i=[i]),i}render(e,t){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Dn.MAP,e)}getMapInternal(){return this.get(Dn.MAP)}setMap(e){this.mapPrecomposeKey_&&(or(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(or(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=gn(e,Ti.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=gn(this,Kt.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,r=this.getLayerState(!1);Rn(!t.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(r)}setSource(e){this.set(Dn.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function FA(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const r=e.zoom;return r>n.minZoom&&r<=n.maxZoom}const ZN={RENDER_ORDER:"renderOrder"};class Fw extends P1{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(ZN.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new Aj(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(ZN.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?kj:e;const t=aK(e);this.styleFunction_=e===null?void 0:$W(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function aK(n){if(n===void 0)return kj;if(!n)return null;if(typeof n=="function"||n instanceof pn)return n;if(!Array.isArray(n))return $N([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof pn){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!(a instanceof pn))throw new Error("Expected a list of style instances");i[s]=a}return i}if("style"in t){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!("style"in a))throw new Error("Expected a list of rules with a style property");i[s]=a}return OH(i)}return $N(n)}class Hu extends Fw{constructor(e){super(e)}createRenderer(){return new uH(this)}}const Kc={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class ru extends yl{constructor(e,t){super(e),this.layer=t}}const GS={LAYERS:"layers"};let Vw=class Gj extends Bj{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let r=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(GS.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new La(r.slice(),{unique:!0}):Rn(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new La(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(or),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(gn(e,Ds.ADD,this.handleLayersAdd_,this),gn(e,Ds.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(or);lg(this.listenerKeys_);const t=e.getArray();for(let r=0,i=t.length;r<i;r++){const s=t[r];this.registerLayerListeners_(s),this.dispatchEvent(new ru(Kc.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[gn(e,N0.PROPERTYCHANGE,this.handleLayerChange_,this),gn(e,Kt.CHANGE,this.handleLayerChange_,this)];e instanceof Gj&&t.push(gn(e,Kc.ADDLAYER,this.handleLayerGroupAdd_,this),gn(e,Kc.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[Gt(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new ru(Kc.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new ru(Kc.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new ru(Kc.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,r=Gt(t);this.listenerKeys_[r].forEach(or),delete this.listenerKeys_[r],this.dispatchEvent(new ru(Kc.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(GS.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const r=t.getArray();for(let i=0,s=r.length;i<s;++i)this.dispatchEvent(new ru(Kc.REMOVELAYER,r[i]))}this.set(GS.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],r=t.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(t)});const i=this.getLayerState();let s=i.zIndex;!e&&i.zIndex===void 0&&(s=0);for(let a=r,o=t.length;a<o;a++){const l=t[a];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=Va(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}};const Lt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function VA(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function J_(n,e){return n[0]=e[0],n[1]=e[1],n[4]=e[2],n[5]=e[3],n[12]=e[4],n[13]=e[5],n}const Np=34962,Bw=34963,BA=35044,zS=35048,oK=5121,lK=5123,cK=5125,zj=5126,JN=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function uK(n,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!X$},e);const t=JN.length;for(let r=0;r<t;++r)try{const i=n.getContext(JN[r],e);if(i)return i}catch{}return null}const hK={STATIC_DRAW:BA};class Um{constructor(e,t){this.array_=null,this.type_=e,Rn(e===Np||e===Bw,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=t!==void 0?t:hK.STATIC_DRAW}ofSize(e){return this.array_=new(Iy(this.type_))(e),this}fromArray(e){return this.array_=Iy(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(Iy(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}setArray(e){const t=Iy(this.type_);if(!(e instanceof t))throw new Error(`Expected ${t}`);this.array_=e}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function Iy(n){switch(n){case Np:return Float32Array;case Bw:return Uint32Array;default:return Float32Array}}const Cy={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},dK=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,fK=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class QN{constructor(e){this.gl_=e.webGlContext;const t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer(),this.depthBuffer_=t.createRenderbuffer();const r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e.vertexShader||dK),t.compileShader(r);const i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,e.fragmentShader||fK),t.compileShader(i),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,r),t.attachShader(this.renderTargetProgram_,i),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(a=>{this.uniforms_.push({value:e.uniforms[a],location:t.getUniformLocation(this.renderTargetProgram_,a)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(e){const t=this.getGL(),r=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.getDepthBuffer()),t.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;const i=0,s=t.RGBA,a=0,o=t.RGBA,l=t.UNSIGNED_BYTE,c=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,i,s,r[0],r[1],a,o,l,c),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,r[0],r[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer_)}}apply(e,t,r,i){const s=this.getGL(),a=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,t?t.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!t){const l=Gt(s.canvas);if(!e.renderTargets[l]){const c=s.getContextAttributes();c&&c.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,a[0],a[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const o=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,o),this.applyUniforms(e),r&&r(s,e),s.drawArrays(s.TRIANGLES,0,6),i&&i(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const t=this.getGL();let r,i=1;this.uniforms_.forEach(function(s){if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof ImageData)s.texture||(s.texture=t.createTexture()),t.activeTexture(t[`TEXTURE${i}`]),t.bindTexture(t.TEXTURE_2D,s.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,r.width,r.height,0,t.UNSIGNED_BYTE,new Uint8Array(r.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.uniform1i(s.location,i++);else if(Array.isArray(r))switch(r.length){case 2:t.uniform2f(s.location,r[0],r[1]);return;case 3:t.uniform3f(s.location,r[0],r[1],r[2]);return;case 4:t.uniform4f(s.location,r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&t.uniform1f(s.location,r)})}}const Bl={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},wi={UNSIGNED_BYTE:oK,UNSIGNED_SHORT:lK,UNSIGNED_INT:cK,FLOAT:zj},Q_={};function eM(n){return"shared/"+n}let tM=0;function gK(){const n="unique/"+tM;return tM+=1,n}function mK(n){let e=Q_[n];if(!e){const t=document.createElement("canvas");t.width=1,t.height=1,t.style.position="absolute",t.style.left="0",e={users:0,context:uK(t)},Q_[n]=e}return e.users+=1,e.context}function pK(n){const e=Q_[n];if(!e||(e.users-=1,e.users>0))return;const t=e.context,r=t.getExtension("WEBGL_lose_context");r&&r.loseContext();const i=t.canvas;i.width=1,i.height=1,delete Q_[n]}class xK extends v1{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?eM(e.canvasCacheKey):gK(),this.gl_=mK(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const t=this.gl_.canvas;t.addEventListener(Cy.LOST,this.boundHandleWebGLContextLost_),t.addEventListener(Cy.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=ni(),this.offsetScaleMatrix_=ni(),this.tmpMat4_=VA(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(r=>new QN({webGlContext:this.gl_,scaleRatio:r.scaleRatio,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms})):[new QN({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const t in e)this.uniforms_.push({name:t,value:e[t]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===eM(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t}getInstancedRenderingExtension_(){const e=this.getExtension("ANGLE_instanced_arrays");return Rn(!!e,"WebGL extension 'ANGLE_instanced_arrays' is required for vector rendering"),e}bindBuffer(e){const t=this.gl_,r=Gt(e);let i=this.bufferCache_[r];if(!i){const s=t.createBuffer();i={buffer:e,webGlBuffer:s},this.bufferCache_[r]=i}t.bindBuffer(e.getType(),i.webGlBuffer)}flushBufferData(e){const t=this.gl_;this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const t=Gt(e);delete this.bufferCache_[t]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(Cy.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(Cy.RESTORED,this.boundHandleWebGLContextRestored_),pK(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,t,r){const i=this.gl_,s=this.getCanvas(),a=e.size,o=e.pixelRatio;(s.width!==a[0]*o||s.height!==a[1]*o)&&(s.width=a[0]*o,s.height=a[1]*o,s.style.width=a[0]+"px",s.style.height=a[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.depthRange(0,1),i.clearDepth(1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,t?i.ZERO:i.ONE_MINUS_SRC_ALPHA),r?(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL)):i.disable(i.DEPTH_TEST)}bindFrameBuffer(e,t){const r=this.getGL();r.bindFramebuffer(r.FRAMEBUFFER,e),t&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0)}bindInitialFrameBuffer(){const e=this.getGL(),t=this.postProcessPasses_[0].getFrameBuffer();e.bindFramebuffer(e.FRAMEBUFFER,t);const r=this.postProcessPasses_[0].getRenderTargetTexture();e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0)}bindTexture(e,t,r){const i=this.gl_;i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,e),i.uniform1i(this.getUniformLocation(r),t)}bindAttribute(e,t,r){const i=this.getGL();this.bindBuffer(e);const s=this.getAttributeLocation(t);i.enableVertexAttribArray(s),i.vertexAttribPointer(s,r,i.FLOAT,!1,0,0)}prepareDrawToRenderTarget(e,t,r,i){const s=this.gl_,a=t.getSize();s.bindFramebuffer(s.FRAMEBUFFER,t.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,t.getDepthbuffer()),s.viewport(0,0,a[0],a[1]),s.bindTexture(s.TEXTURE_2D,t.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,r?s.ZERO:s.ONE_MINUS_SRC_ALPHA),i?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(e,t){const r=this.gl_;this.getExtension("OES_element_index_uint");const i=r.UNSIGNED_INT,s=4,a=t-e,o=e*s;r.drawElements(r.TRIANGLES,a,i,o)}drawElementsInstanced(e,t,r){const i=this.gl_;this.getExtension("OES_element_index_uint");const s=this.getInstancedRenderingExtension_(),a=i.UNSIGNED_INT,o=4,l=t-e,c=e*o;s.drawElementsInstancedANGLE(i.TRIANGLES,l,a,c,r);for(let h=0;h<this.maxAttributeCount_;h++)s.vertexAttribDivisorANGLE(h,0)}finalizeDraw(e,t,r){for(let i=0,s=this.postProcessPasses_.length;i<s;i++)i===s-1?this.postProcessPasses_[i].apply(e,null,t,r):this.postProcessPasses_[i].apply(e,this.postProcessPasses_[i+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const t=e.size,r=e.viewState.rotation,i=e.pixelRatio;this.setUniformFloatValue(Bl.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(Bl.ZOOM,e.viewState.zoom),this.setUniformFloatValue(Bl.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(Bl.PIXEL_RATIO,i),this.setUniformFloatVec2(Bl.VIEWPORT_SIZE_PX,[t[0],t[1]]),this.setUniformFloatValue(Bl.ROTATION,r)}applyHitDetectionUniform(e){const t=this.getUniformLocation(Bl.HIT_DETECTION);this.getGL().uniform1i(t,e?1:0),e&&this.setUniformFloatValue(Bl.PIXEL_RATIO,.5)}applyUniforms(e){const t=this.gl_;let r,i=0;this.uniforms_.forEach(s=>{if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData||r instanceof WebGLTexture){r instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=r):s.texture||(s.prevValue=void 0,s.texture=t.createTexture()),this.bindTexture(s.texture,i,s.name),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const a=!(r instanceof HTMLImageElement)||r.complete;!(r instanceof WebGLTexture)&&a&&s.prevValue!==r&&(s.prevValue=r,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)),i++}else if(Array.isArray(r)&&r.length===6)this.setUniformMatrixValue(s.name,J_(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:t.uniform2f(this.getUniformLocation(s.name),r[0],r[1]);return;case 3:t.uniform3f(this.getUniformLocation(s.name),r[0],r[1],r[2]);return;case 4:t.uniform4f(this.getUniformLocation(s.name),r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&t.uniform1f(this.getUniformLocation(s.name),r)})}useProgram(e,t){this.disableAllAttributes_(),this.gl_.useProgram(e),this.currentProgram_=e,t&&(this.applyFrameState(t),this.applyUniforms(t))}compileShader(e,t){const r=this.gl_,i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}getProgram(e,t){const r=this.gl_,i=this.compileShader(e,r.FRAGMENT_SHADER),s=this.compileShader(t,r.VERTEX_SHADER),a=r.createProgram();if(r.attachShader(a,i),r.attachShader(a,s),r.linkProgram(a),!r.getShaderParameter(i,r.COMPILE_STATUS)){const o=`Fragment shader compilation failed: ${r.getShaderInfoLog(i)}`;throw new Error(o)}if(r.deleteShader(i),!r.getShaderParameter(s,r.COMPILE_STATUS)){const o=`Vertex shader compilation failed: ${r.getShaderInfoLog(s)}`;throw new Error(o)}if(r.deleteShader(s),!r.getProgramParameter(a,r.LINK_STATUS)){const o=`GL program linking failed: ${r.getProgramInfoLog(a)}`;throw new Error(o)}return a}getUniformLocation(e){const t=Gt(this.currentProgram_);return this.uniformLocationsByProgram_[t]===void 0&&(this.uniformLocationsByProgram_[t]={}),this.uniformLocationsByProgram_[t][e]===void 0&&(this.uniformLocationsByProgram_[t][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[t][e]}getAttributeLocation(e){const t=Gt(this.currentProgram_);return this.attribLocationsByProgram_[t]===void 0&&(this.attribLocationsByProgram_[t]={}),this.attribLocationsByProgram_[t][e]===void 0&&(this.attribLocationsByProgram_[t][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[t][e]}makeProjectionTransform(e,t){const r=e.size,i=e.viewState.rotation,s=e.viewState.resolution,a=e.viewState.center;return $a(t,0,0,2/(s*r[0]),2/(s*r[1]),-i,-a[0],-a[1]),t}setUniformFloatValue(e,t){this.gl_.uniform1f(this.getUniformLocation(e),t)}setUniformFloatVec2(e,t){this.gl_.uniform2fv(this.getUniformLocation(e),t)}setUniformFloatVec4(e,t){this.gl_.uniform4fv(this.getUniformLocation(e),t)}setUniformMatrixValue(e,t){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,t)}disableAllAttributes_(){for(let e=0;e<this.maxAttributeCount_;e++)this.gl_.disableVertexAttribArray(e)}enableAttributeArray_(e,t,r,i,s,a){const o=this.getAttributeLocation(e);o<0||(this.gl_.enableVertexAttribArray(o),this.gl_.vertexAttribPointer(o,t,r,!1,i,s),a&&this.getInstancedRenderingExtension_().vertexAttribDivisorANGLE(o,1))}enableAttributes_(e,t){const r=yK(e);let i=0;for(let s=0;s<e.length;s++){const a=e[s];a.name&&this.enableAttributeArray_(a.name,a.size,a.type||zj,r,i,t),i+=a.size*Uj(a.type)}}enableAttributes(e){this.enableAttributes_(e,!1)}enableAttributesInstanced(e){this.enableAttributes_(e,!0)}handleWebGLContextLost(e){lg(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,t,r,i){const s=this.gl_;r=r||s.createTexture();const a=i?s.NEAREST:s.LINEAR;s.bindTexture(s.TEXTURE_2D,r),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE);const o=0,l=s.RGBA,c=0,h=s.RGBA,g=s.UNSIGNED_BYTE;return t instanceof Uint8Array?s.texImage2D(s.TEXTURE_2D,o,l,e[0],e[1],c,h,g,t):t?s.texImage2D(s.TEXTURE_2D,o,l,h,g,t):s.texImage2D(s.TEXTURE_2D,o,l,e[0],e[1],c,h,g,null),r}}function yK(n){let e=0;for(let t=0;t<n.length;t++){const r=n[t];e+=r.size*Uj(r.type)}return e}function Uj(n){switch(n){case wi.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case wi.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case wi.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case wi.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class GA extends cg{constructor(e,t,r){super(),r=r||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(Kt.CHANGE)}release(){this.setState(Lt.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Lt.EMPTY){if(this.state!==Lt.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){Wt()}getAlpha(e,t){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=t,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=t-r+1e3/60;return i>=this.transition_?1:Vj(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Mp(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}function nM(n){return n instanceof Uint8Array||n instanceof Uint8ClampedArray||n instanceof Float32Array||n instanceof DataView?n:null}const _K=new Error("disposed"),vK=[256,256];class Tb extends GA{constructor(e){const t=Lt.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Mp(this.data_);return e?[e.width,e.height]:vK}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Lt.IDLE&&this.state!==Lt.ERROR)return;this.state=Lt.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Lt.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Lt.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(_K),this.controller_=null),super.disposeInternal()}}class Gw extends GA{constructor(e,t,r,i,s,a){super(e,t,a),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_,da?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,i!==null&&(this.image_.crossOrigin=i)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Lt.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Lt.ERROR,this.unlistenImage_(),this.image_=wK(),this.changed()}handleImageLoad_(){if(da)this.state=Lt.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Lt.LOADED:this.state=Lt.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Lt.ERROR&&(this.state=Lt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Lt.IDLE&&(this.state=Lt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=lW(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function wK(){const n=Kr(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let US;const x0=[];function rM(n,e,t,r,i){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(r,i),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,r)+1,Math.max(t,i)),n.restore()}function $S(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function EK(){if(US===void 0){const n=Kr(6,6,x0);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",rM(n,4,5,4,0),rM(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;US=$S(e,0)||$S(e,4)||$S(e,8),Mw(n),x0.push(n.canvas)}return US}function ev(n,e,t,r){const i=b1(t,e,n);let s=U_(e,r,t);const a=e.getMetersPerUnit();a!==void 0&&(s*=a);const o=n.getMetersPerUnit();o!==void 0&&(s/=o);const l=n.getExtent();if(!l||rc(l,i)){const c=U_(n,s,i)/s;isFinite(c)&&c>0&&(s/=c)}return s}function SK(n,e,t,r){const i=dl(t);let s=ev(n,e,i,r);return(!isFinite(s)||s<=0)&&LD(t,function(a){return s=ev(n,e,a,r),isFinite(s)&&s>0}),s}function $j(n,e,t,r,i,s,a,o,l,c,h,g,m,x){const y=Kr(Math.round(t*n),Math.round(t*e),x0);if(g||(y.imageSmoothingEnabled=!1),l.length===0)return y.canvas;y.scale(t,t);function _(D){return Math.round(D*t)/t}y.globalCompositeOperation="lighter";const w=$s();l.forEach(function(D,B,k){ND(w,D.extent)});let T;const b=t/r,R=(g?1:1+Math.pow(2,-24))/b;(!m||l.length!==1||c!==0)&&(T=Kr(Math.round(mn(w)*b),Math.round(ti(w)*b),x0),g||(T.imageSmoothingEnabled=!1),l.forEach(function(D,B,k){if(D.image.width>0&&D.image.height>0){if(D.clipExtent){T.save();const z=(D.clipExtent[0]-w[0])*b,F=-(D.clipExtent[3]-w[3])*b,xe=mn(D.clipExtent)*b,Ce=ti(D.clipExtent)*b;T.rect(g?z:Math.round(z),g?F:Math.round(F),g?xe:Math.round(z+xe)-Math.round(z),g?Ce:Math.round(F+Ce)-Math.round(F)),T.clip()}const A=(D.extent[0]-w[0])*b,C=-(D.extent[3]-w[3])*b,O=mn(D.extent)*b,P=ti(D.extent)*b;T.drawImage(D.image,c,c,D.image.width-2*c,D.image.height-2*c,g?A:Math.round(A),g?C:Math.round(C),g?O:Math.round(A+O)-Math.round(A),g?P:Math.round(C+P)-Math.round(C)),D.clipExtent&&T.restore()}}));const M=kd(a);return o.getTriangles().forEach(function(D,B,k){const A=D.source,C=D.target;let O=A[0][0],P=A[0][1],z=A[1][0],F=A[1][1],xe=A[2][0],Ce=A[2][1];const Ge=_((C[0][0]-M[0])/s),Ne=_(-(C[0][1]-M[1])/s),ue=_((C[1][0]-M[0])/s),ke=_(-(C[1][1]-M[1])/s),ae=_((C[2][0]-M[0])/s),Z=_(-(C[2][1]-M[1])/s),V=O,Q=P;O=0,P=0,z-=V,F-=Q,xe-=V,Ce-=Q;const ee=[[z,F,0,0,ue-Ge],[xe,Ce,0,0,ae-Ge],[0,0,z,F,ke-Ne],[0,0,xe,Ce,Z-Ne]],re=YU(ee);if(!re)return;if(y.save(),y.beginPath(),EK()||!g){y.moveTo(ue,ke);const Ve=4,Be=Ge-ue,ye=Ne-ke;for(let pe=0;pe<Ve;pe++)y.lineTo(ue+_((pe+1)*Be/Ve),ke+_(pe*ye/(Ve-1))),pe!=Ve-1&&y.lineTo(ue+_((pe+1)*Be/Ve),ke+_((pe+1)*ye/(Ve-1)));y.lineTo(ae,Z)}else y.moveTo(ue,ke),y.lineTo(Ge,Ne),y.lineTo(ae,Z);y.clip(),y.transform(re[0],re[2],re[1],re[3],Ge,Ne),y.translate(w[0]-V,w[3]-Q);let he;if(T)he=T.canvas,y.scale(R,-R);else{const Ve=l[0],Be=Ve.extent;he=Ve.image,y.scale(mn(Be)/he.width,-ti(Be)/he.height)}y.drawImage(he,0,0),y.restore()}),T&&(Mw(T),x0.push(T.canvas)),h&&(y.save(),y.globalCompositeOperation="source-over",y.strokeStyle="black",y.lineWidth=1,o.getTriangles().forEach(function(D,B,k){const A=D.target,C=(A[0][0]-M[0])/s,O=-(A[0][1]-M[1])/s,P=(A[1][0]-M[0])/s,z=-(A[1][1]-M[1])/s,F=(A[2][0]-M[0])/s,xe=-(A[2][1]-M[1])/s;y.beginPath(),y.moveTo(P,z),y.lineTo(C,O),y.lineTo(F,xe),y.closePath(),y.stroke()}),y.restore()),y.canvas}const TK=10,iM=.25;class Wj{constructor(e,t,r,i,s,a,o){this.sourceProj_=e,this.targetProj_=t;let l={};const c=o?fb(R=>Cr(o,b1(R,this.targetProj_,this.sourceProj_))):Ep(this.targetProj_,this.sourceProj_);this.transformInv_=function(R){const M=R[0]+"/"+R[1];return l[M]||(l[M]=c(R)),l[M]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&mn(i)>=mn(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?mn(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?mn(this.targetProj_.getExtent()):null;const h=kd(r),g=Tw(r),m=Sw(r),x=Ew(r),y=this.transformInv_(h),_=this.transformInv_(g),w=this.transformInv_(m),T=this.transformInv_(x),b=TK+(a?Math.max(0,Math.ceil(Math.log2(lb(r)/(a*a*256*256)))):0);if(this.addQuad_(h,g,m,x,y,_,w,T,b),this.wrapsXInSource_){let R=1/0;this.triangles_.forEach(function(M,D,B){R=Math.min(R,M.source[0][0],M.source[1][0],M.source[2][0])}),this.triangles_.forEach(M=>{if(Math.max(M.source[0][0],M.source[1][0],M.source[2][0])-R>this.sourceWorldWidth_/2){const D=[[M.source[0][0],M.source[0][1]],[M.source[1][0],M.source[1][1]],[M.source[2][0],M.source[2][1]]];D[0][0]-R>this.sourceWorldWidth_/2&&(D[0][0]-=this.sourceWorldWidth_),D[1][0]-R>this.sourceWorldWidth_/2&&(D[1][0]-=this.sourceWorldWidth_),D[2][0]-R>this.sourceWorldWidth_/2&&(D[2][0]-=this.sourceWorldWidth_);const B=Math.min(D[0][0],D[1][0],D[2][0]);Math.max(D[0][0],D[1][0],D[2][0])-B<this.sourceWorldWidth_/2&&(M.source=D)}})}l={}}addTriangle_(e,t,r,i,s,a){this.triangles_.push({source:[i,s,a],target:[e,t,r]})}addQuad_(e,t,r,i,s,a,o,l,c){const h=ab([s,a,o,l]),g=this.sourceWorldWidth_?mn(h)/this.sourceWorldWidth_:null,m=this.sourceWorldWidth_,x=this.sourceProj_.canWrapX()&&g>.5&&g<1;let y=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const w=ab([e,t,r,i]);y=mn(w)/this.targetWorldWidth_>iM||y}!x&&this.sourceProj_.isGlobal()&&g&&(y=g>iM||y)}if(!y&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!Es(h,this.maxSourceExtent_))return;let _=0;if(!y&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)y=!0;else if(_=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(o[0])||!isFinite(o[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),_!=1&&_!=2&&_!=4&&_!=8)return}if(c>0){if(!y){const w=[(e[0]+r[0])/2,(e[1]+r[1])/2],T=this.transformInv_(w);let b;x?b=(wu(s[0],m)+wu(o[0],m))/2-wu(T[0],m):b=(s[0]+o[0])/2-T[0];const R=(s[1]+o[1])/2-T[1];y=b*b+R*R>this.errorThresholdSquared_}if(y){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const w=[(t[0]+r[0])/2,(t[1]+r[1])/2],T=this.transformInv_(w),b=[(i[0]+e[0])/2,(i[1]+e[1])/2],R=this.transformInv_(b);this.addQuad_(e,t,w,b,s,a,T,R,c-1),this.addQuad_(b,w,r,i,R,T,o,l,c-1)}else{const w=[(e[0]+t[0])/2,(e[1]+t[1])/2],T=this.transformInv_(w),b=[(r[0]+i[0])/2,(r[1]+i[1])/2],R=this.transformInv_(b);this.addQuad_(e,w,b,i,s,T,R,l,c-1),this.addQuad_(w,t,r,b,T,a,o,R,c-1)}return}}if(x){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(_&11)==0&&this.addTriangle_(e,r,i,s,o,l),(_&14)==0&&this.addTriangle_(e,r,t,s,o,a),_&&((_&13)==0&&this.addTriangle_(t,i,e,a,l,s),(_&7)==0&&this.addTriangle_(t,i,r,a,l,o))}calculateSourceExtent(){const e=$s();return this.triangles_.forEach(function(t,r,i){const s=t.source;Bm(e,s[0]),Bm(e,s[1]),Bm(e,s[2])}),e}getTriangles(){return this.triangles_}}const Hj=.5;class zA extends GA{constructor(e,t,r,i,s,a,o,l,c,h,g,m){super(s,Lt.IDLE,m),this.renderEdges_=g!==void 0?g:!1,this.pixelRatio_=o,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=i,this.wrappedTileCoord_=a||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const x=i.getTileCoordExtent(this.wrappedTileCoord_),y=this.targetTileGrid_.getExtent();let _=this.sourceTileGrid_.getExtent();const w=y?Va(x,y):x;if(lb(w)===0){this.state=Lt.EMPTY;return}const T=e.getExtent();T&&(_?_=Va(_,T):_=T);const b=i.getResolution(this.wrappedTileCoord_[0]),R=SK(e,r,w,b);if(!isFinite(R)||R<=0){this.state=Lt.EMPTY;return}const M=h!==void 0?h:Hj;if(this.triangulation_=new Wj(e,r,w,_,R*M,b),this.triangulation_.getTriangles().length===0){this.state=Lt.EMPTY;return}this.sourceZ_=t.getZForResolution(R);let D=this.triangulation_.calculateSourceExtent();if(_&&(e.canWrapX()?(D[1]=ur(D[1],_[1],_[3]),D[3]=ur(D[3],_[1],_[3])):D=Va(D,_)),!lb(D))this.state=Lt.EMPTY;else{let B=0,k=0;e.canWrapX()&&(B=mn(T),k=Math.floor((D[0]-T[0])/B)),DD(D.slice(),e,!0).forEach(C=>{const O=t.getTileRangeForExtentAndZ(C,this.sourceZ_);for(let P=O.minX;P<=O.maxX;P++)for(let z=O.minY;z<=O.maxY;z++){const F=c(this.sourceZ_,P,z,o);if(F){const xe=k*B;this.sourceTiles_.push({tile:F,offset:xe})}}++k}),this.sourceTiles_.length===0&&(this.state=Lt.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const r=t.tile;if(r&&r.getState()==Lt.LOADED){const i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=t.offset,i[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:i,clipExtent:s,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Lt.ERROR;else{const t=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(t),i=typeof r=="number"?r:r[0],s=typeof r=="number"?r:r[1],a=this.targetTileGrid_.getResolution(t),o=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=$j(i,s,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),a,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Lt.LOADED}this.changed()}load(){if(this.state==Lt.IDLE){this.state=Lt.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const r=t.getState();if(r==Lt.IDLE||r==Lt.LOADING){e++;const i=gn(t,Kt.CHANGE,s=>{const a=t.getState();(a==Lt.LOADED||a==Lt.ERROR||a==Lt.EMPTY)&&(or(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},r,i){t.getState()==Lt.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(or),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Mw(this.canvas_.getContext("2d")),x0.push(this.canvas_),this.canvas_=null),super.release()}}class bK extends cg{constructor(e){super(),this.tile,this.handleTileChange_=this.handleTileChange_.bind(this),this.gutter=e.gutter||0,this.helper=e.helper,this.loaded=!1,this.ready=!1}setTile(e){if(e!==this.tile)if(this.tile&&this.tile.removeEventListener(Kt.CHANGE,this.handleTileChange_),this.tile=e,this.loaded=e.getState()===Lt.LOADED,this.loaded)this.uploadTile();else{if(e instanceof Gw){const t=e.getImage();t instanceof Image&&!t.crossOrigin&&(t.crossOrigin="anonymous")}e.addEventListener(Kt.CHANGE,this.handleTileChange_)}}uploadTile(){Wt()}setReady(){this.ready=!0,this.dispatchEvent(Kt.CHANGE)}handleTileChange_(){this.tile.getState()===Lt.LOADED&&(this.loaded=!0,this.uploadTile())}setHelper(e){this.helper=e,this.helper&&this.loaded&&this.uploadTile()}disposeInternal(){this.setHelper(null),this.tile.removeEventListener(Kt.CHANGE,this.handleTileChange_)}}function Kj(n,e,t){const r=t?n.LINEAR:n.NEAREST;n.bindTexture(n.TEXTURE_2D,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,r),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,r)}function RK(n,e,t,r){Kj(n,e,r),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)}function sM(n,e,t,r,i,s){const a=n.getGL();let o,l;t instanceof Float32Array?(o=a.FLOAT,n.getExtension("OES_texture_float"),l=n.getExtension("OES_texture_float_linear")!==null):(o=a.UNSIGNED_BYTE,l=!0),Kj(a,e,s&&l);const c=t.byteLength/r[1];let h=1;c%8===0?h=8:c%4===0?h=4:c%2===0&&(h=2);let g;switch(i){case 1:{g=a.LUMINANCE;break}case 2:{g=a.LUMINANCE_ALPHA;break}case 3:{g=a.RGB;break}case 4:{g=a.RGBA;break}default:throw new Error(`Unsupported number of bands: ${i}`)}const m=a.getParameter(a.UNPACK_ALIGNMENT);a.pixelStorei(a.UNPACK_ALIGNMENT,h),a.texImage2D(a.TEXTURE_2D,0,g,r[0],r[1],0,g,o,t),a.pixelStorei(a.UNPACK_ALIGNMENT,m)}let Wf=null;function AK(){Wf=Kr(1,1,void 0,{willReadFrequently:!0})}class kK extends bK{constructor(e){super(e),this.textures=[],this.renderSize_=ki(e.grid.getTileSize(e.tile.tileCoord[0])),this.bandCount=NaN;const t=new Um(Np,BA);t.fromArray([0,1,1,1,1,0,0,0]),this.helper.flushBufferData(t),this.coords=t,this.setTile(e.tile)}setHelper(e){const t=this.helper?.getGL();if(t){this.helper.deleteBuffer(this.coords);for(let r=0;r<this.textures.length;++r)t.deleteTexture(this.textures[r])}super.setHelper(e),e&&e.flushBufferData(this.coords)}uploadTile(){const e=this.helper,t=e.getGL(),r=this.tile;this.textures.length=0;let i;r instanceof Gw||r instanceof zA?i=r.getImage():i=r.getData();const s=Mp(i);if(s){const b=t.createTexture();this.textures.push(b),this.bandCount=4,RK(t,b,s,r.interpolate),this.setReady();return}i=nM(i);const a=r.getSize(),o=[a[0]+2*this.gutter,a[1]+2*this.gutter],l=i instanceof Float32Array,c=o[0]*o[1],h=l?Float32Array:Uint8Array,g=h.BYTES_PER_ELEMENT,m=i.byteLength/o[1];this.bandCount=Math.floor(m/g/o[0]);const x=Math.ceil(this.bandCount/4);if(x===1){const b=t.createTexture();this.textures.push(b),sM(e,b,i,o,this.bandCount,r.interpolate),this.setReady();return}const y=new Array(x);for(let b=0;b<x;++b){const R=t.createTexture();this.textures.push(R);const M=b<x-1?4:(this.bandCount-1)%4+1;y[b]=new h(c*M)}let _=0,w=0;const T=o[0]*this.bandCount;for(let b=0;b<o[1];++b){for(let R=0;R<T;++R){const M=i[w+R],D=Math.floor(_/this.bandCount),B=R%this.bandCount,k=Math.floor(B/4),A=y[k],C=A.length/c,O=B%4;A[D*C+O]=M,++_}w+=m/g}for(let b=0;b<x;++b){const R=this.textures[b],M=y[b],D=M.length/c;sM(e,R,M,o,D,r.interpolate)}this.setReady()}getImagePixelData_(e,t,r){const i=this.gutter,s=this.renderSize_[0],a=this.renderSize_[1];Wf||AK(),Wf.clearRect(0,0,1,1);const o=e.width,l=e.height,c=o-2*i,h=l-2*i,g=i+Math.floor(c*(t/s)),m=i+Math.floor(h*(r/a));let x;try{Wf.drawImage(e,g,m,1,1,0,0,1,1),x=Wf.getImageData(0,0,1,1).data}catch{return Wf=null,null}return x}getArrayPixelData_(e,t,r,i){const s=this.gutter,a=this.renderSize_[0],o=this.renderSize_[1],l=t[0],c=t[1],h=l+2*s,g=c+2*s,m=s+Math.floor(l*(r/a)),x=s+Math.floor(c*(i/o));if(e instanceof DataView){const _=e.byteLength/(h*g),w=_*(x*h+m),T=e.buffer.slice(w,w+_);return new DataView(T)}const y=this.bandCount*(x*h+m);return e.slice(y,y+this.bandCount)}getPixelData(e,t){if(!this.loaded)return null;if(this.tile instanceof Tb){const r=this.tile.getData(),i=nM(r);if(i){const s=this.tile.getSize();return this.getArrayPixelData_(i,s,e,t)}return this.getImagePixelData_(Mp(r),e,t)}return this.getImagePixelData_(this.tile.getImage(),e,t)}}class zw{constructor(e,t,r,i){this.minX=e,this.maxX=t,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Af(n,e,t,r,i){return i!==void 0?(i.minX=n,i.maxX=e,i.minY=t,i.maxY=r,i):new zw(n,e,t,r)}class bb{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof v1&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const r=this.entries_[e];return Rn(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const t=this.entries_[e];return Rn(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.key_;return e}getValues(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){Rn(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function F0(n,e,t,r){return r!==void 0?(r[0]=n,r[1]=e,r[2]=t,r):[n,e,t]}function Xj(n,e,t){return n+"/"+e+"/"+t}function Hf(n){return Xj(n[0],n[1],n[2])}function c_(n,e,t,r,i){return`${Gt(n)},${e},${Xj(t,r,i)}`}function qj(n){return IK(n[0],n[1],n[2])}function IK(n,e,t){return(e<<n)+t}function CK(n,e){const t=n[0],r=n[1],i=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(r,i):!0}class Uw extends Nj{constructor(e,t){super(e),t=t||{},this.inversePixelTransform_=ni(),this.postProcesses_=t.postProcesses,this.uniforms_=t.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},e.addChangeListener(Dn.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(Ti.PRECOMPOSE)){const i=new zm(Ti.PRECOMPOSE,void 0,t,e);r.dispatchEvent(i)}}dispatchPostComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(Ti.POSTCOMPOSE)){const i=new zm(Ti.POSTCOMPOSE,void 0,t,e);r.dispatchEvent(i)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let t=!0,r=-1,i;for(let a=0,o=e.layerStatesArray.length;a<o;a++){const l=e.layerStatesArray[a].layer,c=l.getRenderer();if(!(c instanceof Uw)){t=!0;continue}const h=l.getClassName();if((t||h!==i)&&(r+=1,t=!1),i=h,c===this)break}const s="map/"+e.mapId+"/group/"+r;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new xK({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),i&&(this.helper.getCanvas().className=i),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}clearCache(){}disposeInternal(){this.clearCache(),this.removeHelper(),this.getLayer()?.removeChangeListener(Dn.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){$a(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);const s=new zm(e,this.inversePixelTransform_,r,t);i.dispatchEvent(s)}}preRender(e,t){this.dispatchRenderEvent_(Ti.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(Ti.POSTRENDER,e,t)}}const PK={TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",RESOLUTION:"u_resolution",ZOOM:"u_zoom",GLOBAL_ALPHA:"u_globalAlpha",PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix"};function aM(n){return 1/(n+2)}function NK(){return{tileIds:new Set,representationsByZ:{}}}function oM(n,e){return n.tileIds.has(Gt(e))}function lM(n,e,t){const r=n.representationsByZ;t in r||(r[t]=new Set),r[t].add(e),n.tileIds.add(Gt(e.tile))}function WS(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Va(e,Oa(t.extent,n.viewState.projection)));const r=t.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(n.viewState.projection).getExtent();i&&(e=Va(e,i))}return e}function Rb(n,e){return`${Gt(n)},${n.getKey()},${n.getRevision()},${Hf(e)}`}class MK extends Uw{constructor(e,t){super(e,{uniforms:t.uniforms,postProcesses:t.postProcesses}),this.renderComplete=!1,this.tileTransform_=ni(),this.tempMat4=VA(),this.tempTileRange_=new zw(0,0,0,0),this.tempTileCoord_=F0(0,0,0),this.tempSize_=[0,0];const r=t.cacheSize!==void 0?t.cacheSize:512;this.tileRepresentationCache=new bb(r),this.frameState=null,this.renderedProjection_=void 0}reset(e){super.reset({uniforms:e.uniforms})}prepareFrameInternal(e){this.renderedProjection_?e.viewState.projection!==this.renderedProjection_&&(this.clearCache(),this.renderedProjection_=e.viewState.projection):this.renderedProjection_=e.viewState.projection;const r=this.getLayer().getRenderSource();return!r||Id(WS(e,e.extent))?!1:r.getState()==="ready"}createTileRepresentation(e){return Wt()}enqueueTiles(e,t,r,i,s){const a=e.viewState,o=this.getLayer(),l=o.getRenderSource(),c=l.getTileGridForProjection(a.projection),h=l.getGutterForProjection(a.projection),g=Gt(l);g in e.wantedTiles||(e.wantedTiles[g]={});const m=e.wantedTiles[g],x=this.tileRepresentationCache,y=o.getMapInternal(),_=Math.max(r-s,c.getMinZoom(),c.getZForResolution(Math.min(o.getMaxResolution(),y?y.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),w=a.rotation,T=w?sA(a.center,a.resolution,w,e.size):void 0;for(let b=r;b>=_;--b){const R=c.getTileRangeForExtentAndZ(t,b,this.tempTileRange_),M=c.getResolution(b);for(let D=R.minX;D<=R.maxX;++D)for(let B=R.minY;B<=R.maxY;++B){if(w&&!c.tileCoordIntersectsViewport([b,D,B],T))continue;const k=F0(b,D,B,this.tempTileCoord_),A=Rb(l,k);let C,O;if(x.containsKey(A)&&(C=x.get(A),O=C.tile),(!C||C.tile.key!==l.getKey())&&(O=l.getTile(b,D,B,e.pixelRatio,a.projection),!O)||oM(i,O))continue;C?C.setTile(O):(C=this.createTileRepresentation({tile:O,grid:c,helper:this.helper,gutter:h}),x.set(A,C)),lM(i,C,b);const P=O.getKey();m[P]=!0,O.getState()===Lt.IDLE&&(e.tileQueue.isKeyQueued(P)||e.tileQueue.enqueue([O,g,c.getTileCoordCenter(k),M]))}}}beforeTilesRender(e,t){this.helper.prepareDraw(this.frameState,!t,!0)}beforeTilesMaskRender(e){return!1}renderTile(e,t,r,i,s,a,o,l,c,h,g){}renderTileMask(e,t,r,i){}drawTile_(e,t,r,i,s,a,o){if(!t.ready)return;const c=t.tile.tileCoord,h=Hf(c),g=h in a?a[h]:1,m=o.getResolution(r),x=ki(o.getTileSize(r),this.tempSize_),y=o.getOrigin(r),_=o.getTileCoordExtent(c),w=g<1?-1:aM(r);g<1&&(e.animate=!0);const T=e.viewState,b=T.center[0],R=T.center[1],M=x[0]+2*i,D=x[1]+2*i,B=M/D,k=(b-y[0])/(x[0]*m),A=(y[1]-R)/(x[1]*m),C=T.resolution/m,O=c[1],P=c[2];A$(this.tileTransform_),mN(this.tileTransform_,2/(e.size[0]*C/M),-2/(e.size[1]*C/M)),k$(this.tileTransform_,T.rotation),mN(this.tileTransform_,1,1/B),qD(this.tileTransform_,(x[0]*(O-k)-i)/M,(x[1]*(P-A)-i)/D),this.renderTile(t,this.tileTransform_,e,s,m,x,y,_,w,i,g)}renderFrame(e){this.frameState=e,this.renderComplete=!0;const t=this.helper.getGL();this.preRender(t,e);const r=e.viewState,i=this.getLayer(),s=i.getRenderSource(),a=s.getTileGridForProjection(r.projection),o=s.getGutterForProjection(r.projection),l=WS(e,e.extent),c=a.getZForResolution(r.resolution,s.zDirection),h=NK(),g=i.getPreload();if(e.nextExtent){const R=a.getZForResolution(r.nextResolution,s.zDirection),M=WS(e,e.nextExtent);this.enqueueTiles(e,M,R,h,g)}this.enqueueTiles(e,l,c,h,0),g>0&&setTimeout(()=>{this.enqueueTiles(e,l,c-1,h,g-1)},0);const m={};let x=!1;const y=h.representationsByZ;if(c in y){const R=Gt(this),M=e.time;for(const D of y[c]){const B=D.tile;if(B.getState()===Lt.EMPTY)continue;const k=B.tileCoord;if(D.ready){const O=B.getAlpha(R,M);if(O===1){B.endTransition(R);continue}x=!0;const P=Hf(k);m[P]=O}if(this.renderComplete=!1,this.findAltTiles_(a,k,c+1,h))continue;const C=a.getMinZoom();for(let O=c-1;O>=C&&!this.findAltTiles_(a,k,O,h);--O);}}const _=Object.keys(y).map(Number).sort(RD);if(this.beforeTilesMaskRender(e))for(let R=0,M=_.length;R<M;++R){const D=_[R];for(const B of y[D]){const k=B.tile.tileCoord;if(Hf(k)in m)continue;const C=a.getTileCoordExtent(k);this.renderTileMask(B,D,C,aM(D))}}this.beforeTilesRender(e,x);for(let R=0,M=_.length;R<M;++R){const D=_[R];for(const B of y[D]){const k=B.tile.tileCoord;Hf(k)in m||this.drawTile_(e,B,D,o,l,m,a)}}if(c in y)for(const R of y[c]){const M=R.tile.tileCoord;Hf(M)in m&&this.drawTile_(e,R,c,o,l,m,a)}this.beforeFinalize(e),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const T=this.helper.getCanvas();return this.tileRepresentationCache.expireCache(),this.postRender(t,e),T}beforeFinalize(e){}findAltTiles_(e,t,r,i){const s=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!s)return!1;let a=!0;const o=this.tileRepresentationCache,l=this.getLayer().getRenderSource();for(let c=s.minX;c<=s.maxX;++c)for(let h=s.minY;h<=s.maxY;++h){const g=Rb(l,[r,c,h]);let m=!1;if(o.containsKey(g)){const x=o.get(g);x.ready&&!oM(i,x.tile)&&(lM(i,x,r),m=!0)}m||(a=!1)}return a}clearCache(){super.clearCache();const e=this.tileRepresentationCache;e.forEach(t=>t.dispose()),e.clear()}afterHelperCreated(){super.afterHelperCreated(),this.tileRepresentationCache.forEach(e=>e.setHelper(this.helper))}disposeInternal(){super.disposeInternal(),delete this.frameState}}const _s={...PK,TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY"},LK={TEXTURE_COORD:"a_textureCoord"},OK=[{name:LK.TEXTURE_COORD,size:2,type:wi.FLOAT}];class pRe extends MK{constructor(e,t){super(e,t),this.program_,this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.indices_=new Um(Bw,BA),this.indices_.fromArray([0,1,3,1,2,3]),this.paletteTextures_=t.paletteTextures||[]}reset(e){if(super.reset(e),this.helper){const t=this.helper.getGL();for(const r of this.paletteTextures_)r.delete(t)}if(this.vertexShader_=e.vertexShader,this.fragmentShader_=e.fragmentShader,this.paletteTextures_=e.paletteTextures||[],this.helper){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_);const t=this.helper.getGL();for(const r of this.paletteTextures_)r.getTexture(t)}}afterHelperCreated(){super.afterHelperCreated();const e=this.helper.getGL();for(const t of this.paletteTextures_)t.getTexture(e);this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)}removeHelper(){if(this.helper){const e=this.helper.getGL();for(const t of this.paletteTextures_)t.delete(e)}super.removeHelper()}createTileRepresentation(e){return new kK(e)}beforeTilesRender(e,t){super.beforeTilesRender(e,t),this.helper.useProgram(this.program_,e)}renderTile(e,t,r,i,s,a,o,l,c,h,g){const m=this.helper.getGL();this.helper.bindBuffer(e.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(OK);let x=0;for(;x<e.textures.length;){const B=`${_s.TILE_TEXTURE_ARRAY}[${x}]`;this.helper.bindTexture(e.textures[x],x,B),++x}for(let B=0;B<this.paletteTextures_.length;++B){const k=this.paletteTextures_[B],A=k.getTexture(m);this.helper.bindTexture(A,x,k.name),++x}const y=r.viewState,_=a[0]+2*h,w=a[1]+2*h,b=e.tile.tileCoord,R=b[1],M=b[2];this.helper.setUniformMatrixValue(_s.TILE_TRANSFORM,J_(this.tempMat4,t)),this.helper.setUniformFloatValue(_s.TRANSITION_ALPHA,g),this.helper.setUniformFloatValue(_s.DEPTH,c);let D=i;h>0&&(D=l,Va(D,i,D)),this.helper.setUniformFloatVec4(_s.RENDER_EXTENT,D),this.helper.setUniformFloatValue(_s.RESOLUTION,y.resolution),this.helper.setUniformFloatValue(_s.ZOOM,y.zoom),this.helper.setUniformFloatValue(_s.TEXTURE_PIXEL_WIDTH,_),this.helper.setUniformFloatValue(_s.TEXTURE_PIXEL_HEIGHT,w),this.helper.setUniformFloatValue(_s.TEXTURE_RESOLUTION,s),this.helper.setUniformFloatValue(_s.TEXTURE_ORIGIN_X,o[0]+R*a[0]*s-h*s),this.helper.setUniformFloatValue(_s.TEXTURE_ORIGIN_Y,o[1]-M*a[1]*s+h*s),this.helper.drawElements(0,this.indices_.getSize())}getData(e){if(!this.helper.getGL())return null;const r=this.frameState;if(!r)return null;const i=this.getLayer(),s=Cr(r.pixelToCoordinateTransform,e.slice()),a=r.viewState,o=i.getExtent();if(o&&!rc(Oa(o,a.projection),s))return null;const l=i.getSources(ab([s]),a.resolution);let c,h,g;for(c=l.length-1;c>=0;--c)if(h=l[c],h.getState()==="ready"){if(g=h.getTileGridForProjection(a.projection),h.getWrapX())break;const x=g.getExtent();if(!x||rc(x,s))break}if(c<0)return null;const m=this.tileRepresentationCache;for(let x=g.getZForResolution(a.resolution);x>=g.getMinZoom();--x){const y=g.getTileCoordForCoordAndZ(s,x),_=Rb(h,y);if(!m.containsKey(_))continue;const w=m.get(_);if(w.tile.getState()===Lt.EMPTY)return null;if(!w.loaded)continue;const b=g.getOrigin(x),R=ki(g.getTileSize(x)),M=g.getResolution(x),D=(s[0]-b[0])/M-y[1]*R[0],B=(b[1]-s[1])/M-y[2]*R[1];return w.getPixelData(D,B)}return null}disposeInternal(){const e=this.helper;if(e){const t=e.getGL();for(const r of this.paletteTextures_)r.delete(t);this.paletteTextures_.length=0,t.deleteProgram(this.program_),delete this.program_,e.deleteBuffer(this.indices_)}super.disposeInternal(),delete this.indices_}}class DK{constructor(e,t){this.name=e,this.data=t,this.texture_=null}getTexture(e){if(!this.texture_){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}function jK(n,e){return`operator_${n}_${Object.keys(e.functions).length}`}function Eu(n){const e=n.toString();return e.includes(".")?e:e+".0"}function UA(n){if(n.length<2||n.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${n.length}(${n.map(Eu).join(", ")})`}function u_(n){const e=Wa(n),t=e.length>3?e[3]:1;return UA([e[0]/255,e[1]/255,e[2]/255,t])}function FK(n){const e=ki(n);return UA(e)}const HS={};let VK=0;function Lp(n){return n in HS||(HS[n]=VK++),HS[n]}function zl(n){return Eu(Lp(n))}function $A(n){return"u_var_"+n}function Yj(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const KS="getBandValue",BK="u_paletteTextures",Zj="featureId",Jj="geometryType",Ab=-9999999;function GK(n,e,t,r){const i=Ii(n,e,t);return WA(i,e,r)}function Pn(n){return(e,t,r)=>{const i=t.args.length,s=new Array(i);for(let a=0;a<i;++a)s[a]=WA(t.args[a],r,e);return n(s,e)}}const zK={[me.Get]:(n,e)=>{const r=e.args[0].value;r in n.properties||(n.properties[r]={name:r,type:e.type});let s="a_prop_"+r;return Yo(e.type,ei)&&(s=`(${s} > 0.0)`),s},[me.Id]:n=>(n.featureId=!0,"a_"+Zj),[me.GeometryType]:n=>(n.geometryType=!0,"a_"+Jj),[me.LineMetric]:()=>"currentLineMetric",[me.Var]:(n,e)=>{const r=e.args[0].value;r in n.variables||(n.variables[r]={name:r,type:e.type});let s=$A(r);return Yo(e.type,ei)&&(s=`(${s} > 0.0)`),s},[me.Has]:(n,e)=>{const r=e.args[0].value;return r in n.properties||(n.properties[r]={name:r,type:e.type}),`(a_prop_${r} != ${Eu(Ab)})`},[me.Resolution]:()=>"u_resolution",[me.Zoom]:()=>"u_zoom",[me.Time]:()=>"u_time",[me.Any]:Pn(n=>`(${n.join(" || ")})`),[me.All]:Pn(n=>`(${n.join(" && ")})`),[me.Not]:Pn(([n])=>`(!${n})`),[me.Equal]:Pn(([n,e])=>`(${n} == ${e})`),[me.NotEqual]:Pn(([n,e])=>`(${n} != ${e})`),[me.GreaterThan]:Pn(([n,e])=>`(${n} > ${e})`),[me.GreaterThanOrEqualTo]:Pn(([n,e])=>`(${n} >= ${e})`),[me.LessThan]:Pn(([n,e])=>`(${n} < ${e})`),[me.LessThanOrEqualTo]:Pn(([n,e])=>`(${n} <= ${e})`),[me.Multiply]:Pn(n=>`(${n.join(" * ")})`),[me.Divide]:Pn(([n,e])=>`(${n} / ${e})`),[me.Add]:Pn(n=>`(${n.join(" + ")})`),[me.Subtract]:Pn(([n,e])=>`(${n} - ${e})`),[me.Clamp]:Pn(([n,e,t])=>`clamp(${n}, ${e}, ${t})`),[me.Mod]:Pn(([n,e])=>`mod(${n}, ${e})`),[me.Pow]:Pn(([n,e])=>`pow(${n}, ${e})`),[me.Abs]:Pn(([n])=>`abs(${n})`),[me.Floor]:Pn(([n])=>`floor(${n})`),[me.Ceil]:Pn(([n])=>`ceil(${n})`),[me.Round]:Pn(([n])=>`floor(${n} + 0.5)`),[me.Sin]:Pn(([n])=>`sin(${n})`),[me.Cos]:Pn(([n])=>`cos(${n})`),[me.Atan]:Pn(([n,e])=>e!==void 0?`atan(${n}, ${e})`:`atan(${n})`),[me.Sqrt]:Pn(([n])=>`sqrt(${n})`),[me.Match]:Pn(n=>{const e=n[0],t=n[n.length-1];let r=null;for(let i=n.length-3;i>=1;i-=2){const s=n[i],a=n[i+1];r=`(${e} == ${s} ? ${a} : ${r||t})`}return r}),[me.Between]:Pn(([n,e,t])=>`(${n} >= ${e} && ${n} <= ${t})`),[me.Interpolate]:Pn(([n,e,...t])=>{let r="";for(let i=0;i<t.length-2;i+=2){const s=t[i],a=r||t[i+1],o=t[i+2],l=t[i+3];let c;n===Eu(1)?c=`(${e} - ${s}) / (${o} - ${s})`:c=`(pow(${n}, (${e} - ${s})) - 1.0) / (pow(${n}, (${o} - ${s})) - 1.0)`,r=`mix(${a}, ${l}, clamp(${c}, 0.0, 1.0))`}return r}),[me.Case]:Pn(n=>{const e=n[n.length-1];let t=null;for(let r=n.length-3;r>=0;r-=2){const i=n[r],s=n[r+1];t=`(${i} ? ${s} : ${t||e})`}return t}),[me.In]:Pn(([n,...e],t)=>{const r=jK("in",t),i=[];for(let s=0;s<e.length;s+=1)i.push(`  if (inputValue == ${e[s]}) { return true; }`);return t.functions[r]=`bool ${r}(float inputValue) {
${i.join(`
`)}
  return false;
}`,`${r}(${n})`}),[me.Array]:Pn(n=>`vec${n.length}(${n.join(", ")})`),[me.Color]:Pn(n=>{if(n.length===1)return`vec4(vec3(${n[0]} / 255.0), 1.0)`;if(n.length===2)return`vec4(vec3(${n[0]} / 255.0), ${n[1]})`;const e=n.slice(0,3).map(r=>`${r} / 255.0`);if(n.length===3)return`vec4(${e.join(", ")}, 1.0)`;const t=n[3];return`vec4(${e.join(", ")}, ${t})`}),[me.Band]:Pn(([n,e,t],r)=>{if(!(KS in r.functions)){let i="";const s=r.bandCount||1;for(let a=0;a<s;a++){const o=Math.floor(a/4);let l=a%4;a===s-1&&l===1&&(l=3);const c=`${_s.TILE_TEXTURE_ARRAY}[${o}]`;i+=`  if (band == ${a+1}.0) {
    return texture2D(${c}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}r.functions[KS]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${_s.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${_s.TEXTURE_PIXEL_HEIGHT};
${i}
}`}return`${KS}(${n}, ${e??"0.0"}, ${t??"0.0"})`}),[me.Palette]:(n,e)=>{const[t,...r]=e.args,i=r.length,s=new Uint8Array(i*4);for(let c=0;c<r.length;c++){const h=r[c].value,g=Wa(h),m=c*4;s[m]=g[0],s[m+1]=g[1],s[m+2]=g[2],s[m+3]=g[3]*255}n.paletteTextures||(n.paletteTextures=[]);const a=`${BK}[${n.paletteTextures.length}]`,o=new DK(a,s);n.paletteTextures.push(o);const l=WA(t,kt,n);return`texture2D(${a}, vec2((${l} + 0.5) / ${i}.0, 0.5))`}};function WA(n,e,t){if(n instanceof Mj){const r=zK[n.operator];if(r===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(n.operator)}`);return r(t,n,e)}if((n.type&kt)>0)return Eu(n.value);if((n.type&ei)>0)return n.value.toString();if((n.type&fi)>0)return zl(n.value.toString());if((n.type&vr)>0)return u_(n.value);if((n.type&Hs)>0)return UA(n.value);if((n.type&ja)>0)return FK(n.value);throw new Error(`Unexpected expression ${n.value} (expected type ${i0(e)})`)}function UK(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const cM=.985;function Jt(n,e,t){const r=PA();return GK(e,t,r,n)}function $K(n){const e=Wa(n),t=e[0]*256,r=e[1],i=e[2]*256,s=Math.round(e[3]*255);return[t+r,i+s]}const WK=`vec4 unpackColor(vec2 packedColor) {
  return vec4(
    min(floor(packedColor[0] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[0], 256.0) / 255.0, 1.0),
    min(floor(packedColor[1] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[1], 256.0) / 255.0, 1.0)
  );
}`;function HA(n){return n===vr||n===ja?2:n===Hs?4:1}function kb(n){const e=HA(n);return e>1?`vec${e}`:"float"}function Qj(n,e){for(const t in e.variables){const r=e.variables[t],i=$A(r.name);let s=kb(r.type);r.type===vr&&(s="vec4"),n.addUniform(i,s)}for(const t in e.properties){const r=e.properties[t],i=kb(r.type),s=`a_prop_${r.name}`;r.type===vr?n.addAttribute(s,i,`unpackColor(${s})`,"vec4"):n.addAttribute(s,i)}for(const t in e.functions)n.addVertexShaderFunction(e.functions[t]),n.addFragmentShaderFunction(e.functions[t])}function eF(n,e){const t={};for(const r in n.variables){const i=n.variables[r],s=$A(i.name);t[s]=()=>{const a=e[i.name];if(typeof a=="number")return a;if(typeof a=="boolean")return a?1:0;if(i.type===vr){const o=[...Wa(a||"#eee")];return o[0]/=255,o[1]/=255,o[2]/=255,o[3]??=1,o}return typeof a=="string"?Lp(a):a}}return t}function tF(n){const e={};for(const t in n.properties){const r=n.properties[t],i=s=>{const a=s.get(r.name);return r.type===vr?$K([...Wa(a||"#eee")]):typeof a=="string"?Lp(a):typeof a=="boolean"?a?1:0:a};e[`prop_${r.name}`]={size:HA(r.type),callback:i}}return e}const kf=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders

${WK}
`,If=UK();class nF{constructor(){this.uniforms_=[],this.attributes_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${Eu(If["circle-radius"])} + ${Eu(If["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=u_(If["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=Eu(If["stroke-width"]),this.strokeColorExpression_=u_(If["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=zl("round"),this.strokeJoinExpression_=zl("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.strokePatternLengthExpression_=null,this.hasFill_=!1,this.fillColorExpression_=u_(If["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e,t){return this.uniforms_.push({name:e,type:t}),this}addAttribute(e,t,r,i){return this.attributes_.push({name:e,type:t,varyingName:e.replace(/^a_/,"v_"),varyingType:i??t,varyingExpression:r??e}),this}setSymbolSizeExpression(e){return this.hasSymbol_=!0,this.symbolSizeExpression_=e,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(e){return this.hasSymbol_=!0,this.symbolColorExpression_=e,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.hasStroke_=!0,this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.hasStroke_=!0,this.strokeColorExpression_=e,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(e){return this.strokeOffsetExpression_=e,this}setStrokeCapExpression(e){return this.strokeCapExpression_=e,this}setStrokeJoinExpression(e){return this.strokeJoinExpression_=e,this}setStrokeMiterLimitExpression(e){return this.strokeMiterLimitExpression_=e,this}setStrokeDistanceFieldExpression(e){return this.strokeDistanceFieldExpression_=e,this}setStrokePatternLengthExpression(e){return this.strokePatternLengthExpression_=e,this}getStrokePatternLengthExpression(){return this.strokePatternLengthExpression_}setFillColorExpression(e){return this.hasFill_=!0,this.fillColorExpression_=e,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(e){return this.vertexShaderFunctions_.includes(e)?this:(this.vertexShaderFunctions_.push(e),this)}addFragmentShaderFunction(e){return this.fragmentShaderFunctions_.includes(e)?this:(this.fragmentShaderFunctions_.push(e),this)}getSymbolVertexShader(){return this.hasSymbol_?`${kf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_localPosition;
attribute vec2 a_hitColor;

varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx + a_localPosition * halfSizePx * vec2(1., -1.);
  float angle = ${this.symbolRotationExpression_}${this.symbolRotateWithView_?" + u_rotation":""};
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = mix(texCoord.s, texCoord.p, a_localPosition.x * 0.5 + 0.5);
  float v = mix(texCoord.t, texCoord.q, a_localPosition.y * 0.5 + 0.5);
  v_texCoord = vec2(u, v);
  v_hitColor = unpackColor(a_hitColor);
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y);
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${kf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${kf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute vec2 a_localPosition;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_angleTangentSum;
attribute float a_distanceLow;
attribute float a_distanceHigh;
attribute vec2 a_joinAngles;
attribute vec2 a_hitColor;

varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float startEndRatio = a_localPosition.x * 0.5 + 0.5;
  currentLineMetric = mix(a_measureStart, a_measureEnd, startEndRatio);
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);

  // compute current vertex position
  float normalDir = -1. * a_localPosition.y;
  float tangentDir = -1. * a_localPosition.x;
  float angle = mix(v_angleStart, v_angleEnd, startEndRatio);
  vec2 joinDirection;
  vec2 positionPx = mix(segmentStartPx, segmentEndPx, startEndRatio);
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${cM} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStartPx = segmentStartPx;
  v_segmentEndPx = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = unpackColor(a_hitColor);

  v_distancePx = a_distanceLow / u_resolution - (lineOffsetPx * a_angleTangentSum);
  float distanceHighPx = a_distanceHigh / u_resolution;
  ${this.strokePatternLengthExpression_!==null?`v_distancePx = mod(v_distancePx, ${this.strokePatternLengthExpression_});
  distanceHighPx = mod(distanceHighPx, ${this.strokePatternLengthExpression_});
  `:""}v_distancePx += distanceHighPx;

  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${kf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${cM}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${zl("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${zl("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${zl("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${zl("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

float distanceFromSegment(vec2 point, vec2 start, vec2 end) {
  vec2 tangent = end - start;
  vec2 startToPoint = point - start;
  // inspire by capsule fn in https://iquilezles.org/articles/distfunctions/
  float h = clamp(dot(startToPoint, tangent) / dot(tangent, tangent), 0.0, 1.0);
  return length(startToPoint - tangent * h);
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}

  vec2 currentPointPx = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPointPx);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLengthPx = length(v_segmentEndPx - v_segmentStartPx);
  segmentLengthPx = max(segmentLengthPx, 1.17549429e-38); // avoid divide by zero
  vec2 segmentTangent = (v_segmentEndPx - v_segmentStartPx) / segmentLengthPx;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPointPx = currentPointPx - v_segmentStartPx;
  float lengthToPointPx = max(0., min(dot(segmentTangent, startToPointPx), segmentLengthPx));
  float currentLengthPx = lengthToPointPx + v_distancePx;
  float currentRadiusPx = distanceFromSegment(currentPointPx, v_segmentStartPx, v_segmentEndPx);
  float currentRadiusRatio = dot(segmentNormal, startToPointPx) * 2. / v_width;
  currentLineMetric = mix(v_measureStart, v_measureEnd, lengthToPointPx / segmentLengthPx);

  if (${this.discardExpression_}) { discard; }

  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPointPx, v_segmentEndPx, v_segmentStartPx, v_width, v_angleEnd, capType, joinType);
  float distanceField = max(
    segmentDistanceField(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distanceField = max(distanceField, ${this.strokeDistanceFieldExpression_});

  vec4 color = ${this.strokeColorExpression_};
  color.a *= smoothstep(0.5, -0.5, distanceField);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${kf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_hitColor;

varying vec4 v_hitColor;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = unpackColor(a_hitColor);
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${kf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec4 v_hitColor;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}}class tv{constructor(){this.globalCounter_=0,this.refToFeature_=new Map,this.uidToRef_=new Map,this.freeGlobalRef_=[],this.polygonBatch={entries:{},geometriesCount:0,verticesCount:0,ringsCount:0},this.pointBatch={entries:{},geometriesCount:0},this.lineStringBatch={entries:{},geometriesCount:0,verticesCount:0}}addFeatures(e,t){for(let r=0;r<e.length;r++)this.addFeature(e[r],t)}addFeature(e,t){let r=e.getGeometry();r&&(t&&(r=r.clone(),r.applyTransform(t)),this.addGeometry_(r,e))}clearFeatureEntryInPointBatch_(e){const t=Gt(e),r=this.pointBatch.entries[t];if(r)return this.pointBatch.geometriesCount-=r.flatCoordss.length,delete this.pointBatch.entries[t],r}clearFeatureEntryInLineStringBatch_(e){const t=Gt(e),r=this.lineStringBatch.entries[t];if(r)return this.lineStringBatch.verticesCount-=r.verticesCount,this.lineStringBatch.geometriesCount-=r.flatCoordss.length,delete this.lineStringBatch.entries[t],r}clearFeatureEntryInPolygonBatch_(e){const t=Gt(e),r=this.polygonBatch.entries[t];if(r)return this.polygonBatch.verticesCount-=r.verticesCount,this.polygonBatch.ringsCount-=r.ringsCount,this.polygonBatch.geometriesCount-=r.flatCoordss.length,delete this.polygonBatch.entries[t],r}addGeometry_(e,t){const r=e.getType();switch(r){case"GeometryCollection":{const i=e.getGeometriesArray();for(const s of i)this.addGeometry_(s,t);break}case"MultiPolygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEndss(),t,Gt(t),i.getStride());break}case"MultiLineString":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),t,Gt(t),i.getStride());break}case"MultiPoint":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,t,Gt(t),i.getStride());break}case"Polygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),t,Gt(t),i.getStride());break}case"Point":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,t,Gt(t),i.getStride());break}case"LineString":case"LinearRing":{const i=e,s=i.getStride();this.addCoordinates_(r,i.getFlatCoordinates(),null,t,Gt(t),s,i.getLayout?.());break}}}addCoordinates_(e,t,r,i,s,a,o){let l;switch(e){case"MultiPolygon":{const c=r;for(let h=0,g=c.length;h<g;h++){let m=c[h];const x=h>0?c[h-1]:null,y=x?x[x.length-1]:0,_=m[m.length-1];m=y>0?m.map(w=>w-y):m,this.addCoordinates_("Polygon",t.slice(y,_),m,i,s,a,o)}break}case"MultiLineString":{const c=r;for(let h=0,g=c.length;h<g;h++){const m=h>0?c[h-1]:0;this.addCoordinates_("LineString",t.slice(m,c[h]),null,i,s,a,o)}break}case"MultiPoint":for(let c=0,h=t.length;c<h;c+=a)this.addCoordinates_("Point",t.slice(c,c+2),null,i,s,null,null);break;case"Polygon":{const c=r;if(i instanceof Fs){const m=Sj(t,c);if(m.length>1){this.addCoordinates_("MultiPolygon",t,m,i,s,a,o);return}}this.polygonBatch.entries[s]||(this.polygonBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0,ringsCount:0,ringsVerticesCounts:[]})),l=t.length/a;const h=r.length,g=r.map((m,x,y)=>x>0?(m-y[x-1])/a:m/a);this.polygonBatch.verticesCount+=l,this.polygonBatch.ringsCount+=h,this.polygonBatch.geometriesCount++,this.polygonBatch.entries[s].flatCoordss.push(HK(t,a)),this.polygonBatch.entries[s].ringsVerticesCounts.push(g),this.polygonBatch.entries[s].verticesCount+=l,this.polygonBatch.entries[s].ringsCount+=h;for(let m=0,x=c.length;m<x;m++){const y=m>0?c[m-1]:0;this.addCoordinates_("LinearRing",t.slice(y,c[m]),null,i,s,a,o)}break}case"Point":this.pointBatch.entries[s]||(this.pointBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[]})),this.pointBatch.geometriesCount++,this.pointBatch.entries[s].flatCoordss.push(t);break;case"LineString":case"LinearRing":this.lineStringBatch.entries[s]||(this.lineStringBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0})),l=t.length/a,this.lineStringBatch.verticesCount+=l,this.lineStringBatch.geometriesCount++,this.lineStringBatch.entries[s].flatCoordss.push(KK(t,a,o)),this.lineStringBatch.entries[s].verticesCount+=l;break}}addRefToEntry_(e,t){const r=this.uidToRef_.get(e),i=r||this.freeGlobalRef_.pop()||++this.globalCounter_;return t.ref=i,r||(this.refToFeature_.set(i,t.feature),this.uidToRef_.set(e,i)),t}removeRef_(e,t){if(!e)throw new Error("This feature has no ref: "+t);this.refToFeature_.delete(e),this.uidToRef_.delete(t),this.freeGlobalRef_.push(e)}changeFeature(e,t){if(!this.uidToRef_.get(Gt(e)))return;this.removeFeature(e);let r=e.getGeometry();r&&(t&&(r=r.clone(),r.applyTransform(t)),this.addGeometry_(r,e))}removeFeature(e){let t=this.clearFeatureEntryInPointBatch_(e);t=this.clearFeatureEntryInPolygonBatch_(e)||t,t=this.clearFeatureEntryInLineStringBatch_(e)||t,t&&this.removeRef_(t.ref,Gt(t.feature))}clear(){this.polygonBatch.entries={},this.polygonBatch.geometriesCount=0,this.polygonBatch.verticesCount=0,this.polygonBatch.ringsCount=0,this.lineStringBatch.entries={},this.lineStringBatch.geometriesCount=0,this.lineStringBatch.verticesCount=0,this.pointBatch.entries={},this.pointBatch.geometriesCount=0,this.globalCounter_=0,this.freeGlobalRef_=[],this.refToFeature_.clear(),this.uidToRef_.clear()}getFeatureFromRef(e){return this.refToFeature_.get(e)}isEmpty(){return this.globalCounter_===0}filter(e){const t=new tv;t.globalCounter_=this.globalCounter_,t.uidToRef_=this.uidToRef_,t.refToFeature_=this.refToFeature_;let r=!0;for(const i of this.refToFeature_.values())e(i)&&(t.addFeature(i),r=!1);return r?new tv:t}}function HK(n,e){return e===2?n:n.filter((t,r)=>r%e<2)}function KK(n,e,t){return e===3&&t==="XYM"?n:e===4?n.filter((r,i)=>i%e!==2):e===3?n.map((r,i)=>i%e!==2?r:0):new Array(n.length*1.5).fill(0).map((r,i)=>i%3===2?0:n[Math.round(i/1.5)])}function XK(){const n='function t(t,n,x=2){const o=n&&n.length,i=o?n[0]*x:t.length;let f=e(t,0,i,x,!0);const l=[];if(!f||f.next===f.prev)return l;let c,y,h;if(o&&(f=function(t,n,r,x){const o=[];for(let r=0,i=n.length;r<i;r++){const f=e(t,n[r]*x,r<i-1?n[r+1]*x:t.length,x,!1);f===f.next&&(f.steiner=!0),o.push(a(f))}o.sort(u);for(let t=0;t<o.length;t++)r=s(o[t],r);return r}(t,n,f,x)),t.length>80*x){c=t[0],y=t[1];let e=c,n=y;for(let r=x;r<i;r+=x){const x=t[r],o=t[r+1];x<c&&(c=x),o<y&&(y=o),x>e&&(e=x),o>n&&(n=o)}h=Math.max(e-c,n-y),h=0!==h?32767/h:0}return r(f,l,x,c,y,h,0),l}function e(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=d(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=d(x/r|0,t[x],t[x+1],o);return o&&b(o,o.next)&&(w(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(w(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function r(t,e,u,s,l,a,y){if(!t)return;!y&&a&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=c(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,f=0;for(let t=0;t<n&&(f++,i=i.nextZ,i);t++);let u=n;for(;f>0||u>0&&i;)0!==f&&(0===u||!i||x.z<=i.z)?(r=x,x=x.nextZ,f--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,s,l,a);let h=t;for(;t.prev!==t.next;){const c=t.prev,p=t.next;if(a?o(t,s,l,a):x(t))e.push(c.i,t.i,p.i),w(t),t=p.next,h=p.next;else if((t=p)===h){y?1===y?r(t=i(n(t),e),e,u,s,l,a,2):2===y&&f(t,e,u,s,l,a):r(n(t),e,u,s,l,a,1);break}}}function x(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,f=e.y,u=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(f,u,s),a=Math.max(x,o,i),y=Math.max(f,u,s);let p=r.next;for(;p!==e;){if(p.x>=l&&p.x<=a&&p.y>=c&&p.y<=y&&h(x,f,o,u,i,s,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,r){const x=t.prev,o=t,i=t.next;if(v(x,o,i)>=0)return!1;const f=x.x,u=o.x,s=i.x,l=x.y,a=o.y,y=i.y,p=Math.min(f,u,s),b=Math.min(l,a,y),M=Math.max(f,u,s),m=Math.max(l,a,y),A=c(p,b,e,n,r),g=c(M,m,e,n,r);let Z=t.prevZ,d=t.nextZ;for(;Z&&Z.z>=A&&d&&d.z<=g;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;Z&&Z.z>=A;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;d&&d.z<=g;){if(d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function i(t,e){let r=t;do{const n=r.prev,x=r.next.next;!b(n,x)&&M(n,r,r.next,x)&&g(n,x)&&g(x,n)&&(e.push(n.i,r.i,x.i),w(r),w(r.next),r=t=x),r=r.next}while(r!==t);return n(r)}function f(t,e,x,o,i,f){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.i!==t.i&&p(u,t)){let s=Z(u,t);return u=n(u,u.next),s=n(s,s.next),r(u,e,x,o,i,f,0),void r(s,e,x,o,i,f,0)}t=t.next}u=u.next}while(u!==t)}function u(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function s(t,e){const r=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(b(t,n))return n;do{if(b(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const f=o,u=o.x,s=o.y;let c=1/0;n=o;do{if(r>=n.x&&n.x>=u&&r!==n.x&&y(x<s?r:i,x,u,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);g(n,t)&&(e<c||e===c&&(n.x>o.x||n.x===o.x&&l(o,n)))&&(o=n,c=e)}n=n.next}while(n!==f);return o}(t,e);if(!r)return e;const x=Z(r,t);return n(x,x.next),n(r,r.next)}function l(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function c(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function a(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,x,o,i,f){return(x-i)*(e-f)>=(t-i)*(o-f)&&(t-i)*(r-f)>=(n-i)*(e-f)&&(n-i)*(o-f)>=(x-i)*(r-f)}function h(t,e,n,r,x,o,i,f){return!(t===i&&e===f)&&y(t,e,n,r,x,o,i,f)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&M(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(g(t,e)&&g(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||b(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function M(t,e,n,r){const x=A(v(t,e,n)),o=A(v(t,e,r)),i=A(v(n,r,t)),f=A(v(n,r,e));return x!==o&&i!==f||(!(0!==x||!m(t,n,e))||(!(0!==o||!m(t,r,e))||(!(0!==i||!m(n,t,r))||!(0!==f||!m(n,e,r)))))}function m(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function g(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function Z(t,e){const n=F(t.i,t.x,t.y),r=F(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function d(t,e,n,r){const x=F(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function E(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function I(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],f=e[3],u=e[4],s=e[5];return t[0]=f/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-f*u)/n,t[5]=-(x*s-o*u)/n,t}new Array(6);const z=[],B={vertexAttributesPosition:0,instanceAttributesPosition:0,indicesPosition:0};function P(t,e,n,r,x){const o=t[e++],i=t[e++],f=z;f.length=r;for(let n=0;n<f.length;n++)f[n]=t[e+n];let u=x?x.instanceAttributesPosition:0;return n[u++]=o,n[u++]=i,f.length&&(n.set(f,u),u+=f.length),B.instanceAttributesPosition=u,B}function N(t,e,n,r,x,o,i,f,u,s){const l=[t[e],t[e+1]],c=[t[n],t[n+1]],a=t[e+2],y=t[n+2],h=E(f,[...l]),p=E(f,[...c]);function v(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),f=[(n[0]-t[0])/i,(n[1]-t[1])/i];let u=0===r||0===i?0:Math.acos((s=f[0]*x[0]+f[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;u=Math.max(u,1e-5);return f[0]*o[0]+f[1]*o[1]>0?u:2*Math.PI-u}let b=-1,M=-1,m=s;const A=null!==x;if(null!==r){b=v(h,p,E(f,[...[t[r],t[r+1]]])),Math.cos(b)<=.985&&(m+=Math.tan((b-Math.PI)/2))}if(A){M=v(p,h,E(f,[...[t[x],t[x+1]]])),Math.cos(M)<=.985&&(m+=Math.tan((Math.PI-M)/2))}const g=Math.pow(2,24),Z=u%g,d=Math.floor(u/g)*g;return o.push(l[0],l[1],a,c[0],c[1],y,b,M,Z,d,s),o.push(...i),{length:u+Math.sqrt((p[0]-h[0])*(p[0]-h[0])+(p[1]-h[1])*(p[1]-h[1])),angle:m}}function R(e,n,r,x,o){const i=2+o;let f=n;const u=e.slice(f,f+o);f+=o;const s=e[f++];let l=0;const c=new Array(s-1);for(let t=0;t<s;t++)l+=e[f++],t<s-1&&(c[t]=l);const a=e.slice(f,f+2*l),y=t(a,c,2);for(let t=0;t<y.length;t++)x.push(y[t]+r.length/i);for(let t=0;t<a.length;t+=2)r.push(a[t],a[t+1],...u);return f+2*l}const S="GENERATE_POLYGON_BUFFERS",T="GENERATE_POINT_BUFFERS",_="GENERATE_LINE_STRING_BUFFERS",O=self;O.onmessage=t=>{const e=t.data;switch(e.type){case T:{const t=2,n=2,r=e.customAttributesSize,x=n+r,o=new Float32Array(e.renderInstructions),i=o.length/x*(t+r),f=Uint32Array.from([0,1,3,1,2,3]),u=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),s=new Float32Array(i);let l;for(let t=0;t<o.length;t+=x)l=P(o,t,s,r,l);const c=Object.assign({indicesBuffer:f.buffer,vertexAttributesBuffer:u.buffer,instanceAttributesBuffer:s.buffer,renderInstructions:o.buffer},e);O.postMessage(c,[u.buffer,s.buffer,f.buffer,o.buffer]);break}case _:{const t=[],n=e.customAttributesSize,r=3,x=new Float32Array(e.renderInstructions);let o=0;const i=[1,0,0,1,0,0];let f,u;for(I(i,e.renderInstructionsTransform);o<x.length;){u=Array.from(x.slice(o,o+n)),o+=n,f=x[o++];const e=o,s=o+(f-1)*r,l=x[e]===x[s]&&x[e+1]===x[s+1];let c=0,a=0;for(let n=0;n<f-1;n++){let y=null;n>0?y=o+(n-1)*r:l&&(y=s-r);let h=null;n<f-2?h=o+(n+2)*r:l&&(h=e+r);const p=N(x,o+n*r,o+(n+1)*r,y,h,t,u,i,c,a);c=p.length,a=p.angle}o+=f*r}const s=Uint32Array.from([0,1,3,1,2,3]),l=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),c=Float32Array.from(t),a=Object.assign({indicesBuffer:s.buffer,vertexAttributesBuffer:l.buffer,instanceAttributesBuffer:c.buffer,renderInstructions:x.buffer},e);O.postMessage(a,[l.buffer,c.buffer,s.buffer,x.buffer]);break}case S:{const t=[],n=[],r=e.customAttributesSize,x=new Float32Array(e.renderInstructions);let o=0;for(;o<x.length;)o=R(x,o,t,n,r);const i=Uint32Array.from(n),f=Float32Array.from(t),u=Float32Array.from([]),s=Object.assign({indicesBuffer:i.buffer,vertexAttributesBuffer:f.buffer,instanceAttributesBuffer:u.buffer,renderInstructions:x.buffer},e);O.postMessage(s,[f.buffer,u.buffer,i.buffer,x.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(n,"binary").toString("base64"):URL.createObjectURL(new Blob([n],{type:"application/javascript"})))}const XS={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};function qK(n,e){e=e||[];const t=256,r=t-1,i=Math.floor(n/t/t/t)/r,s=Math.floor(n/t/t)%t/r,a=Math.floor(n/t)%t/r,o=n%t/r;return e[0]=i*256*255+s*255,e[1]=a*256*255+o*255,e}function YK(n){let e=0;const t=256,r=t-1;return e+=Math.round(n[0]*t*t*t*r),e+=Math.round(n[1]*t*t*r),e+=Math.round(n[2]*t*r),e+=Math.round(n[3]*r),e}function KA(n,e,t,r){let i=0;for(const s in e){const a=e[s],o=a.callback.call(t,t.feature);let l=o?.[0]??o;l===Ab&&console.warn('The "has" operator might return false positives.'),l===void 0?l=Ab:l===null&&(l=0),n[r+i++]=l,!(!a.size||a.size===1)&&(n[r+i++]=o[1],!(a.size<3)&&(n[r+i++]=o[2],!(a.size<4)&&(n[r+i++]=o[3])))}return i}function $w(n){return Object.keys(n).reduce((e,t)=>e+(n[t].size||1),0)}function ZK(n,e,t,r){const i=(2+$w(t))*n.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++)s[0]=l.flatCoordss[c][0],s[1]=l.flatCoordss[c][1],Cr(r,s),e[a++]=s[0],e[a++]=s[1],a+=KA(e,t,l,a)}return e}function JK(n,e,t,r){const i=3*n.verticesCount+(1+$w(t))*n.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,rl(l.flatCoordss[c],0,s.length,3,r,s,3),a+=KA(e,t,l,a),e[a++]=s.length/3;for(let g=0,m=s.length;g<m;g+=3)e[a++]=s[g],e[a++]=s[g+1],e[a++]=s[g+2]}}return e}function QK(n,e,t,r){const i=2*n.verticesCount+(1+$w(t))*n.geometriesCount+n.ringsCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,rl(l.flatCoordss[c],0,s.length,2,r,s),a+=KA(e,t,l,a),e[a++]=l.ringsVerticesCounts[c].length;for(let g=0,m=l.ringsVerticesCounts[c].length;g<m;g++)e[a++]=l.ringsVerticesCounts[c][g];for(let g=0,m=s.length;g<m;g+=2)e[a++]=s[g],e[a++]=s[g+1]}}return e}function nv(n){return(JSON.stringify(n).split("").reduce((t,r)=>(t<<5)-t+r.charCodeAt(0),0)>>>0).toString()}function XA(n,e,t,r){if(`${r}radius`in n&&r!=="icon-"){let i=Jt(t,n[`${r}radius`],kt);if(`${r}radius2`in n){const s=Jt(t,n[`${r}radius2`],kt);i=`max(${i}, ${s})`}`${r}stroke-width`in n&&(i=`(${i} + ${Jt(t,n[`${r}stroke-width`],kt)} * 0.5)`),e.setSymbolSizeExpression(`vec2(${i} * 2. + 0.5)`)}if(`${r}scale`in n){const i=Jt(t,n[`${r}scale`],ja);e.setSymbolSizeExpression(`${e.getSymbolSizeExpression()} * ${i}`)}`${r}displacement`in n&&e.setSymbolOffsetExpression(Jt(t,n[`${r}displacement`],Hs)),`${r}rotation`in n&&e.setSymbolRotationExpression(Jt(t,n[`${r}rotation`],kt)),`${r}rotate-with-view`in n&&e.setSymbolRotateWithView(!!n[`${r}rotate-with-view`])}function rF(n,e,t,r,i){let s="vec4(0.)";if(e!==null&&(s=e),t!==null&&r!==null){const l=`smoothstep(-${r} + 0.63, -${r} - 0.58, ${n})`;s=`mix(${t}, ${s}, ${l})`}const a=`(1.0 - smoothstep(-0.63, 0.58, ${n}))`;let o=`${s} * vec4(1.0, 1.0, 1.0, ${a})`;return i!==null&&(o=`${o} * vec4(1.0, 1.0, 1.0, ${i})`),o}function qA(n,e,t,r,i){const s=new Image;s.crossOrigin=n[`${r}cross-origin`]===void 0?"anonymous":n[`${r}cross-origin`],Rn(typeof n[`${r}src`]=="string",`WebGL layers do not support expressions for the ${r}src style property`),s.src=n[`${r}src`],t[`u_texture${i}_size`]=()=>s.complete?[s.width,s.height]:[0,0],e.addUniform(`u_texture${i}_size`,"vec2");const a=`u_texture${i}_size`;return t[`u_texture${i}`]=s,e.addUniform(`u_texture${i}`,"sampler2D"),a}function YA(n,e,t,r,i){let s=Jt(t,n[`${e}offset`],ja);if(`${e}offset-origin`in n)switch(n[`${e}offset-origin`]){case"top-right":s=`vec2(${r}.x, 0.) + ${i} * vec2(-1., 0.) + ${s} * vec2(-1., 1.)`;break;case"bottom-left":s=`vec2(0., ${r}.y) + ${i} * vec2(0., -1.) + ${s} * vec2(1., -1.)`;break;case"bottom-right":s=`${r} - ${i} - ${s}`;break}return s}function eX(n,e,t,r){r.functions.circleDistanceField=`float circleDistanceField(vec2 point, float radius) {
  return length(point) - radius;
}`,XA(n,e,r,"circle-");let i=null;"circle-opacity"in n&&(i=Jt(r,n["circle-opacity"],kt));let s="coordsPx";"circle-scale"in n&&(s=`coordsPx / ${Jt(r,n["circle-scale"],ja)}`);let a=null;"circle-fill-color"in n&&(a=Jt(r,n["circle-fill-color"],vr));let o=null;"circle-stroke-color"in n&&(o=Jt(r,n["circle-stroke-color"],vr));let l=Jt(r,n["circle-radius"],kt),c=null;"circle-stroke-width"in n&&(c=Jt(r,n["circle-stroke-width"],kt),l=`(${l} + ${c} * 0.5)`);const h=`circleDistanceField(${s}, ${l})`,g=rF(h,a,o,c,i);e.setSymbolColorExpression(g)}function tX(n,e,t,r){r.functions.round=`float round(float v) {
  return sign(v) * floor(abs(v) + 0.5);
}`,r.functions.starDistanceField=`float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round(beta / alpha) * alpha; // angle in sector
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  vec2 tipToPoint = inSector + vec2(-radius, 0.);
  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);
  return dot(normalize(edgeNormal), tipToPoint);
}`,r.functions.regularDistanceField=`float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float radiusIn = radius * cos(PI / numPoints);
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  return inSector.x - radiusIn;
}`,XA(n,e,r,"shape-");let i=null;"shape-opacity"in n&&(i=Jt(r,n["shape-opacity"],kt));let s="coordsPx";"shape-scale"in n&&(s=`coordsPx / ${Jt(r,n["shape-scale"],ja)}`);let a=null;"shape-fill-color"in n&&(a=Jt(r,n["shape-fill-color"],vr));let o=null;"shape-stroke-color"in n&&(o=Jt(r,n["shape-stroke-color"],vr));let l=null;"shape-stroke-width"in n&&(l=Jt(r,n["shape-stroke-width"],kt));const c=Jt(r,n["shape-points"],kt);let h="0.";"shape-angle"in n&&(h=Jt(r,n["shape-angle"],kt));let g,m=Jt(r,n["shape-radius"],kt);if(l!==null&&(m=`${m} + ${l} * 0.5`),"shape-radius2"in n){let y=Jt(r,n["shape-radius2"],kt);l!==null&&(y=`${y} + ${l} * 0.5`),g=`starDistanceField(${s}, ${c}, ${m}, ${y}, ${h})`}else g=`regularDistanceField(${s}, ${c}, ${m}, ${h})`;const x=rF(g,a,o,l,i);e.setSymbolColorExpression(x)}function nX(n,e,t,r){let i="vec4(1.0)";"icon-color"in n&&(i=Jt(r,n["icon-color"],vr)),"icon-opacity"in n&&(i=`${i} * vec4(1.0, 1.0, 1.0, ${Jt(r,n["icon-opacity"],kt)})`);const s=nv(n["icon-src"]),a=qA(n,e,t,"icon-",s);if(e.setSymbolColorExpression(`${i} * texture2D(u_texture${s}, v_texCoord)`).setSymbolSizeExpression(a),"icon-width"in n&&"icon-height"in n&&e.setSymbolSizeExpression(`vec2(${Jt(r,n["icon-width"],kt)}, ${Jt(r,n["icon-height"],kt)})`),"icon-offset"in n&&"icon-size"in n){const o=Jt(r,n["icon-size"],Hs),l=e.getSymbolSizeExpression();e.setSymbolSizeExpression(o);const c=YA(n,"icon-",r,"v_quadSizePx",o);e.setTextureCoordinateExpression(`(vec4((${c}).xyxy) + vec4(0., 0., ${o})) / (${l}).xyxy`)}if(XA(n,e,r,"icon-"),"icon-anchor"in n){const o=Jt(r,n["icon-anchor"],Hs);let l="1.0";"icon-scale"in n&&(l=Jt(r,n["icon-scale"],ja));let c;n["icon-anchor-x-units"]==="pixels"&&n["icon-anchor-y-units"]==="pixels"?c=`${o} * ${l}`:n["icon-anchor-x-units"]==="pixels"?c=`${o} * vec2(vec2(${l}).x, v_quadSizePx.y)`:n["icon-anchor-y-units"]==="pixels"?c=`${o} * vec2(v_quadSizePx.x, vec2(${l}).x)`:c=`${o} * v_quadSizePx`;let h=`v_quadSizePx * vec2(0.5, -0.5) + ${c} * vec2(-1., 1.)`;if("icon-anchor-origin"in n)switch(n["icon-anchor-origin"]){case"top-right":h=`v_quadSizePx * -0.5 + ${c}`;break;case"bottom-left":h=`v_quadSizePx * 0.5 - ${c}`;break;case"bottom-right":h=`v_quadSizePx * vec2(-0.5, 0.5) + ${c} * vec2(1., -1.)`;break}e.setSymbolOffsetExpression(`${e.getSymbolOffsetExpression()} + ${h}`)}}function rX(n,e,t,r){if("stroke-color"in n&&e.setStrokeColorExpression(Jt(r,n["stroke-color"],vr)),"stroke-pattern-src"in n){const i=nv(n["stroke-pattern-src"]),s=qA(n,e,t,"stroke-pattern-",i);let a=s,o="vec2(0.)";"stroke-pattern-offset"in n&&"stroke-pattern-size"in n&&(a=Jt(r,n["stroke-pattern-size"],Hs),o=YA(n,"stroke-pattern-",r,s,a));let l="0.";"stroke-pattern-spacing"in n&&(l=Jt(r,n["stroke-pattern-spacing"],kt));let c="0.";"stroke-pattern-start-offset"in n&&(c=Jt(r,n["stroke-pattern-start-offset"],kt)),r.functions.sampleStrokePattern=`vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float startOffsetPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {
  float currentLengthScaled = (currentLengthPx - startOffsetPx) * sampleSize.y / lineWidth;
  float spacingScaled = spacingPx * sampleSize.y / lineWidth;
  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));
  float isInsideOfPattern = step(uCoordPx, sampleSize.x);
  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;
  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);
  vCoordPx = clamp(vCoordPx, 0.5, sampleSize.y - 0.5);
  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;
  return texture2D(texture, texCoord) * vec4(1.0, 1.0, 1.0, isInsideOfPattern);
}`;const h=`u_texture${i}`;let g="1.";"stroke-color"in n&&(g=e.getStrokeColorExpression()),e.setStrokeColorExpression(`${g} * sampleStrokePattern(${h}, ${s}, ${o}, ${a}, ${l}, ${c}, currentLengthPx, currentRadiusRatio, v_width)`),r.functions.computeStrokePatternLength=`float computeStrokePatternLength(vec2 sampleSize, float spacingPx, float lineWidth) {
  float patternLengthPx = sampleSize.x / sampleSize.y * lineWidth;
  return patternLengthPx + spacingPx;
}`,e.setStrokePatternLengthExpression(`computeStrokePatternLength(${a}, ${l}, v_width)`)}if("stroke-width"in n&&e.setStrokeWidthExpression(Jt(r,n["stroke-width"],kt)),"stroke-offset"in n&&e.setStrokeOffsetExpression(Jt(r,n["stroke-offset"],kt)),"stroke-line-cap"in n&&e.setStrokeCapExpression(Jt(r,n["stroke-line-cap"],fi)),"stroke-line-join"in n&&e.setStrokeJoinExpression(Jt(r,n["stroke-line-join"],fi)),"stroke-miter-limit"in n&&e.setStrokeMiterLimitExpression(Jt(r,n["stroke-miter-limit"],kt)),"stroke-line-dash"in n){r.functions.getSingleDashDistance=`float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType, float lineWidth) {
  float localDistance = mod(distance, dashLengthTotal);
  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;
  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);
  if (capType == ${zl("square")}) {
    distanceSegment -= lineWidth * 0.5;
  } else if (capType == ${zl("round")}) {
    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - lineWidth * 0.5);
  }
  return distanceSegment;
}`;let i=n["stroke-line-dash"].map(y=>Jt(r,y,kt));i.length%2===1&&(i=[...i,...i]);let s="0.";"stroke-line-dash-offset"in n&&(s=Jt(r,n["stroke-line-dash-offset"],kt));const o=`dashDistanceField_${nv(n["stroke-line-dash"])}`,l=i.map((y,_)=>`float dashLength${_}`).join(", "),c=i.map((y,_)=>`dashLength${_}`).join(" + ");let h="0.",g=`getSingleDashDistance(distance, radius, ${h}, dashLength0, totalDashLength, capType, lineWidth)`;for(let y=2;y<i.length;y+=2)h=`${h} + dashLength${y-2} + dashLength${y-1}`,g=`min(${g}, getSingleDashDistance(distance, radius, ${h}, dashLength${y}, totalDashLength, capType, lineWidth))`;r.functions[o]=`float ${o}(float distance, float radius, float capType, float lineWidth, ${l}) {
  float totalDashLength = ${c};
  return ${g};
}`;const m=i.map((y,_)=>`${y}`).join(", ");e.setStrokeDistanceFieldExpression(`${o}(currentLengthPx + ${s}, currentRadiusPx, capType, v_width, ${m})`);let x=i.join(" + ");e.getStrokePatternLengthExpression()&&(r.functions.combinePatternLengths=`float combinePatternLengths(float patternLength1, float patternLength2) {
  return patternLength1 * patternLength2;
}`,x=`combinePatternLengths(${e.getStrokePatternLengthExpression()}, ${x})`),e.setStrokePatternLengthExpression(x)}}function iX(n,e,t,r){if("fill-color"in n&&e.setFillColorExpression(Jt(r,n["fill-color"],vr)),"fill-pattern-src"in n){const i=nv(n["fill-pattern-src"]),s=qA(n,e,t,"fill-pattern-",i);let a=s,o="vec2(0.)";"fill-pattern-offset"in n&&"fill-pattern-size"in n&&(a=Jt(r,n["fill-pattern-size"],Hs),o=YA(n,"fill-pattern-",r,s,a)),r.functions.sampleFillPattern=`vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {
  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);
  vec2 pxRelativePos = pxPosition - pxOrigin;
  // rotate the relative position from origin by the current view rotation
  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));
  // sample position is computed according to the sample offset & size
  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);
  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));
  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright
  return texture2D(texture, (samplePos + textureOffset) / textureSize);
}`;const l=`u_texture${i}`;let c="1.";"fill-color"in n&&(c=e.getFillColorExpression()),e.setFillColorExpression(`${c} * sampleFillPattern(${l}, ${s}, ${o}, ${a}, pxOrigin, pxPos)`)}}function uM(n,e,t){const r=Yj(),i=new nF,s={};if("icon-src"in n?nX(n,i,s,r):"shape-points"in n?tX(n,i,s,r):"circle-radius"in n&&eX(n,i,s,r),rX(n,i,s,r),iX(n,i,s,r),t){const l=Jt(r,t,ei);i.setFragmentDiscardExpression(`!${l}`)}const a={};function o(l,c,h,g){if(!r[l])return;const m=kb(h),x=HA(h);i.addAttribute(`a_${c}`,m),a[c]={size:x,callback:g}}return o("geometryType",Jj,fi,l=>Lp(NA(l.getGeometry()))),o("featureId",Zj,fi|kt,l=>{const c=l.getId()??null;return typeof c=="string"?Lp(c):c}),Qj(i,r),{builder:i,attributes:{...a,...tF(r)},uniforms:{...s,...eF(r,e)}}}const sX=[];let qS;function aX(){return qS||(qS=XK()),qS}let oX=0;const Aa={POSITION:"a_position",LOCAL_POSITION:"a_localPosition",SEGMENT_START:"a_segmentStart",SEGMENT_END:"a_segmentEnd",MEASURE_START:"a_measureStart",MEASURE_END:"a_measureEnd",ANGLE_TANGENT_SUM:"a_angleTangentSum",JOIN_ANGLES:"a_joinAngles",DISTANCE_LOW:"a_distanceLow",DISTANCE_HIGH:"a_distanceHigh"};class lX{constructor(e,t,r,i){this.helper_,this.hitDetectionEnabled_=!!i,this.styleShaders=cX(e,t),this.customAttributes_={},this.uniforms_={},this.hitDetectionEnabled_&&(this.customAttributes_.hitColor={callback(){return qK(this.ref,sX)},size:2});for(const s of this.styleShaders){for(const a in s.attributes)a in this.customAttributes_||(this.customAttributes_[a]=s.attributes[a]);for(const a in s.uniforms)a in this.uniforms_||(this.uniforms_[a]=s.uniforms[a])}this.renderPasses_=this.styleShaders.map(s=>{const a={},o=Object.entries(this.customAttributes_).map(([l,c])=>({name:l in s.attributes||l==="hitColor"?`a_${l}`:null,size:c.size||1,type:wi.FLOAT}));return s.builder.getFillVertexShader()&&(a.fillRenderPass={vertexShader:s.builder.getFillVertexShader(),fragmentShader:s.builder.getFillFragmentShader(),attributesDesc:[{name:Aa.POSITION,size:2,type:wi.FLOAT},...o],instancedAttributesDesc:[],instancePrimitiveVertexCount:3}),s.builder.getStrokeVertexShader()&&(a.strokeRenderPass={vertexShader:s.builder.getStrokeVertexShader(),fragmentShader:s.builder.getStrokeFragmentShader(),attributesDesc:[{name:Aa.LOCAL_POSITION,size:2,type:wi.FLOAT}],instancedAttributesDesc:[{name:Aa.SEGMENT_START,size:2,type:wi.FLOAT},{name:Aa.MEASURE_START,size:1,type:wi.FLOAT},{name:Aa.SEGMENT_END,size:2,type:wi.FLOAT},{name:Aa.MEASURE_END,size:1,type:wi.FLOAT},{name:Aa.JOIN_ANGLES,size:2,type:wi.FLOAT},{name:Aa.DISTANCE_LOW,size:1,type:wi.FLOAT},{name:Aa.DISTANCE_HIGH,size:1,type:wi.FLOAT},{name:Aa.ANGLE_TANGENT_SUM,size:1,type:wi.FLOAT},...o],instancePrimitiveVertexCount:6}),s.builder.getSymbolVertexShader()&&(a.symbolRenderPass={vertexShader:s.builder.getSymbolVertexShader(),fragmentShader:s.builder.getSymbolFragmentShader(),attributesDesc:[{name:Aa.LOCAL_POSITION,size:2,type:wi.FLOAT}],instancedAttributesDesc:[{name:Aa.POSITION,size:2,type:wi.FLOAT},...o],instancePrimitiveVertexCount:6}),a}),this.hasFill_=this.renderPasses_.some(s=>s.fillRenderPass),this.hasStroke_=this.renderPasses_.some(s=>s.strokeRenderPass),this.hasSymbol_=this.renderPasses_.some(s=>s.symbolRenderPass),this.setHelper(r)}async generateBuffers(e,t){if(e.isEmpty())return null;const r=this.generateRenderInstructions_(e,t),[i,s,a]=await Promise.all([this.generateBuffersForType_(r.polygonInstructions,"Polygon",t),this.generateBuffersForType_(r.lineStringInstructions,"LineString",t),this.generateBuffersForType_(r.pointInstructions,"Point",t)]),o=Sp(ni(),t);return{polygonBuffers:i,lineStringBuffers:s,pointBuffers:a,invertVerticesTransform:o}}generateRenderInstructions_(e,t){const r=this.hasFill_?QK(e.polygonBatch,new Float32Array(0),this.customAttributes_,t):null,i=this.hasStroke_?JK(e.lineStringBatch,new Float32Array(0),this.customAttributes_,t):null,s=this.hasSymbol_?ZK(e.pointBatch,new Float32Array(0),this.customAttributes_,t):null;return{polygonInstructions:r,lineStringInstructions:i,pointInstructions:s}}generateBuffersForType_(e,t,r){if(e===null)return null;const i=oX++;let s;switch(t){case"Polygon":s=XS.GENERATE_POLYGON_BUFFERS;break;case"LineString":s=XS.GENERATE_LINE_STRING_BUFFERS;break;case"Point":s=XS.GENERATE_POINT_BUFFERS;break}const a={id:i,type:s,renderInstructions:e.buffer,renderInstructionsTransform:r,customAttributesSize:$w(this.customAttributes_)},o=aX();return o.postMessage(a,[e.buffer]),e=null,new Promise(l=>{const c=h=>{const g=h.data;if(g.id!==i||(o.removeEventListener("message",c),!this.helper_.getGL()))return;const m=new Um(Bw,zS).fromArrayBuffer(g.indicesBuffer),x=new Um(Np,zS).fromArrayBuffer(g.vertexAttributesBuffer),y=new Um(Np,zS).fromArrayBuffer(g.instanceAttributesBuffer);this.helper_.flushBufferData(m),this.helper_.flushBufferData(x),this.helper_.flushBufferData(y),l([m,x,y])};o.addEventListener("message",c)})}render(e,t,r){for(const i of this.renderPasses_)i.fillRenderPass&&this.renderInternal_(e.polygonBuffers[0],e.polygonBuffers[1],e.polygonBuffers[2],i.fillRenderPass,t,r),i.strokeRenderPass&&this.renderInternal_(e.lineStringBuffers[0],e.lineStringBuffers[1],e.lineStringBuffers[2],i.strokeRenderPass,t,r),i.symbolRenderPass&&this.renderInternal_(e.pointBuffers[0],e.pointBuffers[1],e.pointBuffers[2],i.symbolRenderPass,t,r)}renderInternal_(e,t,r,i,s,a){const o=e.getSize();if(o===0)return;const l=i.instancedAttributesDesc.length;if(this.helper_.useProgram(i.program,s),this.helper_.bindBuffer(t),this.helper_.bindBuffer(e),this.helper_.enableAttributes(i.attributesDesc),this.helper_.bindBuffer(r),this.helper_.enableAttributesInstanced(i.instancedAttributesDesc),a(),l){const c=i.instancedAttributesDesc.reduce((g,m)=>g+(m.size||1),0),h=r.getSize()/c;this.helper_.drawElementsInstanced(0,o,h)}else this.helper_.drawElements(0,o)}setHelper(e,t=null){this.helper_=e;for(const r of this.renderPasses_)r.fillRenderPass&&(r.fillRenderPass.program=this.helper_.getProgram(r.fillRenderPass.fragmentShader,r.fillRenderPass.vertexShader)),r.strokeRenderPass&&(r.strokeRenderPass.program=this.helper_.getProgram(r.strokeRenderPass.fragmentShader,r.strokeRenderPass.vertexShader)),r.symbolRenderPass&&(r.symbolRenderPass.program=this.helper_.getProgram(r.symbolRenderPass.fragmentShader,r.symbolRenderPass.vertexShader));this.helper_.addUniforms(this.uniforms_),t&&(t.polygonBuffers&&(this.helper_.flushBufferData(t.polygonBuffers[0]),this.helper_.flushBufferData(t.polygonBuffers[1]),this.helper_.flushBufferData(t.polygonBuffers[2])),t.lineStringBuffers&&(this.helper_.flushBufferData(t.lineStringBuffers[0]),this.helper_.flushBufferData(t.lineStringBuffers[1]),this.helper_.flushBufferData(t.lineStringBuffers[2])),t.pointBuffers&&(this.helper_.flushBufferData(t.pointBuffers[0]),this.helper_.flushBufferData(t.pointBuffers[1]),this.helper_.flushBufferData(t.pointBuffers[2])))}}function cX(n,e){const t=Array.isArray(n)?n:[n];if("style"in t[0]){const r=[],i=t,s=[];for(const a of i){const o=Array.isArray(a.style)?a.style:[a.style];let l=a.filter;a.else&&s.length&&(l=["all",...s.map(h=>["!",h])],a.filter&&l.push(a.filter),l.length<3&&(l=l[1])),a.filter&&s.push(a.filter);const c=o.map(h=>uM(h,e,l));r.push(...c)}return r}return"builder"in t[0]?t:t.map(r=>uM(r,e,null))}const Ho=new Uint8Array(4);class uX{constructor(e,t){this.helper_=e;const r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.depthbuffer_=r.createRenderbuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){gc(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,t){if(e<0||t<0||e>this.size_[0]||t>=this.size_[1])return Ho[0]=0,Ho[1]=0,Ho[2]=0,Ho[3]=0,Ho;this.readAll();const r=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return Ho[0]=this.data_[r*4],Ho[1]=this.data_[r*4+1],Ho[2]=this.data_[r*4+2],Ho[3]=this.data_[r*4+3],Ho}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),t.bindRenderbuffer(t.RENDERBUFFER,this.depthbuffer_),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e[0],e[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}}function hX(n,e){const t=n.viewState.projection,i=e.getSource().getWrapX()&&t.canWrapX(),s=t.getExtent(),a=n.extent,o=i?mn(s):null,l=i?Math.ceil((a[2]-s[2])/o)+1:1;return[i?Math.floor((a[0]-s[0])/o):0,l,o]}const Cf={...Bl,RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",GLOBAL_ALPHA:"u_globalAlpha"};class dX extends Uw{constructor(e,t){const r={[Cf.RENDER_EXTENT]:[0,0,0,0],[Cf.PATTERN_ORIGIN]:[0,0],[Cf.GLOBAL_ALPHA]:1};super(e,{uniforms:r,postProcesses:t.postProcesses}),this.hitDetectionEnabled_=!t.disableHitDetection,this.hitRenderTarget_,this.sourceRevision_=-1,this.previousExtent_=$s(),this.currentTransform_=ni(),this.tmpCoords_=[0,0],this.tmpTransform_=ni(),this.tmpMat4_=VA(),this.currentFrameStateTransform_=ni(),this.styleVariables_={},this.style_=[],this.styleRenderer_=null,this.buffers_=null,this.applyOptions_(t),this.batch_=new tv,this.initialFeaturesAdded_=!1,this.sourceListenKeys_=null}addInitialFeatures_(e){const t=this.getLayer().getSource();let r;this.batch_.addFeatures(t.getFeatures(),r),this.sourceListenKeys_=[gn(t,ss.ADDFEATURE,this.handleSourceFeatureAdded_.bind(this,r)),gn(t,ss.CHANGEFEATURE,this.handleSourceFeatureChanged_.bind(this,r),this),gn(t,ss.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),gn(t,ss.CLEAR,this.handleSourceFeatureClear_,this)]}applyOptions_(e){this.styleVariables_=e.variables,this.style_=e.style}createRenderers_(){this.buffers_=null,this.styleRenderer_=new lX(this.style_,this.styleVariables_,this.helper,this.hitDetectionEnabled_)}reset(e){this.applyOptions_(e),this.helper&&this.createRenderers_(),super.reset(e)}afterHelperCreated(){this.styleRenderer_?this.styleRenderer_.setHelper(this.helper,this.buffers_):this.createRenderers_(),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new uX(this.helper))}handleSourceFeatureAdded_(e,t){const r=t.feature;this.batch_.addFeature(r,e)}handleSourceFeatureChanged_(e,t){const r=t.feature;this.batch_.changeFeature(r,e)}handleSourceFeatureDelete_(e){const t=e.feature;this.batch_.removeFeature(t)}handleSourceFeatureClear_(){this.batch_.clear()}applyUniforms_(e){XD(this.tmpTransform_,this.currentFrameStateTransform_),kw(this.tmpTransform_,e),this.helper.setUniformMatrixValue(Cf.PROJECTION_MATRIX,J_(this.tmpMat4_,this.tmpTransform_)),Sp(this.tmpTransform_,this.tmpTransform_),this.helper.setUniformMatrixValue(Cf.SCREEN_TO_WORLD_MATRIX,J_(this.tmpMat4_,this.tmpTransform_)),this.tmpCoords_[0]=0,this.tmpCoords_[1]=0,Sp(this.tmpTransform_,e),Cr(this.tmpTransform_,this.tmpCoords_),this.helper.setUniformFloatVec2(Cf.PATTERN_ORIGIN,this.tmpCoords_)}renderFrame(e){const t=this.helper.getGL();this.preRender(t,e);const[r,i,s]=hX(e,this.getLayer());this.helper.prepareDraw(e),this.renderWorlds(e,!1,r,i,s),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const a=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,r,i,s),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),a}prepareFrameInternal(e){this.initialFeaturesAdded_||(this.addInitialFeatures_(e),this.initialFeaturesAdded_=!0);const t=this.getLayer(),r=t.getSource(),i=e.viewState,s=!e.viewHints[Qr.ANIMATING]&&!e.viewHints[Qr.INTERACTING],a=!sd(this.previousExtent_,e.extent),o=this.sourceRevision_<r.getRevision();if(o&&(this.sourceRevision_=r.getRevision()),s&&(a||o)){const l=i.projection,c=i.resolution,h=t instanceof Fw?t.getRenderBuffer():0,g=M0(e.extent,h*c);r.loadFeatures(g,c,l),this.ready=!1;const m=this.helper.makeProjectionTransform(e,ni());this.styleRenderer_.generateBuffers(this.batch_,m).then(x=>{this.buffers_&&this.disposeBuffers(this.buffers_),this.buffers_=x,this.ready=!0,this.getLayer().changed()}),this.previousExtent_=e.extent.slice()}return!0}renderWorlds(e,t,r,i,s){let a=r;t&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0));do this.helper.makeProjectionTransform(e,this.currentFrameStateTransform_),qD(this.currentFrameStateTransform_,a*s,0),this.buffers_&&this.styleRenderer_.render(this.buffers_,e,()=>{this.applyUniforms_(this.buffers_.invertVerticesTransform),this.helper.applyHitDetectionUniform(t)});while(++a<i)}forEachFeatureAtCoordinate(e,t,r,i,s){if(Rn(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.styleRenderer_||!this.hitDetectionEnabled_)return;const a=Cr(t.coordinateToPixelTransform,e.slice()),o=this.hitRenderTarget_.readPixel(a[0]/2,a[1]/2),l=[o[0]/255,o[1]/255,o[2]/255,o[3]/255],c=YK(l),h=this.batch_.getFeatureFromRef(c);if(h)return i(h,this.getLayer(),null)}disposeBuffers(e){const t=r=>{for(const i of r)i&&this.helper.deleteBuffer(i)};e.pointBuffers&&t(e.pointBuffers),e.lineStringBuffers&&t(e.lineStringBuffers),e.polygonBuffers&&t(e.polygonBuffers)}disposeInternal(){this.buffers_&&this.disposeBuffers(this.buffers_),this.sourceListenKeys_&&(this.sourceListenKeys_.forEach(function(e){or(e)}),this.sourceListenKeys_=null),super.disposeInternal()}renderDeclutter(){}}const Fl={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},fX=["#00f","#0ff","#0f0","#ff0","#f00"];class gX extends Fw{constructor(e){e=e||{};const t=Object.assign({},e);delete t.gradient,delete t.radius,delete t.blur,delete t.weight,super(t),this.filter_=e.filter??!0,this.styleVariables_=e.variables||{},this.gradient_=null,this.addChangeListener(Fl.GRADIENT,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:fX),this.setBlur(e.blur!==void 0?e.blur:15),this.setRadius(e.radius!==void 0?e.radius:8);const r=e.weight?e.weight:"weight";this.weight_=r,this.setRenderOrder(null)}getBlur(){return this.get(Fl.BLUR)}getGradient(){return this.get(Fl.GRADIENT)}getRadius(){return this.get(Fl.RADIUS)}handleGradientChanged_(){this.gradient_=mX(this.getGradient())}setBlur(e){const t=this.get(Fl.BLUR);if(this.set(Fl.BLUR,e),typeof e=="number"&&typeof t=="number"){this.changed();return}this.clearRenderer()}setGradient(e){this.set(Fl.GRADIENT,e)}setRadius(e){const t=this.get(Fl.RADIUS);if(this.set(Fl.RADIUS,e),typeof e=="number"&&typeof t=="number"){this.changed();return}this.clearRenderer()}setFilter(e){this.filter_=e,this.changed(),this.clearRenderer()}setWeight(e){this.weight_=e,this.changed(),this.clearRenderer()}createRenderer(){const e=new nF,t=Yj(),r=Jt(t,this.filter_,ei);let i=Jt(t,this.getRadius(),kt),s=Jt(t,this.getBlur(),kt);const a={};typeof this.getBlur()=="number"&&(s="a_blur",a.a_blur=()=>this.getBlur(),e.addUniform("a_blur","float")),typeof this.getRadius()=="number"&&(i="a_radius",a.a_radius=()=>this.getRadius(),e.addUniform("a_radius","float"));const o={};let l=null;if(typeof this.weight_=="string"||typeof this.weight_=="function"){const g=typeof this.weight_=="string"?m=>m.get(this.weight_):this.weight_;o.prop_weight={size:1,callback:m=>{const x=g(m);return x!==void 0?ur(x,0,1):1}},l="a_prop_weight",e.addAttribute("a_prop_weight","float")}else{const g=["clamp",this.weight_,0,1];l=Jt(t,g,kt)}e.addFragmentShaderFunction(`float getBlurSlope() {
  float blur = max(1., ${s});
  float radius = ${i};
  return radius / blur;
}`).setSymbolSizeExpression(`vec2(${i} + ${s}) * 2.`).setSymbolColorExpression(`vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * getBlurSlope()) * ${l})`).setStrokeColorExpression(`vec4(smoothstep(0., 1., (1. - length(currentRadiusPx * 2. / v_width)) * getBlurSlope()) * ${l})`).setStrokeWidthExpression(`(${i} + ${s}) * 2.`).setFillColorExpression(`vec4(${l})`).setFragmentDiscardExpression(`!${r}`),Qj(e,t);const c=tF(t),h=eF(t,this.styleVariables_);return new dX(this,{className:this.getClassName(),variables:this.styleVariables_,style:{builder:e,attributes:{...c,...o},uniforms:{...h,...a}},disableHitDetection:!1,postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}renderDeclutter(){}}function mX(n){const r=Kr(1,256),i=r.createLinearGradient(0,0,1,256),s=1/(n.length-1);for(let a=0,o=n.length;a<o;++a)i.addColorStop(a*s,n[a]);return r.fillStyle=i,r.fillRect(0,0,1,256),r.canvas}class pX extends IA{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,s=i.resolution,a=this.getLayer().getSource(),o=e.viewHints;let l=e.extent;if(t.extent!==void 0&&(l=Va(l,Oa(t.extent,i.projection))),!o[Qr.ANIMATING]&&!o[Qr.INTERACTING]&&!Id(l))if(a){const c=i.projection,h=a.getImage(l,s,r,c);h&&(this.loadImage(h)?this.image=h:h.getState()===bt.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=Cr(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!rc(s,i))return null;const a=this.image.getExtent(),o=this.image.getImage(),l=mn(a),c=Math.floor(o.width*((i[0]-a[0])/l));if(c<0||c>=o.width)return null;const h=ti(a),g=Math.floor(o.height*((a[3]-i[1])/h));return g<0||g>=o.height?null:this.getImageData(o,c,g)}renderFrame(e,t){const r=this.image,i=r.getExtent(),s=r.getResolution(),[a,o]=Array.isArray(s)?s:[s,s],l=r.getPixelRatio(),c=e.layerStatesArray[e.layerIndex],h=e.pixelRatio,g=e.viewState,m=g.center,x=g.resolution,y=h*a/(x*l),_=h*o/(x*l);this.prepareContainer(e,t);const w=this.context.canvas.width,T=this.context.canvas.height,b=this.getRenderContext(e);let R=!1,M=!0;if(c.extent){const C=Oa(c.extent,g.projection);M=Es(C,e.extent),R=M&&!cu(C,e.extent),R&&this.clipUnrotated(b,e,C)}const D=r.getImage(),B=$a(this.tempTransform,w/2,T/2,y,_,0,l*(i[0]-m[0])/a,l*(m[1]-i[3])/o);this.renderedResolution=o*h/l;const k=D.width*B[0],A=D.height*B[3];if(this.getLayer().getSource().getInterpolate()||(b.imageSmoothingEnabled=!1),this.preRender(b,e),M&&k>=.5&&A>=.5){const C=B[4],O=B[5],P=c.opacity;P!==1&&(b.save(),b.globalAlpha=P),b.drawImage(D,0,0,+D.width,+D.height,C,O,k,A),P!==1&&b.restore()}return this.postRender(this.context,e),R&&b.restore(),b.imageSmoothingEnabled=!0,this.container}}class xX extends P1{constructor(e){e=e||{},super(e)}}class yX extends xX{constructor(e){super(e)}createRenderer(){return new pX(this)}getData(e){return super.getData(e)}}function YS(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const r=n[t],i=r.has(e);return i||r.add(e),!i}function _X(n,e,t){const r=n[t];return r?r.delete(e):!1}function hM(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Va(e,Oa(t.extent,n.viewState.projection)));const r=t.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(n.viewState.projection).getExtent();i&&(e=Va(e,i))}return e}class vX extends IA{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=$s(),this.tempTileRange_=new zw(0,0,0,0),this.tempTileCoord_=F0(0,0,0);const r=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new bb(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new bb(512)),this.sourceTileCache_}getOrCreateTile(e,t,r,i){const s=this.tileCache_,o=this.getLayer().getSource(),l=c_(o,o.getKey(),e,t,r);let c;if(s.containsKey(l))c=s.get(l);else{const h=i.viewState.projection,g=o.getProjection();if(c=o.getTile(e,t,r,i.pixelRatio,h,!g||Zh(g,h)?void 0:this.getSourceTileCache()),!c)return null;s.set(l,c)}return c}getTile(e,t,r,i){const s=this.getOrCreateTile(e,t,r,i);return s||null}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=Cr(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!rc(s,i))return null;const a=t.viewState,o=r.getRenderSource(),l=o.getTileGridForProjection(a.projection),c=o.getTilePixelRatio(t.pixelRatio);for(let h=l.getZForResolution(a.resolution);h>=l.getMinZoom();--h){const g=l.getTileCoordForCoordAndZ(i,h),m=this.getTile(h,g[1],g[2],t);if(!m||m.getState()!==Lt.LOADED)continue;const x=l.getOrigin(h),y=ki(l.getTileSize(h)),_=l.getResolution(h);let w;if(m instanceof Gw||m instanceof zA)w=m.getImage();else if(m instanceof Tb){if(w=Mp(m.getData()),!w)continue}else continue;const T=Math.floor(c*((i[0]-x[0])/_-g[1]*y[0])),b=Math.floor(c*((x[1]-i[1])/_-g[2]*y[1])),R=Math.round(c*o.getGutterForProjection(a.projection));return this.getImageData(w,T+R,b+R)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const r=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,r,i,s){const a=e.viewState,o=this.getLayer(),l=o.getRenderSource(),c=l.getTileGridForProjection(a.projection),h=Gt(l);h in e.wantedTiles||(e.wantedTiles[h]={});const g=e.wantedTiles[h],m=o.getMapInternal(),x=Math.max(r-s,c.getMinZoom(),c.getZForResolution(Math.min(o.getMaxResolution(),m?m.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),y=a.rotation,_=y?sA(a.center,a.resolution,y,e.size):void 0;for(let w=r;w>=x;--w){const T=c.getTileRangeForExtentAndZ(t,w,this.tempTileRange_),b=c.getResolution(w);for(let R=T.minX;R<=T.maxX;++R)for(let M=T.minY;M<=T.maxY;++M){if(y&&!c.tileCoordIntersectsViewport([w,R,M],_))continue;const D=this.getTile(w,R,M,e);if(!D||!YS(i,D,w))continue;const k=D.getKey();if(g[k]=!0,D.getState()===Lt.IDLE&&!e.tileQueue.isKeyQueued(k)){const A=F0(w,R,M,this.tempTileCoord_);e.tileQueue.enqueue([D,h,c.getTileCoordCenter(A),b])}}}}findStaleTile_(e,t){const r=this.tileCache_,i=e[0],s=e[1],a=e[2],o=this.getStaleKeys();for(let l=0;l<o.length;++l){const c=c_(this.getLayer().getSource(),o[l],i,s,a);if(r.containsKey(c)){const h=r.peek(c);if(h.getState()===Lt.LOADED)return h.endTransition(Gt(this)),YS(t,h,i),!0}}return!1}findAltTiles_(e,t,r,i){const s=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!s)return!1;let a=!0;const o=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let g=s.minY;g<=s.maxY;++g){const m=c_(l,c,r,h,g);let x=!1;if(o.containsKey(m)){const y=o.peek(m);y.getState()===Lt.LOADED&&(YS(i,y,r),x=!0)}x||(a=!1)}return a}renderFrame(e,t){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,s=i.projection,a=i.resolution,o=i.center,l=e.pixelRatio,c=this.getLayer(),h=c.getSource(),g=h.getTileGridForProjection(s),m=g.getZForResolution(a,h.zDirection),x=g.getResolution(m),y=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==y&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=y):this.renderedSourceKey_=y;let _=e.extent;const w=h.getTilePixelRatio(l);this.prepareContainer(e,t);const T=this.context.canvas.width,b=this.context.canvas.height,R=r.extent&&Oa(r.extent);R&&(_=Va(_,Oa(r.extent)));const M=x*T/2/w,D=x*b/2/w,B=[o[0]-M,o[1]-D,o[0]+M,o[1]+D],k={};this.renderedTiles.length=0;const A=c.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const ue=g.getZForResolution(i.nextResolution,h.zDirection),ke=hM(e,e.nextExtent);this.enqueueTiles(e,ke,ue,k,A)}const C=hM(e,_);if(this.enqueueTiles(e,C,m,k,0),A>0&&setTimeout(()=>{this.enqueueTiles(e,C,m-1,k,A-1)},0),!(m in k))return this.container;const O=Gt(this),P=e.time;for(const ue of k[m]){const ke=ue.getState();if(ke===Lt.EMPTY)continue;const ae=ue.tileCoord;if(ke===Lt.LOADED&&ue.getAlpha(O,P)===1){ue.endTransition(O);continue}if(ke!==Lt.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ae,k)){_X(k,ue,m),e.animate=!0;continue}if(this.findAltTiles_(g,ae,m+1,k))continue;const Q=g.getMinZoom();for(let ee=m-1;ee>=Q&&!this.findAltTiles_(g,ae,ee,k);--ee);}const z=x/a*l/w,F=this.getRenderContext(e);$a(this.tempTransform,T/2,b/2,z,z,0,-T/2,-b/2),r.extent&&this.clipUnrotated(F,e,R),h.getInterpolate()||(F.imageSmoothingEnabled=!1),this.preRender(F,e);const xe=Object.keys(k).map(Number);xe.sort(Xl);let Ce;const Ge=[],Ne=[];for(let ue=xe.length-1;ue>=0;--ue){const ke=xe[ue],ae=h.getTilePixelSize(ke,l,s),V=g.getResolution(ke)/x,Q=ae[0]*V*z,ee=ae[1]*V*z,re=g.getTileCoordForCoordAndZ(kd(B),ke),he=g.getTileCoordExtent(re),Ve=Cr(this.tempTransform,[w*(he[0]-B[0])/x,w*(B[3]-he[3])/x]),Be=w*h.getGutterForProjection(s);for(const ye of k[ke]){if(ye.getState()!==Lt.LOADED)continue;const pe=ye.tileCoord,Fe=re[1]-pe[1],Et=Math.round(Ve[0]-(Fe-1)*Q),Ft=re[2]-pe[2],Dt=Math.round(Ve[1]-(Ft-1)*ee),Xt=Math.round(Ve[0]-Fe*Q),en=Math.round(Ve[1]-Ft*ee),ot=Et-Xt,tr=Dt-en,dn=xe.length===1;let un=!1;Ce=[Xt,en,Xt+ot,en,Xt+ot,en+tr,Xt,en+tr];for(let sr=0,Mi=Ge.length;sr<Mi;++sr)if(!dn&&ke<Ne[sr]){const Bn=Ge[sr];Es([Xt,en,Xt+ot,en+tr],[Bn[0],Bn[3],Bn[4],Bn[7]])&&(un||(F.save(),un=!0),F.beginPath(),F.moveTo(Ce[0],Ce[1]),F.lineTo(Ce[2],Ce[3]),F.lineTo(Ce[4],Ce[5]),F.lineTo(Ce[6],Ce[7]),F.moveTo(Bn[6],Bn[7]),F.lineTo(Bn[4],Bn[5]),F.lineTo(Bn[2],Bn[3]),F.lineTo(Bn[0],Bn[1]),F.clip())}Ge.push(Ce),Ne.push(ke),this.drawTile(ye,e,Xt,en,ot,tr,Be,dn),un&&F.restore(),this.renderedTiles.unshift(ye),this.updateUsedTiles(e.usedTiles,h,ye)}}if(this.renderedResolution=x,this.extentChanged=!this.renderedExtent_||!sd(this.renderedExtent_,B),this.renderedExtent_=B,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&F.restore(),F.imageSmoothingEnabled=!0,this.renderComplete){const ue=(ke,ae)=>{const Z=Gt(h),V=ae.wantedTiles[Z],Q=V?Object.keys(V).length:0;this.updateCacheSize(Q),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(ue)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,r,i,s,a,o,l){let c;if(e instanceof Tb){if(c=Mp(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;const h=this.getRenderContext(t),g=Gt(this),m=t.layerStatesArray[t.layerIndex],x=m.opacity*(l?e.getAlpha(g,t.time):1),y=x!==h.globalAlpha;y&&(h.save(),h.globalAlpha=x),h.drawImage(c,o,o,c.width-2*o,c.height-2*o,r,i,s,a),y&&h.restore(),x!==m.opacity?t.animate=!0:l&&e.endTransition(g)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,r){const i=Gt(t);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const Py={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class wX extends P1{constructor(e){e=e||{};const t=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Py.PRELOAD)}setPreload(e){this.set(Py.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Py.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Py.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Rh extends wX{constructor(e){super(e)}createRenderer(){return new vX(this,{cacheSize:this.getCacheSize()})}}function Ib(n){return Array.isArray(n)?Math.min(...n):n}const Pf=[0,0,0],Xc=5;class iF{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Rn(GU(this.resolutions_,(i,s)=>s-i),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!t)t=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Rn(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=kd(r)),Rn(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Rn(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:jA,Rn(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,s)=>{const a=new zw(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const o=this.getTileRangeForExtentAndZ(r,s);a.minX=Math.max(o.minX,a.minX),a.maxX=Math.min(o.maxX,a.maxX),a.minY=Math.max(o.minY,a.minY),a.maxY=Math.min(o.maxY,a.maxY)}return a}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,t,r){const i=this.getTileRangeForExtentAndZ(e,t);for(let s=i.minX,a=i.maxX;s<=a;++s)for(let o=i.minY,l=i.maxY;o<=l;++o)r([t,s,o])}forEachTileCoordParentTileRange(e,t,r,i){let s,a,o,l=null,c=e[0]-1;for(this.zoomFactor_===2?(a=e[1],o=e[2]):l=this.getTileCoordExtent(e,i);c>=this.minZoom;){if(a!==void 0&&o!==void 0?(a=Math.floor(a/2),o=Math.floor(o/2),s=Af(a,a,o,o,r)):s=this.getTileRangeForExtentAndZ(l,c,r),t(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,a=e[2]*2;return Af(s,s+1,a,a+1,t)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,r){if(t>this.maxZoom||t<this.minZoom)return null;const i=e[0],s=e[1],a=e[2];if(t===i)return Af(s,a,s,a,r);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-i),c=Math.floor(s*l),h=Math.floor(a*l);if(t<i)return Af(c,c,h,h,r);const g=Math.floor(l*(s+1))-1,m=Math.floor(l*(a+1))-1;return Af(c,g,h,m,r)}const o=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t,r)}getTileRangeForExtentAndZ(e,t,r){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Pf);const i=Pf[1],s=Pf[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Pf);const a=Pf[1],o=Pf[2];return Af(i,a,s,o,r)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=ki(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*r,t[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,t){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=ki(this.getTileSize(e[0]),this.tmpSize_),a=r[0]+e[1]*s[0]*i,o=r[1]-(e[2]+1)*s[1]*i,l=a+s[0]*i,c=o+s[1]*i;return Pu(a,o,l,c,t)}getTileCoordForCoordAndResolution(e,t,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r)}getTileCoordForXYAndResolution_(e,t,r,i,s){const a=this.getZForResolution(r),o=r/this.getResolution(a),l=this.getOrigin(a),c=ki(this.getTileSize(a),this.tmpSize_);let h=o*(e-l[0])/r/c[0],g=o*(l[1]-t)/r/c[1];return i?(h=uu(h,Xc)-1,g=uu(g,Xc)-1):(h=vy(h,Xc),g=vy(g,Xc)),F0(a,h,g,s)}getTileCoordForXYAndZ_(e,t,r,i,s){const a=this.getOrigin(r),o=this.getResolution(r),l=ki(this.getTileSize(r),this.tmpSize_);let c=(e-a[0])/o/l[0],h=(a[1]-t)/o/l[1];return i?(c=uu(c,Xc)-1,h=uu(h,Xc)-1):(c=vy(c,Xc),h=vy(h,Xc)),F0(r,c,h,s)}getTileCoordForCoordAndZ(e,t,r){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const r=vw(this.resolutions_,e,t||0);return ur(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return ej(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,r=new Array(t);for(let i=this.minZoom;i<t;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function sF(n){let e=n.getDefaultTileGrid();return e||(e=bX(n),n.setDefaultTileGrid(e)),e}function EX(n,e,t){const r=e[0],i=n.getTileCoordCenter(e),s=ZA(t);if(!rc(s,i)){const a=mn(s),o=Math.ceil((s[0]-i[0])/a);return i[0]+=a*o,n.getTileCoordForCoordAndZ(i,r)}return e}function SX(n,e,t,r){r=r!==void 0?r:"top-left";const i=aF(n,e,t);return new iF({extent:n,origin:HU(n,r),resolutions:i,tileSize:t})}function TX(n){const e=n||{},t=e.extent||ir("EPSG:3857").getExtent(),r={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:aF(t,e.maxZoom,e.tileSize,e.maxResolution)};return new iF(r)}function aF(n,e,t,r){e=e!==void 0?e:tK,t=ki(t!==void 0?t:jA);const i=ti(n),s=mn(n);r=r>0?r:Math.max(s/t[0],i/t[1]);const a=e+1,o=new Array(a);for(let l=0;l<a;++l)o[l]=r/Math.pow(2,l);return o}function bX(n,e,t,r){const i=ZA(n);return SX(i,e,t,r)}function ZA(n){n=ir(n);let e=n.getExtent();if(!e){const t=180*L0.degrees/n.getMetersPerUnit();e=Pu(-t,-t,t,t)}return e}function JA(n,e){const t=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&t.push(i+"="+encodeURIComponent(e[i]))});const r=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+r}const RX=/\{z\}/g,AX=/\{x\}/g,kX=/\{y\}/g,IX=/\{-y\}/g;function CX(n,e,t,r,i){return n.replace(RX,e.toString()).replace(AX,t.toString()).replace(kX,r.toString()).replace(IX,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function PX(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const r=t[1].charCodeAt(0),i=t[2].charCodeAt(0);let s;for(s=r;s<=i;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const r=parseInt(t[2],10);for(let i=parseInt(t[1],10);i<=r;i++)e.push(n.replace(t[0],i.toString()));return e}return e.push(n),e}function NX(n,e){return(function(t,r,i){if(!t)return;let s;const a=t[0];if(e){const o=e.getFullTileRange(a);o&&(s=o.getHeight()-1)}return CX(n,a,t[1],t[2],s)})}function MX(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=NX(n[i],e);return LX(r)}function LX(n){return n.length===1?n[0]:(function(e,t,r){if(!e)return;const i=qj(e),s=wu(i,n.length);return n[s](e,t,r)})}class OX extends kA{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&ki(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||Gt(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,r,i,s,a){return Wt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:sF(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,r){const i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(t),a=ki(i.getTileSize(e),this.tmpSize);return s==1?a:UW(a,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const r=t!==void 0?t:this.getProjection(),i=t!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=EX(i,e,r)),CK(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class DX extends yl{constructor(e,t){super(e),this.tile=t}}const ZS={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class QA extends OX{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===QA.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,r=Gt(t),i=t.getState();let s;i==Lt.LOADING?(this.tileLoadingKeys_[r]=!0,s=ZS.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],s=i==Lt.ERROR?ZS.TILELOADERROR:i==Lt.LOADED?ZS.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new DX(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=PX(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(MX(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,r){}}class oF extends QA{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:lF,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:Gw,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Zh(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Zh(t,e)))return this.tileGrid;const r=Gt(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=sF(e)),this.tileGridForProjection[r]}createTile_(e,t,r,i,s,a){const o=[e,t,r],l=this.getTileCoordForTileUrlFunction(o,s),c=l?this.tileUrlFunction(l,i,s):void 0,h=new this.tileClass(o,c!==void 0?Lt.IDLE:Lt.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=a,h.addEventListener(Kt.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,t,r,i,s,a){const o=this.getProjection();if(!o||!s||Zh(o,s))return this.getTileInternal(e,t,r,i,o||s);const l=[e,t,r],c=this.getKey(),h=this.getTileGridForProjection(o),g=this.getTileGridForProjection(s),m=this.getTileCoordForTileUrlFunction(l,s),x=new zA(o,h,s,g,l,m,this.getTilePixelRatio(i),this.getGutter(),(y,_,w,T)=>this.getTileInternal(y,_,w,T,o,a),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return x.key=c,x}getTileInternal(e,t,r,i,s,a){const o=this.getKey(),l=c_(this,o,e,t,r);if(a&&a.containsKey(l))return a.get(l);const c=this.createTile_(e,t,r,i,s,o);return a?.set(l,c),c}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const r=ir(e);if(r){const i=Gt(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=t)}}}function lF(n,e){if(da){const t=n.getCrossOrigin();let r="same-origin",i="same-origin";t==="anonymous"||t===""?(r="cors",i="omit"):t==="use-credentials"&&(r="cors",i="include"),fetch(e,{mode:r,credentials:i}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const a=n.getImage();a.width=s.width,a.height=s.height,a.getContext("2d").drawImage(s,0,0),s.close?.(),a.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Kf extends oF{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:TX({extent:ZA(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const jX="modulepreload",FX=function(n){return"/detectorapp-nl/"+n},dM={},yt=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let l=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");i=l(t.map(c=>{if(c=FX(c),c in dM)return;dM[c]=!0;const h=c.endsWith(".css"),g=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${g}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":jX,h||(m.as="script"),m.crossOrigin="",m.href=c,o&&m.setAttribute("nonce",o),document.head.appendChild(m),h)return new Promise((x,y)=>{m.addEventListener("load",x),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};class VX extends cj{constructor(e,t,r,i,s,a,o){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let c=t.getExtent();c&&t.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);const h=c?Va(r,c):r,g=dl(h),m=ev(e,t,g,i),x=Hj,y=new Wj(e,t,h,l,m*x,i),_=y.calculateSourceExtent(),w=Id(_)?null:a(_,m,s),T=w?bt.IDLE:bt.EMPTY,b=w?w.getPixelRatio():1;super(r,i,b,T),this.targetProj_=t,this.maxSourceExtent_=l,this.triangulation_=y,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=w,this.sourcePixelRatio_=b,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==bt.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==bt.LOADED){const t=mn(this.targetExtent_)/this.targetResolution_,r=ti(this.targetExtent_)/this.targetResolution_;this.canvas_=$j(t,r,this.sourcePixelRatio_,Ib(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==bt.IDLE){this.state=bt.LOADING,this.changed();const e=this.sourceImage_.getState();e==bt.LOADED||e==bt.ERROR?this.reproject_():(this.sourceListenerKey_=gn(this.sourceImage_,Kt.CHANGE,t=>{const r=this.sourceImage_.getState();(r==bt.LOADED||r==bt.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){or(this.sourceListenerKey_),this.sourceListenerKey_=null}}const gu=4,JS={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class BX extends yl{constructor(e,t){super(e),this.image=t}}class GX extends kA{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const r=vw(t,e,0);e=t[r]}return e}getImage(e,t,r,i){const s=this.getProjection();if(!s||!i||Zh(s,i))return s&&(i=s),this.getImageInternal(e,t,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Zh(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==t&&sd(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new VX(s,i,e,t,r,(a,o,l)=>this.getImageInternal(a,o,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,r,i){if(this.loader){const s=cF(e,t,r,1),a=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&cu(this.wantedExtent_,s)||cu(this.image.getExtent(),s))&&(this.wantedResolution_&&Ib(this.wantedResolution_)===a||Ib(this.image.getResolution())===a)))return this.image;this.wantedProjection_=i,this.wantedExtent_=s,this.wantedResolution_=a,this.image=new cj(s,a,r,this.loader),this.image.addEventListener(Kt.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let r;switch(t.getState()){case bt.LOADING:this.loading=!0,r=JS.IMAGELOADSTART;break;case bt.LOADED:this.loading=!1,r=JS.IMAGELOADEND;break;case bt.ERROR:this.loading=!1,r=JS.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new BX(r,t))}}function zX(n,e){n.getImage().src=e}function cF(n,e,t,r){const i=e/t,s=dl(n),a=uu(mn(n)/i,gu),o=uu(ti(n)/i,gu),l=uu((r-1)*a/2,gu),c=a+2*l,h=uu((r-1)*o/2,gu),g=o+2*h;return j_(s,i,0,[c,g])}function UX(n,e,t,r,i,s){const a=i.getCode().split(/:(?=\d+$)/).pop(),o=t/r,l=[F_(mn(e)/o,gu),F_(ti(e)/o,gu)];s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=a,s.IMAGESR=a,s.DPI=Math.round(s.DPI?s.DPI*r:90*r);const c=n.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return JA(c,s)}function $X(n){const e=n.load?n.load:hj,t=ir(n.projection||"EPSG:3857"),r=n.ratio??1.5,i=n.crossOrigin??null;return function(s,a,o){o=n.hidpi?o:1;const l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(l,n.params),s=cF(s,a,o,r);const c=UX(n.url,s,a,o,t,l),h=new Image;return h.crossOrigin=i,e(h,c).then(g=>{const m=mn(s)/g.width*o;return{image:g,extent:s,resolution:m,pixelRatio:o}})}}class WX extends GX{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:zX,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,t,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=$X({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,a)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,a),hj(s))})),super.getImageInternal(e,t,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const Cb="1.3.0";function HX(n,e,t,r,i){i.WIDTH=t[0],i.HEIGHT=t[1];const s=r.getAxisOrientation(),a=jD(i.VERSION,"1.3")>=0;i[a?"CRS":"SRS"]=r.getCode();const o=a&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=o.join(","),JA(n,i)}function KX(n,e,t,r,i,s,a){s=Object.assign({REQUEST:"GetMap"},s);const o=e/t,l=[F_(mn(n)/o,gu),F_(ti(n)/o,gu)];if(t!=1)switch(a){case"geoserver":const h=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+h:s.FORMAT_OPTIONS="dpi:"+h;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return HX(i,n,l,r,s)}function fM(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:Cb,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const XX='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class qX extends Kf{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[XX];const r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",i=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,a)=>{const o=s.getImage();!da&&o instanceof HTMLImageElement&&(o.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||lF)(s,a)},transition:e.transition,url:i,wrapX:e.wrapX,zDirection:e.zDirection})}}const rv=1/0;class YX{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,lg(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,r=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){Rn(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=rv?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,r=this.priorities_,i=t.length,s=t[e],a=r[e],o=e;for(;e<i>>1;){const l=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),h=c<i&&r[c]<r[l]?c:l;t[e]=t[h],r[e]=r[h],e=h}t[e]=s,r[e]=a,this.siftDown_(o,e)}siftDown_(e,t){const r=this.elements_,i=this.priorities_,s=r[t],a=i[t];for(;t>e;){const o=this.getParentIndex_(t);if(i[o]>a)r[t]=r[o],i[t]=i[o],t=o;else break}r[t]=s,i[t]=a}reprioritize(){const e=this.priorityFunction_,t=this.elements_,r=this.priorities_;let i=0;const s=t.length;let a,o,l;for(o=0;o<s;++o)a=t[o],l=e(a),l==rv?delete this.queuedElements_[this.keyFunction_(a)]:(r[i]=l,t[i++]=a);t.length=i,r.length=i,this.heapify_()}}class ZX extends YX{constructor(e,t){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Kt.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,r=t.getState();if(r===Lt.LOADED||r===Lt.ERROR||r===Lt.EMPTY){r!==Lt.ERROR&&t.removeEventListener(Kt.CHANGE,this.boundHandleTileChange_);const i=t.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let r=0;for(;this.tilesLoading_<e&&r<t&&this.getCount()>0;){const i=this.dequeue()[0],s=i.getKey();i.getState()===Lt.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++r,i.load())}}}function JX(n,e,t,r,i){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return rv;const s=n.viewState.center,a=r[0]-s[0],o=r[1]-s[1];return 65536*Math.log(i)+Math.sqrt(a*a+o*o)/i}class QX extends oF{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=$s(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,r,i){const s=ir(r),a=this.getProjection()||s;let o=this.getTileGrid();o||(o=this.getTileGridForProjection(a));const l=b1(e,s,a),c=ev(a,s,e,t),h=o.getZForResolution(c,this.zDirection),g=o.getResolution(h),m=o.getTileCoordForCoordAndZ(l,h);if(o.getResolutions().length<=m[0])return;let x=o.getTileCoordExtent(m,this.tmpExtent_);const y=this.gutter_;y!==0&&(x=M0(x,g*y,x));const _={QUERY_LAYERS:this.params_.LAYERS};Object.assign(_,fM(this.params_,"GetFeatureInfo"),i);const w=Math.floor((l[0]-x[0])/g),T=Math.floor((x[3]-l[1])/g);return _[this.v13_?"I":"X"]=w,_[this.v13_?"J":"Y"]=T,this.getRequestUrl_(m,x,1,a||s,_)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const r={SERVICE:"WMS",VERSION:Cb,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;r.LAYER=i}if(e!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;r.SCALE=e*i/s}return Object.assign(r,t),JA(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,r,i,s){const a=this.urls;if(!a)return;let o;if(a.length==1)o=a[0];else{const l=wu(qj(e),a.length);o=a[l]}return KX(t,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,o,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const r in this.params_)t[e++]=r+"-"+this.params_[r];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||Cb;this.v13_=jD(e,"1.3")>=0}tileUrlFunction(e,t,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=i.getResolution(e[0]);let a=i.getTileCoordExtent(e,this.tmpExtent_);const o=this.gutter_;o!==0&&(a=M0(a,s*o,a));const l=Object.assign({},fM(this.params_,"GetMap"));return this.getRequestUrl_(e,a,t,r,l)}}class Xf extends yl{constructor(e,t,r){super(e),this.map=t,this.frameState=r!==void 0?r:null}}class eu extends Xf{constructor(e,t,r,i,s,a){super(e,t,s),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=a}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Or={SINGLECLICK:"singleclick",CLICK:Kt.CLICK,DBLCLICK:Kt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Pb={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class eq extends cg{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=gn(r,Pb.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=gn(r,Pb.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Kt.TOUCHMOVE,this.boundHandleTouchMove_,aj?{passive:!1}:!1)}emulateClick_(e){let t=new eu(Or.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new eu(Or.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new eu(Or.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const t=e,r=t.pointerId;if(t.type==Or.POINTERUP||t.type==Or.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==t.target){delete this.trackedTouches_[i];break}}else(t.type==Or.POINTERDOWN||t.type==Or.POINTERMOVE)&&(this.trackedTouches_[r]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new eu(Or.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(or),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new eu(Or.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(gn(r,Or.POINTERMOVE,this.handlePointerMove_,this),gn(r,Or.POINTERUP,this.handlePointerUp_,this),gn(this.element_,Or.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(gn(this.element_.getRootNode(),Or.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new eu(Or.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new eu(Or.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(or(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Kt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(or(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(or),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const tu={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},is={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Ww extends _l{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,r=this.listenerKeys.length;t<r;++t)or(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==wp&&this.listenerKeys.push(gn(e,tu.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class tq extends Ww{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",a=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=a):this.collapseLabel_=s;const o=e.label!==void 0?e.label:"i";typeof o=="string"?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=i):this.label_=o;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(Kt.CLICK,this.handleClick_.bind(this),!1);const c=t+" "+A1+" "+TA+(this.collapsed_&&this.collapsible_?" "+wN:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=c,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),r=new Set(t.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(i=>kD(()=>i))),r=t.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!gc(t,this.renderedAttributions_)){Z$(this.ulElement_);for(let i=0,s=t.length;i<s;++i){const a=document.createElement("li");a.innerHTML=t[i],this.ulElement_.appendChild(a)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(wN),this.collapsed_?_N(this.collapseLabel_,this.label_):_N(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class nq extends Ww{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const s=e.tipLabel?e.tipLabel:"Reset rotation",a=document.createElement("button");a.className=t+"-reset",a.setAttribute("type","button"),a.title=s,a.appendChild(this.label_),a.addEventListener(Kt.CLICK,this.handleClick_.bind(this),!1);const o=t+" "+A1+" "+TA,l=this.element;l.className=o,l.appendChild(a),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Sy)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const r=t.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:ug}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const r=t.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Sy);!s&&r===0?this.element.classList.add(Sy):s&&r!==0&&this.element.classList.remove(Sy)}this.label_.style.transform=i}this.rotation_=r}}class rq extends Ww{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",a=e.zoomInLabel!==void 0?e.zoomInLabel:"+",o=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",c=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(Kt.CLICK,this.handleClick_.bind(this,r),!1);const g=document.createElement("button");g.className=s,g.setAttribute("type","button"),g.title=c,g.appendChild(typeof o=="string"?document.createTextNode(o):o),g.addEventListener(Kt.CLICK,this.handleClick_.bind(this,-r),!1);const m=t+" "+A1+" "+TA,x=this.element;x.className=m,x.appendChild(h),x.appendChild(g),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const s=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:ug})):r.setZoom(s)}}}function iq(n){n=n||{};const e=new La;return(n.zoom===void 0||n.zoom)&&e.push(new rq(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new nq(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new tq(n.attributionOptions)),e}class sq{constructor(e,t,r){this.decay_=e,this.minVelocity_=t,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let r=t-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[t+2]-this.points_[r+2];if(i<1e3/60)return!1;const s=this.points_[t]-this.points_[r],a=this.points_[t+1]-this.points_[r+1];return this.angle_=Math.atan2(a,s),this.initialVelocity_=Math.sqrt(s*s+a*a)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const gM={ACTIVE:"active"};class N1 extends _l{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(gM.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(gM.ACTIVE,e)}setMap(e){this.map_=e}}function aq(n,e,t){const r=n.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:YH,center:n.getConstrainedCenter(i)})}}function ek(n,e,t,r){const i=n.getZoom();if(i===void 0)return;const s=n.getConstrainedZoom(i+e),a=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:a,anchor:t,duration:r!==void 0?r:250,easing:ug})}class oq extends N1{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Or.DBLCLICK){const r=e.originalEvent,i=e.map,s=e.coordinate,a=r.shiftKey?-this.delta_:this.delta_,o=i.getView();ek(o,a,s,this.duration_),r.preventDefault(),t=!0}return!t}}function Nb(n){const e=arguments;return function(t){let r=!0;for(let i=0,s=e.length;i<s&&(r=r&&e[i](t),!!r);++i);return r}}const lq=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},cq=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),r=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(r):e.contains(r)},uF=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?cq(n):!0},uq=vp,hF=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(q$&&ij&&e.ctrlKey)},dF=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},hq=function(n){const e=n.originalEvent;return ij?e.metaKey:e.ctrlKey},dq=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},fF=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},QS=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},fq=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class M1 extends N1{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Or.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Or.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==Or.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==Or.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function tk(n){const e=n.length;let t=0,r=0;for(let i=0;i<e;i++)t+=n[i].clientX,r+=n[i].clientY;return{clientX:t/e,clientY:r/e}}class gq extends M1{constructor(e){super({stopDown:ww}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:Nb(dF,fq);this.condition_=e.onFocusOnly?Nb(uF,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const r=this.targetPointers,i=t.getEventPixel(tk(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=e.map.getView();JU(s,o.getResolution()),aA(s,o.getRotation()),o.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,r=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),a=r.getCenterInternal(),o=t.getPixelFromCoordinateInternal(a),l=t.getCoordinateFromPixelInternal([o[0]-i*Math.cos(s),o[1]-i*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:ug})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class mq extends M1{constructor(e){e=e||{},super({stopDown:ww}),this.condition_=e.condition?e.condition:lq,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!QS(e))return;const t=e.map,r=t.getView();if(r.getConstraints().rotation===DA)return;const i=t.getSize(),s=e.pixel,a=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){const o=a-this.lastAngle_;r.adjustRotationInternal(-o)}this.lastAngle_=a}handleUpEvent(e){return QS(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return QS(e)&&hF(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class pq extends v1{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],t[0])+r,i.top=Math.min(e[1],t[1])+r,i.width=Math.abs(t[0]-e[0])+r,i.height=Math.abs(t[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Ha([i])}getGeometry(){return this.geometry_}}const Nf={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class gm extends yl{constructor(e,t,r){super(e),this.coordinate=t,this.mapBrowserEvent=r}}class xq extends M1{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new pq(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??hF,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,r){const i=r[0]-t[0],s=r[1]-t[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new gm(Nf.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new gm(t?Nf.BOXEND:Nf.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new gm(Nf.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new gm(Nf.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new gm(Nf.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class yq extends xq{constructor(e){e=e||{};const t=e.condition?e.condition:dq;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=r.rotatedExtentForGeometry(i),a=r.getResolutionForExtentInternal(s),o=r.getResolution()/a;i=i.clone(),i.scale(o*o)}r.fitInternal(i,{duration:this.duration_,easing:ug})}}const wh={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class _q extends N1{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return dF(t)&&fF(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Kt.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==wh.DOWN||i==wh.LEFT||i==wh.RIGHT||i==wh.UP)){const a=e.map.getView(),o=a.getResolution()*this.pixelDelta_;let l=0,c=0;i==wh.DOWN?c=-o:i==wh.LEFT?l=-o:i==wh.RIGHT?l=o:c=o;const h=[l,c];aA(h,a.getRotation()),aq(a,h,this.duration_),r.preventDefault(),t=!0}}return!t}}class vq extends N1{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!hq(t)&&fF(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Kt.KEYDOWN||e.type==Kt.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const s=e.map,a=i==="+"?this.delta_:-this.delta_,o=s.getView();ek(o,a,void 0,this.duration_),r.preventDefault(),t=!0}}return!t}}const wq=40,Eq=300;class Sq extends N1{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:uq;this.condition_=e.onFocusOnly?Nb(uF,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Kt.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=wq;break;case WheelEvent.DOM_DELTA_PAGE:s*=Eq;break}if(s===0)return!1;this.lastDelta_=s;const a=Date.now();this.startTime_===void 0&&(this.startTime_=a),(!this.mode_||a-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const o=r.getView();if(this.mode_==="trackpad"&&!(o.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=a,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(a-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let r=-ur(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),ek(t,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class Tq extends M1{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=ww),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const r=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const a=e.map,o=a.getView();o.getConstraints().rotation!==DA&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(tk(this.targetPointers))),this.rotating_&&(a.render(),o.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class bq extends M1{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=ww),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const r=this.targetPointers[0],i=this.targetPointers[1],s=r.clientX-i.clientX,a=r.clientY-i.clientY,o=Math.sqrt(s*s+a*a);this.lastDistance_!==void 0&&(t=this.lastDistance_/o),this.lastDistance_=o;const l=e.map,c=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(tk(this.targetPointers))),l.render(),c.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function Rq(n){n=n||{};const e=new La,t=new sq(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new mq),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new oq({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new gq({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new Tq),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new bq({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new _q),e.push(new vq({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new Sq({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new yq({duration:n.zoomDuration})),e}class Aq extends v1{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){Wt()}calculateMatrices2D(e){const t=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;$a(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),Sp(i,r)}forEachFeatureAtCoordinate(e,t,r,i,s,a,o,l){let c;const h=t.viewState;function g(M,D,B,k){return s.call(a,D,M?B:null,k)}const m=h.projection,x=FD(e.slice(),m),y=[[0,0]];if(m.canWrapX()&&i){const M=m.getExtent(),D=mn(M);y.push([-D,0],[D,0])}const _=t.layerStatesArray,w=_.length,T=[],b=[];for(let M=0;M<y.length;M++)for(let D=w-1;D>=0;--D){const B=_[D],k=B.layer;if(k.hasRenderer()&&FA(B,h)&&o.call(l,k)){const A=k.getRenderer(),C=k.getSource();if(A&&C){const O=C.getWrapX()?x:e,P=g.bind(null,B.managed);b[0]=O[0]+y[M][0],b[1]=O[1]+y[M][1],c=A.forEachFeatureAtCoordinate(b,t,r,P,T)}if(c)return c}}if(T.length===0)return;const R=1/T.length;return T.forEach((M,D)=>M.distanceSq+=D*R),T.sort((M,D)=>M.distanceSq-D.distanceSq),T.some(M=>c=M.callback(M.feature,M.layer,M.geometry)),c}hasFeatureAtCoordinate(e,t,r,i,s,a){return this.forEachFeatureAtCoordinate(e,t,r,i,vp,this,s,a)!==void 0}getMap(){return this.map_}renderFrame(e){Wt()}scheduleExpireIconCache(e){Da.canExpireCache()&&e.postRenderFunctions.push(kq)}}function kq(n,e){Da.expire()}class Iq extends Aq{constructor(e){super(e),this.fontChangeListenerKey_=gn(zf,N0.PROPERTYCHANGE,e.redrawText,e),this.element_=da?oj():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=A1+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const r=this.getMap();if(r.hasListener(e)){const i=new zm(e,void 0,t);r.dispatchEvent(i)}}disposeInternal(){or(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Ti.PRECOMPOSE,e);const t=e.layerStatesArray.sort((c,h)=>c.zIndex-h.zIndex);t.some(c=>c.layer instanceof Fw&&c.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let a=null;for(let c=0,h=t.length;c<h;++c){const g=t[c];e.layerIndex=c;const m=g.layer,x=m.getSourceState();if(!FA(g,i)||x!="ready"&&x!="undefined"){m.unrender();continue}const y=m.render(e,a);y&&(y!==a&&(this.children_.push(y),a=y),s.push(g))}this.declutter(e,s),J$(this.element_,this.children_);const l=this.getMap().getTargetElement();if(du(l)){const c=l.getContext("2d");for(const h of this.children_){const g=h.firstElementChild||h,m=h.style.backgroundColor;if(m&&(!du(g)||g.width>0)&&(c.fillStyle=m,c.fillRect(0,0,l.width,l.height)),du(g)&&g.width>0){const x=h.style.opacity||g.style.opacity;c.globalAlpha=x===""?1:Number(x);const y=g.style.transform;if(y)c.setTransform(...mb(y));else{const _=parseFloat(g.style.width)/g.width,w=parseFloat(g.style.height)/g.height;c.setTransform(_,0,0,w,0,0)}c.drawImage(g,0,0)}}c.globalAlpha=1,c.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Ti.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let r=t.length-1;r>=0;--r){const i=t[r],s=i.layer;s.getDeclutter()&&s.renderDeclutter(e,i)}t.forEach(r=>r.layer.renderDeferred(e))}}}function gF(n){if(n instanceof P1){n.setMapInternal(null);return}n instanceof Vw&&n.getLayers().forEach(gF)}function mF(n,e){if(n instanceof P1){n.setMapInternal(e);return}if(n instanceof Vw){const t=n.getLayers().getArray();for(let r=0,i=t.length;r<i;++r)mF(t[r],e)}}let Cq=class extends _l{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=Pq(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:Y$,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=ni(),this.pixelToCoordinateTransform_=ni(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,da||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,da||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(da?new La:iq()),this.interactions=t.interactions||(da?new La:Rq({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new ZX(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(is.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(is.VIEW,this.handleViewChanged_),this.addChangeListener(is.SIZE,this.handleSizeChanged_),this.addChangeListener(is.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const r=this;e.view&&!(e.view instanceof Qo)&&e.view.then(function(i){r.setView(new Qo(i))}),this.controls.addEventListener(Ds.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(Ds.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(Ds.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(Ds.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(Ds.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(Ds.REMOVE,i=>{const s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){mF(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const s=r.hitTolerance!==void 0?r.hitTolerance:0,a=r.layerFilter!==void 0?r.layerFilter:vp,o=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,o,t,null,a,null)}getFeaturesAtPixel(e,t){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},t),r}getAllLayers(){const e=[];function t(r){r.forEach(function(i){i instanceof Vw?t(i.getLayers()):e.push(i)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const i=t.layerFilter!==void 0?t.layerFilter:vp,s=t.hitTolerance!==void 0?t.hitTolerance:0,a=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,a,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=r.width/i[0],a=r.height/i[1],o="changedTouches"in e?e.changedTouches[0]:e;return[(o.clientX-r.left)/s,(o.clientY-r.top)/a]}getTarget(){return this.get(is.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return gb(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?Cr(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(is.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof La){t.setLayers(e);return}const r=t.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,r=e.length;t<r;++t){const i=e[t];if(!i.visible)continue;const s=i.layer.getRenderer();if(s&&!s.ready)return!0;const a=i.layer.getSource();if(a&&a.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Vl(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?Cr(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(is.SIZE)}getView(){return this.get(is.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,r,i){return JX(this.frameState_,e,t,r,i)}handleBrowserEvent(e,t){t=t||e.type;const r=new eu(t,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,r=t.type;if(r===Pb.POINTERDOWN||r===Kt.WHEEL||r===Kt.KEYDOWN){const i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,a=t.target,o=s instanceof ShadowRoot?s.host===a?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(a)||!o.contains(a))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){const a=i[s];if(a.getMap()!==this||!a.getActive()||!this.getTargetElement())continue;if(!a.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,s=i;if(e){const a=e.viewHints;if(a[Qr.ANIMATING]||a[Qr.INTERACTING]){const o=Date.now()-e.time>8;i=o?0:8,s=o?0:2}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Ti.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Ti.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Xf(tu.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Xf(tu.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,s=r.length;i<s;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,i=this.targetChangeHandlerKeys_.length;r<i;++r)or(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Kt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Kt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!du(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(du(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Iq(this)),!du(t)){this.mapBrowserEventHandler_=new eq(this,this.moveTolerance_);for(const i in Or)this.mapBrowserEventHandler_.addEventListener(Or[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Kt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Kt.WHEEL,this.boundHandleBrowserEvent_,aj?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{const i=t.getRootNode();r=i instanceof ShadowRoot?i.host:t}if(this.targetChangeHandlerKeys_=[gn(r,Kt.KEYDOWN,this.handleBrowserEvent,this),gn(r,Kt.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const i=t.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(or(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(or(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=gn(e,N0.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=gn(e,Kt.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(or),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new ru("addlayer",e)),this.layerGroupPropertyListenerKeys_=[gn(e,N0.PROPERTYCHANGE,this.render,this),gn(e,Kt.CHANGE,this.render,this),gn(e,"addlayer",this.handleLayerAdd_,this),gn(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,r=e.length;t<r;++t){const i=e[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){gF(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),r=this.getView(),i=this.frameState_;let s=null;if(t!==void 0&&MN(t)&&r&&r.isDef()){const a=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=r.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:j_(o.center,o.resolution,o.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:o,viewHints:a,wantedTiles:{},mapId:Gt(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const l=isNaN(o.nextRotation)?o.rotation:o.nextRotation;s.nextExtent=j_(o.nextCenter,o.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!Id(this.previousExtent_)&&!sd(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Xf(tu.MOVESTART,this,i)),this.previousExtent_=E1(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Qr.ANIMATING]&&!s.viewHints[Qr.INTERACTING]&&!sd(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Xf(tu.MOVEEND,this,s)),CD(s.extent,this.previousExtent_))),this.dispatchEvent(new Xf(tu.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(tu.LOADSTART)||this.hasListener(tu.LOADEND)||this.hasListener(Ti.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new ru("removelayer",t)),this.set(is.LAYERGROUP,e)}setSize(e){this.set(is.SIZE,e)}setTarget(e){this.set(is.TARGET,e)}setView(e){if(!e||e instanceof Qo){this.set(is.VIEW,e);return}this.set(is.VIEW,new Qo);const t=this;e.then(function(r){t.setView(new Qo(r))})}updateSize(){const e=this.getTargetElement();let t;if(e){let i,s;if(du(e))i=e.width,s=e.height;else{const a=getComputedStyle(e);i=e.offsetWidth-parseFloat(a.borderLeftWidth)-parseFloat(a.paddingLeft)-parseFloat(a.paddingRight)-parseFloat(a.borderRightWidth),s=e.offsetHeight-parseFloat(a.borderTopWidth)-parseFloat(a.paddingTop)-parseFloat(a.paddingBottom)-parseFloat(a.borderBottomWidth)}!isNaN(i)&&!isNaN(s)&&(t=[Math.max(0,i),Math.max(0,s)],!MN(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&BD("No map visible because the map container's width or height are 0."))}const r=this.getSize();t&&(!r||!gc(t,r))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function Pq(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},r=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Vw({layers:n.layers});t[is.LAYERGROUP]=r,t[is.TARGET]=n.target,t[is.VIEW]=n.view instanceof Qo?n.view:new Qo;let i;n.controls!==void 0&&(Array.isArray(n.controls)?i=new La(n.controls.slice()):(Rn(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new La(n.interactions.slice()):(Rn(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let a;return n.overlays!==void 0?Array.isArray(n.overlays)?a=new La(n.overlays.slice()):(Rn(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),a=n.overlays):a=new La,{controls:i,interactions:s,keyboardEventTarget:e,overlays:a,values:t}}const eT="units",Nq=[1,2,5],mm=25.4/.28;class Mq extends Ww{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const r=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+A1,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(eT,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(eT)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(eT,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,r=e.projection,i=this.getUnits(),s=i=="degrees"?"degrees":"m";let a=U_(r,e.resolution,t,s);const o=this.minWidth_*(this.dpi_||mm)/mm,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||mm)/mm:void 0;let c=o*a,h="";if(i=="degrees"){const R=L0.degrees;c*=R,c<R/60?(h="",a*=3600):c<R?(h="",a*=60):h=""}else if(i=="imperial")c<.9144?(h="in",a/=.0254):c<1609.344?(h="ft",a/=.3048):(h="mi",a/=1609.344);else if(i=="nautical")a/=1852,h="NM";else if(i=="metric")c<1e-6?(h="nm",a*=1e9):c<.001?(h="m",a*=1e6):c<1?(h="mm",a*=1e3):c<1e3?h="m":(h="km",a/=1e3);else if(i=="us")c<.9144?(h="in",a*=39.37):c<1609.344?(h="ft",a/=.30480061):(h="mi",a/=1609.3472);else throw new Error("Invalid units");let g=3*Math.floor(Math.log(o*a)/Math.log(10)),m,x,y,_=0,w,T;for(;;){y=Math.floor(g/3);const R=Math.pow(10,y);if(m=Nq[(g%3+3)%3]*R,x=Math.round(m/a),isNaN(x)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&x>=l){m=_,x=w,y=T;break}else if(x>=o)break;_=m,w=x,T=y,++g}const b=this.scaleBar_?this.createScaleBar(x,m,h):m.toFixed(y<0?-y:0)+" "+h;this.renderedHTML_!=b&&(this.innerElement_.innerHTML=b,this.renderedHTML_=b),this.renderedWidth_!=x&&(this.innerElement_.style.width=x+"px",this.renderedWidth_=x),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,r){const i=this.getScaleForResolution(),s=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),a=this.scaleBarSteps_,o=e/a,l=[this.createMarker("absolute")];for(let h=0;h<a;++h){const g=h%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${g}" style="width: ${o}px;"></div>`+this.createMarker("relative")+(h%2===0||a===2?this.createStepText(h,e,!1,t,r):"")+"</div>")}return l.push(this.createStepText(a,e,!0,t,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,r,i,s){const o=(e===0?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:t/this.scaleBarSteps_*-1,c=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${c}px;left: ${r?t+"px":"unset"};">`+o+"</div>"}getScaleForResolution(){const e=U_(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||mm,r=1e3/25.4;return e*r*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const Lq={},mM=n=>{let e;const t=new Set,r=(h,g)=>{const m=typeof h=="function"?h(e):h;if(!Object.is(m,e)){const x=e;e=g??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(y=>y(e,x))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(Lq?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},c=e=n(r,i,l);return l},Oq=n=>n?mM(n):mM;var tT={exports:{}},nT={},rT={exports:{}},iT={};var pM;function Dq(){if(pM)return iT;pM=1;var n=_1();function e(g,m){return g===m&&(g!==0||1/g===1/m)||g!==g&&m!==m}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue;function o(g,m){var x=m(),y=r({inst:{value:x,getSnapshot:m}}),_=y[0].inst,w=y[1];return s(function(){_.value=x,_.getSnapshot=m,l(_)&&w({inst:_})},[g,x,m]),i(function(){return l(_)&&w({inst:_}),g(function(){l(_)&&w({inst:_})})},[g]),a(x),x}function l(g){var m=g.getSnapshot;g=g.value;try{var x=m();return!t(g,x)}catch{return!0}}function c(g,m){return m()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return iT.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:h,iT}var xM;function jq(){return xM||(xM=1,rT.exports=Dq()),rT.exports}var yM;function Fq(){if(yM)return nT;yM=1;var n=_1(),e=jq();function t(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=n.useRef,a=n.useEffect,o=n.useMemo,l=n.useDebugValue;return nT.useSyncExternalStoreWithSelector=function(c,h,g,m,x){var y=s(null);if(y.current===null){var _={hasValue:!1,value:null};y.current=_}else _=y.current;y=o(function(){function T(B){if(!b){if(b=!0,R=B,B=m(B),x!==void 0&&_.hasValue){var k=_.value;if(x(k,B))return M=k}return M=B}if(k=M,r(R,B))return k;var A=m(B);return x!==void 0&&x(k,A)?(R=B,k):(R=B,M=A)}var b=!1,R,M,D=g===void 0?null:g;return[function(){return T(h())},D===null?void 0:function(){return T(D())}]},[h,g,m,x]);var w=i(c,y[0],y[1]);return a(function(){_.hasValue=!0,_.value=w},[w]),l(w),w},nT}var _M;function Vq(){return _M||(_M=1,tT.exports=Fq()),tT.exports}var Bq=Vq();const Gq=nA(Bq),pF={},{useDebugValue:zq}=FU,{useSyncExternalStoreWithSelector:Uq}=Gq;let vM=!1;const $q=n=>n;function Wq(n,e=$q,t){(pF?"production":void 0)!=="production"&&t&&!vM&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),vM=!0);const r=Uq(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return zq(r),r}const Hq=n=>{(pF?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?Oq(n):n,t=(r,i)=>Wq(e,r,i);return Object.assign(t,e),t},Yi=n=>Hq;var xF=Symbol.for("immer-nothing"),wM=Symbol.for("immer-draftable"),ma=Symbol.for("immer-state");function ho(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Op=Object.getPrototypeOf;function V0(n){return!!n&&!!n[ma]}function cd(n){return n?yF(n)||Array.isArray(n)||!!n[wM]||!!n.constructor?.[wM]||L1(n)||Kw(n):!1}var Kq=Object.prototype.constructor.toString(),EM=new WeakMap;function yF(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let r=EM.get(t);return r===void 0&&(r=Function.toString.call(t),EM.set(t,r)),r===Kq}function iv(n,e,t=!0){Hw(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(i=>{e(i,n[i],n)}):n.forEach((r,i)=>e(i,r,n))}function Hw(n){const e=n[ma];return e?e.type_:Array.isArray(n)?1:L1(n)?2:Kw(n)?3:0}function Mb(n,e){return Hw(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function _F(n,e,t){const r=Hw(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function Xq(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function L1(n){return n instanceof Map}function Kw(n){return n instanceof Set}function Ah(n){return n.copy_||n.base_}function Lb(n,e){if(L1(n))return new Map(n);if(Kw(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=yF(n);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[ma];let i=Reflect.ownKeys(r);for(let s=0;s<i.length;s++){const a=i[s],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[a]})}return Object.create(Op(n),r)}else{const r=Op(n);if(r!==null&&t)return{...n};const i=Object.create(r);return Object.assign(i,n)}}function nk(n,e=!1){return Xw(n)||V0(n)||!cd(n)||(Hw(n)>1&&Object.defineProperties(n,{set:Ny,add:Ny,clear:Ny,delete:Ny}),Object.freeze(n),e&&Object.values(n).forEach(t=>nk(t,!0))),n}function qq(){ho(2)}var Ny={value:qq};function Xw(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var Yq={};function ud(n){const e=Yq[n];return e||ho(0,n),e}var Dp;function vF(){return Dp}function Zq(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function SM(n,e){e&&(ud("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function Ob(n){Db(n),n.drafts_.forEach(Jq),n.drafts_=null}function Db(n){n===Dp&&(Dp=n.parent_)}function TM(n){return Dp=Zq(Dp,n)}function Jq(n){const e=n[ma];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function bM(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[ma].modified_&&(Ob(e),ho(4)),cd(n)&&(n=sv(e,n),e.parent_||av(e,n)),e.patches_&&ud("Patches").generateReplacementPatches_(t[ma].base_,n,e.patches_,e.inversePatches_)):n=sv(e,t,[]),Ob(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==xF?n:void 0}function sv(n,e,t){if(Xw(e))return e;const r=n.immer_.shouldUseStrictIteration(),i=e[ma];if(!i)return iv(e,(s,a)=>RM(n,i,e,s,a,t),r),e;if(i.scope_!==n)return e;if(!i.modified_)return av(n,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let a=s,o=!1;i.type_===3&&(a=new Set(s),s.clear(),o=!0),iv(a,(l,c)=>RM(n,i,s,l,c,t,o),r),av(n,s,!1),t&&n.patches_&&ud("Patches").generatePatches_(i,t,n.patches_,n.inversePatches_)}return i.copy_}function RM(n,e,t,r,i,s,a){if(i==null||typeof i!="object"&&!a)return;const o=Xw(i);if(!(o&&!a)){if(V0(i)){const l=s&&e&&e.type_!==3&&!Mb(e.assigned_,r)?s.concat(r):void 0,c=sv(n,i,l);if(_F(t,r,c),V0(c))n.canAutoFreeze_=!1;else return}else a&&t.add(i);if(cd(i)&&!o){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===i&&o)return;sv(n,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(L1(t)?t.has(r):Object.prototype.propertyIsEnumerable.call(t,r))&&av(n,i)}}}function av(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&nk(e,t)}function Qq(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:vF(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=rk;t&&(i=[r],s=jp);const{revoke:a,proxy:o}=Proxy.revocable(i,s);return r.draft_=o,r.revoke_=a,o}var rk={get(n,e){if(e===ma)return n;const t=Ah(n);if(!Mb(t,e))return eY(n,t,e);const r=t[e];return n.finalized_||!cd(r)?r:r===sT(n.base_,e)?(aT(n),n.copy_[e]=Fb(r,n)):r},has(n,e){return e in Ah(n)},ownKeys(n){return Reflect.ownKeys(Ah(n))},set(n,e,t){const r=wF(Ah(n),e);if(r?.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const i=sT(Ah(n),e),s=i?.[ma];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(Xq(t,i)&&(t!==void 0||Mb(n.base_,e)))return!0;aT(n),jb(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return sT(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,aT(n),jb(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Ah(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){ho(11)},getPrototypeOf(n){return Op(n.base_)},setPrototypeOf(){ho(12)}},jp={};iv(rk,(n,e)=>{jp[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});jp.deleteProperty=function(n,e){return jp.set.call(this,n,e,void 0)};jp.set=function(n,e,t){return rk.set.call(this,n[0],e,t,n[0])};function sT(n,e){const t=n[ma];return(t?Ah(t):n)[e]}function eY(n,e,t){const r=wF(e,t);return r?"value"in r?r.value:r.get?.call(n.draft_):void 0}function wF(n,e){if(!(e in n))return;let t=Op(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=Op(t)}}function jb(n){n.modified_||(n.modified_=!0,n.parent_&&jb(n.parent_))}function aT(n){n.copy_||(n.copy_=Lb(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var tY=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const a=this;return function(l=s,...c){return a.produce(l,h=>t.call(this,h,...c))}}typeof t!="function"&&ho(6),r!==void 0&&typeof r!="function"&&ho(7);let i;if(cd(e)){const s=TM(this),a=Fb(e,void 0);let o=!0;try{i=t(a),o=!1}finally{o?Ob(s):Db(s)}return SM(s,r),bM(i,s)}else if(!e||typeof e!="object"){if(i=t(e),i===void 0&&(i=e),i===xF&&(i=void 0),this.autoFreeze_&&nk(i,!0),r){const s=[],a=[];ud("Patches").generateReplacementPatches_(e,i,s,a),r(s,a)}return i}else ho(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let r,i;return[this.produce(e,t,(a,o)=>{r=a,i=o}),r,i]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){cd(n)||ho(8),V0(n)&&(n=nY(n));const e=TM(this),t=Fb(n,void 0);return t[ma].isManual_=!0,Db(e),t}finishDraft(n,e){const t=n&&n[ma];(!t||!t.isManual_)&&ho(9);const{scope_:r}=t;return SM(r,e),bM(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const i=e[t];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}t>-1&&(e=e.slice(t+1));const r=ud("Patches").applyPatches_;return V0(n)?r(n,e):this.produce(n,i=>r(i,e))}};function Fb(n,e){const t=L1(n)?ud("MapSet").proxyMap_(n,e):Kw(n)?ud("MapSet").proxySet_(n,e):Qq(n,e);return(e?e.scope_:vF()).drafts_.push(t),t}function nY(n){return V0(n)||ho(10,n),EF(n)}function EF(n){if(!cd(n)||Xw(n))return n;const e=n[ma];let t,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Lb(n,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else t=Lb(n,!0);return iv(t,(i,s)=>{_F(t,i,EF(s))},r),e&&(e.finalized_=!1),t}var rY=new tY,iY=rY.produce;const sY=n=>(e,t,r)=>(r.setState=(i,s,...a)=>{const o=typeof i=="function"?iY(i):i;return e(o,s,...a)},n(r.setState,t,r)),hg=sY,Wi=Yi()(hg((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.2,minRotationSpeed:8,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:r}=e();r!==null&&navigator.geolocation.clearWatch(r),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(r=>{r.position={lat:t.coords.latitude,lng:t.coords.longitude},r.accuracy=t.coords.accuracy,r.speed=t.coords.speed;const i=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<i)){r.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){r.headingSource="gps";const o=t.coords.heading;e().updateHeading(o,"gps")}else r.headingSource="compass"})},updateHeading:(t,r="compass")=>{n(i=>{const{smoothHeading:s,config:a}=e();if(s===null){i.smoothHeading=t,i.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=r==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(r==="gps"?.5:.35);i.smoothHeading=(h+360)%360,i.heading=t})},setSmoothedHeading:t=>{n(r=>{r.smoothHeading=t,r.heading=t})},setWatchId:t=>{n(r=>{r.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),qw={"TMK 1850":{name:"TMK 1850",factory:async()=>null,immediateLoad:!0,tier:"premium"},"Bonnebladen 1900":{name:"Bonnebladen 1900",factory:async()=>null,immediateLoad:!0,tier:"premium"},"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await yt(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await yt(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await yt(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await yt(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await yt(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE IJzertijd":{name:"FAMKE IJzertijd",factory:async()=>{const{createFAMKEIJzertijdLayerOL:n}=await yt(async()=>{const{createFAMKEIJzertijdLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createFAMKEIJzertijdLayerOL:e}},[]);return n()},immediateLoad:!0},Essen:{name:"Essen",factory:async()=>{const{createEssenLayerOL:n}=await yt(async()=>{const{createEssenLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createEssenLayerOL:e}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await yt(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createRijksmonumentenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await yt(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await yt(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createWerelderfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await yt(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-BdMqUKE4.js");return{createTerpenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await yt(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-CVLevyZY.js");return{createLiniesLayerOL:e}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await yt(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-CVLevyZY.js");return{createInundatiesLayerOL:e}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await yt(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-CVLevyZY.js");return{createMilitaireObjectenLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:n}=await yt(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-BYU08v46.js");return{createPaleo800ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:n}=await yt(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-BYU08v46.js");return{createPaleo100ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:n}=await yt(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-BYU08v46.js");return{createPaleo500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:n}=await yt(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-BYU08v46.js");return{createPaleo1500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:n}=await yt(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-BYU08v46.js");return{createPaleo2750vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:n}=await yt(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-BYU08v46.js");return{createPaleo5500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:n}=await yt(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-BYU08v46.js");return{createPaleo9000vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:n}=await yt(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-Dc60JAz_.js");return{createReligieusErfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hoogtekaart Kleur":{name:"AHN4 Hoogtekaart Kleur",factory:async()=>{const{createAHN4ColorElevationLayerOL:n}=await yt(async()=>{const{createAHN4ColorElevationLayerOL:e}=await import("./hillshadeLayers-Ct0Y29RJ.js");return{createAHN4ColorElevationLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await yt(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-Ct0Y29RJ.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await yt(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-Ct0Y29RJ.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"Hoogtekaart (WebGL)":{name:"Hoogtekaart (WebGL)",factory:async()=>{const{createWebGLHillshadeLayerOL:n}=await yt(async()=>{const{createWebGLHillshadeLayerOL:e}=await import("./ahnWebGLHillshade-BkcW8MpP.js");return{createWebGLHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:n}=await yt(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createGewaspercelenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:n}=await yt(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createKadastraleKaartLayerOL:e}},[]);return n()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:n}=await yt(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createScheepswrakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:n}=await yt(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createWoonheuvelsLayerOL:e}},[]);return n()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:n}=await yt(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./romeinseFortenOL-CF-qWWk4.js");return{createRomeinseFortenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},"Romeinse Forten Lijnen":{name:"Romeinse Forten Lijnen",factory:async()=>{const{createRomeinseFortenLijnenLayerOL:n}=await yt(async()=>{const{createRomeinseFortenLijnenLayerOL:e}=await import("./romeinseFortenOL-CF-qWWk4.js");return{createRomeinseFortenLijnenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:n}=await yt(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createWindmolensLayerOL:e}},[]);return n()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:n}=await yt(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createErfgoedlijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:n}=await yt(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createOudeKernenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenPuntenLayerOL:n}=await yt(async()=>{const{createRelictenPuntenLayerOL:e}=await import("./relictenGelderlandOL-CqLdkh_e.js");return{createRelictenPuntenLayerOL:e}},[]);return n()},immediateLoad:!1},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:n}=await yt(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:n}=await yt(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:n}=await yt(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-C1Kd-71z.js");return{createVerdronkenDorpenLayerOL:e}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await yt(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-B1n8wqc_.js");return{createAMKLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Romeins":{name:"AMK Romeins",factory:async()=>{const{createAMKRomeinsLayerOL:n}=await yt(async()=>{const{createAMKRomeinsLayerOL:e}=await import("./amkOL-B1n8wqc_.js");return{createAMKRomeinsLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Steentijd":{name:"AMK Steentijd",factory:async()=>{const{createAMKSteentijdLayerOL:n}=await yt(async()=>{const{createAMKSteentijdLayerOL:e}=await import("./amkOL-B1n8wqc_.js");return{createAMKSteentijdLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Vroege ME":{name:"AMK Vroege ME",factory:async()=>{const{createAMKVroegeMELayerOL:n}=await yt(async()=>{const{createAMKVroegeMELayerOL:e}=await import("./amkOL-B1n8wqc_.js");return{createAMKVroegeMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Late ME":{name:"AMK Late ME",factory:async()=>{const{createAMKLateMELayerOL:n}=await yt(async()=>{const{createAMKLateMELayerOL:e}=await import("./amkOL-B1n8wqc_.js");return{createAMKLateMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Overig":{name:"AMK Overig",factory:async()=>{const{createAMKOverigLayerOL:n}=await yt(async()=>{const{createAMKOverigLayerOL:e}=await import("./amkOL-B1n8wqc_.js");return{createAMKOverigLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"Romeinse wegen (regio)":{name:"Romeinse wegen (regio)",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await yt(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-zKWsd6db.js");return{createRomeinseWegenLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1},"Romeinse wegen (Wereld)":{name:"Romeinse wegen (Wereld)",factory:async()=>{const{createRomeinseWegenWereldLayerOL:n}=await yt(async()=>{const{createRomeinseWegenWereldLayerOL:e}=await import("./romeinsOL-zKWsd6db.js");return{createRomeinseWegenWereldLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await yt(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-DEyc6wRS.js");return{createKastelenLayerOL:e}},__vite__mapDeps([5,1]));return n()},immediateLoad:!1},Runes:{name:"Runes",factory:async()=>{const{createRuinesLayerOL:n}=await yt(async()=>{const{createRuinesLayerOL:e}=await import("./ruinesOL-zOOrtQlp.js");return{createRuinesLayerOL:e}},__vite__mapDeps([6,1]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await yt(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-B8nn6kV-.js");return{createVeengebiedenLayerOL:e}},[]);return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await yt(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-BN3LmK1V.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([7,1]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await yt(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-6Pz4uX8W.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([8,3,1]));return n()},immediateLoad:!1,tier:"premium"},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await yt(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-BDHywSQu.js");return{createUIKAVVlakkenLayerOL:e}},__vite__mapDeps([9,3]));return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await yt(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-B465RmDL.js");return{createUIKAVBufferlaagLayerOL:e}},__vite__mapDeps([10,3]));return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await yt(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-Blf5fGu5.js");return{createUIKAVExpertLayerOL:e}},__vite__mapDeps([11,3]));return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await yt(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-B9D-asx_.js");return{createUIKAVUiterwaardenLayerOL:e}},__vite__mapDeps([12,3]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await yt(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-ByA0IiCq.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([13,3,1]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await yt(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-CAGibvGg.js");return{createMuseaLayerOL:e}},__vite__mapDeps([14,3,1]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await yt(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-BU4e0iEN.js");return{createStrandjesLayerOL:e}},__vite__mapDeps([15,3]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await yt(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-BQlcE7Kw.js");return{createParkenLayerOL:e}},__vite__mapDeps([16,3]));return n()},immediateLoad:!1},Kringloopwinkels:{name:"Kringloopwinkels",factory:async()=>{const{createKringloopwinkelsLayerOL:n}=await yt(async()=>{const{createKringloopwinkelsLayerOL:e}=await import("./kringloopwinkelsOL-BvSHJk2d.js");return{createKringloopwinkelsLayerOL:e}},__vite__mapDeps([17,1]));return n()},immediateLoad:!1},Ruiterpaden:{name:"Ruiterpaden",factory:async()=>{const{createRuiterpadenLayerOL:n}=await yt(async()=>{const{createRuiterpadenLayerOL:e}=await import("./ruiterpadenOL-DYP0gZUi.js");return{createRuiterpadenLayerOL:e}},[]);return n()},immediateLoad:!1},Laarzenpaden:{name:"Laarzenpaden",factory:async()=>{const{createLaarzenpadenLayerOL:n}=await yt(async()=>{const{createLaarzenpadenLayerOL:e}=await import("./laarzenpadenOL-BXXyejp7.js");return{createLaarzenpadenLayerOL:e}},[]);return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await yt(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-2hcc6-OU.js");return{createFossielenLayerOL:e}},__vite__mapDeps([18,19,1]));return n()},immediateLoad:!1,tier:"premium"},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await yt(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-B3z7O0-W.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([20,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["be"]},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await yt(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-Og28vJU_.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([21,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["de"]},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await yt(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-CGEXLzfi.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([22,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["fr"]},"Fossiel Hotspots":{name:"Fossiel Hotspots",factory:async()=>{const{createFossielHotspotsLayerOL:n}=await yt(async()=>{const{createFossielHotspotsLayerOL:e}=await import("./fossielHotspotsOL-DnXeVQCx.js");return{createFossielHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"Mineralen Hotspots":{name:"Mineralen Hotspots",factory:async()=>{const{createMineralenHotspotsLayerOL:n}=await yt(async()=>{const{createMineralenHotspotsLayerOL:e}=await import("./mineralenHotspotsOL-lNtvNwQm.js");return{createMineralenHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Goudrivieren:{name:"Goudrivieren",factory:async()=>{const{createGoudrivierenLayerOL:n}=await yt(async()=>{const{createGoudrivierenLayerOL:e}=await import("./goudrivierenOL-D5AbSLm8.js");return{createGoudrivierenLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await yt(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-D_Lp2rfo.js");return{createBunkersLayerOL:e}},__vite__mapDeps([23,1]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await yt(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-DSZPSXOv.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([24,1]));return n()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:n}=await yt(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-DLJ9v0zp.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([25,1]));return n()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:n}=await yt(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-CsPukYhU.js");return{createVliegveldenLayerOL:e}},[]);return n()},immediateLoad:!1}};function aY(){return Object.values(qw).filter(n=>n.immediateLoad)}const pi=Yi()(hg((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(r=>{r.map=t})},setRotation:t=>{n(r=>{if(r.rotation=t,r.map&&r.rotationEnabled){const i=t*Math.PI/180;r.map.getView().setRotation(i)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Ri=Yi()(hg((n,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,"FAMKE IJzertijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"AMK Romeins":!1,"AMK Steentijd":!1,"AMK Vroege ME":!1,"AMK Late ME":!1,"AMK Overig":!1,"Archeo Onderzoeken":!1,"Romeinse wegen (regio)":!1,"Romeinse wegen (Wereld)":!1,Kastelen:!1,IKAW:!1,Essen:!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"Hoogtekaart (WebGL)":!1,"AHN4 Hoogtekaart Kleur":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN 0.5m":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Ruiterpaden:!1,Laarzenpaden:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1,"Mijn Vondsten":!0},opacity:{"Hoogtekaart (WebGL)":.8,"AHN4 Hoogtekaart Kleur":.85,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN 0.5m":.7,"TMK 1850":.8,"Bonnebladen 1900":.8,Geomorfologie:.5,Bodemkaart:.6,Veengebieden:.6,IKAW:.5,"FAMKE Steentijd":.6,"FAMKE IJzertijd":.6,Essen:.6,Terpen:.7,"AMK Monumenten":.45,"AMK Romeins":.6,"AMK Steentijd":.6,"AMK Vroege ME":.6,"AMK Late ME":.6,"AMK Overig":.6,"Paleokaart 9000 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 800 n.Chr.":.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},toggleLayer:t=>{const r=e(),i=!r.visible[t];n(s=>{s.visible[t]=i}),i&&!r.layers[t]?e().loadLayer(t):r.layers[t]&&r.layers[t].setVisible(i)},setLayerVisibility:(t,r)=>{const i=e();n(s=>{s.visible[t]=r;const a=s.layers[t];a&&a.setVisible(r)}),r&&!i.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,r)=>{n(i=>{i.opacity[t]=r;const s=i.layers[t];s&&s.setOpacity(r)})},registerLayer:(t,r)=>{n(i=>{i.layers[t]=r,i.loadingState[t]="loaded",i.visible[t]!==void 0&&r.setVisible(i.visible[t]),i.opacity[t]!==void 0&&r.setOpacity(i.opacity[t])})},unregisterLayer:t=>{n(r=>{delete r.layers[t],delete r.loadingState[t]})},loadLayer:async t=>{const r=e();if(r.loadingState[t]==="loading"||r.layers[t])return;const i=qw[t];if(!i){console.warn(` Layer "${t}" not found in registry`);return}const s=pi.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(a=>{a.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const a=await i.factory();if(!a)throw new Error("Factory returned null");const o=e();a.setVisible(o.visible[t]??!1),o.opacity[t]!==void 0&&a.setOpacity(o.opacity[t]),s.addLayer(a),n(l=>{l.layers[t]=a,l.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(a){console.error(` Failed to load layer "${t}":`,a),n(o=>{o.loadingState[t]="error"})}}}))),wr=Yi()(hg((n,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,vondstFormOpen:!1,vondstFormLocation:null,vondstFormPhoto:null,vondstDashboardOpen:!1,createLayerModalOpen:!1,addPointModalOpen:!1,addPointModalLayerId:null,addPointModalLocation:null,layerManagerModalOpen:!1,layerDashboardOpen:!1,layerDashboardLayerId:null,routeDashboardOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(t=>{t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1})},toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleBackgroundsPanel:()=>{n(t=>{const r=t.backgroundsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{n(t=>{const r=t.themesPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{n(t=>{const r=t.settingsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(t=>{const r=t.infoPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.infoPanelOpen=!0)})},togglePresetsPanel:()=>{n(t=>{const r=t.presetsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.presetsPanelOpen=!0)})},toggleCategory:t=>{n(r=>{r.collapsedCategories.has(t)?r.collapsedCategories.delete(t):r.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(r=>{r.layerControlOpen=t})},setLegendOpen:t=>{n(r=>{r.legendOpen=t})},openVondstForm:(t,r)=>{n(i=>{i.backgroundsPanelOpen=!1,i.themesPanelOpen=!1,i.settingsPanelOpen=!1,i.infoPanelOpen=!1,i.presetsPanelOpen=!1,i.vondstFormOpen=!0,i.vondstFormLocation=t||null,i.vondstFormPhoto=r||null})},closeVondstForm:()=>{n(t=>{t.vondstFormOpen=!1,t.vondstFormLocation=null,t.vondstFormPhoto=null})},toggleVondstDashboard:()=>{n(t=>{const r=t.vondstDashboardOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,t.vondstDashboardOpen=!r})},openCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!0})},closeCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!1})},openAddPointModal:(t,r)=>{n(i=>{i.addPointModalOpen=!0,i.addPointModalLayerId=t,i.addPointModalLocation=r})},closeAddPointModal:()=>{n(t=>{t.addPointModalOpen=!1,t.addPointModalLayerId=null,t.addPointModalLocation=null})},openLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!0})},closeLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!1})},openLayerDashboard:t=>{n(r=>{r.layerDashboardOpen=!0,r.layerDashboardLayerId=t,r.layerManagerModalOpen=!1})},closeLayerDashboard:()=>{n(t=>{t.layerDashboardOpen=!1,t.layerDashboardLayerId=null})},toggleRouteDashboard:()=>{n(t=>{t.routeDashboardOpen=!t.routeDashboardOpen})}}))),oY=()=>{};var AM={};const SF=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},lY=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],o=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},TF={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,o=a?n[i+1]:0,l=i+2<n.length,c=l?n[i+2]:0,h=s>>2,g=(s&3)<<4|o>>4;let m=(o&15)<<2|c>>6,x=c&63;l||(x=64,a||(m=64)),r.push(t[h],t[g],t[m],t[x])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(SF(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):lY(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],o=i<n.length?t[n.charAt(i)]:0;++i;const c=i<n.length?t[n.charAt(i)]:64;++i;const g=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||o==null||c==null||g==null)throw new cY;const m=s<<2|o>>4;if(r.push(m),c!==64){const x=o<<4&240|c>>2;if(r.push(x),g!==64){const y=c<<6&192|g;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class cY extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const uY=function(n){const e=SF(n);return TF.encodeByteArray(e,!0)},ov=function(n){return uY(n).replace(/\./g,"")},bF=function(n){try{return TF.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function RF(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const hY=()=>RF().__FIREBASE_DEFAULTS__,dY=()=>{if(typeof process>"u"||typeof AM>"u")return;const n=AM.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},fY=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&bF(n[1]);return e&&JSON.parse(e)},Yw=()=>{try{return oY()||hY()||dY()||fY()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},AF=n=>Yw()?.emulatorHosts?.[n],kF=n=>{const e=AF(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},IF=()=>Yw()?.config,CF=n=>Yw()?.[`_${n}`];class gY{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Ld(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ik(n){return(await fetch(n,{credentials:"include"})).ok}function PF(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[ov(JSON.stringify(t)),ov(JSON.stringify(a)),""].join(".")}const $m={};function mY(){const n={prod:[],emulator:[]};for(const e of Object.keys($m))$m[e]?n.emulator.push(e):n.prod.push(e);return n}function pY(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let kM=!1;function sk(n,e){if(typeof window>"u"||typeof document>"u"||!Ld(window.location.host)||$m[n]===e||$m[n]||kM)return;$m[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",s=mY().prod.length>0;function a(){const m=document.getElementById(r);m&&m.remove()}function o(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,x){m.setAttribute("width","24"),m.setAttribute("id",x),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{kM=!0,a()},m}function h(m,x){m.setAttribute("id",x),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function g(){const m=pY(r),x=t("text"),y=document.getElementById(x)||document.createElement("span"),_=t("learnmore"),w=document.getElementById(_)||document.createElement("a"),T=t("preprendIcon"),b=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const R=m.element;o(R),h(w,_);const M=c();l(b,T),R.append(b,y,w,M),document.body.appendChild(R)}s?(y.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function mi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function xY(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mi())}function NF(){const n=Yw()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function yY(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function _Y(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function vY(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wY(){const n=mi();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function MF(){return!NF()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function LF(){return!NF()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function OF(){try{return typeof indexedDB=="object"}catch{return!1}}function EY(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const SY="FirebaseError";class vl extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=SY,Object.setPrototypeOf(this,vl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,O1.prototype.create)}}class O1{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?TY(s,r):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new vl(i,o,r)}}function TY(n,e){return n.replace(bY,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const bY=/\{\$([^}]+)}/g;function RY(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function hd(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(IM(s)&&IM(a)){if(!hd(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function IM(n){return n!==null&&typeof n=="object"}function D1(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function AY(n,e){const t=new kY(n,e);return t.subscribe.bind(t)}class kY{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");IY(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=oT),i.error===void 0&&(i.error=oT),i.complete===void 0&&(i.complete=oT);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function IY(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function oT(){}function Ni(n){return n&&n._delegate?n._delegate:n}class Nu{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const kh="[DEFAULT]";class CY{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new gY;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(NY(e))try{this.getOrInitializeService({instanceIdentifier:kh})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=kh){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=kh){return this.instances.has(e)}getOptions(e=kh){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);r===o&&a.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:PY(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=kh){return this.component?this.component.multipleInstances?e:kh:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function PY(n){return n===kh?void 0:n}function NY(n){return n.instantiationMode==="EAGER"}class MY{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new CY(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var _n;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(_n||(_n={}));const LY={debug:_n.DEBUG,verbose:_n.VERBOSE,info:_n.INFO,warn:_n.WARN,error:_n.ERROR,silent:_n.SILENT},OY=_n.INFO,DY={[_n.DEBUG]:"log",[_n.VERBOSE]:"log",[_n.INFO]:"info",[_n.WARN]:"warn",[_n.ERROR]:"error"},jY=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=DY[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ak{constructor(e){this.name=e,this._logLevel=OY,this._logHandler=jY,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in _n))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?LY[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,_n.DEBUG,...e),this._logHandler(this,_n.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,_n.VERBOSE,...e),this._logHandler(this,_n.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,_n.INFO,...e),this._logHandler(this,_n.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,_n.WARN,...e),this._logHandler(this,_n.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,_n.ERROR,...e),this._logHandler(this,_n.ERROR,...e)}}const FY=(n,e)=>e.some(t=>n instanceof t);let CM,PM;function VY(){return CM||(CM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function BY(){return PM||(PM=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const DF=new WeakMap,Vb=new WeakMap,jF=new WeakMap,lT=new WeakMap,ok=new WeakMap;function GY(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Su(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&DF.set(t,n)}).catch(()=>{}),ok.set(e,n),e}function zY(n){if(Vb.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});Vb.set(n,e)}let Bb={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Vb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||jF.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Su(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function UY(n){Bb=n(Bb)}function $Y(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(cT(this),e,...t);return jF.set(r,e.sort?e.sort():[e]),Su(r)}:BY().includes(n)?function(...e){return n.apply(cT(this),e),Su(DF.get(this))}:function(...e){return Su(n.apply(cT(this),e))}}function WY(n){return typeof n=="function"?$Y(n):(n instanceof IDBTransaction&&zY(n),FY(n,VY())?new Proxy(n,Bb):n)}function Su(n){if(n instanceof IDBRequest)return GY(n);if(lT.has(n))return lT.get(n);const e=WY(n);return e!==n&&(lT.set(n,e),ok.set(e,n)),e}const cT=n=>ok.get(n);function HY(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),o=Su(a);return r&&a.addEventListener("upgradeneeded",l=>{r(Su(a.result),l.oldVersion,l.newVersion,Su(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const KY=["get","getKey","getAll","getAllKeys","count"],XY=["put","add","delete","clear"],uT=new Map;function NM(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(uT.get(e))return uT.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=XY.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||KY.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(o.shift())),(await Promise.all([c[t](...o),i&&l.done]))[0]};return uT.set(e,s),s}UY(n=>({...n,get:(e,t,r)=>NM(e,t)||n.get(e,t,r),has:(e,t)=>!!NM(e,t)||n.has(e,t)}));class qY{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(YY(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function YY(n){return n.getComponent()?.type==="VERSION"}const Gb="@firebase/app",MM="0.14.6";const sc=new ak("@firebase/app"),ZY="@firebase/app-compat",JY="@firebase/analytics-compat",QY="@firebase/analytics",eZ="@firebase/app-check-compat",tZ="@firebase/app-check",nZ="@firebase/auth",rZ="@firebase/auth-compat",iZ="@firebase/database",sZ="@firebase/data-connect",aZ="@firebase/database-compat",oZ="@firebase/functions",lZ="@firebase/functions-compat",cZ="@firebase/installations",uZ="@firebase/installations-compat",hZ="@firebase/messaging",dZ="@firebase/messaging-compat",fZ="@firebase/performance",gZ="@firebase/performance-compat",mZ="@firebase/remote-config",pZ="@firebase/remote-config-compat",xZ="@firebase/storage",yZ="@firebase/storage-compat",_Z="@firebase/firestore",vZ="@firebase/ai",wZ="@firebase/firestore-compat",EZ="firebase",SZ="12.6.0";const zb="[DEFAULT]",TZ={[Gb]:"fire-core",[ZY]:"fire-core-compat",[QY]:"fire-analytics",[JY]:"fire-analytics-compat",[tZ]:"fire-app-check",[eZ]:"fire-app-check-compat",[nZ]:"fire-auth",[rZ]:"fire-auth-compat",[iZ]:"fire-rtdb",[sZ]:"fire-data-connect",[aZ]:"fire-rtdb-compat",[oZ]:"fire-fn",[lZ]:"fire-fn-compat",[cZ]:"fire-iid",[uZ]:"fire-iid-compat",[hZ]:"fire-fcm",[dZ]:"fire-fcm-compat",[fZ]:"fire-perf",[gZ]:"fire-perf-compat",[mZ]:"fire-rc",[pZ]:"fire-rc-compat",[xZ]:"fire-gcs",[yZ]:"fire-gcs-compat",[_Z]:"fire-fst",[wZ]:"fire-fst-compat",[vZ]:"fire-vertex","fire-js":"fire-js",[EZ]:"fire-js-all"};const lv=new Map,bZ=new Map,Ub=new Map;function LM(n,e){try{n.container.addComponent(e)}catch(t){sc.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function dd(n){const e=n.name;if(Ub.has(e))return sc.debug(`There were multiple attempts to register component ${e}.`),!1;Ub.set(e,n);for(const t of lv.values())LM(t,n);for(const t of bZ.values())LM(t,n);return!0}function Zw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ha(n){return n==null?!1:n.settings!==void 0}const RZ={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Tu=new O1("app","Firebase",RZ);class AZ{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Nu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Tu.create("app-deleted",{appName:this._name})}}const Od=SZ;function FF(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:zb,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Tu.create("bad-app-name",{appName:String(i)});if(t||(t=IF()),!t)throw Tu.create("no-options");const s=lv.get(i);if(s){if(hd(t,s.options)&&hd(r,s.config))return s;throw Tu.create("duplicate-app",{appName:i})}const a=new MY(i);for(const l of Ub.values())a.addComponent(l);const o=new AZ(t,r,a);return lv.set(i,o),o}function lk(n=zb){const e=lv.get(n);if(!e&&n===zb&&IF())return FF();if(!e)throw Tu.create("no-app",{appName:n});return e}function il(n,e,t){let r=TZ[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),sc.warn(a.join(" "));return}dd(new Nu(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const kZ="firebase-heartbeat-database",IZ=1,Fp="firebase-heartbeat-store";let hT=null;function VF(){return hT||(hT=HY(kZ,IZ,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Fp)}catch(t){console.warn(t)}}}}).catch(n=>{throw Tu.create("idb-open",{originalErrorMessage:n.message})})),hT}async function CZ(n){try{const t=(await VF()).transaction(Fp),r=await t.objectStore(Fp).get(BF(n));return await t.done,r}catch(e){if(e instanceof vl)sc.warn(e.message);else{const t=Tu.create("idb-get",{originalErrorMessage:e?.message});sc.warn(t.message)}}}async function OM(n,e){try{const r=(await VF()).transaction(Fp,"readwrite");await r.objectStore(Fp).put(e,BF(n)),await r.done}catch(t){if(t instanceof vl)sc.warn(t.message);else{const r=Tu.create("idb-set",{originalErrorMessage:t?.message});sc.warn(r.message)}}}function BF(n){return`${n.name}!${n.options.appId}`}const PZ=1024,NZ=30;class MZ{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new OZ(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=DM();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>NZ){const i=DZ(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){sc.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=DM(),{heartbeatsToSend:t,unsentEntries:r}=LZ(this._heartbeatsCache.heartbeats),i=ov(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return sc.warn(e),""}}}function DM(){return new Date().toISOString().substring(0,10)}function LZ(n,e=PZ){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),jM(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),jM(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class OZ{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return OF()?EY().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await CZ(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return OM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return OM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function jM(n){return ov(JSON.stringify({version:2,heartbeats:n})).length}function DZ(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function jZ(n){dd(new Nu("platform-logger",e=>new qY(e),"PRIVATE")),dd(new Nu("heartbeat",e=>new MZ(e),"PRIVATE")),il(Gb,MM,n),il(Gb,MM,"esm2020"),il("fire-js","")}jZ("");function GF(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const FZ=GF,zF=new O1("auth","Firebase",GF());const cv=new ak("@firebase/auth");function VZ(n,...e){cv.logLevel<=_n.WARN&&cv.warn(`Auth (${Od}): ${n}`,...e)}function h_(n,...e){cv.logLevel<=_n.ERROR&&cv.error(`Auth (${Od}): ${n}`,...e)}function fl(n,...e){throw uk(n,...e)}function wo(n,...e){return uk(n,...e)}function ck(n,e,t){const r={...FZ(),[e]:t};return new O1("auth","Firebase",r).create(e,{appName:n.name})}function bu(n){return ck(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function BZ(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&fl(n,"argument-error"),ck(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function uk(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return zF.create(n,...e)}function Qt(n,e,...t){if(!n)throw uk(e,...t)}function Ul(n){const e="INTERNAL ASSERTION FAILED: "+n;throw h_(e),new Error(e)}function ac(n,e){n||Ul(e)}function $b(){return typeof self<"u"&&self.location?.href||""}function GZ(){return FM()==="http:"||FM()==="https:"}function FM(){return typeof self<"u"&&self.location?.protocol||null}function zZ(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(GZ()||_Y()||"connection"in navigator)?navigator.onLine:!0}function UZ(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class j1{constructor(e,t){this.shortDelay=e,this.longDelay=t,ac(t>e,"Short delay should be less than long delay!"),this.isMobile=xY()||vY()}get(){return zZ()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function hk(n,e){ac(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class UF{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ul("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ul("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ul("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const $Z={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const WZ=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],HZ=new j1(3e4,6e4);function Jw(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function dg(n,e,t,r,i={}){return $F(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const o=D1({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:e,headers:l,...s};return yY()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&Ld(n.emulatorConfig.host)&&(c.credentials="include"),UF.fetch()(await HF(n,n.config.apiHost,t,o),c)})}async function $F(n,e,t){n._canInitEmulator=!1;const r={...$Z,...e};try{const i=new KZ(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw My(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw My(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw My(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw My(n,"user-disabled",a);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw ck(n,h,c);fl(n,h)}}catch(i){if(i instanceof vl)throw i;fl(n,"network-request-failed",{message:String(i)})}}async function WF(n,e,t,r,i={}){const s=await dg(n,e,t,r,i);return"mfaPendingCredential"in s&&fl(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function HF(n,e,t,r){const i=`${e}${t}?${r}`,s=n,a=s.config.emulator?hk(n.config,i):`${n.config.apiScheme}://${i}`;return WZ.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}class KZ{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(wo(this.auth,"network-request-failed")),HZ.get())})}}function My(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=wo(n,e,r);return i.customData._tokenResponse=t,i}async function XZ(n,e){return dg(n,"POST","/v1/accounts:delete",e)}async function uv(n,e){return dg(n,"POST","/v1/accounts:lookup",e)}function Wm(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function qZ(n,e=!1){const t=Ni(n),r=await t.getIdToken(e),i=dk(r);Qt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:Wm(dT(i.auth_time)),issuedAtTime:Wm(dT(i.iat)),expirationTime:Wm(dT(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function dT(n){return Number(n)*1e3}function dk(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return h_("JWT malformed, contained fewer than 3 sections"),null;try{const i=bF(t);return i?JSON.parse(i):(h_("Failed to decode base64 JWT payload"),null)}catch(i){return h_("Caught error parsing JWT payload as JSON",i?.toString()),null}}function VM(n){const e=dk(n);return Qt(e,"internal-error"),Qt(typeof e.exp<"u","internal-error"),Qt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Vp(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof vl&&YZ(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function YZ({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class ZZ{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Wb{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wm(this.lastLoginAt),this.creationTime=Wm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function hv(n){const e=n.auth,t=await n.getIdToken(),r=await Vp(n,uv(e,{idToken:t}));Qt(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=i.providerUserInfo?.length?KF(i.providerUserInfo):[],a=QZ(n.providerData,s),o=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!a?.length,c=o?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Wb(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(n,h)}async function JZ(n){const e=Ni(n);await hv(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function QZ(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function KF(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function eJ(n,e){const t=await $F(n,{},async()=>{const r=D1({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await HF(n,i,"/v1/token",`key=${s}`),o=await n._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:r};return n.emulatorConfig&&Ld(n.emulatorConfig.host)&&(l.credentials="include"),UF.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function tJ(n,e){return dg(n,"POST","/v2/accounts:revokeToken",Jw(n,e))}class y0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Qt(e.idToken,"internal-error"),Qt(typeof e.idToken<"u","internal-error"),Qt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):VM(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Qt(e.length!==0,"internal-error");const t=VM(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Qt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await eJ(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new y0;return r&&(Qt(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Qt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Qt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new y0,this.toJSON())}_performRefresh(){return Ul("not implemented")}}function qc(n,e){Qt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class po{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new ZZ(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Wb(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Vp(this,this.stsTokenManager.getToken(this.auth,e));return Qt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return qZ(this,e)}reload(){return JZ(this)}_assign(e){this!==e&&(Qt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new po({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Qt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await hv(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ha(this.auth.app))return Promise.reject(bu(this.auth));const e=await this.getIdToken();return await Vp(this,XZ(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:g,emailVerified:m,isAnonymous:x,providerData:y,stsTokenManager:_}=t;Qt(g&&_,e,"internal-error");const w=y0.fromJSON(this.name,_);Qt(typeof g=="string",e,"internal-error"),qc(r,e.name),qc(i,e.name),Qt(typeof m=="boolean",e,"internal-error"),Qt(typeof x=="boolean",e,"internal-error"),qc(s,e.name),qc(a,e.name),qc(o,e.name),qc(l,e.name),qc(c,e.name),qc(h,e.name);const T=new po({uid:g,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:x,photoURL:a,phoneNumber:s,tenantId:o,stsTokenManager:w,createdAt:c,lastLoginAt:h});return y&&Array.isArray(y)&&(T.providerData=y.map(b=>({...b}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new y0;i.updateFromServerResponse(t);const s=new po({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await hv(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Qt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?KF(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,o=new y0;o.updateFromIdToken(r);const l=new po({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Wb(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,c),l}}const BM=new Map;function $l(n){ac(n instanceof Function,"Expected a class definition");let e=BM.get(n);return e?(ac(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,BM.set(n,e),e)}class XF{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}XF.type="NONE";const GM=XF;function d_(n,e,t){return`firebase:${n}:${e}:${t}`}class _0{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=d_(this.userKey,i.apiKey,s),this.fullPersistenceKey=d_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await uv(this.auth,{idToken:e}).catch(()=>{});return t?po._fromGetAccountInfoResponse(this.auth,t,e):null}return po._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new _0($l(GM),e,r);const i=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||$l(GM);const a=d_(r,e.config.apiKey,e.name);let o=null;for(const c of t)try{const h=await c._get(a);if(h){let g;if(typeof h=="string"){const m=await uv(e,{idToken:h}).catch(()=>{});if(!m)break;g=await po._fromGetAccountInfoResponse(e,m,h)}else g=po._fromJSON(e,h);c!==s&&(o=g),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new _0(s,e,r):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new _0(s,e,r))}}function zM(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(JF(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qF(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(e6(e))return"Blackberry";if(t6(e))return"Webos";if(YF(e))return"Safari";if((e.includes("chrome/")||ZF(e))&&!e.includes("edge/"))return"Chrome";if(QF(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function qF(n=mi()){return/firefox\//i.test(n)}function YF(n=mi()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ZF(n=mi()){return/crios\//i.test(n)}function JF(n=mi()){return/iemobile/i.test(n)}function QF(n=mi()){return/android/i.test(n)}function e6(n=mi()){return/blackberry/i.test(n)}function t6(n=mi()){return/webos/i.test(n)}function fk(n=mi()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function nJ(n=mi()){return fk(n)&&!!window.navigator?.standalone}function rJ(){return wY()&&document.documentMode===10}function n6(n=mi()){return fk(n)||QF(n)||t6(n)||e6(n)||/windows phone/i.test(n)||JF(n)}function r6(n,e=[]){let t;switch(n){case"Browser":t=zM(mi());break;case"Worker":t=`${zM(mi())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Od}/${r}`}class iJ{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function sJ(n,e={}){return dg(n,"GET","/v2/passwordPolicy",Jw(n,e))}const aJ=6;class oJ{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??aJ,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class lJ{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new UM(this),this.idTokenSubscription=new UM(this),this.beforeStateQueue=new iJ(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=zF,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=$l(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await _0.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await uv(this,{idToken:e}),r=await po._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ha(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,a=r?._redirectEventId,o=await this.tryRedirectSignIn(e);(!s||s===a)&&o?.user&&(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Qt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await hv(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=UZ()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ha(this.app))return Promise.reject(bu(this));const t=e?Ni(e):null;return t&&Qt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Qt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ha(this.app)?Promise.reject(bu(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ha(this.app)?Promise.reject(bu(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($l(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await sJ(this),t=new oJ(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new O1("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await tJ(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&$l(e)||this._popupRedirectResolver;Qt(t,this,"argument-error"),this.redirectPersistenceManager=await _0.create(this,[$l(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Qt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Qt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=r6(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ha(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&VZ(`Error while retrieving App Check token: ${e.error}`),e?.token}}function F1(n){return Ni(n)}class UM{constructor(e){this.auth=e,this.observer=null,this.addObserver=AY(t=>this.observer=t)}get next(){return Qt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let gk={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cJ(n){gk=n}function uJ(n){return gk.loadJS(n)}function hJ(){return gk.gapiScript}function dJ(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function fJ(n,e){const t=Zw(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(hd(s,e??{}))return i;fl(i,"already-initialized")}return t.initialize({options:e})}function gJ(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map($l);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function mJ(n,e,t){const r=F1(n);Qt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=i6(e),{host:a,port:o}=pJ(e),l=o===null?"":`:${o}`,c={url:`${s}//${a}${l}/`},h=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Qt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Qt(hd(c,r.config.emulator)&&hd(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Ld(a)?(ik(`${s}//${a}${l}`),sk("Auth",!0)):xJ()}function i6(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function pJ(n){const e=i6(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:$M(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:$M(a)}}}function $M(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function xJ(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class s6{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ul("not implemented")}_getIdTokenResponse(e){return Ul("not implemented")}_linkToIdToken(e,t){return Ul("not implemented")}_getReauthenticationResolver(e){return Ul("not implemented")}}async function v0(n,e){return WF(n,"POST","/v1/accounts:signInWithIdp",Jw(n,e))}const yJ="http://localhost";class fd extends s6{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new fd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):fl("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const a=new fd(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return v0(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,v0(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,v0(e,t)}buildRequest(){const e={requestUri:yJ,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=D1(t)}return e}}class mk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class V1 extends mk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class su extends V1{constructor(){super("facebook.com")}static credential(e){return fd._fromParams({providerId:su.PROVIDER_ID,signInMethod:su.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return su.credentialFromTaggedObject(e)}static credentialFromError(e){return su.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return su.credential(e.oauthAccessToken)}catch{return null}}}su.FACEBOOK_SIGN_IN_METHOD="facebook.com";su.PROVIDER_ID="facebook.com";class fo extends V1{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return fd._fromParams({providerId:fo.PROVIDER_ID,signInMethod:fo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return fo.credentialFromTaggedObject(e)}static credentialFromError(e){return fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return fo.credential(t,r)}catch{return null}}}fo.GOOGLE_SIGN_IN_METHOD="google.com";fo.PROVIDER_ID="google.com";class au extends V1{constructor(){super("github.com")}static credential(e){return fd._fromParams({providerId:au.PROVIDER_ID,signInMethod:au.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return au.credentialFromTaggedObject(e)}static credentialFromError(e){return au.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return au.credential(e.oauthAccessToken)}catch{return null}}}au.GITHUB_SIGN_IN_METHOD="github.com";au.PROVIDER_ID="github.com";class ou extends V1{constructor(){super("twitter.com")}static credential(e,t){return fd._fromParams({providerId:ou.PROVIDER_ID,signInMethod:ou.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ou.credentialFromTaggedObject(e)}static credentialFromError(e){return ou.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ou.credential(t,r)}catch{return null}}}ou.TWITTER_SIGN_IN_METHOD="twitter.com";ou.PROVIDER_ID="twitter.com";async function _J(n,e){return WF(n,"POST","/v1/accounts:signUp",Jw(n,e))}class Mu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await po._fromIdTokenResponse(e,r,i),a=WM(r);return new Mu({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=WM(r);return new Mu({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function WM(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function vJ(n){if(ha(n.app))return Promise.reject(bu(n));const e=F1(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Mu({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await _J(e,{returnSecureToken:!0}),r=await Mu._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class dv extends vl{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,dv.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new dv(e,t,r,i)}}function a6(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?dv._fromErrorAndOperation(n,s,e,r):s})}async function wJ(n,e,t=!1){const r=await Vp(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Mu._forOperation(n,"link",r)}async function EJ(n,e,t=!1){const{auth:r}=n;if(ha(r.app))return Promise.reject(bu(r));const i="reauthenticate";try{const s=await Vp(n,a6(r,i,e,n),t);Qt(s.idToken,r,"internal-error");const a=dk(s.idToken);Qt(a,r,"internal-error");const{sub:o}=a;return Qt(n.uid===o,r,"user-mismatch"),Mu._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&fl(r,"user-mismatch"),s}}async function SJ(n,e,t=!1){if(ha(n.app))return Promise.reject(bu(n));const r="signIn",i=await a6(n,r,e),s=await Mu._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}function TJ(n,e,t,r){return Ni(n).onIdTokenChanged(e,t,r)}function bJ(n,e,t){return Ni(n).beforeAuthStateChanged(e,t)}function o6(n,e,t,r){return Ni(n).onAuthStateChanged(e,t,r)}function l6(n){return Ni(n).signOut()}const fv="__sak";class c6{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(fv,"1"),this.storage.removeItem(fv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const RJ=1e3,AJ=10;class u6 extends c6{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=n6(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);rJ()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,AJ):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},RJ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}u6.type="LOCAL";const kJ=u6;class h6 extends c6{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}h6.type="SESSION";const d6=h6;function IJ(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Qw{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Qw(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const o=Array.from(a).map(async c=>c(t.origin,s)),l=await IJ(o);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qw.receivers=[];function pk(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class CJ{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=pk("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(g){const m=g;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(m.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function sl(){return window}function PJ(n){sl().location.href=n}function f6(){return typeof sl().WorkerGlobalScope<"u"&&typeof sl().importScripts=="function"}async function NJ(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function MJ(){return navigator?.serviceWorker?.controller||null}function LJ(){return f6()?self:null}const g6="firebaseLocalStorageDb",OJ=1,gv="firebaseLocalStorage",m6="fbase_key";class B1{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function eE(n,e){return n.transaction([gv],e?"readwrite":"readonly").objectStore(gv)}function DJ(){const n=indexedDB.deleteDatabase(g6);return new B1(n).toPromise()}function Hb(){const n=indexedDB.open(g6,OJ);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(gv,{keyPath:m6})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(gv)?e(r):(r.close(),await DJ(),e(await Hb()))})})}async function HM(n,e,t){const r=eE(n,!0).put({[m6]:e,value:t});return new B1(r).toPromise()}async function jJ(n,e){const t=eE(n,!1).get(e),r=await new B1(t).toPromise();return r===void 0?null:r.value}function KM(n,e){const t=eE(n,!0).delete(e);return new B1(t).toPromise()}const FJ=800,VJ=3;class p6{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Hb(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>VJ)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return f6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qw._getInstance(LJ()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await NJ(),!this.activeServiceWorker)return;this.sender=new CJ(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||MJ()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Hb();return await HM(e,fv,"1"),await KM(e,fv),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>HM(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>jJ(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>KM(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=eE(i,!1).getAll();return new B1(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),FJ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}p6.type="LOCAL";const BJ=p6;new j1(3e4,6e4);function x6(n,e){return e?$l(e):(Qt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class xk extends s6{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return v0(e,this._buildIdpRequest())}_linkToIdToken(e,t){return v0(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return v0(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function GJ(n){return SJ(n.auth,new xk(n),n.bypassAuthState)}function zJ(n){const{auth:e,user:t}=n;return Qt(t,e,"internal-error"),EJ(t,new xk(n),n.bypassAuthState)}async function UJ(n){const{auth:e,user:t}=n;return Qt(t,e,"internal-error"),wJ(t,new xk(n),n.bypassAuthState)}class y6{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return GJ;case"linkViaPopup":case"linkViaRedirect":return UJ;case"reauthViaPopup":case"reauthViaRedirect":return zJ;default:fl(this.auth,"internal-error")}}resolve(e){ac(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ac(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const $J=new j1(2e3,1e4);async function XM(n,e,t){if(ha(n.app))return Promise.reject(wo(n,"operation-not-supported-in-this-environment"));const r=F1(n);BZ(n,e,mk);const i=x6(r,t);return new $h(r,"signInViaPopup",e,i).executeNotNull()}class $h extends y6{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,$h.currentPopupAction&&$h.currentPopupAction.cancel(),$h.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Qt(e,this.auth,"internal-error"),e}async onExecution(){ac(this.filter.length===1,"Popup operations only handle one event");const e=pk();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(wo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(wo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$h.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(wo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,$J.get())};e()}}$h.currentPopupAction=null;const WJ="pendingRedirect",f_=new Map;class HJ extends y6{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=f_.get(this.auth._key());if(!e){try{const r=await KJ(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}f_.set(this.auth._key(),e)}return this.bypassAuthState||f_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function KJ(n,e){const t=YJ(e),r=qJ(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function XJ(n,e){f_.set(n._key(),e)}function qJ(n){return $l(n._redirectPersistence)}function YJ(n){return d_(WJ,n.config.apiKey,n.name)}async function ZJ(n,e,t=!1){if(ha(n.app))return Promise.reject(bu(n));const r=F1(n),i=x6(r,e),a=await new HJ(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const JJ=600*1e3;class QJ{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!eQ(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!_6(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(wo(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=JJ&&this.cachedEventUids.clear(),this.cachedEventUids.has(qM(e))}saveEventToCache(e){this.cachedEventUids.add(qM(e)),this.lastProcessedEventTime=Date.now()}}function qM(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function _6({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function eQ(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _6(n);default:return!1}}async function tQ(n,e={}){return dg(n,"GET","/v1/projects",e)}const nQ=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rQ=/^https?/;async function iQ(n){if(n.config.emulator)return;const{authorizedDomains:e}=await tQ(n);for(const t of e)try{if(sQ(t))return}catch{}fl(n,"unauthorized-domain")}function sQ(n){const e=$b(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!rQ.test(t))return!1;if(nQ.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const aQ=new j1(3e4,6e4);function YM(){const n=sl().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function oQ(n){return new Promise((e,t)=>{function r(){YM(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{YM(),t(wo(n,"network-request-failed"))},timeout:aQ.get()})}if(sl().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(sl().gapi?.load)r();else{const i=dJ("iframefcb");return sl()[i]=()=>{gapi.load?r():t(wo(n,"network-request-failed"))},uJ(`${hJ()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw g_=null,e})}let g_=null;function lQ(n){return g_=g_||oQ(n),g_}const cQ=new j1(5e3,15e3),uQ="__/auth/iframe",hQ="emulator/auth/iframe",dQ={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fQ=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gQ(n){const e=n.config;Qt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?hk(e,hQ):`https://${n.config.authDomain}/${uQ}`,r={apiKey:e.apiKey,appName:n.name,v:Od},i=fQ.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${D1(r).slice(1)}`}async function mQ(n){const e=await lQ(n),t=sl().gapi;return Qt(t,n,"internal-error"),e.open({where:document.body,url:gQ(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:dQ,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=wo(n,"network-request-failed"),o=sl().setTimeout(()=>{s(a)},cQ.get());function l(){sl().clearTimeout(o),i(r)}r.ping(l).then(l,()=>{s(a)})}))}const pQ={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},xQ=500,yQ=600,_Q="_blank",vQ="http://localhost";class ZM{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function wQ(n,e,t,r=xQ,i=yQ){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={...pQ,width:r.toString(),height:i.toString(),top:s,left:a},c=mi().toLowerCase();t&&(o=ZF(c)?_Q:t),qF(c)&&(e=e||vQ,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[x,y])=>`${m}${x}=${y},`,"");if(nJ(c)&&o!=="_self")return EQ(e||"",o),new ZM(null);const g=window.open(e||"",o,h);Qt(g,n,"popup-blocked");try{g.focus()}catch{}return new ZM(g)}function EQ(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const SQ="__/auth/handler",TQ="emulator/auth/handler",bQ=encodeURIComponent("fac");async function JM(n,e,t,r,i,s){Qt(n.config.authDomain,n,"auth-domain-config-required"),Qt(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Od,eventId:i};if(e instanceof mk){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",RY(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,g]of Object.entries({}))a[h]=g}if(e instanceof V1){const h=e.getScopes().filter(g=>g!=="");h.length>0&&(a.scopes=h.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const l=await n._getAppCheckToken(),c=l?`#${bQ}=${encodeURIComponent(l)}`:"";return`${RQ(n)}?${D1(o).slice(1)}${c}`}function RQ({config:n}){return n.emulator?hk(n,TQ):`https://${n.authDomain}/${SQ}`}const fT="webStorageSupport";class AQ{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=d6,this._completeRedirectFn=ZJ,this._overrideRedirectResult=XJ}async _openPopup(e,t,r,i){ac(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await JM(e,t,r,$b(),i);return wQ(e,s,pk())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await JM(e,t,r,$b(),i);return PJ(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(ac(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await mQ(e),r=new QJ(e);return t.register("authEvent",i=>(Qt(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(fT,{type:fT},i=>{const s=i?.[0]?.[fT];s!==void 0&&t(!!s),fl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=iQ(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return n6()||YF()||fk()}}const kQ=AQ;var QM="@firebase/auth",eL="1.12.0";class IQ{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Qt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function CQ(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function PQ(n){dd(new Nu("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Qt(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:r6(n)},c=new lJ(r,i,s,l);return gJ(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),dd(new Nu("auth-internal",e=>{const t=F1(e.getProvider("auth").getImmediate());return(r=>new IQ(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),il(QM,eL,CQ(n)),il(QM,eL,"esm2020")}const NQ=300,MQ=CF("authIdTokenMaxAge")||NQ;let tL=null;const LQ=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>MQ)return;const i=t?.token;tL!==i&&(tL=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function OQ(n=lk()){const e=Zw(n,"auth");if(e.isInitialized())return e.getImmediate();const t=fJ(n,{popupRedirectResolver:kQ,persistence:[BJ,kJ,d6]}),r=CF("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=LQ(s.toString());bJ(t,a,()=>a(t.currentUser)),TJ(t,o=>a(o))}}const i=AF("auth");return i&&mJ(t,`http://${i}`),t}function DQ(){return document.getElementsByTagName("head")?.[0]??document}cJ({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=wo("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",DQ().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});PQ("Browser");var jQ="firebase",FQ="12.7.0";il(jQ,FQ,"app");var nL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ru,v6;(function(){var n;function e(k,A){function C(){}C.prototype=A.prototype,k.F=A.prototype,k.prototype=new C,k.prototype.constructor=k,k.D=function(O,P,z){for(var F=Array(arguments.length-2),xe=2;xe<arguments.length;xe++)F[xe-2]=arguments[xe];return A.prototype[P].apply(O,F)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(k,A,C){C||(C=0);const O=Array(16);if(typeof A=="string")for(var P=0;P<16;++P)O[P]=A.charCodeAt(C++)|A.charCodeAt(C++)<<8|A.charCodeAt(C++)<<16|A.charCodeAt(C++)<<24;else for(P=0;P<16;++P)O[P]=A[C++]|A[C++]<<8|A[C++]<<16|A[C++]<<24;A=k.g[0],C=k.g[1],P=k.g[2];let z=k.g[3],F;F=A+(z^C&(P^z))+O[0]+3614090360&4294967295,A=C+(F<<7&4294967295|F>>>25),F=z+(P^A&(C^P))+O[1]+3905402710&4294967295,z=A+(F<<12&4294967295|F>>>20),F=P+(C^z&(A^C))+O[2]+606105819&4294967295,P=z+(F<<17&4294967295|F>>>15),F=C+(A^P&(z^A))+O[3]+3250441966&4294967295,C=P+(F<<22&4294967295|F>>>10),F=A+(z^C&(P^z))+O[4]+4118548399&4294967295,A=C+(F<<7&4294967295|F>>>25),F=z+(P^A&(C^P))+O[5]+1200080426&4294967295,z=A+(F<<12&4294967295|F>>>20),F=P+(C^z&(A^C))+O[6]+2821735955&4294967295,P=z+(F<<17&4294967295|F>>>15),F=C+(A^P&(z^A))+O[7]+4249261313&4294967295,C=P+(F<<22&4294967295|F>>>10),F=A+(z^C&(P^z))+O[8]+1770035416&4294967295,A=C+(F<<7&4294967295|F>>>25),F=z+(P^A&(C^P))+O[9]+2336552879&4294967295,z=A+(F<<12&4294967295|F>>>20),F=P+(C^z&(A^C))+O[10]+4294925233&4294967295,P=z+(F<<17&4294967295|F>>>15),F=C+(A^P&(z^A))+O[11]+2304563134&4294967295,C=P+(F<<22&4294967295|F>>>10),F=A+(z^C&(P^z))+O[12]+1804603682&4294967295,A=C+(F<<7&4294967295|F>>>25),F=z+(P^A&(C^P))+O[13]+4254626195&4294967295,z=A+(F<<12&4294967295|F>>>20),F=P+(C^z&(A^C))+O[14]+2792965006&4294967295,P=z+(F<<17&4294967295|F>>>15),F=C+(A^P&(z^A))+O[15]+1236535329&4294967295,C=P+(F<<22&4294967295|F>>>10),F=A+(P^z&(C^P))+O[1]+4129170786&4294967295,A=C+(F<<5&4294967295|F>>>27),F=z+(C^P&(A^C))+O[6]+3225465664&4294967295,z=A+(F<<9&4294967295|F>>>23),F=P+(A^C&(z^A))+O[11]+643717713&4294967295,P=z+(F<<14&4294967295|F>>>18),F=C+(z^A&(P^z))+O[0]+3921069994&4294967295,C=P+(F<<20&4294967295|F>>>12),F=A+(P^z&(C^P))+O[5]+3593408605&4294967295,A=C+(F<<5&4294967295|F>>>27),F=z+(C^P&(A^C))+O[10]+38016083&4294967295,z=A+(F<<9&4294967295|F>>>23),F=P+(A^C&(z^A))+O[15]+3634488961&4294967295,P=z+(F<<14&4294967295|F>>>18),F=C+(z^A&(P^z))+O[4]+3889429448&4294967295,C=P+(F<<20&4294967295|F>>>12),F=A+(P^z&(C^P))+O[9]+568446438&4294967295,A=C+(F<<5&4294967295|F>>>27),F=z+(C^P&(A^C))+O[14]+3275163606&4294967295,z=A+(F<<9&4294967295|F>>>23),F=P+(A^C&(z^A))+O[3]+4107603335&4294967295,P=z+(F<<14&4294967295|F>>>18),F=C+(z^A&(P^z))+O[8]+1163531501&4294967295,C=P+(F<<20&4294967295|F>>>12),F=A+(P^z&(C^P))+O[13]+2850285829&4294967295,A=C+(F<<5&4294967295|F>>>27),F=z+(C^P&(A^C))+O[2]+4243563512&4294967295,z=A+(F<<9&4294967295|F>>>23),F=P+(A^C&(z^A))+O[7]+1735328473&4294967295,P=z+(F<<14&4294967295|F>>>18),F=C+(z^A&(P^z))+O[12]+2368359562&4294967295,C=P+(F<<20&4294967295|F>>>12),F=A+(C^P^z)+O[5]+4294588738&4294967295,A=C+(F<<4&4294967295|F>>>28),F=z+(A^C^P)+O[8]+2272392833&4294967295,z=A+(F<<11&4294967295|F>>>21),F=P+(z^A^C)+O[11]+1839030562&4294967295,P=z+(F<<16&4294967295|F>>>16),F=C+(P^z^A)+O[14]+4259657740&4294967295,C=P+(F<<23&4294967295|F>>>9),F=A+(C^P^z)+O[1]+2763975236&4294967295,A=C+(F<<4&4294967295|F>>>28),F=z+(A^C^P)+O[4]+1272893353&4294967295,z=A+(F<<11&4294967295|F>>>21),F=P+(z^A^C)+O[7]+4139469664&4294967295,P=z+(F<<16&4294967295|F>>>16),F=C+(P^z^A)+O[10]+3200236656&4294967295,C=P+(F<<23&4294967295|F>>>9),F=A+(C^P^z)+O[13]+681279174&4294967295,A=C+(F<<4&4294967295|F>>>28),F=z+(A^C^P)+O[0]+3936430074&4294967295,z=A+(F<<11&4294967295|F>>>21),F=P+(z^A^C)+O[3]+3572445317&4294967295,P=z+(F<<16&4294967295|F>>>16),F=C+(P^z^A)+O[6]+76029189&4294967295,C=P+(F<<23&4294967295|F>>>9),F=A+(C^P^z)+O[9]+3654602809&4294967295,A=C+(F<<4&4294967295|F>>>28),F=z+(A^C^P)+O[12]+3873151461&4294967295,z=A+(F<<11&4294967295|F>>>21),F=P+(z^A^C)+O[15]+530742520&4294967295,P=z+(F<<16&4294967295|F>>>16),F=C+(P^z^A)+O[2]+3299628645&4294967295,C=P+(F<<23&4294967295|F>>>9),F=A+(P^(C|~z))+O[0]+4096336452&4294967295,A=C+(F<<6&4294967295|F>>>26),F=z+(C^(A|~P))+O[7]+1126891415&4294967295,z=A+(F<<10&4294967295|F>>>22),F=P+(A^(z|~C))+O[14]+2878612391&4294967295,P=z+(F<<15&4294967295|F>>>17),F=C+(z^(P|~A))+O[5]+4237533241&4294967295,C=P+(F<<21&4294967295|F>>>11),F=A+(P^(C|~z))+O[12]+1700485571&4294967295,A=C+(F<<6&4294967295|F>>>26),F=z+(C^(A|~P))+O[3]+2399980690&4294967295,z=A+(F<<10&4294967295|F>>>22),F=P+(A^(z|~C))+O[10]+4293915773&4294967295,P=z+(F<<15&4294967295|F>>>17),F=C+(z^(P|~A))+O[1]+2240044497&4294967295,C=P+(F<<21&4294967295|F>>>11),F=A+(P^(C|~z))+O[8]+1873313359&4294967295,A=C+(F<<6&4294967295|F>>>26),F=z+(C^(A|~P))+O[15]+4264355552&4294967295,z=A+(F<<10&4294967295|F>>>22),F=P+(A^(z|~C))+O[6]+2734768916&4294967295,P=z+(F<<15&4294967295|F>>>17),F=C+(z^(P|~A))+O[13]+1309151649&4294967295,C=P+(F<<21&4294967295|F>>>11),F=A+(P^(C|~z))+O[4]+4149444226&4294967295,A=C+(F<<6&4294967295|F>>>26),F=z+(C^(A|~P))+O[11]+3174756917&4294967295,z=A+(F<<10&4294967295|F>>>22),F=P+(A^(z|~C))+O[2]+718787259&4294967295,P=z+(F<<15&4294967295|F>>>17),F=C+(z^(P|~A))+O[9]+3951481745&4294967295,k.g[0]=k.g[0]+A&4294967295,k.g[1]=k.g[1]+(P+(F<<21&4294967295|F>>>11))&4294967295,k.g[2]=k.g[2]+P&4294967295,k.g[3]=k.g[3]+z&4294967295}r.prototype.v=function(k,A){A===void 0&&(A=k.length);const C=A-this.blockSize,O=this.C;let P=this.h,z=0;for(;z<A;){if(P==0)for(;z<=C;)i(this,k,z),z+=this.blockSize;if(typeof k=="string"){for(;z<A;)if(O[P++]=k.charCodeAt(z++),P==this.blockSize){i(this,O),P=0;break}}else for(;z<A;)if(O[P++]=k[z++],P==this.blockSize){i(this,O),P=0;break}}this.h=P,this.o+=A},r.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var A=1;A<k.length-8;++A)k[A]=0;A=this.o*8;for(var C=k.length-8;C<k.length;++C)k[C]=A&255,A/=256;for(this.v(k),k=Array(16),A=0,C=0;C<4;++C)for(let O=0;O<32;O+=8)k[A++]=this.g[C]>>>O&255;return k};function s(k,A){var C=o;return Object.prototype.hasOwnProperty.call(C,k)?C[k]:C[k]=A(k)}function a(k,A){this.h=A;const C=[];let O=!0;for(let P=k.length-1;P>=0;P--){const z=k[P]|0;O&&z==A||(C[P]=z,O=!1)}this.g=C}var o={};function l(k){return-128<=k&&k<128?s(k,function(A){return new a([A|0],A<0?-1:0)}):new a([k|0],k<0?-1:0)}function c(k){if(isNaN(k)||!isFinite(k))return g;if(k<0)return w(c(-k));const A=[];let C=1;for(let O=0;k>=C;O++)A[O]=k/C|0,C*=4294967296;return new a(A,0)}function h(k,A){if(k.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(k.charAt(0)=="-")return w(h(k.substring(1),A));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=c(Math.pow(A,8));let O=g;for(let z=0;z<k.length;z+=8){var P=Math.min(8,k.length-z);const F=parseInt(k.substring(z,z+P),A);P<8?(P=c(Math.pow(A,P)),O=O.j(P).add(c(F))):(O=O.j(C),O=O.add(c(F)))}return O}var g=l(0),m=l(1),x=l(16777216);n=a.prototype,n.m=function(){if(_(this))return-w(this).m();let k=0,A=1;for(let C=0;C<this.g.length;C++){const O=this.i(C);k+=(O>=0?O:4294967296+O)*A,A*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(y(this))return"0";if(_(this))return"-"+w(this).toString(k);const A=c(Math.pow(k,6));var C=this;let O="";for(;;){const P=M(C,A).g;C=T(C,P.j(A));let z=((C.g.length>0?C.g[0]:C.h)>>>0).toString(k);if(C=P,y(C))return z+O;for(;z.length<6;)z="0"+z;O=z+O}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function y(k){if(k.h!=0)return!1;for(let A=0;A<k.g.length;A++)if(k.g[A]!=0)return!1;return!0}function _(k){return k.h==-1}n.l=function(k){return k=T(this,k),_(k)?-1:y(k)?0:1};function w(k){const A=k.g.length,C=[];for(let O=0;O<A;O++)C[O]=~k.g[O];return new a(C,~k.h).add(m)}n.abs=function(){return _(this)?w(this):this},n.add=function(k){const A=Math.max(this.g.length,k.g.length),C=[];let O=0;for(let P=0;P<=A;P++){let z=O+(this.i(P)&65535)+(k.i(P)&65535),F=(z>>>16)+(this.i(P)>>>16)+(k.i(P)>>>16);O=F>>>16,z&=65535,F&=65535,C[P]=F<<16|z}return new a(C,C[C.length-1]&-2147483648?-1:0)};function T(k,A){return k.add(w(A))}n.j=function(k){if(y(this)||y(k))return g;if(_(this))return _(k)?w(this).j(w(k)):w(w(this).j(k));if(_(k))return w(this.j(w(k)));if(this.l(x)<0&&k.l(x)<0)return c(this.m()*k.m());const A=this.g.length+k.g.length,C=[];for(var O=0;O<2*A;O++)C[O]=0;for(O=0;O<this.g.length;O++)for(let P=0;P<k.g.length;P++){const z=this.i(O)>>>16,F=this.i(O)&65535,xe=k.i(P)>>>16,Ce=k.i(P)&65535;C[2*O+2*P]+=F*Ce,b(C,2*O+2*P),C[2*O+2*P+1]+=z*Ce,b(C,2*O+2*P+1),C[2*O+2*P+1]+=F*xe,b(C,2*O+2*P+1),C[2*O+2*P+2]+=z*xe,b(C,2*O+2*P+2)}for(k=0;k<A;k++)C[k]=C[2*k+1]<<16|C[2*k];for(k=A;k<2*A;k++)C[k]=0;return new a(C,0)};function b(k,A){for(;(k[A]&65535)!=k[A];)k[A+1]+=k[A]>>>16,k[A]&=65535,A++}function R(k,A){this.g=k,this.h=A}function M(k,A){if(y(A))throw Error("division by zero");if(y(k))return new R(g,g);if(_(k))return A=M(w(k),A),new R(w(A.g),w(A.h));if(_(A))return A=M(k,w(A)),new R(w(A.g),A.h);if(k.g.length>30){if(_(k)||_(A))throw Error("slowDivide_ only works with positive integers.");for(var C=m,O=A;O.l(k)<=0;)C=D(C),O=D(O);var P=B(C,1),z=B(O,1);for(O=B(O,2),C=B(C,2);!y(O);){var F=z.add(O);F.l(k)<=0&&(P=P.add(C),z=F),O=B(O,1),C=B(C,1)}return A=T(k,P.j(A)),new R(P,A)}for(P=g;k.l(A)>=0;){for(C=Math.max(1,Math.floor(k.m()/A.m())),O=Math.ceil(Math.log(C)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),z=c(C),F=z.j(A);_(F)||F.l(k)>0;)C-=O,z=c(C),F=z.j(A);y(z)&&(z=m),P=P.add(z),k=T(k,F)}return new R(P,k)}n.B=function(k){return M(this,k).h},n.and=function(k){const A=Math.max(this.g.length,k.g.length),C=[];for(let O=0;O<A;O++)C[O]=this.i(O)&k.i(O);return new a(C,this.h&k.h)},n.or=function(k){const A=Math.max(this.g.length,k.g.length),C=[];for(let O=0;O<A;O++)C[O]=this.i(O)|k.i(O);return new a(C,this.h|k.h)},n.xor=function(k){const A=Math.max(this.g.length,k.g.length),C=[];for(let O=0;O<A;O++)C[O]=this.i(O)^k.i(O);return new a(C,this.h^k.h)};function D(k){const A=k.g.length+1,C=[];for(let O=0;O<A;O++)C[O]=k.i(O)<<1|k.i(O-1)>>>31;return new a(C,k.h)}function B(k,A){const C=A>>5;A%=32;const O=k.g.length-C,P=[];for(let z=0;z<O;z++)P[z]=A>0?k.i(z+C)>>>A|k.i(z+C+1)<<32-A:k.i(z+C);return new a(P,k.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,v6=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=h,Ru=a}).apply(typeof nL<"u"?nL:typeof self<"u"?self:typeof window<"u"?window:{});var Ly=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var w6,km,E6,m_,Kb,S6,T6,b6;(function(){var n,e=Object.defineProperty;function t(v){v=[typeof globalThis=="object"&&globalThis,v,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ly=="object"&&Ly];for(var N=0;N<v.length;++N){var j=v[N];if(j&&j.Math==Math)return j}throw Error("Cannot find global object")}var r=t(this);function i(v,N){if(N)e:{var j=r;v=v.split(".");for(var K=0;K<v.length-1;K++){var ge=v[K];if(!(ge in j))break e;j=j[ge]}v=v[v.length-1],K=j[v],N=N(K),N!=K&&N!=null&&e(j,v,{configurable:!0,writable:!0,value:N})}}i("Symbol.dispose",function(v){return v||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(v){return v||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(v){return v||function(N){var j=[],K;for(K in N)Object.prototype.hasOwnProperty.call(N,K)&&j.push([K,N[K]]);return j}});var s=s||{},a=this||self;function o(v){var N=typeof v;return N=="object"&&v!=null||N=="function"}function l(v,N,j){return v.call.apply(v.bind,arguments)}function c(v,N,j){return c=l,c.apply(null,arguments)}function h(v,N){var j=Array.prototype.slice.call(arguments,1);return function(){var K=j.slice();return K.push.apply(K,arguments),v.apply(this,K)}}function g(v,N){function j(){}j.prototype=N.prototype,v.Z=N.prototype,v.prototype=new j,v.prototype.constructor=v,v.Ob=function(K,ge,Ie){for(var lt=Array(arguments.length-2),sn=2;sn<arguments.length;sn++)lt[sn-2]=arguments[sn];return N.prototype[ge].apply(K,lt)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?v=>v&&AsyncContext.Snapshot.wrap(v):v=>v;function x(v){const N=v.length;if(N>0){const j=Array(N);for(let K=0;K<N;K++)j[K]=v[K];return j}return[]}function y(v,N){for(let K=1;K<arguments.length;K++){const ge=arguments[K];var j=typeof ge;if(j=j!="object"?j:ge?Array.isArray(ge)?"array":j:"null",j=="array"||j=="object"&&typeof ge.length=="number"){j=v.length||0;const Ie=ge.length||0;v.length=j+Ie;for(let lt=0;lt<Ie;lt++)v[j+lt]=ge[lt]}else v.push(ge)}}class _{constructor(N,j){this.i=N,this.j=j,this.h=0,this.g=null}get(){let N;return this.h>0?(this.h--,N=this.g,this.g=N.next,N.next=null):N=this.i(),N}}function w(v){a.setTimeout(()=>{throw v},0)}function T(){var v=k;let N=null;return v.g&&(N=v.g,v.g=v.g.next,v.g||(v.h=null),N.next=null),N}class b{constructor(){this.h=this.g=null}add(N,j){const K=R.get();K.set(N,j),this.h?this.h.next=K:this.g=K,this.h=K}}var R=new _(()=>new M,v=>v.reset());class M{constructor(){this.next=this.g=this.h=null}set(N,j){this.h=N,this.g=j,this.next=null}reset(){this.next=this.g=this.h=null}}let D,B=!1,k=new b,A=()=>{const v=Promise.resolve(void 0);D=()=>{v.then(C)}};function C(){for(var v;v=T();){try{v.h.call(v.g)}catch(j){w(j)}var N=R;N.j(v),N.h<100&&(N.h++,v.next=N.g,N.g=v)}B=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(v,N){this.type=v,this.g=this.target=N,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var v=!1,N=Object.defineProperty({},"passive",{get:function(){v=!0}});try{const j=()=>{};a.addEventListener("test",j,N),a.removeEventListener("test",j,N)}catch{}return v})();function F(v){return/^[\s\xa0]*$/.test(v)}function xe(v,N){P.call(this,v?v.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,v&&this.init(v,N)}g(xe,P),xe.prototype.init=function(v,N){const j=this.type=v.type,K=v.changedTouches&&v.changedTouches.length?v.changedTouches[0]:null;this.target=v.target||v.srcElement,this.g=N,N=v.relatedTarget,N||(j=="mouseover"?N=v.fromElement:j=="mouseout"&&(N=v.toElement)),this.relatedTarget=N,K?(this.clientX=K.clientX!==void 0?K.clientX:K.pageX,this.clientY=K.clientY!==void 0?K.clientY:K.pageY,this.screenX=K.screenX||0,this.screenY=K.screenY||0):(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0),this.button=v.button,this.key=v.key||"",this.ctrlKey=v.ctrlKey,this.altKey=v.altKey,this.shiftKey=v.shiftKey,this.metaKey=v.metaKey,this.pointerId=v.pointerId||0,this.pointerType=v.pointerType,this.state=v.state,this.i=v,v.defaultPrevented&&xe.Z.h.call(this)},xe.prototype.h=function(){xe.Z.h.call(this);const v=this.i;v.preventDefault?v.preventDefault():v.returnValue=!1};var Ce="closure_listenable_"+(Math.random()*1e6|0),Ge=0;function Ne(v,N,j,K,ge){this.listener=v,this.proxy=null,this.src=N,this.type=j,this.capture=!!K,this.ha=ge,this.key=++Ge,this.da=this.fa=!1}function ue(v){v.da=!0,v.listener=null,v.proxy=null,v.src=null,v.ha=null}function ke(v,N,j){for(const K in v)N.call(j,v[K],K,v)}function ae(v,N){for(const j in v)N.call(void 0,v[j],j,v)}function Z(v){const N={};for(const j in v)N[j]=v[j];return N}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(v,N){let j,K;for(let ge=1;ge<arguments.length;ge++){K=arguments[ge];for(j in K)v[j]=K[j];for(let Ie=0;Ie<V.length;Ie++)j=V[Ie],Object.prototype.hasOwnProperty.call(K,j)&&(v[j]=K[j])}}function ee(v){this.src=v,this.g={},this.h=0}ee.prototype.add=function(v,N,j,K,ge){const Ie=v.toString();v=this.g[Ie],v||(v=this.g[Ie]=[],this.h++);const lt=he(v,N,K,ge);return lt>-1?(N=v[lt],j||(N.fa=!1)):(N=new Ne(N,this.src,Ie,!!K,ge),N.fa=j,v.push(N)),N};function re(v,N){const j=N.type;if(j in v.g){var K=v.g[j],ge=Array.prototype.indexOf.call(K,N,void 0),Ie;(Ie=ge>=0)&&Array.prototype.splice.call(K,ge,1),Ie&&(ue(N),v.g[j].length==0&&(delete v.g[j],v.h--))}}function he(v,N,j,K){for(let ge=0;ge<v.length;++ge){const Ie=v[ge];if(!Ie.da&&Ie.listener==N&&Ie.capture==!!j&&Ie.ha==K)return ge}return-1}var Ve="closure_lm_"+(Math.random()*1e6|0),Be={};function ye(v,N,j,K,ge){if(Array.isArray(N)){for(let Ie=0;Ie<N.length;Ie++)ye(v,N[Ie],j,K,ge);return null}return j=tr(j),v&&v[Ce]?v.J(N,j,o(K)?!!K.capture:!1,ge):pe(v,N,j,!1,K,ge)}function pe(v,N,j,K,ge,Ie){if(!N)throw Error("Invalid event type");const lt=o(ge)?!!ge.capture:!!ge;let sn=en(v);if(sn||(v[Ve]=sn=new ee(v)),j=sn.add(N,j,K,lt,Ie),j.proxy)return j;if(K=Fe(),j.proxy=K,K.src=v,K.listener=j,v.addEventListener)z||(ge=lt),ge===void 0&&(ge=!1),v.addEventListener(N.toString(),K,ge);else if(v.attachEvent)v.attachEvent(Dt(N.toString()),K);else if(v.addListener&&v.removeListener)v.addListener(K);else throw Error("addEventListener and attachEvent are unavailable.");return j}function Fe(){function v(j){return N.call(v.src,v.listener,j)}const N=Xt;return v}function Et(v,N,j,K,ge){if(Array.isArray(N))for(var Ie=0;Ie<N.length;Ie++)Et(v,N[Ie],j,K,ge);else K=o(K)?!!K.capture:!!K,j=tr(j),v&&v[Ce]?(v=v.i,Ie=String(N).toString(),Ie in v.g&&(N=v.g[Ie],j=he(N,j,K,ge),j>-1&&(ue(N[j]),Array.prototype.splice.call(N,j,1),N.length==0&&(delete v.g[Ie],v.h--)))):v&&(v=en(v))&&(N=v.g[N.toString()],v=-1,N&&(v=he(N,j,K,ge)),(j=v>-1?N[v]:null)&&Ft(j))}function Ft(v){if(typeof v!="number"&&v&&!v.da){var N=v.src;if(N&&N[Ce])re(N.i,v);else{var j=v.type,K=v.proxy;N.removeEventListener?N.removeEventListener(j,K,v.capture):N.detachEvent?N.detachEvent(Dt(j),K):N.addListener&&N.removeListener&&N.removeListener(K),(j=en(N))?(re(j,v),j.h==0&&(j.src=null,N[Ve]=null)):ue(v)}}}function Dt(v){return v in Be?Be[v]:Be[v]="on"+v}function Xt(v,N){if(v.da)v=!0;else{N=new xe(N,this);const j=v.listener,K=v.ha||v.src;v.fa&&Ft(v),v=j.call(K,N)}return v}function en(v){return v=v[Ve],v instanceof ee?v:null}var ot="__closure_events_fn_"+(Math.random()*1e9>>>0);function tr(v){return typeof v=="function"?v:(v[ot]||(v[ot]=function(N){return v.handleEvent(N)}),v[ot])}function dn(){O.call(this),this.i=new ee(this),this.M=this,this.G=null}g(dn,O),dn.prototype[Ce]=!0,dn.prototype.removeEventListener=function(v,N,j,K){Et(this,v,N,j,K)};function un(v,N){var j,K=v.G;if(K)for(j=[];K;K=K.G)j.push(K);if(v=v.M,K=N.type||N,typeof N=="string")N=new P(N,v);else if(N instanceof P)N.target=N.target||v;else{var ge=N;N=new P(K,v),Q(N,ge)}ge=!0;let Ie,lt;if(j)for(lt=j.length-1;lt>=0;lt--)Ie=N.g=j[lt],ge=sr(Ie,K,!0,N)&&ge;if(Ie=N.g=v,ge=sr(Ie,K,!0,N)&&ge,ge=sr(Ie,K,!1,N)&&ge,j)for(lt=0;lt<j.length;lt++)Ie=N.g=j[lt],ge=sr(Ie,K,!1,N)&&ge}dn.prototype.N=function(){if(dn.Z.N.call(this),this.i){var v=this.i;for(const N in v.g){const j=v.g[N];for(let K=0;K<j.length;K++)ue(j[K]);delete v.g[N],v.h--}}this.G=null},dn.prototype.J=function(v,N,j,K){return this.i.add(String(v),N,!1,j,K)},dn.prototype.K=function(v,N,j,K){return this.i.add(String(v),N,!0,j,K)};function sr(v,N,j,K){if(N=v.i.g[String(N)],!N)return!0;N=N.concat();let ge=!0;for(let Ie=0;Ie<N.length;++Ie){const lt=N[Ie];if(lt&&!lt.da&&lt.capture==j){const sn=lt.listener,zr=lt.ha||lt.src;lt.fa&&re(v.i,lt),ge=sn.call(zr,K)!==!1&&ge}}return ge&&!K.defaultPrevented}function Mi(v,N){if(typeof v!="function")if(v&&typeof v.handleEvent=="function")v=c(v.handleEvent,v);else throw Error("Invalid listener argument");return Number(N)>2147483647?-1:a.setTimeout(v,N||0)}function Bn(v){v.g=Mi(()=>{v.g=null,v.i&&(v.i=!1,Bn(v))},v.l);const N=v.h;v.h=null,v.m.apply(null,N)}class Sr extends O{constructor(N,j){super(),this.m=N,this.l=j,this.h=null,this.i=!1,this.g=null}j(N){this.h=arguments,this.g?this.i=!0:Bn(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function oi(v){O.call(this),this.h=v,this.g={}}g(oi,O);var _t=[];function xn(v){ke(v.g,function(N,j){this.g.hasOwnProperty(j)&&Ft(N)},v),v.g={}}oi.prototype.N=function(){oi.Z.N.call(this),xn(this)},oi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var An=a.JSON.stringify,Tt=a.JSON.parse,an=class{stringify(v){return a.JSON.stringify(v,void 0)}parse(v){return a.JSON.parse(v,void 0)}};function Mt(){}function Zi(){}var Mr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function li(){P.call(this,"d")}g(li,P);function rn(){P.call(this,"c")}g(rn,P);var Tr={},je=null;function _e(){return je=je||new dn}Tr.Ia="serverreachability";function ve(v){P.call(this,Tr.Ia,v)}g(ve,P);function jt(v){const N=_e();un(N,new ve(N))}Tr.STAT_EVENT="statevent";function L(v,N){P.call(this,Tr.STAT_EVENT,v),this.stat=N}g(L,P);function ut(v){const N=_e();un(N,new L(N,v))}Tr.Ja="timingevent";function W(v,N){P.call(this,Tr.Ja,v),this.size=N}g(W,P);function ie(v,N){if(typeof v!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){v()},N)}function Pe(){this.g=!0}Pe.prototype.ua=function(){this.g=!1};function q(v,N,j,K,ge,Ie){v.info(function(){if(v.g)if(Ie){var lt="",sn=Ie.split("&");for(let Hn=0;Hn<sn.length;Hn++){var zr=sn[Hn].split("=");if(zr.length>1){const qr=zr[0];zr=zr[1];const ta=qr.split("_");lt=ta.length>=2&&ta[1]=="type"?lt+(qr+"="+zr+"&"):lt+(qr+"=redacted&")}}}else lt=null;else lt=Ie;return"XMLHTTP REQ ("+K+") [attempt "+ge+"]: "+N+`
`+j+`
`+lt})}function ce(v,N,j,K,ge,Ie,lt){v.info(function(){return"XMLHTTP RESP ("+K+") [ attempt "+ge+"]: "+N+`
`+j+`
`+Ie+" "+lt})}function Re(v,N,j,K){v.info(function(){return"XMLHTTP TEXT ("+N+"): "+Me(v,j)+(K?" "+K:"")})}function ze(v,N){v.info(function(){return"TIMEOUT: "+N})}Pe.prototype.info=function(){};function Me(v,N){if(!v.g)return N;if(!N)return null;try{const Ie=JSON.parse(N);if(Ie){for(v=0;v<Ie.length;v++)if(Array.isArray(Ie[v])){var j=Ie[v];if(!(j.length<2)){var K=j[1];if(Array.isArray(K)&&!(K.length<1)){var ge=K[0];if(ge!="noop"&&ge!="stop"&&ge!="close")for(let lt=1;lt<K.length;lt++)K[lt]=""}}}}return An(Ie)}catch{return N}}var He={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},$e={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},xt;function Rt(){}g(Rt,Mt),Rt.prototype.g=function(){return new XMLHttpRequest},xt=new Rt;function Ht(v){return encodeURIComponent(String(v))}function G(v){var N=1;v=v.split(":");const j=[];for(;N>0&&v.length;)j.push(v.shift()),N--;return v.length&&j.push(v.join(":")),j}function J(v,N,j,K){this.j=v,this.i=N,this.l=j,this.S=K||1,this.V=new oi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new X}function X(){this.i=null,this.g="",this.h=!1}var Y={},te={};function ne(v,N,j){v.M=1,v.A=El(va(N)),v.u=j,v.R=!0,Ee(v,null)}function Ee(v,N){v.F=Date.now(),be(v),v.B=va(v.A);var j=v.B,K=v.S;Array.isArray(K)||(K=[String(K)]),Ng(j.i,"t",K),v.C=0,j=v.j.L,v.h=new X,v.g=Ex(v.j,j?N:null,!v.u),v.P>0&&(v.O=new Sr(c(v.Y,v,v.g),v.P)),N=v.V,j=v.g,K=v.ba;var ge="readystatechange";Array.isArray(ge)||(ge&&(_t[0]=ge.toString()),ge=_t);for(let Ie=0;Ie<ge.length;Ie++){const lt=ye(j,ge[Ie],K||N.handleEvent,!1,N.h||N);if(!lt)break;N.g[lt.key]=lt}N=v.J?Z(v.J):{},v.u?(v.v||(v.v="POST"),N["Content-Type"]="application/x-www-form-urlencoded",v.g.ea(v.B,v.v,v.u,N)):(v.v="GET",v.g.ea(v.B,v.v,null,N)),jt(),q(v.i,v.v,v.B,v.l,v.S,v.u)}J.prototype.ba=function(v){v=v.target;const N=this.O;N&&Do(v)==3?N.j():this.Y(v)},J.prototype.Y=function(v){try{if(v==this.g)e:{const sn=Do(this.g),zr=this.g.ya(),Hn=this.g.ca();if(!(sn<3)&&(sn!=3||this.g&&(this.h.h||this.g.la()||vx(this.g)))){this.K||sn!=4||zr==7||(zr==8||Hn<=0?jt(3):jt(2)),it(this);var N=this.g.ca();this.X=N;var j=Oe(this);if(this.o=N==200,ce(this.i,this.v,this.B,this.l,this.S,sn,N),this.o){if(this.U&&!this.L){t:{if(this.g){var K,ge=this.g;if((K=ge.g?ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(K)){var Ie=K;break t}}Ie=null}if(v=Ie)Re(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Je(this,v);else{this.o=!1,this.m=3,ut(12),Ze(this),pt(this);break e}}if(this.R){v=!0;let qr;for(;!this.K&&this.C<j.length;)if(qr=Te(this,j),qr==te){sn==4&&(this.m=4,ut(14),v=!1),Re(this.i,this.l,null,"[Incomplete Response]");break}else if(qr==Y){this.m=4,ut(15),Re(this.i,this.l,j,"[Invalid Chunk]"),v=!1;break}else Re(this.i,this.l,qr,null),Je(this,qr);if(we(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),sn!=4||j.length!=0||this.h.h||(this.m=1,ut(16),v=!1),this.o=this.o&&v,!v)Re(this.i,this.l,j,"[Invalid Chunked Response]"),Ze(this),pt(this);else if(j.length>0&&!this.W){this.W=!0;var lt=this.j;lt.g==this&&lt.aa&&!lt.P&&(lt.j.info("Great, no buffering proxy detected. Bytes received: "+j.length),ah(lt),lt.P=!0,ut(11))}}else Re(this.i,this.l,j,null),Je(this,j);sn==4&&Ze(this),this.o&&!this.K&&(sn==4?Jd(this.j,this):(this.o=!1,be(this)))}else Lg(this.g),N==400&&j.indexOf("Unknown SID")>0?(this.m=3,ut(12)):(this.m=0,ut(13)),Ze(this),pt(this)}}}catch{}};function Oe(v){if(!we(v))return v.g.la();const N=vx(v.g);if(N==="")return"";let j="";const K=N.length,ge=Do(v.g)==4;if(!v.h.i){if(typeof TextDecoder>"u")return Ze(v),pt(v),"";v.h.i=new a.TextDecoder}for(let Ie=0;Ie<K;Ie++)v.h.h=!0,j+=v.h.i.decode(N[Ie],{stream:!(ge&&Ie==K-1)});return N.length=0,v.h.g+=j,v.C=0,v.h.g}function we(v){return v.g?v.v=="GET"&&v.M!=2&&v.j.Aa:!1}function Te(v,N){var j=v.C,K=N.indexOf(`
`,j);return K==-1?te:(j=Number(N.substring(j,K)),isNaN(j)?Y:(K+=1,K+j>N.length?te:(N=N.slice(K,K+j),v.C=K+j,N)))}J.prototype.cancel=function(){this.K=!0,Ze(this)};function be(v){v.T=Date.now()+v.H,Ye(v,v.H)}function Ye(v,N){if(v.D!=null)throw Error("WatchDog timer not null");v.D=ie(c(v.aa,v),N)}function it(v){v.D&&(a.clearTimeout(v.D),v.D=null)}J.prototype.aa=function(){this.D=null;const v=Date.now();v-this.T>=0?(ze(this.i,this.B),this.M!=2&&(jt(),ut(17)),Ze(this),this.m=2,pt(this)):Ye(this,this.T-v)};function pt(v){v.j.I==0||v.K||Jd(v.j,v)}function Ze(v){it(v);var N=v.O;N&&typeof N.dispose=="function"&&N.dispose(),v.O=null,xn(v.V),v.g&&(N=v.g,v.g=null,N.abort(),N.dispose())}function Je(v,N){try{var j=v.j;if(j.I!=0&&(j.g==v||Ya(j.h,v))){if(!v.L&&Ya(j.h,v)&&j.I==3){try{var K=j.Ba.g.parse(N)}catch{K=null}if(Array.isArray(K)&&K.length==3){var ge=K;if(ge[0]==0){e:if(!j.v){if(j.g)if(j.g.F+3e3<v.F)Zd(j),Qs(j);else break e;Vo(j),ut(18)}}else j.xa=ge[1],0<j.xa-j.K&&ge[2]<37500&&j.F&&j.A==0&&!j.C&&(j.C=ie(c(j.Va,j),6e3));pr(j.h)<=1&&j.ta&&(j.ta=void 0)}else ea(j,11)}else if((v.L||j.g==v)&&Zd(j),!F(N))for(ge=j.Ba.g.parse(N),N=0;N<ge.length;N++){let Hn=ge[N];const qr=Hn[0];if(!(qr<=j.K))if(j.K=qr,Hn=Hn[1],j.I==2)if(Hn[0]=="c"){j.M=Hn[1],j.ba=Hn[2];const ta=Hn[3];ta!=null&&(j.ka=ta,j.j.info("VER="+j.ka));const Al=Hn[4];Al!=null&&(j.za=Al,j.j.info("SVER="+j.za));const Bo=Hn[5];Bo!=null&&typeof Bo=="number"&&Bo>0&&(K=1.5*Bo,j.O=K,j.j.info("backChannelRequestTimeoutMs_="+K)),K=j;const Go=v.g;if(Go){const tf=Go.g?Go.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(tf){var Ie=K.h;Ie.g||tf.indexOf("spdy")==-1&&tf.indexOf("quic")==-1&&tf.indexOf("h2")==-1||(Ie.j=Ie.l,Ie.g=new Set,Ie.h&&(_a(Ie,Ie.h),Ie.h=null))}if(K.G){const jg=Go.g?Go.g.getResponseHeader("X-HTTP-Session-Id"):null;jg&&(K.wa=jg,Ln(K.J,K.G,jg))}}j.I=3,j.l&&j.l.ra(),j.aa&&(j.T=Date.now()-v.F,j.j.info("Handshake RTT: "+j.T+"ms")),K=j;var lt=v;if(K.na=Dg(K,K.L?K.ba:null,K.W),lt.L){Zs(K.h,lt);var sn=lt,zr=K.O;zr&&(sn.H=zr),sn.D&&(it(sn),be(sn)),K.g=lt}else Ji(K);j.i.length>0&&Rl(j)}else Hn[0]!="stop"&&Hn[0]!="close"||ea(j,7);else j.I==3&&(Hn[0]=="stop"||Hn[0]=="close"?Hn[0]=="stop"?ea(j,7):qd(j):Hn[0]!="noop"&&j.l&&j.l.qa(Hn),j.A=0)}}jt(4)}catch{}}var qt=class{constructor(v,N){this.g=v,this.map=N}};function Gn(v){this.l=v||10,a.PerformanceNavigationTiming?(v=a.performance.getEntriesByType("navigation"),v=v.length>0&&(v[0].nextHopProtocol=="hq"||v[0].nextHopProtocol=="h2")):v=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=v?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Wn(v){return v.h?!0:v.g?v.g.size>=v.j:!1}function pr(v){return v.h?1:v.g?v.g.size:0}function Ya(v,N){return v.h?v.h==N:v.g?v.g.has(N):!1}function _a(v,N){v.g?v.g.add(N):v.h=N}function Zs(v,N){v.h&&v.h==N?v.h=null:v.g&&v.g.has(N)&&v.g.delete(N)}Gn.prototype.cancel=function(){if(this.i=Gr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const v of this.g.values())v.cancel();this.g.clear()}};function Gr(v){if(v.h!=null)return v.i.concat(v.h.G);if(v.g!=null&&v.g.size!==0){let N=v.i;for(const j of v.g.values())N=N.concat(j.G);return N}return x(v.i)}var Sc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function br(v,N){if(v){v=v.split("&");for(let j=0;j<v.length;j++){const K=v[j].indexOf("=");let ge,Ie=null;K>=0?(ge=v[j].substring(0,K),Ie=v[j].substring(K+1)):ge=v[j],N(ge,Ie?decodeURIComponent(Ie.replace(/\+/g," ")):"")}}}function Co(v){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let N;v instanceof Co?(this.l=v.l,eh(this,v.j),this.o=v.o,this.g=v.g,Po(this,v.u),this.h=v.h,Tc(this,Mg(v.i)),this.m=v.m):v&&(N=String(v).match(Sc))?(this.l=!1,eh(this,N[1]||"",!0),this.o=th(N[2]||""),this.g=th(N[3]||"",!0),Po(this,N[4]),this.h=th(N[5]||"",!0),Tc(this,N[6]||"",!0),this.m=th(N[7]||"")):(this.l=!1,this.i=new En(null,this.l))}Co.prototype.toString=function(){const v=[];var N=this.j;N&&v.push(nh(N,Ag,!0),":");var j=this.g;return(j||N=="file")&&(v.push("//"),(N=this.o)&&v.push(nh(N,Ag,!0),"@"),v.push(Ht(j).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),j=this.u,j!=null&&v.push(":",String(j))),(j=this.h)&&(this.g&&j.charAt(0)!="/"&&v.push("/"),v.push(nh(j,j.charAt(0)=="/"?rh:kg,!0))),(j=this.i.toString())&&v.push("?",j),(j=this.m)&&v.push("#",nh(j,Ig)),v.join("")},Co.prototype.resolve=function(v){const N=va(this);let j=!!v.j;j?eh(N,v.j):j=!!v.o,j?N.o=v.o:j=!!v.g,j?N.g=v.g:j=v.u!=null;var K=v.h;if(j)Po(N,v.u);else if(j=!!v.h){if(K.charAt(0)!="/")if(this.g&&!this.h)K="/"+K;else{var ge=N.h.lastIndexOf("/");ge!=-1&&(K=N.h.slice(0,ge+1)+K)}if(ge=K,ge==".."||ge==".")K="";else if(ge.indexOf("./")!=-1||ge.indexOf("/.")!=-1){K=ge.lastIndexOf("/",0)==0,ge=ge.split("/");const Ie=[];for(let lt=0;lt<ge.length;){const sn=ge[lt++];sn=="."?K&&lt==ge.length&&Ie.push(""):sn==".."?((Ie.length>1||Ie.length==1&&Ie[0]!="")&&Ie.pop(),K&&lt==ge.length&&Ie.push("")):(Ie.push(sn),K=!0)}K=Ie.join("/")}else K=ge}return j?N.h=K:j=v.i.toString()!=="",j?Tc(N,Mg(v.i)):j=!!v.m,j&&(N.m=v.m),N};function va(v){return new Co(v)}function eh(v,N,j){v.j=j?th(N,!0):N,v.j&&(v.j=v.j.replace(/:$/,""))}function Po(v,N){if(N){if(N=Number(N),isNaN(N)||N<0)throw Error("Bad port number "+N);v.u=N}else v.u=null}function Tc(v,N,j){N instanceof En?(v.i=N,Hd(v.i,v.l)):(j||(N=nh(N,YE)),v.i=new En(N,v.l))}function Ln(v,N,j){v.i.set(N,j)}function El(v){return Ln(v,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),v}function th(v,N){return v?N?decodeURI(v.replace(/%25/g,"%2525")):decodeURIComponent(v):""}function nh(v,N,j){return typeof v=="string"?(v=encodeURI(v).replace(N,Rg),j&&(v=v.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v):null}function Rg(v){return v=v.charCodeAt(0),"%"+(v>>4&15).toString(16)+(v&15).toString(16)}var Ag=/[#\/\?@]/g,kg=/[#\?:]/g,rh=/[#\?]/g,YE=/[#\?@]/g,Ig=/#/g;function En(v,N){this.h=this.g=null,this.i=v||null,this.j=!!N}function No(v){v.g||(v.g=new Map,v.h=0,v.i&&br(v.i,function(N,j){v.add(decodeURIComponent(N.replace(/\+/g," ")),j)}))}n=En.prototype,n.add=function(v,N){No(this),this.i=null,v=Mo(this,v);let j=this.g.get(v);return j||this.g.set(v,j=[]),j.push(N),this.h+=1,this};function Cg(v,N){No(v),N=Mo(v,N),v.g.has(N)&&(v.i=null,v.h-=v.g.get(N).length,v.g.delete(N))}function Wd(v,N){return No(v),N=Mo(v,N),v.g.has(N)}n.forEach=function(v,N){No(this),this.g.forEach(function(j,K){j.forEach(function(ge){v.call(N,ge,K,this)},this)},this)};function Pg(v,N){No(v);let j=[];if(typeof N=="string")Wd(v,N)&&(j=j.concat(v.g.get(Mo(v,N))));else for(v=Array.from(v.g.values()),N=0;N<v.length;N++)j=j.concat(v[N]);return j}n.set=function(v,N){return No(this),this.i=null,v=Mo(this,v),Wd(this,v)&&(this.h-=this.g.get(v).length),this.g.set(v,[N]),this.h+=1,this},n.get=function(v,N){return v?(v=Pg(this,v),v.length>0?String(v[0]):N):N};function Ng(v,N,j){Cg(v,N),j.length>0&&(v.i=null,v.g.set(Mo(v,N),x(j)),v.h+=j.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const v=[],N=Array.from(this.g.keys());for(let K=0;K<N.length;K++){var j=N[K];const ge=Ht(j);j=Pg(this,j);for(let Ie=0;Ie<j.length;Ie++){let lt=ge;j[Ie]!==""&&(lt+="="+Ht(j[Ie])),v.push(lt)}}return this.i=v.join("&")};function Mg(v){const N=new En;return N.i=v.i,v.g&&(N.g=new Map(v.g),N.h=v.h),N}function Mo(v,N){return N=String(N),v.j&&(N=N.toLowerCase()),N}function Hd(v,N){N&&!v.j&&(No(v),v.i=null,v.g.forEach(function(j,K){const ge=K.toLowerCase();K!=ge&&(Cg(this,K),Ng(this,ge,j))},v)),v.j=N}function Lo(v,N){const j=new Pe;if(a.Image){const K=new Image;K.onload=h(Li,j,"TestLoadImage: loaded",!0,N,K),K.onerror=h(Li,j,"TestLoadImage: error",!1,N,K),K.onabort=h(Li,j,"TestLoadImage: abort",!1,N,K),K.ontimeout=h(Li,j,"TestLoadImage: timeout",!1,N,K),a.setTimeout(function(){K.ontimeout&&K.ontimeout()},1e4),K.src=v}else N(!1)}function Oo(v,N){const j=new Pe,K=new AbortController,ge=setTimeout(()=>{K.abort(),Li(j,"TestPingServer: timeout",!1,N)},1e4);fetch(v,{signal:K.signal}).then(Ie=>{clearTimeout(ge),Ie.ok?Li(j,"TestPingServer: ok",!0,N):Li(j,"TestPingServer: server error",!1,N)}).catch(()=>{clearTimeout(ge),Li(j,"TestPingServer: error",!1,N)})}function Li(v,N,j,K,ge){try{ge&&(ge.onload=null,ge.onerror=null,ge.onabort=null,ge.ontimeout=null),K(j)}catch{}}function ih(){this.g=new an}function Sl(v){this.i=v.Sb||null,this.h=v.ab||!1}g(Sl,Mt),Sl.prototype.g=function(){return new Js(this.i,this.h)};function Js(v,N){dn.call(this),this.H=v,this.o=N,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(Js,dn),n=Js.prototype,n.open=function(v,N){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=v,this.D=N,this.readyState=1,Za(this)},n.send=function(v){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const N={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};v&&(N.body=v),(this.H||a).fetch(new Request(this.D,N)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,bc(this)),this.readyState=0},n.Pa=function(v){if(this.g&&(this.l=v,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=v.headers,this.readyState=2,Za(this)),this.g&&(this.readyState=3,Za(this),this.g)))if(this.responseType==="arraybuffer")v.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in v){if(this.j=v.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;xx(this)}else v.text().then(this.Oa.bind(this),this.ga.bind(this))};function xx(v){v.j.read().then(v.Ma.bind(v)).catch(v.ga.bind(v))}n.Ma=function(v){if(this.g){if(this.o&&v.value)this.response.push(v.value);else if(!this.o){var N=v.value?v.value:new Uint8Array(0);(N=this.B.decode(N,{stream:!v.done}))&&(this.response=this.responseText+=N)}v.done?bc(this):Za(this),this.readyState==3&&xx(this)}},n.Oa=function(v){this.g&&(this.response=this.responseText=v,bc(this))},n.Na=function(v){this.g&&(this.response=v,bc(this))},n.ga=function(){this.g&&bc(this)};function bc(v){v.readyState=4,v.l=null,v.j=null,v.B=null,Za(v)}n.setRequestHeader=function(v,N){this.A.append(v,N)},n.getResponseHeader=function(v){return this.h&&this.h.get(v.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const v=[],N=this.h.entries();for(var j=N.next();!j.done;)j=j.value,v.push(j[0]+": "+j[1]),j=N.next();return v.join(`\r
`)};function Za(v){v.onreadystatechange&&v.onreadystatechange.call(v)}Object.defineProperty(Js.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(v){this.m=v?"include":"same-origin"}});function yx(v){let N="";return ke(v,function(j,K){N+=K,N+=":",N+=j,N+=`\r
`}),N}function Kd(v,N,j){e:{for(K in j){var K=!1;break e}K=!0}K||(j=yx(j),typeof v=="string"?j!=null&&Ht(j):Ln(v,N,j))}function ar(v){dn.call(this),this.headers=new Map,this.L=v||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(ar,dn);var _x=/^https?$/i,ZE=["POST","PUT"];n=ar.prototype,n.Fa=function(v){this.H=v},n.ea=function(v,N,j,K){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+v);N=N?N.toUpperCase():"GET",this.D=v,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():xt.g(),this.g.onreadystatechange=m(c(this.Ca,this));try{this.B=!0,this.g.open(N,String(v),!0),this.B=!1}catch(Ie){Rc(this,Ie);return}if(v=j||"",j=new Map(this.headers),K)if(Object.getPrototypeOf(K)===Object.prototype)for(var ge in K)j.set(ge,K[ge]);else if(typeof K.keys=="function"&&typeof K.get=="function")for(const Ie of K.keys())j.set(Ie,K.get(Ie));else throw Error("Unknown input type for opt_headers: "+String(K));K=Array.from(j.keys()).find(Ie=>Ie.toLowerCase()=="content-type"),ge=a.FormData&&v instanceof a.FormData,!(Array.prototype.indexOf.call(ZE,N,void 0)>=0)||K||ge||j.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ie,lt]of j)this.g.setRequestHeader(Ie,lt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(v),this.v=!1}catch(Ie){Rc(this,Ie)}};function Rc(v,N){v.h=!1,v.g&&(v.j=!0,v.g.abort(),v.j=!1),v.l=N,v.o=5,Ac(v),bl(v)}function Ac(v){v.A||(v.A=!0,un(v,"complete"),un(v,"error"))}n.abort=function(v){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=v||7,un(this,"complete"),un(this,"abort"),bl(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bl(this,!0)),ar.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Tl(this):this.Xa())},n.Xa=function(){Tl(this)};function Tl(v){if(v.h&&typeof s<"u"){if(v.v&&Do(v)==4)setTimeout(v.Ca.bind(v),0);else if(un(v,"readystatechange"),Do(v)==4){v.h=!1;try{const Ie=v.ca();e:switch(Ie){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var N=!0;break e;default:N=!1}var j;if(!(j=N)){var K;if(K=Ie===0){let lt=String(v.D).match(Sc)[1]||null;!lt&&a.self&&a.self.location&&(lt=a.self.location.protocol.slice(0,-1)),K=!_x.test(lt?lt.toLowerCase():"")}j=K}if(j)un(v,"complete"),un(v,"success");else{v.o=6;try{var ge=Do(v)>2?v.g.statusText:""}catch{ge=""}v.l=ge+" ["+v.ca()+"]",Ac(v)}}finally{bl(v)}}}}function bl(v,N){if(v.g){v.m&&(clearTimeout(v.m),v.m=null);const j=v.g;v.g=null,N||un(v,"ready");try{j.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Do(v){return v.g?v.g.readyState:0}n.ca=function(){try{return Do(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(v){if(this.g){var N=this.g.responseText;return v&&N.indexOf(v)==0&&(N=N.substring(v.length)),Tt(N)}};function vx(v){try{if(!v.g)return null;if("response"in v.g)return v.g.response;switch(v.F){case"":case"text":return v.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in v.g)return v.g.mozResponseArrayBuffer}return null}catch{return null}}function Lg(v){const N={};v=(v.g&&Do(v)>=2&&v.g.getAllResponseHeaders()||"").split(`\r
`);for(let K=0;K<v.length;K++){if(F(v[K]))continue;var j=G(v[K]);const ge=j[0];if(j=j[1],typeof j!="string")continue;j=j.trim();const Ie=N[ge]||[];N[ge]=Ie,Ie.push(j)}ae(N,function(K){return K.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function jo(v,N,j){return j&&j.internalChannelParams&&j.internalChannelParams[v]||N}function Xd(v){this.za=0,this.i=[],this.j=new Pe,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=jo("failFast",!1,v),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=jo("baseRetryDelayMs",5e3,v),this.Za=jo("retryDelaySeedMs",1e4,v),this.Ta=jo("forwardChannelMaxRetries",2,v),this.va=jo("forwardChannelRequestTimeoutMs",2e4,v),this.ma=v&&v.xmlHttpFactory||void 0,this.Ua=v&&v.Rb||void 0,this.Aa=v&&v.useFetchStreams||!1,this.O=void 0,this.L=v&&v.supportsCrossDomainXhr||!1,this.M="",this.h=new Gn(v&&v.concurrentRequestLimit),this.Ba=new ih,this.S=v&&v.fastHandshake||!1,this.R=v&&v.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=v&&v.Pb||!1,v&&v.ua&&this.j.ua(),v&&v.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&v&&v.detectBufferingProxy||!1,this.ia=void 0,v&&v.longPollingTimeout&&v.longPollingTimeout>0&&(this.ia=v.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Xd.prototype,n.ka=8,n.I=1,n.connect=function(v,N,j,K){ut(0),this.W=v,this.H=N||{},j&&K!==void 0&&(this.H.OSID=j,this.H.OAID=K),this.F=this.X,this.J=Dg(this,null,this.W),Rl(this)};function qd(v){if(Yd(v),v.I==3){var N=v.V++,j=va(v.J);if(Ln(j,"SID",v.M),Ln(j,"RID",N),Ln(j,"TYPE","terminate"),Fo(v,j),N=new J(v,v.j,N),N.M=2,N.A=El(va(j)),j=!1,a.navigator&&a.navigator.sendBeacon)try{j=a.navigator.sendBeacon(N.A.toString(),"")}catch{}!j&&a.Image&&(new Image().src=N.A,j=!0),j||(N.g=Ex(N.j,null),N.g.ea(N.A)),N.F=Date.now(),be(N)}oh(v)}function Qs(v){v.g&&(ah(v),v.g.cancel(),v.g=null)}function Yd(v){Qs(v),v.v&&(a.clearTimeout(v.v),v.v=null),Zd(v),v.h.cancel(),v.m&&(typeof v.m=="number"&&a.clearTimeout(v.m),v.m=null)}function Rl(v){if(!Wn(v.h)&&!v.m){v.m=!0;var N=v.Ea;D||A(),B||(D(),B=!0),k.add(N,v),v.D=0}}function wx(v,N){return pr(v.h)>=v.h.j-(v.m?1:0)?!1:v.m?(v.i=N.G.concat(v.i),!0):v.I==1||v.I==2||v.D>=(v.Sa?0:v.Ta)?!1:(v.m=ie(c(v.Ea,v,N),Qd(v,v.D)),v.D++,!0)}n.Ea=function(v){if(this.m)if(this.m=null,this.I==1){if(!v){this.V=Math.floor(Math.random()*1e5),v=this.V++;const ge=new J(this,this.j,v);let Ie=this.o;if(this.U&&(Ie?(Ie=Z(Ie),Q(Ie,this.U)):Ie=this.U),this.u!==null||this.R||(ge.J=Ie,Ie=null),this.S)e:{for(var N=0,j=0;j<this.i.length;j++){t:{var K=this.i[j];if("__data__"in K.map&&(K=K.map.__data__,typeof K=="string")){K=K.length;break t}K=void 0}if(K===void 0)break;if(N+=K,N>4096){N=j;break e}if(N===4096||j===this.i.length-1){N=j+1;break e}}N=1e3}else N=1e3;N=Og(this,ge,N),j=va(this.J),Ln(j,"RID",v),Ln(j,"CVER",22),this.G&&Ln(j,"X-HTTP-Session-Id",this.G),Fo(this,j),Ie&&(this.R?N="headers="+Ht(yx(Ie))+"&"+N:this.u&&Kd(j,this.u,Ie)),_a(this.h,ge),this.Ra&&Ln(j,"TYPE","init"),this.S?(Ln(j,"$req",N),Ln(j,"SID","null"),ge.U=!0,ne(ge,j,null)):ne(ge,j,N),this.I=2}}else this.I==3&&(v?sh(this,v):this.i.length==0||Wn(this.h)||sh(this))};function sh(v,N){var j;N?j=N.l:j=v.V++;const K=va(v.J);Ln(K,"SID",v.M),Ln(K,"RID",j),Ln(K,"AID",v.K),Fo(v,K),v.u&&v.o&&Kd(K,v.u,v.o),j=new J(v,v.j,j,v.D+1),v.u===null&&(j.J=v.o),N&&(v.i=N.G.concat(v.i)),N=Og(v,j,1e3),j.H=Math.round(v.va*.5)+Math.round(v.va*.5*Math.random()),_a(v.h,j),ne(j,K,N)}function Fo(v,N){v.H&&ke(v.H,function(j,K){Ln(N,K,j)}),v.l&&ke({},function(j,K){Ln(N,K,j)})}function Og(v,N,j){j=Math.min(v.i.length,j);const K=v.l?c(v.l.Ka,v.l,v):null;e:{var ge=v.i;let sn=-1;for(;;){const zr=["count="+j];sn==-1?j>0?(sn=ge[0].g,zr.push("ofs="+sn)):sn=0:zr.push("ofs="+sn);let Hn=!0;for(let qr=0;qr<j;qr++){var Ie=ge[qr].g;const ta=ge[qr].map;if(Ie-=sn,Ie<0)sn=Math.max(0,ge[qr].g-100),Hn=!1;else try{Ie="req"+Ie+"_"||"";try{var lt=ta instanceof Map?ta:Object.entries(ta);for(const[Al,Bo]of lt){let Go=Bo;o(Bo)&&(Go=An(Bo)),zr.push(Ie+Al+"="+encodeURIComponent(Go))}}catch(Al){throw zr.push(Ie+"type="+encodeURIComponent("_badmap")),Al}}catch{K&&K(ta)}}if(Hn){lt=zr.join("&");break e}}lt=void 0}return v=v.i.splice(0,j),N.G=v,lt}function Ji(v){if(!v.g&&!v.v){v.Y=1;var N=v.Da;D||A(),B||(D(),B=!0),k.add(N,v),v.A=0}}function Vo(v){return v.g||v.v||v.A>=3?!1:(v.Y++,v.v=ie(c(v.Da,v),Qd(v,v.A)),v.A++,!0)}n.Da=function(){if(this.v=null,kc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var v=4*this.T;this.j.info("BP detection timer enabled: "+v),this.B=ie(c(this.Wa,this),v)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ut(10),Qs(this),kc(this))};function ah(v){v.B!=null&&(a.clearTimeout(v.B),v.B=null)}function kc(v){v.g=new J(v,v.j,"rpc",v.Y),v.u===null&&(v.g.J=v.o),v.g.P=0;var N=va(v.na);Ln(N,"RID","rpc"),Ln(N,"SID",v.M),Ln(N,"AID",v.K),Ln(N,"CI",v.F?"0":"1"),!v.F&&v.ia&&Ln(N,"TO",v.ia),Ln(N,"TYPE","xmlhttp"),Fo(v,N),v.u&&v.o&&Kd(N,v.u,v.o),v.O&&(v.g.H=v.O);var j=v.g;v=v.ba,j.M=1,j.A=El(va(N)),j.u=null,j.R=!0,Ee(j,v)}n.Va=function(){this.C!=null&&(this.C=null,Qs(this),Vo(this),ut(19))};function Zd(v){v.C!=null&&(a.clearTimeout(v.C),v.C=null)}function Jd(v,N){var j=null;if(v.g==N){Zd(v),ah(v),v.g=null;var K=2}else if(Ya(v.h,N))j=N.G,Zs(v.h,N),K=1;else return;if(v.I!=0){if(N.o)if(K==1){j=N.u?N.u.length:0,N=Date.now()-N.F;var ge=v.D;K=_e(),un(K,new W(K,j)),Rl(v)}else Ji(v);else if(ge=N.m,ge==3||ge==0&&N.X>0||!(K==1&&wx(v,N)||K==2&&Vo(v)))switch(j&&j.length>0&&(N=v.h,N.i=N.i.concat(j)),ge){case 1:ea(v,5);break;case 4:ea(v,10);break;case 3:ea(v,6);break;default:ea(v,2)}}}function Qd(v,N){let j=v.Qa+Math.floor(Math.random()*v.Za);return v.isActive()||(j*=2),j*N}function ea(v,N){if(v.j.info("Error code "+N),N==2){var j=c(v.bb,v),K=v.Ua;const ge=!K;K=new Co(K||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||eh(K,"https"),El(K),ge?Lo(K.toString(),j):Oo(K.toString(),j)}else ut(2);v.I=0,v.l&&v.l.pa(N),oh(v),Yd(v)}n.bb=function(v){v?(this.j.info("Successfully pinged google.com"),ut(2)):(this.j.info("Failed to ping google.com"),ut(1))};function oh(v){if(v.I=0,v.ja=[],v.l){const N=Gr(v.h);(N.length!=0||v.i.length!=0)&&(y(v.ja,N),y(v.ja,v.i),v.h.i.length=0,x(v.i),v.i.length=0),v.l.oa()}}function Dg(v,N,j){var K=j instanceof Co?va(j):new Co(j);if(K.g!="")N&&(K.g=N+"."+K.g),Po(K,K.u);else{var ge=a.location;K=ge.protocol,N=N?N+"."+ge.hostname:ge.hostname,ge=+ge.port;const Ie=new Co(null);K&&eh(Ie,K),N&&(Ie.g=N),ge&&Po(Ie,ge),j&&(Ie.h=j),K=Ie}return j=v.G,N=v.wa,j&&N&&Ln(K,j,N),Ln(K,"VER",v.ka),Fo(v,K),K}function Ex(v,N,j){if(N&&!v.L)throw Error("Can't create secondary domain capable XhrIo object.");return N=v.Aa&&!v.ma?new ar(new Sl({ab:j})):new ar(v.ma),N.Fa(v.L),N}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Sx(){}n=Sx.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ef(){}ef.prototype.g=function(v,N){return new Oi(v,N)};function Oi(v,N){dn.call(this),this.g=new Xd(N),this.l=v,this.h=N&&N.messageUrlParams||null,v=N&&N.messageHeaders||null,N&&N.clientProtocolHeaderRequired&&(v?v["X-Client-Protocol"]="webchannel":v={"X-Client-Protocol":"webchannel"}),this.g.o=v,v=N&&N.initMessageHeaders||null,N&&N.messageContentType&&(v?v["X-WebChannel-Content-Type"]=N.messageContentType:v={"X-WebChannel-Content-Type":N.messageContentType}),N&&N.sa&&(v?v["X-WebChannel-Client-Profile"]=N.sa:v={"X-WebChannel-Client-Profile":N.sa}),this.g.U=v,(v=N&&N.Qb)&&!F(v)&&(this.g.u=v),this.A=N&&N.supportsCrossDomainXhr||!1,this.v=N&&N.sendRawJson||!1,(N=N&&N.httpSessionIdParam)&&!F(N)&&(this.g.G=N,v=this.h,v!==null&&N in v&&(v=this.h,N in v&&delete v[N])),this.j=new Ic(this)}g(Oi,dn),Oi.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Oi.prototype.close=function(){qd(this.g)},Oi.prototype.o=function(v){var N=this.g;if(typeof v=="string"){var j={};j.__data__=v,v=j}else this.v&&(j={},j.__data__=An(v),v=j);N.i.push(new qt(N.Ya++,v)),N.I==3&&Rl(N)},Oi.prototype.N=function(){this.g.l=null,delete this.j,qd(this.g),delete this.g,Oi.Z.N.call(this)};function Tx(v){li.call(this),v.__headers__&&(this.headers=v.__headers__,this.statusCode=v.__status__,delete v.__headers__,delete v.__status__);var N=v.__sm__;if(N){e:{for(const j in N){v=j;break e}v=void 0}(this.i=v)&&(v=this.i,N=N!==null&&v in N?N[v]:void 0),this.data=N}else this.data=v}g(Tx,li);function bx(){rn.call(this),this.status=1}g(bx,rn);function Ic(v){this.g=v}g(Ic,Sx),Ic.prototype.ra=function(){un(this.g,"a")},Ic.prototype.qa=function(v){un(this.g,new Tx(v))},Ic.prototype.pa=function(v){un(this.g,new bx)},Ic.prototype.oa=function(){un(this.g,"b")},ef.prototype.createWebChannel=ef.prototype.g,Oi.prototype.send=Oi.prototype.o,Oi.prototype.open=Oi.prototype.m,Oi.prototype.close=Oi.prototype.close,b6=function(){return new ef},T6=function(){return _e()},S6=Tr,Kb={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},He.NO_ERROR=0,He.TIMEOUT=8,He.HTTP_ERROR=6,m_=He,$e.COMPLETE="complete",E6=$e,Zi.EventType=Mr,Mr.OPEN="a",Mr.CLOSE="b",Mr.ERROR="c",Mr.MESSAGE="d",dn.prototype.listen=dn.prototype.J,km=Zi,ar.prototype.listenOnce=ar.prototype.K,ar.prototype.getLastError=ar.prototype.Ha,ar.prototype.getLastErrorCode=ar.prototype.ya,ar.prototype.getStatus=ar.prototype.ca,ar.prototype.getResponseJson=ar.prototype.La,ar.prototype.getResponseText=ar.prototype.la,ar.prototype.send=ar.prototype.ea,ar.prototype.setWithCredentials=ar.prototype.Fa,w6=ar}).apply(typeof Ly<"u"?Ly:typeof self<"u"?self:typeof window<"u"?window:{});const rL="@firebase/firestore",iL="4.9.3";let Ui=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ui.UNAUTHENTICATED=new Ui(null),Ui.GOOGLE_CREDENTIALS=new Ui("google-credentials-uid"),Ui.FIRST_PARTY=new Ui("first-party-uid"),Ui.MOCK_USER=new Ui("mock-user");let fg="12.7.0";const gd=new ak("@firebase/firestore");function qf(){return gd.logLevel}function tt(n,...e){if(gd.logLevel<=_n.DEBUG){const t=e.map(yk);gd.debug(`Firestore (${fg}): ${n}`,...t)}}function Ss(n,...e){if(gd.logLevel<=_n.ERROR){const t=e.map(yk);gd.error(`Firestore (${fg}): ${n}`,...t)}}function md(n,...e){if(gd.logLevel<=_n.WARN){const t=e.map(yk);gd.warn(`Firestore (${fg}): ${n}`,...t)}}function yk(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function It(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,R6(n,r,t)}function R6(n,e,t){let r=`FIRESTORE (${fg}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Ss(r),new Error(r)}function Ot(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||R6(e,i,r)}function nn(n,e){return n}const De={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ht extends vl{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class al{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class A6{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class VQ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ui.UNAUTHENTICATED)))}shutdown(){}}class BQ{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class GQ{constructor(e){this.t=e,this.currentUser=Ui.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ot(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new al;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new al,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const l=s;e.enqueueRetryable((async()=>{await l.promise,await i(this.currentUser)}))},o=l=>{tt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>o(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(tt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new al)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(tt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ot(typeof r.accessToken=="string",31837,{l:r}),new A6(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ot(e===null||typeof e=="string",2055,{h:e}),new Ui(e)}}class zQ{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ui.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class UQ{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new zQ(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ui.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class sL{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $Q{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ha(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ot(this.o===void 0,3512);const r=s=>{s.error!=null&&tt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,tt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{tt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):tt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new sL(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ot(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new sL(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function WQ(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class _k{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=WQ(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function tn(n,e){return n<e?-1:n>e?1:0}function Xb(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return gT(i)===gT(s)?tn(i,s):gT(i)?1:-1}return tn(n.length,e.length)}const HQ=55296,KQ=57343;function gT(n){const e=n.charCodeAt(0);return e>=HQ&&e<=KQ}function B0(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function k6(n){return n+"\0"}const aL="__name__";class Zo{constructor(e,t,r){t===void 0?t=0:t>e.length&&It(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&It(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Zo.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Zo?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=Zo.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return tn(e.length,t.length)}static compareSegments(e,t){const r=Zo.isNumericId(e),i=Zo.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Zo.extractNumericId(e).compare(Zo.extractNumericId(t)):Xb(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ru.fromString(e.substring(4,e.length-2))}}class Vn extends Zo{construct(e,t,r){return new Vn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ht(De.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Vn(t)}static emptyPath(){return new Vn([])}}const XQ=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Pr extends Zo{construct(e,t,r){return new Pr(e,t,r)}static isValidIdentifier(e){return XQ.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Pr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===aL}static keyField(){return new Pr([aL])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ht(De.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new ht(De.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ht(De.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(r+=o,i++):(s(),i++)}if(s(),a)throw new ht(De.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Pr(t)}static emptyPath(){return new Pr([])}}class ft{constructor(e){this.path=e}static fromPath(e){return new ft(Vn.fromString(e))}static fromName(e){return new ft(Vn.fromString(e).popFirst(5))}static empty(){return new ft(Vn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Vn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Vn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ft(new Vn(e.slice()))}}function I6(n,e,t){if(!t)throw new ht(De.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function qQ(n,e,t,r){if(e===!0&&r===!0)throw new ht(De.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function oL(n){if(!ft.isDocumentKey(n))throw new ht(De.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function lL(n){if(ft.isDocumentKey(n))throw new ht(De.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function C6(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function tE(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":It(12329,{type:typeof n})}function Ka(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ht(De.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=tE(n);throw new ht(De.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ri(n,e){const t={typeString:n};return e&&(t.value=e),t}function G1(n,e){if(!C6(n))throw new ht(De.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new ht(De.INVALID_ARGUMENT,t);return!0}const cL=-62135596800,uL=1e6;class qn{static now(){return qn.fromMillis(Date.now())}static fromDate(e){return qn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*uL);return new qn(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ht(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ht(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<cL)throw new ht(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ht(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/uL}_compareTo(e){return this.seconds===e.seconds?tn(this.nanoseconds,e.nanoseconds):tn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:qn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(G1(e,qn._jsonSchema))return new qn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-cL;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}qn._jsonSchemaVersion="firestore/timestamp/1.0",qn._jsonSchema={type:ri("string",qn._jsonSchemaVersion),seconds:ri("number"),nanoseconds:ri("number")};class Vt{static fromTimestamp(e){return new Vt(e)}static min(){return new Vt(new qn(0,0))}static max(){return new Vt(new qn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Bp=-1;class mv{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function qb(n){return n.fields.find((e=>e.kind===2))}function Ih(n){return n.fields.filter((e=>e.kind!==2))}mv.UNKNOWN_ID=-1;class p_{constructor(e,t){this.fieldPath=e,this.kind=t}}class Gp{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Gp(0,pa.min())}}function YQ(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Vt.fromTimestamp(r===1e9?new qn(t+1,0):new qn(t,r));return new pa(i,ft.empty(),e)}function P6(n){return new pa(n.readTime,n.key,Bp)}class pa{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new pa(Vt.min(),ft.empty(),Bp)}static max(){return new pa(Vt.max(),ft.empty(),Bp)}}function vk(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ft.comparator(n.documentKey,e.documentKey),t!==0?t:tn(n.largestBatchId,e.largestBatchId))}const N6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class M6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Dd(n){if(n.code!==De.FAILED_PRECONDITION||n.message!==N6)throw n;tt("LocalStore","Unexpectedly lost primary lease")}class de{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&It(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new de(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof de?t:de.resolve(t)}catch(t){return de.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):de.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):de.reject(t)}static resolve(e){return new de(((t,r)=>{t(e)}))}static reject(e){return new de(((t,r)=>{r(e)}))}static waitFor(e){return new de(((t,r)=>{let i=0,s=0,a=!1;e.forEach((o=>{++i,o.next((()=>{++s,a&&s===i&&t()}),(l=>r(l)))})),a=!0,s===i&&t()}))}static or(e){let t=de.resolve(!1);for(const r of e)t=t.next((i=>i?de.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new de(((r,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;t(e[c]).next((h=>{a[c]=h,++o,o===s&&r(a)}),(h=>i(h)))}}))}static doWhile(e,t){return new de(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}const aa="SimpleDb";class nE{static open(e,t,r,i){try{return new nE(t,e.transaction(i,r))}catch(s){throw new Hm(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new al,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Hm(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=wk(r.target.error);this.S.reject(new Hm(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(tt(aa,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new JQ(t)}}class Au{static delete(e){return tt(aa,"Removing database:",e),Oh(RF().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!OF())return!1;if(Au.F())return!0;const e=mi(),t=Au.M(e),r=0<t&&t<10,i=L6(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,Au.M(mi())===12.2&&Ss("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(tt(aa,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new Hm(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new ht(De.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new ht(De.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new Hm(e,a))},i.onupgradeneeded=s=>{tt(aa,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.N.k(a,i.transaction,s.oldVersion,this.version).next((()=>{tt(aa,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.L(e);const o=nE.open(this.db,e,s?"readonly":"readwrite",r),l=i(o).next((c=>(o.C(),c))).catch((c=>(o.abort(c),de.reject(c)))).toPromise();return l.catch((()=>{})),await o.D,l}catch(o){const l=o,c=l.name!=="FirebaseError"&&a<3;if(tt(aa,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function L6(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class ZQ{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Oh(this.U.delete())}}class Hm extends ht{constructor(e,t){super(De.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ku(n){return n.name==="IndexedDbTransactionError"}class JQ{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(tt(aa,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(tt(aa,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Oh(r)}add(e){return tt(aa,"ADD",this.store.name,e,e),Oh(this.store.add(e))}get(e){return Oh(this.store.get(e)).next((t=>(t===void 0&&(t=null),tt(aa,"GET",this.store.name,e,t),t)))}delete(e){return tt(aa,"DELETE",this.store.name,e),Oh(this.store.delete(e))}count(){return tt(aa,"COUNT",this.store.name),Oh(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new de(((a,o)=>{s.onerror=l=>{o(l.target.error)},s.onsuccess=l=>{a(l.target.result)}}))}{const s=this.cursor(r),a=[];return this.H(s,((o,l)=>{a.push(l)})).next((()=>a))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new de(((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}}))}Z(e,t){tt(aa,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((s,a,o)=>o.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new de(((r,i)=>{t.onerror=s=>{const a=wk(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next((o=>{o?a.continue():r()})):r()}}))}H(e,t){const r=[];return new de(((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const o=a.target.result;if(!o)return void i();const l=new ZQ(o),c=t(o.primaryKey,o.value,l);if(c instanceof de){const h=c.catch((g=>(l.done(),de.reject(g))));r.push(h)}l.isDone?i():l.G===null?o.continue():o.continue(l.G)}})).next((()=>de.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Oh(n){return new de(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=wk(r.target.error);t(i)}}))}let hL=!1;function wk(n){const e=Au.M(mi());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new ht("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return hL||(hL=!0,setTimeout((()=>{throw r}),0)),r}}return n}const Km="IndexBackfiller";class QQ{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){tt(Km,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();tt(Km,`Documents written: ${t}`)}catch(t){Ku(t)?tt(Km,"Ignoring IndexedDB error during index backfill: ",t):await Dd(t)}await this.re(6e4)}))}}class eee{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,s=!0;return de.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((a=>{if(a!==null&&!r.has(a))return tt(Km,`Processing collection: ${a}`),this.oe(e,a,i).next((o=>{i-=o,r.add(a)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next((()=>this._e(i,s))).next((o=>(tt(Km,`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,t,o)))).next((()=>a.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{const a=P6(s);vk(a,r)>0&&(r=a)})),new pa(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Fa{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Fa.ce=-1;const Jh=-1;function rE(n){return n==null}function zp(n){return n===0&&1/n==-1/0}function tee(n){return typeof n=="number"&&Number.isInteger(n)&&!zp(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const pv="";function ds(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=dL(e)),e=nee(n.get(t),e);return dL(e)}function nee(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case pv:t+="";break;default:t+=s}}return t}function dL(n){return n+pv+""}function tl(n){const e=n.length;if(Ot(e>=2,64408,{path:n}),e===2)return Ot(n.charAt(0)===pv&&n.charAt(1)==="",56145,{path:n}),Vn.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf(pv,s);switch((a<0||a>t)&&It(50515,{path:n}),n.charAt(a+1)){case"":const o=n.substring(s,a);let l;i.length===0?l=o:(i+=o,l=i,i=""),r.push(l);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:It(61167,{path:n})}s=a+2}return new Vn(r)}const Ch="remoteDocuments",z1="owner",Mf="owner",Up="mutationQueues",ree="userId",co="mutations",fL="batchId",Wh="userMutationsIndex",gL=["userId","batchId"];function x_(n,e){return[n,ds(e)]}function O6(n,e,t){return[n,ds(e),t]}const iee={},G0="documentMutations",xv="remoteDocumentsV14",see=["prefixPath","collectionGroup","readTime","documentId"],y_="documentKeyIndex",aee=["prefixPath","collectionGroup","documentId"],D6="collectionGroupIndex",oee=["collectionGroup","readTime","prefixPath","documentId"],$p="remoteDocumentGlobal",Yb="remoteDocumentGlobalKey",z0="targets",j6="queryTargetsIndex",lee=["canonicalId","targetId"],U0="targetDocuments",cee=["targetId","path"],Ek="documentTargetsIndex",uee=["path","targetId"],yv="targetGlobalKey",Qh="targetGlobal",Wp="collectionParents",hee=["collectionId","parent"],$0="clientMetadata",dee="clientId",iE="bundles",fee="bundleId",sE="namedQueries",gee="name",Sk="indexConfiguration",mee="indexId",Zb="collectionGroupIndex",pee="collectionGroup",Xm="indexState",xee=["indexId","uid"],F6="sequenceNumberIndex",yee=["uid","sequenceNumber"],qm="indexEntries",_ee=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],V6="documentKeyIndex",vee=["indexId","uid","orderedDocumentKey"],aE="documentOverlays",wee=["userId","collectionPath","documentId"],Jb="collectionPathOverlayIndex",Eee=["userId","collectionPath","largestBatchId"],B6="collectionGroupOverlayIndex",See=["userId","collectionGroup","largestBatchId"],Tk="globals",Tee="name",G6=[Up,co,G0,Ch,z0,z1,Qh,U0,$0,$p,Wp,iE,sE],bee=[...G6,aE],z6=[Up,co,G0,xv,z0,z1,Qh,U0,$0,$p,Wp,iE,sE,aE],U6=z6,bk=[...U6,Sk,Xm,qm],Ree=bk,$6=[...bk,Tk],Aee=$6;class Qb extends M6{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function xi(n,e){const t=nn(n);return Au.O(t.le,e)}function mL(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Xu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function W6(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Er{constructor(e,t){this.comparator=e,this.root=t||$i.EMPTY}insert(e,t){return new Er(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,$i.BLACK,null,null))}remove(e){return new Er(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$i.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Oy(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Oy(this.root,e,this.comparator,!1)}getReverseIterator(){return new Oy(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Oy(this.root,e,this.comparator,!0)}}class Oy{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class $i{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??$i.RED,this.left=i??$i.EMPTY,this.right=s??$i.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new $i(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return $i.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return $i.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$i.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw It(43730,{key:this.key,value:this.value});if(this.right.isRed())throw It(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw It(27949);return e+(this.isRed()?0:1)}}$i.EMPTY=null,$i.RED=!0,$i.BLACK=!1;$i.EMPTY=new class{constructor(){this.size=0}get key(){throw It(57766)}get value(){throw It(16141)}get color(){throw It(16727)}get left(){throw It(29726)}get right(){throw It(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new $i(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Qn{constructor(e){this.comparator=e,this.data=new Er(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new pL(this.data.getIterator())}getIteratorFrom(e){return new pL(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Qn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Qn(this.comparator);return t.data=e,t}}class pL{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Lf(n){return n.hasNext()?n.getNext():void 0}class Gs{constructor(e){this.fields=e,e.sort(Pr.comparator)}static empty(){return new Gs([])}unionWith(e){let t=new Qn(Pr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Gs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return B0(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class H6 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class si{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new H6("Invalid base64 string: "+s):s}})(e);return new si(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new si(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}si.EMPTY_BYTE_STRING=new si("");const kee=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oc(n){if(Ot(!!n,39018),typeof n=="string"){let e=0;const t=kee.exec(n);if(Ot(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:yr(n.seconds),nanos:yr(n.nanos)}}function yr(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function lc(n){return typeof n=="string"?si.fromBase64String(n):si.fromUint8Array(n)}const K6="server_timestamp",X6="__type__",q6="__previous_value__",Y6="__local_write_time__";function Rk(n){return(n?.mapValue?.fields||{})[X6]?.stringValue===K6}function oE(n){const e=n.mapValue.fields[q6];return Rk(e)?oE(e):e}function Hp(n){const e=oc(n.mapValue.fields[Y6].timestampValue);return new qn(e.seconds,e.nanos)}class Iee{constructor(e,t,r,i,s,a,o,l,c,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const _v="(default)";class pd{constructor(e,t){this.projectId=e,this.database=t||_v}static empty(){return new pd("","")}get isDefaultDatabase(){return this.database===_v}isEqual(e){return e instanceof pd&&e.projectId===this.projectId&&e.database===this.database}}const Ak="__type__",Z6="__max__",mu={mapValue:{fields:{__type__:{stringValue:Z6}}}},kk="__vector__",W0="value",__={nullValue:"NULL_VALUE"};function Lu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Rk(n)?4:J6(n)?9007199254740991:lE(n)?10:11:It(28295,{value:n})}function gl(n,e){if(n===e)return!0;const t=Lu(n);if(t!==Lu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Hp(n).isEqual(Hp(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=oc(i.timestampValue),o=oc(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return lc(i.bytesValue).isEqual(lc(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return yr(i.geoPointValue.latitude)===yr(s.geoPointValue.latitude)&&yr(i.geoPointValue.longitude)===yr(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return yr(i.integerValue)===yr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=yr(i.doubleValue),o=yr(s.doubleValue);return a===o?zp(a)===zp(o):isNaN(a)&&isNaN(o)}return!1})(n,e);case 9:return B0(n.arrayValue.values||[],e.arrayValue.values||[],gl);case 10:case 11:return(function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(mL(a)!==mL(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!gl(a[l],o[l])))return!1;return!0})(n,e);default:return It(52216,{left:n})}}function Kp(n,e){return(n.values||[]).find((t=>gl(t,e)))!==void 0}function Ou(n,e){if(n===e)return 0;const t=Lu(n),r=Lu(e);if(t!==r)return tn(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return tn(n.booleanValue,e.booleanValue);case 2:return(function(s,a){const o=yr(s.integerValue||s.doubleValue),l=yr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1})(n,e);case 3:return xL(n.timestampValue,e.timestampValue);case 4:return xL(Hp(n),Hp(e));case 5:return Xb(n.stringValue,e.stringValue);case 6:return(function(s,a){const o=lc(s),l=lc(a);return o.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const h=tn(o[c],l[c]);if(h!==0)return h}return tn(o.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,a){const o=tn(yr(s.latitude),yr(a.latitude));return o!==0?o:tn(yr(s.longitude),yr(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return yL(n.arrayValue,e.arrayValue);case 10:return(function(s,a){const o=s.fields||{},l=a.fields||{},c=o[W0]?.arrayValue,h=l[W0]?.arrayValue,g=tn(c?.values?.length||0,h?.values?.length||0);return g!==0?g:yL(c,h)})(n.mapValue,e.mapValue);case 11:return(function(s,a){if(s===mu.mapValue&&a===mu.mapValue)return 0;if(s===mu.mapValue)return 1;if(a===mu.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let g=0;g<l.length&&g<h.length;++g){const m=Xb(l[g],h[g]);if(m!==0)return m;const x=Ou(o[l[g]],c[h[g]]);if(x!==0)return x}return tn(l.length,h.length)})(n.mapValue,e.mapValue);default:throw It(23264,{he:t})}}function xL(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return tn(n,e);const t=oc(n),r=oc(e),i=tn(t.seconds,r.seconds);return i!==0?i:tn(t.nanos,r.nanos)}function yL(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Ou(t[i],r[i]);if(s)return s}return tn(t.length,r.length)}function H0(n){return eR(n)}function eR(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=oc(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return lc(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ft.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=eR(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${eR(t.fields[a])}`;return i+"}"})(n.mapValue):It(61005,{value:n})}function v_(n){switch(Lu(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=oE(n);return e?16+v_(e):16;case 5:return 2*n.stringValue.length;case 6:return lc(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+v_(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Xu(r.fields,((s,a)=>{i+=s.length+v_(a)})),i})(n.mapValue);default:throw It(13486,{value:n})}}function Xp(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function tR(n){return!!n&&"integerValue"in n}function qp(n){return!!n&&"arrayValue"in n}function _L(n){return!!n&&"nullValue"in n}function vL(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function w_(n){return!!n&&"mapValue"in n}function lE(n){return(n?.mapValue?.fields||{})[Ak]?.stringValue===kk}function Ym(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Xu(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Ym(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ym(n.arrayValue.values[t]);return e}return{...n}}function J6(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Z6}const Q6={mapValue:{fields:{[Ak]:{stringValue:kk},[W0]:{arrayValue:{}}}}};function Cee(n){return"nullValue"in n?__:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Xp(pd.empty(),ft.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?lE(n)?Q6:{mapValue:{}}:It(35942,{value:n})}function Pee(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Xp(pd.empty(),ft.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Q6:"mapValue"in n?lE(n)?{mapValue:{}}:mu:It(61959,{value:n})}function wL(n,e){const t=Ou(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function EL(n,e){const t=Ou(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class cs{constructor(e){this.value=e}static empty(){return new cs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!w_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ym(t)}setAll(e){let t=Pr.emptyPath(),r={},i=[];e.forEach(((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=o.popLast()}a?r[o.lastSegment()]=Ym(a):i.push(o.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());w_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return gl(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];w_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Xu(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new cs(Ym(this.value))}}function e8(n){const e=[];return Xu(n.fields,((t,r)=>{const i=new Pr([t]);if(w_(r)){const s=e8(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)})),new Gs(e)}class Vr{constructor(e,t,r,i,s,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Vr(e,0,Vt.min(),Vt.min(),Vt.min(),cs.empty(),0)}static newFoundDocument(e,t,r,i){return new Vr(e,1,t,Vt.min(),r,i,0)}static newNoDocument(e,t){return new Vr(e,2,t,Vt.min(),Vt.min(),cs.empty(),0)}static newUnknownDocument(e,t){return new Vr(e,3,t,Vt.min(),Vt.min(),cs.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Vt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=cs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=cs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Vt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class K0{constructor(e,t){this.position=e,this.inclusive=t}}function SL(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=ft.comparator(ft.fromName(a.referenceValue),t.key):r=Ou(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function TL(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!gl(n.position[t],e.position[t]))return!1;return!0}class vv{constructor(e,t="asc"){this.field=e,this.dir=t}}function Nee(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class t8{}class vn extends t8{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Mee(e,t,r):t==="array-contains"?new Dee(e,r):t==="in"?new o8(e,r):t==="not-in"?new jee(e,r):t==="array-contains-any"?new Fee(e,r):new vn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Lee(e,r):new Oee(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ou(t,this.value)):t!==null&&Lu(this.value)===Lu(t)&&this.matchesComparison(Ou(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return It(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Zn extends t8{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Zn(e,t)}matches(e){return X0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function X0(n){return n.op==="and"}function nR(n){return n.op==="or"}function Ik(n){return n8(n)&&X0(n)}function n8(n){for(const e of n.filters)if(e instanceof Zn)return!1;return!0}function rR(n){if(n instanceof vn)return n.field.canonicalString()+n.op.toString()+H0(n.value);if(Ik(n))return n.filters.map((e=>rR(e))).join(",");{const e=n.filters.map((t=>rR(t))).join(",");return`${n.op}(${e})`}}function r8(n,e){return n instanceof vn?(function(r,i){return i instanceof vn&&r.op===i.op&&r.field.isEqual(i.field)&&gl(r.value,i.value)})(n,e):n instanceof Zn?(function(r,i){return i instanceof Zn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,a,o)=>s&&r8(a,i.filters[o])),!0):!1})(n,e):void It(19439)}function i8(n,e){const t=n.filters.concat(e);return Zn.create(t,n.op)}function s8(n){return n instanceof vn?(function(t){return`${t.field.canonicalString()} ${t.op} ${H0(t.value)}`})(n):n instanceof Zn?(function(t){return t.op.toString()+" {"+t.getFilters().map(s8).join(" ,")+"}"})(n):"Filter"}class Mee extends vn{constructor(e,t,r){super(e,t,r),this.key=ft.fromName(r.referenceValue)}matches(e){const t=ft.comparator(e.key,this.key);return this.matchesComparison(t)}}class Lee extends vn{constructor(e,t){super(e,"in",t),this.keys=a8("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Oee extends vn{constructor(e,t){super(e,"not-in",t),this.keys=a8("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function a8(n,e){return(e.arrayValue?.values||[]).map((t=>ft.fromName(t.referenceValue)))}class Dee extends vn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return qp(t)&&Kp(t.arrayValue,this.value)}}class o8 extends vn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Kp(this.value.arrayValue,t)}}class jee extends vn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Kp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Kp(this.value.arrayValue,t)}}class Fee extends vn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!qp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Kp(this.value.arrayValue,r)))}}class Vee{constructor(e,t=null,r=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Te=null}}function iR(n,e=null,t=[],r=[],i=null,s=null,a=null){return new Vee(n,e,t,r,i,s,a)}function xd(n){const e=nn(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>rR(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),rE(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>H0(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>H0(r))).join(",")),e.Te=t}return e.Te}function U1(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Nee(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!r8(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!TL(n.startAt,e.startAt)&&TL(n.endAt,e.endAt)}function wv(n){return ft.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ev(n,e){return n.filters.filter((t=>t instanceof vn&&t.field.isEqual(e)))}function bL(n,e,t){let r=__,i=!0;for(const s of Ev(n,e)){let a=__,o=!0;switch(s.op){case"<":case"<=":a=Cee(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,o=!1;break;case"!=":case"not-in":a=__}wL({value:r,inclusive:i},{value:a,inclusive:o})<0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];wL({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function RL(n,e,t){let r=mu,i=!0;for(const s of Ev(n,e)){let a=mu,o=!0;switch(s.op){case">=":case">":a=Pee(s.value),o=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,o=!1;break;case"!=":case"not-in":a=mu}EL({value:r,inclusive:i},{value:a,inclusive:o})>0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];EL({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class $1{constructor(e,t=null,r=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Bee(n,e,t,r,i,s,a,o){return new $1(n,e,t,r,i,s,a,o)}function cE(n){return new $1(n)}function AL(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function l8(n){return n.collectionGroup!==null}function Zm(n){const e=nn(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Qn(Pr.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(o=o.add(c.field))}))})),o})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new vv(s,r))})),t.has(Pr.keyField().canonicalString())||e.Ie.push(new vv(Pr.keyField(),r))}return e.Ie}function Ga(n){const e=nn(n);return e.Ee||(e.Ee=Gee(e,Zm(n))),e.Ee}function Gee(n,e){if(n.limitType==="F")return iR(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new vv(i.field,s)}));const t=n.endAt?new K0(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new K0(n.startAt.position,n.startAt.inclusive):null;return iR(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function sR(n,e){const t=n.filters.concat([e]);return new $1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function aR(n,e,t){return new $1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function uE(n,e){return U1(Ga(n),Ga(e))&&n.limitType===e.limitType}function c8(n){return`${xd(Ga(n))}|lt:${n.limitType}`}function Yf(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>s8(i))).join(", ")}]`),rE(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>H0(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>H0(i))).join(",")),`Target(${r})`})(Ga(n))}; limitType=${n.limitType})`}function W1(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ft.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of Zm(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,o,l){const c=SL(a,o,l);return a.inclusive?c<=0:c<0})(r.startAt,Zm(r),i)||r.endAt&&!(function(a,o,l){const c=SL(a,o,l);return a.inclusive?c>=0:c>0})(r.endAt,Zm(r),i))})(n,e)}function zee(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function u8(n){return(e,t)=>{let r=!1;for(const i of Zm(n)){const s=Uee(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Uee(n,e,t){const r=n.field.isKeyField()?ft.comparator(e.key,t.key):(function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?Ou(l,c):It(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return It(19790,{direction:n.dir})}}class xc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Xu(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return W6(this.inner)}size(){return this.innerSize}}const $ee=new Er(ft.comparator);function fa(){return $ee}const h8=new Er(ft.comparator);function Im(...n){let e=h8;for(const t of n)e=e.insert(t.key,t);return e}function d8(n){let e=h8;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function nl(){return Jm()}function f8(){return Jm()}function Jm(){return new xc((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Wee=new Er(ft.comparator),Hee=new Qn(ft.comparator);function hn(...n){let e=Hee;for(const t of n)e=e.add(t);return e}const Kee=new Qn(tn);function Xee(){return Kee}function Ck(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zp(e)?"-0":e}}function g8(n){return{integerValue:""+n}}function qee(n,e){return tee(e)?g8(e):Ck(n,e)}class hE{constructor(){this._=void 0}}function Yee(n,e,t){return n instanceof q0?(function(i,s){const a={fields:{[X6]:{stringValue:K6},[Y6]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Rk(s)&&(s=oE(s)),s&&(a.fields[q6]=s),{mapValue:a}})(t,e):n instanceof Y0?p8(n,e):n instanceof Z0?x8(n,e):(function(i,s){const a=m8(i,s),o=kL(a)+kL(i.Ae);return tR(a)&&tR(i.Ae)?g8(o):Ck(i.serializer,o)})(n,e)}function Zee(n,e,t){return n instanceof Y0?p8(n,e):n instanceof Z0?x8(n,e):t}function m8(n,e){return n instanceof Yp?(function(r){return tR(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class q0 extends hE{}class Y0 extends hE{constructor(e){super(),this.elements=e}}function p8(n,e){const t=y8(e);for(const r of n.elements)t.some((i=>gl(i,r)))||t.push(r);return{arrayValue:{values:t}}}class Z0 extends hE{constructor(e){super(),this.elements=e}}function x8(n,e){let t=y8(e);for(const r of n.elements)t=t.filter((i=>!gl(i,r)));return{arrayValue:{values:t}}}class Yp extends hE{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function kL(n){return yr(n.integerValue||n.doubleValue)}function y8(n){return qp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class _8{constructor(e,t){this.field=e,this.transform=t}}function Jee(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Y0&&i instanceof Y0||r instanceof Z0&&i instanceof Z0?B0(r.elements,i.elements,gl):r instanceof Yp&&i instanceof Yp?gl(r.Ae,i.Ae):r instanceof q0&&i instanceof q0})(n.transform,e.transform)}class Qee{constructor(e,t){this.version=e,this.transformResults=t}}class us{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new us}static exists(e){return new us(void 0,e)}static updateTime(e){return new us(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function E_(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class dE{}function v8(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new fE(n.key,us.none()):new gg(n.key,n.data,us.none());{const t=n.data,r=cs.empty();let i=new Qn(Pr.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new yc(n.key,r,new Gs(i.toArray()),us.none())}}function ete(n,e,t){n instanceof gg?(function(i,s,a){const o=i.value.clone(),l=CL(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()})(n,e,t):n instanceof yc?(function(i,s,a){if(!E_(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=CL(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(w8(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Qm(n,e,t,r){return n instanceof gg?(function(s,a,o,l){if(!E_(s.precondition,a))return o;const c=s.value.clone(),h=PL(s.fieldTransforms,l,a);return c.setAll(h),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null})(n,e,t,r):n instanceof yc?(function(s,a,o,l){if(!E_(s.precondition,a))return o;const c=PL(s.fieldTransforms,l,a),h=a.data;return h.setAll(w8(s)),h.setAll(c),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((g=>g.field)))})(n,e,t,r):(function(s,a,o){return E_(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o})(n,e,t)}function tte(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=m8(r.transform,i||null);s!=null&&(t===null&&(t=cs.empty()),t.set(r.field,s))}return t||null}function IL(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&B0(r,i,((s,a)=>Jee(s,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class gg extends dE{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class yc extends dE{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function w8(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function CL(n,e,t){const r=new Map;Ot(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,o=e.data.field(s.field);r.set(s.field,Zee(a,o,t[i]))}return r}function PL(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,Yee(s,a,e))}return r}class fE extends dE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class E8 extends dE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Pk{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&ete(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Qm(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Qm(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=f8();return this.mutations.forEach((i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const l=v8(a,o);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Vt.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),hn())}isEqual(e){return this.batchId===e.batchId&&B0(this.mutations,e.mutations,((t,r)=>IL(t,r)))&&B0(this.baseMutations,e.baseMutations,((t,r)=>IL(t,r)))}}class Nk{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ot(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return Wee})();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new Nk(e,t,r,i)}}class Mk{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class nte{constructor(e,t){this.count=e,this.unchangedNames=t}}var Jr,Sn;function rte(n){switch(n){case De.OK:return It(64938);case De.CANCELLED:case De.UNKNOWN:case De.DEADLINE_EXCEEDED:case De.RESOURCE_EXHAUSTED:case De.INTERNAL:case De.UNAVAILABLE:case De.UNAUTHENTICATED:return!1;case De.INVALID_ARGUMENT:case De.NOT_FOUND:case De.ALREADY_EXISTS:case De.PERMISSION_DENIED:case De.FAILED_PRECONDITION:case De.ABORTED:case De.OUT_OF_RANGE:case De.UNIMPLEMENTED:case De.DATA_LOSS:return!0;default:return It(15467,{code:n})}}function S8(n){if(n===void 0)return Ss("GRPC error has no .code"),De.UNKNOWN;switch(n){case Jr.OK:return De.OK;case Jr.CANCELLED:return De.CANCELLED;case Jr.UNKNOWN:return De.UNKNOWN;case Jr.DEADLINE_EXCEEDED:return De.DEADLINE_EXCEEDED;case Jr.RESOURCE_EXHAUSTED:return De.RESOURCE_EXHAUSTED;case Jr.INTERNAL:return De.INTERNAL;case Jr.UNAVAILABLE:return De.UNAVAILABLE;case Jr.UNAUTHENTICATED:return De.UNAUTHENTICATED;case Jr.INVALID_ARGUMENT:return De.INVALID_ARGUMENT;case Jr.NOT_FOUND:return De.NOT_FOUND;case Jr.ALREADY_EXISTS:return De.ALREADY_EXISTS;case Jr.PERMISSION_DENIED:return De.PERMISSION_DENIED;case Jr.FAILED_PRECONDITION:return De.FAILED_PRECONDITION;case Jr.ABORTED:return De.ABORTED;case Jr.OUT_OF_RANGE:return De.OUT_OF_RANGE;case Jr.UNIMPLEMENTED:return De.UNIMPLEMENTED;case Jr.DATA_LOSS:return De.DATA_LOSS;default:return It(39323,{code:n})}}(Sn=Jr||(Jr={}))[Sn.OK=0]="OK",Sn[Sn.CANCELLED=1]="CANCELLED",Sn[Sn.UNKNOWN=2]="UNKNOWN",Sn[Sn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Sn[Sn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Sn[Sn.NOT_FOUND=5]="NOT_FOUND",Sn[Sn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Sn[Sn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Sn[Sn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Sn[Sn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Sn[Sn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Sn[Sn.ABORTED=10]="ABORTED",Sn[Sn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Sn[Sn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Sn[Sn.INTERNAL=13]="INTERNAL",Sn[Sn.UNAVAILABLE=14]="UNAVAILABLE",Sn[Sn.DATA_LOSS=15]="DATA_LOSS";function ite(){return new TextEncoder}const ste=new Ru([4294967295,4294967295],0);function NL(n){const e=ite().encode(n),t=new v6;return t.update(e),new Uint8Array(t.digest())}function ML(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ru([t,r],0),new Ru([i,s],0)]}class Lk{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Cm(`Invalid padding: ${t}`);if(r<0)throw new Cm(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Cm(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Cm(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ru.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Ru.fromNumber(r)));return i.compare(ste)===1&&(i=new Ru([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=NL(e),[r,i]=ML(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Lk(s,i,t);return r.forEach((o=>a.insert(o))),a}insert(e){if(this.ge===0)return;const t=NL(e),[r,i]=ML(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Cm extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class gE{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,H1.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new gE(Vt.min(),i,new Er(tn),fa(),hn())}}class H1{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new H1(r,t,hn(),hn(),hn())}}class S_{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class T8{constructor(e,t){this.targetId=e,this.Ce=t}}class b8{constructor(e,t,r=si.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class LL{constructor(){this.ve=0,this.Fe=OL(),this.Me=si.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=hn(),t=hn(),r=hn();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:It(38017,{changeType:s})}})),new H1(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=OL()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ot(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class ate{constructor(e){this.Ge=e,this.ze=new Map,this.je=fa(),this.Je=Dy(),this.He=Dy(),this.Ye=new Er(tn)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:It(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(wv(s))if(r===0){const a=new ft(s.path);this.et(t,a,Vr.newNoDocument(a,Vt.min()))}else Ot(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,c)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=lc(r).toUint8Array()}catch(l){if(l instanceof H6)return md("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Lk(a,i,s)}catch(l){return md(l instanceof Cm?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,a)=>{const o=this.ot(a);if(o){if(s.current&&wv(o.target)){const l=new ft(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Vr.newNoDocument(l,e))}s.Be&&(t.set(a,s.ke()),s.qe())}}));let r=hn();this.He.forEach(((s,a)=>{let o=!0;a.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)})),o&&(r=r.add(s))})),this.je.forEach(((s,a)=>a.setReadTime(e)));const i=new gE(e,t,this.Ye,this.je,r);return this.je=fa(),this.Je=Dy(),this.He=Dy(),this.Ye=new Er(tn),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new LL,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Qn(tn),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Qn(tn),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||tt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new LL),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Dy(){return new Er(ft.comparator)}function OL(){return new Er(ft.comparator)}const ote={asc:"ASCENDING",desc:"DESCENDING"},lte={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cte={and:"AND",or:"OR"};class ute{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function oR(n,e){return n.useProto3Json||rE(e)?e:{value:e}}function J0(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function R8(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function hte(n,e){return J0(n,e.toTimestamp())}function bs(n){return Ot(!!n,49232),Vt.fromTimestamp((function(t){const r=oc(t);return new qn(r.seconds,r.nanos)})(n))}function Ok(n,e){return lR(n,e).canonicalString()}function lR(n,e){const t=(function(i){return new Vn(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function A8(n){const e=Vn.fromString(n);return Ot(D8(e),10190,{key:e.toString()}),e}function Sv(n,e){return Ok(n.databaseId,e.path)}function ed(n,e){const t=A8(e);if(t.get(1)!==n.databaseId.projectId)throw new ht(De.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ht(De.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ft(C8(t))}function k8(n,e){return Ok(n.databaseId,e)}function I8(n){const e=A8(n);return e.length===4?Vn.emptyPath():C8(e)}function cR(n){return new Vn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function C8(n){return Ot(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function DL(n,e,t){return{name:Sv(n,e),fields:t.value.mapValue.fields}}function dte(n,e,t){const r=ed(n,e.name),i=bs(e.updateTime),s=e.createTime?bs(e.createTime):Vt.min(),a=new cs({mapValue:{fields:e.fields}}),o=Vr.newFoundDocument(r,i,s,a);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function fte(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:It(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(c,h){return c.useProto3Json?(Ot(h===void 0||typeof h=="string",58123),si.fromBase64String(h||"")):(Ot(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),si.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&(function(c){const h=c.code===void 0?De.UNKNOWN:S8(c.code);return new ht(h,c.message||"")})(a);t=new b8(r,i,s,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=ed(n,r.document.name),s=bs(r.document.updateTime),a=r.document.createTime?bs(r.document.createTime):Vt.min(),o=new cs({mapValue:{fields:r.document.fields}}),l=Vr.newFoundDocument(i,s,a,o),c=r.targetIds||[],h=r.removedTargetIds||[];t=new S_(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=ed(n,r.document),s=r.readTime?bs(r.readTime):Vt.min(),a=Vr.newNoDocument(i,s),o=r.removedTargetIds||[];t=new S_([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=ed(n,r.document),s=r.removedTargetIds||[];t=new S_([],s,i,null)}else{if(!("filter"in e))return It(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new nte(i,s),o=r.targetId;t=new T8(o,a)}}return t}function Tv(n,e){let t;if(e instanceof gg)t={update:DL(n,e.key,e.value)};else if(e instanceof fE)t={delete:Sv(n,e.key)};else if(e instanceof yc)t={update:DL(n,e.key,e.data),updateMask:_te(e.fieldMask)};else{if(!(e instanceof E8))return It(16599,{Vt:e.type});t={verify:Sv(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,a){const o=a.transform;if(o instanceof q0)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Y0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Z0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Yp)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw It(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:hte(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:It(27497)})(n,e.precondition)),t}function uR(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?us.updateTime(bs(s.updateTime)):s.exists!==void 0?us.exists(s.exists):us.none()})(e.currentDocument):us.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(a,o){let l=null;if("setToServerValue"in o)Ot(o.setToServerValue==="REQUEST_TIME",16630,{proto:o}),l=new q0;else if("appendMissingElements"in o){const h=o.appendMissingElements.values||[];l=new Y0(h)}else if("removeAllFromArray"in o){const h=o.removeAllFromArray.values||[];l=new Z0(h)}else"increment"in o?l=new Yp(a,o.increment):It(16584,{proto:o});const c=Pr.fromServerFormat(o.fieldPath);return new _8(c,l)})(n,i))):[];if(e.update){e.update.name;const i=ed(n,e.update.name),s=new cs({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=(function(l){const c=l.fieldPaths||[];return new Gs(c.map((h=>Pr.fromServerFormat(h))))})(e.updateMask);return new yc(i,s,a,t,r)}return new gg(i,s,t,r)}if(e.delete){const i=ed(n,e.delete);return new fE(i,t)}if(e.verify){const i=ed(n,e.verify);return new E8(i,t)}return It(1463,{proto:e})}function gte(n,e){return n&&n.length>0?(Ot(e!==void 0,14353),n.map((t=>(function(i,s){let a=i.updateTime?bs(i.updateTime):bs(s);return a.isEqual(Vt.min())&&(a=bs(s)),new Qee(a,i.transformResults||[])})(t,e)))):[]}function P8(n,e){return{documents:[k8(n,e.path)]}}function N8(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=k8(n,i);const s=(function(c){if(c.length!==0)return O8(Zn.create(c,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const a=(function(c){if(c.length!==0)return c.map((h=>(function(m){return{field:Zf(m.field),direction:pte(m.dir)}})(h)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=oR(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:i}}function M8(n){let e=I8(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ot(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(g){const m=L8(g);return m instanceof Zn&&Ik(m)?m.getFilters():[m]})(t.where));let a=[];t.orderBy&&(a=(function(g){return g.map((m=>(function(y){return new vv(Jf(y.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(y.direction))})(m)))})(t.orderBy));let o=null;t.limit&&(o=(function(g){let m;return m=typeof g=="object"?g.value:g,rE(m)?null:m})(t.limit));let l=null;t.startAt&&(l=(function(g){const m=!!g.before,x=g.values||[];return new K0(x,m)})(t.startAt));let c=null;return t.endAt&&(c=(function(g){const m=!g.before,x=g.values||[];return new K0(x,m)})(t.endAt)),Bee(e,i,a,s,o,"F",l,c)}function mte(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return It(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function L8(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Jf(t.unaryFilter.field);return vn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Jf(t.unaryFilter.field);return vn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Jf(t.unaryFilter.field);return vn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Jf(t.unaryFilter.field);return vn.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return It(61313);default:return It(60726)}})(n):n.fieldFilter!==void 0?(function(t){return vn.create(Jf(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return It(58110);default:return It(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Zn.create(t.compositeFilter.filters.map((r=>L8(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return It(1026)}})(t.compositeFilter.op))})(n):It(30097,{filter:n})}function pte(n){return ote[n]}function xte(n){return lte[n]}function yte(n){return cte[n]}function Zf(n){return{fieldPath:n.canonicalString()}}function Jf(n){return Pr.fromServerFormat(n.fieldPath)}function O8(n){return n instanceof vn?(function(t){if(t.op==="=="){if(vL(t.value))return{unaryFilter:{field:Zf(t.field),op:"IS_NAN"}};if(_L(t.value))return{unaryFilter:{field:Zf(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(vL(t.value))return{unaryFilter:{field:Zf(t.field),op:"IS_NOT_NAN"}};if(_L(t.value))return{unaryFilter:{field:Zf(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zf(t.field),op:xte(t.op),value:t.value}}})(n):n instanceof Zn?(function(t){const r=t.getFilters().map((i=>O8(i)));return r.length===1?r[0]:{compositeFilter:{op:yte(t.op),filters:r}}})(n):It(54877,{filter:n})}function _te(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function D8(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Wl{constructor(e,t,r,i,s=Vt.min(),a=Vt.min(),o=si.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Wl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Wl(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class j8{constructor(e){this.yt=e}}function vte(n,e){let t;if(e.document)t=dte(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ft.fromSegments(e.noDocument.path),i=_d(e.noDocument.readTime);t=Vr.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return It(56709);{const r=ft.fromSegments(e.unknownDocument.path),i=_d(e.unknownDocument.version);t=Vr.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const s=new qn(i[0],i[1]);return Vt.fromTimestamp(s)})(e.readTime)),t}function jL(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:bv(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,a){return{name:Sv(s,a.key),fields:a.data.value.mapValue.fields,updateTime:J0(s,a.version.toTimestamp()),createTime:J0(s,a.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:yd(e.version)};else{if(!e.isUnknownDocument())return It(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:yd(e.version)}}return r}function bv(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function yd(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function _d(n){const e=new qn(n.seconds,n.nanoseconds);return Vt.fromTimestamp(e)}function Dh(n,e){const t=(e.baseMutations||[]).map((s=>uR(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const o=e.mutations[s+1];a.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>uR(n.yt,s))),i=qn.fromMillis(e.localWriteTimeMs);return new Pk(e.batchId,i,t,r)}function Pm(n){const e=_d(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?_d(n.lastLimboFreeSnapshotVersion):Vt.min();let r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){const a=s.documents.length;return Ot(a===1,1966,{count:a}),Ga(cE(I8(s.documents[0])))})(n.query):(function(s){return Ga(M8(s))})(n.query),new Wl(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,si.fromBase64String(n.resumeToken))}function F8(n,e){const t=yd(e.snapshotVersion),r=yd(e.lastLimboFreeSnapshotVersion);let i;i=wv(e.target)?P8(n.yt,e.target):N8(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:xd(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function V8(n){const e=M8({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?aR(e,e.limit,"L"):e}function mT(n,e){return new Mk(e.largestBatchId,uR(n.yt,e.overlayMutation))}function FL(n,e){const t=e.path.lastSegment();return[n,ds(e.path.popLast()),t]}function VL(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:yd(r.readTime),documentKey:ds(r.documentKey.path),largestBatchId:r.largestBatchId}}class wte{getBundleMetadata(e,t){return BL(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:_d(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return BL(e).put((function(i){return{bundleId:i.id,createTime:yd(bs(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return GL(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:V8(s.bundledQuery),readTime:_d(s.readTime)}})(r)}))}saveNamedQuery(e,t){return GL(e).put((function(i){return{name:i.name,readTime:yd(bs(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function BL(n){return xi(n,iE)}function GL(n){return xi(n,sE)}class mE{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new mE(e,r)}getOverlay(e,t){return pm(e).get(FL(this.userId,t)).next((r=>r?mT(this.serializer,r):null))}getOverlays(e,t){const r=nl();return de.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((s,a)=>{const o=new Mk(t,a);i.push(this.St(e,o))})),de.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((a=>i.add(ds(a.getCollectionPath()))));const s=[];return i.forEach((a=>{const o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(pm(e).Z(Jb,o))})),de.waitFor(s)}getOverlaysForCollection(e,t,r){const i=nl(),s=ds(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return pm(e).J(Jb,a).next((o=>{for(const l of o){const c=mT(this.serializer,l);i.set(c.getKey(),c)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const s=nl();let a;const o=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return pm(e).ee({index:B6,range:o},((l,c,h)=>{const g=mT(this.serializer,c);s.size()<i||g.largestBatchId===a?(s.set(g.getKey(),g),a=g.largestBatchId):h.done()})).next((()=>s))}St(e,t){return pm(e).put((function(i,s,a){const[o,l,c]=FL(s,a.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Tv(i.yt,a.mutation)}})(this.serializer,this.userId,t))}}function pm(n){return xi(n,aE)}class Ete{bt(e){return xi(e,Tk)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?si.fromUint8Array(r):si.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class jh{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(yr(e.integerValue));else if("doubleValue"in e){const r=yr(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),zp(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=oc(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(lc(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?J6(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):lE(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):It(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=W0,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(yr(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),ft.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}jh.Kt=new jh;const Of=255;function Ste(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function zL(n){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const a=Ste(255&r[s]);if(i+=a,a!==8)break}return i})(n);return Math.ceil(e/8)}class Tte{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=zL(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=zL(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Of),this.sn(255)}_n(){this.an(Of),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Of?(this.sn(Of),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Of?(this.an(Of),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class bte{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class Rte{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class xm{constructor(){this.cn=new Tte,this.ln=new bte(this.cn),this.hn=new Rte(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Fh{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Fh(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:T_(this.En),directionalValue:T_(this.dn),orderedDocumentKey:T_(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Yc(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=UL(n.En,e.En),t!==0?t:(t=UL(n.dn,e.dn),t!==0?t:ft.comparator(n.In,e.In)))}function UL(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function T_(n){return LF()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function $L(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class WL{constructor(e){this.mn=new Qn(((t,r)=>Pr.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Ot(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=qb(e);if(t!==void 0&&!this.wn(t))return!1;const r=Ih(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const o=this.mn.getIterator().getNext();if(!i.has(o.field.canonicalString())){const l=r[s];if(!this.Sn(o,l)||!this.bn(this.fn[a++],l))return!1}++s}for(;s<r.length;++s){const o=r[s];if(a>=this.fn.length||!this.bn(this.fn[a++],o))return!1}return!0}Dn(){if(this.pn)return null;let e=new Qn(Pr.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new p_(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new p_(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new p_(r.field,r.dir==="asc"?0:1)));return new mv(mv.UNKNOWN_ID,this.collectionId,t,Gp.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function B8(n){if(Ot(n instanceof vn||n instanceof Zn,20012),n instanceof vn){if(n instanceof o8){const t=n.value.arrayValue?.values?.map((r=>vn.create(n.field,"==",r)))||[];return Zn.create(t,"or")}return n}const e=n.filters.map((t=>B8(t)));return Zn.create(e,n.op)}function Ate(n){if(n.getFilters().length===0)return[];const e=fR(B8(n));return Ot(G8(e),7391),hR(e)||dR(e)?[e]:e.getFilters()}function hR(n){return n instanceof vn}function dR(n){return n instanceof Zn&&Ik(n)}function G8(n){return hR(n)||dR(n)||(function(t){if(t instanceof Zn&&nR(t)){for(const r of t.getFilters())if(!hR(r)&&!dR(r))return!1;return!0}return!1})(n)}function fR(n){if(Ot(n instanceof vn||n instanceof Zn,34018),n instanceof vn)return n;if(n.filters.length===1)return fR(n.filters[0]);const e=n.filters.map((r=>fR(r)));let t=Zn.create(e,n.op);return t=Rv(t),G8(t)?t:(Ot(t instanceof Zn,64498),Ot(X0(t),40251),Ot(t.filters.length>1,57927),t.filters.reduce(((r,i)=>Dk(r,i))))}function Dk(n,e){let t;return Ot(n instanceof vn||n instanceof Zn,38388),Ot(e instanceof vn||e instanceof Zn,25473),t=n instanceof vn?e instanceof vn?(function(i,s){return Zn.create([i,s],"and")})(n,e):HL(n,e):e instanceof vn?HL(e,n):(function(i,s){if(Ot(i.filters.length>0&&s.filters.length>0,48005),X0(i)&&X0(s))return i8(i,s.getFilters());const a=nR(i)?i:s,o=nR(i)?s:i,l=a.filters.map((c=>Dk(c,o)));return Zn.create(l,"or")})(n,e),Rv(t)}function HL(n,e){if(X0(e))return i8(e,n.getFilters());{const t=e.filters.map((r=>Dk(n,r)));return Zn.create(t,"or")}}function Rv(n){if(Ot(n instanceof vn||n instanceof Zn,11850),n instanceof vn)return n;const e=n.getFilters();if(e.length===1)return Rv(e[0]);if(n8(n))return n;const t=e.map((i=>Rv(i))),r=[];return t.forEach((i=>{i instanceof vn?r.push(i):i instanceof Zn&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Zn.create(r,n.op)}class kte{constructor(){this.Cn=new jk}addToCollectionParentIndex(e,t){return this.Cn.add(t),de.resolve()}getCollectionParents(e,t){return de.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return de.resolve()}deleteFieldIndex(e,t){return de.resolve()}deleteAllFieldIndexes(e){return de.resolve()}createTargetIndexes(e,t){return de.resolve()}getDocumentsMatchingTarget(e,t){return de.resolve(null)}getIndexType(e,t){return de.resolve(0)}getFieldIndexes(e,t){return de.resolve([])}getNextCollectionGroupToUpdate(e){return de.resolve(null)}getMinOffset(e,t){return de.resolve(pa.min())}getMinOffsetFromCollectionGroup(e,t){return de.resolve(pa.min())}updateCollectionGroup(e,t,r){return de.resolve()}updateIndexEntries(e,t){return de.resolve()}}class jk{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Qn(Vn.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Qn(Vn.comparator)).toArray()}}const KL="IndexedDbIndexManager",jy=new Uint8Array(0);class Ite{constructor(e,t){this.databaseId=t,this.vn=new jk,this.Fn=new xc((r=>xd(r)),((r,i)=>U1(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:r,parent:ds(i)};return XL(e).put(s)}return de.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[k6(t),""],!1,!0);return XL(e).J(i).next((s=>{for(const a of s){if(a.collectionId!==t)break;r.push(tl(a.parent))}return r}))}addFieldIndex(e,t){const r=ym(e),i=(function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=jf(e);return s.next((o=>{a.put(VL(o,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const r=ym(e),i=jf(e),s=Df(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=ym(e),r=Df(e),i=jf(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return de.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new WL(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const r=Df(e);let i=!0;const s=new Map;return de.forEach(this.Mn(t),(a=>this.xn(e,a).next((o=>{i&&(i=!!o),s.set(a,o)})))).next((()=>{if(i){let a=hn();const o=[];return de.forEach(s,((l,c)=>{tt(KL,`Using index ${(function(R){return`id=${R.indexId}|cg=${R.collectionGroup}|f=${R.fields.map((M=>`${M.fieldPath}:${M.kind}`)).join(",")}`})(l)} to execute ${xd(t)}`);const h=(function(R,M){const D=qb(M);if(D===void 0)return null;for(const B of Ev(R,D.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null})(c,l),g=(function(R,M){const D=new Map;for(const B of Ih(M))for(const k of Ev(R,B.fieldPath))switch(k.op){case"==":case"in":D.set(B.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return D.set(B.fieldPath.canonicalString(),k.value),Array.from(D.values())}return null})(c,l),m=(function(R,M){const D=[];let B=!0;for(const k of Ih(M)){const A=k.kind===0?bL(R,k.fieldPath,R.startAt):RL(R,k.fieldPath,R.startAt);D.push(A.value),B&&(B=A.inclusive)}return new K0(D,B)})(c,l),x=(function(R,M){const D=[];let B=!0;for(const k of Ih(M)){const A=k.kind===0?RL(R,k.fieldPath,R.endAt):bL(R,k.fieldPath,R.endAt);D.push(A.value),B&&(B=A.inclusive)}return new K0(D,B)})(c,l),y=this.On(l,c,m),_=this.On(l,c,x),w=this.Nn(l,c,g),T=this.Bn(l.indexId,h,y,m.inclusive,_,x.inclusive,w);return de.forEach(T,(b=>r.Y(b,t.limit).next((R=>{R.forEach((M=>{const D=ft.fromSegments(M.documentKey);a.has(D)||(a=a.add(D),o.push(D))}))}))))})).next((()=>o))}return de.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=Ate(Zn.create(e.filters,"and")).map((r=>iR(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,s,a,o){const l=(t!=null?t.length:1)*Math.max(r.length,s.length),c=l/(t!=null?t.length:1),h=[];for(let g=0;g<l;++g){const m=t?this.Ln(t[g/c]):jy,x=this.kn(e,m,r[g%c],i),y=this.qn(e,m,s[g%c],a),_=o.map((w=>this.kn(e,m,w,!0)));h.push(...this.createRange(x,y,_))}return h}kn(e,t,r,i){const s=new Fh(e,ft.empty(),t,r);return i?s:s.An()}qn(e,t,r,i){const s=new Fh(e,ft.empty(),t,r);return i?s.An():s}xn(e,t){const r=new WL(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let a=null;for(const o of s)r.yn(o)&&(!a||o.fields.length>a.fields.length)&&(a=o);return a}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return de.forEach(i,(s=>this.xn(e,s).next((a=>{a?r!==0&&a.fields.length<(function(l){let c=new Qn(Pr.comparator),h=!1;for(const g of l.filters)for(const m of g.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:c=c.add(m.field));for(const g of l.orderBy)g.field.isKeyField()||(c=c.add(g.field));return c.size+(h?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(a){return a.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new xm;for(const i of Ih(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.Pn(i.kind);jh.Kt.Dt(s,a)}return r.un()}Ln(e){const t=new xm;return jh.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new xm;return jh.Kt.Dt(Xp(this.databaseId,t),r.Pn((function(s){const a=Ih(s);return a.length===0?0:a[a.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new xm);let s=0;for(const a of Ih(e)){const o=r[s++];for(const l of i)if(this.Un(t,a.fieldPath)&&qp(o))i=this.Kn(i,a,o);else{const c=l.Pn(a.kind);jh.Kt.Dt(o,c)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const o of i){const l=new xm;l.seed(o.un()),jh.Kt.Dt(a,l.Pn(t.kind)),s.push(l)}return s}Un(e,t){return!!e.filters.find((r=>r instanceof vn&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=ym(e),i=jf(e);return(t?r.J(Zb,IDBKeyRange.bound(t,t)):r.J()).next((s=>{const a=[];return de.forEach(s,(o=>i.get([o.indexId,this.uid]).next((l=>{a.push((function(h,g){const m=g?new Gp(g.sequenceNumber,new pa(_d(g.readTime),new ft(tl(g.documentKey)),g.largestBatchId)):Gp.empty(),x=h.fields.map((([y,_])=>new p_(Pr.fromServerFormat(y),_)));return new mv(h.indexId,h.collectionGroup,x,m)})(o,l))})))).next((()=>a))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:tn(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=ym(e),s=jf(e);return this.Gn(e).next((a=>i.J(Zb,IDBKeyRange.bound(t,t)).next((o=>de.forEach(o,(l=>s.put(VL(l.indexId,this.uid,a,r))))))))}updateIndexEntries(e,t){const r=new Map;return de.forEach(t,((i,s)=>{const a=r.get(i.collectionGroup);return(a?de.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next((o=>(r.set(i.collectionGroup,o),de.forEach(o,(l=>this.zn(e,i,l).next((c=>{const h=this.jn(s,l);return c.isEqual(h)?de.resolve():this.Jn(e,s,l,c,h)})))))))}))}Hn(e,t,r,i){return Df(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return Df(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=Df(e);let s=new Qn(Yc);return i.ee({index:V6,range:IDBKeyRange.only([r.indexId,this.uid,T_(this.$n(r,t))])},((a,o)=>{s=s.add(new Fh(r.indexId,t,$L(o.arrayValue),$L(o.directionalValue)))})).next((()=>s))}jn(e,t){let r=new Qn(Yc);const i=this.Qn(t,e);if(i==null)return r;const s=qb(t);if(s!=null){const a=e.data.field(s.fieldPath);if(qp(a))for(const o of a.arrayValue.values||[])r=r.add(new Fh(t.indexId,e.key,this.Ln(o),i))}else r=r.add(new Fh(t.indexId,e.key,jy,i));return r}Jn(e,t,r,i,s){tt(KL,"Updating index entries for document '%s'",t.key);const a=[];return(function(l,c,h,g,m){const x=l.getIterator(),y=c.getIterator();let _=Lf(x),w=Lf(y);for(;_||w;){let T=!1,b=!1;if(_&&w){const R=h(_,w);R<0?b=!0:R>0&&(T=!0)}else _!=null?b=!0:T=!0;T?(g(w),w=Lf(y)):b?(m(_),_=Lf(x)):(_=Lf(x),w=Lf(y))}})(i,s,Yc,(o=>{a.push(this.Hn(e,t,r,o))}),(o=>{a.push(this.Yn(e,t,r,o))})),de.waitFor(a)}Gn(e){let t=1;return jf(e).ee({index:F6,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((a,o)=>Yc(a,o))).filter(((a,o,l)=>!o||Yc(a,l[o-1])!==0));const i=[];i.push(e);for(const a of r){const o=Yc(a,e),l=Yc(a,t);if(o===0)i[0]=e.An();else if(o>0&&l<0)i.push(a),i.push(a.An());else if(l>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.Zn(i[a],i[a+1]))return[];const o=i[a].Vn(this.uid,jy,ft.empty()),l=i[a+1].Vn(this.uid,jy,ft.empty());s.push(IDBKeyRange.bound(o,l))}return s}Zn(e,t){return Yc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(qL)}getMinOffset(e,t){return de.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||It(44426))))).next(qL)}}function XL(n){return xi(n,Wp)}function Df(n){return xi(n,qm)}function ym(n){return xi(n,Sk)}function jf(n){return xi(n,Xm)}function qL(n){Ot(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;vk(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new pa(e.readTime,e.documentKey,t)}const YL={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},z8=41943040;class os{static withCacheSize(e){return new os(e,os.DEFAULT_COLLECTION_PERCENTILE,os.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function U8(n,e,t){const r=n.store(co),i=n.store(G0),s=[],a=IDBKeyRange.only(t.batchId);let o=0;const l=r.ee({range:a},((h,g,m)=>(o++,m.delete())));s.push(l.next((()=>{Ot(o===1,47070,{batchId:t.batchId})})));const c=[];for(const h of t.mutations){const g=O6(e,h.key.path,t.batchId);s.push(i.delete(g)),c.push(h.key)}return de.waitFor(s).next((()=>c))}function Av(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw It(14731);e=n.noDocument}return JSON.stringify(e).length}os.DEFAULT_COLLECTION_PERCENTILE=10,os.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,os.DEFAULT=new os(z8,os.DEFAULT_COLLECTION_PERCENTILE,os.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),os.DISABLED=new os(-1,0,0);class pE{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Ot(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new pE(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Zc(e).ee({index:Wh,range:r},((i,s,a)=>{t=!1,a.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const s=Qf(e),a=Zc(e);return a.add({}).next((o=>{Ot(typeof o=="number",49019);const l=new Pk(o,t,r,i),c=(function(x,y,_){const w=_.baseMutations.map((b=>Tv(x.yt,b))),T=_.mutations.map((b=>Tv(x.yt,b)));return{userId:y,batchId:_.batchId,localWriteTimeMs:_.localWriteTime.toMillis(),baseMutations:w,mutations:T}})(this.serializer,this.userId,l),h=[];let g=new Qn(((m,x)=>tn(m.canonicalString(),x.canonicalString())));for(const m of i){const x=O6(this.userId,m.key.path,o);g=g.add(m.key.path.popLast()),h.push(a.put(c)),h.push(s.put(x,iee))}return g.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[o]=l.keys()})),de.waitFor(h).next((()=>l))}))}lookupMutationBatch(e,t){return Zc(e).get(t).next((r=>r?(Ot(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Dh(this.serializer,r)):null))}er(e,t){return this.Xn[t]?de.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Zc(e).ee({index:Wh,range:i},((a,o,l)=>{o.userId===this.userId&&(Ot(o.batchId>=r,47524,{tr:r}),s=Dh(this.serializer,o)),l.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Jh;return Zc(e).ee({index:Wh,range:t,reverse:!0},((i,s,a)=>{r=s.batchId,a.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Jh],[this.userId,Number.POSITIVE_INFINITY]);return Zc(e).J(Wh,t).next((r=>r.map((i=>Dh(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=x_(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Qf(e).ee({range:i},((a,o,l)=>{const[c,h,g]=a,m=tl(h);if(c===this.userId&&t.path.isEqual(m))return Zc(e).get(g).next((x=>{if(!x)throw It(61480,{nr:a,batchId:g});Ot(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:g}),s.push(Dh(this.serializer,x))}));l.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Qn(tn);const i=[];return t.forEach((s=>{const a=x_(this.userId,s.path),o=IDBKeyRange.lowerBound(a),l=Qf(e).ee({range:o},((c,h,g)=>{const[m,x,y]=c,_=tl(x);m===this.userId&&s.path.isEqual(_)?r=r.add(y):g.done()}));i.push(l)})),de.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=x_(this.userId,r),a=IDBKeyRange.lowerBound(s);let o=new Qn(tn);return Qf(e).ee({range:a},((l,c,h)=>{const[g,m,x]=l,y=tl(m);g===this.userId&&r.isPrefixOf(y)?y.length===i&&(o=o.add(x)):h.done()})).next((()=>this.rr(e,o)))}rr(e,t){const r=[],i=[];return t.forEach((s=>{i.push(Zc(e).get(s).next((a=>{if(a===null)throw It(35274,{batchId:s});Ot(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:s}),r.push(Dh(this.serializer,a))})))})),de.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return U8(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),de.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return de.resolve();const r=IDBKeyRange.lowerBound((function(a){return[a]})(this.userId)),i=[];return Qf(e).ee({range:r},((s,a,o)=>{if(s[0]===this.userId){const l=tl(s[1]);i.push(l)}else o.done()})).next((()=>{Ot(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return $8(e,this.userId,t)}_r(e){return W8(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Jh,lastStreamToken:""}))}}function $8(n,e,t){const r=x_(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Qf(n).ee({range:s,X:!0},((o,l,c)=>{const[h,g,m]=o;h===e&&g===i&&(a=!0),c.done()})).next((()=>a))}function Zc(n){return xi(n,co)}function Qf(n){return xi(n,G0)}function W8(n){return xi(n,Up)}class vd{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new vd(0)}static cr(){return new vd(-1)}}class Cte{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new vd(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Vt.fromTimestamp(new qn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Ff(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Ot(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const s=[];return Ff(e).ee(((a,o)=>{const l=Pm(o);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))})).next((()=>de.waitFor(s))).next((()=>i))}forEachTarget(e,t){return Ff(e).ee(((r,i)=>{const s=Pm(i);t(s)}))}lr(e){return ZL(e).get(yv).next((t=>(Ot(t!==null,2888),t)))}hr(e,t){return ZL(e).put(yv,t)}Pr(e,t){return Ff(e).put(F8(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=xd(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Ff(e).ee({range:i,index:j6},((a,o,l)=>{const c=Pm(o);U1(t,c.target)&&(s=c,l.done())})).next((()=>s))}addMatchingKeys(e,t,r){const i=[],s=lu(e);return t.forEach((a=>{const o=ds(a.path);i.push(s.put({targetId:r,path:o})),i.push(this.referenceDelegate.addReference(e,r,a))})),de.waitFor(i)}removeMatchingKeys(e,t,r){const i=lu(e);return de.forEach(t,(s=>{const a=ds(s.path);return de.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){const r=lu(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=lu(e);let s=hn();return i.ee({range:r,X:!0},((a,o,l)=>{const c=tl(a[1]),h=new ft(c);s=s.add(h)})).next((()=>s))}containsKey(e,t){const r=ds(t.path),i=IDBKeyRange.bound([r],[k6(r)],!1,!0);let s=0;return lu(e).ee({index:Ek,X:!0,range:i},(([a,o],l,c)=>{a!==0&&(s++,c.done())})).next((()=>s>0))}At(e,t){return Ff(e).get(t).next((r=>r?Pm(r):null))}}function Ff(n){return xi(n,z0)}function ZL(n){return xi(n,Qh)}function lu(n){return xi(n,U0)}const JL="LruGarbageCollector",Pte=1048576;function QL([n,e],[t,r]){const i=tn(n,t);return i===0?tn(e,r):i}class Nte{constructor(e){this.Ir=e,this.buffer=new Qn(QL),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();QL(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class H8{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){tt(JL,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ku(t)?tt(JL,"Ignoring IndexedDB error during garbage collection: ",t):await Dd(t)}await this.Vr(3e5)}))}}class Mte{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return de.resolve(Fa.ce);const r=new Nte(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(tt("LruGarbageCollector","Garbage collection skipped; disabled"),de.resolve(YL)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(tt("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),YL):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,a,o,l,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(tt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,a=Date.now(),this.nthSequenceNumber(e,i)))).next((g=>(r=g,o=Date.now(),this.removeTargets(e,r,t)))).next((g=>(s=g,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((g=>(c=Date.now(),qf()<=_n.DEBUG&&tt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${g} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),de.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:g}))))}}function K8(n,e){return new Mte(n,e)}class Lte{constructor(e,t){this.db=e,this.garbageCollector=K8(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return Fy(e,r)}removeReference(e,t,r){return Fy(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Fy(e,t)}br(e,t){return(function(i,s){let a=!1;return W8(i).te((o=>$8(i,o,s).next((l=>(l&&(a=!0),de.resolve(!l)))))).next((()=>a))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((a,o)=>{if(o<=t){const l=this.br(e,a).next((c=>{if(!c)return s++,r.getEntry(e,a).next((()=>(r.removeEntry(a,Vt.min()),lu(e).delete((function(g){return[0,ds(g.path)]})(a)))))}));i.push(l)}})).next((()=>de.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Fy(e,t)}Sr(e,t){const r=lu(e);let i,s=Fa.ce;return r.ee({index:Ek},(([a,o],{path:l,sequenceNumber:c})=>{a===0?(s!==Fa.ce&&t(new ft(tl(i)),s),s=c,i=l):s=Fa.ce})).next((()=>{s!==Fa.ce&&t(new ft(tl(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Fy(n,e){return lu(n).put((function(r,i){return{targetId:0,path:ds(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class X8{constructor(){this.changes=new xc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?de.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ote{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Eh(e).put(r)}removeEntry(e,t,r){return Eh(e).delete((function(s,a){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],bv(a),o[o.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=Vr.newInvalidDocument(t);return Eh(e).ee({index:y_,range:IDBKeyRange.only(_m(t))},((i,s)=>{r=this.Cr(t,s)})).next((()=>r))}vr(e,t){let r={size:0,document:Vr.newInvalidDocument(t)};return Eh(e).ee({index:y_,range:IDBKeyRange.only(_m(t))},((i,s)=>{r={document:this.Cr(t,s),size:Av(s)}})).next((()=>r))}getEntries(e,t){let r=fa();return this.Fr(e,t,((i,s)=>{const a=this.Cr(i,s);r=r.insert(i,a)})).next((()=>r))}Mr(e,t){let r=fa(),i=new Er(ft.comparator);return this.Fr(e,t,((s,a)=>{const o=this.Cr(s,a);r=r.insert(s,o),i=i.insert(s,Av(a))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return de.resolve();let i=new Qn(n3);t.forEach((l=>i=i.add(l)));const s=IDBKeyRange.bound(_m(i.first()),_m(i.last())),a=i.getIterator();let o=a.getNext();return Eh(e).ee({index:y_,range:s},((l,c,h)=>{const g=ft.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;o&&n3(o,g)<0;)r(o,null),o=a.getNext();o&&o.isEqual(g)&&(r(o,c),o=a.hasNext()?a.getNext():null),o?h.j(_m(o)):h.done()})).next((()=>{for(;o;)r(o,null),o=a.hasNext()?a.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,o=[a.popLast().toArray(),a.lastSegment(),bv(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Eh(e).J(IDBKeyRange.bound(o,l,!0)).next((c=>{s?.incrementDocumentReadCount(c.length);let h=fa();for(const g of c){const m=this.Cr(ft.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);m.isFoundDocument()&&(W1(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,r,i){let s=fa();const a=t3(t,r),o=t3(t,pa.max());return Eh(e).ee({index:D6,range:IDBKeyRange.bound(a,o,!0)},((l,c,h)=>{const g=this.Cr(ft.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(g.key,g),s.size===i&&h.done()})).next((()=>s))}newChangeBuffer(e){return new Dte(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return e3(e).get(Yb).next((t=>(Ot(!!t,20021),t)))}Dr(e,t){return e3(e).put(Yb,t)}Cr(e,t){if(t){const r=vte(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Vt.min())))return r}return Vr.newInvalidDocument(e)}}function q8(n){return new Ote(n)}class Dte extends X8{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new xc((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Qn(((s,a)=>tn(s.canonicalString(),a.canonicalString())));return this.changes.forEach(((s,a)=>{const o=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,o.readTime)),a.isValidDocument()){const l=jL(this.Nr.serializer,a);i=i.add(s.path.popLast());const c=Av(l);r+=c-o.size,t.push(this.Nr.addEntry(e,s,l))}else if(r-=o.size,this.trackRemovals){const l=jL(this.Nr.serializer,a.convertToNoDocument(Vt.min()));t.push(this.Nr.addEntry(e,s,l))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,r)),de.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((s,a)=>{this.Br.set(s,{size:a,readTime:r.get(s).readTime})})),r)))}}function e3(n){return xi(n,$p)}function Eh(n){return xi(n,xv)}function _m(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function t3(n,e){const t=e.documentKey.path.toArray();return[n,bv(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function n3(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=tn(t[s],r[s]),i)return i;return i=tn(t.length,r.length),i||(i=tn(t[t.length-2],r[r.length-2]),i||tn(t[t.length-1],r[r.length-1]))}class jte{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Y8{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Qm(r.mutation,i,Gs.empty(),qn.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,hn()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=hn()){const i=nl();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let a=Im();return s.forEach(((o,l)=>{a=a.insert(o,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=nl();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,hn())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((a,o)=>{t.set(a,o)}))}))}computeViews(e,t,r,i){let s=fa();const a=Jm(),o=(function(){return Jm()})();return t.forEach(((l,c)=>{const h=r.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof yc)?s=s.insert(c.key,c):h!==void 0?(a.set(c.key,h.mutation.getFieldMask()),Qm(h.mutation,c,h.mutation.getFieldMask(),qn.now())):a.set(c.key,Gs.empty())})),this.recalculateAndSaveOverlays(e,s).next((l=>(l.forEach(((c,h)=>a.set(c,h))),t.forEach(((c,h)=>o.set(c,new jte(h,a.get(c)??null)))),o)))}recalculateAndSaveOverlays(e,t){const r=Jm();let i=new Er(((a,o)=>a-o)),s=hn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const o of a)o.keys().forEach((l=>{const c=t.get(l);if(c===null)return;let h=r.get(l)||Gs.empty();h=o.applyToLocalView(c,h),r.set(l,h);const g=(i.get(o.batchId)||hn()).add(l);i=i.insert(o.batchId,g)}))})).next((()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,h=l.value,g=f8();h.forEach((m=>{if(!s.has(m)){const x=v8(t.get(m),r.get(m));x!==null&&g.set(m,x),s=s.add(m)}})),a.push(this.documentOverlayCache.saveOverlays(e,c,g))}return de.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return ft.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):l8(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):de.resolve(nl());let o=Bp,l=s;return a.next((c=>de.forEach(c,((h,g)=>(o<g.largestBatchId&&(o=g.largestBatchId),s.get(h)?de.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{l=l.insert(h,m)}))))).next((()=>this.populateOverlays(e,c,s))).next((()=>this.computeViews(e,l,c,hn()))).next((h=>({batchId:o,changes:d8(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ft(t)).next((r=>{let i=Im();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=Im();return this.indexManager.getCollectionParents(e,s).next((o=>de.forEach(o,(l=>{const c=(function(g,m){return new $1(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next((h=>{h.forEach(((g,m)=>{a=a.insert(g,m)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((a=>{s.forEach(((l,c)=>{const h=c.getKey();a.get(h)===null&&(a=a.insert(h,Vr.newInvalidDocument(h)))}));let o=Im();return a.forEach(((l,c)=>{const h=s.get(l);h!==void 0&&Qm(h.mutation,c,Gs.empty(),qn.now()),W1(t,c)&&(o=o.insert(l,c))})),o}))}}class Fte{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return de.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:bs(i.createTime)}})(t)),de.resolve()}getNamedQuery(e,t){return de.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:V8(i.bundledQuery),readTime:bs(i.readTime)}})(t)),de.resolve()}}class Vte{constructor(){this.overlays=new Er(ft.comparator),this.qr=new Map}getOverlay(e,t){return de.resolve(this.overlays.get(t))}getOverlays(e,t){const r=nl();return de.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.St(e,t,s)})),de.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),de.resolve()}getOverlaysForCollection(e,t,r){const i=nl(),s=t.length+1,a=new ft(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return de.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Er(((c,h)=>c-h));const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let h=s.get(c.largestBatchId);h===null&&(h=nl(),s=s.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const o=nl(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,h)=>o.set(c,h))),!(o.size()>=i)););return de.resolve(o)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Mk(t,r));let s=this.qr.get(t);s===void 0&&(s=hn(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}class Bte{constructor(){this.sessionToken=si.EMPTY_BYTE_STRING}getSessionToken(e){return de.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,de.resolve()}}class Fk{constructor(){this.Qr=new Qn(Si.$r),this.Ur=new Qn(Si.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Si(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Si(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ft(new Vn([])),r=new Si(t,e),i=new Si(t,e+1),s=[];return this.Ur.forEachInRange([r,i],(a=>{this.Gr(a),s.push(a.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ft(new Vn([])),r=new Si(t,e),i=new Si(t,e+1);let s=hn();return this.Ur.forEachInRange([r,i],(a=>{s=s.add(a.key)})),s}containsKey(e){const t=new Si(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Si{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ft.comparator(e.key,t.key)||tn(e.Yr,t.Yr)}static Kr(e,t){return tn(e.Yr,t.Yr)||ft.comparator(e.key,t.key)}}class Gte{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Qn(Si.$r)}checkEmpty(e){return de.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Pk(s,t,r,i);this.mutationQueue.push(a);for(const o of i)this.Zr=this.Zr.add(new Si(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return de.resolve(a)}lookupMutationBatch(e,t){return de.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return de.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return de.resolve(this.mutationQueue.length===0?Jh:this.tr-1)}getAllMutationBatches(e){return de.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Si(t,0),i=new Si(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(a=>{const o=this.Xr(a.Yr);s.push(o)})),de.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Qn(tn);return t.forEach((i=>{const s=new Si(i,0),a=new Si(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],(o=>{r=r.add(o.Yr)}))})),de.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;ft.isDocumentKey(s)||(s=s.child(""));const a=new Si(new ft(s),0);let o=new Qn(tn);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.Yr)),!0)}),a),de.resolve(this.ti(o))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Ot(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return de.forEach(t.mutations,(i=>{const s=new Si(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Si(t,0),i=this.Zr.firstAfterOrEqual(r);return de.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,de.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class zte{constructor(e){this.ri=e,this.docs=(function(){return new Er(ft.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return de.resolve(r?r.document.mutableCopy():Vr.newInvalidDocument(t))}getEntries(e,t){let r=fa();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Vr.newInvalidDocument(i))})),de.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=fa();const a=t.path,o=new ft(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||vk(P6(h),r)<=0||(i.has(h.key)||W1(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return de.resolve(s)}getAllFromCollectionGroup(e,t,r,i){It(9500)}ii(e,t){return de.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new Ute(this)}getSize(e){return de.resolve(this.size)}}class Ute extends X8{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),de.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class $te{constructor(e){this.persistence=e,this.si=new xc((t=>xd(t)),U1),this.lastRemoteSnapshotVersion=Vt.min(),this.highestTargetId=0,this.oi=0,this._i=new Fk,this.targetCount=0,this.ai=vd.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),de.resolve()}getLastRemoteSnapshotVersion(e){return de.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return de.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),de.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),de.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new vd(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,de.resolve()}updateTargetData(e,t){return this.Pr(t),de.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,de.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),de.waitFor(s).next((()=>i))}getTargetCount(e){return de.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return de.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),de.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((a=>{s.push(i.markPotentiallyOrphaned(e,a))})),de.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),de.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return de.resolve(r)}containsKey(e,t){return de.resolve(this._i.containsKey(t))}}class Vk{constructor(e,t){this.ui={},this.overlays={},this.ci=new Fa(0),this.li=!1,this.li=!0,this.hi=new Bte,this.referenceDelegate=e(this),this.Pi=new $te(this),this.indexManager=new kte,this.remoteDocumentCache=(function(i){return new zte(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new j8(t),this.Ii=new Fte(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Vte,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new Gte(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){tt("MemoryPersistence","Starting transaction:",e);const i=new Wte(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return de.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class Wte extends M6{constructor(e){super(),this.currentSequenceNumber=e}}class xE{constructor(e){this.persistence=e,this.Ri=new Fk,this.Vi=null}static mi(e){return new xE(e)}get fi(){if(this.Vi)return this.Vi;throw It(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),de.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),de.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),de.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return de.forEach(this.fi,(r=>{const i=ft.fromPath(r);return this.gi(e,i).next((s=>{s||t.removeEntry(i,Vt.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return de.or([()=>de.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class kv{constructor(e,t){this.persistence=e,this.pi=new xc((r=>ds(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=K8(this,t)}static mi(e,t){return new kv(e,t)}Ei(){}di(e){return de.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return de.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?de.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(a=>this.br(e,a,t).next((o=>{o||(r++,s.removeEntry(a,Vt.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),de.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),de.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),de.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),de.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=v_(e.data.value)),t}br(e,t,r){return de.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return de.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Hte{constructor(e){this.serializer=e}k(e,t,r,i){const s=new nE("createOrUpgrade",t);r<1&&i>=1&&((function(l){l.createObjectStore(z1)})(e),(function(l){l.createObjectStore(Up,{keyPath:ree}),l.createObjectStore(co,{keyPath:fL,autoIncrement:!0}).createIndex(Wh,gL,{unique:!0}),l.createObjectStore(G0)})(e),r3(e),(function(l){l.createObjectStore(Ch)})(e));let a=de.resolve();return r<3&&i>=3&&(r!==0&&((function(l){l.deleteObjectStore(U0),l.deleteObjectStore(z0),l.deleteObjectStore(Qh)})(e),r3(e)),a=a.next((()=>(function(l){const c=l.store(Qh),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Vt.min().toTimestamp(),targetCount:0};return c.put(yv,h)})(s)))),r<4&&i>=4&&(r!==0&&(a=a.next((()=>(function(l,c){return c.store(co).J().next((g=>{l.deleteObjectStore(co),l.createObjectStore(co,{keyPath:fL,autoIncrement:!0}).createIndex(Wh,gL,{unique:!0});const m=c.store(co),x=g.map((y=>m.put(y)));return de.waitFor(x)}))})(e,s)))),a=a.next((()=>{(function(l){l.createObjectStore($0,{keyPath:dee})})(e)}))),r<5&&i>=5&&(a=a.next((()=>this.yi(s)))),r<6&&i>=6&&(a=a.next((()=>((function(l){l.createObjectStore($p)})(e),this.wi(s))))),r<7&&i>=7&&(a=a.next((()=>this.Si(s)))),r<8&&i>=8&&(a=a.next((()=>this.bi(e,s)))),r<9&&i>=9&&(a=a.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(a=a.next((()=>this.Di(s)))),r<11&&i>=11&&(a=a.next((()=>{(function(l){l.createObjectStore(iE,{keyPath:fee})})(e),(function(l){l.createObjectStore(sE,{keyPath:gee})})(e)}))),r<12&&i>=12&&(a=a.next((()=>{(function(l){const c=l.createObjectStore(aE,{keyPath:wee});c.createIndex(Jb,Eee,{unique:!1}),c.createIndex(B6,See,{unique:!1})})(e)}))),r<13&&i>=13&&(a=a.next((()=>(function(l){const c=l.createObjectStore(xv,{keyPath:see});c.createIndex(y_,aee),c.createIndex(D6,oee)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Ch)))),r<14&&i>=14&&(a=a.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(a=a.next((()=>(function(l){l.createObjectStore(Sk,{keyPath:mee,autoIncrement:!0}).createIndex(Zb,pee,{unique:!1}),l.createObjectStore(Xm,{keyPath:xee}).createIndex(F6,yee,{unique:!1}),l.createObjectStore(qm,{keyPath:_ee}).createIndex(V6,vee,{unique:!1})})(e)))),r<16&&i>=16&&(a=a.next((()=>{t.objectStore(Xm).clear()})).next((()=>{t.objectStore(qm).clear()}))),r<17&&i>=17&&(a=a.next((()=>{(function(l){l.createObjectStore(Tk,{keyPath:Tee})})(e)}))),r<18&&i>=18&&LF()&&(a=a.next((()=>{t.objectStore(Xm).clear()})).next((()=>{t.objectStore(qm).clear()}))),a}wi(e){let t=0;return e.store(Ch).ee(((r,i)=>{t+=Av(i)})).next((()=>{const r={byteSize:t};return e.store($p).put(Yb,r)}))}yi(e){const t=e.store(Up),r=e.store(co);return t.J().next((i=>de.forEach(i,(s=>{const a=IDBKeyRange.bound([s.userId,Jh],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Wh,a).next((o=>de.forEach(o,(l=>{Ot(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=Dh(this.serializer,l);return U8(e,s.userId,c).next((()=>{}))}))))}))))}Si(e){const t=e.store(U0),r=e.store(Ch);return e.store(Qh).get(yv).next((i=>{const s=[];return r.ee(((a,o)=>{const l=new Vn(a),c=(function(g){return[0,ds(g)]})(l);s.push(t.get(c).next((h=>h?de.resolve():(g=>t.put({targetId:0,path:ds(g),sequenceNumber:i.highestListenSequenceNumber}))(l))))})).next((()=>de.waitFor(s)))}))}bi(e,t){e.createObjectStore(Wp,{keyPath:hee});const r=t.store(Wp),i=new jk,s=a=>{if(i.add(a)){const o=a.lastSegment(),l=a.popLast();return r.put({collectionId:o,parent:ds(l)})}};return t.store(Ch).ee({X:!0},((a,o)=>{const l=new Vn(a);return s(l.popLast())})).next((()=>t.store(G0).ee({X:!0},(([a,o,l],c)=>{const h=tl(o);return s(h.popLast())}))))}Di(e){const t=e.store(z0);return t.ee(((r,i)=>{const s=Pm(i),a=F8(this.serializer,s);return t.put(a)}))}Ci(e,t){const r=t.store(Ch),i=[];return r.ee(((s,a)=>{const o=t.store(xv),l=(function(g){return g.document?new ft(Vn.fromString(g.document.name).popFirst(5)):g.noDocument?ft.fromSegments(g.noDocument.path):g.unknownDocument?ft.fromSegments(g.unknownDocument.path):It(36783)})(a).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(o.put(c))})).next((()=>de.waitFor(i)))}Fi(e,t){const r=t.store(co),i=q8(this.serializer),s=new Vk(xE.mi,this.serializer.yt);return r.J().next((a=>{const o=new Map;return a.forEach((l=>{let c=o.get(l.userId)??hn();Dh(this.serializer,l).keys().forEach((h=>c=c.add(h))),o.set(l.userId,c)})),de.forEach(o,((l,c)=>{const h=new Ui(c),g=mE.wt(this.serializer,h),m=s.getIndexManager(h),x=pE.wt(h,this.serializer,m,s.referenceDelegate);return new Y8(i,x,g,m).recalculateAndSaveOverlaysForDocumentKeys(new Qb(t,Fa.ce),l).next()}))}))}}function r3(n){n.createObjectStore(U0,{keyPath:cee}).createIndex(Ek,uee,{unique:!0}),n.createObjectStore(z0,{keyPath:"targetId"}).createIndex(j6,lee,{unique:!0}),n.createObjectStore(Qh)}const Jc="IndexedDbPersistence",pT=18e5,xT=5e3,yT="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Kte="main";class Bk{constructor(e,t,r,i,s,a,o,l,c,h,g=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=s,this.window=a,this.document=o,this.xi=c,this.Oi=h,this.Ni=g,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Bk.v())throw new ht(De.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Lte(this,i),this.$i=t+Kte,this.serializer=new j8(l),this.Ui=new Au(this.$i,this.Ni,new Hte(this.serializer)),this.hi=new Ete,this.Pi=new Cte(this.referenceDelegate,this.serializer),this.remoteDocumentCache=q8(this.serializer),this.Ii=new wte,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&Ss(Jc,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ht(De.FAILED_PRECONDITION,yT);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Fa(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Vy(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ku(e))return tt(Jc,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return tt(Jc,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return vm(e).get(Mf).next((t=>de.resolve(this.es(t))))}ts(e){return Vy(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,pT)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=xi(t,$0);return r.J().next((i=>{const s=this.ss(i,pT),a=i.filter((o=>s.indexOf(o)===-1));return de.forEach(a,(o=>r.delete(o.clientId))).next((()=>a))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?de.resolve(!0):vm(e).get(Mf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,xT)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ht(De.FAILED_PRECONDITION,yT);return!1}}return!(!this.networkEnabled||!this.inForeground)||Vy(e).J().next((r=>this.ss(r,xT).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,o=this.networkEnabled===i.networkEnabled;if(s||a&&o)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&tt(Jc,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[z1,$0],(e=>{const t=new Qb(e,Fa.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Vy(e).J().next((t=>this.ss(t,pT).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return pE.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Ite(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return mE.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){tt(Jc,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(l){return l===18?Aee:l===17?$6:l===16?Ree:l===15?bk:l===14?U6:l===13?z6:l===12?bee:l===11?G6:void It(60245)})(this.Ni);let a;return this.Ui.runTransaction(e,i,s,(o=>(a=new Qb(o,this.ci?this.ci.next():Fa.ce),t==="readwrite-primary"?this.Hi(a).next((l=>!!l||this.Yi(a))).next((l=>{if(!l)throw Ss(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new ht(De.FAILED_PRECONDITION,N6);return r(a)})).next((l=>this.Xi(a).next((()=>l)))):this.Is(a).next((()=>r(a)))))).then((o=>(a.raiseOnCommittedEvent(),o)))}Is(e){return vm(e).get(Mf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,xT)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ht(De.FAILED_PRECONDITION,yT)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return vm(e).put(Mf,t)}static v(){return Au.v()}Zi(e){const t=vm(e);return t.get(Mf).next((r=>this.es(r)?(tt(Jc,"Releasing primary lease."),t.delete(Mf)):de.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Ss(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;MF()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return tt(Jc,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ss(Jc,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ss("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function vm(n){return xi(n,z1)}function Vy(n){return xi(n,$0)}function Xte(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Gk{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=hn(),i=hn();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Gk(e,t.fromCache,r,i)}}class qte{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Z8{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return MF()?8:L6(mi())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next((a=>{s.result=a})).next((()=>{if(!s.result)return this.ws(e,t,i,r).next((a=>{s.result=a}))})).next((()=>{if(s.result)return;const a=new qte;return this.Ss(e,t,a).next((o=>{if(s.result=o,this.Vs)return this.bs(e,t,a,o.size)}))})).next((()=>s.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(qf()<=_n.DEBUG&&tt("QueryEngine","SDK will not create cache indexes for query:",Yf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),de.resolve()):(qf()<=_n.DEBUG&&tt("QueryEngine","Query:",Yf(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(qf()<=_n.DEBUG&&tt("QueryEngine","The SDK decides to create cache indexes for query:",Yf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ga(t))):de.resolve())}ys(e,t){if(AL(t))return de.resolve(null);let r=Ga(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=aR(t,null,"F"),r=Ga(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const a=hn(...s);return this.ps.getDocuments(e,a).next((o=>this.indexManager.getMinOffset(e,r).next((l=>{const c=this.Ds(t,o);return this.Cs(t,c,a,l.readTime)?this.ys(e,aR(t,null,"F")):this.vs(e,c,t,l)}))))})))))}ws(e,t,r,i){return AL(t)||i.isEqual(Vt.min())?de.resolve(null):this.ps.getDocuments(e,r).next((s=>{const a=this.Ds(t,s);return this.Cs(t,a,r,i)?de.resolve(null):(qf()<=_n.DEBUG&&tt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Yf(t)),this.vs(e,a,t,YQ(i,Bp)).next((o=>o)))}))}Ds(e,t){let r=new Qn(u8(e));return t.forEach(((i,s)=>{W1(e,s)&&(r=r.add(s))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return qf()<=_n.DEBUG&&tt("QueryEngine","Using full collection scan to execute query:",Yf(t)),this.ps.getDocumentsMatchingQuery(e,t,pa.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((a=>{s=s.insert(a.key,a)})),s)))}}const zk="LocalStore",Yte=3e8;class Zte{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Er(tn),this.xs=new xc((s=>xd(s)),U1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Y8(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function J8(n,e,t,r){return new Zte(n,e,t,r)}async function Q8(n,e){const t=nn(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const a=[],o=[];let l=hn();for(const c of i){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of s){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next((c=>({Ls:c,removedBatchIds:a,addedBatchIds:o})))}))}))}function Jte(n,e){const t=nn(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(o,l,c,h){const g=c.batch,m=g.keys();let x=de.resolve();return m.forEach((y=>{x=x.next((()=>h.getEntry(l,y))).next((_=>{const w=c.docVersions.get(y);Ot(w!==null,48541),_.version.compareTo(w)<0&&(g.applyToRemoteDocument(_,c),_.isValidDocument()&&(_.setReadTime(c.commitVersion),h.addEntry(_)))}))})),x.next((()=>o.mutationQueue.removeMutationBatch(l,g)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(o){let l=hn();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function e9(n){const e=nn(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function Qte(n,e){const t=nn(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const o=[];e.targetChanges.forEach(((h,g)=>{const m=i.get(g);if(!m)return;o.push(t.Pi.removeMatchingKeys(s,h.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(s,h.addedDocuments,g))));let x=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?x=x.withResumeToken(si.EMPTY_BYTE_STRING,Vt.min()).withLastLimboFreeSnapshotVersion(Vt.min()):h.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(h.resumeToken,r)),i=i.insert(g,x),(function(_,w,T){return _.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=Yte?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,x,h)&&o.push(t.Pi.updateTargetData(s,x))}));let l=fa(),c=hn();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))})),o.push(ene(s,a,e.documentUpdates).next((h=>{l=h.ks,c=h.qs}))),!r.isEqual(Vt.min())){const h=t.Pi.getLastRemoteSnapshotVersion(s).next((g=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));o.push(h)}return de.waitFor(o).next((()=>a.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,l,c))).next((()=>l))})).then((s=>(t.Ms=i,s)))}function ene(n,e,t){let r=hn(),i=hn();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let a=fa();return t.forEach(((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Vt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):tt(zk,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)})),{ks:a,qs:i}}))}function tne(n,e){const t=nn(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Jh),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function nne(n,e){const t=nn(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((s=>s?(i=s,de.resolve(i)):t.Pi.allocateTargetId(r).next((a=>(i=new Wl(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function gR(n,e,t){const r=nn(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Ku(a))throw a;tt(zk,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function i3(n,e,t){const r=nn(n);let i=Vt.min(),s=hn();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,c,h){const g=nn(l),m=g.xs.get(h);return m!==void 0?de.resolve(g.Ms.get(m)):g.Pi.getTargetData(c,h)})(r,a,Ga(e)).next((o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,o.targetId).next((l=>{s=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:Vt.min(),t?s:hn()))).next((o=>(rne(r,zee(e),o),{documents:o,Qs:s})))))}function rne(n,e,t){let r=n.Os.get(e)||Vt.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Os.set(e,r)}class s3{constructor(){this.activeTargetIds=Xee()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class t9{constructor(){this.Mo=new s3,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new s3,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ine{Oo(e){}shutdown(){}}const a3="ConnectivityMonitor";class o3{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){tt(a3,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){tt(a3,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let By=null;function mR(){return By===null?By=(function(){return 268435456+Math.round(2147483648*Math.random())})():By++,"0x"+By.toString(16)}const _T="RestConnection",sne={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ane{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===_v?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const a=mR(),o=this.zo(e,t.toUriEncodedString());tt(_T,`Sending RPC '${e}' ${a}:`,o,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:c}=new URL(o),h=Ld(c);return this.Jo(e,o,l,r,h).then((g=>(tt(_T,`Received RPC '${e}' ${a}: `,g),g)),(g=>{throw md(_T,`RPC '${e}' ${a} failed with error: `,g,"url: ",o,"request:",r),g}))}Ho(e,t,r,i,s,a){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+fg})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const r=sne[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class one{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const rs="WebChannelConnection";class lne extends ane{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const a=mR();return new Promise(((o,l)=>{const c=new w6;c.setWithCredentials(!0),c.listenOnce(E6.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case m_.NO_ERROR:const g=c.getResponseJson();tt(rs,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),o(g);break;case m_.TIMEOUT:tt(rs,`RPC '${e}' ${a} timed out`),l(new ht(De.DEADLINE_EXCEEDED,"Request time out"));break;case m_.HTTP_ERROR:const m=c.getStatus();if(tt(rs,`RPC '${e}' ${a} failed with status:`,m,"response text:",c.getResponseText()),m>0){let x=c.getResponseJson();Array.isArray(x)&&(x=x[0]);const y=x?.error;if(y&&y.status&&y.message){const _=(function(T){const b=T.toLowerCase().replace(/_/g,"-");return Object.values(De).indexOf(b)>=0?b:De.UNKNOWN})(y.status);l(new ht(_,y.message))}else l(new ht(De.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ht(De.UNAVAILABLE,"Connection failed."));break;default:It(9055,{l_:e,streamId:a,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{tt(rs,`RPC '${e}' ${a} completed.`)}}));const h=JSON.stringify(i);tt(rs,`RPC '${e}' ${a} sending request:`,i),c.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=mR(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=b6(),o=T6(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=s.join("");tt(rs,`Creating RPC '${e}' stream ${i}: ${h}`,l);const g=a.createWebChannel(h,l);this.I_(g);let m=!1,x=!1;const y=new one({Yo:w=>{x?tt(rs,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(m||(tt(rs,`Opening RPC '${e}' stream ${i} transport.`),g.open(),m=!0),tt(rs,`RPC '${e}' stream ${i} sending:`,w),g.send(w))},Zo:()=>g.close()}),_=(w,T,b)=>{w.listen(T,(R=>{try{b(R)}catch(M){setTimeout((()=>{throw M}),0)}}))};return _(g,km.EventType.OPEN,(()=>{x||(tt(rs,`RPC '${e}' stream ${i} transport opened.`),y.o_())})),_(g,km.EventType.CLOSE,(()=>{x||(x=!0,tt(rs,`RPC '${e}' stream ${i} transport closed`),y.a_(),this.E_(g))})),_(g,km.EventType.ERROR,(w=>{x||(x=!0,md(rs,`RPC '${e}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),y.a_(new ht(De.UNAVAILABLE,"The operation could not be completed")))})),_(g,km.EventType.MESSAGE,(w=>{if(!x){const T=w.data[0];Ot(!!T,16349);const b=T,R=b?.error||b[0]?.error;if(R){tt(rs,`RPC '${e}' stream ${i} received error:`,R);const M=R.status;let D=(function(A){const C=Jr[A];if(C!==void 0)return S8(C)})(M),B=R.message;D===void 0&&(D=De.INTERNAL,B="Unknown error status: "+M+" with message "+R.message),x=!0,y.a_(new ht(D,B)),g.close()}else tt(rs,`RPC '${e}' stream ${i} received:`,T),y.u_(T)}})),_(o,S6.STAT_EVENT,(w=>{w.stat===Kb.PROXY?tt(rs,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===Kb.NOPROXY&&tt(rs,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{y.__()}),0),y}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function cne(){return typeof window<"u"?window:null}function b_(){return typeof document<"u"?document:null}function yE(n){return new ute(n,!0)}class n9{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&tt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const l3="PersistentStream";class r9{constructor(e,t,r,i,s,a,o,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new n9(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===De.RESOURCE_EXHAUSTED?(Ss(t.toString()),Ss("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===De.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new ht(De.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return tt(l3,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(tt(l3,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class une extends r9{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=fte(this.serializer,e),r=(function(s){if(!("targetChange"in s))return Vt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Vt.min():a.readTime?bs(a.readTime):Vt.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=cR(this.serializer),t.addTarget=(function(s,a){let o;const l=a.target;if(o=wv(l)?{documents:P8(s,l)}:{query:N8(s,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=R8(s,a.resumeToken);const c=oR(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Vt.min())>0){o.readTime=J0(s,a.snapshotVersion.toTimestamp());const c=oR(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o})(this.serializer,e);const r=mte(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=cR(this.serializer),t.removeTarget=e,this.q_(t)}}class hne extends r9{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ot(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ot(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ot(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=gte(e.writeResults,e.commitTime),r=bs(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=cR(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Tv(this.serializer,r)))};this.q_(t)}}class dne{}class fne extends dne{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ht(De.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Go(e,lR(t,r),i,s,a))).catch((s=>{throw s.name==="FirebaseError"?(s.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ht(De.UNKNOWN,s.toString())}))}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,lR(t,r),i,a,o,s))).catch((a=>{throw a.name==="FirebaseError"?(a.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ht(De.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class gne{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ss(t),this.aa=!1):tt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const wd="RemoteStore";class mne{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{jd(this)&&(tt(wd,"Restarting streams for network reachability change."),await(async function(l){const c=nn(l);c.Ea.add(4),await K1(c),c.Ra.set("Unknown"),c.Ea.delete(4),await _E(c)})(this))}))})),this.Ra=new gne(r,i)}}async function _E(n){if(jd(n))for(const e of n.da)await e(!0)}async function K1(n){for(const e of n.da)await e(!1)}function i9(n,e){const t=nn(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Hk(t)?Wk(t):mg(t).O_()&&$k(t,e))}function Uk(n,e){const t=nn(n),r=mg(t);t.Ia.delete(e),r.O_()&&s9(t,e),t.Ia.size===0&&(r.O_()?r.L_():jd(t)&&t.Ra.set("Unknown"))}function $k(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Vt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}mg(n).Y_(e)}function s9(n,e){n.Va.Ue(e),mg(n).Z_(e)}function Wk(n){n.Va=new ate({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),mg(n).start(),n.Ra.ua()}function Hk(n){return jd(n)&&!mg(n).x_()&&n.Ia.size>0}function jd(n){return nn(n).Ea.size===0}function a9(n){n.Va=void 0}async function pne(n){n.Ra.set("Online")}async function xne(n){n.Ia.forEach(((e,t)=>{$k(n,e)}))}async function yne(n,e){a9(n),Hk(n)?(n.Ra.ha(e),Wk(n)):n.Ra.set("Unknown")}async function _ne(n,e,t){if(n.Ra.set("Online"),e instanceof b8&&e.state===2&&e.cause)try{await(async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ia.delete(o),i.Va.removeTarget(o))})(n,e)}catch(r){tt(wd,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Iv(n,r)}else if(e instanceof S_?n.Va.Ze(e):e instanceof T8?n.Va.st(e):n.Va.tt(e),!t.isEqual(Vt.min()))try{const r=await e9(n.localStore);t.compareTo(r)>=0&&await(function(s,a){const o=s.Va.Tt(a);return o.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(c);h&&s.Ia.set(c,h.withResumeToken(l.resumeToken,a))}})),o.targetMismatches.forEach(((l,c)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(si.EMPTY_BYTE_STRING,h.snapshotVersion)),s9(s,l);const g=new Wl(h.target,l,c,h.sequenceNumber);$k(s,g)})),s.remoteSyncer.applyRemoteEvent(o)})(n,t)}catch(r){tt(wd,"Failed to raise snapshot:",r),await Iv(n,r)}}async function Iv(n,e,t){if(!Ku(e))throw e;n.Ea.add(1),await K1(n),n.Ra.set("Offline"),t||(t=()=>e9(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{tt(wd,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await _E(n)}))}function o9(n,e){return e().catch((t=>Iv(n,t,e)))}async function X1(n){const e=nn(n),t=Du(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Jh;for(;vne(e);)try{const i=await tne(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,wne(e,i)}catch(i){await Iv(e,i)}l9(e)&&c9(e)}function vne(n){return jd(n)&&n.Ta.length<10}function wne(n,e){n.Ta.push(e);const t=Du(n);t.O_()&&t.X_&&t.ea(e.mutations)}function l9(n){return jd(n)&&!Du(n).x_()&&n.Ta.length>0}function c9(n){Du(n).start()}async function Ene(n){Du(n).ra()}async function Sne(n){const e=Du(n);for(const t of n.Ta)e.ea(t.mutations)}async function Tne(n,e,t){const r=n.Ta.shift(),i=Nk.from(r,e,t);await o9(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await X1(n)}async function bne(n,e){e&&Du(n).X_&&await(async function(r,i){if((function(a){return rte(a)&&a!==De.ABORTED})(i.code)){const s=r.Ta.shift();Du(r).B_(),await o9(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await X1(r)}})(n,e),l9(n)&&c9(n)}async function c3(n,e){const t=nn(n);t.asyncQueue.verifyOperationInProgress(),tt(wd,"RemoteStore received new credentials");const r=jd(t);t.Ea.add(3),await K1(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await _E(t)}async function Rne(n,e){const t=nn(n);e?(t.Ea.delete(2),await _E(t)):e||(t.Ea.add(2),await K1(t),t.Ra.set("Unknown"))}function mg(n){return n.ma||(n.ma=(function(t,r,i){const s=nn(t);return s.sa(),new une(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:pne.bind(null,n),t_:xne.bind(null,n),r_:yne.bind(null,n),H_:_ne.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Hk(n)?Wk(n):n.Ra.set("Unknown")):(await n.ma.stop(),a9(n))}))),n.ma}function Du(n){return n.fa||(n.fa=(function(t,r,i){const s=nn(t);return s.sa(),new hne(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Ene.bind(null,n),r_:bne.bind(null,n),ta:Sne.bind(null,n),na:Tne.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await X1(n)):(await n.fa.stop(),n.Ta.length>0&&(tt(wd,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Kk{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new al,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,o=new Kk(e,t,a,i,s);return o.start(r),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ht(De.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xk(n,e){if(Ss("AsyncQueue",`${e}: ${n}`),Ku(n))return new ht(De.UNAVAILABLE,`${e}: ${n}`);throw n}class w0{static emptySet(e){return new w0(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ft.comparator(t.key,r.key):(t,r)=>ft.comparator(t.key,r.key),this.keyedMap=Im(),this.sortedSet=new Er(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof w0)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new w0;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class u3{constructor(){this.ga=new Er(ft.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):It(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Q0{constructor(e,t,r,i,s,a,o,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach((o=>{a.push({type:0,doc:o})})),new Q0(e,t,w0.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&uE(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class Ane{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class kne{constructor(){this.queries=h3(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=nn(t),s=i.queries;i.queries=h3(),s.forEach(((a,o)=>{for(const l of o.Sa)l.onError(r)}))})(this,new ht(De.ABORTED,"Firestore shutting down"))}}function h3(){return new xc((n=>c8(n)),uE)}async function u9(n,e){const t=nn(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new Ane,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=Xk(a,`Initialization of query '${Yf(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&qk(t)}async function h9(n,e){const t=nn(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Ine(n,e){const t=nn(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.Sa)o.Fa(i)&&(r=!0);a.wa=i}}r&&qk(t)}function Cne(n,e,t){const r=nn(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function qk(n){n.Ca.forEach((e=>{e.next()}))}var pR,d3;(d3=pR||(pR={})).Ma="default",d3.Cache="cache";class d9{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Q0(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Q0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==pR.Cache}}class f9{constructor(e){this.key=e}}class g9{constructor(e){this.key=e}}class Pne{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=hn(),this.mutatedKeys=hn(),this.eu=u8(e),this.tu=new w0(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new u3,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,g)=>{const m=i.get(h),x=W1(this.query,g)?g:null,y=!!m&&this.mutatedKeys.has(m.key),_=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let w=!1;m&&x?m.data.isEqual(x.data)?y!==_&&(r.track({type:3,doc:x}),w=!0):this.su(m,x)||(r.track({type:2,doc:x}),w=!0,(l&&this.eu(x,l)>0||c&&this.eu(x,c)<0)&&(o=!0)):!m&&x?(r.track({type:0,doc:x}),w=!0):m&&!x&&(r.track({type:1,doc:m}),w=!0,(l||c)&&(o=!0)),w&&(x?(a=a.add(x),s=_?s.add(h):s.delete(h)):(a=a.delete(h),s=s.delete(h)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:a,iu:r,Cs:o,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((h,g)=>(function(x,y){const _=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return It(20277,{Rt:w})}};return _(x)-_(y)})(h.type,g.type)||this.eu(h.doc,g.doc))),this.ou(r),i=i??!1;const o=t&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,c=l!==this.Za;return this.Za=l,a.length!==0||c?{snapshot:new Q0(this.query,e.tu,s,a,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new u3,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=hn(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new g9(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new f9(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=hn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Q0.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Yk="SyncEngine";class Nne{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Mne{constructor(e){this.key=e,this.hu=!1}}class Lne{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new xc((o=>c8(o)),uE),this.Iu=new Map,this.Eu=new Set,this.du=new Er(ft.comparator),this.Au=new Map,this.Ru=new Fk,this.Vu={},this.mu=new Map,this.fu=vd.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function One(n,e,t=!0){const r=v9(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await m9(r,e,t,!0),i}async function Dne(n,e){const t=v9(n);await m9(t,e,!0,!1)}async function m9(n,e,t,r){const i=await nne(n.localStore,Ga(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t);let o;return r&&(o=await jne(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&i9(n.remoteStore,i),o}async function jne(n,e,t,r,i){n.pu=(g,m,x)=>(async function(_,w,T,b){let R=w.view.ru(T);R.Cs&&(R=await i3(_.localStore,w.query,!1).then((({documents:k})=>w.view.ru(k,R))));const M=b&&b.targetChanges.get(w.targetId),D=b&&b.targetMismatches.get(w.targetId)!=null,B=w.view.applyChanges(R,_.isPrimaryClient,M,D);return g3(_,w.targetId,B.au),B.snapshot})(n,g,m,x);const s=await i3(n.localStore,e,!0),a=new Pne(e,s.Qs),o=a.ru(s.documents),l=H1.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),c=a.applyChanges(o,n.isPrimaryClient,l);g3(n,t,c.au);const h=new Nne(e,t,a);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function Fne(n,e,t){const r=nn(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((a=>!uE(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await gR(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Uk(r.remoteStore,i.targetId),xR(r,i.targetId)})).catch(Dd)):(xR(r,i.targetId),await gR(r.localStore,i.targetId,!0))}async function Vne(n,e){const t=nn(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Uk(t.remoteStore,r.targetId))}async function Bne(n,e,t){const r=w9(n);try{const i=await(function(a,o){const l=nn(a),c=qn.now(),h=o.reduce(((x,y)=>x.add(y.key)),hn());let g,m;return l.persistence.runTransaction("Locally write mutations","readwrite",(x=>{let y=fa(),_=hn();return l.Ns.getEntries(x,h).next((w=>{y=w,y.forEach(((T,b)=>{b.isValidDocument()||(_=_.add(T))}))})).next((()=>l.localDocuments.getOverlayedDocuments(x,y))).next((w=>{g=w;const T=[];for(const b of o){const R=tte(b,g.get(b.key).overlayedDocument);R!=null&&T.push(new yc(b.key,R,e8(R.value.mapValue),us.exists(!0)))}return l.mutationQueue.addMutationBatch(x,c,T,o)})).next((w=>{m=w;const T=w.applyToLocalDocumentSet(g,_);return l.documentOverlayCache.saveOverlays(x,w.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:d8(g)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,o,l){let c=a.Vu[a.currentUser.toKey()];c||(c=new Er(tn)),c=c.insert(o,l),a.Vu[a.currentUser.toKey()]=c})(r,i.batchId,t),await q1(r,i.changes),await X1(r.remoteStore)}catch(i){const s=Xk(i,"Failed to persist write");t.reject(s)}}async function p9(n,e){const t=nn(n);try{const r=await Qte(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const a=t.Au.get(s);a&&(Ot(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Ot(a.hu,14607):i.removedDocuments.size>0&&(Ot(a.hu,42227),a.hu=!1))})),await q1(t,r,e)}catch(r){await Dd(r)}}function f3(n,e,t){const r=nn(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)})),(function(a,o){const l=nn(a);l.onlineState=o;let c=!1;l.queries.forEach(((h,g)=>{for(const m of g.Sa)m.va(o)&&(c=!0)})),c&&qk(l)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Gne(n,e,t){const r=nn(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new Er(ft.comparator);a=a.insert(s,Vr.newNoDocument(s,Vt.min()));const o=hn().add(s),l=new gE(Vt.min(),new Map,new Er(tn),a,o);await p9(r,l),r.du=r.du.remove(s),r.Au.delete(e),Zk(r)}else await gR(r.localStore,e,!1).then((()=>xR(r,e,t))).catch(Dd)}async function zne(n,e){const t=nn(n),r=e.batch.batchId;try{const i=await Jte(t.localStore,e);y9(t,r,null),x9(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await q1(t,i)}catch(i){await Dd(i)}}async function Une(n,e,t){const r=nn(n);try{const i=await(function(a,o){const l=nn(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let h;return l.mutationQueue.lookupMutationBatch(c,o).next((g=>(Ot(g!==null,37113),h=g.keys(),l.mutationQueue.removeMutationBatch(c,g)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,o))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h))).next((()=>l.localDocuments.getDocuments(c,h)))}))})(r.localStore,e);y9(r,e,t),x9(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await q1(r,i)}catch(i){await Dd(i)}}function x9(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function y9(n,e,t){const r=nn(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function xR(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||_9(n,r)}))}function _9(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Uk(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Zk(n))}function g3(n,e,t){for(const r of t)r instanceof f9?(n.Ru.addReference(r.key,e),$ne(n,r)):r instanceof g9?(tt(Yk,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||_9(n,r.key)):It(19791,{wu:r})}function $ne(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(tt(Yk,"New document in limbo: "+t),n.Eu.add(r),Zk(n))}function Zk(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ft(Vn.fromString(e)),r=n.fu.next();n.Au.set(r,new Mne(t)),n.du=n.du.insert(t,r),i9(n.remoteStore,new Wl(Ga(cE(t.path)),r,"TargetPurposeLimboResolution",Fa.ce))}}async function q1(n,e,t){const r=nn(n),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((o,l)=>{a.push(r.pu(l,e,t).then((c=>{if((c||t)&&r.isPrimaryClient){const h=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=Gk.As(l.targetId,c);s.push(h)}})))})),await Promise.all(a),r.Pu.H_(i),await(async function(l,c){const h=nn(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>de.forEach(c,(m=>de.forEach(m.Es,(x=>h.persistence.referenceDelegate.addReference(g,m.targetId,x))).next((()=>de.forEach(m.ds,(x=>h.persistence.referenceDelegate.removeReference(g,m.targetId,x)))))))))}catch(g){if(!Ku(g))throw g;tt(zk,"Failed to update sequence numbers: "+g)}for(const g of c){const m=g.targetId;if(!g.fromCache){const x=h.Ms.get(m),y=x.snapshotVersion,_=x.withLastLimboFreeSnapshotVersion(y);h.Ms=h.Ms.insert(m,_)}}})(r.localStore,s))}async function Wne(n,e){const t=nn(n);if(!t.currentUser.isEqual(e)){tt(Yk,"User change. New user:",e.toKey());const r=await Q8(t.localStore,e);t.currentUser=e,(function(s,a){s.mu.forEach((o=>{o.forEach((l=>{l.reject(new ht(De.CANCELLED,a))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await q1(t,r.Ls)}}function Hne(n,e){const t=nn(n),r=t.Au.get(e);if(r&&r.hu)return hn().add(r.key);{let i=hn();const s=t.Iu.get(e);if(!s)return i;for(const a of s){const o=t.Tu.get(a);i=i.unionWith(o.view.nu)}return i}}function v9(n){const e=nn(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=p9.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Hne.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Gne.bind(null,e),e.Pu.H_=Ine.bind(null,e.eventManager),e.Pu.yu=Cne.bind(null,e.eventManager),e}function w9(n){const e=nn(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zne.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Une.bind(null,e),e}class Zp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yE(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return J8(this.persistence,new Z8,e.initialUser,this.serializer)}Cu(e){return new Vk(xE.mi,this.serializer)}Du(e){return new t9}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Zp.provider={build:()=>new Zp};class Kne extends Zp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ot(this.persistence.referenceDelegate instanceof kv,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new H8(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?os.withCacheSize(this.cacheSizeBytes):os.DEFAULT;return new Vk((r=>kv.mi(r,t)),this.serializer)}}class Xne extends Zp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await w9(this.xu.syncEngine),await X1(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return J8(this.persistence,new Z8,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new H8(r,e.asyncQueue,t)}Mu(e,t){const r=new eee(t,this.persistence);return new QQ(e.asyncQueue,r)}Cu(e){const t=Xte(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?os.withCacheSize(this.cacheSizeBytes):os.DEFAULT;return new Bk(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,cne(),b_(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new t9}}class Cv{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>f3(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Wne.bind(null,this.syncEngine),await Rne(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new kne})()}createDatastore(e){const t=yE(e.databaseInfo.databaseId),r=(function(s){return new lne(s)})(e.databaseInfo);return(function(s,a,o,l){return new fne(s,a,o,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,a,o){return new mne(r,i,s,a,o)})(this.localStore,this.datastore,e.asyncQueue,(t=>f3(this.syncEngine,t,0)),(function(){return o3.v()?new o3:new ine})())}createSyncEngine(e,t){return(function(i,s,a,o,l,c,h){const g=new Lne(i,s,a,o,l,c);return h&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=nn(t);tt(wd,"RemoteStore shutting down."),r.Ea.add(5),await K1(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Cv.provider={build:()=>new Cv};class E9{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ss("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const ju="FirestoreClient";class qne{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ui.UNAUTHENTICATED,this.clientId=_k.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async a=>{tt(ju,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(tt(ju,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new al;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Xk(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function vT(n,e){n.asyncQueue.verifyOperationInProgress(),tt(ju,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await Q8(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function m3(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Yne(n);tt(ju,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>c3(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>c3(e.remoteStore,i))),n._onlineComponents=e}async function Yne(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){tt(ju,"Using user provided OfflineComponentProvider");try{await vT(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===De.FAILED_PRECONDITION||i.code===De.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;md("Error using user provided cache. Falling back to memory cache: "+t),await vT(n,new Zp)}}else tt(ju,"Using default OfflineComponentProvider"),await vT(n,new Kne(void 0));return n._offlineComponents}async function S9(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(tt(ju,"Using user provided OnlineComponentProvider"),await m3(n,n._uninitializedComponentsProvider._online)):(tt(ju,"Using default OnlineComponentProvider"),await m3(n,new Cv))),n._onlineComponents}function Zne(n){return S9(n).then((e=>e.syncEngine))}async function T9(n){const e=await S9(n),t=e.eventManager;return t.onListen=One.bind(null,e.syncEngine),t.onUnlisten=Fne.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Dne.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Vne.bind(null,e.syncEngine),t}function Jne(n,e,t={}){const r=new al;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,c){const h=new E9({next:m=>{h.Nu(),a.enqueueAndForget((()=>h9(s,g)));const x=m.docs.has(o);!x&&m.fromCache?c.reject(new ht(De.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&m.fromCache&&l&&l.source==="server"?c.reject(new ht(De.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),g=new d9(cE(o.path),h,{includeMetadataChanges:!0,qa:!0});return u9(s,g)})(await T9(n),n.asyncQueue,e,t,r))),r.promise}function Qne(n,e,t={}){const r=new al;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,c){const h=new E9({next:m=>{h.Nu(),a.enqueueAndForget((()=>h9(s,g))),m.fromCache&&l.source==="server"?c.reject(new ht(De.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),g=new d9(o,h,{includeMetadataChanges:!0,qa:!0});return u9(s,g)})(await T9(n),n.asyncQueue,e,t,r))),r.promise}function b9(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const p3=new Map;const R9="firestore.googleapis.com",x3=!0;class y3{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ht(De.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=R9,this.ssl=x3}else this.host=e.host,this.ssl=e.ssl??x3;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=z8;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Pte)throw new ht(De.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}qQ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=b9(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ht(De.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ht(De.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ht(De.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vE{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new y3({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ht(De.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ht(De.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new y3(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new VQ;switch(r.type){case"firstParty":return new UQ(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ht(De.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=p3.get(t);r&&(tt("ComponentProvider","Removing Datastore"),p3.delete(t),r.terminate())})(this),Promise.resolve()}}function ere(n,e,t,r={}){n=Ka(n,vE);const i=Ld(e),s=n._getSettings(),a={...s,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;i&&(ik(`https://${o}`),sk("Firestore",!0)),s.host!==R9&&s.host!==o&&md("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:o,ssl:i,emulatorOptions:r};if(!hd(l,a)&&(n._setSettings(l),r.mockUserToken)){let c,h;if(typeof r.mockUserToken=="string")c=r.mockUserToken,h=Ui.MOCK_USER;else{c=PF(r.mockUserToken,n._app?.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new ht(De.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Ui(g)}n._authCredentials=new BQ(new A6(c,h))}}class pg{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new pg(this.firestore,e,this._query)}}class Hr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ku(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Hr(this.firestore,e,this._key)}toJSON(){return{type:Hr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(G1(t,Hr._jsonSchema))return new Hr(e,r||null,new ft(Vn.fromString(t.referencePath)))}}Hr._jsonSchemaVersion="firestore/documentReference/1.0",Hr._jsonSchema={type:ri("string",Hr._jsonSchemaVersion),referencePath:ri("string")};class ku extends pg{constructor(e,t,r){super(e,t,cE(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Hr(this.firestore,null,new ft(e))}withConverter(e){return new ku(this.firestore,e,this._path)}}function _3(n,e,...t){if(n=Ni(n),I6("collection","path",e),n instanceof vE){const r=Vn.fromString(e,...t);return lL(r),new ku(n,null,r)}{if(!(n instanceof Hr||n instanceof ku))throw new ht(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Vn.fromString(e,...t));return lL(r),new ku(n.firestore,null,r)}}function E0(n,e,...t){if(n=Ni(n),arguments.length===1&&(e=_k.newId()),I6("doc","path",e),n instanceof vE){const r=Vn.fromString(e,...t);return oL(r),new Hr(n,null,new ft(r))}{if(!(n instanceof Hr||n instanceof ku))throw new ht(De.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Vn.fromString(e,...t));return oL(r),new Hr(n.firestore,n instanceof ku?n.converter:null,new ft(r))}}const v3="AsyncQueue";class w3{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new n9(this,"async_queue_retry"),this._c=()=>{const r=b_();r&&tt(v3,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=b_();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=b_();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new al;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ku(e))throw e;tt(v3,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Ss("INTERNAL UNHANDLED ERROR: ",E3(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=Kk.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&It(47125,{Pc:E3(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function E3(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class qu extends vE{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new w3,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new w3(e),this._firestoreClient=void 0,await e}}}function tre(n,e){const t=typeof n=="object"?n:lk(),r=typeof n=="string"?n:_v,i=Zw(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=kF("firestore");s&&ere(i,...s)}return i}function Jk(n){if(n._terminated)throw new ht(De.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||A9(n),n._firestoreClient}function A9(n){const e=n._freezeSettings(),t=(function(i,s,a,o){return new Iee(i,s,a,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,b9(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new qne(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}function nre(n,e){md("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return rre(n,Cv.provider,{build:r=>new Xne(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function rre(n,e,t){if((n=Ka(n,qu))._firestoreClient||n._terminated)throw new ht(De.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ht(De.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},A9(n)}class Ma{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ma(si.fromBase64String(e))}catch(t){throw new ht(De.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ma(si.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ma._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(G1(e,Ma._jsonSchema))return Ma.fromBase64String(e.bytes)}}Ma._jsonSchemaVersion="firestore/bytes/1.0",Ma._jsonSchema={type:ri("string",Ma._jsonSchemaVersion),bytes:ri("string")};class wE{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ht(De.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class EE{constructor(e){this._methodName=e}}class ol{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ht(De.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ht(De.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return tn(this._lat,e._lat)||tn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ol._jsonSchemaVersion}}static fromJSON(e){if(G1(e,ol._jsonSchema))return new ol(e.latitude,e.longitude)}}ol._jsonSchemaVersion="firestore/geoPoint/1.0",ol._jsonSchema={type:ri("string",ol._jsonSchemaVersion),latitude:ri("number"),longitude:ri("number")};class ll{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ll._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(G1(e,ll._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ll(e.vectorValues);throw new ht(De.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ll._jsonSchemaVersion="firestore/vectorValue/1.0",ll._jsonSchema={type:ri("string",ll._jsonSchemaVersion),vectorValues:ri("object")};const ire=/^__.*__$/;class sre{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new yc(e,this.data,this.fieldMask,t,this.fieldTransforms):new gg(e,this.data,t,this.fieldTransforms)}}class k9{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new yc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function I9(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw It(40011,{Ac:n})}}class Qk{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Qk({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Pv(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(I9(this.Ac)&&ire.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class are{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||yE(e)}Cc(e,t,r,i=!1){return new Qk({Ac:e,methodName:t,Dc:r,path:Pr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function SE(n){const e=n._freezeSettings(),t=yE(n._databaseId);return new are(n._databaseId,!!e.ignoreUndefinedProperties,t)}function C9(n,e,t,r,i,s={}){const a=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);tI("Data must be an object, but it was:",a,r);const o=P9(r,a);let l,c;if(s.merge)l=new Gs(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const h=[];for(const g of s.mergeFields){const m=yR(e,g,t);if(!a.contains(m))throw new ht(De.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);M9(h,m)||h.push(m)}l=new Gs(h),c=a.fieldTransforms.filter((g=>l.covers(g.field)))}else l=null,c=a.fieldTransforms;return new sre(new cs(o),l,c)}class TE extends EE{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof TE}}class eI extends EE{_toFieldTransform(e){return new _8(e.path,new q0)}isEqual(e){return e instanceof eI}}function ore(n,e,t,r){const i=n.Cc(1,e,t);tI("Data must be an object, but it was:",i,r);const s=[],a=cs.empty();Xu(r,((l,c)=>{const h=nI(e,l,t);c=Ni(c);const g=i.yc(h);if(c instanceof TE)s.push(h);else{const m=Y1(c,g);m!=null&&(s.push(h),a.set(h,m))}}));const o=new Gs(s);return new k9(a,o,i.fieldTransforms)}function lre(n,e,t,r,i,s){const a=n.Cc(1,e,t),o=[yR(e,r,t)],l=[i];if(s.length%2!=0)throw new ht(De.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)o.push(yR(e,s[m])),l.push(s[m+1]);const c=[],h=cs.empty();for(let m=o.length-1;m>=0;--m)if(!M9(c,o[m])){const x=o[m];let y=l[m];y=Ni(y);const _=a.yc(x);if(y instanceof TE)c.push(x);else{const w=Y1(y,_);w!=null&&(c.push(x),h.set(x,w))}}const g=new Gs(c);return new k9(h,g,a.fieldTransforms)}function cre(n,e,t,r=!1){return Y1(t,n.Cc(r?4:3,e))}function Y1(n,e){if(N9(n=Ni(n)))return tI("Unsupported field value:",e,n),P9(n,e);if(n instanceof EE)return(function(r,i){if(!I9(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let a=0;for(const o of r){let l=Y1(o,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=Ni(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return qee(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=qn.fromDate(r);return{timestampValue:J0(i.serializer,s)}}if(r instanceof qn){const s=new qn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:J0(i.serializer,s)}}if(r instanceof ol)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ma)return{bytesValue:R8(i.serializer,r._byteString)};if(r instanceof Hr){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ok(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ll)return(function(a,o){return{mapValue:{fields:{[Ak]:{stringValue:kk},[W0]:{arrayValue:{values:a.toArray().map((c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return Ck(o.serializer,c)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${tE(r)}`)})(n,e)}function P9(n,e){const t={};return W6(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xu(n,((r,i)=>{const s=Y1(i,e.mc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function N9(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof qn||n instanceof ol||n instanceof Ma||n instanceof Hr||n instanceof EE||n instanceof ll)}function tI(n,e,t){if(!N9(t)||!C6(t)){const r=tE(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function yR(n,e,t){if((e=Ni(e))instanceof wE)return e._internalPath;if(typeof e=="string")return nI(n,e);throw Pv("Field path arguments must be of type string or ",n,!1,void 0,t)}const ure=new RegExp("[~\\*/\\[\\]]");function nI(n,e,t){if(e.search(ure)>=0)throw Pv(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new wE(...e.split("."))._internalPath}catch{throw Pv(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Pv(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new ht(De.INVALID_ARGUMENT,o+n+l)}function M9(n,e){return n.some((t=>t.isEqual(e)))}class L9{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Hr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new hre(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(rI("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class hre extends L9{data(){return super.data()}}function rI(n,e){return typeof e=="string"?nI(n,e):e instanceof wE?e._internalPath:e._delegate._internalPath}function dre(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ht(De.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class iI{}class fre extends iI{}function gre(n,e,...t){let r=[];e instanceof iI&&r.push(e),r=r.concat(t),(function(s){const a=s.filter((l=>l instanceof sI)).length,o=s.filter((l=>l instanceof bE)).length;if(a>1||a>0&&o>0)throw new ht(De.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class bE extends fre{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new bE(e,t,r)}_apply(e){const t=this._parse(e);return O9(e._query,t),new pg(e.firestore,e.converter,sR(e._query,t))}_parse(e){const t=SE(e.firestore);return(function(s,a,o,l,c,h,g){let m;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new ht(De.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){T3(g,h);const y=[];for(const _ of g)y.push(S3(l,s,_));m={arrayValue:{values:y}}}else m=S3(l,s,g)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||T3(g,h),m=cre(o,a,g,h==="in"||h==="not-in");return vn.create(c,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function mre(n,e,t){const r=e,i=rI("where",n);return bE._create(i,r,t)}class sI extends iI{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new sI(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Zn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)O9(a,l),a=sR(a,l)})(e._query,t),new pg(e.firestore,e.converter,sR(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function S3(n,e,t){if(typeof(t=Ni(t))=="string"){if(t==="")throw new ht(De.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!l8(e)&&t.indexOf("/")!==-1)throw new ht(De.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Vn.fromString(t));if(!ft.isDocumentKey(r))throw new ht(De.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Xp(n,new ft(r))}if(t instanceof Hr)return Xp(n,t._key);throw new ht(De.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tE(t)}.`)}function T3(n,e){if(!Array.isArray(n)||n.length===0)throw new ht(De.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function O9(n,e){const t=(function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ht(De.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ht(De.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class pre{convertValue(e,t="none"){switch(Lu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return yr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(lc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw It(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Xu(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){const t=e.fields?.[W0].arrayValue?.values?.map((r=>yr(r.doubleValue)));return new ll(t)}convertGeoPoint(e){return new ol(yr(e.latitude),yr(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=oE(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Hp(e));default:return null}}convertTimestamp(e){const t=oc(e);return new qn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Vn.fromString(e);Ot(D8(r),9688,{name:e});const i=new pd(r.get(1),r.get(3)),s=new ft(r.popFirst(5));return i.isEqual(t)||Ss(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function D9(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Nm{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class td extends L9{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new R_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(rI("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ht(De.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=td._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}td._jsonSchemaVersion="firestore/documentSnapshot/1.0",td._jsonSchema={type:ri("string",td._jsonSchemaVersion),bundleSource:ri("string","DocumentSnapshot"),bundleName:ri("string"),bundle:ri("string")};class R_ extends td{data(e={}){return super.data(e)}}class S0{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Nm(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new R_(this._firestore,this._userDataWriter,r.key,r,new Nm(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ht(De.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((o=>{const l=new R_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Nm(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((o=>s||o.type!==3)).map((o=>{const l=new R_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Nm(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:xre(o.type),doc:l,oldIndex:c,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ht(De.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=S0._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=_k.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function xre(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return It(61501,{type:n})}}function yre(n){n=Ka(n,Hr);const e=Ka(n.firestore,qu);return Jne(Jk(e),n._key).then((t=>Sre(e,n,t)))}S0._jsonSchemaVersion="firestore/querySnapshot/1.0",S0._jsonSchema={type:ri("string",S0._jsonSchemaVersion),bundleSource:ri("string","QuerySnapshot"),bundleName:ri("string"),bundle:ri("string")};class j9 extends pre{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ma(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Hr(this.firestore,null,t)}}function _re(n){n=Ka(n,pg);const e=Ka(n.firestore,qu),t=Jk(e),r=new j9(e);return dre(n._query),Qne(t,n._query).then((i=>new S0(e,r,n,i)))}function b3(n,e,t){n=Ka(n,Hr);const r=Ka(n.firestore,qu),i=D9(n.converter,e,t);return RE(r,[C9(SE(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,us.none())])}function vre(n,e,t,...r){n=Ka(n,Hr);const i=Ka(n.firestore,qu),s=SE(i);let a;return a=typeof(e=Ni(e))=="string"||e instanceof wE?lre(s,"updateDoc",n._key,e,t,r):ore(s,"updateDoc",n._key,e),RE(i,[a.toMutation(n._key,us.exists(!0))])}function wre(n){return RE(Ka(n.firestore,qu),[new fE(n._key,us.none())])}function Ere(n,e){const t=Ka(n.firestore,qu),r=E0(n),i=D9(n.converter,e);return RE(t,[C9(SE(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,us.exists(!1))]).then((()=>r))}function RE(n,e){return(function(r,i){const s=new al;return r.asyncQueue.enqueueAndForget((async()=>Bne(await Zne(r),i,s))),s.promise})(Jk(n),e)}function Sre(n,e,t){const r=t.docs.get(e._key),i=new j9(n);return new td(n,i,e._key,r,new Nm(t.hasPendingWrites,t.fromCache),e.converter)}function R3(){return new eI("serverTimestamp")}(function(e,t=!0){(function(i){fg=i})(Od),dd(new Nu("firestore",((r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),o=new qu(new GQ(r.getProvider("auth-internal")),new $Q(a,r.getProvider("app-check-internal")),(function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ht(De.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pd(c.options.projectId,h)})(a,i),a);return s={useFetchStreams:t,...s},o._setSettings(s),o}),"PUBLIC").setMultipleInstances(!0)),il(rL,iL,e),il(rL,iL,"esm2020")})();const F9="firebasestorage.googleapis.com",Tre="storageBucket",bre=120*1e3,Rre=600*1e3;class wl extends vl{constructor(e,t,r=0){super(wT(e),`Firebase Storage: ${t} (${wT(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,wl.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return wT(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ml;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ml||(ml={}));function wT(n){return"storage/"+n}function Are(){const n="An unknown error occurred, please check the error payload for server response.";return new wl(ml.UNKNOWN,n)}function kre(){return new wl(ml.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Ire(){return new wl(ml.CANCELED,"User canceled the upload/download.")}function Cre(n){return new wl(ml.INVALID_URL,"Invalid URL '"+n+"'.")}function Pre(n){return new wl(ml.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function A3(n){return new wl(ml.INVALID_ARGUMENT,n)}function V9(){return new wl(ml.APP_DELETED,"The Firebase app was deleted.")}function Nre(n){return new wl(ml.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class xo{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=xo.makeFromUrl(e,t)}catch{return new xo(e,"")}if(r.path==="")return r;throw Pre(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function c(M){M.path_=decodeURIComponent(M.path)}const h="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",x=new RegExp(`^https?://${g}/${h}/b/${i}/o${m}`,"i"),y={bucket:1,path:3},_=t===F9?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",T=new RegExp(`^https?://${_}/${i}/${w}`,"i"),R=[{regex:o,indices:l,postModify:s},{regex:x,indices:y,postModify:c},{regex:T,indices:{bucket:1,path:2},postModify:c}];for(let M=0;M<R.length;M++){const D=R[M],B=D.regex.exec(e);if(B){const k=B[D.indices.bucket];let A=B[D.indices.path];A||(A=""),r=new xo(k,A),D.postModify(r);break}}if(r==null)throw Cre(e);return r}}class Mre{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function Lre(n,e,t){let r=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let c=!1;function h(...w){c||(c=!0,e.apply(null,w))}function g(w){i=setTimeout(()=>{i=null,n(x,l())},w)}function m(){s&&clearTimeout(s)}function x(w,...T){if(c){m();return}if(w){m(),h.call(null,w,...T);return}if(l()||a){m(),h.call(null,w,...T);return}r<64&&(r*=2);let R;o===1?(o=2,R=0):R=(r+Math.random())*1e3,g(R)}let y=!1;function _(w){y||(y=!0,m(),!c&&(i!==null?(w||(o=2),clearTimeout(i),g(0)):w||(o=1)))}return g(0),s=setTimeout(()=>{a=!0,_(!0)},t),_}function Ore(n){n(!1)}function Dre(n){return n!==void 0}function k3(n,e,t,r){if(r<e)throw A3(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw A3(`Invalid value for '${n}'. Expected ${t} or less.`)}function jre(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Nv;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Nv||(Nv={}));function Fre(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}class Vre{constructor(e,t,r,i,s,a,o,l,c,h,g,m=!0,x=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=g,this.retry=m,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,_)=>{this.resolve_=y,this.reject_=_,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Gy(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===Nv.NO_ERROR,l=s.getStatus();if(!o||Fre(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===Nv.ABORT;r(!1,new Gy(!1,null,h));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new Gy(c,s))})},t=(r,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());Dre(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=Are();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?V9():Ire();a(l)}else{const l=kre();a(l)}};this.canceled_?t(!1,new Gy(!1,null,!0)):this.backoffId_=Lre(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Ore(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Gy{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function Bre(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Gre(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function zre(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Ure(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function $re(n,e,t,r,i,s,a=!0,o=!1){const l=jre(n.urlParams),c=n.url+l,h=Object.assign({},n.headers);return zre(h,e),Bre(h,t),Gre(h,s),Ure(h,r),new Vre(c,n.method,h,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,o)}function Wre(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Hre(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class Mv{constructor(e,t){this._service=e,t instanceof xo?this._location=t:this._location=xo.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Mv(e,t)}get root(){const e=new xo(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Hre(this._location.path)}get storage(){return this._service}get parent(){const e=Wre(this._location.path);if(e===null)return null;const t=new xo(this._location.bucket,e);return new Mv(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Nre(e)}}function I3(n,e){const t=e?.[Tre];return t==null?null:xo.makeFromBucketSpec(t,n)}function Kre(n,e,t,r={}){n.host=`${e}:${t}`;const i=Ld(e);i&&(ik(`https://${n.host}/b`),sk("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:PF(s,n.app.options.projectId))}class Xre{constructor(e,t,r,i,s,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=F9,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=bre,this._maxUploadRetryTime=Rre,this._requests=new Set,i!=null?this._bucket=xo.makeFromBucketSpec(i,this._host):this._bucket=I3(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=xo.makeFromBucketSpec(this._url,e):this._bucket=I3(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){k3("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){k3("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(ha(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Mv(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new Mre(V9());{const a=$re(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const C3="@firebase/storage",P3="0.14.0";const B9="storage";function qre(n=lk(),e){n=Ni(n);const r=Zw(n,B9).getImmediate({identifier:e}),i=kF("storage");return i&&Yre(r,...i),r}function Yre(n,e,t,r={}){Kre(n,e,t,r)}function Zre(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Xre(t,r,i,e,Od)}function Jre(){dd(new Nu(B9,Zre,"PUBLIC").setMultipleInstances(!0)),il(C3,P3,""),il(C3,P3,"esm2020")}Jre();const Qre={apiKey:"AIzaSyBcLuKvUr5XqEJTwOf9I0hqJ1o9g3kOZ-g",authDomain:"detectorapp-nl.firebaseapp.com",projectId:"detectorapp-nl",storageBucket:"detectorapp-nl.firebasestorage.app",messagingSenderId:"110954177210",appId:"1:110954177210:web:d77c9ed262ad92bc431883"},aI=FF(Qre),Hh=OQ(aI),pu=tre(aI);qre(aI);nre(pu).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const eie={};function tie(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var s;const a=l=>l===null?null:JSON.parse(l,void 0),o=(s=t.getItem(i))!=null?s:null;return o instanceof Promise?o.then(a):a(o)},setItem:(i,s)=>t.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>t.removeItem(i)}}const Jp=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return Jp(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return Jp(r)(t)}}}},nie=(n,e)=>(t,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:w=>w,version:0,merge:(w,T)=>({...T,...w}),...e},a=!1;const o=new Set,l=new Set;let c;try{c=s.getStorage()}catch{}if(!c)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...w)},r,i);const h=Jp(s.serialize),g=()=>{const w=s.partialize({...r()});let T;const b=h({state:w,version:s.version}).then(R=>c.setItem(s.name,R)).catch(R=>{T=R});if(T)throw T;return b},m=i.setState;i.setState=(w,T)=>{m(w,T),g()};const x=n((...w)=>{t(...w),g()},r,i);let y;const _=()=>{var w;if(!c)return;a=!1,o.forEach(b=>b(r()));const T=((w=s.onRehydrateStorage)==null?void 0:w.call(s,r()))||void 0;return Jp(c.getItem.bind(c))(s.name).then(b=>{if(b)return s.deserialize(b)}).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return s.migrate(b.state,b.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return b.state}).then(b=>{var R;return y=s.merge(b,(R=r())!=null?R:x),t(y,!0),g()}).then(()=>{T?.(y,void 0),a=!0,l.forEach(b=>b(y))}).catch(b=>{T?.(void 0,b)})};return i.persist={setOptions:w=>{s={...s,...w},w.getStorage&&(c=w.getStorage())},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>_(),hasHydrated:()=>a,onHydrate:w=>(o.add(w),()=>{o.delete(w)}),onFinishHydration:w=>(l.add(w),()=>{l.delete(w)})},_(),y||x},rie=(n,e)=>(t,r,i)=>{let s={storage:tie(()=>localStorage),partialize:_=>_,version:0,merge:(_,w)=>({...w,..._}),...e},a=!1;const o=new Set,l=new Set;let c=s.storage;if(!c)return n((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(..._)},r,i);const h=()=>{const _=s.partialize({...r()});return c.setItem(s.name,{state:_,version:s.version})},g=i.setState;i.setState=(_,w)=>{g(_,w),h()};const m=n((..._)=>{t(..._),h()},r,i);i.getInitialState=()=>m;let x;const y=()=>{var _,w;if(!c)return;a=!1,o.forEach(b=>{var R;return b((R=r())!=null?R:m)});const T=((w=s.onRehydrateStorage)==null?void 0:w.call(s,(_=r())!=null?_:m))||void 0;return Jp(c.getItem.bind(c))(s.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return[!0,s.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var R;const[M,D]=b;if(x=s.merge(D,(R=r())!=null?R:m),t(x,!0),M)return h()}).then(()=>{T?.(x,void 0),x=r(),a=!0,l.forEach(b=>b(x))}).catch(b=>{T?.(void 0,b)})};return i.persist={setOptions:_=>{s={...s,..._},_.storage&&(c=_.storage)},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>y(),hasHydrated:()=>a,onHydrate:_=>(o.add(_),()=>{o.delete(_)}),onFinishHydration:_=>(l.add(_),()=>{l.delete(_)})},s.skipHydration||y(),x||m},iie=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((eie?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),nie(n,e)):rie(n,e),Ro=iie,yn=Yi()(Ro(n=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,vondstenLocalOnly:!0,showVondstButton:!1,showRouteRecordButton:!1,showLocalVondsten:!0,showCustomPointLayers:!0,fontScale:100,layerPanelFontScale:100,presetPanelFontScale:100,menuFontScale:100,voiceFeedbackEnabled:!1,showStepCounter:!1,showFontSliders:!1,showWeatherButton:!1,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setVondstenLocalOnly:e=>n({vondstenLocalOnly:e}),setShowVondstButton:e=>n({showVondstButton:e}),setShowRouteRecordButton:e=>n({showRouteRecordButton:e}),setShowLocalVondsten:e=>n({showLocalVondsten:e}),setShowCustomPointLayers:e=>n({showCustomPointLayers:e}),setFontScale:e=>n({fontScale:e}),setLayerPanelFontScale:e=>n({layerPanelFontScale:e}),setPresetPanelFontScale:e=>n({presetPanelFontScale:e}),setMenuFontScale:e=>n({menuFontScale:e}),setVoiceFeedbackEnabled:e=>n({voiceFeedbackEnabled:e}),setShowStepCounter:e=>n({showStepCounter:e}),setShowFontSliders:e=>n({showFontSliders:e}),setShowWeatherButton:e=>n({showWeatherButton:e})}),{name:"detectorapp-settings",version:2,migrate:(n,e)=>e<2?{...n,showScaleBar:!0}:n})),AE=Yi()(hg((n,e)=>({user:null,accessToken:null,loading:!1,error:null,initialized:!1,setUser:t=>{n(r=>{r.user=t,r.loading=!1})},setLoading:t=>{n(r=>{r.loading=t})},setError:t=>{n(r=>{r.error=t})},setAccessToken:t=>{n(r=>{r.accessToken=t})},signInWithGoogle:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new fo;await XM(Hh,t)}catch(t){console.error("Google sign-in error:",t),n(r=>{r.error=t.message,r.loading=!1})}},connectGoogleFit:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new fo;t.addScope("https://www.googleapis.com/auth/fitness.activity.read");const r=await XM(Hh,t),i=fo.credentialFromResult(r);return i?.accessToken?(n(s=>{s.accessToken=i.accessToken||null,s.loading=!1}),console.log(" Google Fit gekoppeld"),!0):(n(s=>{s.loading=!1}),!1)}catch(t){return console.error("Google Fit connect error:",t),n(r=>{r.error=t.message,r.loading=!1}),!1}},logout:async()=>{n(t=>{t.loading=!0});try{await l6(Hh),n(t=>{t.accessToken=null})}catch(t){console.error("Logout error:",t),n(r=>{r.error=t.message,r.loading=!1})}},initAuth:()=>{e().initialized||(n(t=>{t.initialized=!0}),o6(Hh,t=>{n(r=>{r.user=t,r.loading=!1}),t&&yn.getState().setVondstenLocalOnly(!1)}))}})));Yi()(hg((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(r=>{r.loading=!0});try{const r=gre(_3(pu,"vondsten"),mre("userId","==",t)),s=(await _re(r)).docs.map(a=>({id:a.id,...a.data()}));n(a=>{a.vondsten=s,a.loading=!1})}catch(r){n(i=>{i.error=r.message,i.loading=!1})}},addVondst:async t=>{const r=new Date().toISOString(),i={...t,createdAt:r,updatedAt:r},s=await Ere(_3(pu,"vondsten"),i);return n(a=>{a.vondsten.push({...i,id:s.id})}),s.id},updateVondst:async(t,r)=>{const i=E0(pu,"vondsten",t);await vre(i,{...r,updatedAt:new Date().toISOString()}),n(s=>{const a=s.vondsten.findIndex(o=>o.id===t);a!==-1&&(s.vondsten[a]={...s.vondsten[a],...r})})},deleteVondst:async t=>{await wre(E0(pu,"vondsten",t)),n(r=>{r.vondsten=r.vondsten.filter(i=>i.id!==t)})}})));const ET=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AMK Monumenten","Gewaspercelen"],baseLayer:"CartoDB (licht)",isBuiltIn:!1},{id:"steentijd",name:"Steentijd",icon:"Mountain",layers:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","AMK Steentijd","AHN4 Multi-Hillshade NL","Labels Overlay"],baseLayer:"Luchtfoto",isBuiltIn:!1},{id:"romeins-midvroeg",name:"Romeins - Mid vroeg",icon:"Layers",layers:["Romeinse wegen (regio)","Romeinse Forten","Romeinse Forten Lijnen","AMK Romeins","AMK Vroege ME","Gewaspercelen","Kadastrale Grenzen"],isBuiltIn:!1},{id:"midlaat-nieuwetijd",name:"Mid laat - Nieuwe tijd",icon:"Grid",layers:["AMK Late ME","Kastelen","Essen","Rijksmonumenten","Gewaspercelen","Kadastrale Grenzen","Oude Kernen"],isBuiltIn:!1},{id:"woii-militair",name:"WOII & Militair",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten"],isBuiltIn:!1},{id:"analyse",name:"Terrein Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","Archeo Landschappen","AHN4 Multi-Hillshade NL","AHN4 Hoogtekaart Kleur"],isBuiltIn:!1}],N3=["Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],G9=Yi()(Ro((n,e)=>({presets:[...ET],applyPreset:t=>{const r=e().presets.find(s=>s.id===t);if(!r)return;const i=Ri.getState();N3.forEach(s=>i.setLayerVisibility(s,!1)),r.layers.forEach(s=>i.setLayerVisibility(s,!0)),r.baseLayer&&["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(a=>{i.setLayerVisibility(a,a===r.baseLayer)}),console.log(` Preset toegepast: ${r.name}${r.baseLayer?` (${r.baseLayer})`:""}`)},createPreset:(t,r)=>{const i=Ri.getState(),s=Object.entries(i.visible).filter(([o,l])=>l&&N3.includes(o)).map(([o])=>o),a={id:`custom-${Date.now()}`,name:t,icon:r,layers:s,isBuiltIn:!1};n(o=>({presets:[...o.presets,a]})),console.log(` Preset aangemaakt: ${t} met ${s.length} lagen`)},updatePreset:(t,r)=>{n(i=>({presets:i.presets.map(s=>s.id===t?{...s,...r}:s)}))},deletePreset:t=>{n(r=>({presets:r.presets.filter(i=>i.id!==t||i.isBuiltIn)}))},resetToDefaults:()=>{n({presets:[...ET]})}}),{name:"detectorapp-presets",version:9,migrate:(n,e)=>e<9?{presets:[...ET]}:n})),M3=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],Z1=Yi()(Ro((n,e)=>({layers:[],addLayer:t=>{const r=crypto.randomUUID(),i=e().layers.length,s=M3[i%M3.length];return n(a=>({layers:[...a.layers,{...t,id:r,createdAt:new Date().toISOString(),color:t.color||s,visible:t.visible??!0,opacity:t.opacity??1}]})),r},removeLayer:t=>n(r=>({layers:r.layers.filter(i=>i.id!==t)})),updateLayer:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)})),toggleVisibility:t=>n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)})),setOpacity:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,opacity:r}:s)})),setColor:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,color:r}:s)})),clearAll:()=>n({layers:[]})}),{name:"detectorapp-custom-layers",version:1})),sie=["CartoDB (licht)","OpenStreetMap","Luchtfoto","Labels Overlay","Mijn Vondsten"],oI=Yi()(Ro((n,e)=>({tier:"free",unlockedRegions:["nl"],devMode:!0,setTier:t=>n({tier:t}),unlockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.includes(t)?r.unlockedRegions:[...r.unlockedRegions,t]})),lockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.filter(i=>i!==t)})),setDevMode:t=>n({devMode:t}),isRegionUnlocked:t=>{const r=e();return r.devMode||r.tier==="pro"?!0:r.unlockedRegions.includes(t)},isLayerUnlocked:(t,r="free",i=["nl"])=>{const s=e();return s.devMode||sie.includes(t)||r==="free"||s.tier==="pro"?!0:s.tier==="premium"?i.some(a=>s.unlockedRegions.includes(a)):!1},canAccessPremiumFeatures:()=>{const t=e();return t.devMode||t.tier!=="free"}}),{name:"detectorapp-subscription",version:1}));Yi()(Ro(n=>({parkingLocation:null,showParkingButton:!0,setParkingLocation:e=>n({parkingLocation:e}),clearParkingLocation:()=>n({parkingLocation:null}),setShowParkingButton:e=>n({showParkingButton:e})}),{name:"detectorapp-parking"}));function L3(){return new Date().toISOString().split("T")[0]}Yi()(Ro((n,e)=>({steps:0,distance:0,startTime:null,isActive:!1,todaySteps:0,todayDate:L3(),stepLength:.75,incrementStep:()=>{const t=e(),r=L3(),i=t.todayDate===r?t.todaySteps+1:1;n({steps:t.steps+1,distance:(t.steps+1)*t.stepLength,todaySteps:i,todayDate:r})},resetSession:()=>{n({steps:0,distance:0,startTime:null})},setActive:t=>{n({isActive:t,startTime:t?Date.now():e().startTime})},setStepLength:t=>{const r=e();n({stepLength:t,distance:r.steps*t})}}),{name:"step-counter-storage",partialize:n=>({todaySteps:n.todaySteps,todayDate:n.todayDate,stepLength:n.stepLength})}));const O3={sunAzimuth:315,sunElevation:45,verticalExaggeration:2,colorRamp:"terrain",minElevation:-5,maxElevation:50,showControls:!1};Yi()(Ro(n=>({...O3,setSunAzimuth:e=>n({sunAzimuth:e}),setSunElevation:e=>n({sunElevation:e}),setVerticalExaggeration:e=>n({verticalExaggeration:e}),setColorRamp:e=>n({colorRamp:e}),setMinElevation:e=>n({minElevation:e}),setMaxElevation:e=>n({maxElevation:e}),setShowControls:e=>n({showControls:e}),resetToDefaults:()=>n(O3)}),{name:"detectorapp-hillshade"}));const aie=()=>Math.random().toString(36).substring(2,9),oie={0:"Helder",1:"Overwegend helder",2:"Halfbewolkt",3:"Bewolkt",45:"Mist",48:"Rijp/mist",51:"Lichte motregen",53:"Motregen",55:"Dichte motregen",56:"Lichte ijzel",57:"Ijzel",61:"Lichte regen",63:"Regen",65:"Hevige regen",66:"Lichte ijsregen",67:"IJsregen",71:"Lichte sneeuw",73:"Sneeuw",75:"Hevige sneeuw",77:"Korrelsneeuw",80:"Lichte buien",81:"Buien",82:"Hevige buien",85:"Lichte sneeuwbuien",86:"Sneeuwbuien",95:"Onweer",96:"Onweer met hagel",99:"Zwaar onweer met hagel"};function lie(n){const e=["N","NNO","NO","ONO","O","OZO","ZO","ZZO","Z","ZZW","ZW","WZW","W","WNW","NW","NNW"],t=Math.round(n/22.5)%16;return e[t]}const z9=Yi()(Ro((n,e)=>({weatherData:null,isLoading:!1,error:null,savedLocations:[{id:"current",name:"Huidige locatie",lat:0,lon:0,isCurrentLocation:!0}],selectedLocationId:"current",weatherPanelOpen:!1,showBuienradar:!1,setWeatherData:t=>n({weatherData:t}),setIsLoading:t=>n({isLoading:t}),setError:t=>n({error:t}),addLocation:t=>n(r=>({savedLocations:[...r.savedLocations,{...t,id:aie()}]})),removeLocation:t=>n(r=>({savedLocations:r.savedLocations.filter(i=>i.id!==t),selectedLocationId:r.selectedLocationId===t?"current":r.selectedLocationId})),setSelectedLocation:t=>n({selectedLocationId:t}),updateCurrentLocation:(t,r)=>n(i=>({savedLocations:i.savedLocations.map(s=>s.isCurrentLocation?{...s,lat:t,lon:r}:s)})),toggleWeatherPanel:()=>n(t=>({weatherPanelOpen:!t.weatherPanelOpen})),setWeatherPanelOpen:t=>n({weatherPanelOpen:t}),setShowBuienradar:t=>n({showBuienradar:t}),fetchWeather:async(t,r)=>{const{setIsLoading:i,setError:s,setWeatherData:a,savedLocations:o,selectedLocationId:l}=e();i(!0),s(null);try{const c=new URL("https://api.open-meteo.com/v1/forecast");c.searchParams.set("latitude",t.toString()),c.searchParams.set("longitude",r.toString()),c.searchParams.set("current","temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code,wind_speed_10m,wind_direction_10m,wind_gusts_10m,cloud_cover,is_day,snow_depth"),c.searchParams.set("hourly","temperature_2m,precipitation,precipitation_probability,weather_code,wind_speed_10m,wind_direction_10m,relative_humidity_2m"),c.searchParams.set("daily","weather_code,temperature_2m_max,temperature_2m_min,precipitation_sum,precipitation_probability_max,wind_speed_10m_max,sunrise,sunset"),c.searchParams.set("minutely_15","precipitation"),c.searchParams.set("timezone","Europe/Amsterdam"),c.searchParams.set("forecast_days","7"),c.searchParams.set("past_days","7");const h=await fetch(c.toString());if(!h.ok)throw new Error("Kon weerdata niet ophalen");const g=await h.json();let m=0;const x=g.daily.temperature_2m_min||[],y=new Date().toISOString().split("T")[0],_=g.daily.time.indexOf(y);for(let C=_-1;C>=0&&x[C]<0;C--)m++;const w=o.find(C=>C.id===l)||o[0],T=new Date,b=[],R=[];if(g.minutely_15?.time&&g.minutely_15?.precipitation){const C=new Date(T.getTime()+72e5),O=new Date(T.getTime()+2880*60*1e3);for(let P=0;P<g.minutely_15.time.length;P++){const z=new Date(g.minutely_15.time[P]);z<T||(z<=C&&b.push({time:g.minutely_15.time[P],precipitation:g.minutely_15.precipitation[P]}),z<=O&&R.push({time:g.minutely_15.time[P],precipitation:g.minutely_15.precipitation[P]}))}}const M=T.getHours(),D=T.toISOString().split("T")[0],B=g.hourly.time.map((C,O)=>({time:C,temperature:g.hourly.temperature_2m[O],precipitation:g.hourly.precipitation[O],precipitationProbability:g.hourly.precipitation_probability[O],weatherCode:g.hourly.weather_code[O],windSpeed:g.hourly.wind_speed_10m[O],windDirection:g.hourly.wind_direction_10m[O],humidity:g.hourly.relative_humidity_2m[O]})).filter(C=>new Date(C.time)>=T).slice(0,24),k=g.daily.time.map((C,O)=>({date:C,temperatureMax:g.daily.temperature_2m_max[O],temperatureMin:g.daily.temperature_2m_min[O],precipitationSum:g.daily.precipitation_sum[O],precipitationProbability:g.daily.precipitation_probability_max[O],weatherCode:g.daily.weather_code[O],windSpeedMax:g.daily.wind_speed_10m_max[O],sunrise:g.daily.sunrise[O],sunset:g.daily.sunset[O]})).filter(C=>C.date>=D),A={location:{...w,lat:t,lon:r},current:{temperature:g.current.temperature_2m,apparentTemperature:g.current.apparent_temperature,humidity:g.current.relative_humidity_2m,precipitation:g.current.precipitation,weatherCode:g.current.weather_code,windSpeed:g.current.wind_speed_10m,windDirection:g.current.wind_direction_10m,windGusts:g.current.wind_gusts_10m,cloudCover:g.current.cloud_cover,isDay:g.current.is_day===1,snowDepth:g.current.snow_depth},hourly:B,daily:k,precipitation15min:b,precipitation48h:R,frostDays:m,lastUpdated:Date.now()};try{const C=new URL("https://air-quality-api.open-meteo.com/v1/air-quality");C.searchParams.set("latitude",t.toString()),C.searchParams.set("longitude",r.toString()),C.searchParams.set("current","grass_pollen,birch_pollen,alder_pollen,mugwort_pollen,ragweed_pollen,olive_pollen");const O=await fetch(C.toString());if(O.ok){const P=await O.json();if(P.current){const z=F=>Math.min(5,Math.round(F/20));A.pollen={grass:z(P.current.grass_pollen||0),birch:z(P.current.birch_pollen||0),alder:z(P.current.alder_pollen||0),mugwort:z(P.current.mugwort_pollen||0),ragweed:z(P.current.ragweed_pollen||0),olive:z(P.current.olive_pollen||0)}}}}catch{}a(A)}catch(c){s(c instanceof Error?c.message:"Onbekende fout")}finally{i(!1)}}}),{name:"detectorapp-weather",partialize:n=>({savedLocations:n.savedLocations,selectedLocationId:n.selectedLocationId,showBuienradar:n.showBuienradar})}));function cie({target:n,viewOptions:e}){const t=H.useRef(null),r=H.useRef(null),i=pi(a=>a.setMap),s=yn(a=>a.showScaleBar);return H.useEffect(()=>{if(!t.current){const a={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},o=new Cq({target:n,controls:[],view:new Qo({center:kr(a.center),zoom:a.zoom,rotation:a.rotation,minZoom:a.minZoom,maxZoom:a.maxZoom})});t.current=o,i(o),window.__olMap=o}return()=>{t.current&&(t.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,e,i]),H.useEffect(()=>{const a=t.current;a&&(s?r.current||(r.current=new Mq({units:"metric",bar:!1,text:!0,minWidth:80}),a.addControl(r.current)):r.current&&(a.removeControl(r.current),r.current=null))},[s]),t.current}const D3=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function uie(){const n=H.useRef(null),e=H.useRef(!1);cie({target:"map"});const t=pi(g=>g.map),r=Ri(g=>g.registerLayer),i=Ri(g=>g.setLayerVisibility),s=yn(g=>g.defaultBackground);H.useEffect(()=>{if(!t){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const g=new Rh({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new qX}),m=new Rh({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new Kf({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),x=new Rh({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Kf({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),y=new Rh({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new Kf({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),_=new Rh({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new Kf({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),w=new Rh({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new Kf({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});t.addLayer(g),t.addLayer(m),t.addLayer(x),t.addLayer(y),t.addLayer(_),t.addLayer(w),console.log(" Base layers added:",{osm:g.getVisible(),cartodb:m.getVisible(),satellite:x.getVisible()}),r("OpenStreetMap",g),r("CartoDB (licht)",m),r("Luchtfoto",x),r("Labels Overlay",y),r("TMK 1850",_),r("Bonnebladen 1900",w),t.updateSize(),console.log(" Map size:",t.getSize()),console.log(" Map center:",t.getView().getCenter()),console.log(" Map zoom:",t.getView().getZoom()),a()},[t,r]);async function a(){if(!t){console.error(" Cannot load layers: map is null");return}const g=aY();console.log(` Loading ${g.length} immediate-load layers (WMS/Tile)...`);const m=await Promise.allSettled(g.map(async y=>{try{const _=await y.factory();return _?{name:y.name,layer:_}:null}catch(_){return console.warn(` Failed to create ${y.name}:`,_),null}}));let x=0;m.forEach(y=>{if(y.status==="fulfilled"&&y.value){const{name:_,layer:w}=y.value;t.addLayer(w),r(_,w),x++,console.log(`   ${_}`)}}),console.log(` Immediate layers loaded: ${x}/${g.length}`),console.log(` Total layers on map: ${t.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}H.useEffect(()=>{if(!t||e.current)return;const g=setTimeout(()=>{const m=s||"CartoDB (licht)";D3.forEach(x=>{i(x,!1)}),D3.includes(m)?i(m,!0):i("CartoDB (licht)",!0),e.current=!0,console.log(` Default background: ${m}`)},100);return()=>clearTimeout(g)},[t,s,i]);const o=yn(g=>g.gpsAutoStart),l=Wi(g=>g.startTracking),c=H.useRef(!1);H.useEffect(()=>{if(!(!t||c.current)&&o){const g=setTimeout(()=>{l(),c.current=!0,console.log(" GPS autostart enabled - tracking started")},500);return()=>clearTimeout(g)}},[t,o,l]);const h={width:"100%",height:"100vh"};return f.jsx("div",{id:"map",ref:n,style:h})}const lI=H.createContext({});function cI(n){const e=H.useRef(null);return e.current===null&&(e.current=n()),e.current}const kE=H.createContext(null),uI=H.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class hie extends H.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function die({children:n,isPresent:e}){const t=H.useId(),r=H.useRef(null),i=H.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=H.useContext(uI);return H.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:c}=i.current;if(e||!r.current||!a||!o)return;r.current.dataset.motionPopId=t;const h=document.createElement("style");return s&&(h.nonce=s),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),f.jsx(hie,{isPresent:e,childRef:r,sizeRef:i,children:H.cloneElement(n,{ref:r})})}const fie=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a})=>{const o=cI(gie),l=H.useId(),c=H.useCallback(g=>{o.set(g,!0);for(const m of o.values())if(!m)return;r&&r()},[o,r]),h=H.useMemo(()=>({id:l,initial:e,isPresent:t,custom:i,onExitComplete:c,register:g=>(o.set(g,!1),()=>o.delete(g))}),s?[Math.random(),c]:[t,c]);return H.useMemo(()=>{o.forEach((g,m)=>o.set(m,!1))},[t]),H.useEffect(()=>{!t&&!o.size&&r&&r()},[t]),a==="popLayout"&&(n=f.jsx(die,{isPresent:t,children:n})),f.jsx(kE.Provider,{value:h,children:n})};function gie(){return new Map}function U9(n=!0){const e=H.useContext(kE);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=H.useId();H.useEffect(()=>{n&&i(s)},[n]);const a=H.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,a]:[!0]}const zy=n=>n.key||"";function j3(n){const e=[];return H.Children.forEach(n,t=>{H.isValidElement(t)&&e.push(t)}),e}const hI=typeof window<"u",$9=hI?H.useLayoutEffect:H.useEffect,In=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1})=>{const[o,l]=U9(a),c=H.useMemo(()=>j3(n),[n]),h=a&&!o?[]:c.map(zy),g=H.useRef(!0),m=H.useRef(c),x=cI(()=>new Map),[y,_]=H.useState(c),[w,T]=H.useState(c);$9(()=>{g.current=!1,m.current=c;for(let M=0;M<w.length;M++){const D=zy(w[M]);h.includes(D)?x.delete(D):x.get(D)!==!0&&x.set(D,!1)}},[w,h.length,h.join("-")]);const b=[];if(c!==y){let M=[...c];for(let D=0;D<w.length;D++){const B=w[D],k=zy(B);h.includes(k)||(M.splice(D,0,B),b.push(B))}s==="wait"&&b.length&&(M=b),T(j3(M)),_(c);return}const{forceRender:R}=H.useContext(lI);return f.jsx(f.Fragment,{children:w.map(M=>{const D=zy(M),B=a&&!o?!1:c===w||h.includes(D),k=()=>{if(x.has(D))x.set(D,!0);else return;let A=!0;x.forEach(C=>{C||(A=!1)}),A&&(R?.(),T(m.current),a&&l?.(),r&&r())};return f.jsx(fie,{isPresent:B,initial:!g.current||t?void 0:!1,custom:B?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:B?void 0:k,children:M},D)})})},ga=n=>n;let W9=ga;function dI(n){let e;return()=>(e===void 0&&(e=n()),e)}const eg=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},Jl=n=>n*1e3,Ql=n=>n/1e3,mie={useManualTiming:!1};function pie(n){let e=new Set,t=new Set,r=!1,i=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(c){s.has(c)&&(l.schedule(c),n()),c(a)}const l={schedule:(c,h=!1,g=!1)=>{const x=g&&r?e:t;return h&&s.add(c),x.has(c)||x.add(c),c},cancel:c=>{t.delete(c),s.delete(c)},process:c=>{if(a=c,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(o),e.clear(),r=!1,i&&(i=!1,l.process(c))}};return l}const Uy=["read","resolveKeyframes","update","preRender","render","postRender"],xie=40;function H9(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,a=Uy.reduce((T,b)=>(T[b]=pie(s),T),{}),{read:o,resolveKeyframes:l,update:c,preRender:h,render:g,postRender:m}=a,x=()=>{const T=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(T-i.timestamp,xie),1),i.timestamp=T,i.isProcessing=!0,o.process(i),l.process(i),c.process(i),h.process(i),g.process(i),m.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(x))},y=()=>{t=!0,r=!0,i.isProcessing||n(x)};return{schedule:Uy.reduce((T,b)=>{const R=a[b];return T[b]=(M,D=!1,B=!1)=>(t||y(),R.schedule(M,D,B)),T},{}),cancel:T=>{for(let b=0;b<Uy.length;b++)a[Uy[b]].cancel(T)},state:i,steps:a}}const{schedule:gr,cancel:Fu,state:Gi,steps:ST}=H9(typeof requestAnimationFrame<"u"?requestAnimationFrame:ga,!0),K9=H.createContext({strict:!1}),F3={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},tg={};for(const n in F3)tg[n]={isEnabled:e=>F3[n].some(t=>!!e[t])};function yie(n){for(const e in n)tg[e]={...tg[e],...n[e]}}const _ie=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Lv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||_ie.has(n)}let X9=n=>!Lv(n);function vie(n){n&&(X9=e=>e.startsWith("on")?!Lv(e):n(e))}try{vie(require("@emotion/is-prop-valid").default)}catch{}function wie(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(X9(i)||t===!0&&Lv(i)||!e&&!Lv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function Eie(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const IE=H.createContext({});function Qp(n){return typeof n=="string"||Array.isArray(n)}function CE(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const fI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],gI=["initial",...fI];function PE(n){return CE(n.animate)||gI.some(e=>Qp(n[e]))}function q9(n){return!!(PE(n)||n.variants)}function Sie(n,e){if(PE(n)){const{initial:t,animate:r}=n;return{initial:t===!1||Qp(t)?t:void 0,animate:Qp(r)?r:void 0}}return n.inherit!==!1?e:{}}function Tie(n){const{initial:e,animate:t}=Sie(n,H.useContext(IE));return H.useMemo(()=>({initial:e,animate:t}),[V3(e),V3(t)])}function V3(n){return Array.isArray(n)?n.join(" "):n}const bie=Symbol.for("motionComponentSymbol");function s0(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function Rie(n,e,t){return H.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):s0(t)&&(t.current=r))},[e])}const mI=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Aie="framerAppearId",Y9="data-"+mI(Aie),{schedule:pI}=H9(queueMicrotask,!1),Z9=H.createContext({});function kie(n,e,t,r,i){var s,a;const{visualElement:o}=H.useContext(IE),l=H.useContext(K9),c=H.useContext(kE),h=H.useContext(uI).reducedMotion,g=H.useRef(null);r=r||l.renderer,!g.current&&r&&(g.current=r(n,{visualState:e,parent:o,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:h}));const m=g.current,x=H.useContext(Z9);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&Iie(g.current,t,i,x);const y=H.useRef(!1);H.useInsertionEffect(()=>{m&&y.current&&m.update(t,c)});const _=t[Y9],w=H.useRef(!!_&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,_))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,_)));return $9(()=>{m&&(y.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),pI.render(m.render),w.current&&m.animationState&&m.animationState.animateChanges())}),H.useEffect(()=>{m&&(!w.current&&m.animationState&&m.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var T;(T=window.MotionHandoffMarkAsComplete)===null||T===void 0||T.call(window,_)}),w.current=!1))}),m}function Iie(n,e,t,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:J9(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&s0(o),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:c})}function J9(n){if(n)return n.options.allowProjection!==!1?n.projection:J9(n.parent)}function Cie({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var s,a;n&&yie(n);function o(c,h){let g;const m={...H.useContext(uI),...c,layoutId:Pie(c)},{isStatic:x}=m,y=Tie(c),_=r(c,x);if(!x&&hI){Nie();const w=Mie(m);g=w.MeasureLayout,y.visualElement=kie(i,_,m,e,w.ProjectionNode)}return f.jsxs(IE.Provider,{value:y,children:[g&&y.visualElement?f.jsx(g,{visualElement:y.visualElement,...m}):null,t(i,c,Rie(_,y.visualElement,h),_,x,y.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${(a=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&a!==void 0?a:""})`}`;const l=H.forwardRef(o);return l[bie]=i,l}function Pie({layoutId:n}){const e=H.useContext(lI).id;return e&&n!==void 0?e+"-"+n:n}function Nie(n,e){H.useContext(K9).strict}function Mie(n){const{drag:e,layout:t}=tg;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const Lie=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function xI(n){return typeof n!="string"||n.includes("-")?!1:!!(Lie.indexOf(n)>-1||/[A-Z]/u.test(n))}function B3(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function yI(n,e,t,r){if(typeof e=="function"){const[i,s]=B3(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=B3(r);e=e(t!==void 0?t:n.custom,i,s)}return e}const _R=n=>Array.isArray(n),Oie=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),Die=n=>_R(n)?n[n.length-1]||0:n,hs=n=>!!(n&&n.getVelocity);function A_(n){const e=hs(n)?n.get():n;return Oie(e)?e.toValue():e}function jie({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,s){const a={latestValues:Fie(r,i,s,n),renderState:e()};return t&&(a.onMount=o=>t({props:r,current:o,...a}),a.onUpdate=o=>t(o)),a}const Q9=n=>(e,t)=>{const r=H.useContext(IE),i=H.useContext(kE),s=()=>jie(n,e,r,i);return t?s():cI(s)};function Fie(n,e,t,r){const i={},s=r(n,{});for(const m in s)i[m]=A_(s[m]);let{initial:a,animate:o}=n;const l=PE(n),c=q9(n);e&&c&&!l&&n.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let h=t?t.initial===!1:!1;h=h||a===!1;const g=h?o:a;if(g&&typeof g!="boolean"&&!CE(g)){const m=Array.isArray(g)?g:[g];for(let x=0;x<m.length;x++){const y=yI(n,m[x]);if(y){const{transitionEnd:_,transition:w,...T}=y;for(const b in T){let R=T[b];if(Array.isArray(R)){const M=h?R.length-1:0;R=R[M]}R!==null&&(i[b]=R)}for(const b in _)i[b]=_[b]}}}return i}const xg=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Fd=new Set(xg),e7=n=>e=>typeof e=="string"&&e.startsWith(n),t7=e7("--"),Vie=e7("var(--"),_I=n=>Vie(n)?Bie.test(n.split("/*")[0].trim()):!1,Bie=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,n7=(n,e)=>e&&typeof n=="number"?e.transform(n):n,cc=(n,e,t)=>t>e?e:t<n?n:t,yg={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},e1={...yg,transform:n=>cc(0,1,n)},$y={...yg,default:1},J1=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),nu=J1("deg"),cl=J1("%"),$t=J1("px"),Gie=J1("vh"),zie=J1("vw"),G3={...cl,parse:n=>cl.parse(n)/100,transform:n=>cl.transform(n*100)},Uie={borderWidth:$t,borderTopWidth:$t,borderRightWidth:$t,borderBottomWidth:$t,borderLeftWidth:$t,borderRadius:$t,radius:$t,borderTopLeftRadius:$t,borderTopRightRadius:$t,borderBottomRightRadius:$t,borderBottomLeftRadius:$t,width:$t,maxWidth:$t,height:$t,maxHeight:$t,top:$t,right:$t,bottom:$t,left:$t,padding:$t,paddingTop:$t,paddingRight:$t,paddingBottom:$t,paddingLeft:$t,margin:$t,marginTop:$t,marginRight:$t,marginBottom:$t,marginLeft:$t,backgroundPositionX:$t,backgroundPositionY:$t},$ie={rotate:nu,rotateX:nu,rotateY:nu,rotateZ:nu,scale:$y,scaleX:$y,scaleY:$y,scaleZ:$y,skew:nu,skewX:nu,skewY:nu,distance:$t,translateX:$t,translateY:$t,translateZ:$t,x:$t,y:$t,z:$t,perspective:$t,transformPerspective:$t,opacity:e1,originX:G3,originY:G3,originZ:$t},z3={...yg,transform:Math.round},vI={...Uie,...$ie,zIndex:z3,size:$t,fillOpacity:e1,strokeOpacity:e1,numOctaves:z3},Wie={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Hie=xg.length;function Kie(n,e,t){let r="",i=!0;for(let s=0;s<Hie;s++){const a=xg[s],o=n[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||t){const c=n7(o,vI[a]);if(!l){i=!1;const h=Wie[a]||a;r+=`${h}(${c}) `}t&&(e[a]=c)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function wI(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let a=!1,o=!1;for(const l in e){const c=e[l];if(Fd.has(l)){a=!0;continue}else if(t7(l)){i[l]=c;continue}else{const h=n7(c,vI[l]);l.startsWith("origin")?(o=!0,s[l]=h):r[l]=h}}if(e.transform||(a||t?r.transform=Kie(e,n.transform,t):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:h=0}=s;r.transformOrigin=`${l} ${c} ${h}`}}const Xie={offset:"stroke-dashoffset",array:"stroke-dasharray"},qie={offset:"strokeDashoffset",array:"strokeDasharray"};function Yie(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?Xie:qie;n[s.offset]=$t.transform(-r);const a=$t.transform(e),o=$t.transform(t);n[s.array]=`${a} ${o}`}function U3(n,e,t){return typeof n=="string"?n:$t.transform(e+t*n)}function Zie(n,e,t){const r=U3(e,n.x,n.width),i=U3(t,n.y,n.height);return`${r} ${i}`}function EI(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...c},h,g){if(wI(n,c,g),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:x,dimensions:y}=n;m.transform&&(y&&(x.transform=m.transform),delete m.transform),y&&(i!==void 0||s!==void 0||x.transform)&&(x.transformOrigin=Zie(y,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),r!==void 0&&(m.scale=r),a!==void 0&&Yie(m,a,o,l,!1)}const SI=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),r7=()=>({...SI(),attrs:{}}),TI=n=>typeof n=="string"&&n.toLowerCase()==="svg";function i7(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const s in t)n.style.setProperty(s,t[s])}const s7=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function a7(n,e,t,r){i7(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(s7.has(i)?i:mI(i),e.attrs[i])}const Ov={};function Jie(n){Object.assign(Ov,n)}function o7(n,{layout:e,layoutId:t}){return Fd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Ov[n]||n==="opacity")}function bI(n,e,t){var r;const{style:i}=n,s={};for(const a in i)(hs(i[a])||e.style&&hs(e.style[a])||o7(a,n)||((r=t?.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function l7(n,e,t){const r=bI(n,e,t);for(const i in n)if(hs(n[i])||hs(e[i])){const s=xg.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}function Qie(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const $3=["x","y","width","height","cx","cy","r"],ese={useVisualState:Q9({scrapeMotionValuesFromProps:l7,createRenderState:r7,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let s=!!n.drag;if(!s){for(const o in i)if(Fd.has(o)){s=!0;break}}if(!s)return;let a=!e;if(e)for(let o=0;o<$3.length;o++){const l=$3[o];n[l]!==e[l]&&(a=!0)}a&&gr.read(()=>{Qie(t,r),gr.render(()=>{EI(r,i,TI(t.tagName),n.transformTemplate),a7(t,r)})})}})},tse={useVisualState:Q9({scrapeMotionValuesFromProps:bI,createRenderState:SI})};function c7(n,e,t){for(const r in e)!hs(e[r])&&!o7(r,t)&&(n[r]=e[r])}function nse({transformTemplate:n},e){return H.useMemo(()=>{const t=SI();return wI(t,e,n),Object.assign({},t.vars,t.style)},[e])}function rse(n,e){const t=n.style||{},r={};return c7(r,t,n),Object.assign(r,nse(n,e)),r}function ise(n,e){const t={},r=rse(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function sse(n,e,t,r){const i=H.useMemo(()=>{const s=r7();return EI(s,e,TI(r),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};c7(s,n.style,n),i.style={...s,...i.style}}return i}function ase(n=!1){return(t,r,i,{latestValues:s},a)=>{const l=(xI(t)?sse:ise)(r,s,a,t),c=wie(r,typeof t=="string",n),h=t!==H.Fragment?{...c,...l,ref:i}:{},{children:g}=r,m=H.useMemo(()=>hs(g)?g.get():g,[g]);return H.createElement(t,{...h,children:m})}}function ose(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...xI(r)?ese:tse,preloadedFeatures:n,useRender:ase(i),createVisualElement:e,Component:r};return Cie(a)}}function u7(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function NE(n,e,t){const r=n.getProps();return yI(r,e,t!==void 0?t:r.custom,n)}const lse=dI(()=>window.ScrollTimeline!==void 0);class cse{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(lse()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class use extends cse{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function RI(n,e){return n?n[e]||n.default||n:void 0}const vR=2e4;function h7(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<vR;)e+=t,r=n.next(e);return e>=vR?1/0:e}function AI(n){return typeof n=="function"}function W3(n,e){n.timeline=e,n.onfinish=null}const kI=n=>Array.isArray(n)&&typeof n[0]=="number",hse={linearEasing:void 0};function dse(n,e){const t=dI(n);return()=>{var r;return(r=hse[e])!==null&&r!==void 0?r:t()}}const Dv=dse(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),d7=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=n(eg(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function f7(n){return!!(typeof n=="function"&&Dv()||!n||typeof n=="string"&&(n in wR||Dv())||kI(n)||Array.isArray(n)&&n.every(f7))}const Mm=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,wR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Mm([0,.65,.55,1]),circOut:Mm([.55,0,1,.45]),backIn:Mm([.31,.01,.66,-.59]),backOut:Mm([.33,1.53,.69,.99])};function g7(n,e){if(n)return typeof n=="function"&&Dv()?d7(n,e):kI(n)?Mm(n):Array.isArray(n)?n.map(t=>g7(t,e)||wR.easeOut):wR[n]}const oo={x:!1,y:!1};function m7(){return oo.x||oo.y}function fse(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function p7(n,e){const t=fse(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function H3(n){return e=>{e.pointerType==="touch"||m7()||n(e)}}function gse(n,e,t={}){const[r,i,s]=p7(n,t),a=H3(o=>{const{target:l}=o,c=e(o);if(typeof c!="function"||!l)return;const h=H3(g=>{c(g),l.removeEventListener("pointerleave",h)});l.addEventListener("pointerleave",h,i)});return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const x7=(n,e)=>e?n===e?!0:x7(n,e.parentElement):!1,II=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,mse=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function pse(n){return mse.has(n.tagName)||n.tabIndex!==-1}const Lm=new WeakSet;function K3(n){return e=>{e.key==="Enter"&&n(e)}}function TT(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const xse=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=K3(()=>{if(Lm.has(t))return;TT(t,"down");const i=K3(()=>{TT(t,"up")}),s=()=>TT(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function X3(n){return II(n)&&!m7()}function yse(n,e,t={}){const[r,i,s]=p7(n,t),a=o=>{const l=o.currentTarget;if(!X3(o)||Lm.has(l))return;Lm.add(l);const c=e(o),h=(x,y)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",m),!(!X3(x)||!Lm.has(l))&&(Lm.delete(l),typeof c=="function"&&c(x,{success:y}))},g=x=>{h(x,t.useGlobalTarget||x7(l,x.target))},m=x=>{h(x,!1)};window.addEventListener("pointerup",g,i),window.addEventListener("pointercancel",m,i)};return r.forEach(o=>{!pse(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(t.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o.addEventListener("focus",c=>xse(c,i),i)}),s}function _se(n){return n==="x"||n==="y"?oo[n]?null:(oo[n]=!0,()=>{oo[n]=!1}):oo.x||oo.y?null:(oo.x=oo.y=!0,()=>{oo.x=oo.y=!1})}const y7=new Set(["width","height","top","left","right","bottom",...xg]);let k_;function vse(){k_=void 0}const ul={now:()=>(k_===void 0&&ul.set(Gi.isProcessing||mie.useManualTiming?Gi.timestamp:performance.now()),k_),set:n=>{k_=n,queueMicrotask(vse)}};function CI(n,e){n.indexOf(e)===-1&&n.push(e)}function PI(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class NI{constructor(){this.subscriptions=[]}add(e){return CI(this.subscriptions,e),()=>PI(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function _7(n,e){return e?n*(1e3/e):0}const q3=30,wse=n=>!isNaN(parseFloat(n));class Ese{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=ul.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ul.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=wse(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new NI);const r=this.events[e].add(t);return e==="change"?()=>{r(),gr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ul.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>q3)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,q3);return _7(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function t1(n,e){return new Ese(n,e)}function Sse(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,t1(t))}function Tse(n,e){const t=NE(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const a in s){const o=Die(s[a]);Sse(n,a,o)}}function bse(n){return!!(hs(n)&&n.add)}function ER(n,e){const t=n.getValue("willChange");if(bse(t))return t.add(e)}function v7(n){return n.props[Y9]}const w7=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,Rse=1e-7,Ase=12;function kse(n,e,t,r,i){let s,a,o=0;do a=e+(t-e)/2,s=w7(a,r,i)-n,s>0?t=a:e=a;while(Math.abs(s)>Rse&&++o<Ase);return a}function Q1(n,e,t,r){if(n===e&&t===r)return ga;const i=s=>kse(s,0,1,n,t);return s=>s===0||s===1?s:w7(i(s),e,r)}const E7=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,S7=n=>e=>1-n(1-e),T7=Q1(.33,1.53,.69,.99),MI=S7(T7),b7=E7(MI),R7=n=>(n*=2)<1?.5*MI(n):.5*(2-Math.pow(2,-10*(n-1))),LI=n=>1-Math.sin(Math.acos(n)),A7=S7(LI),k7=E7(LI),I7=n=>/^0[^.\s]+$/u.test(n);function Ise(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||I7(n):!0}const ep=n=>Math.round(n*1e5)/1e5,OI=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Cse(n){return n==null}const Pse=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,DI=(n,e)=>t=>!!(typeof t=="string"&&Pse.test(t)&&t.startsWith(n)||e&&!Cse(t)&&Object.prototype.hasOwnProperty.call(t,e)),C7=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(OI);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Nse=n=>cc(0,255,n),bT={...yg,transform:n=>Math.round(Nse(n))},Kh={test:DI("rgb","red"),parse:C7("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+bT.transform(n)+", "+bT.transform(e)+", "+bT.transform(t)+", "+ep(e1.transform(r))+")"};function Mse(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const SR={test:DI("#"),parse:Mse,transform:Kh.transform},a0={test:DI("hsl","hue"),parse:C7("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+cl.transform(ep(e))+", "+cl.transform(ep(t))+", "+ep(e1.transform(r))+")"},as={test:n=>Kh.test(n)||SR.test(n)||a0.test(n),parse:n=>Kh.test(n)?Kh.parse(n):a0.test(n)?a0.parse(n):SR.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Kh.transform(n):a0.transform(n)},Lse=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Ose(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(OI))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(Lse))===null||t===void 0?void 0:t.length)||0)>0}const P7="number",N7="color",Dse="var",jse="var(",Y3="${}",Fse=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function n1(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=e.replace(Fse,l=>(as.test(l)?(r.color.push(s),i.push(N7),t.push(as.parse(l))):l.startsWith(jse)?(r.var.push(s),i.push(Dse),t.push(l)):(r.number.push(s),i.push(P7),t.push(parseFloat(l))),++s,Y3)).split(Y3);return{values:t,split:o,indexes:r,types:i}}function M7(n){return n1(n).values}function L7(n){const{split:e,types:t}=n1(n),r=e.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=e[a],i[a]!==void 0){const o=t[a];o===P7?s+=ep(i[a]):o===N7?s+=as.transform(i[a]):s+=i[a]}return s}}const Vse=n=>typeof n=="number"?0:n;function Bse(n){const e=M7(n);return L7(n)(e.map(Vse))}const Vu={test:Ose,parse:M7,createTransformer:L7,getAnimatableNone:Bse},Gse=new Set(["brightness","contrast","saturate","opacity"]);function zse(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(OI)||[];if(!r)return n;const i=t.replace(r,"");let s=Gse.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const Use=/\b([a-z-]*)\(.*?\)/gu,TR={...Vu,getAnimatableNone:n=>{const e=n.match(Use);return e?e.map(zse).join(" "):n}},$se={...vI,color:as,backgroundColor:as,outlineColor:as,fill:as,stroke:as,borderColor:as,borderTopColor:as,borderRightColor:as,borderBottomColor:as,borderLeftColor:as,filter:TR,WebkitFilter:TR},jI=n=>$se[n];function O7(n,e){let t=jI(n);return t!==TR&&(t=Vu),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Wse=new Set(["auto","none","0"]);function Hse(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!Wse.has(s)&&n1(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=O7(t,i)}const Z3=n=>n===yg||n===$t,J3=(n,e)=>parseFloat(n.split(", ")[e]),Q3=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return J3(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?J3(s[1],n):0}},Kse=new Set(["x","y","z"]),Xse=xg.filter(n=>!Kse.has(n));function qse(n){const e=[];return Xse.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const ng={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:Q3(4,13),y:Q3(5,14)};ng.translateX=ng.x;ng.translateY=ng.y;const nd=new Set;let bR=!1,RR=!1;function D7(){if(RR){const n=Array.from(nd).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=qse(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))===null||o===void 0||o.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}RR=!1,bR=!1,nd.forEach(n=>n.complete()),nd.clear()}function j7(){nd.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(RR=!0)})}function Yse(){j7(),D7()}class FI{constructor(e,t,r,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(nd.add(this),bR||(bR=!0,gr.read(j7),gr.resolveKeyframes(D7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const l=r.readValue(t,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),nd.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,nd.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const F7=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),Zse=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Jse(n){const e=Zse.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function V7(n,e,t=1){const[r,i]=Jse(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const a=s.trim();return F7(a)?parseFloat(a):a}return _I(i)?V7(i,e,t+1):i}const B7=n=>e=>e.test(n),Qse={test:n=>n==="auto",parse:n=>n},G7=[yg,$t,cl,nu,zie,Gie,Qse],e5=n=>G7.find(B7(n));class z7 extends FI{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),_I(c))){const h=V7(c,t.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!y7.has(r)||e.length!==2)return;const[i,s]=e,a=e5(i),o=e5(s);if(a!==o)if(Z3(a)&&Z3(o))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)Ise(e[i])&&r.push(i);r.length&&Hse(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ng[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=ng[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const t5=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Vu.test(n)||n==="0")&&!n.startsWith("url("));function eae(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function tae(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],a=t5(i,e),o=t5(s,e);return!a||!o?!1:eae(n)||(t==="spring"||AI(t))&&r}const nae=n=>n!==null;function ME(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(nae),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const rae=40;class U7{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ul.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>rae?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Yse(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=ul.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:a,onComplete:o,onUpdate:l,isGenerator:c}=this.options;if(!c&&!tae(e,r,i,s))if(a)this.options.duration=0;else{l&&l(ME(e,this.options,t)),o&&o(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Nr=(n,e,t)=>n+(e-n)*t;function RT(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function iae({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,a=0;if(!e)i=s=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;i=RT(l,o,n+1/3),s=RT(l,o,n),a=RT(l,o,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function jv(n,e){return t=>t>0?e:n}const AT=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},sae=[SR,Kh,a0],aae=n=>sae.find(e=>e.test(n));function n5(n){const e=aae(n);if(!e)return!1;let t=e.parse(n);return e===a0&&(t=iae(t)),t}const r5=(n,e)=>{const t=n5(n),r=n5(e);if(!t||!r)return jv(n,e);const i={...t};return s=>(i.red=AT(t.red,r.red,s),i.green=AT(t.green,r.green,s),i.blue=AT(t.blue,r.blue,s),i.alpha=Nr(t.alpha,r.alpha,s),Kh.transform(i))},oae=(n,e)=>t=>e(n(t)),ex=(...n)=>n.reduce(oae),AR=new Set(["none","hidden"]);function lae(n,e){return AR.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function cae(n,e){return t=>Nr(n,e,t)}function VI(n){return typeof n=="number"?cae:typeof n=="string"?_I(n)?jv:as.test(n)?r5:dae:Array.isArray(n)?$7:typeof n=="object"?as.test(n)?r5:uae:jv}function $7(n,e){const t=[...n],r=t.length,i=n.map((s,a)=>VI(s)(s,e[a]));return s=>{for(let a=0;a<r;a++)t[a]=i[a](s);return t}}function uae(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=VI(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function hae(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],o=n.indexes[a][i[a]],l=(t=n.values[o])!==null&&t!==void 0?t:0;r[s]=l,i[a]++}return r}const dae=(n,e)=>{const t=Vu.createTransformer(e),r=n1(n),i=n1(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?AR.has(n)&&!i.values.length||AR.has(e)&&!r.values.length?lae(n,e):ex($7(hae(r,i),i.values),t):jv(n,e)};function W7(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Nr(n,e,t):VI(n)(n,e)}const fae=5;function H7(n,e,t){const r=Math.max(e-fae,0);return _7(t-n(r),e-r)}const jr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},kT=.001;function gae({duration:n=jr.duration,bounce:e=jr.bounce,velocity:t=jr.velocity,mass:r=jr.mass}){let i,s,a=1-e;a=cc(jr.minDamping,jr.maxDamping,a),n=cc(jr.minDuration,jr.maxDuration,Ql(n)),a<1?(i=c=>{const h=c*a,g=h*n,m=h-t,x=kR(c,a),y=Math.exp(-g);return kT-m/x*y},s=c=>{const g=c*a*n,m=g*t+t,x=Math.pow(a,2)*Math.pow(c,2)*n,y=Math.exp(-g),_=kR(Math.pow(c,2),a);return(-i(c)+kT>0?-1:1)*((m-x)*y)/_}):(i=c=>{const h=Math.exp(-c*n),g=(c-t)*n+1;return-kT+h*g},s=c=>{const h=Math.exp(-c*n),g=(t-c)*(n*n);return h*g});const o=5/n,l=pae(i,s,o);if(n=Jl(n),isNaN(l))return{stiffness:jr.stiffness,damping:jr.damping,duration:n};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:n}}}const mae=12;function pae(n,e,t){let r=t;for(let i=1;i<mae;i++)r=r-n(r)/e(r);return r}function kR(n,e){return n*Math.sqrt(1-e*e)}const xae=["duration","bounce"],yae=["stiffness","damping","mass"];function i5(n,e){return e.some(t=>n[t]!==void 0)}function _ae(n){let e={velocity:jr.velocity,stiffness:jr.stiffness,damping:jr.damping,mass:jr.mass,isResolvedFromDuration:!1,...n};if(!i5(n,yae)&&i5(n,xae))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*cc(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:jr.mass,stiffness:i,damping:s}}else{const t=gae(n);e={...e,...t,mass:jr.mass},e.isResolvedFromDuration=!0}return e}function K7(n=jr.visualDuration,e=jr.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:h,duration:g,velocity:m,isResolvedFromDuration:x}=_ae({...t,velocity:-Ql(t.velocity||0)}),y=m||0,_=c/(2*Math.sqrt(l*h)),w=a-s,T=Ql(Math.sqrt(l/h)),b=Math.abs(w)<5;r||(r=b?jr.restSpeed.granular:jr.restSpeed.default),i||(i=b?jr.restDelta.granular:jr.restDelta.default);let R;if(_<1){const D=kR(T,_);R=B=>{const k=Math.exp(-_*T*B);return a-k*((y+_*T*w)/D*Math.sin(D*B)+w*Math.cos(D*B))}}else if(_===1)R=D=>a-Math.exp(-T*D)*(w+(y+T*w)*D);else{const D=T*Math.sqrt(_*_-1);R=B=>{const k=Math.exp(-_*T*B),A=Math.min(D*B,300);return a-k*((y+_*T*w)*Math.sinh(A)+D*w*Math.cosh(A))/D}}const M={calculatedDuration:x&&g||null,next:D=>{const B=R(D);if(x)o.done=D>=g;else{let k=0;_<1&&(k=D===0?Jl(y):H7(R,D,B));const A=Math.abs(k)<=r,C=Math.abs(a-B)<=i;o.done=A&&C}return o.value=o.done?a:B,o},toString:()=>{const D=Math.min(h7(M),vR),B=d7(k=>M.next(D*k).value,D,30);return D+"ms "+B}};return M}function s5({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:h}){const g=n[0],m={done:!1,value:g},x=A=>o!==void 0&&A<o||l!==void 0&&A>l,y=A=>o===void 0?l:l===void 0||Math.abs(o-A)<Math.abs(l-A)?o:l;let _=t*e;const w=g+_,T=a===void 0?w:a(w);T!==w&&(_=T-g);const b=A=>-_*Math.exp(-A/r),R=A=>T+b(A),M=A=>{const C=b(A),O=R(A);m.done=Math.abs(C)<=c,m.value=m.done?T:O};let D,B;const k=A=>{x(m.value)&&(D=A,B=K7({keyframes:[m.value,y(m.value)],velocity:H7(R,A,m.value),damping:i,stiffness:s,restDelta:c,restSpeed:h}))};return k(0),{calculatedDuration:null,next:A=>{let C=!1;return!B&&D===void 0&&(C=!0,M(A),k(A)),D!==void 0&&A>=D?B.next(A-D):(!C&&M(A),m)}}}const vae=Q1(.42,0,1,1),wae=Q1(0,0,.58,1),X7=Q1(.42,0,.58,1),Eae=n=>Array.isArray(n)&&typeof n[0]!="number",Sae={linear:ga,easeIn:vae,easeInOut:X7,easeOut:wae,circIn:LI,circInOut:k7,circOut:A7,backIn:MI,backInOut:b7,backOut:T7,anticipate:R7},a5=n=>{if(kI(n)){W9(n.length===4);const[e,t,r,i]=n;return Q1(e,t,r,i)}else if(typeof n=="string")return Sae[n];return n};function Tae(n,e,t){const r=[],i=t||W7,s=n.length-1;for(let a=0;a<s;a++){let o=i(n[a],n[a+1]);if(e){const l=Array.isArray(e)?e[a]||ga:e;o=ex(l,o)}r.push(o)}return r}function bae(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(W9(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=Tae(e,r,i),l=o.length,c=h=>{if(a&&h<n[0])return e[0];let g=0;if(l>1)for(;g<n.length-2&&!(h<n[g+1]);g++);const m=eg(n[g],n[g+1],h);return o[g](m)};return t?h=>c(cc(n[0],n[s-1],h)):c}function Rae(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=eg(0,e,r);n.push(Nr(t,1,i))}}function Aae(n){const e=[0];return Rae(e,n.length-1),e}function kae(n,e){return n.map(t=>t*e)}function Iae(n,e){return n.map(()=>e||X7).splice(0,n.length-1)}function Fv({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=Eae(r)?r.map(a5):a5(r),s={done:!1,value:e[0]},a=kae(t&&t.length===e.length?t:Aae(e),n),o=bae(a,e,{ease:Array.isArray(i)?i:Iae(e,i)});return{calculatedDuration:n,next:l=>(s.value=o(l),s.done=l>=n,s)}}const Cae=n=>{const e=({timestamp:t})=>n(t);return{start:()=>gr.update(e,!0),stop:()=>Fu(e),now:()=>Gi.isProcessing?Gi.timestamp:ul.now()}},Pae={decay:s5,inertia:s5,tween:Fv,keyframes:Fv,spring:K7},Nae=n=>n/100;class BI extends U7{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:t,motionValue:r,element:i,keyframes:s}=this.options,a=i?.KeyframeResolver||FI,o=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new a(s,o,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=this.options,o=AI(t)?t:Pae[t]||Fv;let l,c;o!==Fv&&typeof e[0]!="number"&&(l=ex(Nae,W7(e[0],e[1])),e=[0,100]);const h=o({...this.options,keyframes:e});s==="mirror"&&(c=o({...this.options,keyframes:[...e].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=h7(h));const{calculatedDuration:g}=h,m=g+i,x=m*(r+1)-i;return{generator:h,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:g,resolvedDuration:m,totalDuration:x}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:A}=this.options;return{done:!0,value:A[A.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:c,totalDuration:h,resolvedDuration:g}=r;if(this.startTime===null)return s.next(0);const{delay:m,repeat:x,repeatType:y,repeatDelay:_,onUpdate:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const T=this.currentTime-m*(this.speed>=0?1:-1),b=this.speed>=0?T<0:T>h;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let R=this.currentTime,M=s;if(x){const A=Math.min(this.currentTime,h)/g;let C=Math.floor(A),O=A%1;!O&&A>=1&&(O=1),O===1&&C--,C=Math.min(C,x+1),C%2&&(y==="reverse"?(O=1-O,_&&(O-=_/g)):y==="mirror"&&(M=a)),R=cc(0,1,O)*g}const D=b?{done:!1,value:l[0]}:M.next(R);o&&(D.value=o(D.value));let{done:B}=D;!b&&c!==null&&(B=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&B);return k&&i!==void 0&&(D.value=ME(l,this.options,i)),w&&w(D.value),k&&this.finish(),D}get duration(){const{resolved:e}=this;return e?Ql(e.calculatedDuration):0}get time(){return Ql(this.currentTime)}set time(e){e=Jl(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Ql(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Cae,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Mae=new Set(["opacity","clipPath","filter","transform"]);function Lae(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeInOut",times:l}={}){const c={[e]:t};l&&(c.offset=l);const h=g7(o,i);return Array.isArray(h)&&(c.easing=h),n.animate(c,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}const Oae=dI(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Vv=10,Dae=2e4;function jae(n){return AI(n.type)||n.type==="spring"||!f7(n.ease)}function Fae(n,e){const t=new BI({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let s=0;for(;!r.done&&s<Dae;)r=t.sample(s),i.push(r.value),s+=Vv;return{times:void 0,keyframes:i,duration:s-Vv,ease:"linear"}}const q7={anticipate:R7,backInOut:b7,circInOut:k7};function Vae(n){return n in q7}class o5 extends U7{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new z7(s,(a,o)=>this.onKeyframesResolved(a,o),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:s,type:a,motionValue:o,name:l,startTime:c}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof s=="string"&&Dv()&&Vae(s)&&(s=q7[s]),jae(this.options)){const{onComplete:g,onUpdate:m,motionValue:x,element:y,..._}=this.options,w=Fae(e,_);e=w.keyframes,e.length===1&&(e[1]=e[0]),r=w.duration,i=w.times,s=w.ease,a="keyframes"}const h=Lae(o.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return h.startTime=c??this.calcStartTime(),this.pendingTimeline?(W3(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:g}=this.options;o.set(ME(e,this.options,t)),g&&g(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:a,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Ql(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Ql(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=Jl(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return ga;const{animation:r}=t;W3(r,e)}return ga}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:s,ease:a,times:o}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:h,onComplete:g,element:m,...x}=this.options,y=new BI({...x,keyframes:r,duration:i,type:s,ease:a,times:o,isGenerator:!0}),_=Jl(this.time);c.setWithVelocity(y.sample(_-Vv).value,y.sample(_).value,Vv)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:s,damping:a,type:o}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=t.owner.getProps();return Oae()&&r&&Mae.has(r)&&!l&&!c&&!i&&s!=="mirror"&&a!==0&&o!=="inertia"}}const Bae={type:"spring",stiffness:500,damping:25,restSpeed:10},Gae=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),zae={type:"keyframes",duration:.8},Uae={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},$ae=(n,{keyframes:e})=>e.length>2?zae:Fd.has(n)?n.startsWith("scale")?Gae(e[1]):Bae:Uae;function Wae({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:c,...h}){return!!Object.keys(h).length}const GI=(n,e,t,r={},i,s)=>a=>{const o=RI(r,n)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Jl(l);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-c,onUpdate:m=>{e.set(m),o.onUpdate&&o.onUpdate(m)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:n,motionValue:e,element:s?void 0:i};Wae(o)||(h={...h,...$ae(n,h)}),h.duration&&(h.duration=Jl(h.duration)),h.repeatDelay&&(h.repeatDelay=Jl(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let g=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(g=!0)),g&&!s&&e.get()!==void 0){const m=ME(h.keyframes,o);if(m!==void 0)return gr.update(()=>{h.onUpdate(m),h.onComplete()}),new use([])}return!s&&o5.supports(h)?new o5(h):new BI(h)};function Hae({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function Y7(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var s;let{transition:a=n.getDefaultTransition(),transitionEnd:o,...l}=e;r&&(a=r);const c=[],h=i&&n.animationState&&n.animationState.getState()[i];for(const g in l){const m=n.getValue(g,(s=n.latestValues[g])!==null&&s!==void 0?s:null),x=l[g];if(x===void 0||h&&Hae(h,g))continue;const y={delay:t,...RI(a||{},g)};let _=!1;if(window.MotionHandoffAnimation){const T=v7(n);if(T){const b=window.MotionHandoffAnimation(T,g,gr);b!==null&&(y.startTime=b,_=!0)}}ER(n,g),m.start(GI(g,m,x,n.shouldReduceMotion&&y7.has(g)?{type:!1}:y,n,_));const w=m.animation;w&&c.push(w)}return o&&Promise.all(c).then(()=>{gr.update(()=>{o&&Tse(n,o)})}),c}function IR(n,e,t={}){var r;const i=NE(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(s=t.transitionOverride);const a=i?()=>Promise.all(Y7(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(c=0)=>{const{delayChildren:h=0,staggerChildren:g,staggerDirection:m}=s;return Kae(n,e,h+c,g,m,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,h]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>h())}else return Promise.all([a(),o(t.delay)])}function Kae(n,e,t=0,r=0,i=1,s){const a=[],o=(n.variantChildren.size-1)*r,l=i===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(n.variantChildren).sort(Xae).forEach((c,h)=>{c.notify("AnimationStart",e),a.push(IR(c,e,{...s,delay:t+l(h)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(a)}function Xae(n,e){return n.sortNodePosition(e)}function qae(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>IR(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=IR(n,e,t);else{const i=typeof e=="function"?NE(n,e,t.custom):e;r=Promise.all(Y7(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const Yae=gI.length;function Z7(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?Z7(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<Yae;t++){const r=gI[t],i=n.props[r];(Qp(i)||i===!1)&&(e[r]=i)}return e}const Zae=[...fI].reverse(),Jae=fI.length;function Qae(n){return e=>Promise.all(e.map(({animation:t,options:r})=>qae(n,t,r)))}function eoe(n){let e=Qae(n),t=l5(),r=!0;const i=l=>(c,h)=>{var g;const m=NE(n,h,l==="exit"?(g=n.presenceContext)===null||g===void 0?void 0:g.custom:void 0);if(m){const{transition:x,transitionEnd:y,..._}=m;c={...c,..._,...y}}return c};function s(l){e=l(n)}function a(l){const{props:c}=n,h=Z7(n.parent)||{},g=[],m=new Set;let x={},y=1/0;for(let w=0;w<Jae;w++){const T=Zae[w],b=t[T],R=c[T]!==void 0?c[T]:h[T],M=Qp(R),D=T===l?b.isActive:null;D===!1&&(y=w);let B=R===h[T]&&R!==c[T]&&M;if(B&&r&&n.manuallyAnimateOnMount&&(B=!1),b.protectedKeys={...x},!b.isActive&&D===null||!R&&!b.prevProp||CE(R)||typeof R=="boolean")continue;const k=toe(b.prevProp,R);let A=k||T===l&&b.isActive&&!B&&M||w>y&&M,C=!1;const O=Array.isArray(R)?R:[R];let P=O.reduce(i(T),{});D===!1&&(P={});const{prevResolvedValues:z={}}=b,F={...z,...P},xe=Ne=>{A=!0,m.has(Ne)&&(C=!0,m.delete(Ne)),b.needsAnimating[Ne]=!0;const ue=n.getValue(Ne);ue&&(ue.liveStyle=!1)};for(const Ne in F){const ue=P[Ne],ke=z[Ne];if(x.hasOwnProperty(Ne))continue;let ae=!1;_R(ue)&&_R(ke)?ae=!u7(ue,ke):ae=ue!==ke,ae?ue!=null?xe(Ne):m.add(Ne):ue!==void 0&&m.has(Ne)?xe(Ne):b.protectedKeys[Ne]=!0}b.prevProp=R,b.prevResolvedValues=P,b.isActive&&(x={...x,...P}),r&&n.blockInitialAnimation&&(A=!1),A&&(!(B&&k)||C)&&g.push(...O.map(Ne=>({animation:Ne,options:{type:T}})))}if(m.size){const w={};m.forEach(T=>{const b=n.getBaseTarget(T),R=n.getValue(T);R&&(R.liveStyle=!0),w[T]=b??null}),g.push({animation:w})}let _=!!g.length;return r&&(c.initial===!1||c.initial===c.animate)&&!n.manuallyAnimateOnMount&&(_=!1),r=!1,_?e(g):Promise.resolve()}function o(l,c){var h;if(t[l].isActive===c)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(m=>{var x;return(x=m.animationState)===null||x===void 0?void 0:x.setActive(l,c)}),t[l].isActive=c;const g=a(l);for(const m in t)t[m].protectedKeys={};return g}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>t,reset:()=>{t=l5(),r=!0}}}function toe(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!u7(e,n):!1}function Sh(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function l5(){return{animate:Sh(!0),whileInView:Sh(),whileHover:Sh(),whileTap:Sh(),whileDrag:Sh(),whileFocus:Sh(),exit:Sh()}}class Yu{constructor(e){this.isMounted=!1,this.node=e}update(){}}class noe extends Yu{constructor(e){super(e),e.animationState||(e.animationState=eoe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();CE(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let roe=0;class ioe extends Yu{constructor(){super(...arguments),this.id=roe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const soe={animation:{Feature:noe},exit:{Feature:ioe}};function r1(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function tx(n){return{point:{x:n.pageX,y:n.pageY}}}const aoe=n=>e=>II(e)&&n(e,tx(e));function tp(n,e,t,r){return r1(n,e,aoe(t),r)}const c5=(n,e)=>Math.abs(n-e);function ooe(n,e){const t=c5(n.x,e.x),r=c5(n.y,e.y);return Math.sqrt(t**2+r**2)}class J7{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=CT(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,x=ooe(g.offset,{x:0,y:0})>=3;if(!m&&!x)return;const{point:y}=g,{timestamp:_}=Gi;this.history.push({...y,timestamp:_});const{onStart:w,onMove:T}=this.handlers;m||(w&&w(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,g)},this.handlePointerMove=(g,m)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=IT(m,this.transformPagePoint),gr.update(this.updatePoint,!0)},this.handlePointerUp=(g,m)=>{this.end();const{onEnd:x,onSessionEnd:y,resumeAnimation:_}=this.handlers;if(this.dragSnapToOrigin&&_&&_(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=CT(g.type==="pointercancel"?this.lastMoveEventInfo:IT(m,this.transformPagePoint),this.history);this.startEvent&&x&&x(g,w),y&&y(g,w)},!II(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const a=tx(e),o=IT(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=Gi;this.history=[{...l,timestamp:c}];const{onSessionStart:h}=t;h&&h(e,CT(o,this.history)),this.removeListeners=ex(tp(this.contextWindow,"pointermove",this.handlePointerMove),tp(this.contextWindow,"pointerup",this.handlePointerUp),tp(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Fu(this.updatePoint)}}function IT(n,e){return e?{point:e(n.point)}:n}function u5(n,e){return{x:n.x-e.x,y:n.y-e.y}}function CT({point:n},e){return{point:n,delta:u5(n,Q7(e)),offset:u5(n,loe(e)),velocity:coe(e,.1)}}function loe(n){return n[0]}function Q7(n){return n[n.length-1]}function coe(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=Q7(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Jl(e)));)t--;if(!r)return{x:0,y:0};const s=Ql(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const eV=1e-4,uoe=1-eV,hoe=1+eV,tV=.01,doe=0-tV,foe=0+tV;function xa(n){return n.max-n.min}function goe(n,e,t){return Math.abs(n-e)<=t}function h5(n,e,t,r=.5){n.origin=r,n.originPoint=Nr(e.min,e.max,n.origin),n.scale=xa(t)/xa(e),n.translate=Nr(t.min,t.max,n.origin)-n.originPoint,(n.scale>=uoe&&n.scale<=hoe||isNaN(n.scale))&&(n.scale=1),(n.translate>=doe&&n.translate<=foe||isNaN(n.translate))&&(n.translate=0)}function np(n,e,t,r){h5(n.x,e.x,t.x,r?r.originX:void 0),h5(n.y,e.y,t.y,r?r.originY:void 0)}function d5(n,e,t){n.min=t.min+e.min,n.max=n.min+xa(e)}function moe(n,e,t){d5(n.x,e.x,t.x),d5(n.y,e.y,t.y)}function f5(n,e,t){n.min=e.min-t.min,n.max=n.min+xa(e)}function rp(n,e,t){f5(n.x,e.x,t.x),f5(n.y,e.y,t.y)}function poe(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Nr(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Nr(t,n,r.max):Math.min(n,t)),n}function g5(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function xoe(n,{top:e,left:t,bottom:r,right:i}){return{x:g5(n.x,t,i),y:g5(n.y,e,r)}}function m5(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function yoe(n,e){return{x:m5(n.x,e.x),y:m5(n.y,e.y)}}function _oe(n,e){let t=.5;const r=xa(n),i=xa(e);return i>r?t=eg(e.min,e.max-r,n.min):r>i&&(t=eg(n.min,n.max-i,e.min)),cc(0,1,t)}function voe(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const CR=.35;function woe(n=CR){return n===!1?n=0:n===!0&&(n=CR),{x:p5(n,"left","right"),y:p5(n,"top","bottom")}}function p5(n,e,t){return{min:x5(n,e),max:x5(n,t)}}function x5(n,e){return typeof n=="number"?n:n[e]||0}const y5=()=>({translate:0,scale:1,origin:0,originPoint:0}),o0=()=>({x:y5(),y:y5()}),_5=()=>({min:0,max:0}),$r=()=>({x:_5(),y:_5()});function Ca(n){return[n("x"),n("y")]}function nV({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function Eoe({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function Soe(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function PT(n){return n===void 0||n===1}function PR({scale:n,scaleX:e,scaleY:t}){return!PT(n)||!PT(e)||!PT(t)}function Ph(n){return PR(n)||rV(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function rV(n){return v5(n.x)||v5(n.y)}function v5(n){return n&&n!=="0%"}function Bv(n,e,t){const r=n-t,i=e*r;return t+i}function w5(n,e,t,r,i){return i!==void 0&&(n=Bv(n,i,r)),Bv(n,t,r)+e}function NR(n,e=0,t=1,r,i){n.min=w5(n.min,e,t,r,i),n.max=w5(n.max,e,t,r,i)}function iV(n,{x:e,y:t}){NR(n.x,e.translate,e.scale,e.originPoint),NR(n.y,t.translate,t.scale,t.originPoint)}const E5=.999999999999,S5=1.0000000000001;function Toe(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,a;for(let o=0;o<i;o++){s=t[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&c0(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,iV(n,a)),r&&Ph(s.latestValues)&&c0(n,s.latestValues))}e.x<S5&&e.x>E5&&(e.x=1),e.y<S5&&e.y>E5&&(e.y=1)}function l0(n,e){n.min=n.min+e,n.max=n.max+e}function T5(n,e,t,r,i=.5){const s=Nr(n.min,n.max,i);NR(n,e,t,s,r)}function c0(n,e){T5(n.x,e.x,e.scaleX,e.scale,e.originX),T5(n.y,e.y,e.scaleY,e.scale,e.originY)}function sV(n,e){return nV(Soe(n.getBoundingClientRect(),e))}function boe(n,e,t){const r=sV(n,t),{scroll:i}=e;return i&&(l0(r.x,i.offset.x),l0(r.y,i.offset.y)),r}const aV=({current:n})=>n?n.ownerDocument.defaultView:null,Roe=new WeakMap;class Aoe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=$r(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(tx(h).point)},s=(h,g)=>{const{drag:m,dragPropagation:x,onDragStart:y}=this.getProps();if(m&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=_se(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ca(w=>{let T=this.getAxisMotionValue(w).get()||0;if(cl.test(T)){const{projection:b}=this.visualElement;if(b&&b.layout){const R=b.layout.layoutBox[w];R&&(T=xa(R)*(parseFloat(T)/100))}}this.originPoint[w]=T}),y&&gr.postRender(()=>y(h,g)),ER(this.visualElement,"transform");const{animationState:_}=this.visualElement;_&&_.setActive("whileDrag",!0)},a=(h,g)=>{const{dragPropagation:m,dragDirectionLock:x,onDirectionLock:y,onDrag:_}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:w}=g;if(x&&this.currentDirection===null){this.currentDirection=koe(w),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",g.point,w),this.updateAxis("y",g.point,w),this.visualElement.render(),_&&_(h,g)},o=(h,g)=>this.stop(h,g),l=()=>Ca(h=>{var g;return this.getAnimationState(h)==="paused"&&((g=this.getAxisMotionValue(h).animation)===null||g===void 0?void 0:g.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new J7(e,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:aV(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&gr.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Wy(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=poe(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&s0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=xoe(i.layoutBox,t):this.constraints=!1,this.elastic=woe(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Ca(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=voe(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!s0(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=boe(r,i.root,this.visualElement.getTransformPagePoint());let a=yoe(i.layout.layoutBox,s);if(t){const o=t(Eoe(a));this.hasMutatedConstraints=!!o,o&&(a=nV(o))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Ca(h=>{if(!Wy(h,t,this.currentDirection))return;let g=l&&l[h]||{};a&&(g={min:0,max:0});const m=i?200:1e6,x=i?40:1e7,y={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...s,...g};return this.startAxisValueAnimation(h,y)});return Promise.all(c).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return ER(this.visualElement,e),r.start(GI(e,r,0,t,this.visualElement,!1))}stopAnimation(){Ca(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ca(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Ca(t=>{const{drag:r}=this.getProps();if(!Wy(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[t];s.set(e[t]-Nr(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!s0(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Ca(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=_oe({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ca(a=>{if(!Wy(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(Nr(l,c,i[a]))})}addListeners(){if(!this.visualElement.current)return;Roe.set(this.visualElement,this);const e=this.visualElement.current,t=tp(e,"pointerdown",l=>{const{drag:c,dragListener:h=!0}=this.getProps();c&&h&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();s0(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),gr.read(r);const a=r1(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Ca(h=>{const g=this.getAxisMotionValue(h);g&&(this.originPoint[h]+=l[h].translate,g.set(g.get()+l[h].translate))}),this.visualElement.render())}));return()=>{a(),t(),s(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=CR,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function Wy(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function koe(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class Ioe extends Yu{constructor(e){super(e),this.removeGroupControls=ga,this.removeListeners=ga,this.controls=new Aoe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ga}unmount(){this.removeGroupControls(),this.removeListeners()}}const b5=n=>(e,t)=>{n&&gr.postRender(()=>n(e,t))};class Coe extends Yu{constructor(){super(...arguments),this.removePointerDownListener=ga}onPointerDown(e){this.session=new J7(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:aV(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:b5(e),onStart:b5(t),onMove:r,onEnd:(s,a)=>{delete this.session,i&&gr.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=tp(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const I_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function R5(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const wm={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if($t.test(n))n=parseFloat(n);else return n;const t=R5(n,e.target.x),r=R5(n,e.target.y);return`${t}% ${r}%`}},Poe={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=Vu.parse(n);if(i.length>5)return r;const s=Vu.createTransformer(n),a=typeof i[0]!="number"?1:0,o=t.x.scale*e.x,l=t.y.scale*e.y;i[0+a]/=o,i[1+a]/=l;const c=Nr(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=c),typeof i[3+a]=="number"&&(i[3+a]/=c),s(i)}};class Noe extends H.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;Jie(Moe),s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),I_.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,a=r.projection;return a&&(a.isPresent=s,i||e.layoutDependency!==t||t===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||gr.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),pI.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function oV(n){const[e,t]=U9(),r=H.useContext(lI);return f.jsx(Noe,{...n,layoutGroup:r,switchLayoutGroup:H.useContext(Z9),isPresent:e,safeToRemove:t})}const Moe={borderRadius:{...wm,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:wm,borderTopRightRadius:wm,borderBottomLeftRadius:wm,borderBottomRightRadius:wm,boxShadow:Poe};function Loe(n,e,t){const r=hs(n)?n:t1(n);return r.start(GI("",r,e,t)),r.animation}function Ooe(n){return n instanceof SVGElement&&n.tagName!=="svg"}const Doe=(n,e)=>n.depth-e.depth;class joe{constructor(){this.children=[],this.isDirty=!1}add(e){CI(this.children,e),this.isDirty=!0}remove(e){PI(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Doe),this.isDirty=!1,this.children.forEach(e)}}function Foe(n,e){const t=ul.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(Fu(r),n(s-e))};return gr.read(r,!0),()=>Fu(r)}const lV=["TopLeft","TopRight","BottomLeft","BottomRight"],Voe=lV.length,A5=n=>typeof n=="string"?parseFloat(n):n,k5=n=>typeof n=="number"||$t.test(n);function Boe(n,e,t,r,i,s){i?(n.opacity=Nr(0,t.opacity!==void 0?t.opacity:1,Goe(r)),n.opacityExit=Nr(e.opacity!==void 0?e.opacity:1,0,zoe(r))):s&&(n.opacity=Nr(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let a=0;a<Voe;a++){const o=`border${lV[a]}Radius`;let l=I5(e,o),c=I5(t,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||k5(l)===k5(c)?(n[o]=Math.max(Nr(A5(l),A5(c),r),0),(cl.test(c)||cl.test(l))&&(n[o]+="%")):n[o]=c}(e.rotate||t.rotate)&&(n.rotate=Nr(e.rotate||0,t.rotate||0,r))}function I5(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const Goe=cV(0,.5,A7),zoe=cV(.5,.95,ga);function cV(n,e,t){return r=>r<n?0:r>e?1:t(eg(n,e,r))}function C5(n,e){n.min=e.min,n.max=e.max}function ka(n,e){C5(n.x,e.x),C5(n.y,e.y)}function P5(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function N5(n,e,t,r,i){return n-=e,n=Bv(n,1/t,r),i!==void 0&&(n=Bv(n,1/i,r)),n}function Uoe(n,e=0,t=1,r=.5,i,s=n,a=n){if(cl.test(e)&&(e=parseFloat(e),e=Nr(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=Nr(s.min,s.max,r);n===s&&(o-=e),n.min=N5(n.min,e,t,o,i),n.max=N5(n.max,e,t,o,i)}function M5(n,e,[t,r,i],s,a){Uoe(n,e[t],e[r],e[i],e.scale,s,a)}const $oe=["x","scaleX","originX"],Woe=["y","scaleY","originY"];function L5(n,e,t,r){M5(n.x,e,$oe,t?t.x:void 0,r?r.x:void 0),M5(n.y,e,Woe,t?t.y:void 0,r?r.y:void 0)}function O5(n){return n.translate===0&&n.scale===1}function uV(n){return O5(n.x)&&O5(n.y)}function D5(n,e){return n.min===e.min&&n.max===e.max}function Hoe(n,e){return D5(n.x,e.x)&&D5(n.y,e.y)}function j5(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function hV(n,e){return j5(n.x,e.x)&&j5(n.y,e.y)}function F5(n){return xa(n.x)/xa(n.y)}function V5(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class Koe{constructor(){this.members=[]}add(e){CI(this.members,e),e.scheduleRender()}remove(e){if(PI(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Xoe(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,a=t?.z||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:c,rotate:h,rotateX:g,rotateY:m,skewX:x,skewY:y}=t;c&&(r=`perspective(${c}px) ${r}`),h&&(r+=`rotate(${h}deg) `),g&&(r+=`rotateX(${g}deg) `),m&&(r+=`rotateY(${m}deg) `),x&&(r+=`skewX(${x}deg) `),y&&(r+=`skewY(${y}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const Nh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Om=typeof window<"u"&&window.MotionDebug!==void 0,NT=["","X","Y","Z"],qoe={visibility:"hidden"},B5=1e3;let Yoe=0;function MT(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function dV(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=v7(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",gr,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&dV(r)}function fV({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=e?.()){this.id=Yoe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Om&&(Nh.totalNodes=Nh.resolvedTargetDeltas=Nh.recalculatedProjection=0),this.nodes.forEach(Qoe),this.nodes.forEach(ile),this.nodes.forEach(sle),this.nodes.forEach(ele),Om&&window.MotionDebug.record(Nh)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new joe)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new NI),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Ooe(a),this.instance=a;const{layoutId:l,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),n){let g;const m=()=>this.root.updateBlockedByResize=!1;n(a,()=>{this.root.updateBlockedByResize=!0,g&&g(),g=Foe(m,250),I_.hasAnimatedSinceResize&&(I_.hasAnimatedSinceResize=!1,this.nodes.forEach(z5))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||c)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:m,hasRelativeTargetChanged:x,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||h.getDefaultTransition()||ule,{onLayoutAnimationStart:w,onLayoutAnimationComplete:T}=h.getProps(),b=!this.targetLayout||!hV(this.targetLayout,y)||x,R=!m&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||R||m&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(g,R);const M={...RI(_,"layout"),onPlay:w,onComplete:T};(h.shouldReduceMotion||this.options.layoutRoot)&&(M.delay=0,M.type=!1),this.startAnimation(M)}else m||z5(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Fu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(ale),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&dV(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const g=this.path[h];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(G5);return}this.isUpdating||this.nodes.forEach(nle),this.isUpdating=!1,this.nodes.forEach(rle),this.nodes.forEach(Zoe),this.nodes.forEach(Joe),this.clearAllSnapshots();const o=ul.now();Gi.delta=cc(0,1e3/60,o-Gi.timestamp),Gi.timestamp=o,Gi.isProcessing=!0,ST.update.process(Gi),ST.preRender.process(Gi),ST.render.process(Gi),Gi.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,pI.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(tle),this.sharedNodes.forEach(ole)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,gr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){gr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=$r(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!uV(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,h=c!==this.prevTransformTemplateValue;a&&(o||Ph(this.latestValues)||h)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),hle(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return $r();const l=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(dle))){const{scroll:h}=this.root;h&&(l0(l.x,h.offset.x),l0(l.y,h.offset.y))}return l}removeElementScroll(a){var o;const l=$r();if(ka(l,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let c=0;c<this.path.length;c++){const h=this.path[c],{scroll:g,options:m}=h;h!==this.root&&g&&m.layoutScroll&&(g.wasRoot&&ka(l,a),l0(l.x,g.offset.x),l0(l.y,g.offset.y))}return l}applyTransform(a,o=!1){const l=$r();ka(l,a);for(let c=0;c<this.path.length;c++){const h=this.path[c];!o&&h.options.layoutScroll&&h.scroll&&h!==h.root&&c0(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Ph(h.latestValues)&&c0(l,h.latestValues)}return Ph(this.latestValues)&&c0(l,this.latestValues),l}removeTransform(a){const o=$r();ka(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Ph(c.latestValues))continue;PR(c.latestValues)&&c.updateSnapshot();const h=$r(),g=c.measurePageBox();ka(h,g),L5(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,h)}return Ph(this.latestValues)&&L5(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Gi.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:m}=this.options;if(!(!this.layout||!(g||m))){if(this.resolvedRelativeTargetAt=Gi.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$r(),this.relativeTargetOrigin=$r(),rp(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),ka(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=$r(),this.targetWithTransforms=$r()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),moe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ka(this.target,this.layout.layoutBox),iV(this.target,this.targetDelta)):ka(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$r(),this.relativeTargetOrigin=$r(),rp(this.relativeTargetOrigin,this.target,x.target),ka(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Om&&Nh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||PR(this.parent.latestValues)||rV(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Gi.timestamp&&(c=!1),c)return;const{layout:h,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||g))return;ka(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,x=this.treeScale.y;Toe(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=$r());const{target:y}=o;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(P5(this.prevProjectionDelta.x,this.projectionDelta.x),P5(this.prevProjectionDelta.y,this.projectionDelta.y)),np(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==x||!V5(this.projectionDelta.x,this.prevProjectionDelta.x)||!V5(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y)),Om&&Nh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=o0(),this.projectionDelta=o0(),this.projectionDeltaWithTransform=o0()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},h={...this.latestValues},g=o0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const m=$r(),x=l?l.source:void 0,y=this.layout?this.layout.source:void 0,_=x!==y,w=this.getStack(),T=!w||w.members.length<=1,b=!!(_&&!T&&this.options.crossfade===!0&&!this.path.some(cle));this.animationProgress=0;let R;this.mixTargetDelta=M=>{const D=M/1e3;U5(g.x,a.x,D),U5(g.y,a.y,D),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(rp(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),lle(this.relativeTarget,this.relativeTargetOrigin,m,D),R&&Hoe(this.relativeTarget,R)&&(this.isProjectionDirty=!1),R||(R=$r()),ka(R,this.relativeTarget)),_&&(this.animationValues=h,Boe(h,c,this.latestValues,D,b,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Fu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=gr.update(()=>{I_.hasAnimatedSinceResize=!0,this.currentAnimation=Loe(0,B5,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(B5),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:h}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&gV(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||$r();const g=xa(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+g;const m=xa(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+m}ka(o,l),c0(o,h),np(this.projectionDeltaWithTransform,this.layoutCorrected,o,h)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Koe),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&MT("z",a,c,this.animationValues);for(let h=0;h<NT.length;h++)MT(`rotate${NT[h]}`,a,c,this.animationValues),MT(`skew${NT[h]}`,a,c,this.animationValues);a.render();for(const h in c)a.setStaticValue(h,c[h]),this.animationValues&&(this.animationValues[h]=c[h]);a.scheduleRender()}getProjectionStyles(a){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return qoe;const c={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=A_(a?.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none",c;const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){const _={};return this.options.layoutId&&(_.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,_.pointerEvents=A_(a?.pointerEvents)||""),this.hasProjected&&!Ph(this.latestValues)&&(_.transform=h?h({},""):"none",this.hasProjected=!1),_}const m=g.animationValues||g.latestValues;this.applyTransformsToTarget(),c.transform=Xoe(this.projectionDeltaWithTransform,this.treeScale,m),h&&(c.transform=h(m,c.transform));const{x,y}=this.projectionDelta;c.transformOrigin=`${x.origin*100}% ${y.origin*100}% 0`,g.animationValues?c.opacity=g===this?(l=(o=m.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:c.opacity=g===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const _ in Ov){if(m[_]===void 0)continue;const{correct:w,applyTo:T}=Ov[_],b=c.transform==="none"?m[_]:w(m[_],g);if(T){const R=T.length;for(let M=0;M<R;M++)c[T[M]]=b}else c[_]=b}return this.options.layoutId&&(c.pointerEvents=g===this?A_(a?.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(G5),this.root.sharedNodes.clear()}}}function Zoe(n){n.updateLayout()}function Joe(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,a=t.source!==n.layout.source;s==="size"?Ca(g=>{const m=a?t.measuredBox[g]:t.layoutBox[g],x=xa(m);m.min=r[g].min,m.max=m.min+x}):gV(s,t.layoutBox,r)&&Ca(g=>{const m=a?t.measuredBox[g]:t.layoutBox[g],x=xa(r[g]);m.max=m.min+x,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[g].max=n.relativeTarget[g].min+x)});const o=o0();np(o,r,t.layoutBox);const l=o0();a?np(l,n.applyTransform(i,!0),t.measuredBox):np(l,r,t.layoutBox);const c=!uV(o);let h=!1;if(!n.resumeFrom){const g=n.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:m,layout:x}=g;if(m&&x){const y=$r();rp(y,t.layoutBox,m.layoutBox);const _=$r();rp(_,r,x.layoutBox),hV(y,_)||(h=!0),g.options.layoutRoot&&(n.relativeTarget=_,n.relativeTargetOrigin=y,n.relativeParent=g)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeTargetChanged:h})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function Qoe(n){Om&&Nh.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function ele(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function tle(n){n.clearSnapshot()}function G5(n){n.clearMeasurements()}function nle(n){n.isLayoutDirty=!1}function rle(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function z5(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function ile(n){n.resolveTargetDelta()}function sle(n){n.calcProjection()}function ale(n){n.resetSkewAndRotation()}function ole(n){n.removeLeadSnapshot()}function U5(n,e,t){n.translate=Nr(e.translate,0,t),n.scale=Nr(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function $5(n,e,t,r){n.min=Nr(e.min,t.min,r),n.max=Nr(e.max,t.max,r)}function lle(n,e,t,r){$5(n.x,e.x,t.x,r),$5(n.y,e.y,t.y,r)}function cle(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const ule={duration:.45,ease:[.4,0,.1,1]},W5=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),H5=W5("applewebkit/")&&!W5("chrome/")?Math.round:ga;function K5(n){n.min=H5(n.min),n.max=H5(n.max)}function hle(n){K5(n.x),K5(n.y)}function gV(n,e,t){return n==="position"||n==="preserve-aspect"&&!goe(F5(e),F5(t),.2)}function dle(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const fle=fV({attachResizeListener:(n,e)=>r1(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),LT={current:void 0},mV=fV({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!LT.current){const n=new fle({});n.mount(window),n.setOptions({layoutScroll:!0}),LT.current=n}return LT.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),gle={pan:{Feature:Coe},drag:{Feature:Ioe,ProjectionNode:mV,MeasureLayout:oV}};function X5(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&gr.postRender(()=>s(e,tx(e)))}class mle extends Yu{mount(){const{current:e}=this.node;e&&(this.unmount=gse(e,t=>(X5(this.node,t,"Start"),r=>X5(this.node,r,"End"))))}unmount(){}}class ple extends Yu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ex(r1(this.node.current,"focus",()=>this.onFocus()),r1(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function q5(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&gr.postRender(()=>s(e,tx(e)))}class xle extends Yu{mount(){const{current:e}=this.node;e&&(this.unmount=yse(e,t=>(q5(this.node,t,"Start"),(r,{success:i})=>q5(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const MR=new WeakMap,OT=new WeakMap,yle=n=>{const e=MR.get(n.target);e&&e(n)},_le=n=>{n.forEach(yle)};function vle({root:n,...e}){const t=n||document;OT.has(t)||OT.set(t,{});const r=OT.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(_le,{root:n,...e})),r[i]}function wle(n,e,t){const r=vle(e);return MR.set(n,t),r.observe(n),()=>{MR.delete(n),r.unobserve(n)}}const Ele={some:0,all:1};class Sle extends Yu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:Ele[i]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:h,onViewportLeave:g}=this.node.getProps(),m=c?h:g;m&&m(l)};return wle(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(Tle(e,t))&&this.startObserver()}unmount(){}}function Tle({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const ble={inView:{Feature:Sle},tap:{Feature:xle},focus:{Feature:ple},hover:{Feature:mle}},Rle={layout:{ProjectionNode:mV,MeasureLayout:oV}},LR={current:null},pV={current:!1};function Ale(){if(pV.current=!0,!!hI)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>LR.current=n.matches;n.addListener(e),e()}else LR.current=!1}const kle=[...G7,as,Vu],Ile=n=>kle.find(B7(n)),Y5=new WeakMap;function Cle(n,e,t){for(const r in e){const i=e[r],s=t[r];if(hs(i))n.addValue(r,i);else if(hs(s))n.addValue(r,t1(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,t1(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const Z5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Ple{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=FI,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const x=ul.now();this.renderScheduledAt<x&&(this.renderScheduledAt=x,gr.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:h}=a;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=PE(t),this.isVariantNode=q9(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:g,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const x in m){const y=m[x];l[x]!==void 0&&hs(y)&&y.set(l[x],!1)}}mount(e){this.current=e,Y5.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),pV.current||Ale(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:LR.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Y5.delete(this.current),this.projection&&this.projection.unmount(),Fu(this.notifyUpdate),Fu(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Fd.has(e),i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&gr.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in tg){const t=tg[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):$r()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<Z5.length;r++){const i=Z5[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=e[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=Cle(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=t1(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(F7(i)||I7(i))?i=parseFloat(i):!Ile(i)&&Vu.test(t)&&(i=O7(e,t)),this.setBaseTarget(e,hs(i)?i.get():i)),hs(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const a=yI(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);a&&(i=a[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!hs(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new NI),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class xV extends Ple{constructor(){super(...arguments),this.KeyframeResolver=z7}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;hs(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function Nle(n){return window.getComputedStyle(n)}class Mle extends xV{constructor(){super(...arguments),this.type="html",this.renderInstance=i7}readValueFromInstance(e,t){if(Fd.has(t)){const r=jI(t);return r&&r.default||0}else{const r=Nle(e),i=(t7(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return sV(e,t)}build(e,t,r){wI(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return bI(e,t,r)}}class Lle extends xV{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=$r}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Fd.has(t)){const r=jI(t);return r&&r.default||0}return t=s7.has(t)?t:mI(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return l7(e,t,r)}build(e,t,r){EI(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){a7(e,t,r,i)}mount(e){this.isSVGTag=TI(e.tagName),super.mount(e)}}const Ole=(n,e)=>xI(n)?new Lle(e):new Mle(e,{allowProjection:n!==H.Fragment}),Dle=ose({...soe,...ble,...gle,...Rle},Ole),wt=Eie(Dle);const jle=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Fle=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),J5=n=>{const e=Fle(n);return e.charAt(0).toUpperCase()+e.slice(1)},yV=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),Vle=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Ble={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Gle=H.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},l)=>H.createElement("svg",{ref:l,...Ble,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:yV("lucide",i),...!s&&!Vle(o)&&{"aria-hidden":"true"},...o},[...a.map(([c,h])=>H.createElement(c,h)),...Array.isArray(s)?s:[s]]));const et=(n,e)=>{const t=H.forwardRef(({className:r,...i},s)=>H.createElement(Gle,{ref:s,iconNode:e,className:yV(`lucide-${jle(J5(n))}`,`lucide-${n}`,r),...i}));return t.displayName=J5(n),t};const zle=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],Ule=et("archive-restore",zle);const $le=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],_V=et("archive",$le);const Wle=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Hle=et("ban",Wle);const Kle=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Xle=et("book-open",Kle);const qle=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],vV=et("bug",qle);const Yle=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],LE=et("calendar",Yle);const Zle=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],OE=et("camera",Zle);const Jle=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],wV=et("chart-column",Jle);const Qle=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],uc=et("check",Qle);const ece=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],nx=et("chevron-down",ece);const tce=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],nce=et("chevron-left",tce);const rce=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],_g=et("chevron-right",rce);const ice=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],zI=et("chevron-up",ice);const sce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],EV=et("circle-alert",sce);const ace=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],oce=et("circle-check-big",ace);const lce=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Gv=et("clock",lce);const cce=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 17H7",key:"pygtm1"}],["path",{d:"M17 21H9",key:"1u2q02"}]],uce=et("cloud-fog",cce);const hce=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],dce=et("cloud-lightning",hce);const fce=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],gce=et("cloud-off",fce);const mce=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],UI=et("cloud-rain",mce);const pce=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],xce=et("cloud-snow",pce);const yce=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],hc=et("cloud",yce);const _ce=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],vce=et("code",_ce);const wce=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ece=et("compass",wce);const Sce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],i1=et("crosshair",Sce);const Tce=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],zv=et("download",Tce);const bce=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],Rce=et("droplets",bce);const Ace=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Iu=et("external-link",Ace);const kce=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Uv=et("eye-off",kce);const Ice=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],$v=et("eye",Ice);const Cce=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],$I=et("file-text",Cce);const Pce=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],Nce=et("flame",Pce);const Mce=[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]],Q5=et("flower-2",Mce);const Lce=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Oce=et("folder-open",Lce);const Dce=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],jce=et("folder-plus",Dce);const Fce=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Vce=et("folder",Fce);const Bce=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],Gce=et("gauge",Bce);const zce=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],Uce=et("gem",zce);const $ce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Wce=et("globe",$ce);const Hce=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],SV=et("grid-3x3",Hce);const Kce=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],Xce=et("image-plus",Kce);const qce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],WI=et("info",qce);const Yce=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],za=et("layers",Yce);const Zce=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],TV=et("list",Zce);const Jce=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],HI=et("loader-circle",Jce);const Qce=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],eue=et("locate-fixed",Qce);const tue=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],OR=et("lock",tue);const nue=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],KI=et("log-out",nue);const rue=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],As=et("map-pin",rue);const iue=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],XI=et("map",iue);const sue=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],aue=et("menu",sue);const oue=[["path",{d:"M5 12h14",key:"1ays0h"}]],bV=et("minus",oue);const lue=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],rg=et("mountain",lue);const cue=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],uue=et("mouse-pointer",cue);const hue=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],rx=et("navigation",hue);const due=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],RV=et("pause",due);const fue=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],eO=et("pen-line",fue);const gue=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],mue=et("pen",gue);const pue=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],ig=et("pencil",pue);const xue=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],AV=et("person-standing",xue);const yue=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],kV=et("play",yue);const _ue=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Xa=et("plus",_ue);const vue=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],wue=et("radio",vue);const Eue=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Sue=et("refresh-cw",Eue);const Tue=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],bue=et("rotate-ccw",Tue);const Rue=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Aue=et("rotate-cw",Rue);const kue=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],Wv=et("route",kue);const Iue=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],s1=et("ruler",Iue);const Cue=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],IV=et("save",Cue);const Pue=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],Nue=et("scale",Pue);const Mue=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],a1=et("search",Mue);const Lue=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],DR=et("settings",Lue);const Oue=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Due=et("settings-2",Oue);const jue=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Fue=et("share-2",jue);const Vue=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Bue=et("shield",Vue);const Gue=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],zue=et("sliders-horizontal",Gue);const Uue=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],$ue=et("sliders-vertical",Uue);const Wue=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Hue=et("smartphone",Wue);const Kue=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Xue=et("square",Kue);const que=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Yue=et("sun",que);const Zue=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Jue=et("tag",Zue);const Que=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ehe=et("target",Que);const the=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],nhe=et("timer",the);const rhe=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],_c=et("trash-2",rhe);const ihe=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],she=et("tree-palm",ihe);const ahe=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],ohe=et("trending-down",ahe);const lhe=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],che=et("trending-up",lhe);const uhe=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],CV=et("type",uhe);const hhe=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ix=et("upload",hhe);const dhe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],qI=et("user",dhe);const fhe=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],ghe=et("volume-2",fhe);const mhe=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],phe=et("waves",mhe);const xhe=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],tO=et("wind",xhe);const yhe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Xr=et("x",yhe);const _he=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],vhe=et("zoom-in",_he);const whe=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Ehe=et("zoom-out",whe);function She(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:r,setWatchId:i,resetFirstFix:s}=Wi(),a=H.useCallback(l=>{r(l)},[r]),o=H.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return H.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(a,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return i(l),()=>{navigator.geolocation.clearWatch(l)}},[n,a,o,i,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function The(){const{tracking:n,toggle:e}=She();return f.jsx(wt.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:f.jsx(eue,{size:22,strokeWidth:2})})}const bhe="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#4285F4" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function Rhe(){const n=pi(x=>x.map),e=Wi(x=>x.position),t=Wi(x=>x.accuracy),r=Wi(x=>x.tracking),i=Wi(x=>x.smoothHeading),s=yn(x=>x.showAccuracyCircle),a=Wi(x=>x.firstFix),o=Wi(x=>x.resetFirstFix),l=Wi(x=>x.config.centerOnUser),c=H.useRef(null),h=H.useRef(null),g=H.useRef(null),m=H.useMemo(()=>x=>new pn({image:new I1({src:bhe,scale:.9,rotation:x,rotateWithView:!1,anchor:[.5,.5]})}),[]);return H.useEffect(()=>{if(!n||!r&&!e)return;const x=kr([5.1214,52.0907]);return c.current=new _r({geometry:new gi(x)}),c.current.setStyle(m(0)),h.current=new _r({geometry:new gi(x)}),g.current=new Hu({source:new mc({features:[h.current,c.current]}),zIndex:1e3}),n.addLayer(g.current),()=>{g.current&&n&&n.removeLayer(g.current)}},[n,r,e,m]),H.useEffect(()=>{if(!n||!e||!c.current||!h.current)return;const x=kr([e.lng,e.lat]);if(c.current.getGeometry()?.setCoordinates(x),h.current.getGeometry()?.setCoordinates(x),s&&t){const y=n.getView().getResolution()||1,_=Math.min(t/y,80);h.current.setStyle(new pn({image:new Ws({radius:_,fill:new rr({color:"rgba(66, 133, 244, 0.12)"})})}))}else h.current.setStyle(new pn({}));if(a&&r){n.getView().setCenter(x),n.getView().setZoom(17),o();return}r&&l&&!a&&n.getView().animate({center:x,duration:150})},[n,r,e,t,a,o,l,s]),H.useEffect(()=>{if(!c.current)return;const x=i!==null?i*Math.PI/180:0;c.current.setStyle(m(x))},[i,m]),null}function Ahe(){const n=wr(t=>t.themesPanelOpen),e=wr(t=>t.toggleThemesPanel);return f.jsx(wt.button,{className:`
        fixed bottom-[60px] right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:f.jsx(XI,{size:22,strokeWidth:2})})}function khe(){return f.jsx(Ahe,{})}const Hy=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],iu=["Mineraal","Fossiel","Erfgoed","Monument","Overig"],uo="default-vondsten",PV={id:uo,name:"Mijn vondsten",color:"#f97316",categories:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()},Ihe=n=>n.some(t=>t.id===uo)?n:[{...PV,createdAt:new Date().toISOString()},...n],fs=Yi()(Ro((n,e)=>({layers:[{...PV}],colorIndex:0,addLayer:(t,r=iu)=>{const i=crypto.randomUUID(),s=Hy[e().colorIndex%Hy.length];return n(a=>({layers:[...a.layers,{id:i,name:t,color:s,categories:[...r],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:a.colorIndex+1})),i},removeLayer:t=>{n(r=>({layers:r.layers.filter(i=>i.id!==t)}))},updateLayer:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)}))},toggleVisibility:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)}))},toggleArchived:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,archived:!i.archived,visible:i.archived?i.visible:!1}:i)}))},addPoint:(t,r)=>{const i={...r,status:r.status||"todo",id:crypto.randomUUID(),createdAt:new Date().toISOString()};n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:[...a.points,i]}:a)}))},removePoint:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,points:s.points.filter(a=>a.id!==r)}:s)}))},updatePoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,...i}:o)}:a)}))},setPointStatus:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,status:i}:o)}:a)}))},addCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t&&!s.categories.includes(r)?{...s,categories:[...s.categories,r]}:s)}))},removeCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,categories:s.categories.filter(a=>a!==r)}:s)}))},addPhotoToPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:[...o.photos||[],i]}:o)}:a)}))},removePhotoFromPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:(o.photos||[]).filter(l=>l.id!==i)}:o)}:a)}))},updatePhotoInPoint:(t,r,i,s)=>{n(a=>({layers:a.layers.map(o=>o.id===t?{...o,points:o.points.map(l=>l.id===r?{...l,photos:(l.photos||[]).map(c=>c.id===i?{...c,...s}:c)}:l)}:o)}))},exportLayerAsGeoJSON:t=>{const r=e().layers.find(l=>l.id===t);if(!r)return;const i={type:"FeatureCollection",properties:{name:r.name,color:r.color,categories:r.categories,createdAt:r.createdAt,exportedAt:new Date().toISOString()},features:r.points.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:l.coordinates},properties:{id:l.id,name:l.name,category:l.category,notes:l.notes,url:l.url,status:l.status,sourceLayer:l.sourceLayer,sourceId:l.sourceId,photos:l.photos,createdAt:l.createdAt}}))},s=new Blob([JSON.stringify(i,null,2)],{type:"application/geo+json"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`${r.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},importLayerFromGeoJSON:t=>{try{const r=JSON.parse(t);if(r.type!=="FeatureCollection")return{success:!1,error:"Ongeldig GeoJSON formaat"};const i=r.properties||{},s=i.name||`Gemporteerd ${new Date().toLocaleDateString("nl-NL")}`,a=i.categories||iu,o=i.color||Hy[e().colorIndex%Hy.length],l=(r.features||[]).filter(h=>h.geometry?.type==="Point").map(h=>({id:h.properties?.id||crypto.randomUUID(),name:h.properties?.name||"Naamloos",category:h.properties?.category||"Overig",notes:h.properties?.notes||"",url:h.properties?.url,status:h.properties?.status||"todo",sourceLayer:h.properties?.sourceLayer,sourceId:h.properties?.sourceId,photos:h.properties?.photos,coordinates:h.geometry.coordinates,createdAt:h.properties?.createdAt||new Date().toISOString()})),c=crypto.randomUUID();return n(h=>({layers:[...h.layers,{id:c,name:s,color:o,categories:a,points:l,visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:h.colorIndex+1})),{success:!0,layerId:c}}catch{return{success:!1,error:"Fout bij parsen van GeoJSON"}}},getLayer:t=>e().layers.find(r=>r.id===t),getActiveLayerCount:()=>e().layers.filter(t=>!t.archived).length,getArchivedLayerCount:()=>e().layers.filter(t=>t.archived).length,clearAll:()=>{n(t=>({layers:t.layers.map(r=>r.id===uo?{...r,points:[]}:r).filter(r=>r.id===uo),colorIndex:0}))}}),{name:"detectorapp-custom-point-layers",version:3,migrate:(n,e)=>{const t=n;return e<2?{...t,layers:Ihe(t.layers||[])}:e<3?{...t,layers:(t.layers||[]).map(r=>r.id===uo?{...r,name:"Mijn vondsten"}:r)}:t}}));function Fi({title:n,children:e,defaultExpanded:t=!0,layerNames:r}){const[i,s]=H.useState(t),a=Ri(w=>w.visible),o=Ri(w=>w.setLayerVisibility),l=oI(w=>w.isLayerUnlocked),c=w=>{const T=qw[w],b=T?.tier??"free",R=T?.regions??["nl"];return l(w,b,R)},h=r?.filter(w=>c(w))||[],g=h.filter(w=>a[w]).length,m=h.length,x=m>0&&g===m,y=g>0&&g<m,_=w=>{if(w.stopPropagation(),!r||h.length===0)return;const T=!x;h.forEach(b=>{o(b,T)})};return f.jsxs("div",{className:"mb-0.5",children:[f.jsxs("div",{className:"flex items-center gap-1 py-1 px-1 hover:bg-blue-50 transition-colors",children:[f.jsxs("button",{onClick:w=>{w.stopPropagation(),s(!i)},className:"flex-1 flex items-center gap-1 bg-transparent border-0 outline-none text-left",style:{fontSize:"inherit"},children:[f.jsx(wt.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:f.jsx(_g,{size:14})}),i?f.jsx(Oce,{size:16,className:"text-blue-500"}):f.jsx(Vce,{size:16,className:"text-blue-500"}),f.jsx("span",{className:"text-gray-700 font-medium",style:{fontSize:"1em"},children:n}),g>0&&f.jsx("span",{className:"ml-1 px-1.5 py-0.5 font-medium bg-blue-100 text-blue-600 rounded-full",style:{fontSize:"0.7em"},children:g})]}),r&&r.length>0&&f.jsx("button",{onClick:_,className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:x?"#3b82f6":y?"#93c5fd":"white",border:x?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:(x||y)&&f.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:f.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),f.jsx(In,{initial:!1,children:i&&f.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function dt({name:n,type:e,hasOverlay:t}){const r=Ri(R=>R.visible[n]),i=Ri(R=>R.visible["Labels Overlay"]),s=Ri(R=>R.loadingState[n]),a=Ri(R=>R.toggleLayer),o=Ri(R=>R.setLayerVisibility),l=oI(R=>R.isLayerUnlocked),c=s==="loading",h=s==="error",g=qw[n],m=g?.tier??"free",x=g?.regions??["nl"],_=!l(n,m,x),w=R=>{R.stopPropagation(),!(c||_)&&(e==="overlay"?a(n):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(D=>{o(D,D===n)}))},T=R=>{R.stopPropagation(),o("Labels Overlay",!i)},b=r??!1;return f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("button",{onClick:w,disabled:c||_,className:`flex-1 flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${_?"opacity-50 cursor-not-allowed bg-gray-50":c?"opacity-70 cursor-wait bg-transparent":b?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,style:{fontSize:"inherit"},title:_?"Premium laag - upgrade om te ontgrendelen":void 0,children:[f.jsxs("span",{className:`flex items-center gap-1 ${h?"text-red-500":_?"text-gray-400":"text-gray-600"}`,children:[n,h&&f.jsx(EV,{size:12,className:"text-red-500"}),_&&f.jsx(OR,{size:12,className:"text-amber-500"})]}),f.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:_?"#e5e7eb":c?"#93c5fd":b?"#3b82f6":"white",border:_?"2px solid #d1d5db":c?"2px solid #93c5fd":b?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:_?f.jsx(OR,{size:10,strokeWidth:3,className:"text-gray-400"}):c?f.jsx(HI,{size:10,strokeWidth:3,className:"animate-spin"}):b?f.jsx(uc,{size:12,strokeWidth:3}):null})]}),t&&b&&f.jsx("button",{onClick:T,className:`p-1 rounded transition-colors border-0 outline-none ${i?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:i?"Labels verbergen":"Labels tonen",children:f.jsx(Jue,{size:12})})]})}const Che=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899","#6b7280"];function NV({layer:n,compact:e=!1}){const{toggleVisibility:t,removeLayer:r,updateLayer:i,setColor:s}=Z1(),[a,o]=H.useState(!1),[l,c]=H.useState(!1),[h,g]=H.useState(n.name),[m,x]=H.useState(!1),y=H.useRef(null),_=H.useRef(null),w=n.features.features.length,T=[...new Set(n.features.features.map(k=>k.geometry?.type).filter(Boolean))];H.useEffect(()=>{l&&y.current&&(y.current.focus(),y.current.select())},[l]),H.useEffect(()=>{const k=A=>{_.current&&!_.current.contains(A.target)&&x(!1)};if(m)return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[m]);const b=()=>{a?r(n.id):(o(!0),setTimeout(()=>o(!1),3e3))},R=()=>{const k=h.trim();k&&k!==n.name&&i(n.id,{name:k}),c(!1)},M=()=>{g(n.name),c(!1)},D=k=>{k.key==="Enter"?R():k.key==="Escape"&&M()},B=k=>{s(n.id,k),x(!1)};return e?f.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 hover:bg-blue-50 transition-colors rounded",children:[f.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.color}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&f.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:f.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),f.jsx("span",{className:"text-gray-700 truncate flex-1 cursor-pointer",style:{fontSize:"0.9em"},onClick:()=>t(n.id),children:n.name}),f.jsx("span",{className:"text-[10px] text-gray-400 flex-shrink-0",children:w})]}):f.jsxs("div",{className:"flex items-center justify-between py-1.5 group",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[f.jsxs("div",{className:"relative",ref:_,children:[f.jsx("button",{onClick:()=>x(!m),className:"w-5 h-5 rounded border-2 border-white shadow-sm flex-shrink-0 hover:scale-110 transition-transform",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),m&&f.jsx("div",{className:"absolute top-6 left-0 z-50 bg-white rounded-lg shadow-lg border p-2 grid grid-cols-3 gap-1",children:Che.map(k=>f.jsx("button",{onClick:()=>B(k),className:`w-6 h-6 rounded border-2 transition-transform hover:scale-110 ${k===n.color?"border-gray-800 scale-110":"border-white"}`,style:{backgroundColor:k},title:k},k))})]}),f.jsx("div",{className:"flex-1 min-w-0",children:l?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("input",{ref:y,type:"text",value:h,onChange:k=>g(k.target.value),onKeyDown:D,className:"flex-1 text-sm px-1 py-0.5 border rounded min-w-0"}),f.jsx("button",{onClick:R,className:"p-0.5 text-green-600 hover:bg-green-50 rounded",title:"Opslaan",children:f.jsx(uc,{size:14})}),f.jsx("button",{onClick:M,className:"p-0.5 text-gray-400 hover:bg-gray-100 rounded",title:"Annuleren",children:f.jsx(Xr,{size:14})})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-sm text-gray-700 truncate",children:n.name}),f.jsx("button",{onClick:()=>c(!0),className:"p-0.5 text-gray-400 hover:text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Naam wijzigen",children:f.jsx(ig,{size:12})})]}),f.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[f.jsxs("span",{children:[w," ",w===1?"feature":"features"]}),T.length>0&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"mx-0.5",children:""}),f.jsx("span",{children:T.join(", ")})]})]})]})})]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.visible?n.color:"#9ca3af"}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&f.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:f.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),f.jsx("button",{onClick:b,className:`p-1 rounded transition-colors border-0 outline-none ${a?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50"}`,title:a?"Klik nogmaals om te verwijderen":"Verwijderen",children:f.jsx(_c,{size:14})})]})]})}const Phe=[{name:"Rapa Nui - Moai Productie",url:"https://arcg.is/qu59O1",desc:"Paaseiland steengroeve in 3D"},{name:"Digital Giza - Piramides",url:"http://giza.fas.harvard.edu/giza3d/",desc:"Harvard 3D reconstructie"},{name:"Stonehenge 360",url:"https://www.english-heritage.org.uk/visit/places/stonehenge/history-and-stories/stonehenge360/",desc:"English Heritage virtuele tour"},{name:"Pompeii 3D Explorer",url:"https://www.cyark.org/projects/pompeii/3D-Explorer",desc:"CyArk LiDAR scans"},{name:"Virtual Angkor Wat",url:"https://www.virtualangkor.com/",desc:"3D reconstructie 1300 n.Chr."},{name:"Petra Virtuele Tour",url:"https://www.zamaniproject.org/site-jordan-petra.html",desc:"Zamani Project 3D"}],Nhe=[{name:"CyArk (200+ sites)",url:"https://www.cyark.org/projects/",desc:"Wereldwijd erfgoed archief"},{name:"Google Open Heritage",url:"https://artsandculture.google.com/project/openheritage",desc:"26+ UNESCO sites in 3D"}];function Mhe(){const{themesPanelOpen:n,toggleThemesPanel:e,toggleSettingsPanel:t}=wr(),{layers:r,toggleVisibility:i}=fs(),s=Z1(x=>x.layers),a=H.useRef(null),o=yn(x=>x.layerPanelFontScale),l=yn(x=>x.setLayerPanelFontScale),c=yn(x=>x.showFontSliders),h=13*o/100,[g,m]=H.useState(!1);return H.useEffect(()=>{if(!n)return;const x=_=>{a.current&&!a.current.contains(_.target)&&e()},y=setTimeout(()=>{document.addEventListener("click",x)},100);return()=>{clearTimeout(y),document.removeEventListener("click",x)}},[n,e]),f.jsx(In,{children:n&&f.jsxs(wt.div,{ref:a,className:"fixed top-2.5 right-2 z-[1101] bg-white rounded-lg shadow-lg overflow-hidden w-[300px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[f.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-500",style:{fontSize:`${h}px`},children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(za,{size:14,className:"text-white"}),f.jsx("span",{className:"font-medium text-white",children:"Kaartlagen"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[c&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:o,onInput:x=>{l(parseInt(x.target.value))},onChange:x=>l(parseInt(x.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o}%`}),f.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),f.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-blue-400/50 hover:bg-blue-400 transition-colors ml-1",children:f.jsx(Xr,{size:16,className:"text-white",strokeWidth:2.5})})]})]}),f.jsxs("div",{className:"p-2 overflow-y-auto flex-1",style:{fontSize:`${h}px`},children:[r.filter(x=>!x.archived).length>0&&f.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[f.jsx("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:f.jsx("span",{className:"text-orange-600 font-medium",style:{fontSize:"0.9em"},children:"Mijn lagen"})}),r.filter(x=>!x.archived).map(x=>f.jsxs("button",{onClick:y=>{y.stopPropagation(),i(x.id)},className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${x.visible?"bg-orange-50 hover:bg-orange-100":"bg-transparent hover:bg-orange-50"}`,style:{fontSize:"inherit"},children:[f.jsxs("span",{className:"flex items-center gap-2 text-gray-600",children:[x.name,f.jsxs("span",{className:"text-xs text-gray-400",children:["(",x.points.length,")"]})]}),f.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:x.visible?"#f97316":"white",border:x.visible?"2px solid #f97316":"2px solid #fb923c",color:"white"},children:x.visible&&f.jsx(uc,{size:12,strokeWidth:3})})]},x.id))]}),s.length>0&&f.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[f.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:[f.jsx(ix,{size:12,className:"text-cyan-600"}),f.jsx("span",{className:"text-cyan-600 font-medium",style:{fontSize:"0.9em"},children:"Gemporteerde lagen"})]}),s.map(x=>f.jsx(NV,{layer:x,compact:!0},x.id)),f.jsx("button",{onClick:()=>{e(),t()},className:"w-full text-left py-1 pl-3 text-xs text-cyan-500 hover:text-cyan-700 hover:bg-cyan-50 transition-colors",children:"+ Laag importeren..."})]}),f.jsxs("div",{className:"mb-2",children:[f.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1",children:f.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Basislaag"})}),f.jsxs("div",{className:"space-y-0",children:[f.jsx(dt,{name:"CartoDB (licht)",type:"base"}),f.jsx(dt,{name:"OpenStreetMap",type:"base"}),f.jsx(dt,{name:"Luchtfoto",type:"base",hasOverlay:!0}),f.jsx(dt,{name:"TMK 1850",type:"base",hasOverlay:!0}),f.jsx(dt,{name:"Bonnebladen 1900",type:"base",hasOverlay:!0})]})]}),f.jsxs("div",{className:"mb-2",children:[f.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1 border-t border-gray-100 pt-2",children:f.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Thema's"})}),f.jsxs(Fi,{title:"Steentijd & Prehistorie",defaultExpanded:!1,layerNames:["Hunebedden","Grafheuvels","Terpen"],children:[f.jsx(dt,{name:"Hunebedden",type:"overlay"}),f.jsx(dt,{name:"Grafheuvels",type:"overlay"}),f.jsx(dt,{name:"Terpen",type:"overlay"})]}),f.jsxs(Fi,{title:"Paleokaarten",defaultExpanded:!1,layerNames:["Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[f.jsx(dt,{name:"Paleokaart 9000 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 800 n.Chr.",type:"overlay"})]}),f.jsxs(Fi,{title:"Archeologische lagen",defaultExpanded:!1,layerNames:["FAMKE Steentijd","FAMKE IJzertijd","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Archeo Onderzoeken","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[f.jsx(dt,{name:"FAMKE Steentijd",type:"overlay"}),f.jsx(dt,{name:"FAMKE IJzertijd",type:"overlay"}),f.jsx(dt,{name:"AMK Monumenten",type:"overlay"}),f.jsxs(Fi,{title:"AMK per periode",defaultExpanded:!1,layerNames:["AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig"],children:[f.jsx(dt,{name:"AMK Romeins",type:"overlay"}),f.jsx(dt,{name:"AMK Steentijd",type:"overlay"}),f.jsx(dt,{name:"AMK Vroege ME",type:"overlay"}),f.jsx(dt,{name:"AMK Late ME",type:"overlay"}),f.jsx(dt,{name:"AMK Overig",type:"overlay"})]}),f.jsx(dt,{name:"Archeo Onderzoeken",type:"overlay"}),f.jsxs(Fi,{title:"Romeinse tijd",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[f.jsx(dt,{name:"Romeinse wegen (regio)",type:"overlay"}),f.jsx(dt,{name:"Romeinse wegen (Wereld)",type:"overlay"}),f.jsx(dt,{name:"Romeinse Forten",type:"overlay"}),f.jsx(dt,{name:"Romeinse Forten Lijnen",type:"overlay"})]})]}),f.jsxs(Fi,{title:"Archeologische verwachtingen",defaultExpanded:!1,layerNames:["IKAW","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[f.jsx(dt,{name:"IKAW",type:"overlay"}),f.jsx(dt,{name:"UIKAV Punten",type:"overlay"}),f.jsx(dt,{name:"UIKAV Vlakken",type:"overlay"}),f.jsx(dt,{name:"UIKAV Expert",type:"overlay"}),f.jsx(dt,{name:"UIKAV Buffer",type:"overlay"}),f.jsx(dt,{name:"UIKAV Indeling",type:"overlay"})]}),f.jsxs(Fi,{title:"Erfgoed & Monumenten",defaultExpanded:!1,layerNames:["Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Kastelen","Runes"],children:[f.jsx(dt,{name:"Rijksmonumenten",type:"overlay"}),f.jsx(dt,{name:"Werelderfgoed",type:"overlay"}),f.jsx(dt,{name:"Religieus Erfgoed",type:"overlay"}),f.jsx(dt,{name:"Kastelen",type:"overlay"}),f.jsx(dt,{name:"Runes",type:"overlay"})]}),f.jsxs(Fi,{title:"WOII & Militair",defaultExpanded:!1,layerNames:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten","Inundatiegebieden"],children:[f.jsx(dt,{name:"WWII Bunkers",type:"overlay"}),f.jsx(dt,{name:"Slagvelden",type:"overlay"}),f.jsx(dt,{name:"Militaire Vliegvelden",type:"overlay"}),f.jsx(dt,{name:"Verdedigingslinies",type:"overlay"}),f.jsx(dt,{name:"Militaire Objecten",type:"overlay"}),f.jsx(dt,{name:"Inundatiegebieden",type:"overlay"})]}),f.jsxs(Fi,{title:"Hillshade & LiDAR",defaultExpanded:!1,layerNames:["Hoogtekaart (WebGL)","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m"],children:[f.jsx(dt,{name:"Hoogtekaart (WebGL)",type:"overlay"}),f.jsx(dt,{name:"AHN4 Hoogtekaart Kleur",type:"overlay"}),f.jsx(dt,{name:"AHN4 Hillshade NL",type:"overlay"}),f.jsx(dt,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),f.jsx(dt,{name:"AHN 0.5m",type:"overlay"})]}),f.jsxs(Fi,{title:"Terrein & Bodem",defaultExpanded:!1,layerNames:["Veengebieden","Geomorfologie","Bodemkaart","Essen"],children:[f.jsx(dt,{name:"Veengebieden",type:"overlay"}),f.jsx(dt,{name:"Geomorfologie",type:"overlay"}),f.jsx(dt,{name:"Bodemkaart",type:"overlay"}),f.jsx(dt,{name:"Essen",type:"overlay"})]}),f.jsxs(Fi,{title:"Percelen",defaultExpanded:!1,layerNames:["Gewaspercelen","Kadastrale Grenzen"],children:[f.jsx(dt,{name:"Gewaspercelen",type:"overlay"}),f.jsx(dt,{name:"Kadastrale Grenzen",type:"overlay"})]}),f.jsxs(Fi,{title:"Provinciale Thema's",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],children:[f.jsxs(Fi,{title:"Zuid-Holland",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen"],children:[f.jsx(dt,{name:"Scheepswrakken",type:"overlay"}),f.jsx(dt,{name:"Woonheuvels ZH",type:"overlay"}),f.jsx(dt,{name:"Windmolens",type:"overlay"}),f.jsx(dt,{name:"Erfgoedlijnen",type:"overlay"}),f.jsx(dt,{name:"Oude Kernen",type:"overlay"})]}),f.jsxs(Fi,{title:"Gelderland",defaultExpanded:!1,layerNames:["Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken"],children:[f.jsx(dt,{name:"Relictenkaart Punten",type:"overlay"}),f.jsx(dt,{name:"Relictenkaart Lijnen",type:"overlay"}),f.jsx(dt,{name:"Relictenkaart Vlakken",type:"overlay"})]}),f.jsx(Fi,{title:"Zeeland",defaultExpanded:!1,layerNames:["Verdronken Dorpen"],children:f.jsx(dt,{name:"Verdronken Dorpen",type:"overlay"})})]}),f.jsxs(Fi,{title:"Fossielen, Mineralen & Goud",defaultExpanded:!1,layerNames:["Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk"],children:[f.jsx(dt,{name:"Fossiel Hotspots",type:"overlay"}),f.jsx(dt,{name:"Mineralen Hotspots",type:"overlay"}),f.jsx(dt,{name:"Goudrivieren",type:"overlay"}),f.jsx(dt,{name:"Fossielen Nederland",type:"overlay"}),f.jsx(dt,{name:"Fossielen Belgi",type:"overlay"}),f.jsx(dt,{name:"Fossielen Duitsland",type:"overlay"}),f.jsx(dt,{name:"Fossielen Frankrijk",type:"overlay"})]}),f.jsxs(Fi,{title:"Recreatie",defaultExpanded:!1,layerNames:["Ruiterpaden","Laarzenpaden","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels"],children:[f.jsx(dt,{name:"Ruiterpaden",type:"overlay"}),f.jsx(dt,{name:"Laarzenpaden",type:"overlay"}),f.jsx(dt,{name:"Parken",type:"overlay"}),f.jsx(dt,{name:"Speeltuinen",type:"overlay"}),f.jsx(dt,{name:"Musea",type:"overlay"}),f.jsx(dt,{name:"Strandjes",type:"overlay"}),f.jsx(dt,{name:"Kringloopwinkels",type:"overlay"})]}),f.jsxs("div",{className:"mb-2",children:[f.jsxs("button",{onClick:x=>{x.stopPropagation(),m(!g)},className:"w-full flex items-center gap-1 py-1 px-1 hover:bg-purple-50 rounded transition-colors border-0 outline-none bg-transparent",children:[g?f.jsx(nx,{size:14,className:"text-purple-500"}):f.jsx(_g,{size:14,className:"text-purple-500"}),f.jsx(Wce,{size:12,className:"text-purple-500"}),f.jsx("span",{className:"text-purple-600 font-medium",style:{fontSize:"0.95em"},children:"Speciale Projecten"}),f.jsx(Iu,{size:10,className:"text-purple-400 ml-auto"})]}),g&&f.jsxs("div",{className:"mt-1",onClick:x=>x.stopPropagation(),children:[Phe.map(x=>f.jsxs("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",onClick:y=>y.stopPropagation(),className:"w-full flex items-center justify-between py-1.5 pl-6 pr-2 hover:bg-purple-50 rounded transition-colors text-left",style:{fontSize:"inherit"},children:[f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"text-gray-700",children:x.name}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:x.desc})]}),f.jsx(Iu,{size:12,className:"text-purple-400 flex-shrink-0 ml-2"})]},x.name)),f.jsx("div",{className:"border-t border-gray-200 my-1.5 mx-2"}),Nhe.map(x=>f.jsxs("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",onClick:y=>y.stopPropagation(),className:"w-full flex items-center justify-between py-1.5 pl-6 pr-2 hover:bg-purple-50 rounded transition-colors text-left",style:{fontSize:"inherit"},children:[f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"text-gray-700 font-medium",children:x.name}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:x.desc})]}),f.jsx(Iu,{size:12,className:"text-purple-400 flex-shrink-0 ml-2"})]},x.name))]})]})]})]})]})})}function Lhe(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var Ed=1,Sd=2,T0=3,Ohe=4,jR=5,nO=6378137,Dhe=6356752314e-3,rO=.0066943799901413165,ip=484813681109536e-20,Xe=Math.PI/2,jhe=.16666666666666666,Fhe=.04722222222222222,Vhe=.022156084656084655,ct=1e-10,Dr=.017453292519943295,zs=57.29577951308232,Un=Math.PI/4,o1=Math.PI*2,Wr=3.14159265359,Ys={};Ys.greenwich=0;Ys.lisbon=-9.131906111111;Ys.paris=2.337229166667;Ys.bogota=-74.080916666667;Ys.madrid=-3.687938888889;Ys.rome=12.452333333333;Ys.bern=7.439583333333;Ys.jakarta=106.807719444444;Ys.ferro=-17.666666666667;Ys.brussels=4.367975;Ys.stockholm=18.058277777778;Ys.athens=23.7163375;Ys.oslo=10.722916666667;const Bhe={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var iO=/[\s_\-\/\(\)]/g;function Bu(n,e){if(n[e])return n[e];for(var t=Object.keys(n),r=e.toLowerCase().replace(iO,""),i=-1,s,a;++i<t.length;)if(s=t[i],a=s.toLowerCase().replace(iO,""),a===r)return n[s]}function FR(n){var e={},t=n.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,l){var c=l.split("=");return c.push(!0),o[c[0].toLowerCase()]=c[1],o},{}),r,i,s,a={proj:"projName",datum:"datumCode",rf:function(o){e.rf=parseFloat(o)},lat_0:function(o){e.lat0=o*Dr},lat_1:function(o){e.lat1=o*Dr},lat_2:function(o){e.lat2=o*Dr},lat_ts:function(o){e.lat_ts=o*Dr},lon_0:function(o){e.long0=o*Dr},lon_1:function(o){e.long1=o*Dr},lon_2:function(o){e.long2=o*Dr},alpha:function(o){e.alpha=parseFloat(o)*Dr},gamma:function(o){e.rectified_grid_angle=parseFloat(o)*Dr},lonc:function(o){e.longc=o*Dr},x_0:function(o){e.x0=parseFloat(o)},y_0:function(o){e.y0=parseFloat(o)},k_0:function(o){e.k0=parseFloat(o)},k:function(o){e.k0=parseFloat(o)},a:function(o){e.a=parseFloat(o)},b:function(o){e.b=parseFloat(o)},r:function(o){e.a=e.b=parseFloat(o)},r_a:function(){e.R_A=!0},zone:function(o){e.zone=parseInt(o,10)},south:function(){e.utmSouth=!0},towgs84:function(o){e.datum_params=o.split(",").map(function(l){return parseFloat(l)})},to_meter:function(o){e.to_meter=parseFloat(o)},units:function(o){e.units=o;var l=Bu(Bhe,o);l&&(e.to_meter=l.to_meter)},from_greenwich:function(o){e.from_greenwich=o*Dr},pm:function(o){var l=Bu(Ys,o);e.from_greenwich=(l||parseFloat(o))*Dr},nadgrids:function(o){o==="@null"?e.datumCode="none":e.nadgrids=o},axis:function(o){var l="ewnsud";o.length===3&&l.indexOf(o.substr(0,1))!==-1&&l.indexOf(o.substr(1,1))!==-1&&l.indexOf(o.substr(2,1))!==-1&&(e.axis=o)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in t)i=t[r],r in a?(s=a[r],typeof s=="function"?s(i):e[s]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class MV{static getId(e){const t=e.find(r=>Array.isArray(r)&&r[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const r=e[1],i=parseFloat(e[2])||null,s=e.find(o=>Array.isArray(o)&&o[0]==="ID"),a=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:r,conversion_factor:i,id:a}}static convertAxis(e){const t=e[1]||"Unknown";let r;const i=t.match(/^\((.)\)$/);if(i){const c=i[1].toUpperCase();if(c==="E")r="east";else if(c==="N")r="north";else if(c==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${c}`)}else r=e[2]?e[2].toLowerCase():"unknown";const s=e.find(c=>Array.isArray(c)&&c[0]==="ORDER"),a=s?parseInt(s[1],10):null,o=e.find(c=>Array.isArray(c)&&(c[0]==="LENGTHUNIT"||c[0]==="ANGLEUNIT"||c[0]==="SCALEUNIT")),l=this.convertUnit(o);return{name:t,direction:r,unit:l,order:a}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,r)=>(t.order||0)-(r.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")):null,t.conversion=e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")):null;const r=e.find(m=>Array.isArray(m)&&m[0]==="CS");r&&(t.coordinate_system={type:r[1],axis:this.extractAxes(e)});const i=e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT");if(i){const m=this.convertUnit(i);t.coordinate_system.unit=m}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(m=>Array.isArray(m)&&(m[0]==="DATUM"||m[0]==="ENSEMBLE"));if(s){const m=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=m:t.datum=m;const x=e.find(y=>Array.isArray(y)&&y[0]==="PRIMEM");x&&x[1]!=="Greenwich"&&(m.prime_meridian={name:x[1],longitude:parseFloat(x[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(m=>Array.isArray(m)&&m[0]==="MEMBER").map(m=>({type:"DatumEnsembleMember",name:m[1],id:this.getId(m)}));const a=e.find(m=>Array.isArray(m)&&m[0]==="ENSEMBLEACCURACY");a&&(t.accuracy=parseFloat(a[1]));const o=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID");o&&(t.ellipsoid=this.convert(o)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT")&&this.convert(e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&m[0]==="PARAMETER").map(m=>this.convert(m));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(m=>Array.isArray(m)&&(m[0]==="LENGTHUNIT"||m[0]==="ANGLEUNIT"||m[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const l=e.find(m=>Array.isArray(m)&&m[0]==="SOURCECRS");if(l){const m=l.find(x=>Array.isArray(x));t.source_crs=m?this.convert(m):null}const c=e.find(m=>Array.isArray(m)&&m[0]==="TARGETCRS");if(c){const m=c.find(x=>Array.isArray(x));t.target_crs=m?this.convert(m):null}const h=e.find(m=>Array.isArray(m)&&m[0]==="ABRIDGEDTRANSFORMATION");h?t.transformation=this.convert(h):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&(m[0]==="PARAMETER"||m[0]==="PARAMETERFILE")).map(m=>{if(m[0]==="PARAMETER")return this.convert(m);if(m[0]==="PARAMETERFILE")return{name:m[1],value:m[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const m=t.parameters[6];m.name==="Scale difference"&&(m.value=Math.round((m.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const g=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(m=>{m.unit||(m.unit=g)}),g.conversion_factor&&g.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:g});break;default:t.keyword=e[0];break}return t}}class Ghe extends MV{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class zhe extends MV{static convert(e,t={}){super.convert(e,t);const r=e.find(s=>Array.isArray(s)&&s[0]==="CS");r&&(t.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const i=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(i){const s=i.find(l=>Array.isArray(l)&&l[0]==="SCOPE"),a=i.find(l=>Array.isArray(l)&&l[0]==="AREA"),o=i.find(l=>Array.isArray(l)&&l[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),a&&(t.usage.area=a[1]),o&&(t.usage.bbox=o.slice(1))}return t}}function Uhe(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function $he(n){return(Uhe(n)==="2019"?zhe:Ghe).convert(n)}function Whe(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var l1=1,LV=2,OV=3,Hv=4,DV=5,YI=-1,Hhe=/\s/,Khe=/[A-Za-z]/,Xhe=/[A-Za-z84_]/,DE=/[,\]]/,jV=/[\d\.E\-\+]/;function vc(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=l1}vc.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==Hv)for(;Hhe.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case l1:return this.neutral(n);case LV:return this.keyword(n);case Hv:return this.quoted(n);case DV:return this.afterquote(n);case OV:return this.number(n);case YI:return}};vc.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=Hv;return}if(DE.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};vc.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=l1;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=l1,this.currentObject=this.stack.pop(),this.currentObject||(this.state=YI);return}};vc.prototype.number=function(n){if(jV.test(n)){this.word+=n;return}if(DE.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};vc.prototype.quoted=function(n){if(n==='"'){this.state=DV;return}this.word+=n};vc.prototype.keyword=function(n){if(Xhe.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=l1;return}if(DE.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};vc.prototype.neutral=function(n){if(Khe.test(n)){this.word=n,this.state=LV;return}if(n==='"'){this.word="",this.state=Hv;return}if(jV.test(n)){this.word=n,this.state=OV;return}if(DE.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};vc.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===YI)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function qhe(n){var e=new vc(n);return e.output()}function DT(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var r=e?{}:n,i=t.reduce(function(s,a){return u0(a,s),s},r);e&&(n[e]=i)}function u0(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},u0(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var r;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&u0(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&u0(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],DT(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],DT(e,t,n),e[t].type=t;return;default:for(r=-1;++r<n.length;)if(!Array.isArray(n[r]))return u0(n,e[t]);return DT(e,t,n)}}var Yhe=.017453292519943295;function lo(n){return n*Yhe}function FV(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=lo(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=lo(n.lat0>0?90:-90),delete n.lat1)}function sO(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function aO(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function oO(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=aO(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-aO(n.ellipsoid.semi_minor_axis))))}function Kv(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(Kv(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const r=n[t];if(r!==null)switch(t){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,oO(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,oO(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(i=>{const s=i.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",r.unit){const{units:i,to_meter:s}=sO(r.unit);e.units=i,e.to_meter=s}else if(r.axis[0]&&r.axis[0].unit){const{units:i,to_meter:s}=sO(r.axis[0].unit);e.units=i,e.to_meter=s}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(i=>{const s=i.name.toLowerCase().replace(/\s+/g,"_"),a=i.value;i.unit&&i.unit.conversion_factor?e[s]=a*i.unit.conversion_factor:i.unit==="degree"?e[s]=a*Math.PI/180:e[s]=a});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":Kv(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),FV(e),e)}var Zhe=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Jhe(n,e){var t=e[0],r=e[1];!(t in n)&&r in n&&(n[t]=n[r],e.length===3&&(n[t]=e[2](n[t])))}function VV(n){for(var e=Object.keys(n),t=0,r=e.length;t<r;++t){var i=e[t];Zhe.indexOf(i)!==-1&&Qhe(n[i]),typeof n[i]=="object"&&VV(n[i])}}function Qhe(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",r=0,i=n.AXIS.length;r<i;++r){var s=[n.AXIS[r][0].toLowerCase(),n.AXIS[r][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var a=n.GEOGCS;n.type==="GEOGCS"&&(a=n),a&&(a.DATUM?n.datumCode=a.DATUM.name.toLowerCase():n.datumCode=a.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(n.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=a.DATUM.SPHEROID.a,n.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(n.datum_params=a.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=lo(n.rectified_grid_angle));function o(h){var g=n.to_meter||1;return h*g}var l=function(h){return Jhe(n,h)},c=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",lo],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",lo],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",lo],["lat0","latitude_of_origin",lo],["lat0","standard_parallel_1",lo],["lat1","standard_parallel_1",lo],["lat2","standard_parallel_2",lo],["azimuth","Azimuth"],["alpha","azimuth",lo],["srsCode","name"]];c.forEach(l),FV(n)}function Xv(n){if(typeof n=="object")return Kv(n);const e=Whe(n);var t=qhe(n);if(e==="WKT2"){const s=$he(t);return Kv(s)}var r=t[0],i={};return u0(t,i),VV(i),i[r]}function Bi(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?Bi[n]=FR(arguments[1]):Bi[n]=Xv(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?Bi[n]=Xv(arguments[1]):(Bi[n]=t,t||delete Bi[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(r){return Array.isArray(r)?Bi.apply(e,r):Bi(r)});if(typeof n=="string"){if(n in Bi)return Bi[n]}else"EPSG"in n?Bi["EPSG:"+n.EPSG]=n:"ESRI"in n?Bi["ESRI:"+n.ESRI]=n:"IAU2000"in n?Bi["IAU2000:"+n.IAU2000]=n:console.log(n);return}}Lhe(Bi);function ede(n){return typeof n=="string"}function tde(n){return n in Bi}function nde(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var rde=["3857","900913","3785","102113"];function ide(n){var e=Bu(n,"authority");if(e){var t=Bu(e,"epsg");return t&&rde.indexOf(t)>-1}}function sde(n){var e=Bu(n,"extension");if(e)return Bu(e,"proj4")}function ade(n){return n[0]==="+"}function ode(n){if(ede(n)){if(tde(n))return Bi[n];if(nde(n)){var e=Xv(n);if(ide(e))return Bi["EPSG:3857"];var t=sde(e);return t?FR(t):e}if(ade(n))return FR(n)}else return"projName"in n?n:Xv(n)}function lO(n,e){n=n||{};var t,r;if(!e)return n;for(r in e)t=e[r],t!==void 0&&(n[r]=t);return n}function pl(n,e,t){var r=n*e;return t/Math.sqrt(1-r*r)}function sx(n){return n<0?-1:1}function mt(n,e){return e||Math.abs(n)<=Wr?n:n-sx(n)*o1}function Eo(n,e,t){var r=n*t,i=.5*n;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(Xe-e))/r}function c1(n,e){for(var t=.5*n,r,i,s=Xe-2*Math.atan(e),a=0;a<=15;a++)if(r=n*Math.sin(s),i=Xe-2*Math.atan(e*Math.pow((1-r)/(1+r),t))-s,s+=i,Math.abs(i)<=1e-10)return s;return-9999}function lde(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=pl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function cde(n){var e=n.x,t=n.y;if(t*zs>90&&t*zs<-90&&e*zs>180&&e*zs<-180)return null;var r,i;if(Math.abs(Math.abs(t)-Xe)<=ct)return null;if(this.sphere)r=this.x0+this.a*this.k0*mt(e-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(Un+.5*t));else{var s=Math.sin(t),a=Eo(this.e,t,s);r=this.x0+this.a*this.k0*mt(e-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(a)}return n.x=r,n.y=i,n}function ude(n){var e=n.x-this.x0,t=n.y-this.y0,r,i;if(this.sphere)i=Xe-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(i=c1(this.e,s),i===-9999)return null}return r=mt(this.long0+e/(this.a*this.k0),this.over),n.x=r,n.y=i,n}var hde=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const dde={init:lde,forward:cde,inverse:ude,names:hde};function fde(){}function cO(n){return n}var BV=["longlat","identity"];const gde={init:fde,forward:cO,inverse:cO,names:BV};var mde=[dde,gde],Mh={},h0=[];function GV(n,e){var t=h0.length;return n.names?(h0[t]=n,n.names.forEach(function(r){Mh[r.toLowerCase()]=t}),this):(console.log(e),!0)}function zV(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function pde(n){if(!n)return!1;var e=n.toLowerCase();if(typeof Mh[e]<"u"&&h0[Mh[e]]||(e=zV(e),e in Mh&&h0[Mh[e]]))return h0[Mh[e]]}function xde(){mde.forEach(GV)}const yde={start:xde,add:GV,get:pde};var UV={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const _de=UV.WGS84;function vde(n,e,t,r){var i=n*n,s=e*e,a=(i-s)/i,o=0;r?(n*=1-a*(jhe+a*(Fhe+a*Vhe)),i=n*n,a=0):o=Math.sqrt(a);var l=(i-s)/s;return{es:a,e:o,ep2:l}}function wde(n,e,t,r,i){if(!n){var s=Bu(UV,r);s||(s=_de),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<ct)&&(i=!0,e=n),{a:n,b:e,rf:t,sphere:i}}var C_={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var Ede in C_){var jT=C_[Ede];jT.datumName&&(C_[jT.datumName]=jT)}function Sde(n,e,t,r,i,s,a){var o={};return n===void 0||n==="none"?o.datum_type=jR:o.datum_type=Ohe,e&&(o.datum_params=e.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=Ed),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=Sd,o.datum_params[3]*=ip,o.datum_params[4]*=ip,o.datum_params[5]*=ip,o.datum_params[6]=o.datum_params[6]/1e6+1)),a&&(o.datum_type=T0,o.grids=a),o.a=t,o.b=r,o.es=i,o.ep2=s,o}var ZI={};function Tde(n,e,t){return e instanceof ArrayBuffer?bde(n,e,t):{ready:Rde(n,e)}}function bde(n,e,t){var r=!0;t!==void 0&&t.includeErrorFields===!1&&(r=!1);var i=new DataView(e),s=Ide(i),a=Cde(i,s),o=Pde(i,a,s,r),l={header:a,subgrids:o};return ZI[n]=l,l}async function Rde(n,e){for(var t=[],r=await e.getImageCount(),i=r-1;i>=0;i--){var s=await e.getImage(i),a=await s.readRasters(),o=a,l=[s.getWidth(),s.getHeight()],c=s.getBoundingBox().map(uO),h=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(uO),g=c[0]+(l[0]-1)*h[0],m=c[3]-(l[1]-1)*h[1],x=o[0],y=o[1],_=[];for(let b=l[1]-1;b>=0;b--)for(let R=l[0]-1;R>=0;R--){var w=b*l[0]+R;_.push([-xu(y[w]),xu(x[w])])}t.push({del:h,lim:l,ll:[-g,m],cvs:_})}var T={header:{nSubgrids:r},subgrids:t};return ZI[n]=T,T}function Ade(n){if(n===void 0)return null;var e=n.split(",");return e.map(kde)}function kde(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:ZI[n]||null,isNull:!1}}function uO(n){return n*Math.PI/180}function xu(n){return n/3600*Math.PI/180}function Ide(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function Cde(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:VR(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function VR(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function Pde(n,e,t,r){for(var i=176,s=[],a=0;a<e.nSubgrids;a++){var o=Mde(n,i,t),l=Lde(n,i,o,t,r),c=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),h=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);s.push({ll:[xu(o.lowerLongitude),xu(o.lowerLatitude)],del:[xu(o.longitudeInterval),xu(o.latitudeInterval)],lim:[c,h],count:o.gridNodeCount,cvs:Nde(l)});var g=16;r===!1&&(g=8),i+=176+o.gridNodeCount*g}return s}function Nde(n){return n.map(function(e){return[xu(e.longitudeShift),xu(e.latitudeShift)]})}function Mde(n,e,t){return{name:VR(n,e+8,e+16).trim(),parent:VR(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function Lde(n,e,t,r,i){var s=e+176,a=16;i===!1&&(a=8);for(var o=[],l=0;l<t.gridNodeCount;l++){var c={latitudeShift:n.getFloat32(s+l*a,r),longitudeShift:n.getFloat32(s+l*a+4,r)};i!==!1&&(c.latitudeAccuracy=n.getFloat32(s+l*a+8,r),c.longitudeAccuracy=n.getFloat32(s+l*a+12,r)),o.push(c)}return o}function Ua(n,e){if(!(this instanceof Ua))return new Ua(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(c){if(c)throw c};var t=ode(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var r=Ua.projections.get(t.projName);if(!r){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var i=Bu(C_,t.datumCode);i&&(t.datum_params=t.datum_params||(i.towgs84?i.towgs84.split(","):null),t.ellps=i.ellipse,t.datumName=i.datumName?i.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=wde(t.a,t.b,t.rf,t.ellps,t.sphere),a=vde(s.a,s.b,s.rf,t.R_A),o=Ade(t.nadgrids),l=t.datum||Sde(t.datumCode,t.datum_params,s.a,s.b,a.es,a.ep2,o);lO(this,t),lO(this,r),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=l,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}Ua.projections=yde;Ua.projections.start();function Ode(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===Ed?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===Sd?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function $V(n,e,t){var r=n.x,i=n.y,s=n.z?n.z:0,a,o,l,c;if(i<-Xe&&i>-1.001*Xe)i=-Xe;else if(i>Xe&&i<1.001*Xe)i=Xe;else{if(i<-Xe)return{x:-1/0,y:-1/0,z:n.z};if(i>Xe)return{x:1/0,y:1/0,z:n.z}}return r>Math.PI&&(r-=2*Math.PI),o=Math.sin(i),c=Math.cos(i),l=o*o,a=t/Math.sqrt(1-e*l),{x:(a+s)*c*Math.cos(r),y:(a+s)*c*Math.sin(r),z:(a*(1-e)+s)*o}}function WV(n,e,t,r){var i=1e-12,s=i*i,a=30,o,l,c,h,g,m,x,y,_,w,T,b,R,M=n.x,D=n.y,B=n.z?n.z:0,k,A,C;if(o=Math.sqrt(M*M+D*D),l=Math.sqrt(M*M+D*D+B*B),o/t<i){if(k=0,l/t<i)return A=Xe,C=-r,{x:n.x,y:n.y,z:n.z}}else k=Math.atan2(D,M);c=B/l,h=o/l,g=1/Math.sqrt(1-e*(2-e)*h*h),y=h*(1-e)*g,_=c*g,R=0;do R++,x=t/Math.sqrt(1-e*_*_),C=o*y+B*_-x*(1-e*_*_),m=e*x/(x+C),g=1/Math.sqrt(1-m*(2-m)*h*h),w=h*(1-m)*g,T=c*g,b=T*y-w*_,y=w,_=T;while(b*b>s&&R<a);return A=Math.atan(T/Math.abs(w)),{x:k,y:A,z:C}}function Dde(n,e,t){if(e===Ed)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===Sd){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6];return{x:c*(n.x-l*n.y+o*n.z)+r,y:c*(l*n.x+n.y-a*n.z)+i,z:c*(-o*n.x+a*n.y+n.z)+s}}}function jde(n,e,t){if(e===Ed)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===Sd){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=(n.x-r)/c,g=(n.y-i)/c,m=(n.z-s)/c;return{x:h+l*g-o*m,y:-l*h+g+a*m,z:o*h-a*g+m}}}function Ky(n){return n===Ed||n===Sd}function Fde(n,e,t){if(Ode(n,e)||n.datum_type===jR||e.datum_type===jR)return t;var r=n.a,i=n.es;if(n.datum_type===T0){var s=hO(n,!1,t);if(s!==0)return;r=nO,i=rO}var a=e.a,o=e.b,l=e.es;if(e.datum_type===T0&&(a=nO,o=Dhe,l=rO),i===l&&r===a&&!Ky(n.datum_type)&&!Ky(e.datum_type))return t;if(t=$V(t,i,r),Ky(n.datum_type)&&(t=Dde(t,n.datum_type,n.datum_params)),Ky(e.datum_type)&&(t=jde(t,e.datum_type,e.datum_params)),t=WV(t,l,a,o),e.datum_type===T0){var c=hO(e,!0,t);if(c!==0)return}return t}function hO(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-t.x,y:t.y},i={x:Number.NaN,y:Number.NaN},s=[];e:for(var a=0;a<n.grids.length;a++){var o=n.grids[a];if(s.push(o.name),o.isNull){i=r;break}if(o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}for(var l=o.grid.subgrids,c=0,h=l.length;c<h;c++){var g=l[c],m=(Math.abs(g.del[1])+Math.abs(g.del[0]))/1e4,x=g.ll[0]-m,y=g.ll[1]-m,_=g.ll[0]+(g.lim[0]-1)*g.del[0]+m,w=g.ll[1]+(g.lim[1]-1)*g.del[1]+m;if(!(y>r.y||x>r.x||w<r.y||_<r.x)&&(i=Vde(r,e,g),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*zs+" "+r.y*zs+" tried: '"+s+"'"),-1):(t.x=-i.x,t.y=i.y,0)}function Vde(n,e,t){var r={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return r;var i={x:n.x,y:n.y};i.x-=t.ll[0],i.y-=t.ll[1],i.x=mt(i.x-Math.PI)+Math.PI;var s=dO(i,t);if(e){if(isNaN(s.x))return r;s.x=i.x-s.x,s.y=i.y-s.y;var a=9,o=1e-12,l,c;do{if(c=dO(s,t),isNaN(c.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:i.x-(c.x+s.x),y:i.y-(c.y+s.y)},s.x+=l.x,s.y+=l.y}while(a--&&Math.abs(l.x)>o&&Math.abs(l.y)>o);if(a<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=mt(s.x+t.ll[0]),r.y=s.y+t.ll[1]}else isNaN(s.x)||(r.x=n.x+s.x,r.y=n.y+s.y);return r}function dO(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},r={x:Math.floor(t.x),y:Math.floor(t.y)},i={x:t.x-1*r.x,y:t.y-1*r.y},s={x:Number.NaN,y:Number.NaN},a;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return s;a=r.y*e.lim[0]+r.x;var o={x:e.cvs[a][0],y:e.cvs[a][1]};a++;var l={x:e.cvs[a][0],y:e.cvs[a][1]};a+=e.lim[0];var c={x:e.cvs[a][0],y:e.cvs[a][1]};a--;var h={x:e.cvs[a][0],y:e.cvs[a][1]},g=i.x*i.y,m=i.x*(1-i.y),x=(1-i.x)*(1-i.y),y=(1-i.x)*i.y;return s.x=x*o.x+m*l.x+y*h.x+g*c.x,s.y=x*o.y+m*l.y+y*h.y+g*c.y,s}function fO(n,e,t){var r=t.x,i=t.y,s=t.z||0,a,o,l,c={};for(l=0;l<3;l++)if(!(e&&l===2&&t.z===void 0))switch(l===0?(a=r,"ew".indexOf(n.axis[l])!==-1?o="x":o="y"):l===1?(a=i,"ns".indexOf(n.axis[l])!==-1?o="y":o="x"):(a=s,o="z"),n.axis[l]){case"e":c[o]=a;break;case"w":c[o]=-a;break;case"n":c[o]=a;break;case"s":c[o]=-a;break;case"u":t[o]!==void 0&&(c.z=a);break;case"d":t[o]!==void 0&&(c.z=-a);break;default:return null}return c}function HV(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function Bde(n){gO(n.x),gO(n.y)}function gO(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function Gde(n,e){return(n.datum.datum_type===Ed||n.datum.datum_type===Sd||n.datum.datum_type===T0)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Ed||e.datum.datum_type===Sd||e.datum.datum_type===T0)&&n.datumCode!=="WGS84"}function qv(n,e,t,r){var i;Array.isArray(t)?t=HV(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if(Bde(t),n.datum&&e.datum&&Gde(n,e)&&(i=new Ua("WGS84"),t=qv(n,i,t,r),n=i),r&&n.axis!=="enu"&&(t=fO(n,!1,t)),n.projName==="longlat")t={x:t.x*Dr,y:t.y*Dr,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=Fde(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*zs,y:t.y*zs,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),r&&e.axis!=="enu"?fO(e,!0,t):(t&&!s&&delete t.z,t)}var mO=Ua("WGS84");function FT(n,e,t,r){var i,s,a;return Array.isArray(t)?(i=qv(n,e,t,r)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(t.slice(3)):[i.x,i.y,t[2]].concat(t.slice(3)):[i.x,i.y].concat(t.slice(2)):[i.x,i.y]):(s=qv(n,e,t,r),a=Object.keys(t),a.length===2||a.forEach(function(o){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;s[o]=t[o]}),s)}function Xy(n){return n instanceof Ua?n:typeof n=="object"&&"oProj"in n?n.oProj:Ua(n)}function zde(n,e,t){var r,i,s=!1,a;return typeof e>"u"?(i=Xy(n),r=mO,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,i=Xy(n),r=mO,s=!0),r||(r=Xy(n)),i||(i=Xy(e)),t?FT(r,i,t):(a={forward:function(o,l){return FT(r,i,o,l)},inverse:function(o,l){return FT(i,r,o,l)}},s&&(a.oProj=i),a)}var pO=6,KV="AJSAJS",XV="AFAFAF",d0=65,Ls=73,Pa=79,Dm=86,jm=90;const Ude={forward:qV,inverse:$de,toPoint:YV};function qV(n,e){return e=e||5,Kde(Wde({lat:n[1],lon:n[0]}),e)}function $de(n){var e=JI(JV(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function YV(n){var e=JI(JV(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function VT(n){return n*(Math.PI/180)}function xO(n){return 180*(n/Math.PI)}function Wde(n){var e=n.lat,t=n.lon,r=6378137,i=.00669438,s=.9996,a,o,l,c,h,g,m,x=VT(e),y=VT(t),_,w;w=Math.floor((t+180)/6)+1,t===180&&(w=60),e>=56&&e<64&&t>=3&&t<12&&(w=32),e>=72&&e<84&&(t>=0&&t<9?w=31:t>=9&&t<21?w=33:t>=21&&t<33?w=35:t>=33&&t<42&&(w=37)),a=(w-1)*6-180+3,_=VT(a),o=i/(1-i),l=r/Math.sqrt(1-i*Math.sin(x)*Math.sin(x)),c=Math.tan(x)*Math.tan(x),h=o*Math.cos(x)*Math.cos(x),g=Math.cos(x)*(y-_),m=r*((1-i/4-3*i*i/64-5*i*i*i/256)*x-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*x)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*x)-35*i*i*i/3072*Math.sin(6*x));var T=s*l*(g+(1-c+h)*g*g*g/6+(5-18*c+c*c+72*h-58*o)*g*g*g*g*g/120)+5e5,b=s*(m+l*Math.tan(x)*(g*g/2+(5-c+9*h+4*h*h)*g*g*g*g/24+(61-58*c+c*c+600*h-330*o)*g*g*g*g*g*g/720));return e<0&&(b+=1e7),{northing:Math.round(b),easting:Math.round(T),zoneNumber:w,zoneLetter:Hde(e)}}function JI(n){var e=n.northing,t=n.easting,r=n.zoneLetter,i=n.zoneNumber;if(i<0||i>60)return null;var s=.9996,a=6378137,o=.00669438,l,c=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),h,g,m,x,y,_,w,T,b,R=t-5e5,M=e;r<"N"&&(M-=1e7),w=(i-1)*6-180+3,l=o/(1-o),_=M/s,T=_/(a*(1-o/4-3*o*o/64-5*o*o*o/256)),b=T+(3*c/2-27*c*c*c/32)*Math.sin(2*T)+(21*c*c/16-55*c*c*c*c/32)*Math.sin(4*T)+151*c*c*c/96*Math.sin(6*T),h=a/Math.sqrt(1-o*Math.sin(b)*Math.sin(b)),g=Math.tan(b)*Math.tan(b),m=l*Math.cos(b)*Math.cos(b),x=a*(1-o)/Math.pow(1-o*Math.sin(b)*Math.sin(b),1.5),y=R/(h*s);var D=b-h*Math.tan(b)/x*(y*y/2-(5+3*g+10*m-4*m*m-9*l)*y*y*y*y/24+(61+90*g+298*m+45*g*g-252*l-3*m*m)*y*y*y*y*y*y/720);D=xO(D);var B=(y-(1+2*g+m)*y*y*y/6+(5-2*m+28*g-3*m*m+8*l+24*g*g)*y*y*y*y*y/120)/Math.cos(b);B=w+xO(B);var k;if(n.accuracy){var A=JI({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});k={top:A.lat,right:A.lon,bottom:D,left:B}}else k={lat:D,lon:B};return k}function Hde(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function Kde(n,e){var t="00000"+n.easting,r="00000"+n.northing;return n.zoneNumber+n.zoneLetter+Xde(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+r.substr(r.length-5,e)}function Xde(n,e,t){var r=ZV(t),i=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return qde(i,s,r)}function ZV(n){var e=n%pO;return e===0&&(e=pO),e}function qde(n,e,t){var r=t-1,i=KV.charCodeAt(r),s=XV.charCodeAt(r),a=i+n-1,o=s+e,l=!1;a>jm&&(a=a-jm+d0-1,l=!0),(a===Ls||i<Ls&&a>Ls||(a>Ls||i<Ls)&&l)&&a++,(a===Pa||i<Pa&&a>Pa||(a>Pa||i<Pa)&&l)&&(a++,a===Ls&&a++),a>jm&&(a=a-jm+d0-1),o>Dm?(o=o-Dm+d0-1,l=!0):l=!1,(o===Ls||s<Ls&&o>Ls||(o>Ls||s<Ls)&&l)&&o++,(o===Pa||s<Pa&&o>Pa||(o>Pa||s<Pa)&&l)&&(o++,o===Ls&&o++),o>Dm&&(o=o-Dm+d0-1);var c=String.fromCharCode(a)+String.fromCharCode(o);return c}function JV(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,r="",i,s=0;!/[A-Z]/.test(i=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;r+=i,s++}var a=parseInt(r,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var o=n.charAt(s++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+n;t=n.substring(s,s+=2);for(var l=ZV(a),c=Yde(t.charAt(0),l),h=Zde(t.charAt(1),l);h<Jde(o);)h+=2e6;var g=e-s;if(g%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var m=g/2,x=0,y=0,_,w,T,b,R;return m>0&&(_=1e5/Math.pow(10,m),w=n.substring(s,s+m),x=parseFloat(w)*_,T=n.substring(s+m),y=parseFloat(T)*_),b=x+c,R=y+h,{easting:b,northing:R,zoneLetter:o,zoneNumber:a,accuracy:_}}function Yde(n,e){for(var t=KV.charCodeAt(e-1),r=1e5,i=!1;t!==n.charCodeAt(0);){if(t++,t===Ls&&t++,t===Pa&&t++,t>jm){if(i)throw"Bad character: "+n;t=d0,i=!0}r+=1e5}return r}function Zde(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=XV.charCodeAt(e-1),r=0,i=!1;t!==n.charCodeAt(0);){if(t++,t===Ls&&t++,t===Pa&&t++,t>Dm){if(i)throw"Bad character: "+n;t=d0,i=!0}r+=1e5}return r}function Jde(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function sg(n,e,t){if(!(this instanceof sg))return new sg(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var r=n.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}sg.fromMGRS=function(n){return new sg(YV(n))};sg.prototype.toMGRS=function(n){return qV([this.x,this.y],n)};var Qde=1,efe=.25,yO=.046875,_O=.01953125,vO=.01068115234375,tfe=.75,nfe=.46875,rfe=.013020833333333334,ife=.007120768229166667,sfe=.3645833333333333,afe=.005696614583333333,ofe=.3076171875;function QI(n){var e=[];e[0]=Qde-n*(efe+n*(yO+n*(_O+n*vO))),e[1]=n*(tfe-n*(yO+n*(_O+n*vO)));var t=n*n;return e[2]=t*(nfe-n*(rfe+n*ife)),t*=n,e[3]=t*(sfe-n*afe),e[4]=t*n*ofe,e}function vg(n,e,t,r){return t*=e,e*=e,r[0]*n-t*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var lfe=20;function eC(n,e,t){for(var r=1/(1-e),i=n,s=lfe;s;--s){var a=Math.sin(i),o=1-e*a*a;if(o=(vg(i,a,Math.cos(i),t)-n)*(o*Math.sqrt(o))*r,i-=o,Math.abs(o)<ct)return i}return i}function cfe(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=QI(this.es),this.ml0=vg(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function ufe(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i,s,a,o=Math.sin(t),l=Math.cos(t);if(this.es){var h=l*r,g=Math.pow(h,2),m=this.ep2*Math.pow(l,2),x=Math.pow(m,2),y=Math.abs(l)>ct?Math.tan(t):0,_=Math.pow(y,2),w=Math.pow(_,2);i=1-this.es*Math.pow(o,2),h=h/Math.sqrt(i);var T=vg(t,o,l,this.en);s=this.a*(this.k0*h*(1+g/6*(1-_+m+g/20*(5-18*_+w+14*m-58*_*m+g/42*(61+179*w-w*_-479*_)))))+this.x0,a=this.a*(this.k0*(T-this.ml0+o*r*h/2*(1+g/12*(5-_+9*m+4*x+g/30*(61+w-58*_+270*m-330*_*m+g/56*(1385+543*w-w*_-3111*_))))))+this.y0}else{var c=l*Math.sin(r);if(Math.abs(Math.abs(c)-1)<ct)return 93;if(s=.5*this.a*this.k0*Math.log((1+c)/(1-c))+this.x0,a=l*Math.cos(r)/Math.sqrt(1-Math.pow(c,2)),c=Math.abs(a),c>=1){if(c-1>ct)return 93;a=0}else a=Math.acos(a);t<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return n.x=s,n.y=a,n}function hfe(n){var e,t,r,i,s=(n.x-this.x0)*(1/this.a),a=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,t=eC(e,this.es,this.en),Math.abs(t)<Xe){var g=Math.sin(t),m=Math.cos(t),x=Math.abs(m)>ct?Math.tan(t):0,y=this.ep2*Math.pow(m,2),_=Math.pow(y,2),w=Math.pow(x,2),T=Math.pow(w,2);e=1-this.es*Math.pow(g,2);var b=s*Math.sqrt(e)/this.k0,R=Math.pow(b,2);e=e*x,r=t-e*R/(1-this.es)*.5*(1-R/12*(5+3*w-9*y*w+y-4*_-R/30*(61+90*w-252*y*w+45*T+46*y-R/56*(1385+3633*w+4095*T+1574*T*w)))),i=mt(this.long0+b*(1-R/6*(1+2*w+y-R/20*(5+28*w+24*T+8*y*w+6*y-R/42*(61+662*w+1320*T+720*T*w))))/m,this.over)}else r=Xe*sx(a),i=0;else{var o=Math.exp(s/this.k0),l=.5*(o-1/o),c=this.lat0+a/this.k0,h=Math.cos(c);e=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(l,2))),r=Math.asin(e),a<0&&(r=-r),l===0&&h===0?i=0:i=mt(Math.atan2(l,h)+this.long0,this.over)}return n.x=i,n.y=r,n}var dfe=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const P_={init:cfe,forward:ufe,inverse:hfe,names:dfe};function QV(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function Bs(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),r=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(r,2))}function ffe(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function gfe(n){var e=Math.abs(n);return e=ffe(e*(1+e/(Bs(1,e)+1))),n<0?-e:e}function tC(n,e){for(var t=2*Math.cos(2*e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return e+a*Math.sin(2*e)}function mfe(n,e){for(var t=2*Math.cos(e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return Math.sin(e)*a}function pfe(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function eB(n,e,t){for(var r=Math.sin(e),i=Math.cos(e),s=QV(t),a=pfe(t),o=2*i*a,l=-2*r*s,c=n.length-1,h=n[c],g=0,m=0,x=0,y,_;--c>=0;)y=m,_=g,m=h,g=x,h=-y+o*m-l*g+n[c],x=-_+l*m+o*g;return o=r*a,l=i*s,[o*h-l*x,o*x+l*h]}function xfe(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(P_.init.apply(this),this.forward=P_.forward,this.inverse=P_.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var r=tC(this.cbg,this.lat0);this.Zb=-this.Qn*(r+mfe(this.gtu,2*r))}function yfe(n){var e=mt(n.x-this.long0,this.over),t=n.y;t=tC(this.cbg,t);var r=Math.sin(t),i=Math.cos(t),s=Math.sin(e),a=Math.cos(e);t=Math.atan2(r,a*i),e=Math.atan2(s*i,Bs(r,i*a)),e=gfe(Math.tan(e));var o=eB(this.gtu,2*t,2*e);t=t+o[0],e=e+o[1];var l,c;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,c=this.a*(this.Qn*t+this.Zb)+this.y0):(l=1/0,c=1/0),n.x=l,n.y=c,n}function _fe(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var s=eB(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(QV(e));var a=Math.sin(t),o=Math.cos(t),l=Math.sin(e),c=Math.cos(e);t=Math.atan2(a*c,Bs(l,c*o)),e=Math.atan2(l,c*o),r=mt(e+this.long0,this.over),i=tC(this.cgb,t)}else r=1/0,i=1/0;return n.x=r,n.y=i,n}var vfe=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const N_={init:xfe,forward:yfe,inverse:_fe,names:vfe};function wfe(n,e){if(n===void 0){if(n=Math.floor((mt(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var Efe="etmerc";function Sfe(){var n=wfe(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*Dr,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,N_.init.apply(this),this.forward=N_.forward,this.inverse=N_.inverse}var Tfe=["Universal Transverse Mercator System","utm"];const bfe={init:Sfe,names:Tfe,dependsOn:Efe};function nC(n,e){return Math.pow((1-n)/(1+n),e)}var Rfe=20;function Afe(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Un)/(Math.pow(Math.tan(.5*this.lat0+Un),this.C)*nC(this.e*n,this.ratexp))}function kfe(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+Un),this.C)*nC(this.e*Math.sin(t),this.ratexp))-Xe,n.x=this.C*e,n}function Ife(n){for(var e=1e-14,t=n.x/this.C,r=n.y,i=Math.pow(Math.tan(.5*r+Un)/this.K,1/this.C),s=Rfe;s>0&&(r=2*Math.atan(i*nC(this.e*Math.sin(n.y),-.5*this.e))-Xe,!(Math.abs(r-n.y)<e));--s)n.y=r;return s?(n.x=t,n.y=r,n):null}const rC={init:Afe,forward:kfe,inverse:Ife};function Cfe(){rC.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function Pfe(n){var e,t,r,i;return n.x=mt(n.x-this.long0,this.over),rC.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*r),n.x=i*t*Math.sin(n.x),n.y=i*(this.cosc0*e-this.sinc0*t*r),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function Nfe(n){var e,t,r,i,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=Bs(n.x,n.y)){var a=2*Math.atan2(s,this.R2);e=Math.sin(a),t=Math.cos(a),i=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),r=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else i=this.phic0,r=0;return n.x=r,n.y=i,rC.inverse.apply(this,[n]),n.x=mt(n.x+this.long0,this.over),n}var Mfe=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const Lfe={init:Cfe,forward:Pfe,inverse:Nfe,names:Mfe};function iC(n,e,t){return e*=t,Math.tan(.5*(Xe+n))*Math.pow((1-e)/(1+e),.5*t)}function Ofe(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ct&&(this.k0=.5*(1+sx(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=ct&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ct&&Math.abs(Math.cos(this.lat_ts))>ct&&(this.k0=.5*this.cons*pl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Eo(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=pl(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(iC(this.lat0,this.sinlat0,this.e))-Xe,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Dfe(n){var e=n.x,t=n.y,r=Math.sin(t),i=Math.cos(t),s,a,o,l,c,h,g=mt(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=ct&&Math.abs(t+this.lat0)<=ct?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(g)),n.x=this.a*s*i*Math.sin(g)+this.x0,n.y=this.a*s*(this.coslat0*r-this.sinlat0*i*Math.cos(g))+this.y0,n):(a=2*Math.atan(iC(t,r,this.e))-Xe,l=Math.cos(a),o=Math.sin(a),Math.abs(this.coslat0)<=ct?(c=Eo(this.e,t*this.con,this.con*r),h=2*this.a*this.k0*c/this.cons,n.x=this.x0+h*Math.sin(e-this.long0),n.y=this.y0-this.con*h*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<ct?(s=2*this.a*this.k0/(1+l*Math.cos(g)),n.y=s*o):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*l*Math.cos(g))),n.y=s*(this.cosX0*o-this.sinX0*l*Math.cos(g))+this.y0),n.x=s*l*Math.sin(g)+this.x0,n))}function jfe(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var o=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,t=this.lat0,a<=ct?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(o)*this.sinlat0+n.y*Math.sin(o)*this.coslat0/a),Math.abs(this.coslat0)<ct?this.lat0>0?e=mt(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=mt(this.long0+Math.atan2(n.x,n.y),this.over):e=mt(this.long0+Math.atan2(n.x*Math.sin(o),a*this.coslat0*Math.cos(o)-n.y*this.sinlat0*Math.sin(o)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=ct){if(a<=ct)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,r=a*this.cons/(2*this.a*this.k0),t=this.con*c1(this.e,r),e=this.con*mt(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else i=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=ct?s=this.X0:(s=Math.asin(Math.cos(i)*this.sinX0+n.y*Math.sin(i)*this.cosX0/a),e=mt(this.long0+Math.atan2(n.x*Math.sin(i),a*this.cosX0*Math.cos(i)-n.y*this.sinX0*Math.sin(i)),this.over)),t=-1*c1(this.e,Math.tan(.5*(Xe+s)));return n.x=e,n.y=t,n}var Ffe=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const Vfe={init:Ofe,forward:Dfe,inverse:jfe,names:Ffe,ssfn_:iC};function Bfe(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,r=this.rf,i=1/r,s=2*i-Math.pow(i,2),a=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+n/2)),c=Math.log((1+a*e)/(1-a*e));this.K=o-this.alpha*l+this.alpha*a/2*c}function Gfe(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),r=-this.alpha*(e+t)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),a=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),o=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,n.x=this.R*a+this.x0,n}function zfe(n){for(var e=n.x-this.x0,t=n.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),a=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),o=this.lambda0+a/this.alpha,l=0,c=s,h=-1e3,g=0;Math.abs(c-h)>1e-7;){if(++g>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),h=c,c=2*Math.atan(Math.exp(l))-Math.PI/2}return n.x=o,n.y=c,n}var Ufe=["somerc"];const $fe={init:Bfe,forward:Gfe,inverse:zfe,names:Ufe};var e0=1e-7;function Wfe(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf(zV(t))!==-1}function Hfe(){var n,e,t,r,i,s,a,o,l,c,h=0,g,m=0,x=0,y=0,_=0,w=0,T=0;this.no_off=Wfe(this),this.no_rot="no_rot"in this;var b=!1;"alpha"in this&&(b=!0);var R=!1;if("rectified_grid_angle"in this&&(R=!0),b&&(T=this.alpha),R&&(h=this.rectified_grid_angle),b||R)m=this.longc;else if(x=this.long1,_=this.lat1,y=this.long2,w=this.lat2,Math.abs(_-w)<=e0||(n=Math.abs(_))<=e0||Math.abs(n-Xe)<=e0||Math.abs(Math.abs(this.lat0)-Xe)<=e0||Math.abs(Math.abs(w)-Xe)<=e0)throw new Error;var M=1-this.es;e=Math.sqrt(M),Math.abs(this.lat0)>ct?(o=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*o*o,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/M),this.A=this.B*this.k0*e/n,r=this.B*e/(t*Math.sqrt(n)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(Eo(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),b||R?(b?(g=Math.asin(Math.sin(T)/r),R||(h=T)):(g=h,T=Math.asin(r*Math.sin(g))),this.lam0=m-Math.asin(.5*(i-1/i)*Math.tan(g))/this.B):(s=Math.pow(Eo(this.e,_,Math.sin(_)),this.B),a=Math.pow(Eo(this.e,w,Math.sin(w)),this.B),i=this.E/s,l=(a-s)/(a+s),c=this.E*this.E,c=(c-a*s)/(c+a*s),n=x-y,n<-Math.PI?y-=o1:n>Math.PI&&(y+=o1),this.lam0=mt(.5*(x+y)-Math.atan(c*Math.tan(.5*this.B*(x-y))/l)/this.B,this.over),g=Math.atan(2*Math.sin(this.B*mt(x-this.lam0,this.over))/(i-1/i)),h=T=Math.asin(r*Math.sin(g))),this.singam=Math.sin(g),this.cosgam=Math.cos(g),this.sinrot=Math.sin(h),this.cosrot=Math.cos(h),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(T))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*g,this.v_pole_n=this.ArB*Math.log(Math.tan(Un-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(Un+i))}function Kfe(n){var e={},t,r,i,s,a,o,l,c;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-Xe)>ct){if(a=this.E/Math.pow(Eo(this.e,n.y,Math.sin(n.y)),this.B),o=1/a,t=.5*(a-o),r=.5*(a+o),s=Math.sin(this.B*n.x),i=(t*this.singam-s*this.cosgam)/r,Math.abs(Math.abs(i)-1)<ct)throw new Error;c=.5*this.ArB*Math.log((1-i)/(1+i)),o=Math.cos(this.B*n.x),Math.abs(o)<e0?l=this.A*n.x:l=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,o)}else c=n.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*n.y;return this.no_rot?(e.x=l,e.y=c):(l-=this.u_0,e.x=c*this.cosrot+l*this.sinrot,e.y=l*this.cosrot-c*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Xfe(n){var e,t,r,i,s,a,o,l={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*t),i=.5*(r-1/r),s=.5*(r+1/r),a=Math.sin(this.BrA*e),o=(a*this.cosgam+i*this.singam)/s,Math.abs(Math.abs(o)-1)<ct)l.x=0,l.y=o<0?-Xe:Xe;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=c1(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(i*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l}var qfe=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Yfe={init:Hfe,forward:Kfe,inverse:Xfe,names:qfe};function Zfe(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<ct)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),r=pl(this.e,e,t),i=Eo(this.e,this.lat1,e),s=Math.sin(this.lat2),a=Math.cos(this.lat2),o=pl(this.e,s,a),l=Eo(this.e,this.lat2,s),c=Math.abs(Math.abs(this.lat0)-Xe)<ct?0:Eo(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>ct?this.ns=Math.log(r/o)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Jfe(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=ct&&(t=sx(t)*(Xe-2*ct));var r=Math.abs(Math.abs(t)-Xe),i,s;if(r>ct)i=Eo(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(i,this.ns);else{if(r=t*this.ns,r<=0)return null;s=0}var a=this.ns*mt(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(a))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(a))+this.y0,n}function Qfe(n){var e,t,r,i,s,a=(n.x-this.x0)/this.k0,o=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+o*o),t=1):(e=-Math.sqrt(a*a+o*o),t=-1);var l=0;if(e!==0&&(l=Math.atan2(t*a,t*o)),e!==0||this.ns>0){if(t=1/this.ns,r=Math.pow(e/(this.a*this.f0),t),i=c1(this.e,r),i===-9999)return null}else i=-Xe;return s=mt(l/this.ns+this.long0,this.over),n.x=s,n.y=i,n}var e0e=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const t0e={init:Zfe,forward:Jfe,inverse:Qfe,names:e0e};function n0e(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function r0e(n){var e,t,r,i,s,a,o,l=n.x,c=n.y,h=mt(l-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),r=-h*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(r)),s=Math.asin(Math.cos(t)*Math.sin(r)/Math.cos(i)),a=this.n*s,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),n.y=o*Math.cos(a)/1,n.x=o*Math.sin(a)/1,this.czech||(n.y*=-1,n.x*=-1),n}function i0e(n){var e,t,r,i,s,a,o,l,c=n.x;n.x=n.y,n.y=c,this.czech||(n.y*=-1,n.x*=-1),a=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),i=s/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),t=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),n.x=this.long0-t/this.alfa,o=e,l=0;var h=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-n.y)<1e-10&&(l=1),o=n.y,h+=1;while(l===0&&h<15);return h>=15?null:n}var s0e=["Krovak","krovak"];const a0e={init:n0e,forward:r0e,inverse:i0e,names:s0e};function Ts(n,e,t,r,i){return n*i-e*Math.sin(2*i)+t*Math.sin(4*i)-r*Math.sin(6*i)}function ax(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function ox(n){return .375*n*(1+.25*n*(1+.46875*n))}function lx(n){return .05859375*n*n*(1+.75*n)}function cx(n){return n*n*n*(35/3072)}function sC(n,e,t){var r=e*t;return n/Math.sqrt(1-r*r)}function Zu(n){return Math.abs(n)<Xe?n:n-sx(n)*Math.PI}function Yv(n,e,t,r,i){var s,a;s=n/e;for(var o=0;o<15;o++)if(a=(n-(e*s-t*Math.sin(2*s)+r*Math.sin(4*s)-i*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*r*Math.cos(4*s)-6*i*Math.cos(6*s)),s+=a,Math.abs(a)<=1e-10)return s;return NaN}function o0e(){this.sphere||(this.e0=ax(this.es),this.e1=ox(this.es),this.e2=lx(this.es),this.e3=cx(this.es),this.ml0=this.a*Ts(this.e0,this.e1,this.e2,this.e3,this.lat0))}function l0e(n){var e,t,r=n.x,i=n.y;if(r=mt(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),t=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var s=Math.sin(i),a=Math.cos(i),o=sC(this.a,this.e,s),l=Math.tan(i)*Math.tan(i),c=r*Math.cos(i),h=c*c,g=this.es*a*a/(1-this.es),m=this.a*Ts(this.e0,this.e1,this.e2,this.e3,i);e=o*c*(1-h*l*(1/6-(8-l+8*g)*h/120)),t=m-this.ml0+o*s/a*h*(.5+(5-l+6*g)*h/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function c0e(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i;if(this.sphere){var s=t+this.lat0;r=Math.asin(Math.sin(s)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(s))}else{var a=this.ml0/this.a+t,o=Yv(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-Xe)<=ct)return n.x=this.long0,n.y=Xe,t<0&&(n.y*=-1),n;var l=sC(this.a,this.e,Math.sin(o)),c=l*l*l/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(o),2),g=e*this.a/l,m=g*g;r=o-l*Math.tan(o)/c*g*g*(.5-(1+3*h)*g*g/24),i=g*(1-m*(h/3+(1+3*h)*h*m/15))/Math.cos(o)}return n.x=mt(i+this.long0,this.over),n.y=Zu(r),n}var u0e=["Cassini","Cassini_Soldner","cass"];const h0e={init:o0e,forward:l0e,inverse:c0e,names:u0e};function Cu(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var BR=1,GR=2,zR=3,M_=4;function d0e(){var n=Math.abs(this.lat0);if(Math.abs(n-Xe)<ct?this.mode=this.lat0<0?BR:GR:Math.abs(n)<ct?this.mode=zR:this.mode=M_,this.es>0){var e;switch(this.qp=Cu(this.e,1),this.mmf=.5/(1-this.es),this.apa=w0e(this.es),this.mode){case GR:this.dd=1;break;case BR:this.dd=1;break;case zR:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case M_:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Cu(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===M_&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function f0e(n){var e,t,r,i,s,a,o,l,c,h,g=n.x,m=n.y;if(g=mt(g-this.long0,this.over),this.sphere){if(s=Math.sin(m),h=Math.cos(m),r=Math.cos(g),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+h*r:1+this.sinph0*s+this.cosph0*h*r,t<=ct)return null;t=Math.sqrt(2/t),e=t*h*Math.sin(g),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*h*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(m+this.lat0)<ct)return null;t=Un-m*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(g),t*=r}}else{switch(o=0,l=0,c=0,r=Math.cos(g),i=Math.sin(g),s=Math.sin(m),a=Cu(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=a/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:c=1+this.sinb1*o+this.cosb1*l*r;break;case this.EQUIT:c=1+l*r;break;case this.N_POLE:c=Xe+m,a=this.qp-a;break;case this.S_POLE:c=m-Xe,a=this.qp+a;break}if(Math.abs(c)<ct)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),this.mode===this.OBLIQ?t=this.ymf*c*(this.cosb1*o-this.sinb1*l*r):t=(c=Math.sqrt(2/(1+l*r)))*o*this.ymf,e=this.xmf*c*l*i;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(c=Math.sqrt(a))*i,t=r*(this.mode===this.S_POLE?c:-c)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function g0e(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i,s,a,o,l,c;if(this.sphere){var h=0,g,m=0;if(g=Math.sqrt(e*e+t*t),i=g*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=Math.sin(i),h=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(g)<=ct?0:Math.asin(t*m/g),e*=m,t=h*g;break;case this.OBLIQ:i=Math.abs(g)<=ct?this.lat0:Math.asin(h*this.sinph0+t*m*this.cosph0/g),e*=m*this.cosph0,t=(h-Math.sin(i)*this.sinph0)*g;break;case this.N_POLE:t=-t,i=Xe-i;break;case this.S_POLE:i-=Xe;break}r=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,l=Math.sqrt(e*e+t*t),l<ct)return n.x=this.long0,n.y=this.lat0,n;a=2*Math.asin(.5*l/this.rq),s=Math.cos(a),e*=a=Math.sin(a),this.mode===this.OBLIQ?(c=s*this.sinb1+t*a*this.cosb1/l,o=this.qp*c,t=l*this.cosb1*s-t*this.sinb1*a):(c=t*a/l,o=this.qp*c,t=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),o=e*e+t*t,!o)return n.x=this.long0,n.y=this.lat0,n;c=1-o/this.qp,this.mode===this.S_POLE&&(c=-c)}r=Math.atan2(e,t),i=E0e(Math.asin(c),this.apa)}return n.x=mt(this.long0+r,this.over),n.y=i,n}var m0e=.3333333333333333,p0e=.17222222222222222,x0e=.10257936507936508,y0e=.06388888888888888,_0e=.0664021164021164,v0e=.016415012942191543;function w0e(n){var e,t=[];return t[0]=n*m0e,e=n*n,t[0]+=e*p0e,t[1]=e*y0e,e*=n,t[0]+=e*x0e,t[1]+=e*_0e,t[2]=e*v0e,t}function E0e(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var S0e=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const T0e={init:d0e,forward:f0e,inverse:g0e,names:S0e,S_POLE:BR,N_POLE:GR,EQUIT:zR,OBLIQ:M_};function Gu(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function b0e(){Math.abs(this.lat1+this.lat2)<ct||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=pl(this.e3,this.sin_po,this.cos_po),this.qs1=Cu(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=pl(this.e3,this.sin_po,this.cos_po),this.qs2=Cu(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Cu(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>ct?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function R0e(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var r=Cu(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,s=this.ns0*mt(e-this.long0,this.over),a=i*Math.sin(s)+this.x0,o=this.rh-i*Math.cos(s)+this.y0;return n.x=a,n.y=o,n}function A0e(n){var e,t,r,i,s,a;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),r=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*n.x,r*n.y)),r=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-r*r)/(2*this.ns0)):(t=(this.c-r*r)/this.ns0,a=this.phi1z(this.e3,t)),s=mt(i/this.ns0+this.long0,this.over),n.x=s,n.y=a,n}function k0e(n,e){var t,r,i,s,a,o=Gu(.5*e);if(n<ct)return o;for(var l=n*n,c=1;c<=25;c++)if(t=Math.sin(o),r=Math.cos(o),i=n*t,s=1-i*i,a=.5*s*s/r*(e/(1-l)-t/s+.5/n*Math.log((1-i)/(1+i))),o=o+a,Math.abs(a)<=1e-7)return o;return null}var I0e=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const C0e={init:b0e,forward:R0e,inverse:A0e,names:I0e,phi1z:k0e};function P0e(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function N0e(n){var e,t,r,i,s,a,o,l,c=n.x,h=n.y;return r=mt(c-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,a>0||Math.abs(a)<=ct?(o=this.x0+this.a*s*t*Math.sin(r)/a,l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)/a):(o=this.x0+this.infinity_dist*t*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function M0e(n){var e,t,r,i,s,a;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(i=Math.atan2(e,this.rc),t=Math.sin(i),r=Math.cos(i),a=Gu(r*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*r-n.y*this.sin_p14*t),s=mt(this.long0+s,this.over)):(a=this.phic0,s=0),n.x=s,n.y=a,n}var L0e=["gnom"];const O0e={init:P0e,forward:N0e,inverse:M0e,names:L0e};function D0e(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*Xe:Xe;for(var r=Math.asin(.5*e),i,s,a,o,l=0;l<30;l++)if(s=Math.sin(r),a=Math.cos(r),o=n*s,i=Math.pow(1-o*o,2)/(2*a)*(e/(1-n*n)-s/(1-o*o)+.5/n*Math.log((1-o)/(1+o))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function j0e(){this.sphere||(this.k0=pl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function F0e(n){var e=n.x,t=n.y,r,i,s=mt(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var a=Cu(this.e,Math.sin(t));r=this.x0+this.a*this.k0*s,i=this.y0+this.a*a*.5/this.k0}return n.x=r,n.y=i,n}function V0e(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=mt(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=D0e(this.e,2*n.y*this.k0/this.a),e=mt(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var B0e=["cea"];const G0e={init:j0e,forward:F0e,inverse:V0e,names:B0e};function z0e(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function U0e(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=Zu(t-this.lat0);return n.x=this.x0+this.a*r*this.rc,n.y=this.y0+this.a*i,n}function $0e(n){var e=n.x,t=n.y;return n.x=mt(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=Zu(this.lat0+(t-this.y0)/this.a),n}var W0e=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const H0e={init:z0e,forward:U0e,inverse:$0e,names:W0e};var wO=20;function K0e(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ax(this.es),this.e1=ox(this.es),this.e2=lx(this.es),this.e3=cx(this.es),this.ml0=this.a*Ts(this.e0,this.e1,this.e2,this.e3,this.lat0)}function X0e(n){var e=n.x,t=n.y,r,i,s,a=mt(e-this.long0,this.over);if(s=a*Math.sin(t),this.sphere)Math.abs(t)<=ct?(r=this.a*a,i=-1*this.a*this.lat0):(r=this.a*Math.sin(s)/Math.tan(t),i=this.a*(Zu(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=ct)r=this.a*a,i=-1*this.ml0;else{var o=sC(this.a,this.e,Math.sin(t))/Math.tan(t);r=o*Math.sin(s),i=this.a*Ts(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+o*(1-Math.cos(s))}return n.x=r+this.x0,n.y=i+this.y0,n}function q0e(n){var e,t,r,i,s,a,o,l,c;if(r=n.x-this.x0,i=n.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=ct)e=mt(r/this.a+this.long0,this.over),t=0;else{a=this.lat0+i/this.a,o=r*r/this.a/this.a+a*a,l=a;var h;for(s=wO;s;--s)if(h=Math.tan(l),c=-1*(a*(l*h+1)-l-.5*(l*l+o)*h)/((l-a)/h-1),l+=c,Math.abs(c)<=ct){t=l;break}e=mt(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(t),this.over)}else if(Math.abs(i+this.ml0)<=ct)t=0,e=mt(this.long0+r/this.a,this.over);else{a=(this.ml0+i)/this.a,o=r*r/this.a/this.a+a*a,l=a;var g,m,x,y,_;for(s=wO;s;--s)if(_=this.e*Math.sin(l),g=Math.sqrt(1-_*_)*Math.tan(l),m=this.a*Ts(this.e0,this.e1,this.e2,this.e3,l),x=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),y=m/this.a,c=(a*(g*y+1)-y-.5*g*(y*y+o))/(this.es*Math.sin(2*l)*(y*y+o-2*a*y)/(4*g)+(a-y)*(g*x-2/Math.sin(2*l))-x),l-=c,Math.abs(c)<=ct){t=l;break}g=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=mt(this.long0+Math.asin(r*g/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var Y0e=["Polyconic","American_Polyconic","poly"];const Z0e={init:K0e,forward:X0e,inverse:q0e,names:Y0e};function J0e(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Q0e(n){var e,t=n.x,r=n.y,i=r-this.lat0,s=t-this.long0,a=i/ip*1e-5,o=s,l=1,c=0;for(e=1;e<=10;e++)l=l*a,c=c+this.A[e]*l;var h=c,g=o,m=1,x=0,y,_,w=0,T=0;for(e=1;e<=6;e++)y=m*h-x*g,_=x*h+m*g,m=y,x=_,w=w+this.B_re[e]*m-this.B_im[e]*x,T=T+this.B_im[e]*m+this.B_re[e]*x;return n.x=T*this.a+this.x0,n.y=w*this.a+this.y0,n}function ege(n){var e,t=n.x,r=n.y,i=t-this.x0,s=r-this.y0,a=s/this.a,o=i/this.a,l=1,c=0,h,g,m=0,x=0;for(e=1;e<=6;e++)h=l*a-c*o,g=c*a+l*o,l=h,c=g,m=m+this.C_re[e]*l-this.C_im[e]*c,x=x+this.C_im[e]*l+this.C_re[e]*c;for(var y=0;y<this.iterations;y++){var _=m,w=x,T,b,R=a,M=o;for(e=2;e<=6;e++)T=_*m-w*x,b=w*m+_*x,_=T,w=b,R=R+(e-1)*(this.B_re[e]*_-this.B_im[e]*w),M=M+(e-1)*(this.B_im[e]*_+this.B_re[e]*w);_=1,w=0;var D=this.B_re[1],B=this.B_im[1];for(e=2;e<=6;e++)T=_*m-w*x,b=w*m+_*x,_=T,w=b,D=D+e*(this.B_re[e]*_-this.B_im[e]*w),B=B+e*(this.B_im[e]*_+this.B_re[e]*w);var k=D*D+B*B;m=(R*D+M*B)/k,x=(M*D-R*B)/k}var A=m,C=x,O=1,P=0;for(e=1;e<=9;e++)O=O*A,P=P+this.D[e]*O;var z=this.lat0+P*ip*1e5,F=this.long0+C;return n.x=F,n.y=z,n}var tge=["New_Zealand_Map_Grid","nzmg"];const nge={init:J0e,forward:Q0e,inverse:ege,names:tge};function rge(){}function ige(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=this.x0+this.a*r,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=i,n.y=s,n}function sge(n){n.x-=this.x0,n.y-=this.y0;var e=mt(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var age=["Miller_Cylindrical","mill"];const oge={init:rge,forward:ige,inverse:sge,names:age};var lge=20;function cge(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=QI(this.es)}function uge(n){var e,t,r=n.x,i=n.y;if(r=mt(r-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var s=this.n*Math.sin(i),a=lge;a;--a){var o=(this.m*i+Math.sin(i)-s)/(this.m+Math.cos(i));if(i-=o,Math.abs(o)<ct)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),t=this.a*this.C_y*i}else{var l=Math.sin(i),c=Math.cos(i);t=this.a*vg(i,l,c,this.en),e=this.a*r*c/Math.sqrt(1-this.es*l*l)}return n.x=e,n.y=t,n}function hge(n){var e,t,r,i;return n.x-=this.x0,r=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=Gu((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=Gu(Math.sin(e)/this.n)),r=mt(r+this.long0,this.over),e=Zu(e)):(e=eC(n.y/this.a,this.es,this.en),i=Math.abs(e),i<Xe?(i=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=mt(t,this.over)):i-ct<Xe&&(r=this.long0)),n.x=r,n.y=e,n}var dge=["Sinusoidal","sinu"];const fge={init:cge,forward:uge,inverse:hge,names:dge};function gge(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function mge(n){for(var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=t,s=Math.PI*Math.sin(t);;){var a=-(i+Math.sin(i)-s)/(1+Math.cos(i));if(i+=a,Math.abs(a)<ct)break}i/=2,Math.PI/2-Math.abs(t)<ct&&(r=0);var o=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return n.x=o,n.y=l,n}function pge(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var r=mt(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var i=Math.asin(t);return n.x=r,n.y=i,n}var xge=["Mollweide","moll"];const yge={init:gge,forward:mge,inverse:pge,names:xge};function _ge(){Math.abs(this.lat1+this.lat2)<ct||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ax(this.es),this.e1=ox(this.es),this.e2=lx(this.es),this.e3=cx(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=pl(this.e,this.sin_phi,this.cos_phi),this.ml1=Ts(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<ct?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=pl(this.e,this.sin_phi,this.cos_phi),this.ml2=Ts(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Ts(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function vge(n){var e=n.x,t=n.y,r;if(this.sphere)r=this.a*(this.g-t);else{var i=Ts(this.e0,this.e1,this.e2,this.e3,t);r=this.a*(this.g-i)}var s=this.ns*mt(e-this.long0,this.over),a=this.x0+r*Math.sin(s),o=this.y0+this.rh-r*Math.cos(s);return n.x=a,n.y=o,n}function wge(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,r,i;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return i=mt(this.long0+s/this.ns,this.over),r=Zu(this.g-t/this.a),n.x=i,n.y=r,n;var a=this.g-t/this.a;return r=Yv(a,this.e0,this.e1,this.e2,this.e3),i=mt(this.long0+s/this.ns,this.over),n.x=i,n.y=r,n}var Ege=["Equidistant_Conic","eqdc"];const Sge={init:_ge,forward:vge,inverse:wge,names:Ege};function Tge(){this.R=this.a}function bge(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i,s;Math.abs(t)<=ct&&(i=this.x0+this.R*r,s=this.y0);var a=Gu(2*Math.abs(t/Math.PI));(Math.abs(r)<=ct||Math.abs(Math.abs(t)-Xe)<=ct)&&(i=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*a):s=this.y0+Math.PI*this.R*-Math.tan(.5*a));var o=.5*Math.abs(Math.PI/r-r/Math.PI),l=o*o,c=Math.sin(a),h=Math.cos(a),g=h/(c+h-1),m=g*g,x=g*(2/c-1),y=x*x,_=Math.PI*this.R*(o*(g-y)+Math.sqrt(l*(g-y)*(g-y)-(y+l)*(m-y)))/(y+l);r<0&&(_=-_),i=this.x0+_;var w=l+g;return _=Math.PI*this.R*(x*w-o*Math.sqrt((y+l)*(l+1)-w*w))/(y+l),t>=0?s=this.y0+_:s=this.y0-_,n.x=i,n.y=s,n}function Rge(n){var e,t,r,i,s,a,o,l,c,h,g,m,x;return n.x-=this.x0,n.y-=this.y0,g=Math.PI*this.R,r=n.x/g,i=n.y/g,s=r*r+i*i,a=-Math.abs(i)*(1+s),o=a-2*i*i+r*r,l=-2*a+1+2*i*i+s*s,x=i*i/l+(2*o*o*o/l/l/l-9*a*o/l/l)/27,c=(a-o*o/3/l)/l,h=2*Math.sqrt(-c/3),g=3*x/c/h,Math.abs(g)>1&&(g>=0?g=1:g=-1),m=Math.acos(g)/3,n.y>=0?t=(-h*Math.cos(m+Math.PI/3)-o/3/l)*Math.PI:t=-(-h*Math.cos(m+Math.PI/3)-o/3/l)*Math.PI,Math.abs(r)<ct?e=this.long0:e=mt(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(r*r-i*i)+s*s))/2/r,this.over),n.x=e,n.y=t,n}var Age=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const kge={init:Tge,forward:bge,inverse:Rge,names:Age};function Ige(n,e,t,r,i,s){const a=r-e,o=Math.atan((1-s)*Math.tan(n)),l=Math.atan((1-s)*Math.tan(t)),c=Math.sin(o),h=Math.cos(o),g=Math.sin(l),m=Math.cos(l);let x=a,y,_=100,w,T,b,R,M,D,B,k,A,C,O,P,z,F;do{if(w=Math.sin(x),T=Math.cos(x),b=Math.sqrt(m*w*(m*w)+(h*g-c*m*T)*(h*g-c*m*T)),b===0)return{azi1:0,s12:0};R=c*g+h*m*T,M=Math.atan2(b,R),D=h*m*w/b,B=1-D*D,k=B!==0?R-2*c*g/B:0,A=s/16*B*(4+s*(4-3*B)),y=x,x=a+(1-A)*s*D*(M+A*b*(k+A*R*(-1+2*k*k)))}while(Math.abs(x-y)>1e-12&&--_>0);return _===0?{azi1:NaN,s12:NaN}:(C=B*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),O=1+C/16384*(4096+C*(-768+C*(320-175*C))),P=C/1024*(256+C*(-128+C*(74-47*C))),z=P*b*(k+P/4*(R*(-1+2*k*k)-P/6*k*(-3+4*b*b)*(-3+4*k*k))),F=i*(1-s)*O*(M-z),{azi1:Math.atan2(m*w,h*g-c*m*T),s12:F})}function Cge(n,e,t,r,i,s){const a=Math.atan((1-s)*Math.tan(n)),o=Math.sin(a),l=Math.cos(a),c=Math.sin(t),h=Math.cos(t),g=Math.atan2(o,l*h),m=l*c,x=1-m*m,y=x*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),_=1+y/16384*(4096+y*(-768+y*(320-175*y))),w=y/1024*(256+y*(-128+y*(74-47*y)));let T=r/(i*(1-s)*_),b,R=100,M,D,B,k;do M=Math.cos(2*g+T),D=Math.sin(T),B=Math.cos(T),k=w*D*(M+w/4*(B*(-1+2*M*M)-w/6*M*(-3+4*D*D)*(-3+4*M*M))),b=T,T=r/(i*(1-s)*_)+k;while(Math.abs(T-b)>1e-12&&--R>0);if(R===0)return{lat2:NaN,lon2:NaN};const A=o*D-l*B*h,C=Math.atan2(o*B+l*D*h,(1-s)*Math.sqrt(m*m+A*A)),O=Math.atan2(D*c,l*B-o*D*h),P=s/16*x*(4+s*(4-3*x)),z=O-(1-P)*s*m*(T+P*D*(M+P*B*(-1+2*M*M))),F=e+z;return{lat2:C,lon2:F}}function Pge(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function Nge(n){var e=n.x,t=n.y,r=Math.sin(n.y),i=Math.cos(n.y),s=mt(e-this.long0,this.over),a,o,l,c,h,g,m,x,y,_,w;return this.sphere?Math.abs(this.sin_p12-1)<=ct?(n.x=this.x0+this.a*(Xe-t)*Math.sin(s),n.y=this.y0-this.a*(Xe-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=ct?(n.x=this.x0+this.a*(Xe+t)*Math.sin(s),n.y=this.y0+this.a*(Xe+t)*Math.cos(s),n):(y=this.sin_p12*r+this.cos_p12*i*Math.cos(s),m=Math.acos(y),x=m?m/Math.sin(m):1,n.x=this.x0+this.a*x*i*Math.sin(s),n.y=this.y0+this.a*x*(this.cos_p12*r-this.sin_p12*i*Math.cos(s)),n):(a=ax(this.es),o=ox(this.es),l=lx(this.es),c=cx(this.es),Math.abs(this.sin_p12-1)<=ct?(h=this.a*Ts(a,o,l,c,Xe),g=this.a*Ts(a,o,l,c,t),n.x=this.x0+(h-g)*Math.sin(s),n.y=this.y0-(h-g)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=ct?(h=this.a*Ts(a,o,l,c,Xe),g=this.a*Ts(a,o,l,c,t),n.x=this.x0+(h+g)*Math.sin(s),n.y=this.y0+(h+g)*Math.cos(s),n):Math.abs(e)<ct&&Math.abs(t-this.lat0)<ct?(n.x=n.y=0,n):(_=Ige(this.lat0,this.long0,t,e,this.a,this.f),w=_.azi1,n.x=_.s12*Math.sin(w),n.y=_.s12*Math.cos(w),n))}function Mge(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a,o,l,c,h,g,m,x,y,_,w;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*Xe*this.a?void 0:(t=e/this.a,r=Math.sin(t),i=Math.cos(t),s=this.long0,Math.abs(e)<=ct?a=this.lat0:(a=Gu(i*this.sin_p12+n.y*r*this.cos_p12/e),o=Math.abs(this.lat0)-Xe,Math.abs(o)<=ct?this.lat0>=0?s=mt(this.long0+Math.atan2(n.x,-n.y),this.over):s=mt(this.long0-Math.atan2(-n.x,n.y),this.over):s=mt(this.long0+Math.atan2(n.x*r,e*this.cos_p12*i-n.y*this.sin_p12*r),this.over)),n.x=s,n.y=a,n)):(l=ax(this.es),c=ox(this.es),h=lx(this.es),g=cx(this.es),Math.abs(this.sin_p12-1)<=ct?(m=this.a*Ts(l,c,h,g,Xe),e=Math.sqrt(n.x*n.x+n.y*n.y),x=m-e,a=Yv(x/this.a,l,c,h,g),s=mt(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=a,n):Math.abs(this.sin_p12+1)<=ct?(m=this.a*Ts(l,c,h,g,Xe),e=Math.sqrt(n.x*n.x+n.y*n.y),x=e-m,a=Yv(x/this.a,l,c,h,g),s=mt(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=a,n):(y=Math.atan2(n.x,n.y),_=Math.sqrt(n.x*n.x+n.y*n.y),w=Cge(this.lat0,this.long0,y,_,this.a,this.f),n.x=w.lon2,n.y=w.lat2,n))}var Lge=["Azimuthal_Equidistant","aeqd"];const Oge={init:Pge,forward:Nge,inverse:Mge,names:Lge};function Dge(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function jge(n){var e,t,r,i,s,a,o,l,c=n.x,h=n.y;return r=mt(c-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,(a>0||Math.abs(a)<=ct)&&(o=this.a*s*t*Math.sin(r),l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function Fge(n){var e,t,r,i,s,a,o;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=Gu(e/this.a),r=Math.sin(t),i=Math.cos(t),a=this.long0,Math.abs(e)<=ct?(o=this.lat0,n.x=a,n.y=o,n):(o=Gu(i*this.sin_p14+n.y*r*this.cos_p14/e),s=Math.abs(this.lat0)-Xe,Math.abs(s)<=ct?(this.lat0>=0?a=mt(this.long0+Math.atan2(n.x,-n.y),this.over):a=mt(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=a,n.y=o,n):(a=mt(this.long0+Math.atan2(n.x*r,e*this.cos_p14*i-n.y*this.sin_p14*r),this.over),n.x=a,n.y=o,n))}var Vge=["ortho"];const Bge={init:Dge,forward:jge,inverse:Fge,names:Vge};var Ir={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},$n={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Gge(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Xe-Un/2?this.face=Ir.TOP:this.lat0<=-(Xe-Un/2)?this.face=Ir.BOTTOM:Math.abs(this.long0)<=Un?this.face=Ir.FRONT:Math.abs(this.long0)<=Xe+Un?this.face=this.long0>0?Ir.RIGHT:Ir.LEFT:this.face=Ir.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function zge(n){var e={x:0,y:0},t,r,i,s,a,o,l={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,r=n.x,this.face===Ir.TOP)s=Xe-t,r>=Un&&r<=Xe+Un?(l.value=$n.AREA_0,i=r-Xe):r>Xe+Un||r<=-(Xe+Un)?(l.value=$n.AREA_1,i=r>0?r-Wr:r+Wr):r>-(Xe+Un)&&r<=-Un?(l.value=$n.AREA_2,i=r+Xe):(l.value=$n.AREA_3,i=r);else if(this.face===Ir.BOTTOM)s=Xe+t,r>=Un&&r<=Xe+Un?(l.value=$n.AREA_0,i=-r+Xe):r<Un&&r>=-Un?(l.value=$n.AREA_1,i=-r):r<-Un&&r>=-(Xe+Un)?(l.value=$n.AREA_2,i=-r-Xe):(l.value=$n.AREA_3,i=r>0?-r+Wr:-r-Wr);else{var c,h,g,m,x,y,_;this.face===Ir.RIGHT?r=b0(r,+Xe):this.face===Ir.BACK?r=b0(r,+Wr):this.face===Ir.LEFT&&(r=b0(r,-Xe)),m=Math.sin(t),x=Math.cos(t),y=Math.sin(r),_=Math.cos(r),c=x*_,h=x*y,g=m,this.face===Ir.FRONT?(s=Math.acos(c),i=qy(s,g,h,l)):this.face===Ir.RIGHT?(s=Math.acos(h),i=qy(s,g,-c,l)):this.face===Ir.BACK?(s=Math.acos(-c),i=qy(s,g,-h,l)):this.face===Ir.LEFT?(s=Math.acos(-h),i=qy(s,g,c,l)):(s=i=0,l.value=$n.AREA_0)}return o=Math.atan(12/Wr*(i+Math.acos(Math.sin(i)*Math.cos(Un))-Xe)),a=Math.sqrt((1-Math.cos(s))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===$n.AREA_1?o+=Xe:l.value===$n.AREA_2?o+=Wr:l.value===$n.AREA_3&&(o+=1.5*Wr),e.x=a*Math.cos(o),e.y=a*Math.sin(o),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function Uge(n){var e={lam:0,phi:0},t,r,i,s,a,o,l,c,h,g={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,r=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?g.value=$n.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(g.value=$n.AREA_1,t-=Xe):n.x<0&&-n.x>=Math.abs(n.y)?(g.value=$n.AREA_2,t=t<0?t+Wr:t-Wr):(g.value=$n.AREA_3,t+=Xe),h=Wr/12*Math.tan(t),a=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),o=Math.atan(a),i=Math.cos(t),s=Math.tan(r),l=1-i*i*s*s*(1-Math.cos(Math.atan(1/Math.cos(o)))),l<-1?l=-1:l>1&&(l=1),this.face===Ir.TOP)c=Math.acos(l),e.phi=Xe-c,g.value===$n.AREA_0?e.lam=o+Xe:g.value===$n.AREA_1?e.lam=o<0?o+Wr:o-Wr:g.value===$n.AREA_2?e.lam=o-Xe:e.lam=o;else if(this.face===Ir.BOTTOM)c=Math.acos(l),e.phi=c-Xe,g.value===$n.AREA_0?e.lam=-o+Xe:g.value===$n.AREA_1?e.lam=-o:g.value===$n.AREA_2?e.lam=-o-Xe:e.lam=o<0?-o-Wr:-o+Wr;else{var m,x,y;m=l,h=m*m,h>=1?y=0:y=Math.sqrt(1-h)*Math.sin(o),h+=y*y,h>=1?x=0:x=Math.sqrt(1-h),g.value===$n.AREA_1?(h=x,x=-y,y=h):g.value===$n.AREA_2?(x=-x,y=-y):g.value===$n.AREA_3&&(h=x,x=y,y=-h),this.face===Ir.RIGHT?(h=m,m=-x,x=h):this.face===Ir.BACK?(m=-m,x=-x):this.face===Ir.LEFT&&(h=m,m=x,x=-h),e.phi=Math.acos(-y)-Xe,e.lam=Math.atan2(x,m),this.face===Ir.RIGHT?e.lam=b0(e.lam,-Xe):this.face===Ir.BACK?e.lam=b0(e.lam,-Wr):this.face===Ir.LEFT&&(e.lam=b0(e.lam,+Xe))}if(this.es!==0){var _,w,T;_=e.phi<0?1:0,w=Math.tan(e.phi),T=this.b/Math.sqrt(w*w+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-T*T)/(this.one_minus_f*T)),_&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function qy(n,e,t,r){var i;return n<ct?(r.value=$n.AREA_0,i=0):(i=Math.atan2(e,t),Math.abs(i)<=Un?r.value=$n.AREA_0:i>Un&&i<=Xe+Un?(r.value=$n.AREA_1,i-=Xe):i>Xe+Un||i<=-(Xe+Un)?(r.value=$n.AREA_2,i=i>=0?i-Wr:i+Wr):(r.value=$n.AREA_3,i+=Xe)),i}function b0(n,e){var t=n+e;return t<-Wr?t+=o1:t>+Wr&&(t-=o1),t}var $ge=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const Wge={init:Gge,forward:zge,inverse:Uge,names:$ge};var UR=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Fm=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],tB=.8487,nB=1.3523,rB=zs/5,Hge=1/rB,f0=18,Zv=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},Kge=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function Xge(n,e,t,r){for(var i=e;r;--r){var s=n(i);if(i-=s,Math.abs(s)<t)break}return i}function qge(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Yge(n){var e=mt(n.x-this.long0,this.over),t=Math.abs(n.y),r=Math.floor(t*rB);r<0?r=0:r>=f0&&(r=f0-1),t=zs*(t-Hge*r);var i={x:Zv(UR[r],t)*e,y:Zv(Fm[r],t)};return n.y<0&&(i.y=-i.y),i.x=i.x*this.a*tB+this.x0,i.y=i.y*this.a*nB+this.y0,i}function Zge(n){var e={x:(n.x-this.x0)/(this.a*tB),y:Math.abs(n.y-this.y0)/(this.a*nB)};if(e.y>=1)e.x/=UR[f0][0],e.y=n.y<0?-Xe:Xe;else{var t=Math.floor(e.y*f0);for(t<0?t=0:t>=f0&&(t=f0-1);;)if(Fm[t][0]>e.y)--t;else if(Fm[t+1][0]<=e.y)++t;else break;var r=Fm[t],i=5*(e.y-r[0])/(Fm[t+1][0]-r[0]);i=Xge(function(s){return(Zv(r,s)-e.y)/Kge(r,s)},i,ct,100),e.x/=Zv(UR[t],i),e.y=(5*t+i)*Dr,n.y<0&&(e.y=-e.y)}return e.x=mt(e.x+this.long0,this.over),e}var Jge=["Robinson","robin"];const Qge={init:qge,forward:Yge,inverse:Zge,names:Jge};function eme(){this.name="geocent"}function tme(n){var e=$V(n,this.es,this.a);return e}function nme(n){var e=WV(n,this.es,this.a,this.b);return e}var rme=["Geocentric","geocentric","geocent","Geocent"];const ime={init:eme,forward:tme,inverse:nme,names:rme};var ls={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},Em={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function sme(){if(Object.keys(Em).forEach((function(t){if(typeof this[t]>"u")this[t]=Em[t].def;else{if(Em[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);Em[t].num&&(this[t]=parseFloat(this[t]))}Em[t].degrees&&(this[t]=this[t]*Dr)}).bind(this)),Math.abs(Math.abs(this.lat0)-Xe)<ct?this.mode=this.lat0<0?ls.S_POLE:ls.N_POLE:Math.abs(this.lat0)<ct?this.mode=ls.EQUIT:(this.mode=ls.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function ame(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i,s;switch(this.mode){case ls.OBLIQ:s=this.sinph0*e+this.cosph0*t*r;break;case ls.EQUIT:s=t*r;break;case ls.S_POLE:s=-e;break;case ls.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),i=s*t*Math.sin(n.x),this.mode){case ls.OBLIQ:s*=this.cosph0*e-this.sinph0*t*r;break;case ls.EQUIT:s*=e;break;case ls.N_POLE:s*=-(t*r);break;case ls.S_POLE:s*=t*r;break}var a,o;return a=s*this.cg+i*this.sg,o=1/(a*this.sw*this.h1+this.cw),i=(i*this.cg-s*this.sg)*this.cw*o,s=a*o,n.x=i*this.a,n.y=s*this.a,n}function ome(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,r,i;i=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*i,r=this.pn1*n.y*this.cw*i,n.x=t*this.cg+r*this.sg,n.y=r*this.cg-t*this.sg;var s=Bs(n.x,n.y);if(Math.abs(s)<ct)e.x=0,e.y=n.y;else{var a,o;switch(o=1-s*s*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/s+s/this.pn1),a=Math.sqrt(1-o*o),this.mode){case ls.OBLIQ:e.y=Math.asin(a*this.sinph0+n.y*o*this.cosph0/s),n.y=(a-this.sinph0*Math.sin(e.y))*s,n.x*=o*this.cosph0;break;case ls.EQUIT:e.y=Math.asin(n.y*o/s),n.y=a*s,n.x*=o;break;case ls.N_POLE:e.y=Math.asin(a),n.y=-n.y;break;case ls.S_POLE:e.y=-Math.asin(a);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var lme=["Tilted_Perspective","tpers"];const cme={init:sme,forward:ame,inverse:ome,names:lme};function ume(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function hme(n){var e=n.x,t=n.y,r,i,s,a;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var o=this.radius_p/Bs(this.radius_p*Math.cos(t),Math.sin(t));if(i=o*Math.cos(e)*Math.cos(t),s=o*Math.sin(e)*Math.cos(t),a=o*Math.sin(t),(this.radius_g-i)*i-s*s-a*a*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Bs(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/Bs(s,r)))}else this.shape==="sphere"&&(r=Math.cos(t),i=Math.cos(e)*r,s=Math.sin(e)*r,a=Math.sin(t),r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Bs(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/Bs(s,r))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function dme(n){var e=-1,t=0,r=0,i,s,a,o;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Bs(1,r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Bs(1,t));var l=r/this.radius_p;if(i=t*t+l*l+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+r*r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),i=t*t+r*r+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var fme=["Geostationary Satellite View","Geostationary_Satellite","geos"];const gme={init:ume,forward:hme,inverse:dme,names:fme};var sp=1.340264,ap=-.081106,op=893e-6,lp=.003796,Jv=Math.sqrt(3)/2;function mme(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function pme(n){var e=mt(n.x-this.long0,this.over),t=n.y,r=Math.asin(Jv*Math.sin(t)),i=r*r,s=i*i*i;return n.x=e*Math.cos(r)/(Jv*(sp+3*ap*i+s*(7*op+9*lp*i))),n.y=r*(sp+ap*i+s*(op+lp*i)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function xme(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,r=n.y,i,s,a,o,l,c;for(c=0;c<t&&(i=r*r,s=i*i*i,a=r*(sp+ap*i+s*(op+lp*i))-n.y,o=sp+3*ap*i+s*(7*op+9*lp*i),r-=l=a/o,!(Math.abs(l)<e));++c);return i=r*r,s=i*i*i,n.x=Jv*n.x*(sp+3*ap*i+s*(7*op+9*lp*i))/Math.cos(r),n.y=Math.asin(Math.sin(r)/Jv),n.x=mt(n.x+this.long0,this.over),n}var yme=["eqearth","Equal Earth","Equal_Earth"];const _me={init:mme,forward:pme,inverse:xme,names:yme};var u1=1e-10;function vme(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<u1)throw new Error;this.es?(this.en=QI(this.es),this.m1=vg(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=Eme,this.forward=wme):(Math.abs(this.phi1)+u1>=Xe?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Tme,this.forward=Sme)}function wme(n){var e=mt(n.x-(this.long0||0),this.over),t=n.y,r,i,s;return r=this.am1+this.m1-vg(t,i=Math.sin(t),s=Math.cos(t),this.en),i=s*e/(r*Math.sqrt(1-this.es*i*i)),n.x=r*Math.sin(i),n.y=this.am1-r*Math.cos(i),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Eme(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r,i;if(t=Bs(n.x,n.y=this.am1-n.y),i=eC(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(i))<Xe)e=Math.sin(i),r=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-Xe)<=u1)r=0;else throw new Error;return n.x=mt(r+(this.long0||0),this.over),n.y=Zu(i),n}function Sme(n){var e=mt(n.x-(this.long0||0),this.over),t=n.y,r,i;return i=this.cphi1+this.phi1-t,Math.abs(i)>u1?(n.x=i*Math.sin(r=e*Math.cos(t)/i),n.y=this.cphi1-i*Math.cos(r)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Tme(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r=Bs(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-r,Math.abs(t)>Xe)throw new Error;return Math.abs(Math.abs(t)-Xe)<=u1?e=0:e=r*Math.atan2(n.x,n.y)/Math.cos(t),n.x=mt(e+(this.long0||0),this.over),n.y=Zu(t),n}var bme=["bonne","Bonne (Werner lat_1=90)"];const Rme={init:vme,names:bme},EO={OBLIQUE:{forward:Pme,inverse:Mme},TRANSVERSE:{forward:Nme,inverse:Lme}},Qv={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function Ame(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=BV.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=Ua(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const r=Object.keys(Qv),i=o=>{if(typeof this[o]>"u")return;const l=parseFloat(this[o])*Dr;if(isNaN(l))throw new Error("Invalid value for "+o+": "+this[o]);return l};for(let o=0;o<r.length;o++){const l=r[o],c=Qv[l],h=Object.entries(c);if(h.some(([m])=>typeof this[m]<"u")){t=c;for(let m=0;m<h.length;m++){const[x,y]=h[m],_=i(x);if(typeof _>"u")throw new Error("Missing parameter: "+x+".");this[y]=_}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:a}=Cme(this,t);this.lamp=s,Math.abs(a)>ct?(this.cphip=Math.cos(a),this.sphip=Math.sin(a),this.projectionType=EO.OBLIQUE):this.projectionType=EO.TRANSVERSE}function kme(n){return this.projectionType.forward(this,n)}function Ime(n){return this.projectionType.inverse(this,n)}function Cme(n,e){let t,r;if(e===Qv.ROTATE){let i=n.oLongC,s=n.oLatC,a=n.oAlpha;if(Math.abs(Math.abs(s)-Xe)<=ct)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");r=i+Math.atan2(-1*Math.cos(a),-1*Math.sin(a)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(a))}else if(e===Qv.NEW_POLE)r=n.oLongP,t=n.oLatP;else{let i=n.oLong1,s=n.oLat1,a=n.oLong2,o=n.oLat2,l=Math.abs(s);if(Math.abs(s)>Xe-ct)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(o)>Xe-ct)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-o)<ct)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(l<ct)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(s)*Math.sin(o)*Math.cos(i)-Math.sin(s)*Math.cos(o)*Math.cos(a),Math.sin(s)*Math.cos(o)*Math.sin(a)-Math.cos(s)*Math.sin(o)*Math.sin(i)),t=Math.atan(-1*Math.cos(r-i)/Math.tan(s))}return{lamp:r,phip:t}}function Pme(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(t),s=Math.sin(r),a=Math.cos(r);e.x=mt(Math.atan2(a*Math.sin(t),n.sphip*a*i+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*a*i);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=zs,o.y*=zs),o}function Nme(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(r),s=Math.cos(t);e.x=mt(Math.atan2(i*Math.sin(t),Math.sin(r))+n.lamp),e.y=Math.asin(-1*i*s);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=zs,a.y*=zs),a}function Mme(n,e){n.isIdentity&&(e.x*=Dr,e.y*=Dr);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){r-=n.lamp;const s=Math.cos(r),a=Math.sin(i),o=Math.cos(i);e.x=Math.atan2(o*Math.sin(r),n.sphip*o*s-n.cphip*a),e.y=Math.asin(n.sphip*a+n.cphip*o*s)}return e.x=mt(e.x+n.long0),e}function Lme(n,e){n.isIdentity&&(e.x*=Dr,e.y*=Dr);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){const s=Math.cos(i);r-=n.lamp,e.x=Math.atan2(s*Math.sin(r),-1*Math.sin(i)),e.y=Math.asin(s*Math.cos(r))}return e.x=mt(e.x+n.long0),e}var Ome=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const Dme={init:Ame,forward:kme,inverse:Ime,names:Ome};function jme(n){n.Proj.projections.add(P_),n.Proj.projections.add(N_),n.Proj.projections.add(bfe),n.Proj.projections.add(Lfe),n.Proj.projections.add(Vfe),n.Proj.projections.add($fe),n.Proj.projections.add(Yfe),n.Proj.projections.add(t0e),n.Proj.projections.add(a0e),n.Proj.projections.add(h0e),n.Proj.projections.add(T0e),n.Proj.projections.add(C0e),n.Proj.projections.add(O0e),n.Proj.projections.add(G0e),n.Proj.projections.add(H0e),n.Proj.projections.add(Z0e),n.Proj.projections.add(nge),n.Proj.projections.add(oge),n.Proj.projections.add(fge),n.Proj.projections.add(yge),n.Proj.projections.add(Sge),n.Proj.projections.add(kge),n.Proj.projections.add(Oge),n.Proj.projections.add(Bge),n.Proj.projections.add(Wge),n.Proj.projections.add(Qge),n.Proj.projections.add(ime),n.Proj.projections.add(cme),n.Proj.projections.add(gme),n.Proj.projections.add(_me),n.Proj.projections.add(Rme),n.Proj.projections.add(Dme)}const bn=Object.assign(zde,{defaultDatum:"WGS84",Proj:Ua,WGS84:new Ua("WGS84"),Point:sg,toPoint:HV,defs:Bi,nadgrid:Tde,transform:qv,mgrs:Ude,version:"__VERSION__"});jme(bn);class iB{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=_r,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let r=t.dataProjection?ir(t.dataProjection):this.readProjection(e);t.extent&&r&&r.getUnits()==="tile-pixels"&&(r=ir(r),r.setWorldExtent(t.extent)),t={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return Wt()}readFeature(e,t){return Wt()}readFeatures(e,t){return Wt()}readGeometry(e,t){return Wt()}readProjection(e){return Wt()}writeFeature(e,t){return Wt()}writeFeatures(e,t){return Wt()}writeGeometry(e,t){return Wt()}}function Ao(n,e,t){const r=t?ir(t.featureProjection):null,i=t?ir(t.dataProjection):null;let s=n;if(r&&i&&!Zh(r,i)){e&&(s=n.clone());const a=e?r:i,o=e?i:r;a.getUnits()==="tile-pixels"?s.transform(a,o):s.applyTransform(Ep(a,o))}if(e&&t&&t.decimals!==void 0){const a=Math.pow(10,t.decimals),o=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*a)/a;return l};s===n&&(s=n.clone()),s.applyTransform(o)}return s}const Fme={Point:gi,LineString:bi,Polygon:Ha,MultiPoint:Nd,MultiLineString:ic,MultiPolygon:ld};function Vme(n,e,t){return Array.isArray(e[0])?(Ej(n,0,e,t)||(n=n.slice(),wb(n,0,e,t)),n):(AA(n,0,e,t)||(n=n.slice(),X_(n,0,e,t)),n)}function sB(n,e){const t=n.geometry;if(!t)return[];if(Array.isArray(t))return t.map(s=>sB({...n,geometry:s})).flat();const r=t.type==="MultiPolygon"?"Polygon":t.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const i=t.layout.length;return Ao(new Fs(r,r==="Polygon"?Vme(t.flatCoordinates,t.ends,i):t.flatCoordinates,t.ends?.flat(),i,n.properties||{},n.id).enableSimplifyTransformed(),!1,e)}function aC(n,e){if(!n)return null;if(Array.isArray(n)){const r=n.map(i=>aC(i,e));return new _o(r)}const t=Fme[n.type];return Ao(new t(n.flatCoordinates,n.layout||"XY",n.ends),!1,e)}class Bme extends iB{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(Yy(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(Yy(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return Wt()}readFeaturesFromObject(e,t){return Wt()}readGeometry(e,t){return this.readGeometryFromObject(Yy(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return Wt()}readProjection(e){return this.readProjectionFromObject(Yy(e))}readProjectionFromObject(e){return Wt()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return Wt()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return Wt()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return Wt()}}function Yy(n){if(typeof n=="string"){const e=JSON.parse(n);return e||null}return n!==null?n:null}class oC extends Bme{constructor(e){e=e||{},super(),this.dataProjection=ir(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=ir(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const i=lC(r.geometry);if(this.featureClass===Fs)return sB({geometry:i,id:r.id,properties:r.properties},t);const s=new _r;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(aC(i,t)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,t){const r=e;let i=null;if(r.type==="FeatureCollection"){const s=e;i=[];const a=s.features;for(let o=0,l=a.length;o<l;++o){const c=this.readFeatureFromObject(a[o],t);c&&i.push(c)}}else i=[this.readFeatureFromObject(e,t)];return i.flat()}readGeometryFromObject(e,t){return Gme(e,t)}readProjectionFromObject(e){const t=e.crs;let r;if(t)if(t.type=="name")r=ir(t.properties.name);else if(t.type==="EPSG")r=ir("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,t){t=this.adaptOptions(t);const r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;const s=e.getProperties(),a=e.getGeometry();return a&&(r.geometry=$R(a,t),delete s[e.getGeometryName()]),id(s)||(r.properties=s),r}writeFeaturesObject(e,t){t=this.adaptOptions(t);const r=[];for(let i=0,s=e.length;i<s;++i)r.push(this.writeFeatureObject(e[i],t));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,t){return $R(e,this.adaptOptions(t))}}function lC(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=Ume(n);break}case"LineString":{t=$me(n);break}case"Polygon":{t=Xme(n);break}case"MultiPoint":{t=Hme(n);break}case"MultiLineString":{t=Wme(n);break}case"MultiPolygon":{t=Kme(n);break}case"GeometryCollection":{t=zme(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return t}function Gme(n,e){const t=lC(n);return aC(t,e)}function zme(n,e){return n.geometries.map(function(r){return lC(r)})}function Ume(n){const e=n.coordinates;return{type:"Point",flatCoordinates:e,layout:Pd(e.length)}}function $me(n){const e=n.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:Pd(e[0]?.length||2)}}function Wme(n){const e=n.coordinates,t=e[0]?.[0]?.length||2,r=[],i=R1(r,0,e,t);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:Pd(t)}}function Hme(n){const e=n.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:Pd(e[0]?.length||2)}}function Kme(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.[0].length||2,i=JD(t,0,e,r);return{type:"MultiPolygon",flatCoordinates:t,ends:i,layout:Pd(r)}}function Xme(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.length,i=R1(t,0,e,r);return{type:"Polygon",flatCoordinates:t,ends:i,layout:Pd(r)}}function $R(n,e){n=Ao(n,!0,e);const t=n.getType();let r;switch(t){case"Point":{r=epe(n);break}case"LineString":{r=Yme(n);break}case"Polygon":{r=tpe(n,e);break}case"MultiPoint":{r=Jme(n);break}case"MultiLineString":{r=Zme(n);break}case"MultiPolygon":{r=Qme(n,e);break}case"GeometryCollection":{r=qme(n,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return r}function qme(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(r){return $R(r,e)})}}function Yme(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function Zme(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function Jme(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function Qme(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function epe(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function tpe(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}const ew="http://www.w3.org/2001/XMLSchema-instance";function Vd(n,e){return wg().createElementNS(n,e)}function ko(n,e){return aB(n,e,[]).join("")}function aB(n,e,t){if(n.nodeType==Node.CDATA_SECTION_NODE||n.nodeType==Node.TEXT_NODE)t.push(n.nodeValue);else{let r;for(r=n.firstChild;r;r=r.nextSibling)aB(r,e,t)}return t}function Hl(n){return"documentElement"in n}function Kl(n){return new DOMParser().parseFromString(n,"application/xml")}function SO(n,e){return(function(t,r){const i=n.call(e??this,t,r);if(i!==void 0){const s=r[r.length-1];zn(s,i)}})}function go(n,e){return(function(t,r){const i=n.call(e??this,t,r);i!==void 0&&r[r.length-1].push(i)})}function cC(n,e){return(function(t,r){const i=n.call(this,t,r);i!==void 0&&(r[r.length-1]=i)})}function Ue(n,e,t){return(function(r,i){const s=n.call(this,r,i);if(s!==void 0){const a=i[i.length-1],o=e!==void 0?e:r.localName;a[o]=s}})}function nt(n,e){return(function(t,r,i){n.call(this,t,r,i),i[i.length-1].node.appendChild(t)})}function oB(n,e){let t,r;return function(i,s,a){if(t===void 0){t={};const o={};o[i.localName]=n,t[i.namespaceURI]=o,r=Io(i.localName)}lB(t,r,s,a)}}function Io(n,e){return(function(t,r,i){const a=r[r.length-1].node;let o=n;o===void 0&&(o=i);const l=a.namespaceURI;return Vd(l,o)})}const gs=Io();function Ks(n,e){const t=e.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=n[e[i]];return r}function gt(n,e,t){t=t!==void 0?t:{};let r,i;for(r=0,i=n.length;r<i;++r)t[n[r]]=e;return t}function Ju(n,e,t,r){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const s=n[i.namespaceURI];if(s!==void 0){const a=s[i.localName];a!==void 0&&a.call(r,i,t)}}}function wn(n,e,t,r,i){return r.push(n),Ju(e,t,r,i),r.pop()}function lB(n,e,t,r,i,s){const a=(i!==void 0?i:t).length;let o,l;for(let c=0;c<a;++c)o=t[c],o!==void 0&&(l=e.call(s,o,r,i!==void 0?i[c]:void 0),l!==void 0&&n[l.namespaceURI][l.localName].call(s,l,o,r))}function lr(n,e,t,r,i,s,a){return i.push(n),lB(e,t,r,i,s,a),i.pop()}let BT;function npe(){return BT===void 0&&typeof XMLSerializer<"u"&&(BT=new XMLSerializer),BT}let GT;function wg(){return GT===void 0&&typeof document<"u"&&(GT=document.implementation.createDocument("","",null)),GT}class cB extends iB{constructor(){super(),this.xmlSerializer_=npe()}getType(){return"xml"}readFeature(e,t){if(!e)return null;if(typeof e=="string"){const r=Kl(e);return this.readFeatureFromDocument(r,t)}return Hl(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t)}readFeatureFromDocument(e,t){const r=this.readFeaturesFromDocument(e,t);return r.length>0?r[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(!e)return[];if(typeof e=="string"){const r=Kl(e);return this.readFeaturesFromDocument(r,t)}return Hl(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t)}readFeaturesFromDocument(e,t){const r=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&zn(r,this.readFeaturesFromNode(i,t));return r}readFeaturesFromNode(e,t){return Wt()}readGeometry(e,t){if(!e)return null;if(typeof e=="string"){const r=Kl(e);return this.readGeometryFromDocument(r,t)}return Hl(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t)}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const t=Kl(e);return this.readProjectionFromDocument(t)}return Hl(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){const r=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,t){return null}writeFeatures(e,t){const r=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){const r=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,t){return null}}function zu(n){const e=ko(n,!1);return rpe(e)}function rpe(n){const e=/^\s*(true|1)|(false|0)\s*$/.exec(n);if(e)return e[1]!==void 0||!1}function jE(n){const e=ko(n,!1),t=Date.parse(e);return isNaN(t)?void 0:t/1e3}function Mn(n){const e=ko(n,!1);return ipe(e)}function ipe(n){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(n);if(e)return parseFloat(e[1])}function h1(n){const e=ko(n,!1);return spe(e)}function spe(n){const e=/^\s*(\d+)\s*$/.exec(n);if(e)return parseInt(e[1],10)}function cn(n){return ko(n,!1).trim()}function ag(n,e){Fn(n,e?"1":"0")}function ape(n,e){n.appendChild(wg().createCDATASection(e))}function ope(n,e){const t=new Date(e*1e3),r=t.getUTCFullYear()+"-"+cm(t.getUTCMonth()+1,2)+"-"+cm(t.getUTCDate(),2)+"T"+cm(t.getUTCHours(),2)+":"+cm(t.getUTCMinutes(),2)+":"+cm(t.getUTCSeconds(),2)+"Z";n.appendChild(wg().createTextNode(r))}function Os(n,e){const t=e.toPrecision();n.appendChild(wg().createTextNode(t))}function tw(n,e){const t=e.toString();n.appendChild(wg().createTextNode(t))}const lpe=/^\s/,cpe=/\s$/,upe=/(\n|\t|\r|<|&| {2})/;function Fn(n,e){typeof e=="string"&&(lpe.test(e)||cpe.test(e)||upe.test(e))?e.split("]]>").forEach((t,r,i)=>{r<i.length-1&&(t+="]]"),r>0&&(t=">"+t),ape(n,t)}):n.appendChild(wg().createTextNode(e))}const fr=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],hpe="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",dpe={rte:uB,trk:hB,wpt:dB},fpe=gt(fr,{rte:go(uB),trk:go(hB),wpt:go(dB)}),gpe=gt(fr,{text:Ue(cn,"linkText"),type:Ue(cn,"linkType")}),mpe=gt(fr,{name:Ue(cn),email:zpe,link:ux}),ppe=gt(fr,{name:Ue(cn),desc:Ue(cn),author:Ue(Vpe),copyright:Ue(Bpe),link:ux,time:Ue(jE),keywords:Ue(cn),bounds:Gpe,extensions:FE}),xpe=gt(fr,{year:Ue(h1),license:Ue(cn)}),ype=gt(fr,{rte:nt(Hpe),trk:nt(Kpe),wpt:nt(qpe)});class _pe extends cB{constructor(e){super(),e=e||{},this.dataProjection=ir("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let t=0,r=e.length;t<r;++t){const i=e[t];if(this.readExtensions_){const s=i.get("extensionsNode_")||null;this.readExtensions_(i,s)}i.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(Kl(e)):Hl(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE){const r=this.readMetadataFromNode(t);if(r)return r}return null}readMetadataFromNode(e){if(!fr.includes(e.namespaceURI))return null;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(fr.includes(t.namespaceURI)&&t.localName==="metadata")return wn({},ppe,t,[]);return null}readFeatureFromNode(e,t){if(!fr.includes(e.namespaceURI))return null;const r=dpe[e.localName];if(!r)return null;const i=r(e,[this.getReadOptions(e,t)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,t){if(!fr.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const r=wn([],fpe,e,[this.getReadOptions(e,t)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=Vd("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",ew),r.setAttributeNS(ew,"xsi:schemaLocation",hpe),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),lr({node:r},ype,Fpe,e,[t]),r}}const vpe=gt(fr,{name:Ue(cn),cmt:Ue(cn),desc:Ue(cn),src:Ue(cn),link:ux,number:Ue(h1),extensions:FE,type:Ue(cn),rtept:Upe}),wpe=gt(fr,{ele:Ue(Mn),time:Ue(jE)}),Epe=gt(fr,{name:Ue(cn),cmt:Ue(cn),desc:Ue(cn),src:Ue(cn),link:ux,number:Ue(h1),type:Ue(cn),extensions:FE,trkseg:Wpe}),Spe=gt(fr,{trkpt:$pe}),Tpe=gt(fr,{ele:Ue(Mn),time:Ue(jE)}),bpe=gt(fr,{ele:Ue(Mn),time:Ue(jE),magvar:Ue(Mn),geoidheight:Ue(Mn),name:Ue(cn),cmt:Ue(cn),desc:Ue(cn),src:Ue(cn),link:ux,sym:Ue(cn),type:Ue(cn),fix:Ue(cn),sat:Ue(h1),hdop:Ue(Mn),vdop:Ue(Mn),pdop:Ue(Mn),ageofdgpsdata:Ue(Mn),dgpsid:Ue(h1),extensions:FE}),Rpe=["text","type"],Ape=gt(fr,{text:nt(Fn),type:nt(Fn)}),kpe=gt(fr,["name","cmt","desc","src","link","number","type","rtept"]),Ipe=gt(fr,{name:nt(Fn),cmt:nt(Fn),desc:nt(Fn),src:nt(Fn),link:nt(dC),number:nt(tw),type:nt(Fn),rtept:oB(nt(fC))}),Cpe=gt(fr,["ele","time"]),Ppe=gt(fr,["name","cmt","desc","src","link","number","type","trkseg"]),Npe=gt(fr,{name:nt(Fn),cmt:nt(Fn),desc:nt(Fn),src:nt(Fn),link:nt(dC),number:nt(tw),type:nt(Fn),trkseg:oB(nt(Xpe))}),Mpe=Io("trkpt"),Lpe=gt(fr,{trkpt:nt(fC)}),Ope=gt(fr,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),Dpe=gt(fr,{ele:nt(Os),time:nt(ope),magvar:nt(Os),geoidheight:nt(Os),name:nt(Fn),cmt:nt(Fn),desc:nt(Fn),src:nt(Fn),link:nt(dC),sym:nt(Fn),type:nt(Fn),fix:nt(Fn),sat:nt(tw),hdop:nt(Os),vdop:nt(Os),pdop:nt(Os),ageofdgpsdata:nt(Os),dgpsid:nt(tw)}),jpe={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function Fpe(n,e,t){const r=n.getGeometry();if(r){const i=jpe[r.getType()];if(i){const s=e[e.length-1].node;return Vd(s.namespaceURI,i)}}}function uC(n,e,t,r){return n.push(parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))),"ele"in r?(n.push(r.ele),delete r.ele,e.hasZ=!0):n.push(0),"time"in r?(n.push(r.time),delete r.time,e.hasM=!0):n.push(0),n}function hC(n,e,t){let r="XY",i=2;if(n.hasZ&&n.hasM?(r="XYZM",i=4):n.hasZ?(r="XYZ",i=3):n.hasM&&(r="XYM",i=3),i!==4){for(let s=0,a=e.length/4;s<a;s++)e[s*i]=e[s*4],e[s*i+1]=e[s*4+1],n.hasZ&&(e[s*i+2]=e[s*4+2]),n.hasM&&(e[s*i+2]=e[s*4+3]);if(e.length=e.length/4*i,t)for(let s=0,a=t.length;s<a;s++)t[s]=t[s]/4*i}return r}function Vpe(n,e){const t=wn({},mpe,n,e);if(t)return t}function Bpe(n,e){const t=wn({},xpe,n,e);if(t){const r=n.getAttribute("author");return r!==null&&(t.author=r),t}}function Gpe(n,e){const t=e[e.length-1],r=n.getAttribute("minlat"),i=n.getAttribute("minlon"),s=n.getAttribute("maxlat"),a=n.getAttribute("maxlon");i!==null&&r!==null&&a!==null&&s!==null&&(t.bounds=[[parseFloat(i),parseFloat(r)],[parseFloat(a),parseFloat(s)]])}function zpe(n,e){const t=e[e.length-1],r=n.getAttribute("id"),i=n.getAttribute("domain");r!==null&&i!==null&&(t.email=`${r}@${i}`)}function ux(n,e){const t=e[e.length-1],r=n.getAttribute("href");r!==null&&(t.link=r),Ju(gpe,n,e)}function FE(n,e){const t=e[e.length-1];t.extensionsNode_=n}function Upe(n,e){const t=wn({},wpe,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;uC(i,s,n,t)}}function $pe(n,e){const t=wn({},Tpe,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;uC(i,s,n,t)}}function Wpe(n,e){const t=e[e.length-1];Ju(Spe,n,e);const r=t.flatCoordinates;t.ends.push(r.length)}function uB(n,e){const t=e[0],r=wn({flatCoordinates:[],layoutOptions:{}},vpe,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.layoutOptions;delete r.layoutOptions;const a=hC(s,i),o=new bi(i,a);Ao(o,!1,t);const l=new _r(o);return l.setProperties(r,!0),l}function hB(n,e){const t=e[0],r=wn({flatCoordinates:[],ends:[],layoutOptions:{}},Epe,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.ends;delete r.ends;const a=r.layoutOptions;delete r.layoutOptions;const o=hC(a,i,s),l=new ic(i,o,s);Ao(l,!1,t);const c=new _r(l);return c.setProperties(r,!0),c}function dB(n,e){const t=e[0],r=wn({},bpe,n,e);if(!r)return;const i={},s=uC([],i,n,r),a=hC(i,s),o=new gi(s,a);Ao(o,!1,t);const l=new _r(o);return l.setProperties(r,!0),l}function dC(n,e,t){n.setAttribute("href",e);const i=t[t.length-1].properties,s=[i.linkText,i.linkType];lr({node:n},Ape,gs,s,t,Rpe)}function fC(n,e,t){const r=t[t.length-1],s=r.node.namespaceURI,a=r.properties;switch(n.setAttributeNS(null,"lat",String(e[1])),n.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case"XYZM":e[3]!==0&&(a.time=e[3]);case"XYZ":e[2]!==0&&(a.ele=e[2]);break;case"XYM":e[2]!==0&&(a.time=e[2]);break}const l=n.nodeName=="rtept"?Cpe[s]:Ope[s],c=Ks(a,l);lr({node:n,properties:a},Dpe,gs,c,t,l)}function Hpe(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="LineString"){const h=Ao(a,!0,r);s.geometryLayout=h.getLayout(),i.rtept=h.getCoordinates()}const o=t[t.length-1].node,l=kpe[o.namespaceURI],c=Ks(i,l);lr(s,Ipe,gs,c,t,l)}function Kpe(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="MultiLineString"){const h=Ao(a,!0,r);i.trkseg=h.getLineStrings()}const o=t[t.length-1].node,l=Ppe[o.namespaceURI],c=Ks(i,l);lr(s,Npe,gs,c,t,l)}function Xpe(n,e,t){const r={node:n};r.geometryLayout=e.getLayout(),r.properties={},lr(r,Lpe,Mpe,e.getCoordinates(),t)}function qpe(n,e,t){const r=t[0],i=t[t.length-1];i.properties=e.getProperties();const s=e.getGeometry();if(s.getType()=="Point"){const a=Ao(s,!0,r);i.geometryLayout=a.getLayout(),fC(n,a.getCoordinates(),t)}}const wc=["http://www.google.com/kml/ext/2.2"],Pt=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],Ype="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",TO={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},Zpe=gt(Pt,{ExtendedData:AB,Region:kB,MultiGeometry:Ue(TB,"geometry"),LineString:Ue(EB,"geometry"),LinearRing:Ue(SB,"geometry"),Point:Ue(bB,"geometry"),Polygon:Ue(RB,"geometry"),Style:Ue(pC),StyleMap:L1e,address:Ue(cn),description:Ue(cn),name:Ue(cn),open:Ue(zu),phoneNumber:Ue(cn),styleUrl:Ue(xB),visibility:Ue(zu)},gt(wc,{MultiTrack:Ue(w1e,"geometry"),Track:Ue(wB,"geometry")})),Jpe=gt(Pt,{ExtendedData:AB,Region:kB,Link:H1e,address:Ue(cn),description:Ue(cn),name:Ue(cn),open:Ue(zu),phoneNumber:Ue(cn),visibility:Ue(zu)}),Qpe=gt(Pt,{href:Ue(pB)}),e1e=gt(Pt,{Altitude:Ue(Mn),Longitude:Ue(Mn),Latitude:Ue(Mn),Tilt:Ue(Mn),AltitudeMode:Ue(cn),Heading:Ue(Mn),Roll:Ue(Mn)}),fB=gt(Pt,{LatLonAltBox:V1e,Lod:G1e}),t1e=gt(Pt,["Document","Placemark"]),n1e=gt(Pt,{Document:nt(exe),Placemark:nt(PB)});let R0,L_=null,WR,cp,up,hp,nw,HR=null,gC,KR=null,XR,Xh=null,bO=null,qR=null;function rw(n){return 32/Math.min(n[0],n[1])}function r1e(){R0=[255,255,255,1],L_=new rr({color:R0}),WR=[20,2],cp="pixels",up="pixels",hp=[64,64],nw="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",HR=new I1({anchor:WR,anchorOrigin:"bottom-left",anchorXUnits:cp,anchorYUnits:up,crossOrigin:"anonymous",rotation:0,scale:rw(hp),size:hp,src:nw}),gC="NO_IMAGE",KR=new Yn({color:R0,width:1}),XR=new Yn({color:[51,51,51,1],width:2}),Xh=new vo({font:"bold 16px Helvetica",fill:L_,stroke:XR,scale:.8}),bO=new pn({fill:L_,image:HR,text:Xh,stroke:KR,zIndex:0}),qR=[bO]}let Zy;function i1e(n){return n}class s1e extends cB{constructor(e){super(),e=e||{},qR||r1e(),this.dataProjection=ir("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:qR,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:i1e,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,t){const r=gt(Pt,{Document:SO(this.readDocumentOrFolder_,this),Folder:SO(this.readDocumentOrFolder_,this),Placemark:go(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=wn([],r,e,t,this);if(i)return i}readPlacemark_(e,t){const r=wn({geometry:null},Zpe,e,t,this);if(!r)return;const i=new _r,s=e.getAttribute("id");s!==null&&i.setId(s);const a=t[0],o=r.geometry;if(o&&Ao(o,!1,a),i.setGeometry(o),delete r.geometry,this.extractStyles_){const l=r.Style,c=r.styleUrl,h=o1e(l,c,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(h)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,t){const r=e.getAttribute("id");if(r!==null){const i=pC.call(this,e,t);if(i){let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}}}readSharedStyleMap_(e,t){const r=e.getAttribute("id");if(r===null)return;const i=_B.call(this,e,t);if(!i)return;let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}readFeatureFromNode(e,t){if(!Pt.includes(e.namespaceURI))return null;const r=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return r||null}readFeaturesFromNode(e,t){if(!Pt.includes(e.namespaceURI))return[];let r;const i=e.localName;if(i=="Document"||i=="Folder")return r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]),r||[];if(i=="Placemark"){const s=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return s?[s]:[]}if(i=="kml"){r=[];for(let s=e.firstElementChild;s;s=s.nextElementSibling){const a=this.readFeaturesFromNode(s,t);a&&zn(r,a)}return r}return[]}readName(e){if(e){if(typeof e=="string"){const t=Kl(e);return this.readNameFromDocument(t)}return Hl(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){const r=this.readNameFromNode(t);if(r)return r}}readNameFromNode(e){for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(Pt.includes(t.namespaceURI)&&t.localName=="name")return cn(t);for(let t=e.firstElementChild;t;t=t.nextElementSibling){const r=t.localName;if(Pt.includes(t.namespaceURI)&&(r=="Document"||r=="Folder"||r=="Placemark"||r=="kml")){const i=this.readNameFromNode(t);if(i)return i}}}readNetworkLinks(e){const t=[];if(typeof e=="string"){const r=Kl(e);zn(t,this.readNetworkLinksFromDocument(r))}else Hl(e)?zn(t,this.readNetworkLinksFromDocument(e)):zn(t,this.readNetworkLinksFromNode(e));return t}readNetworkLinksFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&zn(t,this.readNetworkLinksFromNode(r));return t}readNetworkLinksFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Pt.includes(r.namespaceURI)&&r.localName=="NetworkLink"){const i=wn({},Jpe,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Pt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&zn(t,this.readNetworkLinksFromNode(r))}return t}readRegion(e){const t=[];if(typeof e=="string"){const r=Kl(e);zn(t,this.readRegionFromDocument(r))}else Hl(e)?zn(t,this.readRegionFromDocument(e)):zn(t,this.readRegionFromNode(e));return t}readRegionFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&zn(t,this.readRegionFromNode(r));return t}readRegionFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Pt.includes(r.namespaceURI)&&r.localName=="Region"){const i=wn({},fB,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Pt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&zn(t,this.readRegionFromNode(r))}return t}readCamera(e){const t=[];if(typeof e=="string"){const r=Kl(e);zn(t,this.readCameraFromDocument(r))}else Hl(e)?zn(t,this.readCameraFromDocument(e)):zn(t,this.readCameraFromNode(e));return t}readCameraFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&zn(t,this.readCameraFromNode(r));return t}readCameraFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Pt.includes(r.namespaceURI)&&r.localName==="Camera"){const i=wn({},e1e,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Pt.includes(r.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&zn(t,this.readCameraFromNode(r))}return t}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=Vd(Pt[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",wc[0]),r.setAttributeNS(i,"xmlns:xsi",ew),r.setAttributeNS(ew,"xsi:schemaLocation",Ype);const s={node:r},a={};e.length>1?a.Document=e:e.length==1&&(a.Placemark=e[0]);const o=t1e[r.namespaceURI],l=Ks(a,o);return lr(s,n1e,gs,l,[t],o,this),r}}function a1e(n,e){const t=[0,0];let r="start";const i=n.getImage();if(i){const o=i.getSize();if(o&&o.length==2){const l=i.getScaleArray(),c=i.getAnchor();t[0]=l[0]*(o[0]-c[0]),t[1]=l[1]*(o[1]/2-c[1]),r="left"}}let s=n.getText();return s?(s=s.clone(),s.setFont(s.getFont()||Xh.getFont()),s.setScale(s.getScale()||Xh.getScale()),s.setFill(s.getFill()||Xh.getFill()),s.setStroke(s.getStroke()||XR)):s=Xh.clone(),s.setText(e),s.setOffsetX(t[0]),s.setOffsetY(t[1]),s.setTextAlign(r),new pn({image:i,text:s})}function o1e(n,e,t,r,i){return(function(s,a){let o=i,l="",c=[];if(o){const g=s.getGeometry();if(g)if(g instanceof _o)c=g.getGeometriesArrayRecursive().filter(function(m){const x=m.getType();return x==="Point"||x==="MultiPoint"}),o=c.length>0;else{const m=g.getType();o=m==="Point"||m==="MultiPoint"}}o&&(l=s.get("name"),o=o&&!!l,o&&/&[^&]+;/.test(l)&&(Zy||(Zy=document.createElement("textarea")),Zy.innerHTML=l,l=Zy.value));let h=t;if(n?h=n:e&&(h=gB(e,t,r)),o){const g=a1e(h[0],l);if(c.length>0){g.setGeometry(new _o(c));const m=new pn({geometry:h[0].getGeometry(),image:null,fill:h[0].getFill(),stroke:h[0].getStroke(),text:null});return[g,m].concat(h.slice(1))}return g}return h})}function gB(n,e,t){return Array.isArray(n)?n:typeof n=="string"?gB(t[n],e,t):e}function VE(n){const e=ko(n,!1),t=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(t){const r=t[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function mB(n){let e=ko(n,!1);const t=[];e=e.replace(/\s*,\s*/g,",");const r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=r.exec(e);){const s=parseFloat(i[1]),a=parseFloat(i[2]),o=i[3]?parseFloat(i[3]):0;t.push(s,a,o),e=e.substr(i[0].length)}if(e==="")return t}function pB(n){const e=ko(n,!1).trim();let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function xB(n){const e=ko(n,!1).trim().replace(/^(?!.*#)/,"#");let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function l1e(n){const e=n.getAttribute("xunits"),t=n.getAttribute("yunits");let r;return e!=="insetPixels"?t!=="insetPixels"?r="bottom-left":r="top-left":t!=="insetPixels"?r="bottom-right":r="top-right",{x:parseFloat(n.getAttribute("x")),xunits:TO[e],y:parseFloat(n.getAttribute("y")),yunits:TO[t],origin:r}}function yB(n){return Mn(n)}const c1e=gt(Pt,{Pair:M1e});function _B(n,e){return wn(void 0,c1e,n,e,this)}const u1e=gt(Pt,{Icon:Ue(T1e),color:Ue(VE),heading:Ue(Mn),hotSpot:Ue(l1e),scale:Ue(yB)});function h1e(n,e){const t=wn({},u1e,n,e);if(!t)return;const r=e[e.length-1],i="Icon"in t?t.Icon:{},s=!("Icon"in t)||Object.keys(i).length>0;let a;const o=i.href;o?a=o:s&&(a=nw);let l,c,h,g="bottom-left";const m=t.hotSpot;m?(l=[m.x,m.y],c=m.xunits,h=m.yunits,g=m.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(a)&&(a.includes("pushpin")?(l=WR,c=cp,h=up):a.includes("arrow-reverse")?(l=[54,42],c=cp,h=up):a.includes("paddle")&&(l=[32,1],c=cp,h=up));let x;const y=i.x,_=i.y;y!==void 0&&_!==void 0&&(x=[y,_]);let w;const T=i.w,b=i.h;T!==void 0&&b!==void 0&&(w=[T,b]);let R;const M=t.heading;M!==void 0&&(R=ql(M));const D=t.scale,B=t.color;if(s){a==nw&&(w=hp);const k=new I1({anchor:l,anchorOrigin:g,anchorXUnits:c,anchorYUnits:h,crossOrigin:this.crossOrigin_,offset:x,offsetOrigin:"bottom-left",rotation:R,scale:D,size:w,src:this.iconUrlFunction_(a),color:B}),A=k.getScaleArray()[0],C=k.getSize();if(C===null){const O=k.getImageState();if(O===bt.IDLE||O===bt.LOADING){const P=function(){const z=k.getImageState();if(!(z===bt.IDLE||z===bt.LOADING)){const F=k.getSize();if(F&&F.length==2){const xe=rw(F);k.setScale(A*xe)}k.unlistenImageChange(P)}};k.listenImageChange(P),O===bt.IDLE&&k.load()}}else if(C.length==2){const O=rw(C);k.setScale(A*O)}r.imageStyle=k}else r.imageStyle=gC}const d1e=gt(Pt,{color:Ue(VE),scale:Ue(yB)});function f1e(n,e){const t=wn({},d1e,n,e);if(!t)return;const r=e[e.length-1],i=new vo({fill:new rr({color:"color"in t?t.color:R0}),scale:t.scale});r.textStyle=i}const g1e=gt(Pt,{color:Ue(VE),width:Ue(Mn)});function m1e(n,e){const t=wn({},g1e,n,e);if(!t)return;const r=e[e.length-1],i=new Yn({color:"color"in t?t.color:R0,width:"width"in t?t.width:1});r.strokeStyle=i}const p1e=gt(Pt,{color:Ue(VE),fill:Ue(zu),outline:Ue(zu)});function x1e(n,e){const t=wn({},p1e,n,e);if(!t)return;const r=e[e.length-1],i=new rr({color:"color"in t?t.color:R0});r.fillStyle=i;const s=t.fill;s!==void 0&&(r.fill=s);const a=t.outline;a!==void 0&&(r.outline=a)}const y1e=gt(Pt,{coordinates:cC(mB)});function vB(n,e){return wn(null,y1e,n,e)}function _1e(n,e){const r=e[e.length-1].coordinates,i=ko(n,!1),a=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(a){const o=parseFloat(a[1]),l=parseFloat(a[2]),c=parseFloat(a[3]);r.push([o,l,c])}else r.push([])}const v1e=gt(wc,{Track:go(wB)});function w1e(n,e){const t=wn([],v1e,n,e);if(t)return new ic(t)}const E1e=gt(Pt,{when:K1e},gt(wc,{coord:_1e}));function wB(n,e){const t=wn({coordinates:[],whens:[]},E1e,n,e);if(!t)return;const r=[],i=t.coordinates,s=t.whens;for(let a=0,o=Math.min(i.length,s.length);a<o;++a)i[a].length==3&&r.push(i[a][0],i[a][1],i[a][2],s[a]);return new bi(r,"XYZM")}const S1e=gt(Pt,{href:Ue(pB)},gt(wc,{x:Ue(Mn),y:Ue(Mn),w:Ue(Mn),h:Ue(Mn)}));function T1e(n,e){const t=wn({},S1e,n,e);return t||null}const b1e=gt(Pt,{coordinates:cC(mB)});function mC(n,e){return wn(null,b1e,n,e)}const BE=gt(Pt,{extrude:Ue(zu),tessellate:Ue(zu),altitudeMode:Ue(cn)});function EB(n,e){const t=wn({},BE,n,e),r=mC(n,e);if(r){const i=new bi(r,"XYZ");return i.setProperties(t,!0),i}}function SB(n,e){const t=wn({},BE,n,e),r=mC(n,e);if(r){const i=new Ha(r,"XYZ",[r.length]);return i.setProperties(t,!0),i}}const R1e=gt(Pt,{LineString:go(EB),LinearRing:go(SB),MultiGeometry:go(TB),Point:go(bB),Polygon:go(RB)});function TB(n,e){const t=wn([],R1e,n,e);if(!t)return null;if(t.length===0)return new _o(t);let r,i=!0;const s=t[0].getType();let a;for(let o=1,l=t.length;o<l;++o)if(a=t[o],a.getType()!=s){i=!1;break}if(i){let o,l;if(s=="Point"){const c=t[0];o=c.getLayout(),l=c.getFlatCoordinates();for(let h=1,g=t.length;h<g;++h)a=t[h],zn(l,a.getFlatCoordinates());r=new Nd(l,o),zT(r,t)}else if(s=="LineString")r=new ic(t),zT(r,t);else if(s=="Polygon")r=new ld(t),zT(r,t);else if(s=="GeometryCollection"||s.startsWith("Multi"))r=new _o(t);else throw new Error("Unknown geometry type found")}else r=new _o(t);return r}function bB(n,e){const t=wn({},BE,n,e),r=mC(n,e);if(r){const i=new gi(r,"XYZ");return i.setProperties(t,!0),i}}const A1e=gt(Pt,{innerBoundaryIs:U1e,outerBoundaryIs:W1e});function RB(n,e){const t=wn({},BE,n,e),r=wn([null],A1e,n,e);if(r&&r[0]){const i=r[0],s=[i.length];for(let o=1,l=r.length;o<l;++o)zn(i,r[o]),s.push(i.length);const a=new Ha(i,"XYZ",s);return a.setProperties(t,!0),a}}const k1e=gt(Pt,{IconStyle:h1e,LabelStyle:f1e,LineStyle:m1e,PolyStyle:x1e});function pC(n,e){const t=wn({},k1e,n,e,this);if(!t)return null;let r="fillStyle"in t?t.fillStyle:L_;const i=t.fill;i!==void 0&&!i&&(r=null);let s;"imageStyle"in t?t.imageStyle!=gC&&(s=t.imageStyle):s=HR;const a="textStyle"in t?t.textStyle:Xh,o="strokeStyle"in t?t.strokeStyle:KR,l=t.outline;return l!==void 0&&!l?[new pn({geometry:function(c){const h=c.getGeometry(),g=h.getType();if(g==="GeometryCollection"){const m=h;return new _o(m.getGeometriesArrayRecursive().filter(function(x){const y=x.getType();return y!=="Polygon"&&y!=="MultiPolygon"}))}if(g!=="Polygon"&&g!=="MultiPolygon")return h},fill:r,image:s,stroke:o,text:a,zIndex:void 0}),new pn({geometry:function(c){const h=c.getGeometry(),g=h.getType();if(g==="GeometryCollection"){const m=h;return new _o(m.getGeometriesArrayRecursive().filter(function(x){const y=x.getType();return y==="Polygon"||y==="MultiPolygon"}))}if(g==="Polygon"||g==="MultiPolygon")return h},fill:r,stroke:null,zIndex:void 0})]:[new pn({fill:r,image:s,stroke:o,text:a,zIndex:void 0})]}function zT(n,e){const t=e.length,r=new Array(e.length),i=new Array(e.length),s=new Array(e.length);let a,o,l;a=!1,o=!1,l=!1;for(let c=0;c<t;++c){const h=e[c];r[c]=h.get("extrude"),i[c]=h.get("tessellate"),s[c]=h.get("altitudeMode"),a=a||r[c]!==void 0,o=o||i[c]!==void 0,l=l||s[c]}a&&n.set("extrude",r),o&&n.set("tessellate",i),l&&n.set("altitudeMode",s)}const I1e=gt(Pt,{displayName:Ue(cn),value:Ue(cn)});function C1e(n,e){const t=n.getAttribute("name");Ju(I1e,n,e);const r=e[e.length-1];t&&r.displayName?r[t]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:t!==null?r[t]=r.value:r.displayName!==null&&(r[r.displayName]=r.value),delete r.value}const P1e=gt(Pt,{Data:C1e,SchemaData:D1e});function AB(n,e){Ju(P1e,n,e)}function kB(n,e){Ju(fB,n,e)}const N1e=gt(Pt,{Style:Ue(pC),key:Ue(cn),styleUrl:Ue(xB)});function M1e(n,e){const t=wn({},N1e,n,e,this);if(!t)return;const r=t.key;if(r&&r=="normal"){const i=t.styleUrl;i&&(e[e.length-1]=i);const s=t.Style;s&&(e[e.length-1]=s)}}function L1e(n,e){const t=_B.call(this,n,e);if(!t)return;const r=e[e.length-1];if(Array.isArray(t))r.Style=t;else if(typeof t=="string")r.styleUrl=t;else throw new Error("`styleMapValue` has an unknown type")}const O1e=gt(Pt,{SimpleData:j1e});function D1e(n,e){Ju(O1e,n,e)}function j1e(n,e){const t=n.getAttribute("name");if(t!==null){const r=cn(n),i=e[e.length-1];i[t]=r}}const F1e=gt(Pt,{altitudeMode:Ue(cn),minAltitude:Ue(Mn),maxAltitude:Ue(Mn),north:Ue(Mn),south:Ue(Mn),east:Ue(Mn),west:Ue(Mn)});function V1e(n,e){const t=wn({},F1e,n,e);if(!t)return;const r=e[e.length-1],i=[parseFloat(t.west),parseFloat(t.south),parseFloat(t.east),parseFloat(t.north)];r.extent=i,r.altitudeMode=t.altitudeMode,r.minAltitude=parseFloat(t.minAltitude),r.maxAltitude=parseFloat(t.maxAltitude)}const B1e=gt(Pt,{minLodPixels:Ue(Mn),maxLodPixels:Ue(Mn),minFadeExtent:Ue(Mn),maxFadeExtent:Ue(Mn)});function G1e(n,e){const t=wn({},B1e,n,e);if(!t)return;const r=e[e.length-1];r.minLodPixels=parseFloat(t.minLodPixels),r.maxLodPixels=parseFloat(t.maxLodPixels),r.minFadeExtent=parseFloat(t.minFadeExtent),r.maxFadeExtent=parseFloat(t.maxFadeExtent)}const z1e=gt(Pt,{LinearRing:go(vB)});function U1e(n,e){const t=wn([],z1e,n,e);t.length>0&&e[e.length-1].push(...t)}const $1e=gt(Pt,{LinearRing:cC(vB)});function W1e(n,e){const t=wn(void 0,$1e,n,e);if(t){const r=e[e.length-1];r[0]=t}}function H1e(n,e){Ju(Qpe,n,e)}function K1e(n,e){const r=e[e.length-1].whens,i=ko(n,!1),s=Date.parse(i);r.push(isNaN(s)?0:s)}function GE(n,e){const t=Wa(e),i=[(t.length==4?t[3]:1)*255,t[2],t[1],t[0]];for(let s=0;s<4;++s){const a=Math.floor(i[s]).toString(16);i[s]=a.length==1?"0"+a:a}Fn(n,i.join(""))}function X1e(n,e,t){const r=t[t.length-1],i=r.layout,s=r.stride;let a;if(i=="XY"||i=="XYM")a=2;else if(i=="XYZ"||i=="XYZM")a=3;else throw new Error("Invalid geometry layout");const o=e.length;let l="";if(o>0){l+=e[0];for(let c=1;c<a;++c)l+=","+e[c];for(let c=s;c<o;c+=s){l+=" "+e[c];for(let h=1;h<a;++h)l+=","+e[c+h]}}Fn(n,l)}const O_=gt(Pt,{Data:nt(q1e),value:nt(Z1e),displayName:nt(Y1e)});function q1e(n,e,t){n.setAttribute("name",e.name);const r={node:n},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&lr(r,O_,gs,[i.displayName],t,["displayName"]),i!==null&&i.value&&lr(r,O_,gs,[i.value],t,["value"])):lr(r,O_,gs,[i],t,["value"])}function Y1e(n,e){Fn(n,e)}function Z1e(n,e){Fn(n,e)}const J1e=gt(Pt,{Placemark:nt(PB)}),Q1e=function(n,e,t){const r=e[e.length-1].node;return Vd(r.namespaceURI,"Placemark")};function exe(n,e,t){lr({node:n},J1e,Q1e,e,t,void 0,this)}const txe=Io("Data");function nxe(n,e,t){const r={node:n},i=e.names,s=e.values,a=i.length;for(let o=0;o<a;o++)lr(r,O_,txe,[{name:i[o],value:s[o]}],t)}const RO=gt(Pt,["href"],gt(wc,["x","y","w","h"])),AO=gt(Pt,{href:nt(Fn)},gt(wc,{x:nt(Os),y:nt(Os),w:nt(Os),h:nt(Os)})),rxe=function(n,e,t){return Vd(wc[0],"gx:"+t)};function ixe(n,e,t){const r={node:n},i=t[t.length-1].node;let s=RO[i.namespaceURI],a=Ks(e,s);lr(r,AO,gs,a,t,s),s=RO[wc[0]],a=Ks(e,s),lr(r,AO,rxe,a,t,s)}const sxe=gt(Pt,["scale","heading","Icon","color","hotSpot"]),axe=gt(Pt,{Icon:nt(ixe),color:nt(GE),heading:nt(Os),hotSpot:nt(Mxe),scale:nt(MB)});function oxe(n,e,t){const r={node:n},i={},s=e.getSrc(),a=e.getSize(),o=e.getImageSize(),l={href:s};if(a){l.w=a[0],l.h=a[1];const w=e.getAnchor(),T=e.getOrigin();if(T&&o&&T[0]!==0&&T[1]!==a[1]&&(l.x=T[0],l.y=o[1]-(T[1]+a[1])),w&&(w[0]!==a[0]/2||w[1]!==a[1]/2)){const b={x:w[0],xunits:"pixels",y:a[1]-w[1],yunits:"pixels"};i.hotSpot=b}}i.Icon=l;let c=e.getScaleArray()[0],h=a;if(h===null&&(h=hp),h.length==2){const w=rw(h);c=c/w}c!==1&&(i.scale=c);const g=e.getRotation();g!==0&&(i.heading=g);const m=e.getColor();m&&(i.color=m);const x=t[t.length-1].node,y=sxe[x.namespaceURI],_=Ks(i,y);lr(r,axe,gs,_,t,y)}const lxe=gt(Pt,["color","scale"]),cxe=gt(Pt,{color:nt(GE),scale:nt(MB)});function uxe(n,e,t){const r={node:n},i={},s=e.getFill();s&&(i.color=s.getColor());const a=e.getScale();a&&a!==1&&(i.scale=a);const o=t[t.length-1].node,l=lxe[o.namespaceURI],c=Ks(i,l);lr(r,cxe,gs,c,t,l)}const hxe=gt(Pt,["color","width"]),dxe=gt(Pt,{color:nt(GE),width:nt(Os)});function fxe(n,e,t){const r={node:n},i={color:e.getColor(),width:Number(e.getWidth())||1},s=t[t.length-1].node,a=hxe[s.namespaceURI],o=Ks(i,a);lr(r,dxe,gs,o,t,a)}const gxe={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},IB=function(n,e,t){if(n){const r=e[e.length-1].node;return Vd(r.namespaceURI,gxe[n.getType()])}},mxe=Io("Point"),pxe=Io("LineString"),xxe=Io("LinearRing"),yxe=Io("Polygon"),_xe=gt(Pt,{LineString:nt(A0),Point:nt(A0),Polygon:nt(NB),GeometryCollection:nt(CB)});function CB(n,e,t){const r={node:n},i=e.getType();let s=[],a;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(o){const l=o.getType();if(l==="MultiPoint")s=s.concat(o.getPoints());else if(l==="MultiLineString")s=s.concat(o.getLineStrings());else if(l==="MultiPolygon")s=s.concat(o.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")s.push(o);else throw new Error("Unknown geometry type")}),a=IB;else if(i==="MultiPoint")s=e.getPoints(),a=mxe;else if(i==="MultiLineString")s=e.getLineStrings(),a=pxe;else if(i==="MultiPolygon")s=e.getPolygons(),a=yxe;else throw new Error("Unknown geometry type");lr(r,_xe,a,s,t)}const vxe=gt(Pt,{LinearRing:nt(A0)});function kO(n,e,t){lr({node:n},vxe,xxe,[e],t)}const UT=gt(Pt,{ExtendedData:nt(nxe),MultiGeometry:nt(CB),LineString:nt(A0),LinearRing:nt(A0),Point:nt(A0),Polygon:nt(NB),Style:nt(Nxe),address:nt(Fn),description:nt(Fn),name:nt(Fn),open:nt(ag),phoneNumber:nt(Fn),styleUrl:nt(Fn),visibility:nt(ag)}),wxe=gt(Pt,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),Exe=Io("ExtendedData");function PB(n,e,t){const r={node:n};e.getId()&&n.setAttribute("id",e.getId());const i=e.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[e.getGeometryName()]=1;const a=Object.keys(i||{}).sort().filter(function(x){return!s[x]}),o=e.getStyleFunction();if(o){const x=o(e,0);if(x){const y=Array.isArray(x)?x:[x];let _=y;if(e.getGeometry()&&(_=y.filter(function(w){const T=w.getGeometryFunction()(e);if(T){const b=T.getType();return b==="GeometryCollection"?T.getGeometriesArrayRecursive().filter(function(R){const M=R.getType();return M==="Point"||M==="MultiPoint"}).length:b==="Point"||b==="MultiPoint"}})),this.writeStyles_){let w=y,T=y;e.getGeometry()&&(w=y.filter(function(b){const R=b.getGeometryFunction()(e);if(R){const M=R.getType();return M==="GeometryCollection"?R.getGeometriesArrayRecursive().filter(function(D){const B=D.getType();return B==="LineString"||B==="MultiLineString"}).length:M==="LineString"||M==="MultiLineString"}}),T=y.filter(function(b){const R=b.getGeometryFunction()(e);if(R){const M=R.getType();return M==="GeometryCollection"?R.getGeometriesArrayRecursive().filter(function(D){const B=D.getType();return B==="Polygon"||B==="MultiPolygon"}).length:M==="Polygon"||M==="MultiPolygon"}})),i.Style={pointStyles:_,lineStyles:w,polyStyles:T}}if(_.length&&i.name===void 0){const w=_[0].getText();w&&(i.name=w.getText())}}}const l=t[t.length-1].node,c=wxe[l.namespaceURI],h=Ks(i,c);if(lr(r,UT,gs,h,t,c),a.length>0){const x=Ks(i,a);lr(r,UT,Exe,[{names:a,values:x}],t)}const g=t[0];let m=e.getGeometry();m&&(m=Ao(m,!0,g)),lr(r,UT,IB,[m],t)}const Sxe=gt(Pt,["extrude","tessellate","altitudeMode","coordinates"]),Txe=gt(Pt,{extrude:nt(ag),tessellate:nt(ag),altitudeMode:nt(Fn),coordinates:nt(X1e)});function A0(n,e,t){const r=e.getFlatCoordinates(),i={node:n};i.layout=e.getLayout(),i.stride=e.getStride();const s=e.getProperties();s.coordinates=r;const a=t[t.length-1].node,o=Sxe[a.namespaceURI],l=Ks(s,o);lr(i,Txe,gs,l,t,o)}const bxe=gt(Pt,["color","fill","outline"]),IO=gt(Pt,{outerBoundaryIs:nt(kO),innerBoundaryIs:nt(kO)}),Rxe=Io("innerBoundaryIs"),Axe=Io("outerBoundaryIs");function NB(n,e,t){const r=e.getLinearRings(),i=r.shift(),s={node:n};lr(s,IO,Rxe,r,t),lr(s,IO,Axe,[i],t)}const kxe=gt(Pt,{color:nt(GE),fill:nt(ag),outline:nt(ag)});function Ixe(n,e,t){const r={node:n},i=e.getFill(),s=e.getStroke(),a={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:s?void 0:!1},o=t[t.length-1].node,l=bxe[o.namespaceURI],c=Ks(a,l);lr(r,kxe,gs,c,t,l)}function MB(n,e){Os(n,Math.round(e*1e6)/1e6)}const Cxe=gt(Pt,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),Pxe=gt(Pt,{IconStyle:nt(oxe),LabelStyle:nt(uxe),LineStyle:nt(fxe),PolyStyle:nt(Ixe)});function Nxe(n,e,t){const r={node:n},i={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(i.LabelStyle=l);const c=e.pointStyles[0].getImage();c&&typeof c.getSrc=="function"&&(i.IconStyle=c)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(i.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!i.LineStyle&&(i.LineStyle=l),i.PolyStyle=e.polyStyles[0]}const s=t[t.length-1].node,a=Cxe[s.namespaceURI],o=Ks(i,a);lr(r,Pxe,gs,o,t,a)}function Mxe(n,e){n.setAttribute("x",String(e.x)),n.setAttribute("y",String(e.y)),n.setAttribute("xunits",e.xunits),n.setAttribute("yunits",e.yunits)}function LB(n){const e=Object.keys(n.defs),t=e.length;let r,i;for(r=0;r<t;++r){const s=e[r];if(!o_(s)){const a=n.defs(s);let o=a.units;!o&&a.projName==="longlat"&&(o="degrees"),z_(new bw({code:s,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:o}))}}for(r=0;r<t;++r){const s=e[r],a=o_(s);for(i=0;i<t;++i){const o=e[i],l=o_(o);if(!l_(s,o))if(n.defs[s]===n.defs[o])db([a,l]);else{const c=n(s,o);b$(a,l,gN(a,l,c.forward),gN(l,a,c.inverse))}}}}console.log(" parcelHighlight.ts v3.1 loaded - fixed pixelRatio for Android");bn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");LB(bn);let qh=null,dp=null,t0=null;function YR(n){qh&&(n.removeLayer(qh),qh=null),dp&&(n.removeLayer(dp),dp=null),t0=null}async function Lxe(n,e){try{const t=Tn(e);console.log(` Click (3857): ${e[0].toFixed(0)}, ${e[1].toFixed(0)}`),console.log(` LonLat (WGS84): ${t[0].toFixed(5)}, ${t[1].toFixed(5)}`);const r=bn("EPSG:4326","EPSG:28992",t);if(console.log(` RD (28992): ${r?r[0].toFixed(0)+", "+r[1].toFixed(0):"FAILED"}`),!r||r[0]<7e3||r[0]>3e5||r[1]<289e3||r[1]>629e3)return console.error(" Coordinate outside Netherlands or transformation failed:",r),!1;YR(n);const i=1,s=`${r[0]-i},${r[1]-i},${r[0]+i},${r[1]+i}`,a=Date.now(),o=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&BBOX=${s},EPSG:28992&_=${a}`;console.log(" WFS URL:",o);const l=new AbortController,c=setTimeout(()=>l.abort(),1e4),h=await fetch(o,{signal:l.signal});if(clearTimeout(c),!h.ok)return console.error("WFS request failed:",h.status),!1;const g=await h.json();if(console.log(" WFS RESPONSE:",JSON.stringify(g).substring(0,500)),!g.features||g.features.length===0)return console.log("No parcel found at location"),!1;const m=g.features[0];console.log(" PARCEL ID:",m.id||m.properties?.id||"geen ID"),console.log(" PARCEL BBOX:",JSON.stringify(m.bbox||"geen bbox"));const y=new oC().readFeature(m,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),_=y.getGeometry();if(!_)return console.log("No geometry in parcel feature"),!1;const w=m.properties||{};console.log(` Parcel: ${w.category||"unknown"} - ${w.gewasnaam||w.gewas||"geen gewas"}`),console.log(` Geometry type: ${_.getType()}, extent: ${_.getExtent().map(C=>C.toFixed(0)).join(", ")}`);const T=_.getExtent(),b=T[2]-T[0],R=T[3]-T[1],M=Math.max(b,R)*.05,D=[T[0]-M,T[1]-M,T[2]+M,T[3]+M],B=Math.max(b,R)*.3,k=[T[0]-B,T[1]-B,T[2]+B,T[3]+B];t0=_,qh=new yX({source:new WX({url:"https://ahn.arcgisonline.nl/arcgis/rest/services/Hoogtebestand/AHN4_DTM_50cm/ImageServer",params:{renderingRule:JSON.stringify({rasterFunction:"AHN - Color Ramp D"})},crossOrigin:"anonymous"}),extent:D,zIndex:998}),qh.on("prerender",C=>{if(!t0)return;const O=C.context;if(!O)return;const P=C.frameState;if(!P)return;O.save(),O.beginPath(),(t0.getType()==="Polygon"?t0.getCoordinates()[0]:t0.getCoordinates()[0][0]).forEach((F,xe)=>{const Ce=n.getPixelFromCoordinate(F);if(!Ce)return;const Ge=P.pixelRatio,Ne=Ce[0]*Ge,ue=Ce[1]*Ge;xe===0?O.moveTo(Ne,ue):O.lineTo(Ne,ue)}),O.closePath(),O.clip()}),qh.on("postrender",C=>{const O=C.context;O&&O.restore()}),n.addLayer(qh);const A=new mc({features:[y]});return dp=new Hu({source:A,style:new pn({fill:new rr({color:"rgba(0, 0, 0, 0)"}),stroke:new Yn({color:"#dc2626",width:3})}),zIndex:999}),n.addLayer(dp),console.log(" Parcel height map displayed"),!0}catch(t){return console.error("Failed to show parcel height map:",t),!1}}var iw={};iw.version="0.18.5";var OB=1252,Oxe=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],DB=function(n){Oxe.indexOf(n)!=-1&&(OB=n)};function Dxe(){DB(1252)}var d1=function(n){DB(n)};function jxe(){d1(1200),Dxe()}var Jy=function(e){return String.fromCharCode(e)},CO=function(e){return String.fromCharCode(e)},sw,yu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function f1(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0,c=0;c<n.length;)t=n.charCodeAt(c++),s=t>>2,r=n.charCodeAt(c++),a=(t&3)<<4|r>>4,i=n.charCodeAt(c++),o=(r&15)<<2|i>>6,l=i&63,isNaN(r)?o=l=64:isNaN(i)&&(l=64),e+=yu.charAt(s)+yu.charAt(a)+yu.charAt(o)+yu.charAt(l);return e}function dc(n){var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<n.length;)s=yu.indexOf(n.charAt(c++)),a=yu.indexOf(n.charAt(c++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=yu.indexOf(n.charAt(c++)),r=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(r)),l=yu.indexOf(n.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var jn=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ec=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Td(n){return jn?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function PO(n){return jn?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var mo=function(e){return jn?Ec(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function zE(n){if(typeof ArrayBuffer>"u")return mo(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),r=0;r!=n.length;++r)t[r]=n.charCodeAt(r)&255;return e}function hx(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function Fxe(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var Hi=jn?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:Ec(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0,t=0;e<n.length;t+=i,++e)if(i=n[e].length,n[e]instanceof Uint8Array)r.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";r.set(new Uint8Array(n[e]),t)}return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Vxe(n){for(var e=[],t=0,r=n.length+250,i=Td(n.length+255),s=0;s<n.length;++s){var a=n.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=n.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>r&&(e.push(i.slice(0,t)),t=0,i=Td(65535),r=65530)}return e.push(i.slice(0,t)),Hi(e)}var fp=/\u0000/g,Qy=/[\u0001-\u0006]/g;function k0(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function yo(n,e){var t=""+n;return t.length>=e?t:Fr("0",e-t.length)+t}function xC(n,e){var t=""+n;return t.length>=e?t:Fr(" ",e-t.length)+t}function aw(n,e){var t=""+n;return t.length>=e?t:t+Fr(" ",e-t.length)}function Bxe(n,e){var t=""+Math.round(n);return t.length>=e?t:Fr("0",e-t.length)+t}function Gxe(n,e){var t=""+n;return t.length>=e?t:Fr("0",e-t.length)+t}var NO=Math.pow(2,32);function Vf(n,e){if(n>NO||n<-NO)return Bxe(n,e);var t=Math.round(n);return Gxe(t,e)}function ow(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var MO=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],$T=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function zxe(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var Br={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},LO={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Uxe={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function lw(n,e,t){for(var r=n<0?-1:1,i=n*r,s=0,a=1,o=0,l=1,c=0,h=0,g=Math.floor(i);c<e&&(g=Math.floor(i),o=g*a+s,h=g*c+l,!(i-g<5e-8));)i=1/(i-g),s=a,a=o,l=c,c=h;if(h>e&&(c>e?(h=l,o=s):(h=c,o=a)),!t)return[0,r*o,h];var m=Math.floor(r*o/h);return[m,r*o-m*h,h]}function e_(n,e,t){if(n>2958465||n<0)return null;var r=n|0,i=Math.floor(86400*(n-r)),s=0,a=[],o={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++r,++o.D)),r===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),t&&(s=Yxe(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var jB=new Date(1899,11,31,0,0,0),$xe=jB.getTime(),Wxe=new Date(1900,2,1,0,0,0);function FB(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=Wxe&&(t+=1440*60*1e3),(t-($xe+(n.getTimezoneOffset()-jB.getTimezoneOffset())*6e4))/(1440*60*1e3)}function yC(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Hxe(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Kxe(n){var e=n<0?12:11,t=yC(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function Xxe(n){var e=yC(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function qxe(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=Kxe(n):e===10?t=n.toFixed(10).substr(0,12):t=Xxe(n),yC(Hxe(t.toUpperCase()))}function ZR(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):qxe(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return Uu(14,FB(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function Yxe(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function Zxe(n,e,t,r){var i="",s=0,a=0,o=t.y,l,c=0;switch(n){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,c=e.length;break;case 3:return $T[t.m-1][1];case 5:return $T[t.m-1][0];default:return $T[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,c=e.length;break;case 3:return MO[t.q][0];default:return MO[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?yo(t.S,e.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=yo(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var h=c>0?yo(l,c):"";return h}function _u(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var VB=/%/g;function Jxe(n,e,t){var r=e.replace(VB,""),i=e.length-r.length;return ec(n,r,t*Math.pow(10,2*i))+Fr("%",i)}function Qxe(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return ec(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function BB(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+BB(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var GB=/# (\?+)( ?)\/( ?)(\d+)/;function eye(n,e,t){var r=parseInt(n[4],10),i=Math.round(e*r),s=Math.floor(i/r),a=i-s*r,o=r;return t+(s===0?"":""+s)+" "+(a===0?Fr(" ",n[1].length+1+n[4].length):xC(a,n[1].length)+n[2]+"/"+n[3]+yo(o,n[4].length))}function tye(n,e,t){return t+(e===0?"":""+e)+Fr(" ",n[1].length+2+n[4].length)}var zB=/^#*0*\.([0#]+)/,UB=/\).*[0#]/,$B=/\(###\) ###\\?-####/;function vs(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function OO(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function DO(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function nye(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function rye(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Ia(n,e,t){if(n.charCodeAt(0)===40&&!e.match(UB)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ia("n",r,t):"("+Ia("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Qxe(n,e,t);if(e.indexOf("%")!==-1)return Jxe(n,e,t);if(e.indexOf("E")!==-1)return BB(e,t);if(e.charCodeAt(0)===36)return"$"+Ia(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+Vf(l,e.length);if(e.match(/^[#?]+$/))return i=Vf(t,0),i==="0"&&(i=""),i.length>e.length?i:vs(e.substr(0,e.length-i.length))+i;if(s=e.match(GB))return eye(s,l,c);if(e.match(/^#+0+$/))return c+Vf(l,e.length-e.indexOf("0"));if(s=e.match(zB))return i=OO(t,s[1].length).replace(/^([^\.]+)$/,"$1."+vs(s[1])).replace(/\.$/,"."+vs(s[1])).replace(/\.(\d*)$/,function(y,_){return"."+_+Fr("0",vs(s[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+OO(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+_u(Vf(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ia(n,e,-t):_u(""+(Math.floor(t)+nye(t,s[1].length)))+"."+yo(DO(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Ia(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=k0(Ia(n,e.replace(/[\\-]/g,""),t)),a=0,k0(k0(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match($B))return i=Ia(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=lw(l,Math.pow(10,a)-1,!1),i=""+c,h=ec("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=aw(o[2],a),h.length<s[4].length&&(h=vs(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=lw(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?xC(o[1],a)+s[2]+"/"+s[3]+aw(o[2],a):Fr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Vf(t,0),e.length<=i.length?i:vs(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var g=e.indexOf(".")-a,m=e.length-i.length-g;return vs(e.substr(0,g)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=DO(t,s[1].length),t<0?"-"+Ia(n,e,-t):_u(rye(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?yo(0,3-y.length):"")+y})+"."+yo(a,s[1].length);switch(e){case"###,##0.00":return Ia(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var x=_u(Vf(l,0));return x!=="0"?c+x:"";case"###,###.00":return Ia(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ia(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function iye(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return ec(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function sye(n,e,t){var r=e.replace(VB,""),i=e.length-r.length;return ec(n,r,t*Math.pow(10,2*i))+Fr("%",i)}function WB(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+WB(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Xo(n,e,t){if(n.charCodeAt(0)===40&&!e.match(UB)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Xo("n",r,t):"("+Xo("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return iye(n,e,t);if(e.indexOf("%")!==-1)return sye(n,e,t);if(e.indexOf("E")!==-1)return WB(e,t);if(e.charCodeAt(0)===36)return"$"+Xo(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+yo(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:vs(e.substr(0,e.length-i.length))+i;if(s=e.match(GB))return tye(s,l,c);if(e.match(/^#+0+$/))return c+yo(l,e.length-e.indexOf("0"));if(s=e.match(zB))return i=(""+t).replace(/^([^\.]+)$/,"$1."+vs(s[1])).replace(/\.$/,"."+vs(s[1])),i=i.replace(/\.(\d*)$/,function(y,_){return"."+_+Fr("0",vs(s[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+_u(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Xo(n,e,-t):_u(""+t)+"."+Fr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Xo(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=k0(Xo(n,e.replace(/[\\-]/g,""),t)),a=0,k0(k0(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match($B))return i=Xo(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=lw(l,Math.pow(10,a)-1,!1),i=""+c,h=ec("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=aw(o[2],a),h.length<s[4].length&&(h=vs(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=lw(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?xC(o[1],a)+s[2]+"/"+s[3]+aw(o[2],a):Fr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:vs(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var g=e.indexOf(".")-a,m=e.length-i.length-g;return vs(e.substr(0,g)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Xo(n,e,-t):_u(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?yo(0,3-y.length):"")+y})+"."+yo(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var x=_u(""+l);return x!=="0"?c+x:"";default:if(e.match(/\.[0#?]*$/))return Xo(n,e.slice(0,e.lastIndexOf(".")),t)+vs(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ec(n,e,t){return(t|0)===t?Xo(n,e,t):Ia(n,e,t)}function aye(n){for(var e=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(i,r-i),i=r+1}if(e[e.length]=n.substr(i),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var HB=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function KB(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":ow(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match(HB))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function oye(n,e,t,r){for(var i=[],s="",a=0,o="",l="t",c,h,g,m="H";a<n.length;)switch(o=n.charAt(a)){case"G":if(!ow(n,a))throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(g=n.charCodeAt(++a))!==34&&a<n.length;)s+=String.fromCharCode(g);i[i.length]={t:"t",v:s},++a;break;case"\\":var x=n.charAt(++a),y=x==="("||x===")"?x:"t";i[i.length]={t:y,v:x},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(n.charAt(a+1)==="1"||n.charAt(a+1)==="2"){if(c==null&&(c=e_(e,t,n.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:n.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=e_(e,t),c==null))return"";for(s=o;++a<n.length&&n.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var _={t:o,v:o};if(c==null&&(c=e_(e,t)),n.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(_.v=c.H>=12?"P":"A"),_.t="T",m="h",a+=3):n.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(_.v=c.H>=12?"PM":"AM"),_.t="T",a+=5,m="h"):n.substr(a,5).toUpperCase()==="/"?(c!=null&&(_.v=c.H>=12?"":""),_.t="T",a+=5,m="h"):(_.t="t",++a),c==null&&_.t==="T")return"";i[i.length]=_,l=o;break;case"[":for(s=o;n.charAt(a++)!=="]"&&a<n.length;)s+=n.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(HB)){if(c==null&&(c=e_(e,t),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",KB(n)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<n.length&&(o=n.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<n.length&&"0#?.,E+-%".indexOf(o=n.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;n.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(n.charAt(a)==" "||n.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:r===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<n.length&&"0123456789".indexOf(n.charAt(++a))>-1;)s+=n.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"t",v:o},++a;break}var w=0,T=0,b;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=m,l="h",w<1&&(w=1);break;case"s":(b=i[a].v.match(/\.0+$/))&&(T=Math.max(T,b[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[a].v.match(/[Hh]/)&&(w=1),w<2&&i[a].v.match(/[Mm]/)&&(w=2),w<3&&i[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var R="",M;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=Zxe(i[a].t.charCodeAt(0),i[a].v,c,T),i[a].t="t";break;case"n":case"?":for(M=a+1;i[M]!=null&&((o=i[M].t)==="?"||o==="D"||(o===" "||o==="t")&&i[M+1]!=null&&(i[M+1].t==="?"||i[M+1].t==="t"&&i[M+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[M].v==="/"||i[M].v===" "&&i[M+1]!=null&&i[M+1].t=="?"));)i[a].v+=i[M].v,i[M]={v:"",t:";"},++M;R+=i[a].v,a=M-1;break;case"G":i[a].t="t",i[a].v=ZR(e,t);break}var D="",B,k;if(R.length>0){R.charCodeAt(0)==40?(B=e<0&&R.charCodeAt(0)===45?-e:e,k=ec("n",R,B)):(B=e<0&&r>1?-e:e,k=ec("n",R,B),B<0&&i[0]&&i[0].t=="t"&&(k=k.substr(1),i[0].v="-"+i[0].v)),M=k.length-1;var A=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){A=a;break}var C=i.length;if(A===i.length&&k.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(M>=i[a].v.length-1?(M-=i[a].v.length,i[a].v=k.substr(M+1,i[a].v.length)):M<0?i[a].v="":(i[a].v=k.substr(0,M+1),M=-1),i[a].t="t",C=a);M>=0&&C<i.length&&(i[C].v=k.substr(0,M+1)+i[C].v)}else if(A!==i.length&&k.indexOf("E")===-1){for(M=k.indexOf(".")-1,a=A;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===A?i[a].v.indexOf(".")-1:i[a].v.length-1,D=i[a].v.substr(h+1);h>=0;--h)M>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(D=k.charAt(M--)+D);i[a].v=D,i[a].t="t",C=a}for(M>=0&&C<i.length&&(i[C].v=k.substr(0,M+1)+i[C].v),M=k.indexOf(".")+1,a=A;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==A)){for(h=i[a].v.indexOf(".")>-1&&a===A?i[a].v.indexOf(".")+1:0,D=i[a].v.substr(0,h);h<i[a].v.length;++h)M<k.length&&(D+=k.charAt(M++));i[a].v=D,i[a].t="t",C=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(B=r>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=ec(i[a].t,i[a].v,B),i[a].t="t");var O="";for(a=0;a!==i.length;++a)i[a]!=null&&(O+=i[a].v);return O}var jO=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function FO(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function lye(n,e){var t=aye(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(jO),o=t[1].match(jO);return FO(e,a)?[r,t[0]]:FO(e,o)?[r,t[1]]:[r,t[a!=null&&o!=null?2:1]]}return[r,s]}function Uu(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:Br)[n],r==null&&(r=t.table&&t.table[LO[n]]||Br[LO[n]]),r==null&&(r=Uxe[n]||"General");break}if(ow(r,0))return ZR(e,t);e instanceof Date&&(e=FB(e,t.date1904));var i=lye(r,e);if(ow(i[1]))return ZR(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return oye(i[1],e,t,i[0])}function XB(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Br[t]==null){e<0&&(e=t);continue}if(Br[t]==n){e=t;break}}e<0&&(e=391)}return Br[e]=n,e}function UE(n){for(var e=0;e!=392;++e)n[e]!==void 0&&XB(n[e],e)}function $E(){Br=zxe()}var qB=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function cye(n){var e=typeof n=="number"?Br[n]:n;return e=e.replace(qB,"(\\d+)"),new RegExp("^"+e+"$")}function uye(n,e,t){var r=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(qB)||[]).forEach(function(g,m){var x=parseInt(t[m+1],10);switch(g.toLowerCase().charAt(0)){case"y":r=x;break;case"d":s=x;break;case"h":a=x;break;case"s":l=x;break;case"m":a>=0?o=x:i=x;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:r==-1&&i==-1&&s==-1?h:c+"T"+h}var hye=(function(){var n={};n.version="1.2.0";function e(){for(var k=0,A=new Array(256),C=0;C!=256;++C)k=C,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,A[C]=k;return typeof Int32Array<"u"?new Int32Array(A):A}var t=e();function r(k){var A=0,C=0,O=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)P[O]=k[O];for(O=0;O!=256;++O)for(C=k[O],A=256+O;A<4096;A+=256)C=P[A]=C>>>8^k[C&255];var z=[];for(O=1;O!=16;++O)z[O-1]=typeof Int32Array<"u"?P.subarray(O*256,O*256+256):P.slice(O*256,O*256+256);return z}var i=r(t),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],h=i[5],g=i[6],m=i[7],x=i[8],y=i[9],_=i[10],w=i[11],T=i[12],b=i[13],R=i[14];function M(k,A){for(var C=A^-1,O=0,P=k.length;O<P;)C=C>>>8^t[(C^k.charCodeAt(O++))&255];return~C}function D(k,A){for(var C=A^-1,O=k.length-15,P=0;P<O;)C=R[k[P++]^C&255]^b[k[P++]^C>>8&255]^T[k[P++]^C>>16&255]^w[k[P++]^C>>>24]^_[k[P++]]^y[k[P++]]^x[k[P++]]^m[k[P++]]^g[k[P++]]^h[k[P++]]^c[k[P++]]^l[k[P++]]^o[k[P++]]^a[k[P++]]^s[k[P++]]^t[k[P++]];for(O+=15;P<O;)C=C>>>8^t[(C^k[P++])&255];return~C}function B(k,A){for(var C=A^-1,O=0,P=k.length,z=0,F=0;O<P;)z=k.charCodeAt(O++),z<128?C=C>>>8^t[(C^z)&255]:z<2048?(C=C>>>8^t[(C^(192|z>>6&31))&255],C=C>>>8^t[(C^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,F=k.charCodeAt(O++)&1023,C=C>>>8^t[(C^(240|z>>8&7))&255],C=C>>>8^t[(C^(128|z>>2&63))&255],C=C>>>8^t[(C^(128|F>>6&15|(z&3)<<4))&255],C=C>>>8^t[(C^(128|F&63))&255]):(C=C>>>8^t[(C^(224|z>>12&15))&255],C=C>>>8^t[(C^(128|z>>6&63))&255],C=C>>>8^t[(C^(128|z&63))&255]);return~C}return n.table=t,n.bstr=M,n.buf=D,n.str=B,n})(),nr=(function(){var e={};e.version="1.2.1";function t(G,J){for(var X=G.split("/"),Y=J.split("/"),te=0,ne=0,Ee=Math.min(X.length,Y.length);te<Ee;++te){if(ne=X[te].length-Y[te].length)return ne;if(X[te]!=Y[te])return X[te]<Y[te]?-1:1}return X.length-Y.length}function r(G){if(G.charAt(G.length-1)=="/")return G.slice(0,-1).indexOf("/")===-1?G:r(G.slice(0,-1));var J=G.lastIndexOf("/");return J===-1?G:G.slice(0,J+1)}function i(G){if(G.charAt(G.length-1)=="/")return i(G.slice(0,-1));var J=G.lastIndexOf("/");return J===-1?G:G.slice(J+1)}function s(G,J){typeof J=="string"&&(J=new Date(J));var X=J.getHours();X=X<<6|J.getMinutes(),X=X<<5|J.getSeconds()>>>1,G.write_shift(2,X);var Y=J.getFullYear()-1980;Y=Y<<4|J.getMonth()+1,Y=Y<<5|J.getDate(),G.write_shift(2,Y)}function a(G){var J=G.read_shift(2)&65535,X=G.read_shift(2)&65535,Y=new Date,te=X&31;X>>>=5;var ne=X&15;X>>>=4,Y.setMilliseconds(0),Y.setFullYear(X+1980),Y.setMonth(ne-1),Y.setDate(te);var Ee=J&31;J>>>=5;var Oe=J&63;return J>>>=6,Y.setHours(J),Y.setMinutes(Oe),Y.setSeconds(Ee<<1),Y}function o(G){oa(G,0);for(var J={},X=0;G.l<=G.length-4;){var Y=G.read_shift(2),te=G.read_shift(2),ne=G.l+te,Ee={};switch(Y){case 21589:X=G.read_shift(1),X&1&&(Ee.mtime=G.read_shift(4)),te>5&&(X&2&&(Ee.atime=G.read_shift(4)),X&4&&(Ee.ctime=G.read_shift(4))),Ee.mtime&&(Ee.mt=new Date(Ee.mtime*1e3));break}G.l=ne,J[Y]=Ee}return J}var l;function c(){return l||(l={})}function h(G,J){if(G[0]==80&&G[1]==75)return jt(G,J);if((G[0]|32)==109&&(G[1]|32)==105)return ze(G,J);if(G.length<512)throw new Error("CFB file size "+G.length+" < 512");var X=3,Y=512,te=0,ne=0,Ee=0,Oe=0,we=0,Te=[],be=G.slice(0,512);oa(be,0);var Ye=g(be);switch(X=Ye[0],X){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(Ye[1]==0)return jt(G,J);default:throw new Error("Major Version: Expected 3 or 4 saw "+X)}Y!==512&&(be=G.slice(0,Y),oa(be,28));var it=G.slice(0,Y);m(be,X);var pt=be.read_shift(4,"i");if(X===3&&pt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pt);be.l+=4,Ee=be.read_shift(4,"i"),be.l+=4,be.chk("00100000","Mini Stream Cutoff Size: "),Oe=be.read_shift(4,"i"),te=be.read_shift(4,"i"),we=be.read_shift(4,"i"),ne=be.read_shift(4,"i");for(var Ze=-1,Je=0;Je<109&&(Ze=be.read_shift(4,"i"),!(Ze<0));++Je)Te[Je]=Ze;var qt=x(G,Y);w(we,ne,qt,Y,Te);var Gn=b(qt,Ee,Te,Y);Gn[Ee].name="!Directory",te>0&&Oe!==F&&(Gn[Oe].name="!MiniFAT"),Gn[Te[0]].name="!FAT",Gn.fat_addrs=Te,Gn.ssz=Y;var Wn={},pr=[],Ya=[],_a=[];R(Ee,Gn,qt,pr,te,Wn,Ya,Oe),y(Ya,_a,pr),pr.shift();var Zs={FileIndex:Ya,FullPaths:_a};return J&&J.raw&&(Zs.raw={header:it,sectors:qt}),Zs}function g(G){if(G[G.l]==80&&G[G.l+1]==75)return[0,0];G.chk(xe,"Header Signature: "),G.l+=16;var J=G.read_shift(2,"u");return[G.read_shift(2,"u"),J]}function m(G,J){var X=9;switch(G.l+=2,X=G.read_shift(2)){case 9:if(J!=3)throw new Error("Sector Shift: Expected 9 saw "+X);break;case 12:if(J!=4)throw new Error("Sector Shift: Expected 12 saw "+X);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+X)}G.chk("0600","Mini Sector Shift: "),G.chk("000000000000","Reserved: ")}function x(G,J){for(var X=Math.ceil(G.length/J)-1,Y=[],te=1;te<X;++te)Y[te-1]=G.slice(te*J,(te+1)*J);return Y[X-1]=G.slice(X*J),Y}function y(G,J,X){for(var Y=0,te=0,ne=0,Ee=0,Oe=0,we=X.length,Te=[],be=[];Y<we;++Y)Te[Y]=be[Y]=Y,J[Y]=X[Y];for(;Oe<be.length;++Oe)Y=be[Oe],te=G[Y].L,ne=G[Y].R,Ee=G[Y].C,Te[Y]===Y&&(te!==-1&&Te[te]!==te&&(Te[Y]=Te[te]),ne!==-1&&Te[ne]!==ne&&(Te[Y]=Te[ne])),Ee!==-1&&(Te[Ee]=Y),te!==-1&&Y!=Te[Y]&&(Te[te]=Te[Y],be.lastIndexOf(te)<Oe&&be.push(te)),ne!==-1&&Y!=Te[Y]&&(Te[ne]=Te[Y],be.lastIndexOf(ne)<Oe&&be.push(ne));for(Y=1;Y<we;++Y)Te[Y]===Y&&(ne!==-1&&Te[ne]!==ne?Te[Y]=Te[ne]:te!==-1&&Te[te]!==te&&(Te[Y]=Te[te]));for(Y=1;Y<we;++Y)if(G[Y].type!==0){if(Oe=Y,Oe!=Te[Oe])do Oe=Te[Oe],J[Y]=J[Oe]+"/"+J[Y];while(Oe!==0&&Te[Oe]!==-1&&Oe!=Te[Oe]);Te[Y]=-1}for(J[0]+="/",Y=1;Y<we;++Y)G[Y].type!==2&&(J[Y]+="/")}function _(G,J,X){for(var Y=G.start,te=G.size,ne=[],Ee=Y;X&&te>0&&Ee>=0;)ne.push(J.slice(Ee*z,Ee*z+z)),te-=z,Ee=Vh(X,Ee*4);return ne.length===0?Le(0):Hi(ne).slice(0,G.size)}function w(G,J,X,Y,te){var ne=F;if(G===F){if(J!==0)throw new Error("DIFAT chain shorter than expected")}else if(G!==-1){var Ee=X[G],Oe=(Y>>>2)-1;if(!Ee)return;for(var we=0;we<Oe&&(ne=Vh(Ee,we*4))!==F;++we)te.push(ne);w(Vh(Ee,Y-4),J-1,X,Y,te)}}function T(G,J,X,Y,te){var ne=[],Ee=[];te||(te=[]);var Oe=Y-1,we=0,Te=0;for(we=J;we>=0;){te[we]=!0,ne[ne.length]=we,Ee.push(G[we]);var be=X[Math.floor(we*4/Y)];if(Te=we*4&Oe,Y<4+Te)throw new Error("FAT boundary crossed: "+we+" 4 "+Y);if(!G[be])break;we=Vh(G[be],Te)}return{nodes:ne,data:HO([Ee])}}function b(G,J,X,Y){var te=G.length,ne=[],Ee=[],Oe=[],we=[],Te=Y-1,be=0,Ye=0,it=0,pt=0;for(be=0;be<te;++be)if(Oe=[],it=be+J,it>=te&&(it-=te),!Ee[it]){we=[];var Ze=[];for(Ye=it;Ye>=0;){Ze[Ye]=!0,Ee[Ye]=!0,Oe[Oe.length]=Ye,we.push(G[Ye]);var Je=X[Math.floor(Ye*4/Y)];if(pt=Ye*4&Te,Y<4+pt)throw new Error("FAT boundary crossed: "+Ye+" 4 "+Y);if(!G[Je]||(Ye=Vh(G[Je],pt),Ze[Ye]))break}ne[it]={nodes:Oe,data:HO([we])}}return ne}function R(G,J,X,Y,te,ne,Ee,Oe){for(var we=0,Te=Y.length?2:0,be=J[G].data,Ye=0,it=0,pt;Ye<be.length;Ye+=128){var Ze=be.slice(Ye,Ye+128);oa(Ze,64),it=Ze.read_shift(2),pt=SC(Ze,0,it-Te),Y.push(pt);var Je={name:pt,type:Ze.read_shift(1),color:Ze.read_shift(1),L:Ze.read_shift(4,"i"),R:Ze.read_shift(4,"i"),C:Ze.read_shift(4,"i"),clsid:Ze.read_shift(16),state:Ze.read_shift(4,"i"),start:0,size:0},qt=Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2);qt!==0&&(Je.ct=M(Ze,Ze.l-8));var Gn=Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2);Gn!==0&&(Je.mt=M(Ze,Ze.l-8)),Je.start=Ze.read_shift(4,"i"),Je.size=Ze.read_shift(4,"i"),Je.size<0&&Je.start<0&&(Je.size=Je.type=0,Je.start=F,Je.name=""),Je.type===5?(we=Je.start,te>0&&we!==F&&(J[we].name="!StreamData")):Je.size>=4096?(Je.storage="fat",J[Je.start]===void 0&&(J[Je.start]=T(X,Je.start,J.fat_addrs,J.ssz)),J[Je.start].name=Je.name,Je.content=J[Je.start].data.slice(0,Je.size)):(Je.storage="minifat",Je.size<0?Je.size=0:we!==F&&Je.start!==F&&J[we]&&(Je.content=_(Je,J[we].data,(J[Oe]||{}).data))),Je.content&&oa(Je.content,0),ne[pt]=Je,Ee.push(Je)}}function M(G,J){return new Date((ua(G,J+4)/1e7*Math.pow(2,32)+ua(G,J)/1e7-11644473600)*1e3)}function D(G,J){return c(),h(l.readFileSync(G),J)}function B(G,J){var X=J&&J.type;switch(X||jn&&Buffer.isBuffer(G)&&(X="buffer"),X||"base64"){case"file":return D(G,J);case"base64":return h(mo(dc(G)),J);case"binary":return h(mo(G),J)}return h(G,J)}function k(G,J){var X=J||{},Y=X.root||"Root Entry";if(G.FullPaths||(G.FullPaths=[]),G.FileIndex||(G.FileIndex=[]),G.FullPaths.length!==G.FileIndex.length)throw new Error("inconsistent CFB structure");G.FullPaths.length===0&&(G.FullPaths[0]=Y+"/",G.FileIndex[0]={name:Y,type:5}),X.CLSID&&(G.FileIndex[0].clsid=X.CLSID),A(G)}function A(G){var J="Sh33tJ5";if(!nr.find(G,"/"+J)){var X=Le(4);X[0]=55,X[1]=X[3]=50,X[2]=54,G.FileIndex.push({name:J,type:2,content:X,size:4,L:69,R:69,C:69}),G.FullPaths.push(G.FullPaths[0]+J),C(G)}}function C(G,J){k(G);for(var X=!1,Y=!1,te=G.FullPaths.length-1;te>=0;--te){var ne=G.FileIndex[te];switch(ne.type){case 0:Y?X=!0:(G.FileIndex.pop(),G.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(ne.R*ne.L*ne.C)&&(X=!0),ne.R>-1&&ne.L>-1&&ne.R==ne.L&&(X=!0);break;default:X=!0;break}}if(!(!X&&!J)){var Ee=new Date(1987,1,19),Oe=0,we=Object.create?Object.create(null):{},Te=[];for(te=0;te<G.FullPaths.length;++te)we[G.FullPaths[te]]=!0,G.FileIndex[te].type!==0&&Te.push([G.FullPaths[te],G.FileIndex[te]]);for(te=0;te<Te.length;++te){var be=r(Te[te][0]);Y=we[be],Y||(Te.push([be,{name:i(be).replace("/",""),type:1,clsid:Ge,ct:Ee,mt:Ee,content:null}]),we[be]=!0)}for(Te.sort(function(pt,Ze){return t(pt[0],Ze[0])}),G.FullPaths=[],G.FileIndex=[],te=0;te<Te.length;++te)G.FullPaths[te]=Te[te][0],G.FileIndex[te]=Te[te][1];for(te=0;te<Te.length;++te){var Ye=G.FileIndex[te],it=G.FullPaths[te];if(Ye.name=i(it).replace("/",""),Ye.L=Ye.R=Ye.C=-(Ye.color=1),Ye.size=Ye.content?Ye.content.length:0,Ye.start=0,Ye.clsid=Ye.clsid||Ge,te===0)Ye.C=Te.length>1?1:-1,Ye.size=0,Ye.type=5;else if(it.slice(-1)=="/"){for(Oe=te+1;Oe<Te.length&&r(G.FullPaths[Oe])!=it;++Oe);for(Ye.C=Oe>=Te.length?-1:Oe,Oe=te+1;Oe<Te.length&&r(G.FullPaths[Oe])!=r(it);++Oe);Ye.R=Oe>=Te.length?-1:Oe,Ye.type=1}else r(G.FullPaths[te+1]||"")==r(it)&&(Ye.R=te+1),Ye.type=2}}}function O(G,J){var X=J||{};if(X.fileType=="mad")return Me(G,X);switch(C(G),X.fileType){case"zip":return ut(G,X)}var Y=(function(pt){for(var Ze=0,Je=0,qt=0;qt<pt.FileIndex.length;++qt){var Gn=pt.FileIndex[qt];if(Gn.content){var Wn=Gn.content.length;Wn>0&&(Wn<4096?Ze+=Wn+63>>6:Je+=Wn+511>>9)}}for(var pr=pt.FullPaths.length+3>>2,Ya=Ze+7>>3,_a=Ze+127>>7,Zs=Ya+Je+pr+_a,Gr=Zs+127>>7,Sc=Gr<=109?0:Math.ceil((Gr-109)/127);Zs+Gr+Sc+127>>7>Gr;)Sc=++Gr<=109?0:Math.ceil((Gr-109)/127);var br=[1,Sc,Gr,_a,pr,Je,Ze,0];return pt.FileIndex[0].size=Ze<<6,br[7]=(pt.FileIndex[0].start=br[0]+br[1]+br[2]+br[3]+br[4]+br[5])+(br[6]+7>>3),br})(G),te=Le(Y[7]<<9),ne=0,Ee=0;{for(ne=0;ne<8;++ne)te.write_shift(1,Ce[ne]);for(ne=0;ne<8;++ne)te.write_shift(2,0);for(te.write_shift(2,62),te.write_shift(2,3),te.write_shift(2,65534),te.write_shift(2,9),te.write_shift(2,6),ne=0;ne<3;++ne)te.write_shift(2,0);for(te.write_shift(4,0),te.write_shift(4,Y[2]),te.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),te.write_shift(4,0),te.write_shift(4,4096),te.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:F),te.write_shift(4,Y[3]),te.write_shift(-4,Y[1]?Y[0]-1:F),te.write_shift(4,Y[1]),ne=0;ne<109;++ne)te.write_shift(-4,ne<Y[2]?Y[1]+ne:-1)}if(Y[1])for(Ee=0;Ee<Y[1];++Ee){for(;ne<236+Ee*127;++ne)te.write_shift(-4,ne<Y[2]?Y[1]+ne:-1);te.write_shift(-4,Ee===Y[1]-1?F:Ee+1)}var Oe=function(pt){for(Ee+=pt;ne<Ee-1;++ne)te.write_shift(-4,ne+1);pt&&(++ne,te.write_shift(-4,F))};for(Ee=ne=0,Ee+=Y[1];ne<Ee;++ne)te.write_shift(-4,Ne.DIFSECT);for(Ee+=Y[2];ne<Ee;++ne)te.write_shift(-4,Ne.FATSECT);Oe(Y[3]),Oe(Y[4]);for(var we=0,Te=0,be=G.FileIndex[0];we<G.FileIndex.length;++we)be=G.FileIndex[we],be.content&&(Te=be.content.length,!(Te<4096)&&(be.start=Ee,Oe(Te+511>>9)));for(Oe(Y[6]+7>>3);te.l&511;)te.write_shift(-4,Ne.ENDOFCHAIN);for(Ee=ne=0,we=0;we<G.FileIndex.length;++we)be=G.FileIndex[we],be.content&&(Te=be.content.length,!(!Te||Te>=4096)&&(be.start=Ee,Oe(Te+63>>6)));for(;te.l&511;)te.write_shift(-4,Ne.ENDOFCHAIN);for(ne=0;ne<Y[4]<<2;++ne){var Ye=G.FullPaths[ne];if(!Ye||Ye.length===0){for(we=0;we<17;++we)te.write_shift(4,0);for(we=0;we<3;++we)te.write_shift(4,-1);for(we=0;we<12;++we)te.write_shift(4,0);continue}be=G.FileIndex[ne],ne===0&&(be.start=be.size?be.start-1:F);var it=ne===0&&X.root||be.name;if(Te=2*(it.length+1),te.write_shift(64,it,"utf16le"),te.write_shift(2,Te),te.write_shift(1,be.type),te.write_shift(1,be.color),te.write_shift(-4,be.L),te.write_shift(-4,be.R),te.write_shift(-4,be.C),be.clsid)te.write_shift(16,be.clsid,"hex");else for(we=0;we<4;++we)te.write_shift(4,0);te.write_shift(4,be.state||0),te.write_shift(4,0),te.write_shift(4,0),te.write_shift(4,0),te.write_shift(4,0),te.write_shift(4,be.start),te.write_shift(4,be.size),te.write_shift(4,0)}for(ne=1;ne<G.FileIndex.length;++ne)if(be=G.FileIndex[ne],be.size>=4096)if(te.l=be.start+1<<9,jn&&Buffer.isBuffer(be.content))be.content.copy(te,te.l,0,be.size),te.l+=be.size+511&-512;else{for(we=0;we<be.size;++we)te.write_shift(1,be.content[we]);for(;we&511;++we)te.write_shift(1,0)}for(ne=1;ne<G.FileIndex.length;++ne)if(be=G.FileIndex[ne],be.size>0&&be.size<4096)if(jn&&Buffer.isBuffer(be.content))be.content.copy(te,te.l,0,be.size),te.l+=be.size+63&-64;else{for(we=0;we<be.size;++we)te.write_shift(1,be.content[we]);for(;we&63;++we)te.write_shift(1,0)}if(jn)te.l=te.length;else for(;te.l<te.length;)te.write_shift(1,0);return te}function P(G,J){var X=G.FullPaths.map(function(we){return we.toUpperCase()}),Y=X.map(function(we){var Te=we.split("/");return Te[Te.length-(we.slice(-1)=="/"?2:1)]}),te=!1;J.charCodeAt(0)===47?(te=!0,J=X[0].slice(0,-1)+J):te=J.indexOf("/")!==-1;var ne=J.toUpperCase(),Ee=te===!0?X.indexOf(ne):Y.indexOf(ne);if(Ee!==-1)return G.FileIndex[Ee];var Oe=!ne.match(Qy);for(ne=ne.replace(fp,""),Oe&&(ne=ne.replace(Qy,"!")),Ee=0;Ee<X.length;++Ee)if((Oe?X[Ee].replace(Qy,"!"):X[Ee]).replace(fp,"")==ne||(Oe?Y[Ee].replace(Qy,"!"):Y[Ee]).replace(fp,"")==ne)return G.FileIndex[Ee];return null}var z=64,F=-2,xe="d0cf11e0a1b11ae1",Ce=[208,207,17,224,161,177,26,225],Ge="00000000000000000000000000000000",Ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:xe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ge,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ue(G,J,X){c();var Y=O(G,X);l.writeFileSync(J,Y)}function ke(G){for(var J=new Array(G.length),X=0;X<G.length;++X)J[X]=String.fromCharCode(G[X]);return J.join("")}function ae(G,J){var X=O(G,J);switch(J&&J.type||"buffer"){case"file":return c(),l.writeFileSync(J.filename,X),X;case"binary":return typeof X=="string"?X:ke(X);case"base64":return f1(typeof X=="string"?X:ke(X));case"buffer":if(jn)return Buffer.isBuffer(X)?X:Ec(X);case"array":return typeof X=="string"?mo(X):X}return X}var Z;function V(G){try{var J=G.InflateRaw,X=new J;if(X._processChunk(new Uint8Array([3,0]),X._finishFlushFlag),X.bytesRead)Z=G;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function Q(G,J){if(!Z)return _e(G,J);var X=Z.InflateRaw,Y=new X,te=Y._processChunk(G.slice(G.l),Y._finishFlushFlag);return G.l+=Y.bytesRead,te}function ee(G){return Z?Z.deflateRawSync(G):an(G)}var re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ve=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Be(G){var J=(G<<1|G<<11)&139536|(G<<5|G<<15)&558144;return(J>>16|J>>8|J)&255}for(var ye=typeof Uint8Array<"u",pe=ye?new Uint8Array(256):[],Fe=0;Fe<256;++Fe)pe[Fe]=Be(Fe);function Et(G,J){var X=pe[G&255];return J<=8?X>>>8-J:(X=X<<8|pe[G>>8&255],J<=16?X>>>16-J:(X=X<<8|pe[G>>16&255],X>>>24-J))}function Ft(G,J){var X=J&7,Y=J>>>3;return(G[Y]|(X<=6?0:G[Y+1]<<8))>>>X&3}function Dt(G,J){var X=J&7,Y=J>>>3;return(G[Y]|(X<=5?0:G[Y+1]<<8))>>>X&7}function Xt(G,J){var X=J&7,Y=J>>>3;return(G[Y]|(X<=4?0:G[Y+1]<<8))>>>X&15}function en(G,J){var X=J&7,Y=J>>>3;return(G[Y]|(X<=3?0:G[Y+1]<<8))>>>X&31}function ot(G,J){var X=J&7,Y=J>>>3;return(G[Y]|(X<=1?0:G[Y+1]<<8))>>>X&127}function tr(G,J,X){var Y=J&7,te=J>>>3,ne=(1<<X)-1,Ee=G[te]>>>Y;return X<8-Y||(Ee|=G[te+1]<<8-Y,X<16-Y)||(Ee|=G[te+2]<<16-Y,X<24-Y)||(Ee|=G[te+3]<<24-Y),Ee&ne}function dn(G,J,X){var Y=J&7,te=J>>>3;return Y<=5?G[te]|=(X&7)<<Y:(G[te]|=X<<Y&255,G[te+1]=(X&7)>>8-Y),J+3}function un(G,J,X){var Y=J&7,te=J>>>3;return X=(X&1)<<Y,G[te]|=X,J+1}function sr(G,J,X){var Y=J&7,te=J>>>3;return X<<=Y,G[te]|=X&255,X>>>=8,G[te+1]=X,J+8}function Mi(G,J,X){var Y=J&7,te=J>>>3;return X<<=Y,G[te]|=X&255,X>>>=8,G[te+1]=X&255,G[te+2]=X>>>8,J+16}function Bn(G,J){var X=G.length,Y=2*X>J?2*X:J+5,te=0;if(X>=J)return G;if(jn){var ne=PO(Y);if(G.copy)G.copy(ne);else for(;te<G.length;++te)ne[te]=G[te];return ne}else if(ye){var Ee=new Uint8Array(Y);if(Ee.set)Ee.set(G);else for(;te<X;++te)Ee[te]=G[te];return Ee}return G.length=Y,G}function Sr(G){for(var J=new Array(G),X=0;X<G;++X)J[X]=0;return J}function oi(G,J,X){var Y=1,te=0,ne=0,Ee=0,Oe=0,we=G.length,Te=ye?new Uint16Array(32):Sr(32);for(ne=0;ne<32;++ne)Te[ne]=0;for(ne=we;ne<X;++ne)G[ne]=0;we=G.length;var be=ye?new Uint16Array(we):Sr(we);for(ne=0;ne<we;++ne)Te[te=G[ne]]++,Y<te&&(Y=te),be[ne]=0;for(Te[0]=0,ne=1;ne<=Y;++ne)Te[ne+16]=Oe=Oe+Te[ne-1]<<1;for(ne=0;ne<we;++ne)Oe=G[ne],Oe!=0&&(be[ne]=Te[Oe+16]++);var Ye=0;for(ne=0;ne<we;++ne)if(Ye=G[ne],Ye!=0)for(Oe=Et(be[ne],Y)>>Y-Ye,Ee=(1<<Y+4-Ye)-1;Ee>=0;--Ee)J[Oe|Ee<<Ye]=Ye&15|ne<<4;return Y}var _t=ye?new Uint16Array(512):Sr(512),xn=ye?new Uint16Array(32):Sr(32);if(!ye){for(var An=0;An<512;++An)_t[An]=0;for(An=0;An<32;++An)xn[An]=0}(function(){for(var G=[],J=0;J<32;J++)G.push(5);oi(G,xn,32);var X=[];for(J=0;J<=143;J++)X.push(8);for(;J<=255;J++)X.push(9);for(;J<=279;J++)X.push(7);for(;J<=287;J++)X.push(8);oi(X,_t,288)})();var Tt=(function(){for(var J=ye?new Uint8Array(32768):[],X=0,Y=0;X<Ve.length-1;++X)for(;Y<Ve[X+1];++Y)J[Y]=X;for(;Y<32768;++Y)J[Y]=29;var te=ye?new Uint8Array(259):[];for(X=0,Y=0;X<he.length-1;++X)for(;Y<he[X+1];++Y)te[Y]=X;function ne(Oe,we){for(var Te=0;Te<Oe.length;){var be=Math.min(65535,Oe.length-Te),Ye=Te+be==Oe.length;for(we.write_shift(1,+Ye),we.write_shift(2,be),we.write_shift(2,~be&65535);be-- >0;)we[we.l++]=Oe[Te++]}return we.l}function Ee(Oe,we){for(var Te=0,be=0,Ye=ye?new Uint16Array(32768):[];be<Oe.length;){var it=Math.min(65535,Oe.length-be);if(it<10){for(Te=dn(we,Te,+(be+it==Oe.length)),Te&7&&(Te+=8-(Te&7)),we.l=Te/8|0,we.write_shift(2,it),we.write_shift(2,~it&65535);it-- >0;)we[we.l++]=Oe[be++];Te=we.l*8;continue}Te=dn(we,Te,+(be+it==Oe.length)+2);for(var pt=0;it-- >0;){var Ze=Oe[be];pt=(pt<<5^Ze)&32767;var Je=-1,qt=0;if((Je=Ye[pt])&&(Je|=be&-32768,Je>be&&(Je-=32768),Je<be))for(;Oe[Je+qt]==Oe[be+qt]&&qt<250;)++qt;if(qt>2){Ze=te[qt],Ze<=22?Te=sr(we,Te,pe[Ze+1]>>1)-1:(sr(we,Te,3),Te+=5,sr(we,Te,pe[Ze-23]>>5),Te+=3);var Gn=Ze<8?0:Ze-4>>2;Gn>0&&(Mi(we,Te,qt-he[Ze]),Te+=Gn),Ze=J[be-Je],Te=sr(we,Te,pe[Ze]>>3),Te-=3;var Wn=Ze<4?0:Ze-2>>1;Wn>0&&(Mi(we,Te,be-Je-Ve[Ze]),Te+=Wn);for(var pr=0;pr<qt;++pr)Ye[pt]=be&32767,pt=(pt<<5^Oe[be])&32767,++be;it-=qt-1}else Ze<=143?Ze=Ze+48:Te=un(we,Te,1),Te=sr(we,Te,pe[Ze]),Ye[pt]=be&32767,++be}Te=sr(we,Te,0)-1}return we.l=(Te+7)/8|0,we.l}return function(we,Te){return we.length<8?ne(we,Te):Ee(we,Te)}})();function an(G){var J=Le(50+Math.floor(G.length*1.1)),X=Tt(G,J);return J.slice(0,X)}var Mt=ye?new Uint16Array(32768):Sr(32768),Zi=ye?new Uint16Array(32768):Sr(32768),Mr=ye?new Uint16Array(128):Sr(128),li=1,rn=1;function Tr(G,J){var X=en(G,J)+257;J+=5;var Y=en(G,J)+1;J+=5;var te=Xt(G,J)+4;J+=4;for(var ne=0,Ee=ye?new Uint8Array(19):Sr(19),Oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],we=1,Te=ye?new Uint8Array(8):Sr(8),be=ye?new Uint8Array(8):Sr(8),Ye=Ee.length,it=0;it<te;++it)Ee[re[it]]=ne=Dt(G,J),we<ne&&(we=ne),Te[ne]++,J+=3;var pt=0;for(Te[0]=0,it=1;it<=we;++it)be[it]=pt=pt+Te[it-1]<<1;for(it=0;it<Ye;++it)(pt=Ee[it])!=0&&(Oe[it]=be[pt]++);var Ze=0;for(it=0;it<Ye;++it)if(Ze=Ee[it],Ze!=0){pt=pe[Oe[it]]>>8-Ze;for(var Je=(1<<7-Ze)-1;Je>=0;--Je)Mr[pt|Je<<Ze]=Ze&7|it<<3}var qt=[];for(we=1;qt.length<X+Y;)switch(pt=Mr[ot(G,J)],J+=pt&7,pt>>>=3){case 16:for(ne=3+Ft(G,J),J+=2,pt=qt[qt.length-1];ne-- >0;)qt.push(pt);break;case 17:for(ne=3+Dt(G,J),J+=3;ne-- >0;)qt.push(0);break;case 18:for(ne=11+ot(G,J),J+=7;ne-- >0;)qt.push(0);break;default:qt.push(pt),we<pt&&(we=pt);break}var Gn=qt.slice(0,X),Wn=qt.slice(X);for(it=X;it<286;++it)Gn[it]=0;for(it=Y;it<30;++it)Wn[it]=0;return li=oi(Gn,Mt,286),rn=oi(Wn,Zi,30),J}function je(G,J){if(G[0]==3&&!(G[1]&3))return[Td(J),2];for(var X=0,Y=0,te=PO(J||1<<18),ne=0,Ee=te.length>>>0,Oe=0,we=0;(Y&1)==0;){if(Y=Dt(G,X),X+=3,Y>>>1)Y>>1==1?(Oe=9,we=5):(X=Tr(G,X),Oe=li,we=rn);else{X&7&&(X+=8-(X&7));var Te=G[X>>>3]|G[(X>>>3)+1]<<8;if(X+=32,Te>0)for(!J&&Ee<ne+Te&&(te=Bn(te,ne+Te),Ee=te.length);Te-- >0;)te[ne++]=G[X>>>3],X+=8;continue}for(;;){!J&&Ee<ne+32767&&(te=Bn(te,ne+32767),Ee=te.length);var be=tr(G,X,Oe),Ye=Y>>>1==1?_t[be]:Mt[be];if(X+=Ye&15,Ye>>>=4,(Ye>>>8&255)===0)te[ne++]=Ye;else{if(Ye==256)break;Ye-=257;var it=Ye<8?0:Ye-4>>2;it>5&&(it=0);var pt=ne+he[Ye];it>0&&(pt+=tr(G,X,it),X+=it),be=tr(G,X,we),Ye=Y>>>1==1?xn[be]:Zi[be],X+=Ye&15,Ye>>>=4;var Ze=Ye<4?0:Ye-2>>1,Je=Ve[Ye];for(Ze>0&&(Je+=tr(G,X,Ze),X+=Ze),!J&&Ee<pt&&(te=Bn(te,pt+100),Ee=te.length);ne<pt;)te[ne]=te[ne-Je],++ne}}}return J?[te,X+7>>>3]:[te.slice(0,ne),X+7>>>3]}function _e(G,J){var X=G.slice(G.l||0),Y=je(X,J);return G.l+=Y[1],Y[0]}function ve(G,J){if(G)typeof console<"u"&&console.error(J);else throw new Error(J)}function jt(G,J){var X=G;oa(X,0);var Y=[],te=[],ne={FileIndex:Y,FullPaths:te};k(ne,{root:J.root});for(var Ee=X.length-4;(X[Ee]!=80||X[Ee+1]!=75||X[Ee+2]!=5||X[Ee+3]!=6)&&Ee>=0;)--Ee;X.l=Ee+4,X.l+=4;var Oe=X.read_shift(2);X.l+=6;var we=X.read_shift(4);for(X.l=we,Ee=0;Ee<Oe;++Ee){X.l+=20;var Te=X.read_shift(4),be=X.read_shift(4),Ye=X.read_shift(2),it=X.read_shift(2),pt=X.read_shift(2);X.l+=8;var Ze=X.read_shift(4),Je=o(X.slice(X.l+Ye,X.l+Ye+it));X.l+=Ye+it+pt;var qt=X.l;X.l=Ze+4,L(X,Te,be,ne,Je),X.l=qt}return ne}function L(G,J,X,Y,te){G.l+=2;var ne=G.read_shift(2),Ee=G.read_shift(2),Oe=a(G);if(ne&8257)throw new Error("Unsupported ZIP encryption");for(var we=G.read_shift(4),Te=G.read_shift(4),be=G.read_shift(4),Ye=G.read_shift(2),it=G.read_shift(2),pt="",Ze=0;Ze<Ye;++Ze)pt+=String.fromCharCode(G[G.l++]);if(it){var Je=o(G.slice(G.l,G.l+it));(Je[21589]||{}).mt&&(Oe=Je[21589].mt),((te||{})[21589]||{}).mt&&(Oe=te[21589].mt)}G.l+=it;var qt=G.slice(G.l,G.l+Te);switch(Ee){case 8:qt=Q(G,be);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ee)}var Gn=!1;ne&8&&(we=G.read_shift(4),we==134695760&&(we=G.read_shift(4),Gn=!0),Te=G.read_shift(4),be=G.read_shift(4)),Te!=J&&ve(Gn,"Bad compressed size: "+J+" != "+Te),be!=X&&ve(Gn,"Bad uncompressed size: "+X+" != "+be),$e(Y,pt,qt,{unsafe:!0,mt:Oe})}function ut(G,J){var X=J||{},Y=[],te=[],ne=Le(1),Ee=X.compression?8:0,Oe=0,we=0,Te=0,be=0,Ye=0,it=G.FullPaths[0],pt=it,Ze=G.FileIndex[0],Je=[],qt=0;for(we=1;we<G.FullPaths.length;++we)if(pt=G.FullPaths[we].slice(it.length),Ze=G.FileIndex[we],!(!Ze.size||!Ze.content||pt=="Sh33tJ5")){var Gn=be,Wn=Le(pt.length);for(Te=0;Te<pt.length;++Te)Wn.write_shift(1,pt.charCodeAt(Te)&127);Wn=Wn.slice(0,Wn.l),Je[Ye]=hye.buf(Ze.content,0);var pr=Ze.content;Ee==8&&(pr=ee(pr)),ne=Le(30),ne.write_shift(4,67324752),ne.write_shift(2,20),ne.write_shift(2,Oe),ne.write_shift(2,Ee),Ze.mt?s(ne,Ze.mt):ne.write_shift(4,0),ne.write_shift(-4,Je[Ye]),ne.write_shift(4,pr.length),ne.write_shift(4,Ze.content.length),ne.write_shift(2,Wn.length),ne.write_shift(2,0),be+=ne.length,Y.push(ne),be+=Wn.length,Y.push(Wn),be+=pr.length,Y.push(pr),ne=Le(46),ne.write_shift(4,33639248),ne.write_shift(2,0),ne.write_shift(2,20),ne.write_shift(2,Oe),ne.write_shift(2,Ee),ne.write_shift(4,0),ne.write_shift(-4,Je[Ye]),ne.write_shift(4,pr.length),ne.write_shift(4,Ze.content.length),ne.write_shift(2,Wn.length),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(4,0),ne.write_shift(4,Gn),qt+=ne.l,te.push(ne),qt+=Wn.length,te.push(Wn),++Ye}return ne=Le(22),ne.write_shift(4,101010256),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,Ye),ne.write_shift(2,Ye),ne.write_shift(4,qt),ne.write_shift(4,be),ne.write_shift(2,0),Hi([Hi(Y),Hi(te),ne])}var W={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(G,J){if(G.ctype)return G.ctype;var X=G.name||"",Y=X.match(/\.([^\.]+)$/);return Y&&W[Y[1]]||J&&(Y=(X=J).match(/[\.\\]([^\.\\])+$/),Y&&W[Y[1]])?W[Y[1]]:"application/octet-stream"}function Pe(G){for(var J=f1(G),X=[],Y=0;Y<J.length;Y+=76)X.push(J.slice(Y,Y+76));return X.join(`\r
`)+`\r
`}function q(G){var J=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Te){var be=Te.charCodeAt(0).toString(16).toUpperCase();return"="+(be.length==1?"0"+be:be)});J=J.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),J.charAt(0)==`
`&&(J="=0D"+J.slice(1)),J=J.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var X=[],Y=J.split(`\r
`),te=0;te<Y.length;++te){var ne=Y[te];if(ne.length==0){X.push("");continue}for(var Ee=0;Ee<ne.length;){var Oe=76,we=ne.slice(Ee,Ee+Oe);we.charAt(Oe-1)=="="?Oe--:we.charAt(Oe-2)=="="?Oe-=2:we.charAt(Oe-3)=="="&&(Oe-=3),we=ne.slice(Ee,Ee+Oe),Ee+=Oe,Ee<ne.length&&(we+="="),X.push(we)}}return X.join(`\r
`)}function ce(G){for(var J=[],X=0;X<G.length;++X){for(var Y=G[X];X<=G.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+G[++X];J.push(Y)}for(var te=0;te<J.length;++te)J[te]=J[te].replace(/[=][0-9A-Fa-f]{2}/g,function(ne){return String.fromCharCode(parseInt(ne.slice(1),16))});return mo(J.join(`\r
`))}function Re(G,J,X){for(var Y="",te="",ne="",Ee,Oe=0;Oe<10;++Oe){var we=J[Oe];if(!we||we.match(/^\s*$/))break;var Te=we.match(/^(.*?):\s*([^\s].*)$/);if(Te)switch(Te[1].toLowerCase()){case"content-location":Y=Te[2].trim();break;case"content-type":ne=Te[2].trim();break;case"content-transfer-encoding":te=Te[2].trim();break}}switch(++Oe,te.toLowerCase()){case"base64":Ee=mo(dc(J.slice(Oe).join("")));break;case"quoted-printable":Ee=ce(J.slice(Oe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+te)}var be=$e(G,Y.slice(X.length),Ee,{unsafe:!0});ne&&(be.ctype=ne)}function ze(G,J){if(ke(G.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var X=J&&J.root||"",Y=(jn&&Buffer.isBuffer(G)?G.toString("binary"):ke(G)).split(`\r
`),te=0,ne="";for(te=0;te<Y.length;++te)if(ne=Y[te],!!/^Content-Location:/i.test(ne)&&(ne=ne.slice(ne.indexOf("file")),X||(X=ne.slice(0,ne.lastIndexOf("/")+1)),ne.slice(0,X.length)!=X))for(;X.length>0&&(X=X.slice(0,X.length-1),X=X.slice(0,X.lastIndexOf("/")+1),ne.slice(0,X.length)!=X););var Ee=(Y[1]||"").match(/boundary="(.*?)"/);if(!Ee)throw new Error("MAD cannot find boundary");var Oe="--"+(Ee[1]||""),we=[],Te=[],be={FileIndex:we,FullPaths:Te};k(be);var Ye,it=0;for(te=0;te<Y.length;++te){var pt=Y[te];pt!==Oe&&pt!==Oe+"--"||(it++&&Re(be,Y.slice(Ye,te),X),Ye=te)}return be}function Me(G,J){var X=J||{},Y=X.boundary||"SheetJS";Y="------="+Y;for(var te=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],ne=G.FullPaths[0],Ee=ne,Oe=G.FileIndex[0],we=1;we<G.FullPaths.length;++we)if(Ee=G.FullPaths[we].slice(ne.length),Oe=G.FileIndex[we],!(!Oe.size||!Oe.content||Ee=="Sh33tJ5")){Ee=Ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qt){return"_x"+qt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qt){return"_u"+qt.charCodeAt(0).toString(16)+"_"});for(var Te=Oe.content,be=jn&&Buffer.isBuffer(Te)?Te.toString("binary"):ke(Te),Ye=0,it=Math.min(1024,be.length),pt=0,Ze=0;Ze<=it;++Ze)(pt=be.charCodeAt(Ze))>=32&&pt<128&&++Ye;var Je=Ye>=it*4/5;te.push(Y),te.push("Content-Location: "+(X.root||"file:///C:/SheetJS/")+Ee),te.push("Content-Transfer-Encoding: "+(Je?"quoted-printable":"base64")),te.push("Content-Type: "+ie(Oe,Ee)),te.push(""),te.push(Je?q(be):Pe(be))}return te.push(Y+`--\r
`),te.join(`\r
`)}function He(G){var J={};return k(J,G),J}function $e(G,J,X,Y){var te=Y&&Y.unsafe;te||k(G);var ne=!te&&nr.find(G,J);if(!ne){var Ee=G.FullPaths[0];J.slice(0,Ee.length)==Ee?Ee=J:(Ee.slice(-1)!="/"&&(Ee+="/"),Ee=(Ee+J).replace("//","/")),ne={name:i(J),type:2},G.FileIndex.push(ne),G.FullPaths.push(Ee),te||nr.utils.cfb_gc(G)}return ne.content=X,ne.size=X?X.length:0,Y&&(Y.CLSID&&(ne.clsid=Y.CLSID),Y.mt&&(ne.mt=Y.mt),Y.ct&&(ne.ct=Y.ct)),ne}function xt(G,J){k(G);var X=nr.find(G,J);if(X){for(var Y=0;Y<G.FileIndex.length;++Y)if(G.FileIndex[Y]==X)return G.FileIndex.splice(Y,1),G.FullPaths.splice(Y,1),!0}return!1}function Rt(G,J,X){k(G);var Y=nr.find(G,J);if(Y){for(var te=0;te<G.FileIndex.length;++te)if(G.FileIndex[te]==Y)return G.FileIndex[te].name=i(X),G.FullPaths[te]=X,!0}return!1}function Ht(G){C(G,!0)}return e.find=P,e.read=B,e.parse=h,e.write=ae,e.writeFile=ue,e.utils={cfb_new:He,cfb_add:$e,cfb_del:xt,cfb_mov:Rt,cfb_gc:Ht,ReadShift:mp,CheckField:fG,prep_blob:oa,bconcat:Hi,use_zlib:V,_deflateRaw:an,_inflateRaw:_e,consts:Ne},e})();function dye(n){return typeof n=="string"?zE(n):Array.isArray(n)?Fxe(n):n}function dx(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=zE(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var r=t=="utf8"?m1(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([dye(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=n,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(n);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=hx(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+n)}function qi(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function VO(n,e){for(var t=[],r=qi(n),i=0;i!==r.length;++i)t[n[r[i]][e]]==null&&(t[n[r[i]][e]]=r[i]);return t}function _C(n){for(var e=[],t=qi(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}function WE(n){for(var e=[],t=qi(n),r=0;r!==t.length;++r)e[n[t[r]]]=parseInt(t[r],10);return e}function fye(n){for(var e=[],t=qi(n),r=0;r!==t.length;++r)e[n[t[r]]]==null&&(e[n[t[r]]]=[]),e[n[t[r]]].push(t[r]);return e}var cw=new Date(1899,11,30,0,0,0);function Xs(n,e){var t=n.getTime(),r=cw.getTime()+(n.getTimezoneOffset()-cw.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var YB=new Date,gye=cw.getTime()+(YB.getTimezoneOffset()-cw.getTimezoneOffset())*6e4,BO=YB.getTimezoneOffset();function ZB(n){var e=new Date;return e.setTime(n*24*60*60*1e3+gye),e.getTimezoneOffset()!==BO&&e.setTime(e.getTime()+(e.getTimezoneOffset()-BO)*6e4),e}var GO=new Date("2017-02-19T19:06:09.000Z"),JB=isNaN(GO.getFullYear())?new Date("2/19/17"):GO,mye=JB.getFullYear()==2017;function Rs(n,e){var t=new Date(n);if(mye)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(JB.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function HE(n,e){if(jn&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function qs(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=qs(n[t]));return e}function Fr(n,e){for(var t="";t.length<e;)t+=n;return t}function tc(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(r)))?e/t:e}var pye=["january","february","march","april","may","june","july","august","september","october","november","december"];function g1(n){var e=new Date(n),t=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=n.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&pye.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||s>1)&&r!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function ln(n,e,t){if(n.FullPaths){if(typeof t=="string"){var r;return jn?r=Ec(t):r=Vxe(t),nr.utils.cfb_add(n,e,r)}nr.utils.cfb_add(n,e,t)}else n.file(e,t)}function vC(){return nr.utils.cfb_new()}var ai=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,xye={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},wC=_C(xye),EC=/[&<>'"]/g,yye=/[\u0000-\u0008\u000b-\u001f]/g;function Jn(n){var e=n+"";return e.replace(EC,function(t){return wC[t]}).replace(yye,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function zO(n){return Jn(n).replace(/ /g,"_x0020_")}var QB=/[\u0000-\u001f]/g;function _ye(n){var e=n+"";return e.replace(EC,function(t){return wC[t]}).replace(/\n/g,"<br/>").replace(QB,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function vye(n){var e=n+"";return e.replace(EC,function(t){return wC[t]}).replace(QB,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function wye(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function Eye(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function WT(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(i=n.charCodeAt(t++),r>191&&r<224){a=(r&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}a=n.charCodeAt(t++),o=((r&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function UO(n){var e=Td(2*n.length),t,r,i=1,s=0,a=0,o;for(r=0;r<n.length;r+=i)i=1,(o=n.charCodeAt(r))<128?t=o:o<224?(t=(o&31)*64+(n.charCodeAt(r+1)&63),i=2):o<240?(t=(o&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,t=(o&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function $O(n){return Ec(n,"binary").toString("utf8")}var t_="foo bar baz",gp=jn&&($O(t_)==WT(t_)&&$O||UO(t_)==WT(t_)&&UO)||WT,m1=jn?function(n){return Ec(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},Sye=(function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}})(),eG=/(^\s|\s$|\n)/;function Ki(n,e){return"<"+n+(e.match(eG)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function p1(n){return qi(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function st(n,e,t){return"<"+n+(t!=null?p1(t):"")+(e!=null?(e.match(eG)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function JR(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function Tye(n,e){switch(typeof n){case"string":var t=st("vt:lpwstr",Jn(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return st((n|0)==n?"vt:i4":"vt:r8",Jn(String(n)));case"boolean":return st("vt:bool",n?"true":"false")}if(n instanceof Date)return st("vt:filetime",JR(n));throw new Error("Unable to serialize "+n)}var Ai={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Eg=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ca={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function bye(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),i=n[e+6]&15,s=5;s>=0;--s)i=i*256+n[e+s];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function Rye(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=r?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)n[t+o]=s&255;n[t+6]=(i&15)<<4|s&15,n[t+7]=i>>4|r}var WO=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,s=n[0][r].length;i<s;i+=t)e.push.apply(e,n[0][r].slice(i,i+t));return e},HO=jn?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:Ec(e)})):WO(n)}:WO,KO=function(n,e,t){for(var r=[],i=e;i<t;i+=2)r.push(String.fromCharCode(Vm(n,i)));return r.join("").replace(fp,"")},SC=jn?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(fp,""):KO(n,e,t)}:KO,XO=function(n,e,t){for(var r=[],i=e;i<e+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},tG=jn?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):XO(n,e,t)}:XO,qO=function(n,e,t){for(var r=[],i=e;i<t;i++)r.push(String.fromCharCode(n0(n,i)));return r.join("")},fx=jn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):qO(e,t,r)}:qO,nG=function(n,e){var t=ua(n,e);return t>0?fx(n,e+4,e+4+t-1):""},rG=nG,iG=function(n,e){var t=ua(n,e);return t>0?fx(n,e+4,e+4+t-1):""},sG=iG,aG=function(n,e){var t=2*ua(n,e);return t>0?fx(n,e+4,e+4+t-1):""},oG=aG,lG=function(e,t){var r=ua(e,t);return r>0?SC(e,t+4,t+4+r):""},cG=lG,uG=function(n,e){var t=ua(n,e);return t>0?fx(n,e+4,e+4+t):""},hG=uG,dG=function(n,e){return bye(n,e)},uw=dG,TC=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};jn&&(rG=function(e,t){if(!Buffer.isBuffer(e))return nG(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},sG=function(e,t){if(!Buffer.isBuffer(e))return iG(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},oG=function(e,t){if(!Buffer.isBuffer(e))return aG(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},cG=function(e,t){if(!Buffer.isBuffer(e))return lG(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},hG=function(e,t){if(!Buffer.isBuffer(e))return uG(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},uw=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):dG(e,t)},TC=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var n0=function(n,e){return n[e]},Vm=function(n,e){return n[e+1]*256+n[e]},Aye=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},ua=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},Vh=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},kye=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function mp(n,e){var t="",r,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,jn&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(l=0;l<n;++l)t+=String.fromCharCode(Vm(this,c)),c+=2;n*=2;break;case"utf8":t=fx(this,this.l,this.l+n);break;case"utf16le":n*=2,t=SC(this,this.l,this.l+n);break;case"wstr":return mp.call(this,n,"dbcs");case"lpstr-ansi":t=rG(this,this.l),n=4+ua(this,this.l);break;case"lpstr-cp":t=sG(this,this.l),n=4+ua(this,this.l);break;case"lpwstr":t=oG(this,this.l),n=4+2*ua(this,this.l);break;case"lpp4":n=4+ua(this,this.l),t=cG(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+ua(this,this.l),t=hG(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(a=n0(this,this.l+n++))!==0;)s.push(Jy(a));t=s.join("");break;case"_wstr":for(n=0,t="";(a=Vm(this,this.l+n))!==0;)s.push(Jy(a)),n+=2;n+=2,t=s.join("");break;case"dbcs-cont":for(t="",c=this.l,l=0;l<n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=n0(this,c),this.l=c+1,o=mp.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Jy(Vm(this,c))),c+=2}t=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",c=this.l,l=0;l!=n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=n0(this,c),this.l=c+1,o=mp.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Jy(n0(this,c))),c+=1}t=s.join("");break;default:switch(n){case 1:return r=n0(this,this.l),this.l++,r;case 2:return r=(e==="i"?Aye:Vm)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(n>0?Vh:kye)(this,this.l),this.l+=4,r):(i=ua(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return n==8?i=uw(this,this.l):i=uw([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=tG(this,this.l,n);break}}return this.l+=n,t}var Iye=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},Cye=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},Pye=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function Nye(n,e,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)Pye(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(t==="hex"){for(;i<n;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(e.length,n);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,Iye(this,e,this.l);break;case 8:if(r=8,t==="f"){Rye(this,e,this.l);break}case 16:break;case-4:r=4,Cye(this,e,this.l);break}return this.l+=r,this}function fG(n,e){var t=tG(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function oa(n,e){n.l=e,n.read_shift=mp,n.chk=fG,n.write_shift=Nye}function xl(n,e){n.l+=e}function Le(n){var e=Td(n);return oa(e,0),e}function Us(){var n=[],e=jn?256:2048,t=function(c){var h=Le(c);return oa(h,0),h},r=t(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},s=function(c){return r&&c<r.length-r.l?r:(i(),r=t(Math.max(c+1,e)))},a=function(){return i(),Hi(n)},o=function(c){i(),r=c,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:o,end:a,_bufs:n}}function We(n,e,t,r){var i=+e,s;if(!isNaN(i)){r||(r=bSe[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var a=n.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&TC(t)&&n.push(t)}}function pp(n,e,t){var r=qs(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function YO(n,e,t){var r=qs(n);return r.s=pp(r.s,e.s,t),r.e=pp(r.e,e.s,t),r}function xp(n,e){if(n.cRel&&n.c<0)for(n=qs(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=qs(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=er(n);return!n.cRel&&n.cRel!=null&&(t=Oye(t)),!n.rRel&&n.rRel!=null&&(t=Mye(t)),t}function HT(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+ms(n.s.c)+":"+(n.e.cRel?"":"$")+ms(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Xi(n.s.r)+":"+(n.e.rRel?"":"$")+Xi(n.e.r):xp(n.s,e.biff)+":"+xp(n.e,e.biff)}function bC(n){return parseInt(Lye(n),10)-1}function Xi(n){return""+(n+1)}function Mye(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Lye(n){return n.replace(/\$(\d+)$/,"$1")}function RC(n){for(var e=Dye(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function ms(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function Oye(n){return n.replace(/^([A-Z])/,"$$$1")}function Dye(n){return n.replace(/^\$([A-Z])/,"$1")}function jye(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ci(n){for(var e=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function er(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function ya(n){var e=n.indexOf(":");return e==-1?{s:Ci(n),e:Ci(n)}:{s:Ci(n.slice(0,e)),e:Ci(n.slice(e+1))}}function ii(n,e){return typeof e>"u"||typeof e=="number"?ii(n.s,n.e):(typeof n!="string"&&(n=er(n)),typeof e!="string"&&(e=er(e)),n==e?n:n+":"+e)}function mr(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,s=n.length;for(t=0;r<s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.s.c=--t,t=0;r<s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(e.s.r=--t,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.e.c=--t,t=0;r!=s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return e.e.r=--t,e}function ZO(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=Uu(n.z,t?Xs(e):e)}catch{}try{return n.w=Uu((n.XF||{}).numFmtId||(t?14:0),t?Xs(e):e)}catch{return""+e}}function fc(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?gx[n.v]||n.v:e==null?ZO(n,n.v):ZO(n,e))}function Bd(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function gG(n,e,t){var r=t||{},i=n?Array.isArray(n):r.dense,s=n||(i?[]:{}),a=0,o=0;if(s&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?Ci(r.origin):r.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=mr(s["!ref"]);c.s.c=h.s.c,c.s.r=h.s.r,c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),a==-1&&(c.e.r=a=h.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[g].length;++m)if(!(typeof e[g][m]>"u")){var x={v:e[g][m]},y=a+g,_=o+m;if(c.s.r>y&&(c.s.r=y),c.s.c>_&&(c.s.c=_),c.e.r<y&&(c.e.r=y),c.e.c<_&&(c.e.c=_),e[g][m]&&typeof e[g][m]=="object"&&!Array.isArray(e[g][m])&&!(e[g][m]instanceof Date))x=e[g][m];else if(Array.isArray(x.v)&&(x.f=e[g][m][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(r.nullError)x.t="e",x.v=0;else if(r.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=r.dateNF||Br[14],r.cellDates?(x.t="d",x.w=Uu(x.z,Xs(x.v))):(x.t="n",x.v=Xs(x.v),x.w=Uu(x.z,x.v))):x.t="s";if(i)s[y]||(s[y]=[]),s[y][_]&&s[y][_].z&&(x.z=s[y][_].z),s[y][_]=x;else{var w=er({c:_,r:y});s[w]&&s[w].z&&(x.z=s[w].z),s[w]=x}}}return c.s.c<1e7&&(s["!ref"]=ii(c)),s}function Sg(n,e){return gG(null,n,e)}function Fye(n){return n.read_shift(4,"i")}function So(n,e){return e||(e=Le(4)),e.write_shift(4,n),e}function ps(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function Pi(n,e){var t=!1;return e==null&&(t=!0,e=Le(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function Vye(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function Bye(n,e){return e||(e=Le(4)),e.write_shift(2,0),e.write_shift(2,0),e}function AC(n,e){var t=n.l,r=n.read_shift(1),i=ps(n),s=[],a={t:i,h:i};if((r&1)!==0){for(var o=n.read_shift(4),l=0;l!=o;++l)s.push(Vye(n));a.r=s}else a.r=[{ich:0,ifnt:0}];return n.l=t+e,a}function Gye(n,e){var t=!1;return e==null&&(t=!0,e=Le(15+4*n.t.length)),e.write_shift(1,0),Pi(n.t,e),t?e.slice(0,e.l):e}var zye=AC;function Uye(n,e){var t=!1;return e==null&&(t=!0,e=Le(23+4*n.t.length)),e.write_shift(1,1),Pi(n.t,e),e.write_shift(4,1),Bye({},e),t?e.slice(0,e.l):e}function qa(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function Gd(n,e){return e==null&&(e=Le(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function zd(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function Ud(n,e){return e==null&&(e=Le(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var $ye=ps,mG=Pi;function kC(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function hw(n,e){var t=!1;return e==null&&(t=!0,e=Le(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var Wye=ps,QR=kC,IC=hw;function pG(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var i=r===0?uw([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Vh(e,0)>>2;return t?i/100:i}function xG(n,e){e==null&&(e=Le(4));var t=0,r=0,i=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?i:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function yG(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function Hye(n,e){return e||(e=Le(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var $d=yG,Tg=Hye;function bg(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function bd(n,e){return(e||Le(8)).write_shift(8,n,"f")}function Kye(n){var e={},t=n.read_shift(1),r=t>>>1,i=n.read_shift(1),s=n.read_shift(2,"i"),a=n.read_shift(1),o=n.read_shift(1),l=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var c=n_e[i];c&&(e.rgb=lD(c));break;case 2:e.rgb=lD([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function dw(n,e){if(e||(e=Le(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function Xye(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function qye(n,e){e||(e=Le(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var _G=2,sa=3,n_=11,fw=19,r_=64,Yye=65,Zye=71,Jye=4108,Qye=4126,zi=80,JO={1:{n:"CodePage",t:_G},2:{n:"Category",t:zi},3:{n:"PresentationFormat",t:zi},4:{n:"ByteCount",t:sa},5:{n:"LineCount",t:sa},6:{n:"ParagraphCount",t:sa},7:{n:"SlideCount",t:sa},8:{n:"NoteCount",t:sa},9:{n:"HiddenCount",t:sa},10:{n:"MultimediaClipCount",t:sa},11:{n:"ScaleCrop",t:n_},12:{n:"HeadingPairs",t:Jye},13:{n:"TitlesOfParts",t:Qye},14:{n:"Manager",t:zi},15:{n:"Company",t:zi},16:{n:"LinksUpToDate",t:n_},17:{n:"CharacterCount",t:sa},19:{n:"SharedDoc",t:n_},22:{n:"HyperlinksChanged",t:n_},23:{n:"AppVersion",t:sa,p:"version"},24:{n:"DigSig",t:Yye},26:{n:"ContentType",t:zi},27:{n:"ContentStatus",t:zi},28:{n:"Language",t:zi},29:{n:"Version",t:zi},255:{},2147483648:{n:"Locale",t:fw},2147483651:{n:"Behavior",t:fw},1919054434:{}},QO={1:{n:"CodePage",t:_G},2:{n:"Title",t:zi},3:{n:"Subject",t:zi},4:{n:"Author",t:zi},5:{n:"Keywords",t:zi},6:{n:"Comments",t:zi},7:{n:"Template",t:zi},8:{n:"LastAuthor",t:zi},9:{n:"RevNumber",t:zi},10:{n:"EditTime",t:r_},11:{n:"LastPrinted",t:r_},12:{n:"CreatedDate",t:r_},13:{n:"ModifiedDate",t:r_},14:{n:"PageCount",t:sa},15:{n:"WordCount",t:sa},16:{n:"CharCount",t:sa},17:{n:"Thumbnail",t:Zye},18:{n:"Application",t:zi},19:{n:"DocSecurity",t:sa},255:{},2147483648:{n:"Locale",t:fw},2147483651:{n:"Behavior",t:fw},1919054434:{}};function e_e(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var t_e=e_e([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n_e=qs(t_e),gx={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},r_e={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},i_={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function vG(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function wG(n,e){var t=fye(r_e),r=[],i;r[r.length]=ai,r[r.length]=st("Types",null,{xmlns:Ai.CT,"xmlns:xsd":Ai.xsd,"xmlns:xsi":Ai.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return st("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){n[l]&&n[l].length>0&&(i=n[l][0],r[r.length]=st("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:i_[l][e.bookType]||i_[l].xlsx}))},a=function(l){(n[l]||[]).forEach(function(c){r[r.length]=st("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:i_[l][e.bookType]||i_[l].xlsx})})},o=function(l){(n[l]||[]).forEach(function(c){r[r.length]=st("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:t[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var Nn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function EG(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function I0(n){var e=[ai,st("Relationships",null,{xmlns:Ai.RELS})];return qi(n["!id"]).forEach(function(t){e[e.length]=st("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Xn(n,e,t,r,i,s){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=t,[Nn.HLINK,Nn.XPATH,Nn.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,e}function i_e(n){var e=[ai];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function eD(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function s_e(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function a_e(n){var e=[ai];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(eD(n[t][0],n[t][1])),e.push(s_e("",n[t][0]));return e.push(eD("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function SG(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+iw.version+"</meta:generator></office:meta></office:document-meta>"}var rd=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function KT(n,e,t,r,i){i[n]!=null||e==null||e===""||(i[n]=e,e=Jn(e),r[r.length]=t?st(n,e,t):Ki(n,e))}function TG(n,e){var t=e||{},r=[ai,st("cp:coreProperties",null,{"xmlns:cp":Ai.CORE_PROPS,"xmlns:dc":Ai.dc,"xmlns:dcterms":Ai.dcterms,"xmlns:dcmitype":Ai.dcmitype,"xmlns:xsi":Ai.xsi})],i={};if(!n&&!t.Props)return r.join("");n&&(n.CreatedDate!=null&&KT("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:JR(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&KT("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:JR(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=rd.length;++s){var a=rd[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:n?n[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&KT(a[0],o,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var C0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],bG=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function RG(n){var e=[],t=st;return n||(n={}),n.Application="SheetJS",e[e.length]=ai,e[e.length]=st("Properties",null,{xmlns:Ai.EXT_PROPS,"xmlns:vt":Ai.vt}),C0.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Jn(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(r[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+Jn(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function AG(n){var e=[ai,st("Properties",null,{xmlns:Ai.CUST_PROPS,"xmlns:vt":Ai.vt})];if(!n)return e.join("");var t=1;return qi(n).forEach(function(i){++t,e[e.length]=st("property",Tye(n[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Jn(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var tD={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function o_e(n,e){var t=[];return qi(tD).map(function(r){for(var i=0;i<rd.length;++i)if(rd[i][1]==r)return rd[i];for(i=0;i<C0.length;++i)if(C0[i][1]==r)return C0[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(Ki(tD[r[1]]||r[1],i))}}),st("DocumentProperties",t.join(""),{xmlns:ca.o})}function l_e(n,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&qi(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var a=0;a<rd.length;++a)if(s==rd[a][1])return;for(a=0;a<C0.length;++a)if(s==C0[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=n[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(st(zO(s),o,{"dt:dt":l}))}}),e&&qi(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(st(zO(s),a,{"dt:dt":o}))}}),"<"+r+' xmlns="'+ca.o+'">'+i.join("")+"</"+r+">"}function c_e(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),i=(t-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var a=Le(8);return a.write_shift(4,r),a.write_shift(4,i),a}function nD(n,e){var t=Le(4),r=Le(4);switch(t.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,e);break;case 5:r=Le(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=c_e(e);break;case 31:case 80:for(r=Le(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return Hi([t,r])}var kG=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function u_e(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function rD(n,e,t){var r=Le(8),i=[],s=[],a=8,o=0,l=Le(8),c=Le(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=Le(8),c.write_shift(4,0),i.unshift(c);var h=[Le(4)];for(h[0].write_shift(4,n.length),o=0;o<n.length;++o){var g=n[o][0];for(l=Le(8+2*(g.length+1)+(g.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,g.length+1),l.write_shift(0,g,"dbcs");l.l!=l.length;)l.write_shift(1,0);h.push(l)}l=Hi(h),s.unshift(l),a+=8+l.length}for(o=0;o<n.length;++o)if(!(e&&!e[n[o][0]])&&!(kG.indexOf(n[o][0])>-1||bG.indexOf(n[o][0])>-1)&&n[o][1]!=null){var m=n[o][1],x=0;if(e){x=+e[n[o][0]];var y=t[x];if(y.p=="version"&&typeof m=="string"){var _=m.split(".");m=(+_[0]<<16)+(+_[1]||0)}l=nD(y.t,m)}else{var w=u_e(m);w==-1&&(w=31,m=String(m)),l=nD(w,m)}s.push(l),c=Le(8),c.write_shift(4,e?x:2+o),i.push(c),a+=8+l.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return r.write_shift(4,a),r.write_shift(4,s.length),Hi([r].concat(i).concat(s))}function iD(n,e,t,r,i,s){var a=Le(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,nr.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=rD(n,t,r);if(o.push(l),i){var c=rD(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return Hi(o)}function h_e(n,e){e||(e=Le(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function d_e(n,e){return n.read_shift(e)===1}function ws(n,e){return e||(e=Le(2)),e.write_shift(2,+!!n),e}function IG(n){return n.read_shift(2,"u")}function Na(n,e){return e||(e=Le(2)),e.write_shift(2,n),e}function CG(n,e,t){return t||(t=Le(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function PG(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=n.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var a=r?n.read_shift(r,i):"";return a}function f_e(n){var e=n.t||"",t=Le(3);t.write_shift(2,e.length),t.write_shift(1,1);var r=Le(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[t,r];return Hi(i)}function g_e(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function m_e(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):g_e(n,r,t)}function p_e(n,e,t){if(t.biff>5)return m_e(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function NG(n,e,t){return t||(t=Le(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function sD(n,e){e||(e=Le(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function x_e(n){var e=Le(512),t=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)r=r.slice(1),sD(r,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&sD(i>-1?r.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),t=0;t<r.length-3*l;++t)e.write_shift(1,r.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function Rd(n,e,t,r){return r||(r=Le(6)),r.write_shift(2,n),r.write_shift(2,e),r.write_shift(2,t||0),r}function y_e(n,e,t){var r=t.biff>8?4:2,i=n.read_shift(r),s=n.read_shift(r,"i"),a=n.read_shift(r,"i");return[i,s,a]}function __e(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:t}}}function MG(n,e){return e||(e=Le(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function CC(n,e,t){var r=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Le(i);return s.write_shift(2,r),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function v_e(n,e){var t=!e||e.biff==8,r=Le(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function w_e(n,e){var t=!e||e.biff>=8?2:1,r=Le(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function E_e(n,e){var t=Le(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=f_e(n[i]);var s=Hi([t].concat(r));return s.parts=[t.length].concat(r.map(function(a){return a.length})),s}function S_e(){var n=Le(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function T_e(n){var e=Le(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function b_e(n,e){var t=n.name||"Arial",r=e&&e.biff==5,i=r?15+t.length:16+2*t.length,s=Le(i);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),s}function R_e(n,e,t,r){var i=Le(10);return Rd(n,e,r,i),i.write_shift(4,t),i}function A_e(n,e,t,r,i){var s=!i||i.biff==8,a=Le(8+ +s+(1+s)*t.length);return Rd(n,e,r,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function k_e(n,e,t,r){var i=t&&t.biff==5;r||(r=Le(i?3+e.length:5+2*e.length)),r.write_shift(2,n),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function I_e(n,e){var t=e.biff==8||!e.biff?4:2,r=Le(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function aD(n,e,t,r){var i=t&&t.biff==5;r||(r=Le(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,e<<4));var s=0;return n.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function C_e(n){var e=Le(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function P_e(n,e,t,r,i,s){var a=Le(8);return Rd(n,e,r,a),CG(t,s,a),a}function N_e(n,e,t,r){var i=Le(14);return Rd(n,e,r,i),bd(t,i),i}function M_e(n,e,t){if(t.biff<8)return L_e(n,e,t);for(var r=[],i=n.l+e,s=n.read_shift(t.biff>8?4:2);s--!==0;)r.push(y_e(n,t.biff>8?12:6,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function L_e(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=PG(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function O_e(n){var e=Le(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)MG(n[t],e);return e}function D_e(n){var e=Le(24),t=Ci(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return Hi([e,x_e(n[1])])}function j_e(n){var e=n[1].Tooltip,t=Le(10+2*(e.length+1));t.write_shift(2,2048);var r=Ci(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function F_e(n){return n||(n=Le(4)),n.write_shift(2,1),n.write_shift(2,1),n}function V_e(n,e,t){if(!t.cellStyles)return xl(n,e);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),s=n.read_shift(r),a=n.read_shift(r),o=n.read_shift(r),l=n.read_shift(2);r==2&&(n.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}function B_e(n,e){var t=Le(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),r=n.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function G_e(n){for(var e=Le(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function z_e(n,e,t){var r=Le(15);return px(r,n,e),r.write_shift(8,t,"f"),r}function U_e(n,e,t){var r=Le(9);return px(r,n,e),r.write_shift(2,t),r}var $_e=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=_C({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var c=[],h=Td(1);switch(l.type){case"base64":h=mo(dc(o));break;case"binary":h=mo(o);break;case"buffer":case"array":h=o;break}oa(h,0);var g=h.read_shift(1),m=!!(g&136),x=!1,y=!1;switch(g){case 2:break;case 3:break;case 48:x=!0,m=!0;break;case 49:x=!0,m=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var _=0,w=521;g==2&&(_=h.read_shift(2)),h.l+=3,g!=2&&(_=h.read_shift(4)),_>1048576&&(_=1e6),g!=2&&(w=h.read_shift(2));var T=h.read_shift(2),b=l.codepage||1252;g!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(b=n[h[h.l]]),h.l+=1,h.l+=2),y&&(h.l+=36);for(var R=[],M={},D=Math.min(h.length,g==2?521:w-10-(x?264:0)),B=y?32:11;h.l<D&&h[h.l]!=13;)switch(M={},M.name=sw.utils.decode(b,h.slice(h.l,h.l+B)).replace(/[\u0000\r\n].*$/g,""),h.l+=B,M.type=String.fromCharCode(h.read_shift(1)),g!=2&&!y&&(M.offset=h.read_shift(4)),M.len=h.read_shift(1),g==2&&(M.offset=h.read_shift(2)),M.dec=h.read_shift(1),M.name.length&&R.push(M),g!=2&&(h.l+=y?13:14),M.type){case"B":(!x||M.len!=8)&&l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(h[h.l]!==13&&(h.l=w-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=w;var k=0,A=0;for(c[0]=[],A=0;A!=R.length;++A)c[0][A]=R[A].name;for(;_-- >0;){if(h[h.l]===42){h.l+=T;continue}for(++h.l,c[++k]=[],A=0,A=0;A!=R.length;++A){var C=h.slice(h.l,h.l+R[A].len);h.l+=R[A].len,oa(C,0);var O=sw.utils.decode(b,C);switch(R[A].type){case"C":O.trim().length&&(c[k][A]=O.replace(/\s+$/,""));break;case"D":O.length===8?c[k][A]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):c[k][A]=O;break;case"F":c[k][A]=parseFloat(O.trim());break;case"+":case"I":c[k][A]=y?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":c[k][A]=!0;break;case"N":case"F":c[k][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));c[k][A]="##MEMO##"+(y?parseInt(O.trim(),10):C.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(c[k][A]=+O||0);break;case"@":c[k][A]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":c[k][A]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":c[k][A]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[k][A]=-C.read_shift(-8,"f");break;case"B":if(x&&R[A].len==8){c[k][A]=C.read_shift(8,"f");break}case"G":case"P":C.l+=R[A].len;break;case"0":if(R[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+R[A].type)}}}if(g!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=R,c}function r(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var h=Sg(t(o,c),c);return h["!cols"]=c.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete c.DBF,h}function i(o,l){try{return Bd(r(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&d1(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var h=Us(),g=yw(o,{header:1,raw:!0,cellDates:!0}),m=g[0],x=g.slice(1),y=o["!cols"]||[],_=0,w=0,T=0,b=1;for(_=0;_<m.length;++_){if(((y[_]||{}).DBF||{}).name){m[_]=y[_].DBF.name,++T;continue}if(m[_]!=null){if(++T,typeof m[_]=="number"&&(m[_]=m[_].toString(10)),typeof m[_]!="string")throw new Error("DBF Invalid column name "+m[_]+" |"+typeof m[_]+"|");if(m.indexOf(m[_])!==_){for(w=0;w<1024;++w)if(m.indexOf(m[_]+"_"+w)==-1){m[_]+="_"+w;break}}}}var R=mr(o["!ref"]),M=[],D=[],B=[];for(_=0;_<=R.e.c-R.s.c;++_){var k="",A="",C=0,O=[];for(w=0;w<x.length;++w)x[w][_]!=null&&O.push(x[w][_]);if(O.length==0||m[_]==null){M[_]="?";continue}for(w=0;w<O.length;++w){switch(typeof O[w]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=O[w]instanceof Date?"D":"C";break;default:A="C"}C=Math.max(C,String(O[w]).length),k=k&&k!=A?"C":A}C>250&&(C=250),A=((y[_]||{}).DBF||{}).type,A=="C"&&y[_].DBF.len>C&&(C=y[_].DBF.len),k=="B"&&A=="N"&&(k="N",B[_]=y[_].DBF.dec,C=y[_].DBF.len),D[_]=k=="C"||A=="N"?C:s[k]||0,b+=D[_],M[_]=k}var P=h.next(32);for(P.write_shift(4,318902576),P.write_shift(4,x.length),P.write_shift(2,296+32*T),P.write_shift(2,b),_=0;_<4;++_)P.write_shift(4,0);for(P.write_shift(4,0|(+e[OB]||3)<<8),_=0,w=0;_<m.length;++_)if(m[_]!=null){var z=h.next(32),F=(m[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);z.write_shift(1,F,"sbcs"),z.write_shift(1,M[_]=="?"?"C":M[_],"sbcs"),z.write_shift(4,w),z.write_shift(1,D[_]||s[M[_]]||0),z.write_shift(1,B[_]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),w+=D[_]||s[M[_]]||0}var xe=h.next(264);for(xe.write_shift(4,13),_=0;_<65;++_)xe.write_shift(4,0);for(_=0;_<x.length;++_){var Ce=h.next(b);for(Ce.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(M[w]){case"L":Ce.write_shift(1,x[_][w]==null?63:x[_][w]?84:70);break;case"B":Ce.write_shift(8,x[_][w]||0,"f");break;case"N":var Ge="0";for(typeof x[_][w]=="number"&&(Ge=x[_][w].toFixed(B[w]||0)),T=0;T<D[w]-Ge.length;++T)Ce.write_shift(1,32);Ce.write_shift(1,Ge,"sbcs");break;case"D":x[_][w]?(Ce.write_shift(4,("0000"+x[_][w].getFullYear()).slice(-4),"sbcs"),Ce.write_shift(2,("00"+(x[_][w].getMonth()+1)).slice(-2),"sbcs"),Ce.write_shift(2,("00"+x[_][w].getDate()).slice(-2),"sbcs")):Ce.write_shift(8,"00000000","sbcs");break;case"C":var Ne=String(x[_][w]!=null?x[_][w]:"").slice(0,D[w]);for(Ce.write_shift(1,Ne,"sbcs"),T=0;T<D[w]-Ne.length;++T)Ce.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:r,from_sheet:a}})(),W_e=(function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+qi(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(m,x){var y=n[x];return typeof y=="number"?CO(y):y},r=function(m,x,y){var _=x.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return _==59?m:CO(_)};n["|"]=254;function i(m,x){switch(x.type){case"base64":return s(dc(m),x);case"binary":return s(m,x);case"buffer":return s(jn&&Buffer.isBuffer(m)?m.toString("binary"):hx(m),x);case"array":return s(HE(m),x)}throw new Error("Unrecognized type "+x.type)}function s(m,x){var y=m.split(/[\n\r]+/),_=-1,w=-1,T=0,b=0,R=[],M=[],D=null,B={},k=[],A=[],C=[],O=0,P;for(+x.codepage>=0&&d1(+x.codepage);T!==y.length;++T){O=0;var z=y[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),F=z.replace(/;;/g,"\0").split(";").map(function(re){return re.replace(/\u0000/g,";")}),xe=F[0],Ce;if(z.length>0)switch(xe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&M.push(z.slice(3).replace(/;;/g,";"));break;case"C":var Ge=!1,Ne=!1,ue=!1,ke=!1,ae=-1,Z=-1;for(b=1;b<F.length;++b)switch(F[b].charAt(0)){case"A":break;case"X":w=parseInt(F[b].slice(1))-1,Ne=!0;break;case"Y":for(_=parseInt(F[b].slice(1))-1,Ne||(w=0),P=R.length;P<=_;++P)R[P]=[];break;case"K":Ce=F[b].slice(1),Ce.charAt(0)==='"'?Ce=Ce.slice(1,Ce.length-1):Ce==="TRUE"?Ce=!0:Ce==="FALSE"?Ce=!1:isNaN(tc(Ce))?isNaN(g1(Ce).getDate())||(Ce=Rs(Ce)):(Ce=tc(Ce),D!==null&&KB(D)&&(Ce=ZB(Ce))),Ge=!0;break;case"E":ke=!0;var V=Uve(F[b].slice(1),{r:_,c:w});R[_][w]=[R[_][w],V];break;case"S":ue=!0,R[_][w]=[R[_][w],"S5S"];break;case"G":break;case"R":ae=parseInt(F[b].slice(1))-1;break;case"C":Z=parseInt(F[b].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+z)}if(Ge&&(R[_][w]&&R[_][w].length==2?R[_][w][0]=Ce:R[_][w]=Ce,D=null),ue){if(ke)throw new Error("SYLK shared formula cannot have own formula");var Q=ae>-1&&R[ae][Z];if(!Q||!Q[1])throw new Error("SYLK shared formula cannot find base");R[_][w][1]=$ve(Q[1],{r:_-ae,c:w-Z})}break;case"F":var ee=0;for(b=1;b<F.length;++b)switch(F[b].charAt(0)){case"X":w=parseInt(F[b].slice(1))-1,++ee;break;case"Y":for(_=parseInt(F[b].slice(1))-1,P=R.length;P<=_;++P)R[P]=[];break;case"M":O=parseInt(F[b].slice(1))/20;break;case"F":break;case"G":break;case"P":D=M[parseInt(F[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=F[b].slice(1).split(" "),P=parseInt(C[0],10);P<=parseInt(C[1],10);++P)O=parseInt(C[2],10),A[P-1]=O===0?{hidden:!0}:{wch:O},PC(A[P-1]);break;case"C":w=parseInt(F[b].slice(1))-1,A[w]||(A[w]={});break;case"R":_=parseInt(F[b].slice(1))-1,k[_]||(k[_]={}),O>0?(k[_].hpt=O,k[_].hpx=FG(O)):O===0&&(k[_].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+z)}ee<1&&(D=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+z)}}return k.length>0&&(B["!rows"]=k),A.length>0&&(B["!cols"]=A),x&&x.sheetRows&&(R=R.slice(0,x.sheetRows)),[R,B]}function a(m,x){var y=i(m,x),_=y[0],w=y[1],T=Sg(_,x);return qi(w).forEach(function(b){T[b]=w[b]}),T}function o(m,x){return Bd(a(m,x),x)}function l(m,x,y,_){var w="C;Y"+(y+1)+";X"+(_+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+MC(m.f,{r:y,c:_}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(m,x){x.forEach(function(y,_){var w="F;W"+(_+1)+" "+(_+1)+" ";y.hidden?w+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=gw(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=mw(y.wpx)),typeof y.wch=="number"&&(w+=Math.round(y.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function h(m,x){x.forEach(function(y,_){var w="F;";y.hidden?w+="M0;":y.hpt?w+="M"+20*y.hpt+";":y.hpx&&(w+="M"+20*pw(y.hpx)+";"),w.length>2&&m.push(w+"R"+(_+1))})}function g(m,x){var y=["ID;PWXL;N;E"],_=[],w=mr(m["!ref"]),T,b=Array.isArray(m),R=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),m["!cols"]&&c(y,m["!cols"]),m["!rows"]&&h(y,m["!rows"]),y.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var M=w.s.r;M<=w.e.r;++M)for(var D=w.s.c;D<=w.e.c;++D){var B=er({r:M,c:D});T=b?(m[M]||[])[D]:m[B],!(!T||T.v==null&&(!T.f||T.F))&&_.push(l(T,m,M,D))}return y.join(R)+R+_.join(R)+R+"E"+R}return{to_workbook:o,to_sheet:a,from_sheet:g}})(),H_e=(function(){function n(s,a){switch(a.type){case"base64":return e(dc(s),a);case"binary":return e(s,a);case"buffer":return e(jn&&Buffer.isBuffer(s)?s.toString("binary"):hx(s),a);case"array":return e(HE(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,h=0,g=[];h!==o.length;++h){if(o[h].trim()==="BOT"){g[++l]=[],c=0;continue}if(!(l<0)){var m=o[h].trim().split(","),x=m[0],y=m[1];++h;for(var _=o[h]||"";(_.match(/["]/g)||[]).length&1&&h<o.length-1;)_+=`
`+o[++h];switch(_=_.trim(),+x){case-1:if(_==="BOT"){g[++l]=[],c=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?g[l][c]=!0:_==="FALSE"?g[l][c]=!1:isNaN(tc(y))?isNaN(g1(y).getDate())?g[l][c]=y:g[l][c]=Rs(y):g[l][c]=tc(y),++c;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),g[l][c++]=_!==""?_:null;break}if(_==="EOD")break}}return a&&a.sheetRows&&(g=g.slice(0,a.sheetRows)),g}function t(s,a){return Sg(n(s,a),a)}function r(s,a){return Bd(t(s,a),a)}var i=(function(){var s=function(l,c,h,g,m){l.push(c),l.push(h+","+g),l.push('"'+m.replace(/"/g,'""')+'"')},a=function(l,c,h,g){l.push(c+","+h),l.push(c==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(l){var c=[],h=mr(l["!ref"]),g,m=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,h.e.r-h.s.r+1,""),s(c,"TUPLES",0,h.e.c-h.s.c+1,""),s(c,"DATA",0,0,"");for(var x=h.s.r;x<=h.e.r;++x){a(c,-1,0,"BOT");for(var y=h.s.c;y<=h.e.c;++y){var _=er({r:x,c:y});if(g=m?(l[x]||[])[y]:l[_],!g){a(c,1,0,"");continue}switch(g.t){case"n":var w=g.w;!w&&g.v!=null&&(w=g.v),w==null?g.f&&!g.F?a(c,1,0,"="+g.f):a(c,1,0,""):a(c,0,w,"V");break;case"b":a(c,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Uu(g.z||Br[14],Xs(Rs(g.v)))),a(c,0,g.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var T=`\r
`,b=c.join(T);return b}})();return{to_workbook:r,to_sheet:t,from_sheet:i}})(),LG=(function(){function n(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,m){for(var x=g.split(`
`),y=-1,_=-1,w=0,T=[];w!==x.length;++w){var b=x[w].trim().split(":");if(b[0]==="cell"){var R=Ci(b[1]);if(T.length<=R.r)for(y=T.length;y<=R.r;++y)T[y]||(T[y]=[]);switch(y=R.r,_=R.c,b[2]){case"t":T[y][_]=n(b[3]);break;case"v":T[y][_]=+b[3];break;case"vtf":var M=b[b.length-1];case"vtc":switch(b[3]){case"nl":T[y][_]=!!+b[4];break;default:T[y][_]=+b[4];break}b[2]=="vtf"&&(T[y][_]=[T[y][_],M])}}}return m&&m.sheetRows&&(T=T.slice(0,m.sheetRows)),T}function r(g,m){return Sg(t(g,m),m)}function i(g,m){return Bd(r(g,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(g){if(!g||!g["!ref"])return"";for(var m=[],x=[],y,_="",w=ya(g["!ref"]),T=Array.isArray(g),b=w.s.r;b<=w.e.r;++b)for(var R=w.s.c;R<=w.e.c;++R)if(_=er({r:b,c:R}),y=T?(g[b]||[])[R]:g[_],!(!y||y.v==null||y.t==="z")){switch(x=["cell",_,"t"],y.t){case"s":case"str":x.push(e(y.v));break;case"n":y.f?(x[2]="vtf",x[3]="n",x[4]=y.v,x[5]=e(y.f)):(x[2]="v",x[3]=y.v);break;case"b":x[2]="vt"+(y.f?"f":"c"),x[3]="nl",x[4]=y.v?"1":"0",x[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var M=Xs(Rs(y.v));x[2]="vtc",x[3]="nd",x[4]=""+M,x[5]=y.w||Uu(y.z||Br[14],M);break;case"e":continue}m.push(x.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(g){return[s,a,o,a,c(g),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:h}})(),K_e=(function(){function n(h,g,m,x,y){y.raw?g[m][x]=h:h===""||(h==="TRUE"?g[m][x]=!0:h==="FALSE"?g[m][x]=!1:isNaN(tc(h))?isNaN(g1(h).getDate())?g[m][x]=h:g[m][x]=Rs(h):g[m][x]=tc(h))}function e(h,g){var m=g||{},x=[];if(!h||h.length===0)return x;for(var y=h.split(/[\r\n]/),_=y.length-1;_>=0&&y[_].length===0;)--_;for(var w=10,T=0,b=0;b<=_;++b)T=y[b].indexOf(" "),T==-1?T=y[b].length:T++,w=Math.max(w,T);for(b=0;b<=_;++b){x[b]=[];var R=0;for(n(y[b].slice(0,w).trim(),x,b,R,m),R=1;R<=(y[b].length-w)/10+1;++R)n(y[b].slice(w+(R-1)*10,w+R*10).trim(),x,b,R,m)}return m.sheetRows&&(x=x.slice(0,m.sheetRows)),x}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(h){for(var g={},m=!1,x=0,y=0;x<h.length;++x)(y=h.charCodeAt(x))==34?m=!m:!m&&y in t&&(g[y]=(g[y]||0)+1);y=[];for(x in g)Object.prototype.hasOwnProperty.call(g,x)&&y.push([g[x],x]);if(!y.length){g=r;for(x in g)Object.prototype.hasOwnProperty.call(g,x)&&y.push([g[x],x])}return y.sort(function(_,w){return _[0]-w[0]||r[_[1]]-r[w[1]]}),t[y.pop()[1]]||44}function s(h,g){var m=g||{},x="",y=m.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(x=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(x=h.charAt(4),h=h.slice(6)):x=i(h.slice(0,1024)):m&&m.FS?x=m.FS:x=i(h.slice(0,1024));var w=0,T=0,b=0,R=0,M=0,D=x.charCodeAt(0),B=!1,k=0,A=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var C=m.dateNF!=null?cye(m.dateNF):null;function O(){var P=h.slice(R,M),z={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)z.t="z";else if(m.raw)z.t="s",z.v=P;else if(P.trim().length===0)z.t="s",z.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(z.t="s",z.v=P.slice(2,-1).replace(/""/g,'"')):Wve(P)?(z.t="n",z.f=P.slice(1)):(z.t="s",z.v=P);else if(P=="TRUE")z.t="b",z.v=!0;else if(P=="FALSE")z.t="b",z.v=!1;else if(!isNaN(b=tc(P)))z.t="n",m.cellText!==!1&&(z.w=P),z.v=b;else if(!isNaN(g1(P).getDate())||C&&P.match(C)){z.z=m.dateNF||Br[14];var F=0;C&&P.match(C)&&(P=uye(P,m.dateNF,P.match(C)||[]),F=1),m.cellDates?(z.t="d",z.v=Rs(P,F)):(z.t="n",z.v=Xs(Rs(P,F))),m.cellText!==!1&&(z.w=Uu(z.z,z.v instanceof Date?Xs(z.v):z.v)),m.cellNF||delete z.z}else z.t="s",z.v=P;if(z.t=="z"||(m.dense?(y[w]||(y[w]=[]),y[w][T]=z):y[er({c:T,r:w})]=z),R=M+1,A=h.charCodeAt(R),_.e.c<T&&(_.e.c=T),_.e.r<w&&(_.e.r=w),k==D)++T;else if(T=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;M<h.length;++M)switch(k=h.charCodeAt(M)){case 34:A===34&&(B=!B);break;case D:case 10:case 13:if(!B&&O())break e;break}return M-R>0&&O(),y["!ref"]=ii(_),y}function a(h,g){return!(g&&g.PRN)||g.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,g):Sg(e(h,g),g)}function o(h,g){var m="",x=g.type=="string"?[0,0,0,0]:sTe(h,g);switch(g.type){case"base64":m=dc(h);break;case"binary":m=h;break;case"buffer":g.codepage==65001?m=h.toString("utf8"):g.codepage&&typeof sw<"u"||(m=jn&&Buffer.isBuffer(h)?h.toString("binary"):hx(h));break;case"array":m=HE(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+g.type)}return x[0]==239&&x[1]==187&&x[2]==191?m=gp(m.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?m=gp(m):g.type=="binary"&&typeof sw<"u",m.slice(0,19)=="socialcalc:version:"?LG.to_sheet(g.type=="string"?m:gp(m),g):a(m,g)}function l(h,g){return Bd(o(h,g),g)}function c(h){for(var g=[],m=mr(h["!ref"]),x,y=Array.isArray(h),_=m.s.r;_<=m.e.r;++_){for(var w=[],T=m.s.c;T<=m.e.c;++T){var b=er({r:_,c:T});if(x=y?(h[_]||[])[T]:h[b],!x||x.v==null){w.push("          ");continue}for(var R=(x.w||(fc(x),x.w)||"").slice(0,10);R.length<10;)R+=" ";w.push(R+(T===0?" ":""))}g.push(w.join(""))}return g.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}})(),oD=(function(){function n(V,Q,ee){if(V){oa(V,V.l||0);for(var re=ee.Enum||ae;V.l<V.length;){var he=V.read_shift(2),Ve=re[he]||re[65535],Be=V.read_shift(2),ye=V.l+Be,pe=Ve.f&&Ve.f(V,Be,ee);if(V.l=ye,Q(pe,Ve,he))return}}}function e(V,Q){switch(Q.type){case"base64":return t(mo(dc(V)),Q);case"binary":return t(mo(V),Q);case"buffer":case"array":return t(V,Q)}throw"Unsupported type "+Q.type}function t(V,Q){if(!V)return V;var ee=Q||{},re=ee.dense?[]:{},he="Sheet1",Ve="",Be=0,ye={},pe=[],Fe=[],Et={s:{r:0,c:0},e:{r:0,c:0}},Ft=ee.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)ee.Enum=ae,n(V,function(ot,tr,dn){switch(dn){case 0:ee.vers=ot,ot>=4096&&(ee.qpro=!0);break;case 6:Et=ot;break;case 204:ot&&(Ve=ot);break;case 222:Ve=ot;break;case 15:case 51:ee.qpro||(ot[1].v=ot[1].v.slice(1));case 13:case 14:case 16:dn==14&&(ot[2]&112)==112&&(ot[2]&15)>1&&(ot[2]&15)<15&&(ot[1].z=ee.dateNF||Br[14],ee.cellDates&&(ot[1].t="d",ot[1].v=ZB(ot[1].v))),ee.qpro&&ot[3]>Be&&(re["!ref"]=ii(Et),ye[he]=re,pe.push(he),re=ee.dense?[]:{},Et={s:{r:0,c:0},e:{r:0,c:0}},Be=ot[3],he=Ve||"Sheet"+(Be+1),Ve="");var un=ee.dense?(re[ot[0].r]||[])[ot[0].c]:re[er(ot[0])];if(un){un.t=ot[1].t,un.v=ot[1].v,ot[1].z!=null&&(un.z=ot[1].z),ot[1].f!=null&&(un.f=ot[1].f);break}ee.dense?(re[ot[0].r]||(re[ot[0].r]=[]),re[ot[0].r][ot[0].c]=ot[1]):re[er(ot[0])]=ot[1];break}},ee);else if(V[2]==26||V[2]==14)ee.Enum=Z,V[2]==14&&(ee.qpro=!0,V.l=0),n(V,function(ot,tr,dn){switch(dn){case 204:he=ot;break;case 22:ot[1].v=ot[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ot[3]>Be&&(re["!ref"]=ii(Et),ye[he]=re,pe.push(he),re=ee.dense?[]:{},Et={s:{r:0,c:0},e:{r:0,c:0}},Be=ot[3],he="Sheet"+(Be+1)),Ft>0&&ot[0].r>=Ft)break;ee.dense?(re[ot[0].r]||(re[ot[0].r]=[]),re[ot[0].r][ot[0].c]=ot[1]):re[er(ot[0])]=ot[1],Et.e.c<ot[0].c&&(Et.e.c=ot[0].c),Et.e.r<ot[0].r&&(Et.e.r=ot[0].r);break;case 27:ot[14e3]&&(Fe[ot[14e3][0]]=ot[14e3][1]);break;case 1537:Fe[ot[0]]=ot[1],ot[0]==Be&&(he=ot[1]);break}},ee);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(re["!ref"]=ii(Et),ye[Ve||he]=re,pe.push(Ve||he),!Fe.length)return{SheetNames:pe,Sheets:ye};for(var Dt={},Xt=[],en=0;en<Fe.length;++en)ye[pe[en]]?(Xt.push(Fe[en]||pe[en]),Dt[Fe[en]]=ye[Fe[en]]||ye[pe[en]]):(Xt.push(Fe[en]),Dt[Fe[en]]={"!ref":"A1"});return{SheetNames:Xt,Sheets:Dt}}function r(V,Q){var ee=Q||{};if(+ee.codepage>=0&&d1(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK1 to JS string");var re=Us(),he=mr(V["!ref"]),Ve=Array.isArray(V),Be=[];at(re,0,s(1030)),at(re,6,l(he));for(var ye=Math.min(he.e.r,8191),pe=he.s.r;pe<=ye;++pe)for(var Fe=Xi(pe),Et=he.s.c;Et<=he.e.c;++Et){pe===he.s.r&&(Be[Et]=ms(Et));var Ft=Be[Et]+Fe,Dt=Ve?(V[pe]||[])[Et]:V[Ft];if(!(!Dt||Dt.t=="z"))if(Dt.t=="n")(Dt.v|0)==Dt.v&&Dt.v>=-32768&&Dt.v<=32767?at(re,13,x(pe,Et,Dt.v)):at(re,14,_(pe,Et,Dt.v));else{var Xt=fc(Dt);at(re,15,g(pe,Et,Xt.slice(0,239)))}}return at(re,1),re.end()}function i(V,Q){var ee=Q||{};if(+ee.codepage>=0&&d1(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK3 to JS string");var re=Us();at(re,0,a(V));for(var he=0,Ve=0;he<V.SheetNames.length;++he)(V.Sheets[V.SheetNames[he]]||{})["!ref"]&&at(re,27,ke(V.SheetNames[he],Ve++));var Be=0;for(he=0;he<V.SheetNames.length;++he){var ye=V.Sheets[V.SheetNames[he]];if(!(!ye||!ye["!ref"])){for(var pe=mr(ye["!ref"]),Fe=Array.isArray(ye),Et=[],Ft=Math.min(pe.e.r,8191),Dt=pe.s.r;Dt<=Ft;++Dt)for(var Xt=Xi(Dt),en=pe.s.c;en<=pe.e.c;++en){Dt===pe.s.r&&(Et[en]=ms(en));var ot=Et[en]+Xt,tr=Fe?(ye[Dt]||[])[en]:ye[ot];if(!(!tr||tr.t=="z"))if(tr.t=="n")at(re,23,O(Dt,en,Be,tr.v));else{var dn=fc(tr);at(re,22,k(Dt,en,Be,dn.slice(0,239)))}}++Be}}return at(re,1),re.end()}function s(V){var Q=Le(2);return Q.write_shift(2,V),Q}function a(V){var Q=Le(26);Q.write_shift(2,4096),Q.write_shift(2,4),Q.write_shift(4,0);for(var ee=0,re=0,he=0,Ve=0;Ve<V.SheetNames.length;++Ve){var Be=V.SheetNames[Ve],ye=V.Sheets[Be];if(!(!ye||!ye["!ref"])){++he;var pe=ya(ye["!ref"]);ee<pe.e.r&&(ee=pe.e.r),re<pe.e.c&&(re=pe.e.c)}}return ee>8191&&(ee=8191),Q.write_shift(2,ee),Q.write_shift(1,he),Q.write_shift(1,re),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(1,1),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(4,0),Q}function o(V,Q,ee){var re={s:{c:0,r:0},e:{c:0,r:0}};return Q==8&&ee.qpro?(re.s.c=V.read_shift(1),V.l++,re.s.r=V.read_shift(2),re.e.c=V.read_shift(1),V.l++,re.e.r=V.read_shift(2),re):(re.s.c=V.read_shift(2),re.s.r=V.read_shift(2),Q==12&&ee.qpro&&(V.l+=2),re.e.c=V.read_shift(2),re.e.r=V.read_shift(2),Q==12&&ee.qpro&&(V.l+=2),re.s.c==65535&&(re.s.c=re.e.c=re.s.r=re.e.r=0),re)}function l(V){var Q=Le(8);return Q.write_shift(2,V.s.c),Q.write_shift(2,V.s.r),Q.write_shift(2,V.e.c),Q.write_shift(2,V.e.r),Q}function c(V,Q,ee){var re=[{c:0,r:0},{t:"n",v:0},0,0];return ee.qpro&&ee.vers!=20768?(re[0].c=V.read_shift(1),re[3]=V.read_shift(1),re[0].r=V.read_shift(2),V.l+=2):(re[2]=V.read_shift(1),re[0].c=V.read_shift(2),re[0].r=V.read_shift(2)),re}function h(V,Q,ee){var re=V.l+Q,he=c(V,Q,ee);if(he[1].t="s",ee.vers==20768){V.l++;var Ve=V.read_shift(1);return he[1].v=V.read_shift(Ve,"utf8"),he}return ee.qpro&&V.l++,he[1].v=V.read_shift(re-V.l,"cstr"),he}function g(V,Q,ee){var re=Le(7+ee.length);re.write_shift(1,255),re.write_shift(2,Q),re.write_shift(2,V),re.write_shift(1,39);for(var he=0;he<re.length;++he){var Ve=ee.charCodeAt(he);re.write_shift(1,Ve>=128?95:Ve)}return re.write_shift(1,0),re}function m(V,Q,ee){var re=c(V,Q,ee);return re[1].v=V.read_shift(2,"i"),re}function x(V,Q,ee){var re=Le(7);return re.write_shift(1,255),re.write_shift(2,Q),re.write_shift(2,V),re.write_shift(2,ee,"i"),re}function y(V,Q,ee){var re=c(V,Q,ee);return re[1].v=V.read_shift(8,"f"),re}function _(V,Q,ee){var re=Le(13);return re.write_shift(1,255),re.write_shift(2,Q),re.write_shift(2,V),re.write_shift(8,ee,"f"),re}function w(V,Q,ee){var re=V.l+Q,he=c(V,Q,ee);if(he[1].v=V.read_shift(8,"f"),ee.qpro)V.l=re;else{var Ve=V.read_shift(2);M(V.slice(V.l,V.l+Ve),he),V.l+=Ve}return he}function T(V,Q,ee){var re=Q&32768;return Q&=-32769,Q=(re?V:0)+(Q>=8192?Q-16384:Q),(re?"":"$")+(ee?ms(Q):Xi(Q))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},R=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(V,Q){oa(V,0);for(var ee=[],re=0,he="",Ve="",Be="",ye="";V.l<V.length;){var pe=V[V.l++];switch(pe){case 0:ee.push(V.read_shift(8,"f"));break;case 1:Ve=T(Q[0].c,V.read_shift(2),!0),he=T(Q[0].r,V.read_shift(2),!1),ee.push(Ve+he);break;case 2:{var Fe=T(Q[0].c,V.read_shift(2),!0),Et=T(Q[0].r,V.read_shift(2),!1);Ve=T(Q[0].c,V.read_shift(2),!0),he=T(Q[0].r,V.read_shift(2),!1),ee.push(Fe+Et+":"+Ve+he)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:ee.push("("+ee.pop()+")");break;case 5:ee.push(V.read_shift(2));break;case 6:{for(var Ft="";pe=V[V.l++];)Ft+=String.fromCharCode(pe);ee.push('"'+Ft.replace(/"/g,'""')+'"')}break;case 8:ee.push("-"+ee.pop());break;case 23:ee.push("+"+ee.pop());break;case 22:ee.push("NOT("+ee.pop()+")");break;case 20:case 21:ye=ee.pop(),Be=ee.pop(),ee.push(["AND","OR"][pe-20]+"("+Be+","+ye+")");break;default:if(pe<32&&R[pe])ye=ee.pop(),Be=ee.pop(),ee.push(Be+R[pe]+ye);else if(b[pe]){if(re=b[pe][1],re==69&&(re=V[V.l++]),re>ee.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+ee.join("|")+"|");return}var Dt=ee.slice(-re);ee.length-=re,ee.push(b[pe][0]+"("+Dt.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}ee.length==1?Q[1].f=""+ee[0]:console.error("WK1 bad formula parse |"+ee.join("|")+"|")}function D(V){var Q=[{c:0,r:0},{t:"n",v:0},0];return Q[0].r=V.read_shift(2),Q[3]=V[V.l++],Q[0].c=V[V.l++],Q}function B(V,Q){var ee=D(V);return ee[1].t="s",ee[1].v=V.read_shift(Q-4,"cstr"),ee}function k(V,Q,ee,re){var he=Le(6+re.length);he.write_shift(2,V),he.write_shift(1,ee),he.write_shift(1,Q),he.write_shift(1,39);for(var Ve=0;Ve<re.length;++Ve){var Be=re.charCodeAt(Ve);he.write_shift(1,Be>=128?95:Be)}return he.write_shift(1,0),he}function A(V,Q){var ee=D(V);ee[1].v=V.read_shift(2);var re=ee[1].v>>1;if(ee[1].v&1)switch(re&7){case 0:re=(re>>3)*5e3;break;case 1:re=(re>>3)*500;break;case 2:re=(re>>3)/20;break;case 3:re=(re>>3)/200;break;case 4:re=(re>>3)/2e3;break;case 5:re=(re>>3)/2e4;break;case 6:re=(re>>3)/16;break;case 7:re=(re>>3)/64;break}return ee[1].v=re,ee}function C(V,Q){var ee=D(V),re=V.read_shift(4),he=V.read_shift(4),Ve=V.read_shift(2);if(Ve==65535)return re===0&&he===3221225472?(ee[1].t="e",ee[1].v=15):re===0&&he===3489660928?(ee[1].t="e",ee[1].v=42):ee[1].v=0,ee;var Be=Ve&32768;return Ve=(Ve&32767)-16446,ee[1].v=(1-Be*2)*(he*Math.pow(2,Ve+32)+re*Math.pow(2,Ve)),ee}function O(V,Q,ee,re){var he=Le(14);if(he.write_shift(2,V),he.write_shift(1,ee),he.write_shift(1,Q),re==0)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var Ve=0,Be=0,ye=0,pe=0;return re<0&&(Ve=1,re=-re),Be=Math.log2(re)|0,re/=Math.pow(2,Be-31),pe=re>>>0,(pe&2147483648)==0&&(re/=2,++Be,pe=re>>>0),re-=pe,pe|=2147483648,pe>>>=0,re*=Math.pow(2,32),ye=re>>>0,he.write_shift(4,ye),he.write_shift(4,pe),Be+=16383+(Ve?32768:0),he.write_shift(2,Be),he}function P(V,Q){var ee=C(V);return V.l+=Q-14,ee}function z(V,Q){var ee=D(V),re=V.read_shift(4);return ee[1].v=re>>6,ee}function F(V,Q){var ee=D(V),re=V.read_shift(8,"f");return ee[1].v=re,ee}function xe(V,Q){var ee=F(V);return V.l+=Q-10,ee}function Ce(V,Q){return V[V.l+Q-1]==0?V.read_shift(Q,"cstr"):""}function Ge(V,Q){var ee=V[V.l++];ee>Q-1&&(ee=Q-1);for(var re="";re.length<ee;)re+=String.fromCharCode(V[V.l++]);return re}function Ne(V,Q,ee){if(!(!ee.qpro||Q<21)){var re=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var he=V.read_shift(Q-21,"cstr");return[re,he]}}function ue(V,Q){for(var ee={},re=V.l+Q;V.l<re;){var he=V.read_shift(2);if(he==14e3){for(ee[he]=[0,""],ee[he][0]=V.read_shift(2);V[V.l];)ee[he][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return ee}function ke(V,Q){var ee=Le(5+V.length);ee.write_shift(2,14e3),ee.write_shift(2,Q);for(var re=0;re<V.length;++re){var he=V.charCodeAt(re);ee[ee.l++]=he>127?95:he}return ee[ee.l++]=0,ee}var ae={0:{n:"BOF",f:IG},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ce},222:{n:"SHEETNAMELP",f:Ge},65535:{n:""}},Z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ue},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:z},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:xe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}})(),X_e=/^\s|\s$|[\t\n\r]/;function OG(n,e){if(!e.bookSST)return"";var t=[ai];t[t.length]=st("sst",null,{xmlns:Eg[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(X_e)&&(s+=' xml:space="preserve"'),s+=">"+Jn(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function q_e(n){return[n.read_shift(4),n.read_shift(4)]}function Y_e(n,e){return e||(e=Le(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var Z_e=Gye;function J_e(n){var e=Us();We(e,159,Y_e(n));for(var t=0;t<n.length;++t)We(e,19,Z_e(n[t]));return We(e,160),e.end()}function Q_e(n){for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function DG(n){var e=0,t,r=Q_e(n),i=r.length+1,s,a,o,l,c;for(t=Td(i),t[0]=r.length,s=1;s!=i;++s)t[s]=r[s-1];for(s=i-1;s>=0;--s)a=t[s],o=(e&16384)===0?0:1,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var eve=(function(){function n(i,s){switch(s.type){case"base64":return e(dc(i),s);case"binary":return e(i,s);case"buffer":return e(jn&&Buffer.isBuffer(i)?i.toString("binary"):hx(i),s);case"array":return e(HE(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,g){Array.isArray(o)&&(o[g]=[]);for(var m=/\\\w+\b/g,x=0,y,_=-1;y=m.exec(h);){switch(y[0]){case"\\cell":var w=h.slice(x,m.lastIndex-y[0].length);if(w[0]==" "&&(w=w.slice(1)),++_,w.length){var T={v:w,t:"s"};Array.isArray(o)?o[g][_]=T:o[er({r:g,c:_})]=T}break}x=m.lastIndex}_>c.e.c&&(c.e.c=_)}),o["!ref"]=ii(c),o}function t(i,s){return Bd(n(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],a=mr(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var g=er({r:c,c:h});o=l?(i[c]||[])[h]:i[g],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(fc(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:r}})();function lD(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var tve=6,nc=tve;function gw(n){return Math.floor((n+Math.round(128/nc)/256)*nc)}function mw(n){return Math.floor((n-5)/nc*100+.5)/100}function eA(n){return Math.round((n*nc+5)/nc*256)/256}function PC(n){n.width?(n.wpx=gw(n.width),n.wch=mw(n.wpx),n.MDW=nc):n.wpx?(n.wch=mw(n.wpx),n.width=eA(n.wch),n.MDW=nc):typeof n.wch=="number"&&(n.width=eA(n.wch),n.wpx=gw(n.width),n.MDW=nc),n.customWidth&&delete n.customWidth}var nve=96,jG=nve;function pw(n){return n*96/jG}function FG(n){return n*jG/96}function rve(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&(e[e.length]=st("numFmt",null,{numFmtId:r,formatCode:Jn(n[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=st("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function ive(n){var e=[];return e[e.length]=st("cellXfs",null),n.forEach(function(t){e[e.length]=st("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=st("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function VG(n,e){var t=[ai,st("styleSheet",null,{xmlns:Eg[0],"xmlns:vt":Ai.vt})],r;return n.SSF&&(r=rve(n.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=ive(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function sve(n,e){var t=n.read_shift(2),r=ps(n);return[t,r]}function ave(n,e,t){t||(t=Le(6+4*e.length)),t.write_shift(2,n),Pi(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function ove(n,e,t){var r={};r.sz=n.read_shift(2)/20;var i=Xye(n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=n.read_shift(1);a!=0&&(r.underline=a);var o=n.read_shift(1);o>0&&(r.family=o);var l=n.read_shift(1);switch(l>0&&(r.charset=l),n.l++,r.color=Kye(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=ps(n),r}function lve(n,e){e||(e=Le(153)),e.write_shift(2,n.sz*20),qye(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),dw(n.color,e);var r=0;return r=2,e.write_shift(1,r),Pi(n.name,e),e.length>e.l?e.slice(0,e.l):e}var cve=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],XT,uve=xl;function cD(n,e){e||(e=Le(84)),XT||(XT=_C(cve));var t=XT[n.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(dw({auto:1},e),dw({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function hve(n,e){var t=n.l+e,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}function BG(n,e,t){t||(t=Le(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Sm(n,e){return e||(e=Le(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var dve=xl;function fve(n,e){return e||(e=Le(51)),e.write_shift(1,0),Sm(null,e),Sm(null,e),Sm(null,e),Sm(null,e),Sm(null,e),e.length>e.l?e.slice(0,e.l):e}function gve(n,e){return e||(e=Le(52)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),hw(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function mve(n,e,t){var r=Le(2052);return r.write_shift(4,n),hw(e,r),hw(t,r),r.length>r.l?r.slice(0,r.l):r}function pve(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++t}),t!=0&&(We(n,615,So(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&We(n,44,ave(i,e[i]))}),We(n,616))}}function xve(n){var e=1;We(n,611,So(e)),We(n,43,lve({sz:12,color:{theme:1},name:"Calibri",family:2})),We(n,612)}function yve(n){var e=2;We(n,603,So(e)),We(n,45,cD({patternType:"none"})),We(n,45,cD({patternType:"gray125"})),We(n,604)}function _ve(n){var e=1;We(n,613,So(e)),We(n,46,fve()),We(n,614)}function vve(n){var e=1;We(n,626,So(e)),We(n,47,BG({numFmtId:0},65535)),We(n,627)}function wve(n,e){We(n,617,So(e.length)),e.forEach(function(t){We(n,47,BG(t,0))}),We(n,618)}function Eve(n){var e=1;We(n,619,So(e)),We(n,48,gve({xfId:0,name:"Normal"})),We(n,620)}function Sve(n){var e=0;We(n,505,So(e)),We(n,506)}function Tve(n){var e=0;We(n,508,mve(e,"TableStyleMedium9","PivotStyleMedium4")),We(n,509)}function bve(n,e){var t=Us();return We(t,278),pve(t,n.SSF),xve(t),yve(t),_ve(t),vve(t),wve(t,e.cellXfs),Eve(t),Sve(t),Tve(t),We(t,279),t.end()}function GG(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[ai];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Rve(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:ps(n)}}function Ave(n){var e=Le(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),Pi(n.name,e),e.slice(0,e.l)}function kve(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function Ive(n){var e=Le(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function Cve(n,e){var t=Le(8+2*e.length);return t.write_shift(4,n),Pi(e,t),t.slice(0,t.l)}function Pve(n){return n.l+=4,n.read_shift(4)!=0}function Nve(n,e){var t=Le(8);return t.write_shift(4,n),t.write_shift(4,1),t}function Mve(){var n=Us();return We(n,332),We(n,334,So(1)),We(n,335,Ave({name:"XLDAPR",version:12e4,flags:3496657072})),We(n,336),We(n,339,Cve(1,"XLDAPR")),We(n,52),We(n,35,So(514)),We(n,4096,So(0)),We(n,4097,Na(1)),We(n,36),We(n,53),We(n,340),We(n,337,Nve(1)),We(n,51,Ive([[1,0]])),We(n,338),We(n,333),n.end()}function zG(){var n=[ai];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function Lve(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=er(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var g0=1024;function UG(n,e){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[st("xml",null,{"xmlns:v":ca.v,"xmlns:o":ca.o,"xmlns:x":ca.x,"xmlns:mv":ca.mv}).replace(/\/>/,">"),st("o:shapelayout",st("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),st("v:shapetype",[st("v:stroke",null,{joinstyle:"miter"}),st("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];g0<n*1e3;)g0+=1e3;return e.forEach(function(s){var a=Ci(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?st("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=st("v:fill",l,o),h={on:"t",obscured:"t"};++g0,i=i.concat(["<v:shape"+p1({id:"_x0000_s"+g0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,st("v:shadow",null,h),st("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ki("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Ki("x:AutoFill","False"),Ki("x:Row",String(a.r)),Ki("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function $G(n){var e=[ai,st("comments",null,{xmlns:Eg[0]})],t=[];return e.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var s=Jn(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=t.indexOf(Jn(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Ki("t",Jn(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Ki("t",Jn(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Ove(n,e,t){var r=[ai,st("ThreadedComments",null,{xmlns:Ai.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),r.push(st("threadedComment",Ki("text",a.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function Dve(n){var e=[ai,st("personList",null,{xmlns:Ai.TCMNT,"xmlns:x":Eg[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){e.push(st("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function jve(n){var e={};e.iauthor=n.read_shift(4);var t=$d(n);return e.rfx=t.s,e.ref=er(t.s),n.l+=16,e}function Fve(n,e){return e==null&&(e=Le(36)),e.write_shift(4,n[1].iauthor),Tg(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Vve=ps;function Bve(n){return Pi(n.slice(0,54))}function Gve(n){var e=Us(),t=[];return We(e,628),We(e,630),n.forEach(function(r){r[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),We(e,632,Bve(i.a)))})}),We(e,631),We(e,633),n.forEach(function(r){r[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:Ci(r[0]),e:Ci(r[0])};We(e,635,Fve([s,i])),i.t&&i.t.length>0&&We(e,637,Uye(i)),We(e,636),delete i.iauthor})}),We(e,634),We(e,629),e.end()}function zve(n,e){e.FullPaths.forEach(function(t,r){if(r!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&nr.utils.cfb_add(n,i,e.FileIndex[r].content)}})}var WG=["xlsb","xlsm","xlam","biff8","xla"],Uve=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,l?c+=e.r:--c,i+(o?"":"$")+ms(h)+(l?"":"$")+Xi(c)}return function(i,s){return e=s,i.replace(n,t)}})(),NC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,MC=(function(){return function(e,t){return e.replace(NC,function(r,i,s,a,o,l){var c=RC(a)-(s?0:t.c),h=bC(l)-(o?0:t.r),g=h==0?"":o?h+1:"["+h+"]",m=c==0?"":s?c+1:"["+c+"]";return i+"R"+g+"C"+m})}})();function $ve(n,e){return n.replace(NC,function(t,r,i,s,a,o){return r+(i=="$"?i+s:ms(RC(s)+e.c))+(a=="$"?a+o:Xi(bC(o)+e.r))})}function Wve(n){return n.length!=1}function Zr(n){n.l+=1}function $u(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function HG(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return KG(n);t.biff==12&&(r=4)}var i=n.read_shift(r),s=n.read_shift(r),a=$u(n),o=$u(n);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function KG(n){var e=$u(n),t=$u(n),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function Hve(n,e,t){if(t.biff<8)return KG(n);var r=n.read_shift(t.biff==12?4:2),i=n.read_shift(t.biff==12?4:2),s=$u(n),a=$u(n);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function XG(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return Kve(n);var r=n.read_shift(t&&t.biff==12?4:2),i=$u(n);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function Kve(n){var e=$u(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function Xve(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function qve(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return Yve(n);var i=n.read_shift(r>=12?4:2),s=n.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function Yve(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:r}}function Zve(n,e,t){var r=(n[n.l++]&96)>>5,i=HG(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function Jve(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var a=HG(n,s,t);return[r,i,a]}function Qve(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function ewe(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,i]}function twe(n,e,t){var r=(n[n.l++]&96)>>5,i=Hve(n,e-1,t);return[r,i]}function nwe(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function uD(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function rwe(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(n.read_shift(t&&t.biff==2?1:2));return i}function iwe(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function swe(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function awe(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function owe(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function qG(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function lwe(n){return n.read_shift(2),qG(n)}function cwe(n){return n.read_shift(2),qG(n)}function uwe(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=XG(n,0,t);return[r,i]}function hwe(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=qve(n,0,t);return[r,i]}function dwe(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var s=XG(n,0,t);return[r,i,s]}function fwe(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[fEe[i],JG[i],r]}function gwe(n,e,t){var r=n[n.l++],i=n.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:mwe(n);return[i,(s[0]===0?JG:dEe)[s[1]]]}function mwe(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function pwe(n,e,t){n.l+=t&&t.biff==2?3:4}function xwe(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function ywe(n){return n.l++,gx[n.read_shift(1)]}function _we(n){return n.l++,n.read_shift(2)}function vwe(n){return n.l++,n.read_shift(1)!==0}function wwe(n){return n.l++,bg(n)}function Ewe(n,e,t){return n.l++,PG(n,e-1,t)}function Swe(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=d_e(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=gx[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=bg(n);break;case 2:t[1]=p_e(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Twe(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((t.biff==12?$d:__e)(n));return i}function bwe(n,e,t){var r=0,i=0;t.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=Swe(n,t.biff);return a}function Rwe(n,e,t){var r=n.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=n.read_shift(i);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function Awe(n,e,t){if(t.biff==5)return kwe(n);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),s=n.read_shift(4);return[r,i,s]}function kwe(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function Iwe(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function Cwe(n,e,t){var r=n.read_shift(1)>>>5&3,i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function Pwe(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function Nwe(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,i]}var Mwe=xl,Lwe=xl,Owe=xl;function mx(n,e,t){return n.l+=2,[Xve(n)]}function LC(n){return n.l+=6,[]}var Dwe=mx,jwe=LC,Fwe=LC,Vwe=mx;function YG(n){return n.l+=2,[IG(n),n.read_shift(2)&1]}var Bwe=mx,Gwe=YG,zwe=LC,Uwe=mx,$we=mx,Wwe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Hwe(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),s=n.read_shift(2),a=Wwe[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:r,c:i,C:s}}function Kwe(n){return n.l+=2,[n.read_shift(4)]}function Xwe(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function qwe(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function Ywe(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function Zwe(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function Jwe(n){return n.l+=4,[0,0]}var hD={1:{n:"PtgExp",f:xwe},2:{n:"PtgTbl",f:Owe},3:{n:"PtgAdd",f:Zr},4:{n:"PtgSub",f:Zr},5:{n:"PtgMul",f:Zr},6:{n:"PtgDiv",f:Zr},7:{n:"PtgPower",f:Zr},8:{n:"PtgConcat",f:Zr},9:{n:"PtgLt",f:Zr},10:{n:"PtgLe",f:Zr},11:{n:"PtgEq",f:Zr},12:{n:"PtgGe",f:Zr},13:{n:"PtgGt",f:Zr},14:{n:"PtgNe",f:Zr},15:{n:"PtgIsect",f:Zr},16:{n:"PtgUnion",f:Zr},17:{n:"PtgRange",f:Zr},18:{n:"PtgUplus",f:Zr},19:{n:"PtgUminus",f:Zr},20:{n:"PtgPercent",f:Zr},21:{n:"PtgParen",f:Zr},22:{n:"PtgMissArg",f:Zr},23:{n:"PtgStr",f:Ewe},26:{n:"PtgSheet",f:Xwe},27:{n:"PtgEndSheet",f:qwe},28:{n:"PtgErr",f:ywe},29:{n:"PtgBool",f:vwe},30:{n:"PtgInt",f:_we},31:{n:"PtgNum",f:wwe},32:{n:"PtgArray",f:nwe},33:{n:"PtgFunc",f:fwe},34:{n:"PtgFuncVar",f:gwe},35:{n:"PtgName",f:Rwe},36:{n:"PtgRef",f:uwe},37:{n:"PtgArea",f:Zve},38:{n:"PtgMemArea",f:Iwe},39:{n:"PtgMemErr",f:Mwe},40:{n:"PtgMemNoMem",f:Lwe},41:{n:"PtgMemFunc",f:Cwe},42:{n:"PtgRefErr",f:Pwe},43:{n:"PtgAreaErr",f:Qve},44:{n:"PtgRefN",f:hwe},45:{n:"PtgAreaN",f:twe},46:{n:"PtgMemAreaN",f:Ywe},47:{n:"PtgMemNoMemN",f:Zwe},57:{n:"PtgNameX",f:Awe},58:{n:"PtgRef3d",f:dwe},59:{n:"PtgArea3d",f:Jve},60:{n:"PtgRefErr3d",f:Nwe},61:{n:"PtgAreaErr3d",f:ewe},255:{}},Qwe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},eEe={1:{n:"PtgElfLel",f:YG},2:{n:"PtgElfRw",f:Uwe},3:{n:"PtgElfCol",f:Dwe},6:{n:"PtgElfRwV",f:$we},7:{n:"PtgElfColV",f:Vwe},10:{n:"PtgElfRadical",f:Bwe},11:{n:"PtgElfRadicalS",f:zwe},13:{n:"PtgElfColS",f:jwe},15:{n:"PtgElfColSV",f:Fwe},16:{n:"PtgElfRadicalLel",f:Gwe},25:{n:"PtgList",f:Hwe},29:{n:"PtgSxName",f:Kwe},255:{}},tEe={0:{n:"PtgAttrNoop",f:Jwe},1:{n:"PtgAttrSemi",f:owe},2:{n:"PtgAttrIf",f:swe},4:{n:"PtgAttrChoose",f:rwe},8:{n:"PtgAttrGoto",f:iwe},16:{n:"PtgAttrSum",f:pwe},32:{n:"PtgAttrBaxcel",f:uD},33:{n:"PtgAttrBaxcel",f:uD},64:{n:"PtgAttrSpace",f:lwe},65:{n:"PtgAttrSpaceSemi",f:cwe},128:{n:"PtgAttrIfError",f:awe},255:{}};function nEe(n,e,t,r){if(r.biff<8)return xl(n,e);for(var i=n.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=bwe(n,0,r),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=Twe(n,t[a][1],r),s.push(t[a][2]);break;case"PtgExp":r&&r.biff==12&&(t[a][1][1]=n.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-n.l,e!==0&&s.push(xl(n,e)),s}function rEe(n,e,t){for(var r=n.l+e,i,s,a=[];r!=n.l;)e=r-n.l,s=n[n.l],i=hD[s]||hD[Qwe[s]],(s===24||s===25)&&(i=(s===24?eEe:tEe)[n[n.l+1]]),!i||!i.f?xl(n,e):a.push([i.n,i.f(n,e,t)]);return a}function iEe(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],i=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var sEe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function aEe(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function ZG(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function dD(n,e,t){var r=ZG(n,e,t);return r=="#REF"?r:aEe(r,t)}function og(n,e,t,r,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,h,g=0,m=0,x,y="";if(!n[0]||!n[0][0])return"";for(var _=-1,w="",T=0,b=n[0].length;T<b;++T){var R=n[0][T];switch(R[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),_>=0){switch(n[0][_][1][0]){case 0:w=Fr(" ",n[0][_][1][1]);break;case 1:w=Fr("\r",n[0][_][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}c=c+w,_=-1}o.push(c+sEe[R[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=pp(R[1][1],a,i),o.push(xp(h,s));break;case"PtgRefN":h=t?pp(R[1][1],t,i):R[1][1],o.push(xp(h,s));break;case"PtgRef3d":g=R[1][1],h=pp(R[1][2],a,i),y=dD(r,g,i),o.push(y+"!"+xp(h,s));break;case"PtgFunc":case"PtgFuncVar":var M=R[1][0],D=R[1][1];M||(M=0),M&=127;var B=M==0?[]:o.slice(-M);o.length-=M,D==="User"&&(D=B.shift()),o.push(D+"("+B.join(",")+")");break;case"PtgBool":o.push(R[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(R[1]);break;case"PtgNum":o.push(String(R[1]));break;case"PtgStr":o.push('"'+R[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(R[1]);break;case"PtgAreaN":x=YO(R[1][1],t?{s:t}:a,i),o.push(HT(x,i));break;case"PtgArea":x=YO(R[1][1],a,i),o.push(HT(x,i));break;case"PtgArea3d":g=R[1][1],x=R[1][2],y=dD(r,g,i),o.push(y+"!"+HT(x,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=R[1][2];var k=(r.names||[])[m-1]||(r[0]||[])[m],A=k?k.Name:"SH33TJSNAME"+String(m);A&&A.slice(0,6)=="_xlfn."&&!i.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var C=R[1][1];m=R[1][2];var O;if(i.biff<=5)C<0&&(C=-C),r[C]&&(O=r[C][m]);else{var P="";if(((r[C]||[])[0]||[])[0]==14849||(((r[C]||[])[0]||[])[0]==1025?r[C][m]&&r[C][m].itab>0&&(P=r.SheetNames[r[C][m].itab-1]+"!"):P=r.SheetNames[m-1]+"!"),r[C]&&r[C][m])P+=r[C][m].Name;else if(r[0]&&r[0][m])P+=r[0][m].Name;else{var z=(ZG(r,C,i)||"").split(";;");z[m-1]?P=z[m-1]:P+="SH33TJSERRX"}o.push(P);break}O||(O={Name:"SH33TJSERRY"}),o.push(O.Name);break;case"PtgParen":var F="(",xe=")";if(_>=0){switch(w="",n[0][_][1][0]){case 2:F=Fr(" ",n[0][_][1][1])+F;break;case 3:F=Fr("\r",n[0][_][1][1])+F;break;case 4:xe=Fr(" ",n[0][_][1][1])+xe;break;case 5:xe=Fr("\r",n[0][_][1][1])+xe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}_=-1}o.push(F+o.pop()+xe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:R[1][1],r:R[1][0]};var Ce={c:t.c,r:t.r};if(r.sharedf[er(h)]){var Ge=r.sharedf[er(h)];o.push(og(Ge,a,Ce,r,i))}else{var Ne=!1;for(l=0;l!=r.arrayf.length;++l)if(c=r.arrayf[l],!(h.c<c[0].s.c||h.c>c[0].e.c)&&!(h.r<c[0].s.r||h.r>c[0].e.r)){o.push(og(c[1],a,Ce,r,i)),Ne=!0;break}Ne||o.push(R[1])}break;case"PtgArray":o.push("{"+iEe(R[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+R[1].idx+"[#"+R[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(R));default:throw new Error("Unrecognized Formula Token: "+String(R))}var ue=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&ue.indexOf(n[0][T][0])==-1){R=n[0][_];var ke=!0;switch(R[1][0]){case 4:ke=!1;case 0:w=Fr(" ",R[1][1]);break;case 5:ke=!1;case 1:w=Fr("\r",R[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+R[1][0])}o.push((ke?w:"")+o.pop()+(ke?"":w)),_=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function oEe(n){if(n==null){var e=Le(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return bd(n);return bd(0)}function lEe(n,e,t,r,i){var s=Rd(e,t,i),a=oEe(n.v),o=Le(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=Le(n.bf.length),h=0;h<n.bf.length;++h)c[h]=n.bf[h];var g=Hi([s,a,o,c]);return g}function KE(n,e,t){var r=n.read_shift(4),i=rEe(n,r,t),s=n.read_shift(4),a=s>0?nEe(n,s,i,t):null;return[i,a]}var cEe=KE,XE=KE,uEe=KE,hEe=KE,dEe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},JG={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},fEe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function gEe(n){var e="of:="+n.replace(NC,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function mEe(n){return n.replace(/\./,"!")}var yp=typeof Map<"u";function OC(n,e,t){var r=0,i=n.length;if(t){if(yp?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=yp?t.get(e):t[e];r<s.length;++r)if(n[s[r]].t===e)return n.Count++,s[r]}}else for(;r<i;++r)if(n[r].t===e)return n.Count++,r;return n[i]={t:e},n.Count++,n.Unique++,t&&(yp?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function qE(n,e){var t={min:n+1,max:n+1},r=-1;return e.MDW&&(nc=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=mw(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=eA(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function QG(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function Qu(n,e,t){var r=t.revssf[e.z!=null?e.z:"General"],i=60,s=n.length;if(r==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){XB(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=r=i;break}}for(i=0;i!=s;++i)if(n[i].numFmtId===r)return i;return n[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function pEe(n,e,t){if(n&&n["!ref"]){var r=mr(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function xEe(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+ii(n[t])+'"/>';return e+"</mergeCells>"}function yEe(n,e,t,r,i){var s=!1,a={},o=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=m1(Jn(l))}if(n&&n["!outline"]){var c={summaryBelow:1,summaryRight:1};n["!outline"].above&&(c.summaryBelow=0),n["!outline"].left&&(c.summaryRight=0),o=(o||"")+st("outlinePr",null,c)}!s&&!o||(i[i.length]=st("sheetPr",o,a))}var _Ee=["objects","scenarios","selectLockedCells","selectUnlockedCells"],vEe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function wEe(n){var e={sheet:1};return _Ee.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),vEe.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=DG(n.password).toString(16).toUpperCase()),st("sheetProtection",null,e)}function EEe(n){return QG(n),st("pageMargins",null,n)}function SEe(n,e){for(var t=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(t[t.length]=st("col",null,qE(i,r)));return t[t.length]="</cols>",t.join("")}function TEe(n,e,t,r){var i=typeof n.ref=="string"?n.ref:ii(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=ya(i);a.s.r==a.e.r&&(a.e.r=ya(e["!ref"]).e.r,i=ii(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+t.SheetNames[r]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),st("autoFilter",null,{ref:i})}function bEe(n,e,t,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),st("sheetViews",st("sheetView",null,i),{})}function REe(n,e,t,r){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var i="",s=n.t,a=n.v;if(n.t!=="z")switch(n.t){case"b":i=n.v?"1":"0";break;case"n":i=""+n.v;break;case"e":i=gx[n.v];break;case"d":r&&r.cellDates?i=Rs(n.v,-1).toISOString():(n=qs(n),n.t="n",i=""+(n.v=Xs(Rs(n.v)))),typeof n.z>"u"&&(n.z=Br[14]);break;default:i=n.v;break}var o=Ki("v",Jn(i)),l={r:e},c=Qu(r.cellXfs,n,r);switch(c!==0&&(l.s=c),n.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=Ki("v",""+OC(r.Strings,n.v,r.revStrings)),l.t="s";break}l.t="str";break}if(n.t!=s&&(n.t=s,n.v=a),typeof n.f=="string"&&n.f){var h=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;o=st("f",Jn(n.f),h)+(n.v!=null?o:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(l.cm=1),st("c",o,l)}function AEe(n,e,t,r){var i=[],s=[],a=mr(n["!ref"]),o="",l,c="",h=[],g=0,m=0,x=n["!rows"],y=Array.isArray(n),_={r:c},w,T=-1;for(m=a.s.c;m<=a.e.c;++m)h[m]=ms(m);for(g=a.s.r;g<=a.e.r;++g){for(s=[],c=Xi(g),m=a.s.c;m<=a.e.c;++m){l=h[m]+c;var b=y?(n[g]||[])[m]:n[l];b!==void 0&&(o=REe(b,l,n,e))!=null&&s.push(o)}(s.length>0||x&&x[g])&&(_={r:c},x&&x[g]&&(w=x[g],w.hidden&&(_.hidden=1),T=-1,w.hpx?T=pw(w.hpx):w.hpt&&(T=w.hpt),T>-1&&(_.ht=T,_.customHeight=1),w.level&&(_.outlineLevel=w.level)),i[i.length]=st("row",s.join(""),_))}if(x)for(;g<x.length;++g)x&&x[g]&&(_={r:g+1},w=x[g],w.hidden&&(_.hidden=1),T=-1,w.hpx?T=pw(w.hpx):w.hpt&&(T=w.hpt),T>-1&&(_.ht=T,_.customHeight=1),w.level&&(_.outlineLevel=w.level),i[i.length]=st("row","",_));return i.join("")}function ez(n,e,t,r){var i=[ai,st("worksheet",null,{xmlns:Eg[0],"xmlns:r":Ai.r})],s=t.SheetNames[n],a=0,o="",l=t.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",h=mr(c);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),c=ii(h)}r||(r={}),l["!comments"]=[];var g=[];yEe(l,t,n,e,i),i[i.length]=st("dimension",null,{ref:c}),i[i.length]=bEe(l,e,n,t),e.sheetFormat&&(i[i.length]=st("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=SEe(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=AEe(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=wEe(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=TEe(l["!autofilter"],l,t,n)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=xEe(l["!merges"]));var m=-1,x,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(_){_[1].Target&&(x={ref:_[0]},_[1].Target.charAt(0)!="#"&&(y=Xn(r,-1,Jn(_[1].Target).replace(/#.*$/,""),Nn.HLINK),x["r:id"]="rId"+y),(m=_[1].Target.indexOf("#"))>-1&&(x.location=Jn(_[1].Target.slice(m+1))),_[1].Tooltip&&(x.tooltip=Jn(_[1].Tooltip)),i[i.length]=st("hyperlink",null,x))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=EEe(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Ki("ignoredErrors",st("ignoredError",null,{numberStoredAsText:1,sqref:c}))),g.length>0&&(y=Xn(r,-1,"../drawings/drawing"+(n+1)+".xml",Nn.DRAW),i[i.length]=st("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=g),l["!comments"].length>0&&(y=Xn(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Nn.VML),i[i.length]=st("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function kEe(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function IEe(n,e,t){var r=Le(145),i=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var s=320;i.hpx?s=pw(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:n,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var g=-1,m=-1,x=h<<10;x<h+1<<10;++x){c.c=x;var y=Array.isArray(t)?(t[c.r]||[])[c.c]:t[er(c)];y&&(g<0&&(g=x),m=x)}g<0||(++o,r.write_shift(4,g),r.write_shift(4,m))}var _=r.l;return r.l=l,r.write_shift(4,o),r.l=_,r.length>r.l?r.slice(0,r.l):r}function CEe(n,e,t,r){var i=IEe(r,t,e);(i.length>17||(e["!rows"]||[])[r])&&We(n,0,i)}var PEe=$d,NEe=Tg;function MEe(){}function LEe(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=$ye(n),t}function OEe(n,e,t){t==null&&(t=Le(84+4*n.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var i=1;i<3;++i)t.write_shift(1,0);return dw({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),mG(n,t),t.slice(0,t.l)}function DEe(n){var e=qa(n);return[e]}function jEe(n,e,t){return t==null&&(t=Le(8)),Gd(e,t)}function FEe(n){var e=zd(n);return[e]}function VEe(n,e,t){return t==null&&(t=Le(4)),Ud(e,t)}function BEe(n){var e=qa(n),t=n.read_shift(1);return[e,t,"b"]}function GEe(n,e,t){return t==null&&(t=Le(9)),Gd(e,t),t.write_shift(1,n.v?1:0),t}function zEe(n){var e=zd(n),t=n.read_shift(1);return[e,t,"b"]}function UEe(n,e,t){return t==null&&(t=Le(5)),Ud(e,t),t.write_shift(1,n.v?1:0),t}function $Ee(n){var e=qa(n),t=n.read_shift(1);return[e,t,"e"]}function WEe(n,e,t){return t==null&&(t=Le(9)),Gd(e,t),t.write_shift(1,n.v),t}function HEe(n){var e=zd(n),t=n.read_shift(1);return[e,t,"e"]}function KEe(n,e,t){return t==null&&(t=Le(8)),Ud(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function XEe(n){var e=qa(n),t=n.read_shift(4);return[e,t,"s"]}function qEe(n,e,t){return t==null&&(t=Le(12)),Gd(e,t),t.write_shift(4,e.v),t}function YEe(n){var e=zd(n),t=n.read_shift(4);return[e,t,"s"]}function ZEe(n,e,t){return t==null&&(t=Le(8)),Ud(e,t),t.write_shift(4,e.v),t}function JEe(n){var e=qa(n),t=bg(n);return[e,t,"n"]}function QEe(n,e,t){return t==null&&(t=Le(16)),Gd(e,t),bd(n.v,t),t}function e2e(n){var e=zd(n),t=bg(n);return[e,t,"n"]}function t2e(n,e,t){return t==null&&(t=Le(12)),Ud(e,t),bd(n.v,t),t}function n2e(n){var e=qa(n),t=pG(n);return[e,t,"n"]}function r2e(n,e,t){return t==null&&(t=Le(12)),Gd(e,t),xG(n.v,t),t}function i2e(n){var e=zd(n),t=pG(n);return[e,t,"n"]}function s2e(n,e,t){return t==null&&(t=Le(8)),Ud(e,t),xG(n.v,t),t}function a2e(n){var e=qa(n),t=AC(n);return[e,t,"is"]}function o2e(n){var e=qa(n),t=ps(n);return[e,t,"str"]}function l2e(n,e,t){return t==null&&(t=Le(12+4*n.v.length)),Gd(e,t),Pi(n.v,t),t.length>t.l?t.slice(0,t.l):t}function c2e(n){var e=zd(n),t=ps(n);return[e,t,"str"]}function u2e(n,e,t){return t==null&&(t=Le(8+4*n.v.length)),Ud(e,t),Pi(n.v,t),t.length>t.l?t.slice(0,t.l):t}function h2e(n,e,t){var r=n.l+e,i=qa(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"b"];if(t.cellFormula){n.l+=2;var o=XE(n,r-n.l,t);a[3]=og(o,null,i,t.supbooks,t)}else n.l=r;return a}function d2e(n,e,t){var r=n.l+e,i=qa(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"e"];if(t.cellFormula){n.l+=2;var o=XE(n,r-n.l,t);a[3]=og(o,null,i,t.supbooks,t)}else n.l=r;return a}function f2e(n,e,t){var r=n.l+e,i=qa(n);i.r=t["!row"];var s=bg(n),a=[i,s,"n"];if(t.cellFormula){n.l+=2;var o=XE(n,r-n.l,t);a[3]=og(o,null,i,t.supbooks,t)}else n.l=r;return a}function g2e(n,e,t){var r=n.l+e,i=qa(n);i.r=t["!row"];var s=ps(n),a=[i,s,"str"];if(t.cellFormula){n.l+=2;var o=XE(n,r-n.l,t);a[3]=og(o,null,i,t.supbooks,t)}else n.l=r;return a}var m2e=$d,p2e=Tg;function x2e(n,e){return e==null&&(e=Le(4)),e.write_shift(4,n),e}function y2e(n,e){var t=n.l+e,r=$d(n),i=kC(n),s=ps(n),a=ps(n),o=ps(n);n.l=t;var l={rfx:r,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function _2e(n,e){var t=Le(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));Tg({s:Ci(n[0]),e:Ci(n[0])},t),IC("rId"+e,t);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return Pi(i||"",t),Pi(n[1].Tooltip||"",t),Pi("",t),t.slice(0,t.l)}function v2e(){}function w2e(n,e,t){var r=n.l+e,i=yG(n),s=n.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=cEe(n,r-n.l,t);a[1]=o}else n.l=r;return a}function E2e(n,e,t){var r=n.l+e,i=$d(n),s=[i];if(t.cellFormula){var a=hEe(n,r-n.l,t);s[1]=a,n.l=r}else n.l=r;return s}function S2e(n,e,t){t==null&&(t=Le(18));var r=qE(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var tz=["left","right","top","bottom","header","footer"];function T2e(n){var e={};return tz.forEach(function(t){e[t]=bg(n)}),e}function b2e(n,e){return e==null&&(e=Le(48)),QG(n),tz.forEach(function(t){bd(n[t],e)}),e}function R2e(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function A2e(n,e,t){t==null&&(t=Le(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function k2e(n){var e=Le(24);return e.write_shift(4,4),e.write_shift(4,1),Tg(n,e),e}function I2e(n,e){return e==null&&(e=Le(66)),e.write_shift(2,n.password?DG(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function C2e(){}function P2e(){}function N2e(n,e,t,r,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=qs(e),e.z=e.z||Br[14],e.v=Xs(Rs(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:r};switch(l.s=Qu(i.cellXfs,e,i),e.l&&s["!links"].push([er(l),e.l]),e.c&&s["!comments"].push([er(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=OC(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?We(n,18,ZEe(e,l)):We(n,7,qEe(e,l))):(l.t="str",a?We(n,17,u2e(e,l)):We(n,6,l2e(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?We(n,13,s2e(e,l)):We(n,2,r2e(e,l)):a?We(n,16,t2e(e,l)):We(n,5,QEe(e,l)),!0;case"b":return l.t="b",a?We(n,15,UEe(e,l)):We(n,4,GEe(e,l)),!0;case"e":return l.t="e",a?We(n,14,KEe(e,l)):We(n,3,WEe(e,l)),!0}return a?We(n,12,VEe(e,l)):We(n,1,jEe(e,l)),!0}function M2e(n,e,t,r){var i=mr(e["!ref"]||"A1"),s,a="",o=[];We(n,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=c;++h){a=Xi(h),CEe(n,e,i,h);var g=!1;if(h<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){h===i.s.r&&(o[m]=ms(m)),s=o[m]+a;var x=l?(e[h]||[])[m]:e[s];if(!x){g=!1;continue}g=N2e(n,x,h,m,r,e,g)}}We(n,146)}function L2e(n,e){!e||!e["!merges"]||(We(n,177,x2e(e["!merges"].length)),e["!merges"].forEach(function(t){We(n,176,p2e(t))}),We(n,178))}function O2e(n,e){!e||!e["!cols"]||(We(n,390),e["!cols"].forEach(function(t,r){t&&We(n,60,S2e(r,t))}),We(n,391))}function D2e(n,e){!e||!e["!ref"]||(We(n,648),We(n,649,k2e(mr(e["!ref"]))),We(n,650))}function j2e(n,e,t){e["!links"].forEach(function(r){if(r[1].Target){var i=Xn(t,-1,r[1].Target.replace(/#.*$/,""),Nn.HLINK);We(n,494,_2e(r,i))}}),delete e["!links"]}function F2e(n,e,t,r){if(e["!comments"].length>0){var i=Xn(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Nn.VML);We(n,551,IC("rId"+i)),e["!legacy"]=i}}function V2e(n,e,t,r){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:ii(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=ya(s);o.s.r==o.e.r&&(o.e.r=ya(e["!ref"]).e.r,s=ii(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+t.SheetNames[r]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+s}),We(n,161,Tg(mr(s))),We(n,162)}}function B2e(n,e,t){We(n,133),We(n,137,A2e(e,t)),We(n,138),We(n,134)}function G2e(n,e){e["!protect"]&&We(n,535,I2e(e["!protect"]))}function z2e(n,e,t,r){var i=Us(),s=t.SheetNames[n],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[n].CodeName||o)}catch{}var l=mr(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],We(i,129),(t.vbaraw||a["!outline"])&&We(i,147,OEe(o,a["!outline"])),We(i,148,NEe(l)),B2e(i,a,t.Workbook),O2e(i,a),M2e(i,a,n,e),G2e(i,a),V2e(i,a,t,n),L2e(i,a),j2e(i,a,r),a["!margins"]&&We(i,476,b2e(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&D2e(i,a),F2e(i,a,n,r),We(i,130),i.end()}function U2e(n,e){n.l+=10;var t=ps(n);return{name:t}}var $2e=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function W2e(n){return!n.Workbook||!n.Workbook.WBProps?"false":Eye(n.Workbook.WBProps.date1904)?"true":"false"}var H2e="][*?/\\".split("");function nz(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return H2e.forEach(function(r){if(n.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function K2e(n,e,t){n.forEach(function(r,i){nz(r);for(var s=0;s<i;++s)if(r==n[s])throw new Error("Duplicate Sheet Name: "+r);if(t){var a=e&&e[i]&&e[i].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function X2e(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];K2e(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)pEe(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function rz(n){var e=[ai];e[e.length]=st("workbook",null,{xmlns:Eg[0],"xmlns:r":Ai.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&($2e.forEach(function(o){n.Workbook.WBProps[o[0]]!=null&&n.Workbook.WBProps[o[0]]!=o[1]&&(r[o[0]]=n.Workbook.WBProps[o[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=st("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==n.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var a={name:Jn(n.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=st("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=st("definedName",Jn(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function q2e(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=QR(n),t.name=ps(n),t}function Y2e(n,e){return e||(e=Le(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),IC(n.strRelID,e),Pi(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Z2e(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=e>8?ps(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function J2e(n,e){e||(e=Le(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),mG(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Q2e(n,e,t){var r=n.l+e;n.l+=4,n.l+=1;var i=n.read_shift(4),s=Wye(n),a=uEe(n,0,t),o=kC(n);n.l=r;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function eSe(n,e){We(n,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};We(n,156,Y2e(i))}We(n,144)}function tSe(n,e){e||(e=Le(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return Pi("SheetJS",e),Pi(iw.version,e),Pi(iw.version,e),Pi("7262",e),e.length>e.l?e.slice(0,e.l):e}function nSe(n,e){e||(e=Le(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function rSe(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,i=-1,s=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&i==-1?i=r:t[r].Hidden==1&&s==-1&&(s=r);s>i||(We(n,135),We(n,158,nSe(i)),We(n,136))}}function iSe(n,e){var t=Us();return We(t,131),We(t,128,tSe()),We(t,153,J2e(n.Workbook&&n.Workbook.WBProps||null)),rSe(t,n),eSe(t,n),We(t,132),t.end()}function sSe(n,e,t){return(e.slice(-4)===".bin"?iSe:rz)(n)}function aSe(n,e,t,r,i){return(e.slice(-4)===".bin"?z2e:ez)(n,t,r,i)}function oSe(n,e,t){return(e.slice(-4)===".bin"?bve:VG)(n,t)}function lSe(n,e,t){return(e.slice(-4)===".bin"?J_e:OG)(n,t)}function cSe(n,e,t){return(e.slice(-4)===".bin"?Gve:$G)(n)}function uSe(n){return(n.slice(-4)===".bin"?Mve:zG)()}function hSe(n,e){var t=[];return n.Props&&t.push(o_e(n.Props,e)),n.Custprops&&t.push(l_e(n.Props,n.Custprops)),t.join("")}function dSe(){return""}function fSe(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var s=[];s.push(st("NumberFormat",null,{"ss:Format":Jn(Br[r.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push(st("Style",s.join(""),a))}),st("Styles",t.join(""))}function iz(n){return st("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+MC(n.Ref,{r:0,c:0})})}function gSe(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(iz(i)))}return st("Names",t.join(""))}function mSe(n,e,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(iz(o)))}return s.join("")}function pSe(n,e,t,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(st("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(st("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(st("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)i.push(st("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push(Ki("ProtectContents","True")),n["!protect"].objects&&i.push(Ki("ProtectObjects","True")),n["!protect"].scenarios&&i.push(Ki("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push(Ki("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push(Ki("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){n["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":st("WorksheetOptions",i.join(""),{xmlns:ca.x})}function xSe(n){return n.map(function(e){var t=wye(e.t||""),r=st("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return st("Comment",r,{"ss:Author":e.a})}).join("")}function ySe(n,e,t,r,i,s,a){if(!n||n.v==null&&n.f==null)return"";var o={};if(n.f&&(o["ss:Formula"]="="+Jn(MC(n.f,a))),n.F&&n.F.slice(0,e.length)==e){var l=Ci(n.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(n.l&&n.l.Target&&(o["ss:HRef"]=Jn(n.l.Target),n.l.Tooltip&&(o["x:HRefScreenTip"]=Jn(n.l.Tooltip))),t["!merges"])for(var c=t["!merges"],h=0;h!=c.length;++h)c[h].s.c!=a.c||c[h].s.r!=a.r||(c[h].e.c>c[h].s.c&&(o["ss:MergeAcross"]=c[h].e.c-c[h].s.c),c[h].e.r>c[h].s.r&&(o["ss:MergeDown"]=c[h].e.r-c[h].s.r));var g="",m="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":g="Number",m=String(n.v);break;case"b":g="Boolean",m=n.v?"1":"0";break;case"e":g="Error",m=gx[n.v];break;case"d":g="DateTime",m=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Br[14]);break;case"s":g="String",m=vye(n.v||"");break}var x=Qu(r.cellXfs,n,r);o["ss:StyleID"]="s"+(21+x),o["ss:Index"]=a.c+1;var y=n.v!=null?m:"",_=n.t=="z"?"":'<Data ss:Type="'+g+'">'+y+"</Data>";return(n.c||[]).length>0&&(_+=xSe(n.c)),st("Cell",_,o)}function _Se(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=FG(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function vSe(n,e,t,r){if(!n["!ref"])return"";var i=mr(n["!ref"]),s=n["!merges"]||[],a=0,o=[];n["!cols"]&&n["!cols"].forEach(function(w,T){PC(w);var b=!!w.width,R=qE(T,w),M={"ss:Index":T+1};b&&(M["ss:Width"]=gw(R.width)),w.hidden&&(M["ss:Hidden"]="1"),o.push(st("Column",null,M))});for(var l=Array.isArray(n),c=i.s.r;c<=i.e.r;++c){for(var h=[_Se(c,(n["!rows"]||[])[c])],g=i.s.c;g<=i.e.c;++g){var m=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>g)&&!(s[a].s.r>c)&&!(s[a].e.c<g)&&!(s[a].e.r<c)){(s[a].s.c!=g||s[a].s.r!=c)&&(m=!0);break}if(!m){var x={r:c,c:g},y=er(x),_=l?(n[c]||[])[g]:n[y];h.push(ySe(_,y,n,e,t,r,x))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function wSe(n,e,t){var r=[],i=t.SheetNames[n],s=t.Sheets[i],a=s?mSe(s,e,n,t):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=s?vSe(s,e,n,t):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(pSe(s,e,n,t)),r.join("")}function ESe(n,e){e||(e={}),n.SSF||(n.SSF=qs(Br)),n.SSF&&($E(),UE(n.SSF),e.revssf=WE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],Qu(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(hSe(n,e)),t.push(dSe()),t.push(""),t.push("");for(var r=0;r<n.SheetNames.length;++r)t.push(st("Worksheet",wSe(r,e,n),{"ss:Name":Jn(n.SheetNames[r])}));return t[2]=fSe(n,e),t[3]=gSe(n),ai+st("Workbook",t.join(""),{xmlns:ca.ss,"xmlns:o":ca.o,"xmlns:x":ca.x,"xmlns:ss":ca.ss,"xmlns:dt":ca.dt,"xmlns:html":ca.html})}var qT={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function SSe(n,e){var t=[],r=[],i=[],s=0,a,o=VO(JO,"n"),l=VO(QO,"n");if(n.Props)for(a=qi(n.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Props[a[s]]]);if(n.Custprops)for(a=qi(n.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)kG.indexOf(i[s][0])>-1||bG.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);r.length&&nr.utils.cfb_add(e,"/SummaryInformation",iD(r,qT.SI,l,QO)),(t.length||c.length)&&nr.utils.cfb_add(e,"/DocumentSummaryInformation",iD(t,qT.DSI,o,JO,c.length?c:null,qT.UDI))}function TSe(n,e){var t=e||{},r=nr.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return nr.utils.cfb_add(r,i,sz(n,t)),t.biff==8&&(n.Props||n.Custprops)&&SSe(n,r),t.biff==8&&n.vbaraw&&zve(r,nr.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var bSe={0:{f:kEe},1:{f:DEe},2:{f:n2e},3:{f:$Ee},4:{f:BEe},5:{f:JEe},6:{f:o2e},7:{f:XEe},8:{f:g2e},9:{f:f2e},10:{f:h2e},11:{f:d2e},12:{f:FEe},13:{f:i2e},14:{f:HEe},15:{f:zEe},16:{f:e2e},17:{f:c2e},18:{f:YEe},19:{f:AC},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Q2e},40:{},42:{},43:{f:ove},44:{f:sve},45:{f:uve},46:{f:dve},47:{f:hve},48:{},49:{f:Fye},50:{},51:{f:kve},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:V_e},62:{f:a2e},63:{f:Lve},64:{f:C2e},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:xl,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:R2e},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:LEe},148:{f:PEe,p:16},151:{f:v2e},152:{},153:{f:Z2e},154:{},155:{},156:{f:q2e},157:{},158:{},159:{T:1,f:q_e},160:{T:-1},161:{T:1,f:$d},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:m2e},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Rve},336:{T:-1},337:{f:Pve,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:QR},357:{},358:{},359:{},360:{T:1},361:{},362:{f:M_e},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:w2e},427:{f:E2e},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:T2e},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:MEe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:y2e},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:QR},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Vve},633:{T:1},634:{T:-1},635:{T:1,f:jve},636:{T:-1},637:{f:zye},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:U2e},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:P2e},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function at(n,e,t,r){var i=e;if(!isNaN(i)){var s=r||(t||[]).length||0,a=n.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&TC(t)&&n.push(t)}}function RSe(n,e,t,r){var i=(t||[]).length||0;if(i<=8224)return at(n,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var h=n.next(4);for(h.write_shift(2,s),h.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c;l<i;){for(h=n.next(4),h.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;h.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c}}}function px(n,e,t){return n||(n=Le(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function ASe(n,e,t,r){var i=Le(9);return px(i,n,e),CG(t,r||"b",i),i}function kSe(n,e,t){var r=Le(8+2*t.length);return px(r,n,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function ISe(n,e,t,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Xs(Rs(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?at(n,2,U_e(t,r,i)):at(n,3,z_e(t,r,i));return;case"b":case"e":at(n,5,ASe(t,r,e.v,e.t));return;case"s":case"str":at(n,4,kSe(t,r,(e.v||"").slice(0,255)));return}at(n,1,px(null,t,r))}function CSe(n,e,t,r){var i=Array.isArray(e),s=mr(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=ii(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Xi(c);for(var h=s.s.c;h<=s.e.c;++h){c===s.s.r&&(l[h]=ms(h)),a=l[h]+o;var g=i?(e[c]||[])[h]:e[a];g&&ISe(n,g,c,h)}}}function PSe(n,e){for(var t=e||{},r=Us(),i=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return at(r,t.biff==4?1033:t.biff==3?521:9,CC(n,16,t)),CSe(r,n.Sheets[n.SheetNames[i]],i,t),at(r,10),r.end()}function NSe(n,e,t){at(n,49,b_e({sz:12,name:"Arial"},t))}function MSe(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&at(n,1054,k_e(i,e[i],t))})}function LSe(n,e){var t=Le(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),at(n,2151,t),t=Le(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),MG(mr(e["!ref"]||"A1"),t),t.write_shift(4,4),at(n,2152,t)}function OSe(n,e){for(var t=0;t<16;++t)at(n,224,aD({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){at(n,224,aD(r,0,e))})}function DSe(n,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];at(n,440,D_e(r)),r[1].Tooltip&&at(n,2048,j_e(r))}delete e["!links"]}function jSe(n,e){if(e){var t=0;e.forEach(function(r,i){++t<=256&&r&&at(n,125,B_e(qE(i,r),i))})}}function FSe(n,e,t,r,i){var s=16+Qu(i.cellXfs,e,i);if(e.v==null&&!e.bf){at(n,513,Rd(t,r,s));return}if(e.bf)at(n,6,lEe(e,t,r,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Xs(Rs(e.v)):e.v;at(n,515,N_e(t,r,a,s));break;case"b":case"e":at(n,517,P_e(t,r,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=OC(i.Strings,e.v,i.revStrings);at(n,253,R_e(t,r,o,s))}else at(n,516,A_e(t,r,(e.v||"").slice(0,255),s,i));break;default:at(n,513,Rd(t,r,s))}}function VSe(n,e,t){var r=Us(),i=t.SheetNames[n],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[n]||{},l=Array.isArray(s),c=e.biff==8,h,g="",m=[],x=mr(s["!ref"]||"A1"),y=c?65536:16384;if(x.e.c>255||x.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,y-1)}at(r,2057,CC(t,16,e)),at(r,13,Na(1)),at(r,12,Na(100)),at(r,15,ws(!0)),at(r,17,ws(!1)),at(r,16,bd(.001)),at(r,95,ws(!0)),at(r,42,ws(!1)),at(r,43,ws(!1)),at(r,130,Na(1)),at(r,128,C_e()),at(r,131,ws(!1)),at(r,132,ws(!1)),c&&jSe(r,s["!cols"]),at(r,512,I_e(x,e)),c&&(s["!links"]=[]);for(var _=x.s.r;_<=x.e.r;++_){g=Xi(_);for(var w=x.s.c;w<=x.e.c;++w){_===x.s.r&&(m[w]=ms(w)),h=m[w]+g;var T=l?(s[_]||[])[w]:s[h];T&&(FSe(r,T,_,w,e),c&&T.l&&s["!links"].push([h,T.l]))}}var b=o.CodeName||o.name||i;return c&&at(r,574,T_e((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&at(r,229,O_e(s["!merges"])),c&&DSe(r,s),at(r,442,NG(b)),c&&LSe(r,s),at(r,10),r.end()}function BSe(n,e,t){var r=Us(),i=(n||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,l=t.biff==5;if(at(r,2057,CC(n,5,t)),t.bookType=="xla"&&at(r,135),at(r,225,o?Na(1200):null),at(r,193,h_e(2)),l&&at(r,191),l&&at(r,192),at(r,226),at(r,92,v_e("SheetJS",t)),at(r,66,Na(o?1200:1252)),o&&at(r,353,Na(0)),o&&at(r,448),at(r,317,G_e(n.SheetNames.length)),o&&n.vbaraw&&at(r,211),o&&n.vbaraw){var c=a.CodeName||"ThisWorkbook";at(r,442,NG(c))}at(r,156,Na(17)),at(r,25,ws(!1)),at(r,18,ws(!1)),at(r,19,Na(0)),o&&at(r,431,ws(!1)),o&&at(r,444,Na(0)),at(r,61,S_e()),at(r,64,ws(!1)),at(r,141,Na(0)),at(r,34,ws(W2e(n)=="true")),at(r,14,ws(!0)),o&&at(r,439,ws(!1)),at(r,218,Na(0)),NSe(r,n,t),MSe(r,n.SSF,t),OSe(r,t),o&&at(r,352,ws(!1));var h=r.end(),g=Us();o&&at(g,140,F_e()),o&&t.Strings&&RSe(g,252,E_e(t.Strings)),at(g,10);var m=g.end(),x=Us(),y=0,_=0;for(_=0;_<n.SheetNames.length;++_)y+=(o?12:11)+(o?2:1)*n.SheetNames[_].length;var w=h.length+y+m.length;for(_=0;_<n.SheetNames.length;++_){var T=s[_]||{};at(x,133,w_e({pos:w,hs:T.Hidden||0,dt:0,name:n.SheetNames[_]},t)),w+=e[_].length}var b=x.end();if(y!=b.length)throw new Error("BS8 "+y+" != "+b.length);var R=[];return h.length&&R.push(h),b.length&&R.push(b),m.length&&R.push(m),Hi(R)}function GSe(n,e){var t=e||{},r=[];n&&!n.SSF&&(n.SSF=qs(Br)),n&&n.SSF&&($E(),UE(n.SSF),t.revssf=WE(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,DC(t),t.cellXfs=[],Qu(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=VSe(i,t,n);return r.unshift(BSe(n,r,t)),Hi(r)}function sz(n,e){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];if(!(!r||!r["!ref"])){var i=ya(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return GSe(n,e);case 4:case 3:case 2:return PSe(n,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function zSe(n,e,t,r){for(var i=n["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>t||i[c].s.c>a)&&!(i[c].e.r<t||i[c].e.c<a)){if(i[c].s.r<t||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var h=er({r:t,c:a}),g=r.dense?(n[t]||[])[a]:n[h],m=g&&g.v!=null&&(g.h||_ye(g.w||(fc(g),g.w)||""))||"",x={};o>1&&(x.rowspan=o),l>1&&(x.colspan=l),r.editable?m='<span contenteditable="true">'+m+"</span>":g&&(x["data-t"]=g&&g.t||"z",g.v!=null&&(x["data-v"]=g.v),g.z!=null&&(x["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+g.l.Target+'">'+m+"</a>")),x.id=(r.id||"sjs")+"-"+h,s.push(st("td",m,x))}}var y="<tr>";return y+s.join("")+"</tr>"}var USe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$Se="</body></html>";function WSe(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function az(n,e){var t=e||{},r=t.header!=null?t.header:USe,i=t.footer!=null?t.footer:$Se,s=[r],a=ya(n["!ref"]);t.dense=Array.isArray(n),s.push(WSe(n,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(zSe(n,a,o,t));return s.push("</table>"+i),s.join("")}function oz(n,e,t){var r=t||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var a=typeof r.origin=="string"?Ci(r.origin):r.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(n["!ref"]){var h=ya(n["!ref"]);c.s.r=Math.min(c.s.r,h.s.r),c.s.c=Math.min(c.s.c,h.s.c),c.e.r=Math.max(c.e.r,h.e.r),c.e.c=Math.max(c.e.c,h.e.c),i==-1&&(c.e.r=i=h.e.r+1)}var g=[],m=0,x=n["!rows"]||(n["!rows"]=[]),y=0,_=0,w=0,T=0,b=0,R=0;for(n["!cols"]||(n["!cols"]=[]);y<o.length&&_<l;++y){var M=o[y];if(fD(M)){if(r.display)continue;x[_]={hidden:!0}}var D=M.children;for(w=T=0;w<D.length;++w){var B=D[w];if(!(r.display&&fD(B))){var k=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):Sye(B.innerHTML),A=B.getAttribute("data-z")||B.getAttribute("z");for(m=0;m<g.length;++m){var C=g[m];C.s.c==T+s&&C.s.r<_+i&&_+i<=C.e.r&&(T=C.e.c+1-s,m=-1)}R=+B.getAttribute("colspan")||1,((b=+B.getAttribute("rowspan")||1)>1||R>1)&&g.push({s:{r:_+i,c:T+s},e:{r:_+i+(b||1)-1,c:T+s+(R||1)-1}});var O={t:"s",v:k},P=B.getAttribute("data-t")||B.getAttribute("t")||"";k!=null&&(k.length==0?O.t=P||"z":r.raw||k.trim().length==0||P=="s"||(k==="TRUE"?O={t:"b",v:!0}:k==="FALSE"?O={t:"b",v:!1}:isNaN(tc(k))?isNaN(g1(k).getDate())||(O={t:"d",v:Rs(k)},r.cellDates||(O={t:"n",v:Xs(O.v)}),O.z=r.dateNF||Br[14]):O={t:"n",v:tc(k)})),O.z===void 0&&A!=null&&(O.z=A);var z="",F=B.getElementsByTagName("A");if(F&&F.length)for(var xe=0;xe<F.length&&!(F[xe].hasAttribute("href")&&(z=F[xe].getAttribute("href"),z.charAt(0)!="#"));++xe);z&&z.charAt(0)!="#"&&(O.l={Target:z}),r.dense?(n[_+i]||(n[_+i]=[]),n[_+i][T+s]=O):n[er({c:T+s,r:_+i})]=O,c.e.c<T+s&&(c.e.c=T+s),T+=R}}++_}return g.length&&(n["!merges"]=(n["!merges"]||[]).concat(g)),c.e.r=Math.max(c.e.r,_-1+i),n["!ref"]=ii(c),_>=l&&(n["!fullref"]=ii((c.e.r=o.length-y+_-1+i,c))),n}function lz(n,e){var t=e||{},r=t.dense?[]:{};return oz(r,n,e)}function HSe(n,e){return Bd(lz(n,e),e)}function fD(n){var e="",t=KSe(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function KSe(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var XSe=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+p1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return ai+e}})(),gD=(function(){var n=function(s){return Jn(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Jn(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,h=0,g=ya(s["!ref"]||"A1"),m=s["!merges"]||[],x=0,y=Array.isArray(s);if(s["!cols"])for(h=0;h<=g.e.c;++h)l.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var _="",w=s["!rows"]||[];for(c=0;c<g.s.r;++c)_=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+_+`></table:table-row>
`);for(;c<=g.e.r;++c){for(_=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+_+`>
`),h=0;h<g.s.c;++h)l.push(e);for(;h<=g.e.c;++h){var T=!1,b={},R="";for(x=0;x!=m.length;++x)if(!(m[x].s.c>h)&&!(m[x].s.r>c)&&!(m[x].e.c<h)&&!(m[x].e.r<c)){(m[x].s.c!=h||m[x].s.r!=c)&&(T=!0),b["table:number-columns-spanned"]=m[x].e.c-m[x].s.c+1,b["table:number-rows-spanned"]=m[x].e.r-m[x].s.r+1;break}if(T){l.push(t);continue}var M=er({r:c,c:h}),D=y?(s[c]||[])[h]:s[M];if(D&&D.f&&(b["table:formula"]=Jn(gEe(D.f)),D.F&&D.F.slice(0,M.length)==M)){var B=ya(D.F);b["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,b["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!D){l.push(e);continue}switch(D.t){case"b":R=D.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=D.v?"true":"false";break;case"n":R=D.w||String(D.v||0),b["office:value-type"]="float",b["office:value"]=D.v||0;break;case"s":case"str":R=D.v==null?"":D.v,b["office:value-type"]="string";break;case"d":R=D.w||Rs(D.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Rs(D.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(e);continue}var k=n(R);if(D.l&&D.l.Target){var A=D.l.Target;A=A.charAt(0)=="#"?"#"+mEe(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),k=st("text:a",k,{"xlink:href":A.replace(/&/g,"&amp;")})}l.push("          "+st("table:table-cell",st("text:p",k,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var h=0;h<c["!cols"].length;++h)if(c["!cols"][h]){var g=c["!cols"][h];if(g.width==null&&g.wpx==null&&g.wch==null)continue;PC(g),g.ods=o;var m=c["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var h=0;h<c["!rows"].length;++h)if(c["!rows"][h]){c["!rows"][h].ods=l;var g=c["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[ai],c=p1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=p1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+h+`>
`),l.push(SG().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var g=0;g!=a.SheetNames.length;++g)l.push(r(a.Sheets[a.SheetNames[g]],a,g));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function cz(n,e){if(e.bookType=="fods")return gD(n,e);var t=vC(),r="",i=[],s=[];return r="mimetype",ln(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",ln(t,r,gD(n,e)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",ln(t,r,XSe(n,e)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",ln(t,r,ai+SG()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",ln(t,r,a_e(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",ln(t,r,i_e(i)),t}function xw(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function qSe(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):mo(m1(n))}function YSe(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var r=0;r<e.length;++r)if(n[t+r]!=e[r])continue e;return!0}return!1}function Wu(n){var e=n.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(i,r),r+=i.length}),t}function ZSe(n,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,r-6176);n[e+15]|=r>>7,n[e+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)n[e+s]=i&255;n[e+15]|=t>=0?0:128}function x1(n,e){var t=e?e[0]:0,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),r}function Kn(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function P0(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function hi(n){for(var e=[],t=[0];t[0]<n.length;){var r=t[0],i=x1(n,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=t[0];n[t[0]++]>=128;);o=n.slice(l,t[0])}break;case 5:a=4,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=x1(n,t),o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function Vi(n){var e=[];return n.forEach(function(t,r){t.forEach(function(i){i.data&&(e.push(Kn(r*8+i.type)),i.type==2&&e.push(Kn(i.data.length)),e.push(i.data))})}),Wu(e)}function so(n){for(var e,t=[],r=[0];r[0]<n.length;){var i=x1(n,r),s=hi(n.slice(r[0],r[0]+i));r[0]+=i;var a={id:P0(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=hi(o.data),c=P0(l[3][0].data);a.messages.push({meta:l,data:n.slice(r[0],r[0]+c)}),r[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=P0(s[3][0].data)>>>0>0),t.push(a)}return t}function Bf(n){var e=[];return n.forEach(function(t){var r=[];r[1]=[{data:Kn(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:Kn(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Kn(a.data.length)}],r[2].push({data:Vi(a.meta),type:2})});var s=Vi(r);e.push(Kn(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Wu(e)}function JSe(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=x1(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(c=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Wu(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var h=Wu(i);if(h.length!=r)throw new Error("Unexpected length: ".concat(h.length," != ").concat(r));return h}function ao(n){for(var e=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(JSe(r,n.slice(t,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return Wu(e)}function Gf(n){for(var e=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=Kn(r),a=s.length;e.push(s),r<=60?(a++,e.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(n.slice(t,t+r)),a+=r,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=r}return Wu(e)}function YT(n,e){var t=new Uint8Array(32),r=xw(t),i=12,s=0;switch(t[0]=5,n.t){case"n":t[1]=2,ZSe(t,i,n.v),s|=1,i+=16;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,s,!0),t.slice(0,i)}function ZT(n,e){var t=new Uint8Array(32),r=xw(t),i=12,s=0;switch(t[0]=3,n.t){case"n":t[2]=2,r.setFloat64(i,n.v,!0),s|=32,i+=8;break;case"b":t[2]=6,r.setFloat64(i,n.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,s,!0),t.slice(0,i)}function Qc(n){var e=hi(n);return x1(e[1][0].data)}function QSe(n,e,t){var r,i,s,a;if(!((r=n[6])!=null&&r[0])||!((i=n[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=n[8])==null?void 0:s[0])==null?void 0:a.data)&&P0(n[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=xw(n[7][0].data),h=0,g=[],m=xw(n[4][0].data),x=0,y=[],_=0;_<e.length;++_){if(e[_]==null){c.setUint16(_*2,65535,!0),m.setUint16(_*2,65535);continue}c.setUint16(_*2,h,!0),m.setUint16(_*2,x,!0);var w,T;switch(typeof e[_]){case"string":w=YT({t:"s",v:e[_]},t),T=ZT({t:"s",v:e[_]},t);break;case"number":w=YT({t:"n",v:e[_]},t),T=ZT({t:"n",v:e[_]},t);break;case"boolean":w=YT({t:"b",v:e[_]},t),T=ZT({t:"b",v:e[_]},t);break;default:throw new Error("Unsupported value "+e[_])}g.push(w),h+=w.length,y.push(T),x+=T.length,++l}for(n[2][0].data=Kn(l);_<n[7][0].data.length/2;++_)c.setUint16(_*2,65535,!0),m.setUint16(_*2,65535,!0);return n[6][0].data=Wu(g),n[3][0].data=Wu(y),l}function eTe(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=ya(t["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ii(r)));var s=yw(t,{range:r,header:1}),a=["~Sh33tJ5~"];s.forEach(function(Q){return Q.forEach(function(ee){typeof ee=="string"&&a.push(ee)})});var o={},l=[],c=nr.read(e.numbers,{type:"base64"});c.FileIndex.map(function(Q,ee){return[Q,c.FullPaths[ee]]}).forEach(function(Q){var ee=Q[0],re=Q[1];if(ee.type==2&&ee.name.match(/\.iwa/)){var he=ee.content,Ve=ao(he),Be=so(Ve);Be.forEach(function(ye){l.push(ye.id),o[ye.id]={deps:[],location:re,type:P0(ye.messages[0].meta[1][0].data)}})}}),l.sort(function(Q,ee){return Q-ee});var h=l.filter(function(Q){return Q>1}).map(function(Q){return[Q,Kn(Q)]});c.FileIndex.map(function(Q,ee){return[Q,c.FullPaths[ee]]}).forEach(function(Q){var ee=Q[0];if(Q[1],!!ee.name.match(/\.iwa/)){var re=so(ao(ee.content));re.forEach(function(he){he.messages.forEach(function(Ve){h.forEach(function(Be){he.messages.some(function(ye){return P0(ye.meta[1][0].data)!=11006&&YSe(ye.data,Be[1])})&&o[Be[0]].deps.push(he.id)})})})}});for(var g=nr.find(c,o[1].location),m=so(ao(g.content)),x,y=0;y<m.length;++y){var _=m[y];_.id==1&&(x=_)}var w=Qc(hi(x.messages[0].data)[1][0].data);for(g=nr.find(c,o[w].location),m=so(ao(g.content)),y=0;y<m.length;++y)_=m[y],_.id==w&&(x=_);for(w=Qc(hi(x.messages[0].data)[2][0].data),g=nr.find(c,o[w].location),m=so(ao(g.content)),y=0;y<m.length;++y)_=m[y],_.id==w&&(x=_);for(w=Qc(hi(x.messages[0].data)[2][0].data),g=nr.find(c,o[w].location),m=so(ao(g.content)),y=0;y<m.length;++y)_=m[y],_.id==w&&(x=_);var T=hi(x.messages[0].data);{T[6][0].data=Kn(r.e.r+1),T[7][0].data=Kn(r.e.c+1);var b=Qc(T[46][0].data),R=nr.find(c,o[b].location),M=so(ao(R.content));{for(var D=0;D<M.length&&M[D].id!=b;++D);if(M[D].id!=b)throw"Bad ColumnRowUIDMapArchive";var B=hi(M[D].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var k=0;k<=r.e.c;++k){var A=[];A[1]=A[2]=[{type:0,data:Kn(k+420690)}],B[1].push({type:2,data:Vi(A)}),B[2].push({type:0,data:Kn(k)}),B[3].push({type:0,data:Kn(k)})}B[4]=[],B[5]=[],B[6]=[];for(var C=0;C<=r.e.r;++C)A=[],A[1]=A[2]=[{type:0,data:Kn(C+726270)}],B[4].push({type:2,data:Vi(A)}),B[5].push({type:0,data:Kn(C)}),B[6].push({type:0,data:Kn(C)});M[D].messages[0].data=Vi(B)}R.content=Gf(Bf(M)),R.size=R.content.length,delete T[46];var O=hi(T[4][0].data);{O[7][0].data=Kn(r.e.r+1);var P=hi(O[1][0].data),z=Qc(P[2][0].data);R=nr.find(c,o[z].location),M=so(ao(R.content));{if(M[0].id!=z)throw"Bad HeaderStorageBucket";var F=hi(M[0].messages[0].data);for(C=0;C<s.length;++C){var xe=hi(F[2][0].data);xe[1][0].data=Kn(C),xe[4][0].data=Kn(s[C].length),F[2][C]={type:F[2][0].type,data:Vi(xe)}}M[0].messages[0].data=Vi(F)}R.content=Gf(Bf(M)),R.size=R.content.length;var Ce=Qc(O[2][0].data);R=nr.find(c,o[Ce].location),M=so(ao(R.content));{if(M[0].id!=Ce)throw"Bad HeaderStorageBucket";for(F=hi(M[0].messages[0].data),k=0;k<=r.e.c;++k)xe=hi(F[2][0].data),xe[1][0].data=Kn(k),xe[4][0].data=Kn(r.e.r+1),F[2][k]={type:F[2][0].type,data:Vi(xe)};M[0].messages[0].data=Vi(F)}R.content=Gf(Bf(M)),R.size=R.content.length;var Ge=Qc(O[4][0].data);(function(){for(var Q=nr.find(c,o[Ge].location),ee=so(ao(Q.content)),re,he=0;he<ee.length;++he){var Ve=ee[he];Ve.id==Ge&&(re=Ve)}var Be=hi(re.messages[0].data);{Be[3]=[];var ye=[];a.forEach(function(Et,Ft){ye[1]=[{type:0,data:Kn(Ft)}],ye[2]=[{type:0,data:Kn(1)}],ye[3]=[{type:2,data:qSe(Et)}],Be[3].push({type:2,data:Vi(ye)})})}re.messages[0].data=Vi(Be);var pe=Bf(ee),Fe=Gf(pe);Q.content=Fe,Q.size=Q.content.length})();var Ne=hi(O[3][0].data);{var ue=Ne[1][0];delete Ne[2];var ke=hi(ue.data);{var ae=Qc(ke[2][0].data);(function(){for(var Q=nr.find(c,o[ae].location),ee=so(ao(Q.content)),re,he=0;he<ee.length;++he){var Ve=ee[he];Ve.id==ae&&(re=Ve)}var Be=hi(re.messages[0].data);{delete Be[6],delete Ne[7];var ye=new Uint8Array(Be[5][0].data);Be[5]=[];for(var pe=0,Fe=0;Fe<=r.e.r;++Fe){var Et=hi(ye);pe+=QSe(Et,s[Fe],a),Et[1][0].data=Kn(Fe),Be[5].push({data:Vi(Et),type:2})}Be[1]=[{type:0,data:Kn(r.e.c+1)}],Be[2]=[{type:0,data:Kn(r.e.r+1)}],Be[3]=[{type:0,data:Kn(pe)}],Be[4]=[{type:0,data:Kn(r.e.r+1)}]}re.messages[0].data=Vi(Be);var Ft=Bf(ee),Dt=Gf(Ft);Q.content=Dt,Q.size=Q.content.length})()}ue.data=Vi(ke)}O[3][0].data=Vi(Ne)}T[4][0].data=Vi(O)}x.messages[0].data=Vi(T);var Z=Bf(m),V=Gf(Z);return g.content=V,g.size=g.content.length,c}function tTe(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function DC(n){tTe([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function nTe(n,e){return e.bookType=="ods"?cz(n,e):e.bookType=="numbers"?eTe(n,e):e.bookType=="xlsb"?rTe(n,e):iTe(n,e)}function rTe(n,e){g0=1024,n&&!n.SSF&&(n.SSF=qs(Br)),n&&n.SSF&&($E(),UE(n.SSF),e.revssf=WE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,yp?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",r=WG.indexOf(e.bookType)>-1,i=vG();DC(e=e||{});var s=vC(),a="",o=0;if(e.cellXfs=[],Qu(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",ln(s,a,TG(n.Props,e)),i.coreprops.push(a),Xn(e.rels,2,a,Nn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}for(n.Props.Worksheets=n.Props.SheetNames.length,ln(s,a,RG(n.Props)),i.extprops.push(a),Xn(e.rels,3,a,Nn.EXT_PROPS),n.Custprops!==n.Props&&qi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",ln(s,a,AG(n.Custprops)),i.custprops.push(a),Xn(e.rels,4,a,Nn.CUST_PROPS)),o=1;o<=n.SheetNames.length;++o){var h={"!id":{}},g=n.Sheets[n.SheetNames[o-1]],m=(g||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,ln(s,a,aSe(o-1,a,e,n,h)),i.sheets.push(a),Xn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Nn.WS[0])}if(g){var x=g["!comments"],y=!1,_="";x&&x.length>0&&(_="xl/comments"+o+"."+t,ln(s,_,cSe(x,_)),i.comments.push(_),Xn(h,-1,"../comments"+o+"."+t,Nn.CMNT),y=!0),g["!legacy"]&&y&&ln(s,"xl/drawings/vmlDrawing"+o+".vml",UG(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}h["!id"].rId1&&ln(s,EG(a),I0(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,ln(s,a,lSe(e.Strings,a,e)),i.strs.push(a),Xn(e.wbrels,-1,"sharedStrings."+t,Nn.SST)),a="xl/workbook."+t,ln(s,a,sSe(n,a)),i.workbooks.push(a),Xn(e.rels,1,a,Nn.WB),a="xl/theme/theme1.xml",ln(s,a,GG(n.Themes,e)),i.themes.push(a),Xn(e.wbrels,-1,"theme/theme1.xml",Nn.THEME),a="xl/styles."+t,ln(s,a,oSe(n,a,e)),i.styles.push(a),Xn(e.wbrels,-1,"styles."+t,Nn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",ln(s,a,n.vbaraw),i.vba.push(a),Xn(e.wbrels,-1,"vbaProject.bin",Nn.VBA)),a="xl/metadata."+t,ln(s,a,uSe(a)),i.metadata.push(a),Xn(e.wbrels,-1,"metadata."+t,Nn.XLMETA),ln(s,"[Content_Types].xml",wG(i,e)),ln(s,"_rels/.rels",I0(e.rels)),ln(s,"xl/_rels/workbook."+t+".rels",I0(e.wbrels)),delete e.revssf,delete e.ssf,s}function iTe(n,e){g0=1024,n&&!n.SSF&&(n.SSF=qs(Br)),n&&n.SSF&&($E(),UE(n.SSF),e.revssf=WE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,yp?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=WG.indexOf(e.bookType)>-1,i=vG();DC(e=e||{});var s=vC(),a="",o=0;if(e.cellXfs=[],Qu(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",ln(s,a,TG(n.Props,e)),i.coreprops.push(a),Xn(e.rels,2,a,Nn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}n.Props.Worksheets=n.Props.SheetNames.length,ln(s,a,RG(n.Props)),i.extprops.push(a),Xn(e.rels,3,a,Nn.EXT_PROPS),n.Custprops!==n.Props&&qi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",ln(s,a,AG(n.Custprops)),i.custprops.push(a),Xn(e.rels,4,a,Nn.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=n.SheetNames.length;++o){var g={"!id":{}},m=n.Sheets[n.SheetNames[o-1]],x=(m||{})["!type"]||"sheet";switch(x){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,ln(s,a,ez(o-1,e,n,g)),i.sheets.push(a),Xn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Nn.WS[0])}if(m){var y=m["!comments"],_=!1,w="";if(y&&y.length>0){var T=!1;y.forEach(function(b){b[1].forEach(function(R){R.T==!0&&(T=!0)})}),T&&(w="xl/threadedComments/threadedComment"+o+"."+t,ln(s,w,Ove(y,h,e)),i.threadedcomments.push(w),Xn(g,-1,"../threadedComments/threadedComment"+o+"."+t,Nn.TCMNT)),w="xl/comments"+o+"."+t,ln(s,w,$G(y)),i.comments.push(w),Xn(g,-1,"../comments"+o+"."+t,Nn.CMNT),_=!0}m["!legacy"]&&_&&ln(s,"xl/drawings/vmlDrawing"+o+".vml",UG(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}g["!id"].rId1&&ln(s,EG(a),I0(g))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,ln(s,a,OG(e.Strings,e)),i.strs.push(a),Xn(e.wbrels,-1,"sharedStrings."+t,Nn.SST)),a="xl/workbook."+t,ln(s,a,rz(n)),i.workbooks.push(a),Xn(e.rels,1,a,Nn.WB),a="xl/theme/theme1.xml",ln(s,a,GG(n.Themes,e)),i.themes.push(a),Xn(e.wbrels,-1,"theme/theme1.xml",Nn.THEME),a="xl/styles."+t,ln(s,a,VG(n,e)),i.styles.push(a),Xn(e.wbrels,-1,"styles."+t,Nn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",ln(s,a,n.vbaraw),i.vba.push(a),Xn(e.wbrels,-1,"vbaProject.bin",Nn.VBA)),a="xl/metadata."+t,ln(s,a,zG()),i.metadata.push(a),Xn(e.wbrels,-1,"metadata."+t,Nn.XLMETA),h.length>1&&(a="xl/persons/person.xml",ln(s,a,Dve(h)),i.people.push(a),Xn(e.wbrels,-1,"persons/person.xml",Nn.PEOPLE)),ln(s,"[Content_Types].xml",wG(i,e)),ln(s,"_rels/.rels",I0(e.rels)),ln(s,"xl/_rels/workbook."+t+".rels",I0(e.wbrels)),delete e.revssf,delete e.ssf,s}function sTe(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=dc(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function uz(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return dx(e.file,nr.write(n,{type:jn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return nr.write(n,e)}function aTe(n,e){var t=qs(e||{}),r=nTe(n,t);return oTe(r,t)}function oTe(n,e){var t={},r=jn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=n.FullPaths?nr.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(zE(i))}return e.password&&typeof encrypt_agile<"u"?uz(encrypt_agile(i,e.password),e):e.type==="file"?dx(e.file,i):e.type=="string"?gp(i):i}function lTe(n,e){var t=e||{},r=TSe(n,t);return uz(r,t)}function qo(n,e,t){t||(t="");var r=t+n;switch(e.type){case"base64":return f1(m1(r));case"binary":return m1(r);case"string":return n;case"file":return dx(e.file,r,"utf8");case"buffer":return jn?Ec(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):qo(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function cTe(n,e){switch(e.type){case"base64":return f1(n);case"binary":return n;case"string":return n;case"file":return dx(e.file,n,"binary");case"buffer":return jn?Ec(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function s_(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return e.type=="base64"?f1(t):e.type=="string"?gp(t):t;case"file":return dx(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function hz(n,e){jxe(),X2e(n);var t=qs(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=hz(n,t);return t.type="array",zE(r)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=n.SheetNames.indexOf(t.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return qo(ESe(n,t),t);case"slk":case"sylk":return qo(W_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"htm":case"html":return qo(az(n.Sheets[n.SheetNames[i]],t),t);case"txt":return cTe(dz(n.Sheets[n.SheetNames[i]],t),t);case"csv":return qo(jC(n.Sheets[n.SheetNames[i]],t),t,"\uFEFF");case"dif":return qo(H_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"dbf":return s_($_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"prn":return qo(K_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"rtf":return qo(eve.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"eth":return qo(LG.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"fods":return qo(cz(n,t),t);case"wk1":return s_(oD.sheet_to_wk1(n.Sheets[n.SheetNames[i]],t),t);case"wk3":return s_(oD.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),s_(sz(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),lTe(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return aTe(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function uTe(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function hTe(n,e,t){var r={};return r.type="file",r.file=e,uTe(r),hz(n,r)}function dTe(n,e,t,r,i,s,a,o){var l=Xi(t),c=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),g=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:t,enumerable:!1})}catch{m.__rowNum__=t}else m.__rowNum__=t;if(!a||n[t])for(var x=e.s.c;x<=e.e.c;++x){var y=a?n[t][x]:n[r[x]+l];if(y===void 0||y.t===void 0){if(c===void 0)continue;s[x]!=null&&(m[s[x]]=c);continue}var _=y.v;switch(y.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[x]!=null){if(_==null)if(y.t=="e"&&_===null)m[s[x]]=null;else if(c!==void 0)m[s[x]]=c;else if(h&&_===null)m[s[x]]=null;else continue;else m[s[x]]=h&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?_:fc(y,_,o);_!=null&&(g=!1)}}return{row:m,isempty:g}}function yw(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},h=c.range!=null?c.range:n["!ref"];switch(c.header===1?r=1:c.header==="A"?r=2:Array.isArray(c.header)?r=3:c.header==null&&(r=0),typeof h){case"string":l=mr(h);break;case"number":l=mr(n["!ref"]),l.s.r=h;break;default:l=h}r>0&&(i=0);var g=Xi(l.s.r),m=[],x=[],y=0,_=0,w=Array.isArray(n),T=l.s.r,b=0,R={};w&&!n[T]&&(n[T]=[]);var M=c.skipHidden&&n["!cols"]||[],D=c.skipHidden&&n["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(M[b]||{}).hidden)switch(m[b]=ms(b),t=w?n[T][b]:n[m[b]+g],r){case 1:s[b]=b-l.s.c;break;case 2:s[b]=m[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=fc(t,null,c),_=R[a]||0,!_)R[a]=1;else{do o=a+"_"+_++;while(R[o]);R[a]=_,R[o]=1}s[b]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(D[T]||{}).hidden){var B=dTe(n,l,T,m,r,s,w,c);(B.isempty===!1||(r===1?c.blankrows!==!1:c.blankrows))&&(x[y++]=B.row)}return x.length=y,x}var mD=/"/g;function fTe(n,e,t,r,i,s,a,o){for(var l=!0,c=[],h="",g=Xi(t),m=e.s.c;m<=e.e.c;++m)if(r[m]){var x=o.dense?(n[t]||[])[m]:n[r[m]+g];if(x==null)h="";else if(x.v!=null){l=!1,h=""+(o.rawNumbers&&x.t=="n"?x.v:fc(x,null,o));for(var y=0,_=0;y!==h.length;++y)if((_=h.charCodeAt(y))===i||_===s||_===34||o.forceQuotes){h='"'+h.replace(mD,'""')+'"';break}h=="ID"&&(h='"ID"')}else x.f!=null&&!x.F?(l=!1,h="="+x.f,h.indexOf(",")>=0&&(h='"'+h.replace(mD,'""')+'"')):h="";c.push(h)}return o.blankrows===!1&&l?null:c.join(a)}function jC(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";var i=mr(n["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),h="",g=[];r.dense=Array.isArray(n);for(var m=r.skipHidden&&n["!cols"]||[],x=r.skipHidden&&n["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(m[y]||{}).hidden||(g[y]=ms(y));for(var _=0,w=i.s.r;w<=i.e.r;++w)(x[w]||{}).hidden||(h=fTe(n,i,w,g,a,l,s,r),h!=null&&(r.strip&&(h=h.replace(c,"")),(h||r.blankrows!==!1)&&t.push((_++?o:"")+h)));return delete r.dense,t.join("")}function dz(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=jC(n,e);return t}function gTe(n){var e="",t,r="";if(n==null||n["!ref"]==null)return[];var i=mr(n["!ref"]),s="",a=[],o,l=[],c=Array.isArray(n);for(o=i.s.c;o<=i.e.c;++o)a[o]=ms(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=Xi(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=c?(n[h]||[])[o]:n[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}l[l.length]=e+"="+r}return l}function fz(n,e,t){var r=t||{},i=+!r.skipHeader,s=n||{},a=0,o=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?Ci(r.origin):r.origin;a=l.r,o=l.c}var c,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var g=mr(s["!ref"]);h.e.c=Math.max(h.e.c,g.e.c),h.e.r=Math.max(h.e.r,g.e.r),a==-1&&(a=g.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var m=r.header||[],x=0;e.forEach(function(_,w){qi(_).forEach(function(T){(x=m.indexOf(T))==-1&&(m[x=m.length]=T);var b=_[T],R="z",M="",D=er({c:o+x,r:a+w+i});c=y1(s,D),b&&typeof b=="object"&&!(b instanceof Date)?s[D]=b:(typeof b=="number"?R="n":typeof b=="boolean"?R="b":typeof b=="string"?R="s":b instanceof Date?(R="d",r.cellDates||(R="n",b=Xs(b)),M=r.dateNF||Br[14]):b===null&&r.nullError&&(R="e",b=0),c?(c.t=R,c.v=b,delete c.w,delete c.R,M&&(c.z=M)):s[D]=c={t:R,v:b},M&&(c.z=M))})}),h.e.c=Math.max(h.e.c,o+m.length-1);var y=Xi(a);if(i)for(x=0;x<m.length;++x)s[ms(x+o)+y]={t:"s",v:m[x]};return s["!ref"]=ii(h),s}function mTe(n,e){return fz(null,n,e)}function y1(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var r=Ci(e);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?y1(n,er(e)):y1(n,er({r:e,c:t||0}))}function pTe(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function xTe(){return{SheetNames:[],Sheets:{}}}function yTe(n,e,t,r){var i=1;if(!t)for(;i<=65535&&n.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&n.SheetNames.indexOf(t=a+i)!=-1;++i);}if(nz(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function _Te(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=pTe(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function vTe(n,e){return n.z=e,n}function gz(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function wTe(n,e,t){return gz(n,"#"+e,t)}function ETe(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function STe(n,e,t,r){for(var i=typeof e!="string"?e:mr(e),s=typeof e=="string"?e:ii(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=y1(n,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=t,r&&(l.D=!0))}return n}var JT={encode_col:ms,encode_row:Xi,encode_cell:er,encode_range:ii,decode_col:RC,decode_row:bC,split_cell:jye,decode_cell:Ci,decode_range:ya,format_cell:fc,sheet_add_aoa:gG,sheet_add_json:fz,sheet_add_dom:oz,aoa_to_sheet:Sg,json_to_sheet:mTe,table_to_sheet:lz,table_to_book:HSe,sheet_to_csv:jC,sheet_to_txt:dz,sheet_to_json:yw,sheet_to_html:az,sheet_to_formulae:gTe,sheet_to_row_object_array:yw,sheet_get_cell:y1,book_new:xTe,book_append_sheet:yTe,book_set_sheet_visibility:_Te,cell_set_number_format:vTe,cell_set_hyperlink:gz,cell_set_internal_link:wTe,cell_add_comment:ETe,sheet_set_array_formula:STe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const hl=Yi()(Ro((n,e)=>({vondsten:[],addVondst:t=>n(r=>({vondsten:[...r.vondsten,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeVondst:t=>n(r=>({vondsten:r.vondsten.filter(i=>i.id!==t)})),updateVondst:(t,r)=>n(i=>({vondsten:i.vondsten.map(s=>s.id===t?{...s,...r}:s)})),clearAll:()=>n({vondsten:[]}),exportAsGeoJSON:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r={type:"FeatureCollection",features:t.map(o=>({type:"Feature",geometry:{type:"Point",coordinates:[o.location.lng,o.location.lat]},properties:{id:o.id,objectType:o.objectType,material:o.material,period:o.period,depth:o.depth,notes:o.notes,timestamp:o.timestamp,photoUrl:o.photoUrl,condition:o.condition,weight:o.weight,length:o.length}}))},i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),a=document.createElement("a");a.href=s,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)},exportAsCSV:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=`ID,Latitude,Longitude,Datum,Type,Materiaal,Periode,Diepte (cm),Conditie,Gewicht (g),Lengte (mm),Notities,Foto URL
`,i=t.map(c=>{const h=new Date(c.timestamp).toLocaleDateString("nl-NL"),g=c.notes?`"${c.notes.replace(/"/g,'""')}"`:"";return`${c.id},${c.location.lat},${c.location.lng},${h},${c.objectType},${c.material},${c.period},${c.depth||""},${c.condition||""},${c.weight||""},${c.length||""},${g},${c.photoUrl||""}`}).join(`
`),s=r+i,a=new Blob([s],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(a),l=document.createElement("a");l.href=o,l.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)},exportAsExcel:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(o=>({ID:o.id,Latitude:o.location.lat,Longitude:o.location.lng,Datum:new Date(o.timestamp).toLocaleDateString("nl-NL"),Type:o.objectType,Materiaal:o.material,Periode:o.period,"Diepte (cm)":o.depth||"",Conditie:o.condition||"","Gewicht (g)":o.weight||"","Lengte (mm)":o.length||"",Notities:o.notes||"","Foto URL":o.photoUrl||""})),i=JT.json_to_sheet(r),s=JT.book_new();JT.book_append_sheet(s,i,"Vondsten");const a=[{wch:36},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:40},{wch:50}];i["!cols"]=a,hTe(s,`mijn-vondsten-${new Date().toISOString().split("T")[0]}.xlsx`)},exportAsGPX:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(l=>{const c=new Date(l.timestamp).toISOString();return`  <wpt lat="${l.location.lat}" lon="${l.location.lng}">
    <name>${l.objectType} - ${l.material}</name>
    <desc>${l.period}${l.depth?`, ${l.depth}cm diep`:""}${l.condition&&l.condition!=="Onbekend"?`, ${l.condition}`:""}${l.weight?`, ${l.weight}g`:""}${l.length?`, ${l.length}mm`:""}${l.notes?`. ${l.notes}`:""}</desc>
    <time>${c}</time>
    <sym>Pin</sym>
  </wpt>`}).join(`
`),i=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL" xmlns="http://www.topografix.com/GPX/1/1">
  <metadata>
    <name>Mijn Vondsten</name>
    <desc>Geexporteerd uit DetectorApp NL</desc>
    <time>${new Date().toISOString()}</time>
  </metadata>
${r}
</gpx>`,s=new Blob([i],{type:"application/gpx+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.gpx`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},exportAsKML:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const i=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>Mijn Vondsten</name>
    <description>Geexporteerd uit DetectorApp NL</description>
${t.map(l=>{const c=new Date(l.timestamp).toLocaleDateString("nl-NL"),h=`<![CDATA[
            <b>Type:</b> ${l.objectType}<br/>
            <b>Materiaal:</b> ${l.material}<br/>
            <b>Periode:</b> ${l.period}<br/>
            ${l.depth?`<b>Diepte:</b> ${l.depth} cm<br/>`:""}
            ${l.condition&&l.condition!=="Onbekend"?`<b>Conditie:</b> ${l.condition}<br/>`:""}
            ${l.weight?`<b>Gewicht:</b> ${l.weight} gram<br/>`:""}
            ${l.length?`<b>Lengte:</b> ${l.length} mm<br/>`:""}
            <b>Datum:</b> ${c}<br/>
            ${l.notes?`<b>Notities:</b> ${l.notes}<br/>`:""}
            ${l.photoUrl?`<a href="${l.photoUrl}">Bekijk foto</a>`:""}
          ]]>`;return`    <Placemark>
      <name>${l.objectType} - ${l.material}</name>
      <description>${h}</description>
      <Point>
        <coordinates>${l.location.lng},${l.location.lat},0</coordinates>
      </Point>
    </Placemark>`}).join(`
`)}
  </Document>
</kml>`,s=new Blob([i],{type:"application/vnd.google-earth.kml+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.kml`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}}),{name:"detectorapp-local-vondsten"})),TTe={Fectio:{naam:"Fectio",latinNaam:"Fectio",type:"castellum",periode:"ca. 4 - 270 n.Chr.",beschrijving:"Groot Romeins castellum bij Bunnik/Vechten, aan de splitsing van Rijn en Vecht. Een van de belangrijkste legerbases in Nederland met ruimte voor 500 soldaten. Het fort had barakken, badhuis, hospitaal en pakhuizen. Buiten de muren woonden handelaren en soldatenfamilies in een vicus. Hier is een compleet Romeins schip gevonden (De Meern 1). Strategisch gelegen voor transport over de rivieren. Veel vondsten door natte bodem: leer, hout, textiel naast munten en militaria. Te bezoeken: Archeologisch Park Castellum Hoge Woerd met reconstructie en museum.",watWasHier:"Groot castellum met ruimte voor 500 soldaten, barakken, badhuis, hospitaal en pakhuizen. Buiten het fort een burgerdorp.",watTeZien:"Archeologisch Park Castellum Hoge Woerd toont de contouren. Museum met veel vondsten waaronder een Romeins schip.",verwachteVondsten:"Munten, fibulae, aardewerk, wapens, paardentuig, militaire uitrusting. Door natte bodem ook leer, hout en textiel.",betekenis:"Een van de belangrijkste forten aan de Limes. Knooppunt voor troepen- en goederentransport.",bronnen:["https://www.hogewoerd.nl","https://www.livius.org/articles/place/fectio-vechten/"]},Traiectum:{naam:"Traiectum",latinNaam:"Traiectum",type:"castellum",periode:"ca. 42 - 275 n.Chr.",beschrijving:'Romeins castellum onder het huidige Domplein in Utrecht. De naam betekent "doorwaadbare plaats" - hier splitsten Rijn en Vecht. Het fort (124x152m in laatste fase) bood plaats aan ca. 500 soldaten. Vijf bouwfases: eerst hout, na 200 n.Chr. steen met tufsteen uit de Eifel. Cohors II Hispanorum peditata (Spaanse infanterie) was hier uniek gelegerd 88-275 n.Chr. - hun dakpanstempels zijn nergens anders aan de Limes gevonden! Het fort werd verwoest tijdens de Bataafse Opstand (69 n.Chr.). DOMunder onder het Domplein toont de opgegraven resten. UNESCO Werelderfgoed sinds 2021.',watWasHier:"Castellum (500 soldaten) bij riviersplitsing. Cohors II Hispanorum gelegerd.",watTeZien:"DOMunder onder het Domplein: opgravingen te bezoeken. Principia en poorten blootgelegd.",verwachteVondsten:"Dakpannen met stempels, munten, aardewerk, tufsteen bouwmateriaal, militaria.",betekenis:"UNESCO Werelderfgoed. Oorsprong van de stad Utrecht.",bronnen:["https://www.livius.org/articles/place/traiectum-utrecht/","https://www.utrechtaltijd.nl/verhalen/castellum-traiectum-een-romeinse-legerbasis-in-het-hart-van-de-domstad/","https://www.romeinen.nl/locatie-overzicht/3447271878/domunder-castellum-traiectum"]},Laurum:{naam:"Laurum",latinNaam:"Laurum",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in het huidige Woerden aan de Oude Rijn. Garnizoen van ca. 500 soldaten in houten barakken. Bijzonder vanwege de natte veenbodem: organisch materiaal bleef bewaard zoals houten schrijfplankjes met Latijnse teksten, leren schoenen en een Romeinse boot. Het fort werd meerdere keren herbouwd na overstromingen. De contouren zijn in het stratenpatroon herkenbaar. Buiten de muren lag een vicus (burgerdorp). Vondsten in Stadsmuseum Woerden, waaronder unieke houten voorwerpen die elders zijn vergaan.",watWasHier:"Castellum voor 500 soldaten met houten barakken, badhuis en pakhuizen. Vicus buiten de muren.",watTeZien:"Stadsmuseum Woerden met bijzondere vondsten. Fort-contouren in stratenpatroon herkenbaar.",verwachteVondsten:"Militaria, aardewerk, munten, schrijfplankjes. Door natte veengrond ook hout, leer en schoenen.",betekenis:"Toont Romeins bouwen in moeilijk veengebied. Unieke organische vondsten.",bronnen:["https://www.castellumwoerden.nl"]},"Castellum Praetorium Agrippinae":{naam:"Praetorium Agrippinae",latinNaam:"Praetorium Agrippinae",type:"castellum",periode:"ca. 40 - 275 n.Chr.",beschrijving:"Een van de best opgegraven Romeinse locaties van Nederland. Het castellum werd gesticht in de winter van 39/40 n.Chr. door keizer Caligula, vernoemd naar zijn moeder Vipsania Agrippina. Een opgegraven wijnvat bevatte wijn van de persoonlijke wijngaarden van de keizer! Er zijn 7 bouwfasen gevonden, 6 van hout en de laatste van steen - uniek compleet inzicht in Romeinse bouwtechnieken. Cohors III Gallorum equitata was hier gelegerd. Bij opgravingen (1941-1953) zijn door het grondwater veel organische vondsten bewaard: voedselresten, leer, touw. De vicus buiten het fort strekte zich 1 km uit met 700+ graven. Op het Castellumplein zijn de contouren in brons gemarkeerd.",watWasHier:"Castellum met 7 bouwfasen. Vicus (1 km) met 700+ graven. Detachement Cohors III Gallorum.",watTeZien:"Castellumplein met bronzen markeringen. Torenmuseum Valkenburg. Gereconstrueerde poort.",verwachteVondsten:"Militaria, organisch materiaal (voedsel, leer, touw), aardewerk, munten, inscripties.",betekenis:"Best gedocumenteerde Romeinse fort van Nederland. UNESCO Werelderfgoed.",bronnen:["https://www.livius.org/articles/place/praetorium-agrippinae-valkenburg-zh/","https://www.geschiedenisvanzuidholland.nl/zien-en-doen/locaties/praetorium-agrippinae-in-valkenburg/","https://oudvalkenburgzh.nl/torenmuseum-5/"]},"Castra Hunnerberg":{naam:"Castra Hunnerberg",latinNaam:"Castra",type:"legerkamp",periode:"ca. 16 v.Chr. - 104 n.Chr.",beschrijving:'Enorm Romeins legerkamp op de Hunnerberg bij Nijmegen - 42 hectare (80 voetbalvelden), ruimte voor 12.000 man. De enige plek in Nederland waar echte legioenen (geen hulptroepen) verbleven! Na de Bataafse Opstand (69 n.Chr.) vestigde Legio X Gemina Pia Fidelis zich hier - opgericht door Julius Caesar en het bekendste legioen van Nederland. De afkorting LXG is talloze keren gevonden op dakpannen en tegels. Bij opgravingen zijn ruim 1000 fragmenten militaire uitrusting en paardentuig gevonden. In 104 n.Chr. vertrok het legioen naar de Balkan - een ramp voor de economie. UNESCO Werelderfgoed sinds 2021, omschreven als "bakermat van de Nederduitse Limes".',watWasHier:"Legerkamp voor 12.000 man. Legio X Gemina (71-104 n.Chr.), opgericht door Julius Caesar.",watTeZien:"Museum Het Valkhof. Museum Kam in de Hunnerberg. Grafvelden in Nijmegen-Oost.",verwachteVondsten:"Legioenstempels LXG, militaria, paardentuig, dakpannen, munten, grafstenen.",betekenis:"UNESCO Werelderfgoed. Bakermat van de Limes. Enige legioenskamp in Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-hunnerberg/","https://www.welkominnijmegen.nl/pages/geschiedenis/de-romeinen-in-nijmegen/de-legerkampen.php","https://mijngelderland.nl/inhoud/specials/archeokroniek/romeinse-militaire-uitrusting-en-paardentuig-van-de-hunerberg-te-nijmegen"]},"Castellum Kops Plateau":{naam:"Kops Plateau",latinNaam:"Oppidum Batavorum",type:"castellum",periode:"ca. 10 v.Chr. - 70 n.Chr.",beschrijving:"Vroege Romeinse basis op het Kops Plateau in Nijmegen, later de civiele hoofdstad van de Bataven: Oppidum Batavorum. Hier woonden Romeinen en Bataven samen - het eerste contactpunt tussen beide culturen. Verwoest tijdens de Bataafse Opstand van 69-70 n.Chr. onder leiding van Julius Civilis. Gemengde vondsten: Romeinse militaria n Keltisch-Bataafse voorwerpen. Vroege importaardewerk en munten van Augustus. Nu natuurgebied. Museum Het Valkhof toont de unieke vondsten van deze ontmoeting van culturen.",watWasHier:"Eerst Romeins kamp, later Bataafse hoofdstad. Romeinen en Bataven woonden samen.",watTeZien:"Kops Plateau is natuurgebied. Museum Het Valkhof toont de vondsten.",verwachteVondsten:"Vroege militaria, Keltisch-Bataafse voorwerpen, importaardewerk, munten van Augustus.",betekenis:"Eerste contactpunt Romeinen-Bataven. Begin van romanisering Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-kops-plateau/"]},"Nijmegen, Valkhof":{naam:"Valkhof Nijmegen",latinNaam:"Valkhof",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:"Laat-Romeinse versterking op het Valkhof in Nijmegen, aan de Waaloever. Gebouwd toen het Rijk onder druk stond van Germaanse invallen. Strategische positie boven de rivier. Continuteit: Karel de Grote bouwde hier later zijn palts (koninklijke residentie). De Sint-Nicolaaskapel bevat mogelijk Karolingische elementen op Romeinse fundamenten. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Museum Het Valkhof toont de overgang van Romeinse tijd naar vroege middeleeuwen.",watWasHier:"Laat-Romeinse versterking boven de Waal. Later Karolingische palts.",watTeZien:"Valkhofpark met Sint-Nicolaaskapel. Museum Het Valkhof.",verwachteVondsten:"Laat-Romeinse munten, gordels, riemtongen, militaire gespen, 3e-4e eeuws aardewerk.",betekenis:"Toont overgang Romeinse tijd naar middeleeuwen. Nijmegen bleef machtscentrum.",bronnen:["https://www.museumhetvalkhof.nl"]},"Castellum Op de Hoge Woerd":{naam:"Hoge Woerd",latinNaam:"Castellum",type:"castellum",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeins castellum in Leidsche Rijn (Utrecht), nu een voorbeeldig archeologisch park. Middelgroot fort met houten gebouwen en een burgerdorp (vicus) buiten de muren. Hier is een compleet Romeins schip gevonden: De Meern 1, een 25 meter lange vrachtboot. Door de natte kleigrond bleef veel organisch materiaal bewaard. Het park toont de reconstructie van het fort - je kunt over de originele fundamenten lopen. Modern museum met interactieve presentatie. Ideale plek om te zien hoe een Romeins fort eruitzag.",watWasHier:"Middelgroot castellum met houten gebouwen. Vicus buiten de muren. Compleet schip gevonden.",watTeZien:"Archeologisch Park Hoge Woerd: reconstructie fort, museum, originele fundamenten.",verwachteVondsten:"Militaria, scheepsonderdelen, aardewerk, munten. Door natte grond ook organisch materiaal.",betekenis:"Best gepresenteerde Romeinse fort in Nederland. Ideaal om fort-layout te begrijpen.",bronnen:["https://www.hogewoerd.nl"]},Lugdunum:{naam:"Lugdunum",latinNaam:"Lugdunum",type:"vlootbasis",periode:"ca. 40 - 270 n.Chr.",beschrijving:`Romeinse vlootbasis en versterkte graanopslagplaats bij de monding van de Rijn, het westelijkste punt van de gehele Limes. Hier stond mogelijk een enorme vuurtoren (ca. 60m hoog) naar model van de Pharos van Ostia - vissers noemden deze "Kalla's toren" (Caligula). Door de vele dakpannen van de Romeinse vloot wordt aangenomen dat dit een vlootbasis was. Het fort is door kustafslag in zee verdwenen. Bij stormen in 1520, 1552 en 1562 waren de runes van de "Brittenburg" zichtbaar op het strand; de laatst gedateerde vondst was 270 n.Chr. Het Rijksmuseum van Oudheden in Leiden toont vondsten. De beroemde kaart van Ortelius toont hoe het eruit zag.`,watWasHier:"Vlootbasis met vuurtoren bij Rijnmonding. Graanopslag voor Britannia.",watTeZien:"Fort verdwenen in zee. RMO Leiden toont vondsten en kaart van Ortelius.",verwachteVondsten:"Na stormen: munten, aardewerk, militaria. Fort zelf onbereikbaar in Noordzee.",betekenis:"Westelijk eindpunt van de Limes. Verbinding met Britannia.",bronnen:["https://www.livius.org/articles/place/lugdunum-katwijk/","https://nl.wikipedia.org/wiki/Lugdunum_(Katwijk)"]},"Vlootbasis Naaldwijk":{naam:"Vlootbasis Naaldwijk",type:"vlootbasis",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Vermoedelijke basis van de Classis Germanica (Germaanse vloot) bij Naaldwijk in het Westland. De Romeinse vloot patrouilleerde langs de Noordzeekust en vervoerde troepen en goederen naar Britannia. Haven met dokken voor oorlogsschepen en transportboten. Mariniers (classiarii) waren hier gestationeerd. Het gebied is nu landbouwgrond, maar bij opgravingen zijn haven-structuren en scheepsgerelateerde vondsten gedaan. Ankers, scheepsonderdelen en specifieke mariniers-uitrusting. Toont het belang van zeemacht voor de Romeinse grensverdediging.",watWasHier:"Haven voor oorlogsschepen. Mariniers gestationeerd. Patrouilles langs Noordzeekust.",watTeZien:"Gebied is landbouwgrond. Vondsten in lokale musea.",verwachteVondsten:"Scheepsonderdelen, ankers, mariniers-uitrusting, importaardewerk.",betekenis:"Toont belang Romeinse vloot voor kustverdediging.",bronnen:[]},"Minifort Ockenburg":{naam:"Minifort Ockenburg",type:"minifort",periode:"ca. 150 - 180 n.Chr.",beschrijving:"Klein Romeins kustfort bij Ockenburg in Den Haag, op een oude strandwal. Bewaakte de kust tegen piraten en Germaanse invallen over zee. Ruimte voor slechts 20-30 soldaten - een wachtpost eerder dan een echt fort. Korte gebruiksperiode van ca. 30 jaar. Toont dat de Romeinen niet alleen de rivieren maar ook de Noordzeekust verdedigden. Het terrein is beschermd rijksmonument maar niet publiek toegankelijk. Vondsten in het Haags Historisch Museum: militaria, aardewerk en munten uit de 2e eeuw.",watWasHier:"Kleine kustwachtpost voor 20-30 soldaten op strandwal.",watTeZien:"Terrein beschermd maar niet toegankelijk. Haags Historisch Museum.",verwachteVondsten:"Kleine hoeveelheden militaria, aardewerk, munten 2e eeuw.",betekenis:"Toont Romeinse kustverdediging naast rivierforten.",bronnen:[]},"Castellum Ceuclum":{naam:"Ceuclum",latinNaam:"Ceuclum",type:"castellum",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Romeins castellum bij Cuijk aan de Maas, waar de belangrijke weg naar het noorden de rivier kruiste. Het fort bewaakte een brug of veerpont. Garnizoen van hulptroepen. De naam Cuijk is afgeleid van Ceuclum. Bij de brug werden ritueel munten geofferd. Het fort lag op een strategisch punt waar de Maasroute de landweg kruiste. Vondsten wijzen op handel en militaire activiteit. Het Maasmuseum in Cuijk toont lokale Romeinse vondsten. Onder het centrum zijn bij bouwwerkzaamheden regelmatig resten gevonden.",watWasHier:"Castellum bij Maasbrug. Belangrijke rivierovergang en kruispunt.",watTeZien:"Maasmuseum Cuijk. Resten gevonden onder centrum.",verwachteVondsten:"Munten (geofferd bij brug), fibulae, aardewerk, bruggerelateerde vondsten.",betekenis:"Belangrijke schakel in wegennet langs de Maas.",bronnen:["https://www.livius.org/articles/place/ceuclum-cuijk/"]},"Castellum Meinerswijk":{naam:"Meinerswijk",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in de uiterwaarden bij Arnhem-Meinerswijk aan de Rijn. Het fort bewaakt een strategisch punt waar de rivier goed te overzien was. Meerdere bouwfasen door overstromingen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan: militaria, aardewerk, munten en scheepsresten. Het gebied is nu natuurgebied Meinerswijk met wisselende waterstanden. Na hoog water kunnen vondsten aan de oppervlakte komen. Museum Arnhem toont Romeinse vondsten uit de regio.",watWasHier:"Castellum in uiterwaarden. Meerdere bouwfasen door overstromingen.",watTeZien:"Natuurgebied Meinerswijk. Museum Arnhem.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},Levefanum:{naam:"Levefanum",latinNaam:"Levefanum",type:"versterking",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeinse versterking bij Wijk bij Duurstede, waar de Rijn splitste in de Lek en Kromme Rijn. Strategisch cruciaal punt voor controle over het scheepvaartverkeer. Waarschijnlijk ook een haven voor overslag van goederen. Op dezelfde plek ontstond later de Karolingische handelsstad Dorestad, een van de belangrijkste havens van vroegmiddeleeuws Europa. De continuteit toont het blijvende belang van deze locatie. Dorestad Museum vertelt het verhaal van Romeinse tijd tot Vikingaanvallen. Vondsten: munten, handelsaardewerk, militaria.",watWasHier:"Versterking bij riviersplitsing. Haven en overslagpunt. Later Dorestad.",watTeZien:"Dorestad Museum. Terrein bebouwd.",verwachteVondsten:"Munten, handelsaardewerk, militaria, scheepsgerelateerde vondsten.",betekenis:"Strategisch controlepunt waterwegen. Later belangrijke handelsstad Dorestad.",bronnen:[]},"Nigrum Pullum":{naam:"Nigrum Pullum",latinNaam:"Nigrum Pullum (Zwarte Poel)",type:"minifort",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Zwammerdam aan de Oude Rijn. Garnizoen van 100-150 soldaten met pakhuizen en haven voor riviertransport. Wereldberoemd door de vondst van 6 Romeinse schepen (1971-1974) in perfecte staat - bewaard door de natte veengrond. De Zwammerdamschepen zijn de best bewaarde Romeinse rivierschepen ter wereld en tonen uniek inzicht in Romeins transport en scheepsbouw. Vondsten: schepen, leren schoeisel, houten voorwerpen, aardewerk, munten, militaria. Te zien in Rijksmuseum van Oudheden, Leiden.",watWasHier:"Klein fort met pakhuizen en haven. Bij opgravingen werden 6 Romeinse schepen gevonden.",watTeZien:"De schepen zijn in het Rijksmuseum van Oudheden in Leiden. Het terrein zelf is niet te bezoeken.",verwachteVondsten:"Scheepsonderdelen, leren schoeisel, houten voorwerpen, aardewerk, munten, en door de natte veengrond organisch materiaal.",betekenis:"Wereldberoemd om de goed bewaarde Romeinse schepen. Toont transport over de Rijn.",bronnen:["https://www.rmo.nl/collectie/themas/zwammerdam"]},"Stenen wachttoren Vleuterweide":{naam:"Wachttoren Vleuterweide",type:"wachttoren",periode:"ca. 150 - 250 n.Chr.",beschrijving:"Bijzondere stenen wachttoren in Vleuterweide bij Utrecht - de meeste Romeinse wachttorens waren van hout. De stenen constructie wijst op permanentie en belang. Onderdeel van het signaleringssysteem langs de Limes: bij gevaar werden vuren aangestoken om forten te waarschuwen. De toren bood uitzicht over de omgeving en de rivier. Mogelijk woonden hier ook families van de soldaten. De fundamenten zijn gemarkeerd in de moderne woonwijk. Vondsten: bouwmateriaal (dakpannen, stenen), aardewerk, persoonlijke bezittingen. Centraal Museum Utrecht.",watWasHier:"Stenen wachttoren (ongebruikelijk). Signaalpost voor waarschuwingssysteem.",watTeZien:"Fundamenten gemarkeerd in wijk. Centraal Museum Utrecht.",verwachteVondsten:"Dakpannen met legioenstempels, aardewerk, persoonlijke bezittingen.",betekenis:"Een van weinige bekende stenen wachttorens. Toont variatie in bouwwijzen.",bronnen:[]},"Wachttoren Bunnik":{naam:"Wachttoren Bunnik",type:"wachttoren",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Houten wachttoren bij Bunnik aan de Rijn, onderdeel van het signaleringssysteem langs de Limes. Elke paar kilometer stond een toren met uitzicht over de rivier. Bij nadering van vijanden werden vuren of rooksignalen gegeven, zodat binnen minuten alle forten gewaarschuwd waren. De torens waren meestal van hout op een aarden verhoging. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend doordat het gebied nu bebouwd is. Vondsten zijn schaars: wat aardewerk en militaria.",watWasHier:"Houten uitkijktoren voor signalering. Kleine bezetting van 4-8 soldaten.",watTeZien:"Exacte locatie onbekend. Gebied bebouwd.",verwachteVondsten:"Kleine hoeveelheden militaria en aardewerk.",betekenis:"Onderdeel signaleringssysteem langs Limes.",bronnen:[]},"Castellum Maastricht":{naam:"Castellum Maastricht",latinNaam:"Mosae Trajectum",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:'Laat-Romeinse versterking in het centrum van Maastricht bij de brug over de Maas. Mosae Trajectum betekent "Maasoversteek". Gebouwd in een periode dat het Rijk onder druk stond van Germaanse invallen. Het fort bewaakte de strategische rivierovergang. Continuteit van bewoning: Maastricht bleef bewoond tot op heden. Onder het Vrijthof en omgeving zijn Romeinse resten gevonden. Typische laat-Romeinse vondsten: gordels, riembeslag, munten 3e-4e eeuw, zwaar versterkte muren. Centre Ceramique vertelt de geschiedenis.',watWasHier:"Laat-Romeinse versterking bij Maasbrug. Verdediging tegen Germaanse invallen.",watTeZien:"Onder Vrijthof zijn resten. Centre Ceramique.",verwachteVondsten:"Laat-Romeinse munten, militaire gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont continuteit - Maastricht ononderbroken bewoond sinds Romeinse tijd.",bronnen:["https://www.centreceramique.nl"]},Roompot:{naam:"Roompot Fort",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de Roompot in Zeeland dat de toegang tot de Oosterschelde bewaakte. Het fort beschermde schepen tegen piraterij en controleerde de vaarroute. Door zeespiegelstijging en kustafslag is het fort in de golven verdwenen. De exacte locatie ligt nu onder water. Soms spoelen na stormen vondsten aan op de stranden van Noord-Beveland en Walcheren: munten, aardewerk, metalen voorwerpen. Toont dat de Romeinen de gehele Zeeuwse delta controleerden, niet alleen de grote rivieren.",watWasHier:"Kustfort dat zeeroute bewaakte. Bescherming tegen piraterij.",watTeZien:"Fort verdwenen in zee. Soms vondsten op strand na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen voorwerpen op Zeeuwse stranden.",betekenis:"Toont Romeinse controle over Zeeuwse wateren.",bronnen:[]},"Castellum Carvium":{naam:"Carvium",latinNaam:"Carvium",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Herwen-Aerdt (bij Lobith) waar Rijn en Waal samenkwamen - een strategisch knooppunt van eerste orde. Het fort controleerde het rivierverkeer op beide grote stromen. Garnizoen van hulptroepen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan. Het gebied is nu natuurgebied de Gelderse Poort met dynamische rivierlandschap. Na hoog water kunnen vondsten aan oppervlakte komen. Museum Het Valkhof in Nijmegen toont vondsten uit de regio. Scheepsresten gevonden.",watWasHier:"Fort bij samenvloeiing Rijn en Waal. Controleerde twee grote rivieren.",watTeZien:"Natuurgebied Gelderse Poort. Museum Het Valkhof Nijmegen.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Controleerde strategisch knooppunt waterwegen.",bronnen:[]},Matilo:{naam:"Matilo",latinNaam:"Matilo",type:"castellum",periode:"ca. 70 - 260 n.Chr.",beschrijving:'Romeins castellum bij Leiden-Roomburg, gebouwd na de Bataafse Opstand (69-70 n.Chr.) op een strategische plek aan de monding van het Kanaal van Corbulo. Het gigantische fort (80x120m) bood plaats aan ca. 500 soldaten en is een van de best bewaarde castella in Nederland. De archeologische resten liggen grotendeels intact onder Archeologisch Park Matilo. In het park staan 6 replica-wachttorens en een aarden wal die de omtrek van het fort visualiseert. Het fort werd tussen 240-260 n.Chr. opgeheven. De locatie Roomburg ("Romeinse burcht") verwijst naar de oorsprong. UNESCO Werelderfgoed sinds 2021.',watWasHier:"Groot castellum (500 soldaten) bij monding Kanaal van Corbulo. Vicus buiten de muren.",watTeZien:"Archeologisch Park Matilo met 6 wachttoren-replica's en aarden wal. Rijksmuseum van Oudheden.",verwachteVondsten:"Militaria, grafgiften, crematie-urnen, aardewerk, munten, fibulae.",betekenis:"UNESCO Werelderfgoed. Een van de best bewaarde castella van Nederland.",bronnen:["https://parkmatilo.nl/het-verhaal-van-matilo/","https://www.limeswerelderfgoed.nl/locaties/2016475046/archeologisch-park-matilo","https://www.romeinen.nl/locatie-overzicht/2016475046/archeologisch-park-matilo"]},Corbulo:{naam:"Forum Hadriani",latinNaam:"Forum Hadriani (Municipium Aelium Cananefatium)",type:"versterking",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Forum Hadriani bij Voorburg was de noordelijkste Romeinse stad van het Europese continent en de enige stad met stadsrechten in Nederland. Gesticht rond 70 n.Chr. aan het Kanaal van Corbulo (34 km, verbinding Rijn-Maas). Keizer Hadrianus verleende in 121 n.Chr. marktrechten en gaf de stad zijn naam. Rond 150 n.Chr. kreeg het stadsrechten (Municipium). De stad had ca. 1000 inwoners, een stadsmuur met dubbele gracht, stenen gebouwen en tempels. Park Arentsburgh markeert de locatie. UNESCO Werelderfgoed sinds 2021. De eerste wetenschappelijke opgravingen (1827-1833) waren door Caspar Reuvens, de eerste hoogleraar archeologie ter wereld.",watWasHier:"Enige Romeinse stad met stadsrechten in Nederland. Ca. 1000 inwoners.",watTeZien:"Park Arentsburgh in Voorburg. Kanaal traceerbaar als de Vliet.",verwachteVondsten:"Stedelijke vondsten: bouwmateriaal, aardewerk, munten, inscripties, religieuze voorwerpen.",betekenis:"UNESCO Werelderfgoed. Noordelijkste Romeinse stad van Europa.",bronnen:["https://www.awlv.nl/forum-hadriani/de-stad-forum-hadriani/","https://www.romeinen.nl/weten/nederland-in-de-romeinse-tijd/zuid-holland/regio-voorburg","https://kennis.cultureelerfgoed.nl/index.php/Monumenten/508083"]},"Berg - Tomveld":{naam:"Berg-Tomveld",type:"villa",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse villa bij Berg in Zuid-Limburg, mogelijk tijdelijk militair gebruikt. Dit type gebouwen diende als landbouwbedrijf met luxe woondeel voor de eigenaar. De regio Zuid-Limburg was dicht bebouwd met villa's die graan en vee leverden aan het Romeinse leger. Vondsten wijzen op welvaart: mozaekvloeren, beschilderd pleisterwerk, hypocaustum (vloerverwarming). De locatie Tomveld verwijst mogelijk naar Romeinse grafheuvels (tumuli) in de buurt. Thermenmuseum Heerlen toont de villa-cultuur.",watWasHier:"Villa rustica met mogelijk militair gebruik. Landbouw voor legervoorraden.",watTeZien:"Locatie in agrarisch gebied. Thermenmuseum Heerlen.",verwachteVondsten:"Bouwmateriaal, dakpannen, aardewerk, munten, sieraden.",betekenis:"Toont Romeinse landbouweconomie in Zuid-Limburg.",bronnen:[]},"Berg - Trappenberg":{naam:"Berg-Trappenberg",type:"legerkamp",periode:"1e eeuw v.Chr. - 1e eeuw n.Chr.",beschrijving:"Vroeg-Romeins legerkamp bij Berg in Zuid-Limburg dat later werd omgebouwd tot villa of boerderij. Toont de transitie van militaire bezetting naar civiele bewoning. Het kamp dateert uit de veroveringsperiode toen Rome dit gebied inlijfde. Na pacificatie was een fort niet meer nodig en werd het terrein civiel benut. Vondsten: vroege Romeinse militaria naast later agrarisch materiaal. Zuid-Limburg was een grenszone voordat de Limes naar de Rijn verplaatste.",watWasHier:"Eerst legerkamp, later villa/boerderij. Overgang militair naar civiel.",watTeZien:"Locatie in landbouwgebied.",verwachteVondsten:"Vroege militaria, later agrarisch aardewerk, bouwmateriaal.",betekenis:"Toont Romeinse verovering en pacificatie van Zuid-Limburg.",bronnen:[]},"Castellum Blariacum":{naam:"Blariacum",latinNaam:"Blariacum",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van het Romeinse castellum Blariacum bij Blerick (nu deel van Venlo). De naam leeft voort in de plaatsnaam. Het fort zou de Maasovergang hebben bewaakt op de route tussen Xanten en Maastricht. De exacte locatie is nooit definitief vastgesteld ondanks vele opgravingspogingen. Vondsten in de omgeving wijzen wel op Romeinse militaire aanwezigheid: militaria, munten, aardewerk. Het Limburgs Museum in Venlo toont de Romeinse geschiedenis van de regio.",watWasHier:"Vermoedelijk castellum bij Maasovergang. Exacte locatie onzeker.",watTeZien:"Locatie niet vastgesteld. Limburgs Museum Venlo.",verwachteVondsten:"Militaria, munten, aardewerk als aanwijzingen voor fortlocatie.",betekenis:"Plaatsnaam Blerick afgeleid van Blariacum. Schakel in Maasroute.",bronnen:[]},"Fortificatie Bodegraven":{naam:"Wachtpost Bodegraven",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Waarschijnlijke Romeinse wachtpost bij Bodegraven aan de Oude Rijn. Onderdeel van het signaleringssysteem tussen de grotere forten zoals Nigrum Pullum en Laurum. De wachttorens stonden om de paar kilometer en konden met vuur- of rooksignalen waarschuwingen doorgeven. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend. Bij graafwerkzaamheden in Bodegraven zijn wel Romeinse scherven gevonden die op aanwezigheid wijzen.",watWasHier:"Kleine wachtpost voor signalering. 4-8 soldaten.",watTeZien:"Exacte locatie onbekend.",verwachteVondsten:"Aardewerk, kleine hoeveelheden militaria.",betekenis:"Onderdeel communicatiesysteem langs de Limes.",bronnen:[]},Caestert:{naam:"Caestert",type:"versterking",periode:"1e eeuw v.Chr.",beschrijving:"Mogelijk de locatie waar de Eburonen onder leiding van Ambiorix in 54 v.Chr. een Romeins legioen vernietigden - de zwaarste Romeinse nederlaag in de Lage Landen. Het plateau van Caestert bij Kanne (Belgisch Limburg) had een oppidum (versterkte nederzetting). Julius Caesar beschrijft de slag in zijn Gallische Oorlogen. De locatie is omstreden, maar Caestert is een sterke kandidaat. Symbolisch belangrijke plek voor de Belgische geschiedenis. De site is nu natuurgebied met grotten.",watWasHier:"Mogelijk slagveld Ambiorix-opstand 54 v.Chr. Oppidum (versterking).",watTeZien:"Plateau Caestert, natuurgebied met grotten.",verwachteVondsten:"Keltische en vroeg-Romeinse voorwerpen, mogelijk slagveldvondsten.",betekenis:"Mogelijke locatie grootste Romeinse nederlaag in de regio.",bronnen:[]},"Castellum Driel?":{naam:"Castellum Driel",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:'Mogelijke locatie van een Romeins castellum bij Driel in de Betuwe. Het bestaan en de exacte locatie zijn onzeker, vandaar het vraagteken. De Betuwe (Insula Batavorum - "Eiland der Bataven") was kerngebied van de Bataven, bondgenoten van Rome. Zij leverden beroemde hulptroepen aan het Romeinse leger. Een fort hier zou logisch zijn om het gebied te controleren. Vondsten in de omgeving wijzen op Romeinse aanwezigheid. Museum Het Valkhof Nijmegen toont de Bataafse cultuur.',watWasHier:"Mogelijk castellum in Bataafs kerngebied. Bestaan onzeker.",watTeZien:"Geen zichtbare resten. Museum Het Valkhof.",verwachteVondsten:"Romeinse en Bataafse voorwerpen indien locatie juist.",betekenis:"Zou Romeinse controle over Bataafs gebied tonen.",bronnen:[]},"Castellum Duiven - Loowaard":{naam:"Duiven-Loowaard",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Duiven/Loowaard aan de Rijn, in de uiterwaarden tussen Arnhem en Zevenaar. Het fort bewaakte de rivierroute en de overgang naar het Bataafse gebied. De dynamische rivier heeft veel resten weggespoeld of diep begraven. Bij lage waterstanden en na erosie komen soms vondsten aan oppervlakte: munten, militaria, aardewerk. Het gebied is nu natuurgebied met grazende grote grazers. Museum Arnhem en Het Valkhof Nijmegen tonen vondsten uit de regio.",watWasHier:"Castellum aan de Rijn in uiterwaarden. Bewaakte rivierovergang.",watTeZien:"Natuurgebied. Na erosie mogelijk vondsten aan oppervlakte.",verwachteVondsten:"Militaria, munten, aardewerk na erosie of bij laag water.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},"Castellum Grinnes":{naam:"Grinnes",latinNaam:"Grinnes",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Rossum in de gemeente Maasdriel - waarschijnlijk het antieke Grinnes vermeld op de Peutingerkaart. Het fort lag aan de Waal en controleerde de rivierroute. Bij opgravingen zijn resten van het fort gevonden. De omgeving is rijk aan Romeinse vondsten: militaria, munten, aardewerk, bouwmateriaal. Het Museum voor de Bommelerwaard in Ammerzoden toont lokale vondsten. De naam Grinnes leeft niet voort in moderne plaatsnamen.",watWasHier:"Castellum aan de Waal. Vermeld op Peutingerkaart.",watTeZien:"Locatie opgegraven. Museum Bommelerwaard.",verwachteVondsten:"Militaria, munten, aardewerk, bouwmateriaal.",betekenis:"Verbinding antieke bronnen met archeologische locatie.",bronnen:[]},"Wachttoren Heumen":{naam:"Wachttoren Heumen",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren bij Heumen ten zuiden van Nijmegen. Onderdeel van het signaleringssysteem langs de Maas en verbindingswegen. De torens stonden op strategische punten met goed uitzicht. Bij nadering van vijanden werden signalen gegeven naar de grotere forten. Kleine bezetting van 4-8 soldaten die in de toren woonden. De exacte locatie is archeologisch vastgesteld. Vondsten: militaria, aardewerk, persoonlijke bezittingen.",watWasHier:"Signaleertoren met klein garnizoen. Uitzichtpunt.",watTeZien:"Locatie bekend maar geen zichtbare resten.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Onderdeel communicatienetwerk Romeins leger.",bronnen:[]},"Castellum Huissen?":{naam:"Castellum Huissen",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Huissen aan de Rijn. Het bestaan is niet zeker vastgesteld, vandaar het vraagteken. Huissen ligt op een logische plek tussen de bekende forten bij Arnhem en Zevenaar. Vondsten in de omgeving wijzen op Romeinse activiteit. De moderne bebouwing maakt onderzoek lastig. Als er een fort was, bewaakte het de rivierroute en mogelijk een oversteekplaats.",watWasHier:"Mogelijk castellum aan de Rijn. Bestaan onzeker.",watTeZien:"Geen resten zichtbaar. Gebied bebouwd.",verwachteVondsten:"Romeinse vondsten die fortaanwezigheid zouden bevestigen.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Castellum Kessel-Lith":{naam:"Kessel-Lith",type:"castellum",periode:"3e - 4e eeuw n.Chr.",beschrijving:"Laat-Romeins castellum uit de 3e-4e eeuw bij Kessel-Lith aan de Maas. Gebouwd in een periode van Germaanse invallen toen de oude Limes niet meer te handhaven was. Dit type forten was compacter en zwaarder versterkt dan de vroege castella. De locatie bij een rivierovergang bleef strategisch. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Het fort toont de veranderde militaire strategie van het late Romeinse Rijk.",watWasHier:"Laat-Romeins fort, compacter en zwaarder versterkt.",watTeZien:"Locatie bekend, weinig zichtbaar.",verwachteVondsten:"Laat-Romeinse munten, gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont Romeinse aanpassing aan nieuwe dreigingen.",bronnen:[]},Carvo:{naam:"Carvo",latinNaam:"Carvo",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke Romeinse versterking nabij Kesteren in de Betuwe. De naam komt voor op de Peutingerkaart. Kesteren lag in het hart van het Bataafse stamgebied. De Bataven waren belangrijke bondgenoten van Rome en leverden beroemde cavalerie-eenheden. Een versterking hier zou zowel bescherming als controle bieden. De exacte locatie is niet vastgesteld. Vondsten in de regio tonen intensief Romeins-Bataafs contact: import-aardewerk, wapens, paardentuig.",watWasHier:"Vermoedelijke versterking in Bataafs kerngebied.",watTeZien:"Locatie onbekend.",verwachteVondsten:"Gemengd Romeins-Bataafse voorwerpen, paardentuig.",betekenis:"Zou Romeinse aanwezigheid in Bataafs gebied tonen.",bronnen:[]},Mannaricium:{naam:"Mannaricium",latinNaam:"Mannaricium",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Vermoedelijke locatie van het Romeinse castellum Mannaricium bij Maurik aan de Rijn. De naam komt voor op de Peutingerkaart. Het fort zou de rivierroute hebben bewaakt tussen Levefanum (Wijk bij Duurstede) en forten stroomopwaarts. De moderne plaats Maurik zou afgeleid kunnen zijn van Mannaricium. Bij bouwwerkzaamheden zijn Romeinse vondsten gedaan die op een fort wijzen. De exacte contouren zijn niet bekend.",watWasHier:"Vermoedelijk castellum aan de Rijn. Vermeld op Peutingerkaart.",watTeZien:"Geen zichtbare resten. Gebied bebouwd.",verwachteVondsten:"Militaria, aardewerk, munten bij bouwwerkzaamheden.",betekenis:"Mogelijke herkomst plaatsnaam Maurik.",bronnen:[]},Oostvoorne:{naam:"Castellum Oostvoorne",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de monding van de Waal en Maas, nu verdwenen in zee door kustafslag. Het fort bewaakte de zeeroute en beschermde tegen piraterij. De kust lag in de Romeinse tijd kilometers verder westwaarts. Door zeespiegelstijging en erosie is het fort in de golven verdwenen. Na stormen spoelen soms vondsten aan op de stranden van Voorne-Putten: munten, aardewerk, metalen voorwerpen. De Brittenburg bij Katwijk was een soortgelijk lot beschoren.",watWasHier:"Kustfort bij riviermonding. Bewaking zeeroute.",watTeZien:"Fort verdwenen in zee. Soms strandvondsten na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen op strand.",betekenis:"Toont voormalige kustlijn en Romeinse kustverdediging.",bronnen:[]},"Castellum Randwijk":{naam:"Castellum Randwijk",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Randwijk aan de Rijn in de Betuwe. Het bestaan en de exacte locatie zijn onzeker. De rivier heeft veel oude resten weggespoeld. Randwijk ligt tussen bekende fortlocaties wat een fort hier logisch zou maken. In de uiterwaarden zijn bij erosie Romeinse vondsten gedaan. Het dynamische rivierlandschap maakt onderzoek lastig maar kan ook vondsten blootleggen na hoog water.",watWasHier:"Mogelijk castellum. Bestaan en locatie onzeker.",watTeZien:"Geen zichtbare resten. Uiterwaarden.",verwachteVondsten:"Mogelijk vondsten na erosie of hoog water.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Versterking Scheveningseweg":{naam:"Minifort Scheveningseweg",type:"minifort",periode:"2e eeuw n.Chr.",beschrijving:"Vermoede locatie van een klein Romeins kustfort bij de Scheveningseweg in Den Haag, vergelijkbaar met het nabije Minifort Ockenburg. Dit type miniforten bewaakte de kust tegen piraten en Germaanse raids over zee. Ruimte voor 20-30 soldaten. De exacte locatie is niet vastgesteld maar vondsten in de omgeving suggereren Romeinse militaire aanwezigheid. Het zou aantonen dat de gehele Noordzeekust werd bewaakt, niet alleen de riviermonding.",watWasHier:"Vermoedelijk klein kustfort zoals Ockenburg. 20-30 soldaten.",watTeZien:"Locatie niet vastgesteld.",verwachteVondsten:"Militaria, aardewerk 2e eeuw indien locatie gevonden.",betekenis:"Zou Romeinse kustverdediging Den Haag bevestigen.",bronnen:[]},"Tongeren - Sacramentstraat":{naam:"Atuatuca Tungrorum",latinNaam:"Atuatuca Tungrorum / Municipium Tungrorum",type:"legerkamp",periode:"ca. 10 v.Chr. - 400 n.Chr.",beschrijving:"Oudste stad van Belgi, gesticht ca. 10 v.Chr. Hoofdstad van de Civitas Tungrorum - met 150 hectare de grootste civitas van Noordwest-Europa! Strategisch gelegen op de weg Boulogne-Bavay-Keulen. Onder keizer Trajanus (2e eeuw) ommuurd met meer dan 4,5 km muren en tot 3 grachten - waarvan nog 1,5 km staat! Een 1e-eeuwse buste van Julius Caesar is een topstuk. Het Gallo-Romeins Museum (Europees Museum van het Jaar 2011) toont een schat aan vondsten: beelden, steles, sieraden, architectuurelementen. Ook de Romeinse muren, het tempelcomplex, het aquaduct van Beukenberg en tumuli zijn te bezoeken.",watWasHier:"Civitas-hoofdstad Tungri (150 ha). 4,5 km stadsmuur. Politiek en religieus centrum.",watTeZien:"Gallo-Romeins Museum. Romeinse muren (1,5 km). Tempelcomplex. Aquaduct Beukenberg. Tumuli.",verwachteVondsten:"Stadsaardewerk, bouwmateriaal, munten, inscripties, religieuze objecten.",betekenis:"Oudste stad van Belgi. Grootste civitas van Noordwest-Europa.",bronnen:["https://www.galloromeinsmuseum.be","https://www.canonvanvlaanderen.be/en/events/tongeren-a-roman-town/"]},"Valkenburg-Marktveld, mini-castellum":{naam:"Marktveld Valkenburg",type:"minifort",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Klein Romeins castellum met wachttoren bij het Marktveld in Valkenburg (Zuid-Holland), nabij het grotere Praetorium Agrippinae. Dit type miniforten vulde de ruimtes tussen de grote castella op. Wachttoren voor signalering en kleine bezetting voor patrouilles. De combinatie van toren en klein fort was effectief voor grensbewaking. Bij opgravingen zijn de contouren vastgesteld. Vondsten in Archeologisch Steunpunt Valkenburg.",watWasHier:"Klein fort met wachttoren. Aanvulling op Praetorium Agrippinae.",watTeZien:"Archeologisch Steunpunt Valkenburg.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Toont gelaagdheid Romeinse grensverdediging.",bronnen:[]},"Wachttoren a":{naam:"Wachttoren Utrecht-West",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Een van meerdere Romeinse wachttorens in de omgeving van Utrecht, onderdeel van het signaleringssysteem langs de Limes. De torens stonden om de 1-2 kilometer met zicht op elkaar. Bij nadering van vijanden werden vuur- of rooksignalen gegeven. Binnen minuten kon de hele grens gewaarschuwd zijn. Kleine houten constructie op aarden verhoging met bezetting van 4-8 soldaten. Vondsten zijn schaars door de kleine schaal.",watWasHier:"Houten signaleertoren. 4-8 soldaten.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Kleine hoeveelheden aardewerk en militaria.",betekenis:"Onderdeel vroegwaarschuwingssysteem.",bronnen:[]},"Wachttoren b":{naam:"Wachttoren Utrecht-Oost",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren ten oosten van Utrecht, onderdeel van de keten signaleertorens langs de Rijn. Elke toren had zichtlijn naar de volgende. Dit systeem maakte snelle communicatie mogelijk in een tijd zonder telegraaf of telefoon. De soldaten woonden in of bij de toren en hielden permanent wacht. Bij gevaar werden brandende fakkels of rookpotten gebruikt. De locatie is archeologisch vastgesteld maar niet zichtbaar.",watWasHier:"Signaleertoren in torenketen. Permanente wacht.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, militaria, persoonlijke bezittingen.",betekenis:"Onderdeel communicatienetwerk Limes.",bronnen:[]},"Wachttoren c":{naam:"Wachttoren Hoge Woerd",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren nabij Castellum Op de Hoge Woerd, onderdeel van het signaleringssysteem. Torens bij forten dienden als vooruitgeschoven posten en waarschuwingsplaatsen. De combinatie van fort met omringende torens was de standaard Romeinse grensverdediging. Het Archeologisch Park Hoge Woerd geeft een goed beeld van hoe dit systeem functioneerde. De toren zelf is niet gereconstrueerd maar de context is te begrijpen.",watWasHier:"Signaleertoren bij castellum. Vooruitgeschoven post.",watTeZien:"Archeologisch Park Hoge Woerd toont context.",verwachteVondsten:"Aardewerk, militaria.",betekenis:"Toont samenhang fort en torens.",bronnen:[]},"Zwammerdam-Rijksstraatweg":{naam:"Zwammerdam-Rijksstraatweg",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke militaire nederzetting aan de Rijksstraatweg in Zwammerdam, naast het bekende Nigrum Pullum fort. Mogelijk een vicus (burgerdorp) of aparte militaire faciliteit. Bij Zwammerdam werden de beroemde Romeinse schepen gevonden. De hele zone langs de Oude Rijn was dicht bezet met militaire en civiele structuren. Vondsten wijzen op intensieve Romeinse activiteit: aardewerk, munten, militaria en door de natte veenbodem ook organisch materiaal.",watWasHier:"Mogelijk vicus of militaire faciliteit nabij Nigrum Pullum.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, munten, militaria, organisch materiaal.",betekenis:"Toont dichtheid Romeinse bewoning langs Oude Rijn.",bronnen:[]},"Kastell Aachen":{naam:"Aquae Granni",latinNaam:"Aquae Granni",type:"versterking",periode:"1e - 4e eeuw n.Chr.",beschrijving:'Romeinse kuuroord bij de hete bronnen (tot 75C!) gewijd aan Apollo en de Keltische geneesheer Grannos - "aan de wateren van Grannos". In de 1e eeuw uitgebouwd tot kurort voor de legioenen van Neder-Germani. Onder keizer Trajanus bouwden legioenen uit Xanten een aquaduct en thermen onder de huidige Dom. De Mnsterthermen hadden de indeling van een valetudinarium (Romeins hospitaal). Karel de Grote bouwde hier zijn Pfalz (793-813) en maakte Aken tot keizerlijke residentie - bewust als "vernieuwer van het Romeinse Rijk". De Dom (UNESCO 1978, eerste in Duitsland!) staat op Romeinse fundamenten. Karel stierf hier in 814.',watWasHier:"Kurort voor legioenen. Thermen. Later keizerlijke Pfalz van Karel de Grote.",watTeZien:"Dom (UNESCO). Centre Charlemagne. Thermen onder de stad.",verwachteVondsten:"Badhuisresten, inscripties, munten, Romeins en Karolingisch bouwmateriaal.",betekenis:"Ononderbroken bewoning van Romeinse tijd tot Karel de Grote. Eerste UNESCO-site Duitsland.",bronnen:["https://centre-charlemagne.eu/zeitreise/?lang=en","http://www.aquaegranni.de/","https://de.wikipedia.org/wiki/Aquae_Granni"]},Hazerswoude:{naam:"Hazerswoude-Rijndijk",type:"wachttoren",periode:"2e - 3e eeuw n.Chr.",beschrijving:"Bevestigde Romeinse wachtpost langs de Limesweg bij Hazerswoude-Rijndijk. Bij opgravingen in 2021-2023 door Vestigia BV en het Rijksmuseum van Oudheden zijn spectaculaire vondsten gedaan: resten van de houten Limesweg (eiken palen uit 124-125 n.Chr.), een Romeinse dam, en aanwijzingen voor een kleine wachtpost. Bijzondere vondsten: de eerste Romeinse mijlpaal in Nederland (2023), een muntschat met 22 zilveren munten (na 166 n.Chr.), aardewerk, mantelspelden, leren schoenzolen en ca. 40.000-50.000 objecten. De locatie ligt precies tussen Albaniana (Alphen) en Matilo (Leiden).",watWasHier:"Wachtpost langs de Limesweg. Houten wegdek uit 124-125 n.Chr.",watTeZien:"Opgravingen afgerond. Vondsten naar Rijksmuseum van Oudheden.",verwachteVondsten:"Militaria, munten, aardewerk. Gebied grotendeels onderzocht.",betekenis:"Eerste Romeinse mijlpaal in Nederland. Bevestigt trac Limesweg.",bronnen:["https://www.rmo.nl/onderzoek/opgravingsprojecten/hazerswoude/","https://www.vestigia.nl/opgraving-hazerswoude-in-samenwerking-met-het-rijksmuseum-van-oudheden-en-de-gemeente-alphen-aan-den-rijn/","https://romeinsalphen.nl/themas/romeinse-weg-hazerswoude-rijndijk"]},Albaniana:{naam:"Albaniana",latinNaam:"Albaniana",type:"castellum",periode:"41 - 275 n.Chr.",beschrijving:"Groot Romeins castellum bij Alphen aan den Rijn, een van de belangrijkste forten aan de Nederlandse Limes. Het fort werd gesticht in 41-42 n.Chr., kort na de dood van keizer Caligula. De locatie is nauwkeurig bekend: bij het Rijnplein en Theater Castellum aan de Castellumstraat. Het fort (80x120m) was beschermd door een omgrachte aarden wal. Bij opgravingen tussen 1950 en 2002 zijn uitgebreide resten gevonden. Door de natte bodem zijn veel houten structuren bewaard gebleven. Een bronzen maquette van het castellum staat op het Rijnplein.",watWasHier:"Castellum met vicus. Locatie bekend: Rijnplein/Castellumstraat.",watTeZien:"Bronzen maquette Rijnplein. Theater Castellum op fortlocatie. Archeon.",verwachteVondsten:"Munten, militaria, aardewerk, dakpannen, fibulae. Veel bij bouwwerkzaamheden.",betekenis:"Een van de hoofdforten aan de Limes. UNESCO Werelderfgoed.",bronnen:["https://www.hierisalphen.nl/home/ontdekken/romeinse-limes","https://www.romeinen.nl/weten/nederland-in-de-romeinse-tijd/zuid-holland/alphen-aan-den-rijn","https://archeologiehuiszuidholland.nl/zien-en-doen/het-archeologiehuis/fort-aan-de-rijn"]}},bTe={naam:"Romeins fort",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse militaire versterking langs de Limes, de noordgrens van het Romeinse Rijk. Forten lagen om de 10-15 km langs de Rijn. Garnizoen van hulptroepen (auxilia) die de grens bewaakten tegen Germaanse invallen. Standaard rechthoekige plattegrond met houten of stenen muur, gracht, poorten en binnengebouwen (barakken, commandopost, graanopslagplaats, werkplaatsen). Buiten de muren vaak een vicus (burgerdorp) met handelaren en soldatenfamilies. Vondsten: munten, fibulae (mantelspelden), aardewerk, wapens, gereedschap. Onderdeel van UNESCO Werelderfgoed sinds 2021."},RTe={castellum:"Castellum (legerplaats)",wachttoren:"Wachttoren (signaalpost)",vlootbasis:"Vlootbasis (haven)",legerkamp:"Legerkamp (castra)",minifort:"Minifort (wachtpost)",versterking:"Versterking",villa:"Villa (militair gebruikt)"};bn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");function pD(n){if(!n)return n;const e={Mo:"ma",Tu:"di",We:"wo",Th:"do",Fr:"vr",Sa:"za",Su:"zo",Mon:"ma",Tue:"di",Wed:"wo",Thu:"do",Fri:"vr",Sat:"za",Sun:"zo",PH:"feestdagen",SH:"schoolvakantie"};let t=n;return Object.entries(e).forEach(([r,i])=>{t=t.replace(new RegExp(`\\b${r}\\b`,"gi"),i)}),t=t.replace(/\boff\b/gi,"gesloten").replace(/\bclosed\b/gi,"gesloten").replace(/\bopen\b/gi,"open"),t}async function ATe(n){try{const e=Tn(n),t=bn("EPSG:4326","EPSG:28992",e);if(t[0]<7e3||t[0]>3e5||t[1]<289e3||t[1]>629e3)return null;const r=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${t[0]-r},${t[1]-r},${t[0]+r},${t[1]+r}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,o=await(await fetch(s)).json();if(o.features&&o.features.length>0){const l=o.features[0].properties,c=l?.value_list??l?.GRAY_INDEX??l?.value??l?.gray_index;if(c!=null){const h=typeof c=="number"?c:parseFloat(c);if(!isNaN(h))return h}}}catch(e){console.warn("AHN height query failed:",e)}return null}const kTe={ABG:"Alphen-Chaam",ACM:"Alkmaar",ALF:"Alfen",ALK:"Alkemade",AML:"Ameland",AMR:"Amerongen",AMS:"Amsterdam",ANL:"Anloo",APD:"Apeldoorn",ARN:"Arnhem",ASN:"Assen",AVW:"Avenhorn",BDA:"Breda",BLK:"Blokker",BRN:"Barneveld",DEL:"Delft",DHG:"Den Haag",DRD:"Dordrecht",EHV:"Eindhoven",EMN:"Emmen",EPE:"Epe",GNP:"Gennep",GRN:"Groningen",GRV:"Grave",GTB:"Giethoorn",HDK:"Harderwijk",HLM:"Haarlem",HLN:"Heiloo",HRL:"Harlingen",HTN:"Houten",LDN:"Leiden",LWR:"Leeuwarden",MST:"Maastricht",NKK:"Nijkerk",NMG:"Nijmegen",OTM:"Ootmarsum",RTD:"Rotterdam",SND:"Sneek",TBG:"Tilburg",UTR:"Utrecht",VLO:"Venlo",WGN:"Wageningen",ZWL:"Zwolle",ZTP:"Zutphen",444:"Houten",811:"Gouda",310:"Utrecht",344:"Amsterdam",363:"Rotterdam",518:"Den Haag",758:"Eindhoven",772:"Tilburg",855:"Breda",85:"Arnhem",268:"Nijmegen",14:"Groningen",80:"Leeuwarden",995:"Maastricht",106:"Enschede",153:"Zwolle",34:"Almere"},ITe={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function xD(n,e){const t=[],r=n.toLowerCase(),i=(e||"").toLowerCase();return r.includes("kalkhoudend")||i.endsWith("a")?t.push("Kalkhoudend = goede metaalconservering"):(r.includes("kalkarm")||r.includes("kalkloos"))&&t.push("Kalkarm = meer corrosie op metalen"),r.includes("poldervaag")?t.push("Poldervaaggrond = jonge rivierklei, ingepolderd gebied"):r.includes("enkeerdgrond")||r.includes("enk")?t.push("Enkeerdgrond = oude akkers met plaggenbemesting - archeologisch interessant!"):r.includes("podzol")?t.push("Podzolgrond = uitgeloogde zandgrond, vaak zuur"):(r.includes("veengrond")||r.includes("veen"))&&t.push("Veengrond = zuur, slechte metaalconservering (tenzij waterverzadigd)"),r.includes("zware klei")?t.push("Zware klei = moeilijk graven, goede conservering"):r.includes("lichte klei")||r.includes("zavel")?t.push("Zavel/lichte klei = redelijk te graven"):r.includes("zand")&&!r.includes("zavel")&&t.push("Zandgrond = makkelijk graven"),r.includes("rivierklei")||i.startsWith("r")?t.push("Rivierafzetting"):(r.includes("zeeklei")||i.startsWith("m"))&&t.push("Zeekleiafzetting"),t}function CTe(){const n=pi(_t=>_t.map),e=hl(_t=>_t.removeVondst),t=hl(_t=>_t.updateVondst),r=hl(_t=>_t.vondsten),{layers:i,addPoint:s,addLayer:a}=fs(),[o,l]=H.useState([]),[c,h]=H.useState(0),[g,m]=H.useState(!1),[x,y]=H.useState(null),[_,w]=H.useState(!1),[T,b]=H.useState(!1),[R,M]=H.useState(null),[D,B]=H.useState(null),[k,A]=H.useState(null),[C,O]=H.useState(null),[P,z]=H.useState(!1),[F,xe]=H.useState(null),[Ce,Ge]=H.useState(null),[Ne,ue]=H.useState(null),[ke,ae]=H.useState(!1),[Z,V]=H.useState(""),[Q,ee]=H.useState([]),re=Q[c]||null,[he,Ve]=H.useState(()=>{const _t=localStorage.getItem("popupTextScale");return _t?parseInt(_t):100}),[Be,ye]=H.useState("half"),pe=_t=>{Ve(_t),localStorage.setItem("popupTextScale",_t.toString())},Fe=o[c]||"",Et=o.length>1,Ft=_t=>{const xn=_t.match(/<strong[^>]*>(.*?)<\/strong>/);if(xn){const An=xn[1].replace(/<[^>]+>/g,""),Tt=_t.replace(xn[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:An,contentWithoutTitle:Tt}}return{title:"",contentWithoutTitle:_t}},Dt=_t=>_t.replace(/class="([^"]*)"/g,(An,Tt)=>{if(Tt.includes("text-xs")){const an=Tt.replace(/\btext-xs\b/g,"").trim();return an?`style="font-size:0.857em" class="${an}"`:'style="font-size:0.857em"'}if(Tt.includes("text-sm")){const an=Tt.replace(/\btext-sm\b/g,"").trim();return an?`class="${an}"`:""}return An}).replace(/class=""/g,""),{title:Xt,contentWithoutTitle:en}=Ft(Fe),ot=Dt(en),tr=Fe.includes("Landbouwperceel"),dn=Fe.includes("data-vondst-id="),un=()=>{h(_t=>(_t-1+o.length)%o.length)},sr=()=>{h(_t=>(_t+1)%o.length)},Mi=async()=>{if(console.log(" HOOGTEKAART KNOP GEKLIKT"),console.log(" parcelCoordinate uit state:",x),!n||!x||T){console.log(" STOP - map:",!!n,"coord:",x,"loading:",T);return}console.log(` DOORGEVEN AAN showParcelHeightMap: [${x[0]}, ${x[1]}]`),b(!0);try{await Lxe(n,x)&&w(!0)}catch(_t){console.error("Failed to load height map:",_t)}finally{b(!1)}},Bn=()=>{n&&(YR(n),w(!1))};H.useEffect(()=>{if(!n)return;const _t=Tt=>{let an='<strong class="text-purple-800">AMK Monument</strong>';if(Tt.toponiem&&(an+=`<br/><span class="text-sm font-semibold">${Tt.toponiem}</span>`),Tt.kwaliteitswaarde&&(an+=`<br/><span class="text-sm text-purple-700">${Tt.kwaliteitswaarde}</span>`),Tt.omschrijving&&(an+=`<br/><span class="text-xs text-gray-600 mt-1 block">${Tt.omschrijving}</span>`),Tt.txt_label){const Mt=Tt.txt_label.split(", ").slice(0,3).join(", ");an+=`<br/><span class="text-xs text-gray-500 italic">${Mt}${Tt.txt_label.split(", ").length>3?"...":""}</span>`}return an},xn=async(Tt,an)=>{const Mt=[],Zi=n.getLayers().getArray().filter(Mr=>Mr instanceof Rh&&Mr.getVisible()?Mr.getSource()instanceof QX:!1);for(const Mr of Zi){const li=Mr.getSource();if(!li)continue;const rn=Mr.get("title")||"";if(rn.startsWith("Paleokaart"))continue;if(rn==="Archeo Landschappen"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=100,L=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties,Pe=ie.landschapsnaam||ie.naam||"Archeologisch Landschap",q=ie.omschrijving||"";let ce=`<strong class="text-green-800">${Pe}</strong>`;q&&(ce+=`<br/><span class="text-sm text-gray-600">${q}</span>`),ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ce+='<div class="text-sm text-gray-700 mt-1">Een archeologisch landschap is een gebied waar het landschap nog sporen draagt van menselijke activiteit uit het verleden. Denk aan oude akkers, nederzettingen of verdedigingswerken.</div>',ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ce+='<div class="text-sm text-gray-700 mt-1">Aardewerk, munten, gereedschap en andere voorwerpen van vroegere bewoners. De kans op vondsten hangt af van het type landschap.</div>',ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',ce+='<div class="text-sm text-gray-700 mt-1"><a href="https://www.cultureelerfgoed.nl/onderwerpen/bronnen-en-kaarten/overzicht/landschappenkaart" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Landschappenkaart</a></div>',ce+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Landschapstypen_van_Nederland" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Landschapstypen</a></div>',Mt.push(ce)}}catch(je){console.warn("Archeo Landschappen WMS query failed:",je)}continue}if(rn==="Essen"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=100,L=`https://services.rce.geovoorziening.nl/landschapsatlas/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=essen&QUERY_LAYERS=essen&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties;let Pe='<strong class="text-amber-800">Es (historisch akkercomplex)</strong>';(ie.naam||ie.Naam||ie.NAME)&&(Pe+=`<br/><span class="text-sm font-semibold text-amber-700">${ie.naam||ie.Naam||ie.NAME}</span>`),(ie.type||ie.Type||ie.TYPE)&&(Pe+=`<br/><span class="text-xs text-gray-600">${ie.type||ie.Type||ie.TYPE}</span>`),(ie.omschrijving||ie.Omschrijving)&&(Pe+=`<br/><span class="text-xs text-gray-500">${ie.omschrijving||ie.Omschrijving}</span>`),Pe+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is een es?</span></div>',Pe+='<div class="text-sm text-gray-700 mt-1">Een es is een oud akkercomplex op hogere zandgronden. Eeuwenlang werden hier gewassen verbouwd. De bodem werd bemest met plaggen en mest, waardoor de grond donker en vruchtbaar werd.</div>',Pe+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Pe+='<div class="text-sm text-gray-700 mt-1">Munten, gespen, knopen, aardewerk en soms bijzondere voorwerpen die door bemesting op het land terechtkwamen. Essen behoren tot de beste vindplaatsen voor metaaldetectie.</div>',Pe+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Conservering</span></div>',Pe+='<div class="text-sm text-gray-700 mt-1 italic">De zure zandgrond tast metaal aan. IJzer en koper zijn vaak slecht bewaard. Zilver en brons houden zich beter.</div>',Pe+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Pe+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Es_(geografie)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Es (geografie)</a></div>',Mt.push(Pe)}}catch(je){console.warn("Essen WMS query failed:",je)}continue}if(rn==="FAMKE Steentijd"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=`https://geoportaal.fryslan.nl/arcgis/rest/services/Themas/cultuurhistorie/MapServer/2/query?geometry=${_e[0]},${_e[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=BESCHR,BESCHRTOELICHTING,BESCHRLINK&returnGeometry=false&f=json`,L=await(await fetch(ve)).json();if(L.features&&L.features.length>0){const ut=L.features[0].attributes;let W='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';W+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart</span>';const ie=ut.BESCHR||"";ie&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Advies</span></div>',W+=`<div class="text-sm text-amber-700 mt-1 font-medium">${ie}</div>`);const Pe=ut.BESCHRTOELICHTING||"";Pe&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Toelichting</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Pe}</div>`);const q=ut.BESCHRLINK||"";q&&(W+=`<div class="mt-3"><a href="${q}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:underline">Meer informatie</a></div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de steentijd en bronstijd te verwachten zijn.</div>',Mt.push(W)}}catch(je){console.warn("FAMKE Steentijd query failed:",je)}continue}if(rn==="FAMKE IJzertijd"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=`https://geoportaal.fryslan.nl/arcgis/rest/services/Themas/cultuurhistorie/MapServer/1/query?geometry=${_e[0]},${_e[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=BESCHR,BESCHRTOELICHTING,BESCHRLINK&returnGeometry=false&f=json`,L=await(await fetch(ve)).json();if(L.features&&L.features.length>0){const ut=L.features[0].attributes;let W='<strong class="text-orange-800">FAMKE IJzertijd-Middeleeuwen</strong>';W+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart</span>';const ie=ut.BESCHR||"";ie&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Advies</span></div>',W+=`<div class="text-sm text-orange-700 mt-1 font-medium">${ie}</div>`);const Pe=ut.BESCHRTOELICHTING||"";Pe&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Toelichting</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Pe}</div>`);const q=ut.BESCHRLINK||"";q&&(W+=`<div class="mt-3"><a href="${q}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:underline">Meer informatie</a></div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de ijzertijd tot en met de middeleeuwen te verwachten zijn.</div>',Mt.push(W)}}catch(je){console.warn("FAMKE IJzertijd query failed:",je)}continue}if(rn==="Archeo Onderzoeken"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=100,L=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}&FEATURE_COUNT=20`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0)for(const ie of W.features){const Pe=ie.properties,q=Pe.type_onderzoek||"",ce=Pe.projectnaam||Pe.project_naam||Pe.naam||"",Re=ce&&ce!=="-"&&ce.trim()!==""&&!/^\d+$/.test(ce.trim())?ce:"",ze=Pe.gemeente||"",Me=Pe.uitvoerder||"",He=Pe.onderzoeksmeldingnummer||"",$e=Pe.adres||Pe.straat||"";let xt="Archeologisch Onderzoek";Re?xt=Re:ze&&$e?xt=`${ze} - ${$e}`:ze&&(xt=`Onderzoek ${ze}`);let Rt=`<strong class="text-blue-800">${xt}</strong>`;if(q&&(Rt+=`<br/><span class="text-sm font-semibold text-blue-700">${q}</span>`),ze&&!xt.includes(ze)&&(Rt+=`<br/><span class="text-sm text-gray-700">${ze}</span>`),$e&&!xt.includes($e)&&(Rt+=`<br/><span class="text-sm text-gray-600">${$e}</span>`),He&&(Rt+=`<br/><span class="text-xs text-gray-500 font-mono">OM: ${He}</span>`),Me&&(Rt+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${Me}</span>`),Pe.startdatum||Pe.einddatum){const J=[Pe.startdatum,Pe.einddatum].filter(Boolean).join(" - ");Rt+=`<br/><span class="text-xs text-gray-600">Periode: ${J}</span>`}const Ht=[];Pe.periode_paleolithicum&&Ht.push("Paleolithicum"),Pe.periode_mesolithicum&&Ht.push("Mesolithicum"),Pe.periode_neolithicum&&Ht.push("Neolithicum"),Pe.periode_bronstijd&&Ht.push("Bronstijd"),Pe.periode_ijzertijd&&Ht.push("IJzertijd"),Pe.periode_romeins&&Ht.push("Romeins"),Pe.periode_middeleeuwen&&Ht.push("Middeleeuwen"),Pe.periode_nieuwe_tijd&&Ht.push("Nieuwe tijd"),Ht.length>0&&(Rt+=`<br/><span class="text-sm text-purple-700">Datering: ${Ht.join(", ")}</span>`),Rt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',q.toLowerCase().includes("opgraving")?Rt+='<div class="text-sm text-gray-700 mt-1">Hier is een archeologische opgraving gedaan. Professionele archeologen hebben vondsten en sporen gedocumenteerd en geborgen.</div>':q.toLowerCase().includes("bureauonderzoek")?Rt+='<div class="text-sm text-gray-700 mt-1">Een bureauonderzoek naar de archeologische verwachting op basis van historische bronnen en kaarten.</div>':q.toLowerCase().includes("booronderzoek")?Rt+='<div class="text-sm text-gray-700 mt-1">Met boringen is onderzocht wat er in de grond zit. Vaak de eerste stap om te bepalen of er verder onderzoek nodig is.</div>':q.toLowerCase().includes("proefsleuven")?Rt+='<div class="text-sm text-gray-700 mt-1">Proefsleuven zijn gegraven om te kijken of er archeologische sporen in de grond zitten.</div>':q.toLowerCase().includes("begeleiding")?Rt+='<div class="text-sm text-gray-700 mt-1">Archeologische begeleiding bij graafwerk. Een archeoloog was aanwezig om te controleren of er vondsten naar boven kwamen.</div>':q.toLowerCase().includes("inventariserend")||q.toLowerCase().includes("karterend")?Rt+='<div class="text-sm text-gray-700 mt-1">Verkennend onderzoek om te bepalen of er archeologische resten in de grond kunnen zitten.</div>':Rt+='<div class="text-sm text-gray-700 mt-1">Op deze locatie is archeologisch onderzoek uitgevoerd. De resultaten zijn opgeslagen in het landelijke archief.</div>',Rt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Interessant voor detectie?</span></div>',Rt+='<div class="text-sm text-gray-700 mt-1 italic">Onderzoekslocaties kunnen interessant zijn: archeologen vinden vaak niet alles. Maar check altijd eerst of je daar mag zoeken.</div>',Rt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Rapport opzoeken</span></div>';let G="";if(Re?G=Re:Me&&ze?G=`${Me} ${ze}`:ze&&(G=ze),G){const J=G.length>35?G.substring(0,35)+"...":G;Rt+=`<div class="text-sm text-gray-700 mt-1"><a href="https://archaeology.datastations.nl/dataverse/root?q=${encodeURIComponent(G)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek "${J}" in DANS</a></div>`,Rt+=`<div class="text-sm text-gray-700 mt-1"><a href="https://scholar.google.nl/scholar?q=${encodeURIComponent(G+" archeologisch rapport")}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek in Google Scholar</a></div>`}He&&(Rt+=`<div class="text-sm text-gray-700 mt-1"><a href="https://archis.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek OM ${He} in ARCHIS</a> <span class="text-xs text-gray-400">(account nodig)</span></div>`),Mt.push(Rt)}}catch(je){console.warn("Archeo Onderzoeken WMS query failed:",je)}continue}if(rn==="IKAW"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=500,L=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties,Pe=Math.round(ie.PALETTE_INDEX||ie.palette_index||0),q=ITe[Pe]||`Trefkans onbekend (${Pe})`;let ce='<strong class="text-orange-800">IKAW Verwachtingskaart</strong>';ce+='<br/><span class="text-sm text-gray-500">Kaart met kansen op archeologische vondsten</span>',ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',ce+=`<div class="text-sm text-orange-700 mt-1">${q}</div>`;const ze={1:{tekst:"De kans op archeologische vondsten is hier zeer klein. De grond is waarschijnlijk verstoord of te jong.",vondsten:"Niet veel te verwachten, maar verrassingen zijn altijd mogelijk.",kleur:"text-gray-600"},2:{tekst:"De kans op vondsten is laag, maar niet uitgesloten. Soms worden hier toch interessante objecten gevonden.",vondsten:"Af en toe losse vondsten uit verschillende periodes.",kleur:"text-yellow-600"},3:{tekst:"Dit is een interessant gebied met een redelijke kans op vondsten. Hier woonden of werkten mensen in het verleden.",vondsten:"Aardewerk, munten, metalen voorwerpen uit verschillende tijdperken.",kleur:"text-amber-600"},4:{tekst:"Dit is een zeer kansrijk gebied! Hier zijn waarschijnlijk resten van oude bewoning of activiteit. Let op: bij graafwerk kan een vergunning nodig zijn.",vondsten:"Grote kans op interessante vondsten: aardewerk, munten, sieraden, gereedschap.",kleur:"text-orange-600"},5:{tekst:"Dit is een waterbodem. Vondsten zijn hier moeilijker te bereiken maar kunnen goed bewaard zijn gebleven.",vondsten:"Scheepswrakken, verloren lading, gedumpte voorwerpen.",kleur:"text-blue-600"},6:{tekst:"Waterbodem met archeologische potentie. Hier kunnen interessante vondsten liggen die door het water goed bewaard zijn.",vondsten:"Scheepsresten, ankers, aardewerk, metalen voorwerpen.",kleur:"text-blue-600"},7:{tekst:"Waterbodem met hoge archeologische waarde. Hier zijn bekende vindplaatsen of scheepswrakken.",vondsten:"Belangrijke maritieme vondsten, beschermd gebied.",kleur:"text-blue-700"}}[Pe];ze&&(ce+=`<div class="text-sm ${ze.kleur} mt-1">${ze.tekst}</div>`,ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ce+=`<div class="text-sm text-gray-700 mt-1">${ze.vondsten}</div>`),ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de IKAW?</span></div>',ce+='<div class="text-sm text-gray-700 mt-1">De IKAW (Indicatieve Kaart Archeologische Waarden) toont de kans op archeologische vondsten in heel Nederland. De kaart is gemaakt door de Rijksdienst voor het Cultureel Erfgoed.</div>',Mt.push(ce)}}catch(je){console.warn("IKAW WMS query failed:",je)}continue}if(rn==="Inundatiegebieden"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=100,L=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties;let Pe='<strong class="text-blue-800">Inundatiegebied</strong>';(ie["linie-naam"]||ie.linie_naam)&&(Pe+=`<br/><span class="text-sm font-semibold text-blue-700">${ie["linie-naam"]||ie.linie_naam}</span>`),ie.naam&&(Pe+=`<br/><span class="text-sm text-gray-700">${ie.naam}</span>`),ie.periode&&(Pe+=`<br/><span class="text-xs text-gray-500">${ie.periode}</span>`),ie.lin_period&&(Pe+=`<br/><span class="text-xs text-gray-400">${ie.lin_period}</span>`),Mt.push(Pe)}}catch(je){console.warn("Inundatiegebieden WMS query failed:",je)}continue}if(rn==="Militaire Objecten"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=50,L=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties,Pe=ie.obj_soort||"",q=ie.obj_naam||"",ce=ie.lin_period||"",Re=ie["linie-naam"]||ie.linie_naam||"";let ze=Pe||"Militair Object",Me="Dit is een historisch militair object uit de Nederlandse verdedigingsgeschiedenis.",He="";const $e=Pe.toLowerCase();$e.includes("fort")?(Me="Een fort is een versterkte verdedigingspost, vaak met dikke muren en geschutsopstellingen. Forten maakten deel uit van grotere verdedigingslinies.",He="Rond forten worden soms kogels, knopen van uniformen, muntjes of andere militaire voorwerpen gevonden."):$e.includes("schans")?(Me="Een schans is een kleinere versterking, vaak gemaakt van aarde en palissaden. Schansen werden gebruikt om strategische punten te verdedigen.",He="Bij schansen kun je musketkogels, knopen en soms munten uit de 17e-18e eeuw tegenkomen."):$e.includes("batterij")||$e.includes("battery")?(Me="Een batterij is een geschutsopstelling, vaak op een strategische plek om vijanden onder vuur te nemen.",He="Bij batterijen worden soms kanonkogels of onderdelen van geschut gevonden."):$e.includes("bunker")||$e.includes("kazemat")?(Me="Een bunker of kazemat is een versterkte betonnen schuilplaats. Veel werden gebouwd rond 1940 als onderdeel van verdedigingslinies.",He="Bij bunkers worden soms militaire voorwerpen uit WOII gevonden, zoals knopen, gespen of munitieresten."):$e.includes("sluis")||$e.includes("inlaatwerk")?(Me="Militaire sluizen en inlaatwerken werden gebruikt om land onder water te zetten (inunderen). Dit was een belangrijke verdedigingstactiek.",He="Bij historische sluizen worden soms voorwerpen gevonden van soldaten die deze bewaakten."):$e.includes("toren")||$e.includes("wachttoren")?(Me="Wachttorens werden gebruikt om de omgeving in de gaten te houden en vijandelijke bewegingen te signaleren.",He="Bij torens worden soms persoonlijke voorwerpen van soldaten gevonden."):$e.includes("kazerne")&&(Me="Een kazerne is een gebouw waar soldaten gelegerd waren. Hier woonden, aten en oefenden de troepen.",He="Rond kazernes worden regelmatig knopen, gespen en andere persoonlijke voorwerpen gevonden.");let xt=`<strong class="text-stone-800">${ze}</strong>`;q&&(xt+=`<br/><span class="text-sm font-semibold text-stone-700">${q}</span>`),Re&&(xt+=`<br/><span class="text-sm text-blue-600">${Re}</span>`),ce&&(xt+=`<br/><span class="text-xs text-gray-500">${ce}</span>`),xt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',xt+=`<div class="text-sm text-gray-700 mt-1">${Me}</div>`,He&&(xt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',xt+=`<div class="text-sm text-gray-700 mt-1">${He}</div>`),xt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',xt+='<div class="text-sm text-gray-700 mt-1">',xt+='<a href="https://erfgoedenlocatie.nl/linies-en-stellingen" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Linies en Stellingen</a>',xt+="</div>",Mt.push(xt)}}catch(je){console.warn("Militaire Objecten WMS query failed:",je)}continue}if(rn==="Verdedigingslinies"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=100,L=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties;let Pe='<strong class="text-amber-800">Verdedigingslinie</strong>';const q={"Hollandse Waterlinie":"Verdedigingsstelsel (1815-1940) dat gebruik maakte van inundaties om Holland te beschermen. UNESCO Werelderfgoed.","Nieuwe Hollandse Waterlinie":"Uitgebreide versie (1815-1940) met forten en inundatiegebieden van Muiden tot Gorinchem.","Stelling van Amsterdam":"Ringverdediging rond Amsterdam (1880-1920) met 42 forten. UNESCO Werelderfgoed.",Grebbelinie:"Verdedigingslinie langs de Grebbe (17e-20e eeuw). Zware gevechten in mei 1940.",IJssellinie:"Koude Oorlog verdediging (1950-1968) langs de IJssel tegen Sovjet-invasie.",Atlantikwall:"Duitse kustverdediging WOII (1942-1945) van Noorwegen tot Spanje.","Peel-Raamstelling":"Verdedigingslinie in Brabant/Limburg. Gevechten mei 1940.","Maas-Waalstelling":"Linie tussen Maas en Waal, onderdeel landsverdediging.",Zuiderwaterlinie:"Waterlinie in West-Brabant en Zeeland (17e-19e eeuw).","Staats-Spaanse Linies":"Vestingwerken uit de 80-jarige oorlog (1568-1648)."},ce=ie.naam||ie.lin_naam||"";if(ce){Pe+=`<br/><span class="text-sm font-semibold text-amber-700">${ce}</span>`;const Re=Object.entries(q).find(([ze])=>ce.toLowerCase().includes(ze.toLowerCase())||ze.toLowerCase().includes(ce.toLowerCase()));Re&&(Pe+=`<br/><span class="text-sm text-gray-700">${Re[1]}</span>`)}ie.lin_period&&(Pe+=`<br/><span class="text-xs text-purple-600">${ie.lin_period}</span>`),ie.status&&(Pe+=`<br/><span class="text-xs text-gray-400">${ie.status}</span>`),Mt.push(Pe)}}catch(je){console.warn("Verdedigingslinies WMS query failed:",je)}continue}if(rn==="Rijksmonumenten"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=50,L=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties;let Pe='<strong class="text-red-800">Rijksmonument</strong>';(ie.cbsNaam||ie.cbs_naam)&&(Pe+=`<br/><span class="text-sm font-semibold">${ie.cbsNaam||ie.cbs_naam}</span>`),ie.hoofdcategorie&&(Pe+=`<br/><span class="text-sm text-red-700">${ie.hoofdcategorie}</span>`),ie.subcategorie&&(Pe+=`<br/><span class="text-xs text-gray-600">${ie.subcategorie}</span>`),ie.rijksmonumentnummer&&(Pe+=`<br/><span class="text-xs text-gray-500">Nr: ${ie.rijksmonumentnummer}</span>`),(ie.bouwjaar||ie.oorspronkelijkebouwjaar)&&(Pe+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${ie.bouwjaar||ie.oorspronkelijkebouwjaar}</span>`),Pe+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',ie.rijksmonumentnummer&&(Pe+=`<div class="text-sm text-gray-700 mt-1"><a href="https://monumentenregister.cultureelerfgoed.nl/monumenten/${ie.rijksmonumentnummer}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk in Monumentenregister</a></div>`),Pe+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Rijksmonument" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Rijksmonument</a></div>',Mt.push(Pe)}}catch(je){console.warn("Rijksmonumenten WMS query failed:",je)}continue}if(rn==="Werelderfgoed"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=500,L=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties;let Pe='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(ie.siteName||ie.naam)&&(Pe+=`<br/><span class="text-sm font-semibold text-cyan-700">${ie.siteName||ie.naam}</span>`),ie.siteDesignation&&(Pe+=`<br/><span class="text-xs text-gray-600">${ie.siteDesignation}</span>`),Mt.push(Pe)}}catch(je){console.warn("Werelderfgoed WMS query failed:",je)}continue}if(rn==="Terpen"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=`https://geoportaal.fryslan.nl/arcgis/rest/services/ProvinciaalGeoRegister/PGR2/MapServer/66/query?geometry=${_e[0]},${_e[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=SOORT,SHAPE_Area&returnGeometry=false&f=json`,L=await(await fetch(ve)).json();if(L.features&&L.features.length>0){const ut=L.features[0].attributes,W=ut.SOORT||"Terp",ie=ut.SHAPE_Area?Math.round(ut.SHAPE_Area):null;let Pe="",q="",ce=!1;try{const xt=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-100},${_e[1]-100},${_e[0]+100},${_e[1]+100}`}`,Ht=await(await fetch(xt)).json();if(Ht.features&&Ht.features.length>0){const G=Ht.features[0].properties;Pe=G.siteName||G.naam||"",q=G.inspireId||G.monumentnummer||"",ce=!0}}catch{}let Re="";Pe?(Re=`<strong class="text-orange-800">${Pe}</strong>`,Re+=`<br/><span class="text-sm text-orange-600 font-medium">${W}</span>`):Re=`<strong class="text-orange-800">${W}</strong>`,Re+='<br/><span class="text-sm text-gray-600">Friese terp (woonheuvel)</span>';const Me={terp:{uitleg:"Een kunstmatige woonheuvel waar mensen woonden om droge voeten te houden.",periode:"IJzertijd tot Middeleeuwen"},"afgegraven terp":{uitleg:"Deze terp is deels of geheel afgegraven voor de vruchtbare grond (terpaarde).",periode:"Oorspronkelijk IJzertijd-Middeleeuwen"},terprestant:{uitleg:"Hier lag ooit een terp, waarvan nu alleen nog resten over zijn.",periode:"IJzertijd tot Middeleeuwen"},"deels afgegraven terp":{uitleg:"Een deel van deze terp is afgegraven, een deel is nog intact.",periode:"IJzertijd tot Middeleeuwen"},"verhoogd kerkhof":{uitleg:"Een verhoogd kerkhof, vaak op een oude terplocatie gebouwd.",periode:"Middeleeuwen"},kerkterp:{uitleg:"Een terp met daarop een kerk, vaak het centrum van een terpdorp.",periode:"IJzertijd tot heden"}}[W.toLowerCase()]||{uitleg:"Een kunstmatige woonheuvel uit de tijd dat dit gebied vaak overstroomde.",periode:"IJzertijd tot Middeleeuwen"};if(Re+=`<div class="mt-2 text-sm text-gray-700">${Me.uitleg}</div>`,Re+=`<br/><span class="text-sm text-gray-600">Periode: ${Me.periode}</span>`,ie&&ie>100){const He=(ie/1e4).toFixed(1);Re+=`<br/><span class="text-sm text-gray-500">Oppervlak: ${He} hectare</span>`}if(ce&&(Re+='<div class="mt-2 p-2 bg-orange-100 rounded text-xs text-orange-800">',Re+="<strong> Rijksmonument</strong> - Deze terp is wettelijk beschermd. Detecteren is niet toegestaan zonder vergunning.",q&&(Re+=`<br/>Monumentnummer: ${q}`),Re+="</div>"),Re+='<div class="mt-2 p-2 bg-amber-50 rounded text-xs text-amber-800">',Re+="<strong>Detectietip:</strong> ",W.toLowerCase().includes("afgegraven")?Re+="Afgegraven terpen zijn interessant! Bij het afgraven kwam materiaal aan de oppervlakte. Zoek op akkers rond de oude terplocatie.":Re+="Terpen zijn rijk aan vondsten: aardewerk, munten, fibulae, botten, gereedschap. De grond is vaak donker en vruchtbaar door eeuwenlange bewoning.",Re+="</div>",Re+='<div class="mt-3 space-y-1">',Re+='<a href="https://www.terpenonderzoek.nl/" target="_blank" class="block text-blue-600 hover:underline text-sm">Terpenonderzoek.nl - Wetenschappelijk onderzoek</a>',Re+='<a href="https://www.friesmuseum.nl/collectie/archeologie/" target="_blank" class="block text-blue-600 hover:underline text-sm">Fries Museum - Terpvondsten</a>',Re+='<a href="https://nl.wikipedia.org/wiki/Terp" target="_blank" class="block text-blue-600 hover:underline text-sm">Wikipedia - Terpen</a>',Pe){const He=encodeURIComponent(Pe+" terp friesland");Re+=`<a href="https://www.google.com/search?q=${He}" target="_blank" class="block text-blue-600 hover:underline text-sm">Zoek meer over ${Pe}</a>`}Re+="</div>",Mt.push(Re)}}catch(je){console.warn("Terpen query failed:",je)}continue}if(rn==="Religieus Erfgoed"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=50,L=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties,Pe=ie.naam||ie.NAAM||ie.name||ie.NAME||"Onbekend",q=ie.denominatie||ie.DENOMINATIE||ie.religie||"",ce=ie.type||ie.TYPE||ie.functie||"",Re=ie.bouwjaar||ie.BOUWJAAR||ie.jaar||"",ze=ie.gemeente||ie.GEMEENTE||ie.plaats||"";let Me=`<strong class="text-purple-800">${Pe}</strong>`;const He=ce.toLowerCase();let $e="Een religieus gebouw of heilige plek.",xt="Munten van kerkgangers, knopen, gespen, religieuze voorwerpen";He.includes("kerk")||He.includes("church")?($e="Een kerk was het hart van de gemeenschap. Hier kwamen mensen samen voor diensten, maar ook voor belangrijke gebeurtenissen.",xt="Munten uit de collecte, knopen, gespen, pelgrimsinsignes, loden zegels"):He.includes("kapel")||He.includes("chapel")?($e="Een kapel is een klein gebedshuis, vaak bij een landgoed, langs een weg, of op een bijzondere plek.",xt="Devotionalia, munten, kruisjes, rozenkransen"):He.includes("synagoge")?($e="Een synagoge is een Joods gebedshuis. Veel synagogen in Nederland zijn verwoest of herbestemd na de Tweede Wereldoorlog.",xt="Munten, knopen, kleine religieuze voorwerpen"):He.includes("klooster")||He.includes("monastery")?($e="Een klooster was een woon- en werkplek voor monniken of nonnen. Veel kloosters hadden eigen werkplaatsen en landerijen.",xt="Religieuze voorwerpen, zegels, gereedschap, aardewerk, middeleeuwse munten"):He.includes("toren")||He.includes("tower")?($e="Een kerktoren of klokkentoren. Soms is alleen de toren nog over van een verdwenen kerk.",xt="Munten, knopen, bouwmateriaal"):(He.includes("begraafplaats")||He.includes("cemetery"))&&($e="Een historische begraafplaats. Detecteren op begraafplaatsen is niet toegestaan zonder toestemming.",xt="Detecteren hier niet toegestaan"),q&&(Me+=`<br/><span class="text-sm text-purple-600">${q}</span>`),ce&&(Me+=`<br/><span class="text-sm text-gray-600">${ce}</span>`),Re&&(Me+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${Re}</span>`),ze&&(Me+=`<br/><span class="text-xs text-gray-400">${ze}</span>`),Me+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Me+=`<div class="text-sm text-gray-700 mt-1">${$e}</div>`,Me+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Me+=`<div class="text-sm text-gray-700 mt-1">${xt}</div>`,Me+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',He.includes("begraafplaats")?Me+='<div class="text-sm text-red-600 mt-1">Detecteren op begraafplaatsen is niet toegestaan. Respecteer de rust van de overledenen.</div>':Me+='<div class="text-sm text-gray-700 mt-1">Veel kerken en religieuze gebouwen zijn beschermd monument. Vraag altijd toestemming voordat je gaat detecteren op het terrein.</div>',Mt.push(Me)}}catch(je){console.warn("Religieus Erfgoed WMS query failed:",je)}continue}if(rn==="Gewaspercelen"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=50,jt=`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`,L=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${jt}`,ut=`https://service.pdok.nl/bzk/bro-bodemkaart/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=soilarea&QUERY_LAYERS=soilarea&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${jt}`,[W,ie]=await Promise.all([fetch(L),fetch(ut).catch(()=>null)]),Pe=await W.json();if(Pe.features&&Pe.features.length>0){const q=Pe.features[0].properties;let ce='<strong class="text-green-800">Landbouwperceel</strong>';if((q.gewas||q.gewasnaam)&&(ce+=`<br/><span class="text-sm font-semibold text-green-700">${q.gewas||q.gewasnaam}</span>`),(q.categorie||q.category)&&(ce+=`<br/><span class="text-xs text-gray-600">${q.categorie||q.category}</span>`),q.oppervlakte&&(ce+=`<br/><span class="text-xs text-gray-500">${q.oppervlakte} ha</span>`),ie)try{const Re=await ie.json();if(Re.features&&Re.features.length>0){const ze=Re.features[0].properties,Me=ze.first_soilname||ze.soilname||ze.bodemtype,He=ze.first_soilcode||ze.soilcode||ze.maparea_soilcode;if(Me){ce+=`<br/><span class="text-xs text-amber-700 font-medium">Grondsoort: ${Me}</span>`;const $e=xD(Me,He);$e.length>0&&(ce+=`<br/><span class="text-xs text-gray-500 italic">${$e.join("  ")}</span>`)}}}catch{}Mt.push(ce)}}catch(je){console.warn("BRP Gewaspercelen WMS query failed:",je)}continue}if(rn==="Kadastrale Grenzen"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=20,L=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties,Pe=ie.kadastraleGemeenteWaarde||ie.kadastrale_gemeente_waarde||ie.kadastraleGemeente||kTe[String(ie.kadastraleGemeenteCode)]||ie.kadastraleGemeenteCode,q=ie.sectie||ie.Sectie||"",ce=ie.perceelnummer||ie.perceelNummer||ie.Perceelnummer||"",Re=ie.kadastraleGrootteWaarde||ie.kadastrale_grootte_waarde||ie.kadastraleGrootte||ie.oppervlakte,ze=ie.AKRKadastraleGemeenteCodeWaarde||ie.akrKadastraleGemeenteCodeWaarde||"",Me=[Pe,q,ce].filter(Boolean).join(" "),He=ze&&q&&ce?`${ze}-${q}-${ce}`:"";let $e='<strong class="text-indigo-800">Kadastraal Perceel</strong>';if(Me&&($e+=`<br/><span class="text-sm text-indigo-700">${Me}</span>`),He&&($e+=`<br/><span class="text-sm font-bold text-gray-800 font-mono">${He}</span>`),Re){const xt=typeof Re=="number"?Re:parseFloat(Re);isNaN(xt)||($e+=`<br/><span class="text-xs text-gray-600">${xt.toLocaleString("nl-NL")} m</span>`)}$e+='<br/><br/><span class="text-xs text-gray-600">Eigenaar opzoeken? Kopieer bovenstaande code, ga naar </span><a href="https://www.kadaster.nl/winkel" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">kadaster.nl/winkel</a><span class="text-xs text-gray-600"> en klik "Zoek op aanduiding"</span><span class="text-xs text-gray-400"> (betaalde dienst)</span>',Mt.push($e)}}catch(je){console.warn("Kadastrale Grenzen WMS query failed:",je)}continue}if(rn==="Scheepswrakken"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=100,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties;let q=`<strong class="text-cyan-800">${ie.naam||ie.NAAM||"Scheepswrak"}</strong>`;q+='<br/><span class="text-sm text-gray-800">Historisch scheepswrak in Zuid-Holland</span>',q+='<div class="mt-2 text-sm text-gray-700">',q+="Op deze plek ligt een oud scheepswrak. Dit is een schip dat lang geleden is gezonken. ",q+="In de bodem kunnen nog resten van het schip en de lading liggen.",q+="</div>",(ie.type||ie.TYPE)&&(q+=`<br/><span class="text-sm text-cyan-700">Type: ${ie.type||ie.TYPE}</span>`),(ie.datering||ie.DATERING)&&(q+=`<br/><span class="text-sm text-gray-600">Periode: ${ie.datering||ie.DATERING}</span>`),(ie.bron||ie.BRON)&&(q+=`<br/><span class="text-xs text-gray-500">Bron: ${ie.bron||ie.BRON}</span>`),q+='<div class="mt-2 p-2 bg-cyan-50 rounded text-xs text-cyan-800">',q+="<strong>Detectietip:</strong> Bij scheepswrakken kun je bijzondere vondsten doen zoals scheepsonderdelen, munten, gereedschap en lading. Let op: vaak is een vergunning nodig.",q+="</div>",q+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Mt.push(q)}}catch(je){console.warn("Scheepswrakken WMS query failed:",je)}continue}if(rn==="Woonheuvels ZH"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=100,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties;let q=`<strong class="text-orange-800">${ie.naam||ie.NAAM||"Woonheuvel"}</strong>`;q+='<br/><span class="text-sm text-gray-800">Historische woonheuvel (terp)</span>',q+='<div class="mt-2 text-sm text-gray-700">',q+="Een woonheuvel is een door mensen opgeworpen heuvel. Mensen woonden hierop om droge voeten te houden bij hoog water. ",q+="Deze heuvels werden steeds hoger gemaakt. Je vindt ze vooral in laaggelegen gebieden.",q+="</div>",(ie.type||ie.TYPE)&&(q+=`<br/><span class="text-sm text-orange-700">Type: ${ie.type||ie.TYPE}</span>`),q+='<div class="mt-2 p-2 bg-orange-50 rounded text-xs text-orange-800">',q+="<strong>Detectietip:</strong> Woonheuvels zijn rijk aan vondsten! Denk aan aardewerk, munten, sieraden en huisraad uit de middeleeuwen. De grond bevat vaak veel materiaal.",q+="</div>",q+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Mt.push(q)}}catch(je){console.warn("Woonheuvels WMS query failed:",je)}continue}if(rn==="Romeinse Forten"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=200,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties;let q=`<strong class="text-red-800">${ie.naam||ie.NAAM||"Romeins Fort"}</strong>`;q+='<br/><span class="text-sm text-gray-800">Romeins militair fort (castellum)</span>',q+='<div class="mt-2 text-sm text-gray-700">',q+="Dit was een Romeins legerfort. De Romeinen bouwden deze forten langs de Rijn, de grens van hun rijk. ",q+="Soldaten woonden hier en bewaakten de grens. Deze forten zijn ongeveer 2000 jaar oud.",q+="</div>",(ie.type||ie.TYPE)&&(q+=`<br/><span class="text-sm text-red-700">Type: ${ie.type||ie.TYPE}</span>`),(ie.periode||ie.PERIODE)&&(q+=`<br/><span class="text-sm text-gray-600">Periode: ${ie.periode||ie.PERIODE}</span>`),q+='<div class="mt-2 p-2 bg-red-50 rounded text-xs text-red-800">',q+="<strong>Detectietip:</strong> Romeinse forten zijn toplocaties! Je kunt hier Romeinse munten, fibulae (mantelspelden), militaire uitrusting en aardewerk vinden. Vaak beschermd, check de regels!",q+="</div>",q+='<div class="mt-2"><a href="https://www.limesworld.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over de Romeinse Limes</a></div>',Mt.push(q)}}catch(je){console.warn("Romeinse Forten WMS query failed:",je)}continue}if(rn==="Windmolens"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=50,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties;let q=`<strong class="text-amber-800">${ie.naam||ie.NAAM||"Windmolen"}</strong>`;if(q+='<br/><span class="text-sm text-gray-800">Historische windmolen</span>',q+='<div class="mt-2 text-sm text-gray-700">',q+="Windmolens gebruikten de kracht van de wind. Ze maalden graan tot meel of pompten water weg uit polders. ",q+="Nederland heeft veel molens omdat we laaggelegen land droog moesten houden.",q+="</div>",ie.type||ie.TYPE||ie.functie||ie.FUNCTIE){const ce=ie.functie||ie.FUNCTIE||ie.type||ie.TYPE;q+=`<br/><span class="text-sm text-amber-700">Functie: ${ce}</span>`}(ie.bouwjaar||ie.BOUWJAAR)&&(q+=`<br/><span class="text-sm text-gray-600">Bouwjaar: ${ie.bouwjaar||ie.BOUWJAAR}</span>`),q+='<div class="mt-2 p-2 bg-amber-50 rounded text-xs text-amber-800">',q+="<strong>Detectietip:</strong> Bij molens vind je vaak voorwerpen van de molenaar en bezoekers: munten, knopen, gereedschap. Ook de grond rond verdwenen molens kan interessant zijn.",q+="</div>",q+='<div class="mt-2"><a href="https://www.molendatabase.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over Nederlandse molens</a></div>',Mt.push(q)}}catch(je){console.warn("Windmolens WMS query failed:",je)}continue}if(rn==="Erfgoedlijnen"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=200,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties;let q=`<strong class="text-purple-800">${ie.naam||ie.NAAM||ie.erfgoedlijn||"Erfgoedlijn"}</strong>`;q+='<br/><span class="text-sm text-gray-800">Historische lijn in het landschap</span>',q+='<div class="mt-2 text-sm text-gray-700">',q+="Een erfgoedlijn is een route of lijn met veel geschiedenis. Dit kunnen oude dijken, wegen, kanalen of verdedigingslinies zijn. ",q+="Langs deze lijnen vind je vaak bijzondere plekken.",q+="</div>",(ie.type||ie.TYPE)&&(q+=`<br/><span class="text-sm text-purple-700">Type: ${ie.type||ie.TYPE}</span>`),(ie.omschrijving||ie.OMSCHRIJVING)&&(q+=`<br/><span class="text-sm text-gray-600">${ie.omschrijving||ie.OMSCHRIJVING}</span>`),q+='<div class="mt-2 p-2 bg-purple-50 rounded text-xs text-purple-800">',q+="<strong>Detectietip:</strong> Erfgoedlijnen volgen oude routes waar mensen langskwamen. Denk aan munten, knopen, gespen en andere verloren voorwerpen. Dijken en wegen zijn vaak interessant.",q+="</div>",q+='<div class="mt-2"><a href="https://www.erfgoedlijnen.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over Erfgoedlijnen</a></div>',Mt.push(q)}}catch(je){console.warn("Erfgoedlijnen WMS query failed:",je)}continue}if(rn==="Oude Kernen"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=200,L=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties;let q=`<strong class="text-stone-800">${ie.naam||ie.NAAM||"Historische Kern"}</strong>`;q+='<br/><span class="text-sm text-gray-800">Oude dorps- of stadskern</span>',q+='<div class="mt-2 text-sm text-gray-700">',q+="Dit is het oude centrum van een dorp of stad. Hier woonden en werkten mensen al honderden jaren geleden. ",q+="De grond bevat vaak veel sporen van het verleden.",q+="</div>",(ie.type||ie.TYPE)&&(q+=`<br/><span class="text-sm text-stone-700">Type: ${ie.type||ie.TYPE}</span>`),(ie.periode||ie.PERIODE)&&(q+=`<br/><span class="text-sm text-gray-600">Periode: ${ie.periode||ie.PERIODE}</span>`),q+='<div class="mt-2 p-2 bg-stone-100 rounded text-xs text-stone-800">',q+="<strong>Detectietip:</strong> Oude kernen zijn rijk aan vondsten! Munten, knopen, sieraden, gereedschap en huisraad. Let op: detecteren is vaak niet toegestaan in beschermde kernen.",q+="</div>",q+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Mt.push(q)}}catch(je){console.warn("Oude Kernen WMS query failed:",je)}continue}if(rn==="Relictenkaart Punten"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=50,L=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties,Pe={KV:{naam:"Kasteel of Vesting",uitleg:"Een versterkt gebouw uit de middeleeuwen. Vaak zijn er nog resten in de grond."},K:{naam:"Kapel",uitleg:"Een klein kerkgebouw. Rond kapellen worden vaak religieuze voorwerpen gevonden."},KE:{naam:"Kerkhof",uitleg:"Historische begraafplaats. Respecteer deze plek en vraag altijd toestemming."},B:{naam:"Buitenhuis",uitleg:"Een landhuis van welgestelde families. Vaak met tuinen en bijgebouwen."},OB:{naam:"Oud Bebouwingsrelict",uitleg:"Resten van oude bebouwing. Hier stonden ooit huizen of boerderijen."},OV:{naam:"Oude Verkaveling",uitleg:"Historisch patroon van akkers en weilanden uit vroeger tijden."},NR:{naam:"Nijverheidsrelict",uitleg:"Plek waar vroeger ambacht of industrie was, zoals smederijen of molens."},GH:{naam:"Grafheuvel",uitleg:"Prehistorische begraafplaats. Beschermd monument - niet detecteren!"},BP:{naam:"Begraafplaats",uitleg:"Historische begraafplaats. Respecteer deze plek."},HH:{naam:"Havezate",uitleg:"Adellijk huis met landerijen. Interessant voor middeleeuwse vondsten."},RM:{naam:"Rosmolen",uitleg:"Molen aangedreven door paarden. Zeldzaam cultuurhistorisch object."},WM:{naam:"Windmolen",uitleg:"Historische windmolen. Vaak zijn funderingen nog zichtbaar."},PM:{naam:"Poldermolen",uitleg:"Molen voor waterbeheer. Belangrijk voor de waterhuishouding."},EK:{naam:"Eendenkooi",uitleg:"Plek om wilde eenden te vangen. Bijzonder cultuurlandschap."},SH:{naam:"Scholtenhoeve",uitleg:"Boerderij van een welgestelde boer. Vaak eeuwenoud."},SL:{naam:"Slot",uitleg:"Versterkt kasteel of adellijke woning."},MO:{naam:"Motte",uitleg:"Vroegmiddeleeuwse kasteelberg. Zeer interessant voor detectie."},BR:{naam:"Borg",uitleg:"Versterkte adellijke woning, typisch voor het noorden."}},q=ie.type?.replace(/[0-9]/g,"")||"",ce=Pe[q]||{naam:ie.type||"Cultuurhistorisch object",uitleg:"Een historisch relict in het Gelderse landschap."};let Re=`<strong class="text-emerald-800">${ce.naam}</strong>`;Re+='<br/><span class="text-sm text-gray-800">Gelders cultuurhistorisch relict</span>',ie.streek&&(Re+=`<br/><span class="text-sm text-gray-600">Streek: ${ie.streek}</span>`),Re+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',Re+=`<div class="text-sm text-gray-700 mt-1">${ce.uitleg}</div>`,Re+='<div class="mt-3"><a href="https://www.gelderland.nl/erfgoed" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Meer over Gelders erfgoed</a></div>',Mt.push(Re)}}catch(je){console.warn("Relictenkaart Punten WMS query failed:",je)}continue}if(rn==="Relictenkaart Lijnen"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=50,L=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties,q={1:{naam:"Sprengenbeek",uitleg:"Kunstmatig aangelegde beek voor waterkracht. Vaak bij papiermolens."},2:{naam:"Oude waterloop",uitleg:"Historische beek of rivier. Langs waterlopen vind je vaak oude bewoningssporen."},3:{naam:"Doorgaande weg",uitleg:"Eeuwenoude handelsroute. Langs deze wegen gingen reizigers en handelaren."},4:{naam:"Hessenweg",uitleg:"Historische handelsweg naar Duitsland. Gebruikt door marskramers en kooplieden."},5:{naam:"Oude weg",uitleg:"Historische route door het landschap. Vaak al eeuwen in gebruik."},6:{naam:"Historische grens",uitleg:"Oude eigendoms- of gebiedsgrens. Soms gemarkeerd met grenspalen."},7:{naam:"Trekpad",uitleg:"Pad langs een kanaal waar paarden schepen trokken."},8:{naam:"Jaagpad",uitleg:"Pad langs water voor scheepvaart met paardentractie."}}[ie.klasse]||{naam:"Historisch lijnrelict",uitleg:"Een lijnvormig historisch element in het landschap."};let ce=`<strong class="text-teal-800">${q.naam}</strong>`;ce+='<br/><span class="text-sm text-gray-800">Gelders lijnrelict</span>',ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',ce+=`<div class="text-sm text-gray-700 mt-1">${q.uitleg}</div>`,ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip</span></div>',ce+='<div class="text-sm text-gray-700 mt-1">Langs oude wegen en waterlopen worden vaak vondsten gedaan. Mensen verloren er munten en voorwerpen.</div>',Mt.push(ce)}}catch(je){console.warn("Relictenkaart Lijnen WMS query failed:",je)}continue}if(rn==="Relictenkaart Vlakken"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=100,L=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties,q={1:{naam:"Oud agrarisch land",uitleg:"Gebied dat al voor 1850 als landbouwgrond werd gebruikt. Rijk aan geschiedenis."},2:{naam:"Jonge heideontginning",uitleg:"Heide die tussen 1850 en 1950 is ontgonnen voor landbouw."},3:{naam:"Open essencomplex",uitleg:"Historische akkers op hoge grond. Vaak eeuwenoud en rijk aan vondsten."},4:{naam:"Kampenlandschap",uitleg:"Landschap met kleine akkers omringd door houtwallen. Typisch voor Oost-Nederland."},5:{naam:"Heiderelict",uitleg:"Restant van het vroegere uitgestrekte heidelandschap. Vaak prehistorische vondsten."},6:{naam:"Oud bosrelict",uitleg:"Bos dat al in 1850 bestond. Oude bossen bevatten vaak cultuurhistorische resten."},7:{naam:"Stuifzandrelict",uitleg:"Overblijfsel van actief stuifzand. Vaak bij grafheuvels en prehistorische sites."},8:{naam:"Oud bouwland",uitleg:"Historische akkergrond. Boeren hebben hier eeuwenlang gewerkt."},9:{naam:"Historisch grasland",uitleg:"Oud weiland of hooiland. Vaak bij boerderijen en dorpen."},10:{naam:"Beekdal",uitleg:"Laagte langs een beek. Mensen woonden graag bij water."}}[ie.klasse]||{naam:"Historisch landschap",uitleg:"Een waardevol cultuurlandschap in Gelderland."};let ce=`<strong class="text-lime-800">${q.naam}</strong>`;if(ce+='<br/><span class="text-sm text-gray-800">Gelders landschapsrelict</span>',ie.st_area_shape_){const Re=(ie.st_area_shape_/1e4).toFixed(1);ce+=`<br/><span class="text-sm text-gray-600">${Re} hectare</span>`}ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',ce+=`<div class="text-sm text-gray-700 mt-1">${q.uitleg}</div>`,Mt.push(ce)}}catch(je){console.warn("Relictenkaart Vlakken WMS query failed:",je)}continue}if(rn==="Verdronken Dorpen"){try{const je=Tn(Tt),_e=bn("EPSG:4326","EPSG:28992",je),ve=200,L=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${_e[0]-ve},${_e[1]-ve},${_e[0]+ve},${_e[1]+ve}`}`,W=await(await fetch(L)).json();if(W.features&&W.features.length>0){const ie=W.features[0].properties;let q=`<strong class="text-blue-800">${ie.naam||ie.NAAM||"Verdronken dorp"}</strong>`;q+='<br/><span class="text-sm text-gray-800">Verdronken dorp in Zeeland</span>',q+='<div class="mt-2 text-sm text-gray-700">',q+="Dit dorp is lang geleden door de zee verzwolgen. Bij stormvloeden brak de zeedijk door en liep het land onder water. ",q+="De mensen vluchtten, maar hun huizen en bezittingen bleven achter. In de bodem liggen nog resten van dit dorp.",q+="</div>",(ie.verdronken||ie.VERDRONKEN||ie.jaar||ie.JAAR)&&(q+=`<br/><span class="text-sm text-blue-700">Verdronken in: ${ie.verdronken||ie.VERDRONKEN||ie.jaar||ie.JAAR}</span>`),(ie.gemeente||ie.GEMEENTE)&&(q+=`<br/><span class="text-sm text-gray-600">Gemeente: ${ie.gemeente||ie.GEMEENTE}</span>`),(ie.bron||ie.BRON)&&(q+=`<br/><span class="text-xs text-gray-500">Bron: ${ie.bron||ie.BRON}</span>`),q+='<div class="mt-2 p-2 bg-blue-50 rounded text-xs text-blue-800">',q+="<strong>Detectietip:</strong> Verdronken dorpen bevatten veel vondsten! Aardewerk, munten, sieraden, gereedschap en huisraad. Bij laag water komen soms stukken vrij. Let op getijden en veiligheid!",q+="</div>",q+='<div class="mt-2"><a href="https://www.verdronkengeschiedenis.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over verdronken dorpen</a></div>',Mt.push(q)}}catch(je){console.warn("Verdronken Dorpen WMS query failed:",je)}continue}const Tr=li.getFeatureInfoUrl(Tt,an,"EPSG:3857",{INFO_FORMAT:"application/json"});if(Tr)try{const _e=await(await fetch(Tr)).json();if(_e.features&&_e.features.length>0){const ve=_e.features[0].properties;if(rn==="AHN 0.5m"){let W='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const ie=ve.value_list??ve.GRAY_INDEX??ve.value??ve.gray_index??ve.dtm_05m??ve.DTM_05M??ve.hoogte??ve.HOOGTE??ve.elevation??ve.ELEVATION;if(ie!=null&&!isNaN(Number(ie))){const Pe=typeof ie=="number"?ie.toFixed(2):Number(ie).toFixed(2);W+=`<br/><span class="text-sm text-blue-700">Hoogte: ${Pe} m NAP</span>`,Mt.push(W)}else{let Pe=!1;const q=["geometry","id","fid","gml_id","bbox"];for(const[ce,Re]of Object.entries(ve))!q.includes(ce.toLowerCase())&&Re!==null&&Re!==""&&(W+=`<br/><span class="text-xs text-gray-600">${ce}: ${Re}</span>`,Pe=!0);Pe&&Mt.push(W)}continue}if(rn==="Geomorfologie"){let W='<strong class="text-green-800">Geomorfologie</strong>',ie=!1;const Pe=ve.landform_subgroup_description,q=ve.relief_klasse,ce=ve.relief_subklasse,Re=ve.genese_description,ze=ve.active_process;if(Pe&&(W+=`<br/><span class="text-sm text-green-700">${Pe}</span>`,ie=!0),q){const Me=ce&&ce!==q?`${q} (${ce})`:q;W+=`<br/><span class="text-xs text-gray-600">Relief: ${Me}</span>`,ie=!0}if(Re&&(W+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${Re}</span>`,ie=!0),ze&&ze!=="onbekend"&&(W+=`<br/><span class="text-xs text-gray-500">Actief proces: ${ze}</span>`,ie=!0),!ie){const Me=["geometry","id","fid","gml_id","bbox","fuuid","geom","collection_id"];for(const[He,$e]of Object.entries(ve))!Me.includes(He.toLowerCase())&&$e!==null&&$e!==""&&!He.includes("validfrom")&&!He.includes("validto")&&(W+=`<br/><span class="text-xs text-gray-600">${He}: ${$e}</span>`)}W+='<br/><a href="https://legendageomorfologie.wur.nl/" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">Meer over geomorfologie</a>',Mt.push(W);continue}let jt=`<strong>${rn}</strong>`;const L=ve.first_soilname||ve.soilname,ut=ve.soilcode||ve.first_soilcode;if(L&&(jt+=`<br/><span class="text-sm text-amber-700">${L}</span>`,rn==="Bodemkaart")){const W=xD(L,ut);W.length>0&&(jt+=`<br/><span class="text-xs text-gray-500 italic">${W.join("  ")}</span>`)}if(ve.soilslope&&ve.soilslope!=="Niet opgenomen"&&(jt+=`<br/><span class="text-xs text-gray-500">Helling: ${ve.soilslope}</span>`),!L){const W=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[ie,Pe]of Object.entries(ve))!W.includes(ie)&&Pe&&Pe!=="Niet opgenomen"&&(jt+=`<br/><span class="text-xs text-gray-600">${ie}: ${Pe}</span>`)}Mt.push(jt)}}catch(je){console.warn("WMS GetFeatureInfo failed:",je)}}return Mt},An=async Tt=>{const an=[],Mt=[],Zi=_e=>{if(!_e)return;const ve=_e.getType(),L=_e.clone().transform("EPSG:3857","EPSG:4326").getCoordinates();return{type:ve,coordinates:L}},Mr=ATe(Tt.coordinate),li=[];n.forEachFeatureAtPixel(Tt.pixel,_e=>{li.push(_e)});for(const _e of li){const ve=_e.getProperties(),{geometry:jt,...L}=ve;if(L.vondst){const q=L.vondst,ce=`<strong>${q.objectType}</strong>
            <div data-vondst-id="${q.id}"></div>
            <br/><span class="text-sm text-gray-600"><strong>Materiaal:</strong> ${q.material}</span>
            <br/><span class="text-sm text-gray-600"><strong>Periode:</strong> ${q.period}</span>
            ${q.depth?`<br/><span class="text-sm text-gray-600"><strong>Diepte:</strong> ${q.depth} cm</span>`:""}
            ${q.condition&&q.condition!=="Onbekend"?`<br/><span class="text-sm text-gray-600"><strong>Conditie:</strong> ${q.condition}</span>`:""}
            ${q.weight?`<br/><span class="text-sm text-gray-600"><strong>Gewicht:</strong> ${q.weight} gram</span>`:""}
            ${q.notes?`<br/><span class="text-sm text-gray-600"><strong>Notities:</strong> ${q.notes}</span>`:""}
            ${q.photoUrl?`<br/><a href="${q.photoUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm"> Bekijk foto</a>`:""}
            <br/><span class="text-xs text-gray-400">${new Date(q.timestamp).toLocaleDateString("nl-NL")}</span>`;an.push(ce),Mt.push(null),M(q.id);continue}if(L.layerType==="customPoint"&&L.customPoint){const q=L.customPoint,ce=L.customLayerName||"Mijn Laag",Re=L.customLayerColor||"#f97316";let ze="";if(q.popupContent?(ze=`<div class="flex items-center gap-2 mb-2 pb-2 border-b border-gray-100">
              <span class="w-3 h-3 rounded-full flex-shrink-0" style="background-color: ${Re}"></span>
              <span class="text-xs font-medium" style="color: ${Re}">${ce}</span>
            </div>`,ze+=q.popupContent):(ze=`<strong>${q.name}</strong>`,ze+=`<br/><span class="text-xs text-gray-500">${ce}</span>`,q.category&&q.category!=="Overig"&&(ze+=`<br/><span class="text-sm text-gray-600"><strong>Categorie:</strong> ${q.category}</span>`)),q.photos&&q.photos.length>0){ze+='<div class="flex flex-wrap gap-1 my-2">';for(const Me of q.photos.slice(0,3)){const He=Me.thumbnailUrl||Me.thumbnailBase64;He&&(ze+=`<img src="${He}" alt="Foto" class="w-16 h-16 object-cover rounded border border-gray-200" />`)}q.photos.length>3&&(ze+=`<span class="text-xs text-gray-400 self-end">+${q.photos.length-3} meer</span>`),ze+="</div>"}q.notes&&!q.popupContent&&(ze+=`<br/><span class="text-sm text-gray-600 mt-1">${q.notes}</span>`),q.url&&(ze+=`<br/><a href="${q.url}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm">Meer info</a>`),ze+=`<br/><span class="text-xs text-gray-400">${new Date(q.createdAt).toLocaleDateString("nl-NL")}</span>`,an.push(ze),Mt.push(null);continue}if(L.layerType==="importedLayer"){const q=L.layerName||"Gemporteerde laag",ce=L.layerColor||"#8b5cf6",Re=["layerType","layerId","layerName","layerColor","featureIndex","geometry"],ze=L.name||L.Name||L.naam||L.title||L.NAAM||L.NAME||L.label||L.description||"Feature";let Me=`<strong style="color: ${ce}">${ze}</strong>`;Me+=`<br/><span class="text-xs text-gray-500">${q}</span>`;const He=Object.entries(L).filter(([$e])=>!Re.includes($e)&&$e!=="name"&&$e!=="Name");if(He.length>0){Me+='<div class="mt-2 space-y-1">';for(const[$e,xt]of He)if(xt!=null&&xt!==""){const Rt=$e.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,G=>G.toUpperCase());let Ht=String(xt);Ht.length>200&&(Ht=Ht.substring(0,200)+"..."),Ht.startsWith("http://")||Ht.startsWith("https://")?Me+=`<div class="text-sm"><span class="text-gray-500">${Rt}:</span> <a href="${Ht}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Link</a></div>`:Me+=`<div class="text-sm"><span class="text-gray-500">${Rt}:</span> <span class="text-gray-700">${Ht}</span></div>`}Me+="</div>"}an.push(Me),Mt.push({geometry:Zi(jt),properties:L,popupHtml:Me});continue}if(L.kwaliteitswaarde&&L.kwaliteitswaarde.includes("archeologische waarde")){const q=_t(L);an.push(q),Mt.push({geometry:Zi(jt),properties:L,popupHtml:q});continue}if(L.layerType==="romeinsFort"||L.layerType==="romeinsFortLijn"){const q=L.Name||L.name||"";L.description;const ce=TTe[q]||null,Re=ce||bTe;let ze=`<strong class="text-red-800">${ce?Re.naam:q||"Romeins Fort"}</strong>`;if(ze+=`<br/><span class="text-sm text-red-700">${RTe[Re.type]||Re.type}</span>`,ze+=`<br/><span class="text-sm text-gray-500">${Re.periode}</span>`,L.layerType==="romeinsFortLijn"&&(ze+='<br/><span class="text-sm text-red-600"> Gereconstrueerde fortomtrek</span>'),ze+=`<br/><span class="text-xs text-gray-600 mt-1 block">${Re.beschrijving}</span>`,ce?.bronnen&&ce.bronnen.length>0){const Me=ce.bronnen[0].replace(/^https?:\/\//,"").split("/")[0];ze+=`<br/><a href="${ce.bronnen[0]}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-xs">${Me}</a>`}an.push(ze),Mt.push({geometry:Zi(jt),properties:L,popupHtml:ze});continue}let ut=L.name||L.Name||L.naam||L.title||L.NAAM||L.NAME||L.label||L.route_name||L.road_name;ut||(L.leisure==="playground"?ut="Speeltuin":L.leisure==="park"?ut="Park":L.leisure==="swimming_area"||L.sport==="swimming"?ut="Zwemplek":L.tourism==="museum"?ut="Museum":L.amenity==="cafe"||L.amenity==="restaurant"?ut=L.amenity==="cafe"?"Caf":"Restaurant":L.historic==="castle"?ut="Kasteel":ut="Info"),(L.bunker_type||L.name&&(L.name.toLowerCase().includes("bunker")||L.name.toLowerCase().includes("kazemat")||L.name.toLowerCase().includes("schuilplaats")))&&(ut="Bunker"),L.historic==="battlefield"&&(ut="Historisch slagveld");let W=`<strong>${ut}</strong>`,ie=!1;if(L.category&&(W+=`<br/><span class="text-sm text-gray-600">Categorie: ${L.category}</span>`),L.from_to&&L.from_to!==ut&&(W+=`<br/><span class="text-sm text-gray-600">${L.from_to}</span>`),L.route&&L.route!==ut&&(W+=`<br/><span class="text-sm text-gray-600">${L.route}</span>`),L.TOPONIEM&&(W+=`<br/><span class="text-sm font-semibold text-gray-800">${L.TOPONIEM}</span>`,L.PLAATS&&(W+=`<br/><span class="text-xs text-gray-500">${L.PLAATS}</span>`)),(L.AARD_VINDP||L.Aard_vindp)&&(W+=`<br/><span class="text-sm text-gray-700">Aard: ${L.AARD_VINDP||L.Aard_vindp}</span>`),L.BEGIN_PER&&L.EIND_PER&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${L.BEGIN_PER} - ${L.EIND_PER}</span>`),(L.AARD_OPM||L.Aard_opmer)&&(W+=`<br/><span class="text-xs text-gray-600 italic">${L.AARD_OPM||L.Aard_opmer}</span>`),L.Gemeente&&(W+=`<br/><span class="text-sm text-gray-600">Gemeente: ${L.Gemeente}</span>`),L.Bron&&(W+=`<br/><span class="text-xs text-gray-500">Bron: ${L.Bron}</span>`),L.Bron_besch&&(W+=`<br/><span class="text-xs text-gray-500">${L.Bron_besch}</span>`),L.Dat_st_z&&L.Dat_ei_z&&(W+=`<br/><span class="text-sm text-purple-700">Datering: ${L.Dat_st_z} - ${L.Dat_ei_z}</span>`),L.Begin&&L.Einde&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${L.Begin} - ${L.Einde}</span>`),L.Uiterwaard&&(W+=`<br/><span class="text-sm font-semibold">${L.Uiterwaard}</span>`),L.rivier&&(W+=`<br/><span class="text-sm text-blue-600">Rivier: ${L.rivier}</span>`),L.Beschrijvi&&(W+=`<br/><span class="text-sm text-gray-700">${L.Beschrijvi}</span>`),L.leisure==="park"){ie=!0,W=`<strong class="text-green-800">${L.name||"Park"}</strong>`,W+='<br/><span class="text-sm text-gray-800">Park</span>',L.description&&(W+=`<div class="mt-2 text-sm text-gray-700">${L.description}</div>`),L.area&&(W+=`<br/><span class="text-sm text-gray-600">Oppervlakte: ${L.area}</span>`);const ce=[];if(L.dog==="yes"&&ce.push("Honden toegestaan"),L.lit==="yes"&&ce.push("Verlicht"),L.bench==="yes"&&ce.push("Bankjes"),ce.length>0&&(W+=`<br/><span class="text-sm text-gray-600">${ce.join("  ")}</span>`),L.operator&&(W+=`<br/><span class="text-xs text-gray-500">Beheer: ${L.operator}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip voor detectie</span></div>',W+='<div class="text-sm text-gray-700">Parken zijn populair bij detectoristen. Mensen verliezen hier munten en sieraden. Vraag eerst toestemming aan de gemeente of beheerder.</div>',L.website){const Re=L.website.replace(/^https?:\/\//,"").split("/")[0];W+=`<div class="mt-2"><a href="${L.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">${Re}</a></div>`}}else L.leisure==="playground"&&(ie=!0,W=`<strong class="text-orange-800">${L.name||"Speeltuin"}</strong>`,W+='<br/><span class="text-sm text-gray-800">Speeltuin</span>',L.description&&(W+=`<div class="mt-2 text-sm text-gray-700">${L.description}</div>`));if(L.tourism==="museum"||L.museum){ie=!0;const q=L.name||"Museum",ce=L.museum||L["museum:type"]||"",ze=ce&&ce!=="yes"?{art:"Kunstmuseum",history:"Geschiedenismuseum",archaeology:"Archeologisch museum",science:"Wetenschapsmuseum",technology:"Techniekmuseum",nature:"Natuurmuseum",open_air:"Openluchtmuseum",local:"Streekmuseum",military:"Militair museum",railway:"Spoorwegmuseum",maritime:"Maritiem museum",children:"Kindermuseum"}[ce.toLowerCase()]||ce:"Museum";if(W=`<strong class="text-purple-800">${q}</strong>`,W+=`<br/><span class="text-sm text-purple-600">${ze}</span>`,L.description&&(W+=`<div class="mt-2 text-sm text-gray-700">${L.description}</div>`),L.fee){const Me=L.fee==="yes"?"Toegangsprijs":L.fee==="no"?"Gratis toegang":L.fee;W+=`<div class="mt-2"><span class="text-sm text-gray-600">${Me}</span></div>`}if(L.opening_hours){const Me=pD(String(L.opening_hours));W+=`<div class="mt-2"><span class="text-xs text-green-600">Open: ${Me}</span></div>`}if(L.website||L.url){const Me=L.website||L.url;W+=`<div class="mt-1"><a href="${Me}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Bezoek ${q}</a></div>`}if(L.wikipedia){const Me=L.wikipedia.split(":")[0]||"nl",He=L.wikipedia.split(":")[1]||L.wikipedia;W+=`<div class="text-sm"><a href="https://${Me}.wikipedia.org/wiki/${encodeURIComponent(He)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Meer info op Wikipedia</a></div>`}if(L["addr:street"]||L["addr:housenumber"]||L["addr:city"]){if(W+='<div class="mt-2 text-xs text-gray-400">',L["addr:street"]||L["addr:housenumber"]){const Me=[L["addr:street"],L["addr:housenumber"]].filter(Boolean).join(" ");Me&&(W+=`${Me}<br/>`)}L["addr:city"]&&(W+=`${L["addr:postcode"]||""} ${L["addr:city"]}`),W+="</div>"}}if(L.leisure==="swimming_area"||L.sport==="swimming"||L.natural==="beach"){ie=!0,W=`<strong class="text-cyan-800">${L.name||"Zwemplek"}</strong>`;const ce=L.natural==="beach"?"Strand":L.leisure==="swimming_area"?"Zwemplek":"Zwemwater";W+=`<br/><span class="text-sm text-gray-800">${ce}</span>`,L.water&&(W+=`<br/><span class="text-sm text-gray-700">${{lake:"Meer",river:"Rivier",pond:"Vijver",reservoir:"Reservoir",canal:"Kanaal"}[L.water]||L.water}</span>`),L.supervised==="yes"&&(W+='<br/><span class="text-sm text-green-700">Met toezicht</span>'),L.changing_rooms==="yes"&&(W+='<br/><span class="text-sm text-gray-600">Kleedruimte aanwezig</span>'),L.description&&(W+=`<div class="mt-2 text-sm text-gray-700">${L.description}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip voor detectie</span></div>',W+='<div class="text-sm text-gray-700">Zwemplekken kunnen interessant zijn voor detectie. Mensen verliezen hier sieraden en munten. Let op: niet overal is detecteren toegestaan.</div>'}if(L.osm_id&&L.address!==void 0&&(W+='<br/><span class="text-sm text-lime-700">Kringloopwinkel</span>',L.address&&(W+=`<br/><span class="text-xs text-gray-500">${L.address}</span>`),L.phone&&(W+=`<br/><span class="text-xs text-gray-600">${L.phone}</span>`)),L.site_type==="tumulus"){ie=!0;const q=_e.getGeometry()?.getCoordinates();let ce="",Re="";if(q){const ze=Tn(q),Me=ze[0],He=ze[1];Me>5.5&&Me<6.3&&He>52&&He<52.5?(ce="Veluwe",Re="De Veluwe heeft de grootste concentratie grafheuvels van Nederland. Veel heuvels liggen in grafvelden met tientallen heuvels bij elkaar."):Me>6.2&&Me<7.1&&He>52.6&&He<53.3?(ce="Drenthe",Re="Drenthe is beroemd om zijn prehistorische monumenten. Naast hunebedden liggen hier honderden grafheuvels uit de Bronstijd."):Me>4.5&&Me<6&&He>51.3&&He<51.9?(ce="Noord-Brabant",Re="Op de Brabantse zandgronden liggen veel grafheuvels, vaak in kleine groepjes op hogere gronden."):Me>5.5&&Me<6.3&&He>50.7&&He<51.6?(ce="Limburg",Re="De Limburgse heuvels en plateaus herbergen grafheuvels uit verschillende periodes, van Bronstijd tot Romeinse tijd."):Me>5&&Me<5.6&&He>52&&He<52.4&&(ce="Utrechtse Heuvelrug",Re="De stuwwallen van de Utrechtse Heuvelrug en het Gooi waren al in de prehistorie bewoond. Grafheuvels markeren de laatste rustplaats van de vroege bewoners.")}W+='<br/><span class="text-sm text-amber-700">Grafheuvel uit de Bronstijd of IJzertijd</span>',ce&&(W+=`<br/><span class="text-sm text-gray-500">${ce}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Een grafheuvel is een kunstmatige heuvel over een of meerdere graven. De meeste Nederlandse grafheuvels zijn 3000 tot 4000 jaar oud, uit de Bronstijd (2000-800 v.Chr.) of vroege IJzertijd.</div>',Re&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over deze regio</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Re}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe herken je een grafheuvel?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Grafheuvels zijn vaak ronde, lage heuvels van 10-30 meter doorsnee en 1-3 meter hoog. Ze liggen meestal op zandgronden, vaak in groepjes (grafvelden). Let op de kenmerkende ronde vorm in het landschap.</div>',L.wikidata?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="https://www.wikidata.org/wiki/${L.wikidata}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk op Wikidata</a></div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Grafheuvel" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Lees meer over grafheuvels op Wikipedia</a></div>')}if(L.historic==="castle"||L.castle_type){ie=!0;const q={manor:{label:"Landhuis",uitleg:"Een landhuis of havezate was het woonhuis van een adellijke familie. Vaak met een landgoed eromheen.",vondsten:"Sieraden, gespen, munten, aardewerk van rijke bewoners"},stately:{label:"Statig huis",uitleg:"Een groot en deftig woonhuis, vaak van welgestelde families. Soms met kasteelachtige kenmerken.",vondsten:"Huishoudelijke voorwerpen, munten, knopen, aardewerk"},fortress:{label:"Fort/Vesting",uitleg:"Een versterkte militaire bouwwerk, gebouwd om een gebied te verdedigen.",vondsten:"Militaire voorwerpen, kogels, gespen, uniformonderdelen"},defensive:{label:"Verdedigingskasteel",uitleg:"Een kasteel gebouwd voor verdediging, met dikke muren, een gracht en torens.",vondsten:"Wapens, harnasonderdelen, pijlpunten, middeleeuwse munten"},palace:{label:"Paleis",uitleg:"Een groot en luxueus gebouw voor koningen, prinsen of zeer rijke families.",vondsten:"Luxe voorwerpen, sieraden, zegels, zeldzame munten"},castrum:{label:"Romeins fort",uitleg:"Een Romeins legerkamp of fort. Deze zijn bijna 2000 jaar oud!",vondsten:"Romeinse munten, fibulae, militaria, aardewerk"},citadel:{label:"Citadel",uitleg:"Een sterk versterkte kern binnen een stad, als laatste verdedigingslinie.",vondsten:"Militaire voorwerpen uit verschillende periodes"}},ce=L.castle_type?q[L.castle_type]:null,Re=ce?.label||"Kasteel";if(W+=`<br/><span class="text-sm text-purple-700">${Re}</span>`,L.start_date&&(W+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${L.start_date}</span>`),L.heritage&&(W+='<br/><span class="text-sm text-amber-700">Rijksmonument</span>'),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ce?W+=`<div class="text-sm text-gray-700 mt-1">${ce.uitleg}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Een historisch kasteel of adellijk huis. Kastelen waren vaak het middelpunt van macht en rijkdom in een gebied.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ce?W+=`<div class="text-sm text-gray-700 mt-1">${ce.vondsten}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Munten, sieraden, gespen, aardewerk en andere voorwerpen van de vroegere bewoners.</div>',L.wikipedia||L.website){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',L.wikipedia){const ze=L.wikipedia.startsWith("http")?L.wikipedia:`https://nl.wikipedia.org/wiki/${L.wikipedia.replace(/^nl:/,"")}`;W+=`<div class="text-sm text-gray-700 mt-1"><a href="${ze}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}L.website&&(W+=`<div class="text-sm text-gray-700 mt-1"><a href="${L.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Website bezoeken</a></div>`)}}if(L.historic==="ruins"){const q=L.ruins_type||"";let ce="Rune",Re="Een rune is wat overblijft van een oud gebouw. Het kan een kerk, kasteel, molen of ander bouwwerk zijn geweest.",ze="Baksteenfragmenten, aardewerk, metalen voorwerpen van vroegere bewoners of gebruikers";if(q.toLowerCase().includes("church")||q.toLowerCase().includes("kerk")?(ce="Kerkrune",Re="De overblijfselen van een oude kerk. Vaak nog te herkennen aan de fundering of een paar muren.",ze="Religieuze voorwerpen, munten van kerkgangers, knopen, gespen"):q.toLowerCase().includes("castle")||q.toLowerCase().includes("kasteel")?(ce="Kasteelrune",Re="De resten van een middeleeuws kasteel. Soms is alleen de gracht of fundering nog zichtbaar.",ze="Middeleeuwse munten, sieraden, harnasonderdelen, pijlpunten"):q.toLowerCase().includes("mill")||q.toLowerCase().includes("molen")?(ce="Molenrune",Re="Wat rest van een oude molen. Vaak nog te zien aan de stenen fundering of de molenberg.",ze="Gereedschap, munten, huishoudelijke voorwerpen"):q.toLowerCase().includes("fort")&&(ce="Fortrune",Re="De overblijfselen van een militair fort of verdedigingswerk.",ze="Militaire voorwerpen, kogels, gespen, uniformonderdelen"),W+=`<br/><span class="text-sm text-amber-700">${ce}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Re}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${ze}</div>`,L.description&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Beschrijving</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`),L.wikipedia){const Me=L.wikipedia.startsWith("http")?L.wikipedia:`https://${L.wikipedia.split(":")[0]||"nl"}.wikipedia.org/wiki/${L.wikipedia.replace(/^[a-z]{2}:/,"")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${Me}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(L.bunker_type||L.name&&(L.name.toLowerCase().includes("bunker")||L.name.toLowerCase().includes("kazemat")||L.name.toLowerCase().includes("schuilplaats"))){ie=!0;const q={munitions:"Munitiebunker",personnel_shelter:"Personeelsschuilplaats",personell_shelter:"Personeelsschuilplaats",command:"Commandobunker",gun_emplacement:"Geschutsbunker",mg_nest:"Mitrailleursnest",technical:"Technische bunker",storage:"Opslagbunker",tobruk:"Tobruk",kazemat:"Kazemat",Flak:"Luchtafweerstelling",hardened_aircraft_shelter:"Vliegtuigshelter",shelter:"Schuilkelder",observation:"Observatiebunker",anti_aircraft:"Luchtafweerstelling"},ce=L.name||"",Re=L.bunker_type?q[L.bunker_type]||L.bunker_type:"";ce&&ce!=="Bunker"&&(W+=`<br/><span class="text-sm font-semibold text-gray-700">${ce}</span>`),Re&&Re!==ce&&(W+=`<br/><span class="text-xs text-gray-500">${Re}</span>`);const ze=_e.getGeometry()?.getCoordinates();let Me="",He="",$e="";if(ze){const xt=Tn(ze),Rt=xt[0],Ht=xt[1],G=Rt<4.8||Rt<5.2&&Ht>51.8&&Ht<53.5,J=Rt>4.2&&Rt<4.4&&Ht>52&&Ht<52.15,X=Rt>4.5&&Rt<4.7&&Ht>52.4&&Ht<52.5,Y=Rt>4&&Rt<4.2&&Ht>51.95&&Ht<52.05,te=Rt<4.2&&Ht<51.6,ne=Rt>5.2&&Rt<5.8&&Ht>51.9&&Ht<52.3;J?(Me="Deze bunker maakt deel uit van de Atlantikwall bij Scheveningen. De Duitsers bouwden hier tijdens WOII zo'n 80 bunkers in de duinen. De muren zijn soms 3 meter dik beton. Voor deze bunkers moesten 138.000 mensen uit Den Haag en Scheveningen hun huis verlaten.",He="https://nl.wikipedia.org/wiki/Atlantikwall_Museum_Scheveningen",$e="Atlantikwall Museum Scheveningen"):X?(Me="Deze bunker hoort bij Festung IJmuiden, een van de zwaarst verdedigde punten van de Atlantikwall. De Duitsers bouwden hier bunkers om de haventoegang te beschermen. Er zijn nu rondleidingen door het Bunkermuseum.",He="https://www.bunkermuseum.nl/",$e="Bunkermuseum IJmuiden"):Y?(Me="Deze bunker maakt deel uit van de Atlantikwall bij Hoek van Holland. Dit was een strategisch punt voor de Duitsers vanwege de Nieuwe Waterweg. Veel bunkers zijn nog te bezoeken.",He="https://www.atlantikwallhoekvanholland.nl/",$e="Atlantikwall Hoek van Holland"):te?(Me="Deze bunker hoort bij de Atlantikwall in Zeeland. De Duitsers verdedigden hier de Westerschelde en de kust. Bij Zoutelande en Westkapelle zijn veel bunkers bewaard gebleven.",He="https://www.bunkermuseumzoutelande.nl/",$e="Bunkermuseum Zoutelande"):G?(Me="Deze bunker maakt deel uit van de Atlantikwall: de Duitse verdedigingslinie langs de hele kust van Europa. In Nederland bouwden de Duitsers duizenden bunkers tussen 1942 en 1944.",He="https://nl.wikipedia.org/wiki/Atlantikwall",$e="Atlantikwall (Wikipedia)"):ne?(Me="Deze bunker hoort mogelijk bij de Grebbelinie of de Nieuwe Hollandse Waterlinie. Dit waren Nederlandse verdedigingslinies die de Duitsers na 1940 versterkten met bunkers.",He="https://nl.wikipedia.org/wiki/Grebbelinie",$e="Grebbelinie (Wikipedia)"):(Me="Een bunker uit de Tweede Wereldoorlog. De meeste bunkers in Nederland zijn gebouwd tussen 1940 en 1944, als onderdeel van de Duitse verdediging of langs bestaande Nederlandse linies.",He="https://nl.wikipedia.org/wiki/Atlantikwall",$e="WOII bunkers (Wikipedia)")}else Me="Een bunker uit de Tweede Wereldoorlog.",He="https://nl.wikipedia.org/wiki/Atlantikwall",$e="WOII bunkers (Wikipedia)";W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Me}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je vinden?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Bij bunkers worden soms voorwerpen gevonden zoals patronen, uniformknopen, gespen en persoonlijke spullen van soldaten.</div>',W+='<div class="mt-2 text-xs text-gray-500 italic">Let op: betreed nooit een bunker zonder toestemming. Raak munitieresten niet aan.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${He}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${$e}</a>`,L.website?W+=`<br/><a href="${L.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>`:W+='<br/><a href="https://www.tracesofwar.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>',W+="</div>"}if(L.historic==="battlefield"){ie=!0;const q=L.name||"Onbekend slagveld",Re={"Slag om Arnhem":{periode:"September 1944",samenvatting:"De Slag om Arnhem was onderdeel van Operatie Market Garden. Geallieerde parachutisten probeerden de brug over de Rijn te veroveren. Na negen dagen hevige gevechten moesten ze zich terugtrekken. Van de 10.000 Britse soldaten werden er 1.500 gedood en 6.500 krijgsgevangen gemaakt.",watZieJe:"Er zijn veel monumenten en infoborden. Het Airborne Museum in Oosterbeek vertelt het hele verhaal. Elk jaar in september is er een herdenking.",uitkomst:"De geallieerden verloren de slag. Nederland bleef nog tot mei 1945 bezet.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Arnhem"},"Slag om de Sloedam":{periode:"1-2 november 1944",samenvatting:"Canadese soldaten vielen de Sloedam aan om Walcheren te bevrijden. De dam was smal en de Duitsers verdedigden fel. Veel soldaten sneuvelden bij deze bloedige aanval.",watZieJe:"Bij de dam staat een monument voor de gevallen Canadezen. Er zijn infoborden die de slag uitleggen.",uitkomst:"De Canadezen wonnen na zware verliezen. Dit opende de weg naar de bevrijding van Walcheren.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_de_Sloedam"},"Slag bij Heiligerlee (1568)":{periode:"23 mei 1568",samenvatting:"De eerste veldslag van de Tachtigjarige Oorlog. Lodewijk van Nassau versloeg het Spaanse leger. Zijn broer Adolf sneuvelde tijdens de strijd.",watZieJe:"In Heiligerlee staat het Slag bij Heiligerlee monument. Het klooster waar Adolf van Nassau begraven ligt is nog te bezoeken.",uitkomst:"De opstandelingen wonnen, maar dit was pas het begin van 80 jaar oorlog.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_bij_Heiligerlee_(1568)"},Overloon:{periode:"Oktober 1944",samenvatting:"Bij Overloon vochten Britten en Amerikanen tegen de Duitsers. Het was een van de zwaarste tankgevechten op Nederlandse bodem. Het dorp werd volledig verwoest.",watZieJe:"Het Oorlogsmuseum Overloon staat op het voormalige slagveld. Je kunt tanks, vliegtuigen en andere voertuigen zien.",uitkomst:"De geallieerden wonnen na wekenlange gevechten.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Overloon"},"Slagveld Lanakerveld":{periode:"1568",samenvatting:"Onderdeel van de Nederlandse opstand tegen Spanje. Hier vonden gevechten plaats tijdens de beginjaren van de Tachtigjarige Oorlog.",watZieJe:"Het gebied is nu grotendeels landbouwgrond. Lokaal zijn er soms infoborden.",uitkomst:"Onderdeel van de lange strijd tegen de Spaanse overheersing.",wikiUrl:"https://nl.wikipedia.org/wiki/Tachtigjarige_Oorlog"},Blessebrugschans:{periode:"Diverse periodes",samenvatting:"Een historische schans die meerdere keren werd gebruikt in militaire conflicten.",watZieJe:"De resten van de schans zijn nog zichtbaar in het landschap.",uitkomst:"De schans speelde een rol in verschillende conflicten.",wikiUrl:"https://nl.wikipedia.org/wiki/Schans_(vestingwerk)"}}[q];if(q!=="Onbekend slagveld"&&q!=="Historisch slagveld"&&(W+=`<br/><span class="text-sm font-semibold text-red-700">${q}</span>`),Re)W+=`<br/><span class="text-xs text-gray-500">${Re.periode}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Re.samenvatting}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe liep het af?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Re.uitkomst}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je zien?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Re.watZieJe}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${Re.wikiUrl}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a>`,q.includes("Arnhem")&&(W+='<br/><a href="https://www.airbornemuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Airborne Museum Oosterbeek</a>'),q.includes("Overloon")&&(W+='<br/><a href="https://www.oorlogsmuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Oorlogsmuseum Overloon</a>'),W+="</div>";else if(L.date&&(W+=`<br/><span class="text-xs text-gray-500">${L.date}</span>`),L.description?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Op deze plek vonden historische gevechten plaats. Zoek lokaal naar infoborden of monumenten.</div>'),L.wikipedia){const ze=L.wikipedia.startsWith("http")?L.wikipedia:`https://nl.wikipedia.org/wiki/${L.wikipedia.replace("nl:","")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="${ze}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(L.bron==="Paleobiology Database"){const q=Me=>{const He={Mollusca:"weekdieren zoals schelpen en slakken",Brachiopoda:"armpotigen, schelp-achtige dieren",Echinodermata:"stekelhuidigen zoals zee-egels en zeesterren",Chordata:"gewervelde dieren",Arthropoda:"geleedpotigen zoals kreeften en trilobieten",Cnidaria:"neteldieren zoals koralen en kwallen",Bryozoa:"mosdiertjes",Foraminifera:"eencellige schelpdieren",Plantae:"planten",Crinoidea:"zeelelies",Gastropoda:"slakken",Bivalvia:"tweekleppigen zoals mossels en oesters",Cephalopoda:"koppotigen zoals inktvissen en ammonieten",Trilobita:"trilobieten, uitgestorven kreeftachtigen",Mammalia:"zoogdieren",Reptilia:"reptielen",Pisces:"vissen",Amphibia:"amfibien"};for(const[$e,xt]of Object.entries(He))if(Me.toLowerCase().includes($e.toLowerCase()))return xt;return""},ce=Me=>{const He={Cambrium:"541-485 miljoen jaar geleden",Ordovicium:"485-444 miljoen jaar geleden",Siluur:"444-419 miljoen jaar geleden",Devoon:"419-359 miljoen jaar geleden",Carboon:"359-299 miljoen jaar geleden",Perm:"299-252 miljoen jaar geleden",Trias:"252-201 miljoen jaar geleden",Jura:"201-145 miljoen jaar geleden",Krijt:"145-66 miljoen jaar geleden",Paleogeen:"66-23 miljoen jaar geleden",Neogeen:"23-2,6 miljoen jaar geleden",Kwartair:"2,6 miljoen jaar - nu",Pleistoceen:"2,6 miljoen - 11.700 jaar geleden",Holoceen:"11.700 jaar geleden - nu"};for(const[$e,xt]of Object.entries(He))if(Me.toLowerCase().includes($e.toLowerCase()))return xt;return""},Re=Me=>{const He={limestone:"kalksteen",sandstone:"zandsteen",shale:"schalie",clay:"klei",sand:"zand",gravel:"grind",marl:"mergel",chalk:"krijt",mudstone:"moddersteen",siltstone:"siltsteen"};let $e=Me;for(const[xt,Rt]of Object.entries(He))$e=$e.replace(new RegExp(xt,"gi"),Rt);return $e},ze=Me=>{const He={marine:"zee",coastal:"kust",terrestrial:"land",fluvial:"rivier",lacustrine:"meer",reef:"rif",deltaic:"delta",shallow:"ondiep water",deep:"diep water"};let $e=Me;for(const[xt,Rt]of Object.entries(He))$e=$e.replace(new RegExp(xt,"gi"),Rt);return $e};if(L.vindplaats&&(W+=`<br/><span class="text-xs text-gray-600">${L.vindplaats}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',L.taxonomie&&L.taxonomie!=="Onbekend"){const Me=q(L.taxonomie);Me?(W+=`<div class="text-sm text-gray-700 mt-1">${Me}</div>`,W+=`<div class="text-xs text-gray-500 italic">(${L.taxonomie})</div>`):W+=`<div class="text-sm text-gray-700 mt-1">${L.taxonomie}</div>`}if(L.aantal_fossielen){const Me=parseInt(L.aantal_fossielen),He=Me>100?"Veel fossielen gevonden op deze locatie.":Me>10?"Meerdere fossielen gevonden op deze locatie.":`${L.aantal_fossielen} fossiel${Me>1?"en":""} gevonden op deze locatie.`;W+=`<div class="text-sm text-gray-600 mt-1">${He}</div>`}if(L.periode&&L.periode!=="Onbekend"){W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wanneer leefden deze dieren?</span></div>';const Me=ce(L.periode);W+=`<div class="text-sm text-gray-700 mt-1">${L.periode}</div>`,Me&&(W+=`<div class="text-sm text-gray-600">${Me}</div>`),L.ouderdom&&L.ouderdom!=="Onbekend"&&(W+=`<div class="text-sm text-gray-600">Ouderdom: ${L.ouderdom}</div>`)}(L.gesteente||L.formatie||L.milieu)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">In wat voor gesteente?</span></div>',L.gesteente&&(W+=`<div class="text-sm text-gray-700 mt-1">${Re(L.gesteente)}</div>`),L.formatie&&(W+=`<div class="text-sm text-gray-600">Formatie: ${L.formatie}</div>`,L.lid&&(W+=`<div class="text-sm text-gray-600 ml-3">Lid: ${L.lid}</div>`)),L.milieu&&(W+=`<div class="text-sm text-gray-600">Leefomgeving: ${ze(L.milieu)}</div>`))}if(L.layerType==="fossielHotspot"){const q=[];if(L.type&&q.push(L.type),L.region&&q.push(L.region),L.country){const ce={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};q.push(ce[L.country]||L.country)}if(q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${q.join("  ")}</span>`),(L.finds||L.period)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',L.finds&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.finds}</div>`),L.period&&(W+=`<div class="text-sm text-gray-600 mt-1">Periode: ${L.period}</div>`),L.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${L.geology}</div>`)),L.access||L.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',L.access){const Re=L.access.toLowerCase().includes("verboden")||L.access.toLowerCase().includes("niet toegankelijk")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${Re} mt-1">${L.access}</div>`}L.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${L.tips}</div>`)}}if(L.layerType==="mineralenHotspot"){const q=[];if(L.region&&q.push(L.region),L.country){const ce={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};q.push(ce[L.country]||L.country)}if(q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${q.join("  ")}</span>`),L.minerals&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.minerals}</div>`,L.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${L.geology}</div>`)),L.access||L.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',L.access){const Re=L.access.toLowerCase().includes("verboden")||L.access.toLowerCase().includes("niet toegankelijk")||L.access.toLowerCase().includes("gesloten")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${Re} mt-1">${L.access}</div>`}L.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${L.tips}</div>`)}}if(L.layerType==="goudrivier"){const q=[];if(L.river&&q.push(L.river),L.region&&q.push(L.region),L.country){const ce={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};q.push(ce[L.country]||L.country)}if(q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${q.join("  ")}</span>`),(L.goldType||L.origin)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',L.goldType&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.goldType}</div>`),L.origin&&(W+=`<div class="text-sm text-gray-600 mt-1">Herkomst: ${L.origin}</div>`)),L.legal||L.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Mag ik hier zoeken?</span></div>',L.legal){const Re=L.legal.includes("VERBODEN")?"text-red-600 font-semibold":"text-gray-700";W+=`<div class="text-sm ${Re} mt-1">${L.legal}</div>`}L.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${L.tips}</div>`)}}if(L.layerType==="wandelroute"){const q=[];if(L.region&&q.push(L.region),L.country){const ce={NL:"Nederland",BE:"Belgi"};q.push(ce[L.country]||L.country)}if(q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${q.join("  ")}</span>`),L.distance||L.duration){const ce=L.distance?`${L.distance} km`:"",Re=L.duration?`${L.duration}`:"",ze=[ce,Re].filter(Boolean).join("  ");ze&&(W+=`<br/><span class="text-sm text-green-700 font-medium">${ze}</span>`)}(L.description||L.highlights)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat ga je zien?</span></div>',L.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`),L.highlights&&(W+=`<div class="text-sm text-gray-600 mt-1">Hoogtepunten: ${L.highlights}</div>`)),L.startAddress&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waar begin ik?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.startAddress}</div>`),L.url&&(W+=`<div class="mt-3"><a href="${L.url}" target="_blank" class="text-sm text-blue-600 hover:underline">Bekijk route en download GPX</a></div>`)}if(L.layerType==="hunebed"){L.period&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${L.period}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',L.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${L.description}</div>`);const q=[];if(L.stones){const ce=L.stones.toLowerCase(),Re=ce.match(/(\d+)\s*dekst[^\s,]*/i),ze=ce.match(/(\d+)\s*draagst[^\s,]*/i),Me=ce.match(/(\d+)\s*sluitst[^\s,]*/i),He=ce.match(/(\d+)\s*poortst[^\s,]*/i),$e=ce.match(/(\d+)\s*gangdekst[^\s,]*/i),xt=ce.match(/(\d+)\s*gangzijst[^\s,]*/i);Re&&q.push(`${Re[1]} deksteen${parseInt(Re[1])>1?"en":""} (de grote steen${parseInt(Re[1])>1?"en":""} bovenop)`),ze&&q.push(`${ze[1]} draagstenen (de stenen die de dekstenen dragen)`),Me&&q.push(`${Me[1]} sluitsteen${parseInt(Me[1])>1?"en":""} (afsluiting aan de korte zijden)`),He&&q.push(`${He[1]} poortsteen${parseInt(He[1])>1?"en":""} (bij de ingang)`),$e&&q.push(`${$e[1]} gangdeksteen${parseInt($e[1])>1?"en":""} (boven de toegangsgang)`),xt&&q.push(`${xt[1]} gangzijstenen (langs de toegangsgang)`)}if(L.length&&q.push(`Een grafkamer van ${L.length} lang`),L.width&&q.push(`${L.width}`),q.length>0&&(W+='<div class="text-sm text-gray-700 mt-1">Het hunebed heeft:</div>',W+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',q.forEach(ce=>{W+=`<li>${ce}</li>`}),W+="</ul>"),L.notable){const ce=L.notable.toLowerCase();let Re="Wat is hier bijzonder?";ce.includes("grootste")?Re="Waarom is dit het grootste hunebed?":ce.includes("klein")||ce.includes("kindhunebed")?Re="Waarom is dit hunebed zo klein?":ce.includes("cluster")||ce.includes("naast elkaar")?Re="Waarom liggen hier meerdere hunebedden?":(ce.includes("enige")||ce.includes("westelijk")||ce.includes("noordelijk"))&&(Re="Wat maakt deze locatie bijzonder?"),W+=`<div class="mt-3"><span class="text-sm font-semibold text-gray-800">${Re}</span></div>`,W+=`<div class="text-sm text-gray-700 mt-1">${L.notable}</div>`}W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de Trechterbeker cultuur?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">De Trechterbeker cultuur is de naam voor de mensen die 5.000 jaar geleden in Nederland woonden. Ze maakten potten met een trechter-vorm. Daarom heten ze zo. Deze mensen bouwden de hunebedden als graven voor hun doden.</div>',L.finds&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.finds}</div>`),L.museum&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Museum in de buurt</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${L.museum}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',L.access?W+=`<div class="text-sm text-gray-700 mt-1">${L.access}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Je kunt dit hunebed gratis bezoeken.</div>',L.wikipedia&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${L.wikipedia}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`)}if((L.inventarisnummer||L.locatie_naam)&&(L.locatie_naam&&(W+=`<br/><span class="text-sm font-semibold">${L.locatie_naam}</span>`),L.inventarisnummer&&(W+=`<br/><span class="text-xs text-gray-500">CAI: ${L.inventarisnummer}</span>`),L.datering_tekst&&(W+=`<br/><span class="text-sm text-purple-700">${L.datering_tekst}</span>`)),(L.veensoort||L.dikte)&&(L.veensoort&&(W+=`<br/><span class="text-sm text-amber-700">${L.veensoort}</span>`),L.dikte&&(W+=`<br/><span class="text-xs text-gray-600">Dikte: ${L.dikte}</span>`)),L.nature&&L.debut){W+=`<br/><span class="text-sm text-purple-700">${L.nature}</span>`;const q=L.debut===L.fin?L.debut:`${L.debut} - ${L.fin}`;q&&(W+=`<br/><span class="text-sm text-gray-700">Periode: ${q}</span>`),L.structure&&(W+=`<br/><span class="text-xs text-gray-600">${L.structure}</span>`),L.commune&&(W+=`<br/><span class="text-xs text-gray-500">${L.commune}</span>`),L.decouvert&&(W+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${L.decouvert}</span>`),L.numero&&(W+=`<br/><span class="text-xs text-gray-400">${L.numero}</span>`)}if((L.NATURE_OPE||L.CODE_OPERA)&&(L.TITRE&&(W+=`<br/><span class="text-sm font-semibold">${L.TITRE}</span>`),L.NATURE_OPE&&(W+=`<br/><span class="text-sm text-amber-700">${L.NATURE_OPE}</span>`),L.AUTEUR&&(W+=`<br/><span class="text-xs text-gray-600">Auteur: ${L.AUTEUR}</span>`),L.DATE&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${L.DATE}</span>`),L.COMMUNE&&(W+=`<br/><span class="text-xs text-gray-500">${L.COMMUNE}</span>`)),L.type_protection&&(L.n_site||L.t_site)){const q=L.type_protection==="Classe"?"text-red-700":"text-amber-700";W+=`<br/><span class="text-sm ${q}">${L.type_protection}</span>`,L.n_site&&(W+=`<br/><span class="text-sm font-semibold">${L.n_site}</span>`),L.t_site&&(W+=`<br/><span class="text-xs text-gray-600">${L.t_site}</span>`),L.c_site&&(W+=`<br/><span class="text-xs text-gray-500">Code: ${L.c_site}</span>`),L.d_creation&&(W+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${L.d_creation}</span>`)}if(L.type_protection&&L.cod_diren){const q=L.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${q}">${L.type_protection}</span>`,L.proced&&(W+=`<br/><span class="text-xs text-gray-600">${L.proced}</span>`),L.d_proced&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${L.d_proced}</span>`),L.comment){const ce=String(L.comment).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${ce}${String(L.comment).length>150?"...":""}</span>`}}if(L.type_protection&&L.nomsite){const q=L.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${q}">${L.type_protection}</span>`,L.caractere&&(W+=`<br/><span class="text-xs text-gray-600">${L.caractere}</span>`),L.datedecis&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${L.datedecis}</span>`),L.descriptio){const ce=String(L.descriptio).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${ce}${String(L.descriptio).length>150?"...":""}</span>`}}if(L.secteur&&L.style){if(W+=`<br/><span class="text-sm text-gray-700">${L.secteur}</span>`,L["sous-secteur"]&&(W+=`<br/><span class="text-xs text-gray-600">${L["sous-secteur"]}</span>`),L.description){const q=String(L.description).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${q}${String(L.description).length>150?"...":""}</span>`}L.url&&(W+=`<br/><a href="${L.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(L.nature_operation||L.synthese){L.nature_operation&&(W+=`<br/><span class="text-sm text-red-700">${L.nature_operation}</span>`),L.responsable_operation&&(W+=`<br/><span class="text-xs text-gray-600">Responsable: ${L.responsable_operation}</span>`),L.date_operation&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${L.date_operation}</span>`);const q=[];if(L.prehistoire==="Oui"&&q.push("Prehistorie"),L.protohistoire==="Oui"&&q.push("Protohistorie"),L.antiquite==="Oui"&&q.push("Romeins"),L.moyen_age==="Oui"&&q.push("Middeleeuwen"),L.temps_modernes==="Oui"&&q.push("Moderne tijd"),q.length>0&&(W+=`<br/><span class="text-sm text-purple-700">${q.join(", ")}</span>`),L.adresse&&(W+=`<br/><span class="text-xs text-gray-500">${L.adresse}</span>`),L.synthese){const ce=String(L.synthese).slice(0,200);W+=`<br/><span class="text-xs text-gray-600 italic">${ce}${String(L.synthese).length>200?"...":""}</span>`}}if(L.operator&&(W+=`<br/><span class="text-sm text-gray-600">${L.operator}</span>`),!ie){if(L.opening_hours){const q=pD(String(L.opening_hours));W+=`<br/><span class="text-xs text-green-600">Open: ${q}</span>`}L.website&&(W+=`<br/><a href="${L.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`)}if(L.addr_street){const q=[L.addr_street,L.addr_housenumber,L.addr_postcode].filter(Boolean).join(" ");W+=`<br/><span class="text-xs text-gray-500">${q}</span>`}const Pe=L.description||L.omschrijving||L.descr||L.info;Pe&&Pe!==ut&&(W+=`<br/><span class="text-sm text-gray-600">${Pe}</span>`),an.push(W),Mt.push({geometry:Zi(jt),properties:L,popupHtml:W})}const rn=n.getView().getResolution()||1,Tr=await xn(Tt.coordinate,rn);an.push(...Tr);for(const _e of Tr)Mt.push(null);const je=await Mr;if(an.length===0&&je!==null){const _e=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${je.toFixed(2)} m NAP</span>
          </div>`;an.push(_e),Mt.push(null)}if(an.length>0&&je!==null&&(an[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${je.toFixed(2)} m NAP</span>
        </div>`),an.length>0){l(an),ee(Mt),h(0),console.log(` KLIK OPGESLAGEN: [${Tt.coordinate[0].toFixed(0)}, ${Tt.coordinate[1].toFixed(0)}]`),y(Tt.coordinate),w(!1),z(!1),ae(!1),V(""),xe(null);const _e=Tn(Tt.coordinate);Ge(_e),A(`https://www.google.com/maps/dir/?api=1&destination=${_e[1]},${_e[0]}`),O(`https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=${_e[1]},${_e[0]}`),m(!0)}};return n.on("click",An),()=>{n.un("click",An)}},[n]);const Sr=()=>{m(!1),ye("half"),n&&_&&(YR(n),w(!1))},oi=(_t,xn)=>{const An=xn.velocity.y,Tt=xn.offset.y;Be==="half"?Tt<-50||An<-500?ye("full"):(Tt>100||An>500)&&Sr():(Tt>50||An>300)&&ye("half")};return f.jsx(In,{children:g&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:Sr}),f.jsxs(wt.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl overflow-hidden flex flex-col",style:{fontSize:`${14*he/100}px`,height:Be==="full"?"90vh":"auto",maxHeight:Be==="full"?"90vh":"35vh"},initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0,bottom:0},dragElastic:.3,onDragEnd:oi,children:[f.jsx("div",{className:"flex justify-center pt-2 pb-1 cursor-grab active:cursor-grabbing",onClick:()=>ye(Be==="half"?"full":"half"),children:f.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),f.jsxs("div",{className:"flex items-center gap-2 px-3 pb-2 border-b border-gray-100",children:[Et&&f.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[f.jsx("button",{onClick:un,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Vorige laag",children:f.jsx(nce,{size:18})}),f.jsxs("span",{className:"text-gray-500 font-medium min-w-[32px] text-center",style:{fontSize:"0.857em"},children:[c+1,"/",o.length]}),f.jsx("button",{onClick:sr,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Volgende laag",children:f.jsx(_g,{size:18})})]}),f.jsx("span",{className:"flex-1 font-semibold text-gray-800 truncate",style:{fontSize:"1em"},children:Xt||"Info"}),Ce&&f.jsxs("div",{className:"relative",children:[f.jsx("button",{onClick:()=>z(!P),className:`p-1.5 transition-colors flex-shrink-0 border-0 outline-none bg-transparent ${F?"text-green-500":"text-orange-500 hover:text-orange-600"}`,title:"Toevoegen aan mijn laag","aria-label":"Toevoegen aan mijn laag",children:F?f.jsx(uc,{size:18}):f.jsx(Xa,{size:18})}),P&&f.jsxs("div",{className:"absolute right-0 top-full mt-1 z-50 bg-white rounded-lg shadow-lg border border-gray-200 py-1 min-w-[180px] max-w-[220px]",children:[f.jsx("div",{className:"px-3 py-1 text-xs text-gray-400 font-medium",children:"Toevoegen aan:"}),f.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:i.filter(_t=>!_t.archived).map(_t=>f.jsxs("button",{onClick:()=>{const xn=re;s(_t.id,{name:Xt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[Ce[0],Ce[1]],sourceLayer:Xt,geometry:xn?.geometry,sourceProperties:xn?.properties,popupContent:xn?.popupHtml}),z(!1),xe(_t.name),setTimeout(()=>xe(null),2e3)},className:"w-full px-3 py-1.5 text-left text-sm text-gray-700 hover:bg-blue-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[f.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:_t.color}}),f.jsx("span",{className:"truncate",children:_t.name})]},_t.id))}),f.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:ke?f.jsxs("div",{className:"px-2 py-1",children:[f.jsx("input",{type:"text",value:Z,onChange:_t=>V(_t.target.value),placeholder:"Naam nieuwe laag...",className:"w-full px-2 py-1 text-sm border border-gray-200 rounded focus:outline-none focus:border-orange-400",autoFocus:!0,onKeyDown:_t=>{if(_t.key==="Enter"&&Z.trim()){const xn=a(Z.trim()),An=re;s(xn,{name:Xt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[Ce[0],Ce[1]],sourceLayer:Xt,geometry:An?.geometry,sourceProperties:An?.properties,popupContent:An?.popupHtml}),z(!1),ae(!1),V(""),xe(Z.trim()),setTimeout(()=>xe(null),2e3)}else _t.key==="Escape"&&(ae(!1),V(""))}}),f.jsxs("div",{className:"flex gap-1 mt-1",children:[f.jsx("button",{onClick:()=>{if(Z.trim()){const _t=a(Z.trim()),xn=re;s(_t,{name:Xt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[Ce[0],Ce[1]],sourceLayer:Xt,geometry:xn?.geometry,sourceProperties:xn?.properties,popupContent:xn?.popupHtml}),z(!1),ae(!1),V(""),xe(Z.trim()),setTimeout(()=>xe(null),2e3)}},disabled:!Z.trim(),className:"flex-1 px-2 py-1 text-xs bg-orange-500 text-white rounded disabled:opacity-50",children:"Toevoegen"}),f.jsx("button",{onClick:()=>{ae(!1),V("")},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700",children:"Annuleer"})]})]}):f.jsxs("button",{onClick:()=>ae(!0),className:"w-full px-3 py-1.5 text-left text-sm text-orange-600 hover:bg-orange-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[f.jsx(Xa,{size:14}),f.jsx("span",{children:"Nieuwe laag maken..."})]})})]})]}),C&&f.jsx("a",{href:C,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-amber-500 hover:text-amber-600 transition-colors flex-shrink-0",title:"Open Street View","aria-label":"Open Street View",children:f.jsx(AV,{size:18})}),k&&f.jsx("a",{href:k,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-blue-500 hover:text-blue-600 transition-colors flex-shrink-0",title:"Navigeer naar locatie","aria-label":"Open in Google Maps",children:f.jsx(Iu,{size:18})}),f.jsx("button",{onClick:Sr,className:"p-1.5 text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0 border-0 outline-none bg-transparent","aria-label":"Sluiten",children:f.jsx(Xr,{size:18})})]}),f.jsx("div",{className:`px-4 py-3 overflow-y-auto select-text min-h-0 ${Be==="full"?"flex-1":""}`,style:{userSelect:"text",WebkitUserSelect:"text"},dangerouslySetInnerHTML:{__html:ot}}),f.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 flex items-center gap-2 flex-shrink-0",children:[f.jsx(CV,{size:14,className:"text-gray-400 flex-shrink-0"}),f.jsx("input",{type:"range",min:"80",max:"150",value:he,onChange:_t=>pe(parseInt(_t.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),f.jsxs("span",{className:"text-gray-400 w-8 text-right",style:{fontSize:"0.857em"},children:[he,"%"]})]}),dn&&R&&!D&&f.jsxs("div",{className:"px-4 pb-4 flex gap-2 flex-shrink-0",children:[f.jsxs("button",{onClick:()=>{const _t=r.find(xn=>xn.id===R);_t&&B(_t)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(ig,{size:16}),f.jsx("span",{children:"Bewerken"})]}),f.jsxs("button",{onClick:()=>{e(R),m(!1),M(null)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(_c,{size:16}),f.jsx("span",{children:"Verwijderen"})]})]}),D&&f.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-gray-100 pt-3 flex-shrink-0 overflow-y-auto max-h-[40vh]",children:[f.jsx("div",{className:"text-sm font-medium text-blue-600",children:"Vondst bewerken"}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Objecttype"}),f.jsx("input",{type:"text",value:D.objectType,onChange:_t=>B({...D,objectType:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Materiaal"}),f.jsx("input",{type:"text",value:D.material,onChange:_t=>B({...D,material:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Periode"}),f.jsx("input",{type:"text",value:D.period,onChange:_t=>B({...D,period:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Notities"}),f.jsx("textarea",{value:D.notes,onChange:_t=>B({...D,notes:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50 resize-none h-16"})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>B(null),className:"flex-1 px-3 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none text-sm",children:"Annuleren"}),f.jsx("button",{onClick:()=>{t(D.id,{objectType:D.objectType,material:D.material,period:D.period,notes:D.notes}),B(null),m(!1)},className:"flex-1 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none text-sm",children:"Opslaan"})]})]}),tr&&x&&f.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:_?f.jsxs("button",{onClick:Bn,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(rg,{size:16}),f.jsx("span",{children:"Hoogtekaart verbergen"})]}):f.jsx("button",{onClick:Mi,disabled:T,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-white rounded-lg transition-colors border-0 outline-none ${T?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:T?f.jsxs(f.Fragment,{children:[f.jsx(HI,{size:16,className:"animate-spin"}),f.jsx("span",{children:"Laden..."})]}):f.jsxs(f.Fragment,{children:[f.jsx(rg,{size:16}),f.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}const yD=1e-4;function PTe(n,e){return n.points.some(t=>{const r=Math.abs(t.coordinates[0]-e[0]),i=Math.abs(t.coordinates[1]-e[1]);return r<yD&&i<yD})}function NTe(){const n=pi(O=>O.map),e=wr(O=>O.openVondstForm),{openAddPointModal:t,openCreateLayerModal:r,openLayerManagerModal:i}=wr(),s=fs(O=>O.layers),[a,o]=H.useState(null),[l,c]=H.useState(!1),[h,g]=H.useState(!1),[m,x]=H.useState(!1),y=H.useRef(null),_=H.useRef(null);H.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const O=n.getViewport();if(!O){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",O);const P=600,z=15,F=ae=>{if(console.log(" Touch start, touches:",ae.touches.length),ae.touches.length!==1)return;const Z=ae.touches[0];_.current={x:Z.clientX,y:Z.clientY},console.log(" Starting long press timer at:",_.current),y.current&&clearTimeout(y.current),y.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",_.current),!_.current)return;const V=window.__olMap;if(!V){console.log(" Map not available (global)");return}const Q=O.getBoundingClientRect(),ee=[_.current.x-Q.left,_.current.y-Q.top],re=V.getCoordinateFromPixel(ee);if(re){const he=Tn(re);ae.preventDefault(),o({pixel:[_.current.x,_.current.y],coordinate:he}),c(!0),g(!1),setTimeout(()=>g(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",he)}},P)},xe=ae=>{if(!y.current||!_.current)return;const Z=ae.touches[0],V=Z.clientX-_.current.x,Q=Z.clientY-_.current.y,ee=Math.sqrt(V*V+Q*Q);ee>z&&(console.log(" Touch moved too much, cancelling. Distance:",ee),clearTimeout(y.current),y.current=null)},Ce=()=>{console.log(" Touch end, timer active:",!!y.current),y.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(y.current),y.current=null),_.current=null},Ge=ae=>{l&&ae.preventDefault()},Ne=ae=>{ae.button===0&&(console.log(" Mouse down"),_.current={x:ae.clientX,y:ae.clientY},y.current&&clearTimeout(y.current),y.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!_.current)return;const Z=window.__olMap;if(console.log(" __olMap:",Z),console.log(" __olMap constructor:",Z?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof Z?.getCoordinateAtPixel),!Z){console.log(" Map not available (global)");return}const V=O.getBoundingClientRect(),Q=[_.current.x-V.left,_.current.y-V.top];console.log(" Pixel:",Q);const ee=Z.getCoordinateFromPixel(Q);if(console.log(" Coordinate:",ee),ee){const re=Tn(ee);o({pixel:[_.current.x,_.current.y],coordinate:re}),c(!0),g(!1),setTimeout(()=>g(!0),300),console.log(" Long press (mouse) detected at:",re)}},P))},ue=ae=>{if(!y.current||!_.current)return;const Z=ae.clientX-_.current.x,V=ae.clientY-_.current.y;Math.sqrt(Z*Z+V*V)>z&&(console.log(" Mouse moved, cancelling"),clearTimeout(y.current),y.current=null)},ke=()=>{console.log(" Mouse up"),y.current&&(clearTimeout(y.current),y.current=null),_.current=null};return O.addEventListener("touchstart",F,{passive:!1}),O.addEventListener("touchmove",xe,{passive:!0}),O.addEventListener("touchend",Ce),O.addEventListener("touchcancel",Ce),O.addEventListener("contextmenu",Ge),O.addEventListener("mousedown",Ne),O.addEventListener("mousemove",ue),O.addEventListener("mouseup",ke),O.addEventListener("mouseleave",ke),()=>{O.removeEventListener("touchstart",F),O.removeEventListener("touchmove",xe),O.removeEventListener("touchend",Ce),O.removeEventListener("touchcancel",Ce),O.removeEventListener("contextmenu",Ge),O.removeEventListener("mousedown",Ne),O.removeEventListener("mousemove",ue),O.removeEventListener("mouseup",ke),O.removeEventListener("mouseleave",ke),y.current&&clearTimeout(y.current)}},[n,l]);const w=()=>{h&&(c(!1),o(null),g(!1),x(!1))},T=()=>{c(!1),o(null),g(!1),x(!1)},b=O=>{if(!a)return;const[P,z]=a.coordinate;t(O,{lat:z,lng:P}),T()},R=()=>{r(),T()},M=()=>{if(!a)return;const[O,P]=a.coordinate;e({lat:P,lng:O}),c(!1),o(null),g(!1)},D=()=>{if(!a)return;const[O,P]=a.coordinate,z=`https://www.google.com/maps?q=${P},${O}`;window.open(z,"_blank"),c(!1),o(null),g(!1)},B=()=>{if(!a)return;const[O,P]=a.coordinate,z=`https://www.google.com/maps?layer=c&cbll=${P},${O}`;window.open(z,"_blank"),T()},k=()=>{if(!a)return;const O=document.createElement("input");O.type="file",O.accept="image/*",O.capture="environment",O.onchange=async P=>{const z=P.target.files?.[0];if(!z)return;const[F,xe]=a.coordinate;e({lat:xe,lng:F},z)},O.click(),T()},A=()=>{i(),T()},C=O=>{const[P,z]=O;return`${z.toFixed(5)}N, ${P.toFixed(5)}E`};return f.jsx(In,{children:l&&a&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:w}),f.jsxs(wt.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(a.pixel[0],window.innerWidth-220),top:(()=>{const O=m?480:380;return window.innerHeight-a.pixel[1]<O&&a.pixel[1]>O?a.pixel[1]-O+40:Math.min(a.pixel[1],window.innerHeight-O)})()},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[f.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:f.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[f.jsx(As,{size:16}),f.jsx("span",{className:"text-xs font-mono",children:C(a.coordinate)})]})}),f.jsxs("div",{className:"bg-white",children:[f.jsxs("button",{onClick:M,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(i1,{size:20,className:"text-orange-500"}),f.jsx("span",{className:"font-medium",children:"Vondst toevoegen"})]}),f.jsxs("button",{onClick:k,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(OE,{size:20,className:"text-green-500"}),f.jsx("span",{className:"font-medium",children:"Foto maken"})]}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{onClick:()=>x(!m),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(za,{size:20,className:"text-purple-500"}),f.jsx("span",{className:"font-medium flex-1 text-left",children:"Voeg toe aan laag..."}),f.jsx(_g,{size:16,className:`text-gray-400 transition-transform ${m?"rotate-90":""}`})]}),f.jsx(In,{children:m&&f.jsx(wt.div,{className:"bg-gray-50 border-t border-gray-100",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:s.length===0?f.jsxs("button",{onClick:R,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none",children:[f.jsx(Xa,{size:14}),f.jsx("span",{children:"Maak eerst een laag aan"})]}):f.jsxs(f.Fragment,{children:[s.map(O=>{const P=a?PTe(O,a.coordinate):!1;return f.jsxs("button",{onClick:()=>!P&&b(O.id),className:`w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm bg-transparent border-0 outline-none ${P?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,title:P?"Al toegevoegd aan deze laag":void 0,disabled:P,children:[P&&f.jsx(uc,{size:14,className:"text-green-500 flex-shrink-0"}),f.jsx("span",{className:"truncate",children:O.name}),f.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:P?"al toegevoegd":`(${O.points.length})`})]},O.id)}),f.jsxs("button",{onClick:R,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none border-t border-gray-200",children:[f.jsx(Xa,{size:14}),f.jsx("span",{children:"Nieuwe laag..."})]})]})})})]}),f.jsxs("button",{onClick:A,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(Due,{size:20,className:"text-purple-500"}),f.jsx("span",{className:"font-medium",children:"Lagen beheren"})]}),f.jsxs("button",{onClick:D,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(Iu,{size:20,className:"text-blue-600"}),f.jsx("span",{className:"font-medium",children:"Open in Google Maps"})]}),f.jsxs("button",{onClick:B,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(AV,{size:20,className:"text-yellow-600"}),f.jsx("span",{className:"font-medium",children:"Street View"})]})]}),f.jsx("div",{className:"bg-white",children:f.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[f.jsx(Xr,{size:18}),f.jsx("span",{children:"Annuleren"})]})})]})]})})}const MTe={Compass:Ece,TreePalm:she,Mountain:rg,Waves:phe,Search:a1,Target:ehe,Layers:za,Grid:SV},LTe={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},OTe={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},_D=["Mijn Vondsten","Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","FAMKE IJzertijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Onderzoeken","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","Runes","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","Hoogtekaart (WebGL)","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Ruiterpaden","Laarzenpaden","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],DTe=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"],jTe=[5.2913,52.1326],FTe=8;function VTe(){const n=Ri(P=>P.setLayerVisibility),e=Wi(P=>P.stopTracking),t=pi(P=>P.map),{presetsPanelOpen:r,togglePresetsPanel:i,closeAllPanels:s}=wr(),{presets:a,applyPreset:o,updatePreset:l,createPreset:c,resetToDefaults:h}=G9(),g=Ri(P=>P.visible),m=yn(P=>P.presetPanelFontScale),x=yn(P=>P.setPresetPanelFontScale),y=yn(P=>P.showFontSliders),_=12*m/100,[w,T]=H.useState(null),[b,R]=H.useState(!1),[M,D]=H.useState(""),B=()=>{s(),_D.forEach(P=>n(P,!1)),DTe.forEach(P=>{n(P,P==="CartoDB (licht)")}),e(),t&&t.getView().animate({center:kr(jTe),zoom:FTe,duration:500}),console.log(" Reset: CartoDB, alle lagen uit, GPS uit, zoom naar Nederland")},k=P=>{o(P),s()},A=(P,z)=>{P.stopPropagation();const F=Object.entries(g).filter(([xe,Ce])=>Ce&&_D.includes(xe)).map(([xe])=>xe);l(z,{layers:F}),T(z),setTimeout(()=>T(null),2e3),console.log(" Lagen opgeslagen naar preset")},C=()=>{M.trim()&&(c(M.trim(),"Layers"),D(""),R(!1))},O=()=>{confirm("Alle presets terugzetten naar standaard? Dit verwijdert aangepaste presets.")&&h()};return f.jsxs(f.Fragment,{children:[f.jsx(wt.button,{onClick:B,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - CartoDB, alle lagen uit, GPS uit",children:f.jsx(bue,{size:20,className:"text-gray-600"})}),f.jsx(wt.button,{onClick:i,className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?f.jsx(zI,{size:20,className:"text-blue-600"}):f.jsx(za,{size:20,className:"text-blue-600"})}),f.jsx(In,{children:r&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i}),f.jsxs(wt.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[60px] left-[56px] bg-white/95 rounded-xl shadow-lg overflow-hidden w-[240px] backdrop-blur-sm z-[801]",children:[f.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",style:{fontSize:`${_}px`},children:[f.jsx("span",{className:"font-medium text-white",children:"Presets"}),y&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:m,onInput:P=>{x(parseInt(P.target.value))},onChange:P=>x(parseInt(P.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${m}%`}),f.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),f.jsx("div",{className:"p-2 max-h-[300px] overflow-y-auto",children:a.map(P=>{const z=MTe[P.icon]||za,F=LTe[P.icon]||"text-blue-600",xe=OTe[P.icon]||"hover:bg-blue-50",Ce=w===P.id;return f.jsxs("button",{onClick:()=>k(P.id),className:`w-full h-8 flex items-center gap-2 px-2 ${xe} rounded text-left transition-colors border-0 outline-none bg-transparent overflow-hidden ${Ce?"bg-green-50":""}`,style:{fontSize:`${_}px`},children:[f.jsx(z,{size:14,className:`${F} flex-shrink-0`}),f.jsx("span",{className:"text-gray-700 truncate flex-1",children:P.name}),Ce?f.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:f.jsx(uc,{size:14,className:"text-green-500"})}):f.jsx("span",{onClick:Ge=>A(Ge,P.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan naar deze preset",children:f.jsx(IV,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},P.id)})}),f.jsx("div",{className:"border-t border-gray-200 p-2",children:b?f.jsxs("div",{className:"flex gap-1",children:[f.jsx("input",{type:"text",value:M,onChange:P=>D(P.target.value),onKeyDown:P=>{P.key==="Enter"&&C(),P.key==="Escape"&&R(!1)},placeholder:"Naam preset...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400",style:{fontSize:`${_}px`}}),f.jsx("button",{onClick:C,disabled:!M.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-sm disabled:opacity-50 border-0 outline-none",children:f.jsx(uc,{size:14})})]}):f.jsxs("div",{className:"flex gap-1",children:[f.jsxs("button",{onClick:()=>R(!0),className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",style:{fontSize:`${_}px`},children:[f.jsx(Xa,{size:14}),f.jsx("span",{children:"Nieuwe preset"})]}),f.jsx("button",{onClick:O,className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors border-0 outline-none",title:"Presets terugzetten naar standaard",children:f.jsx(Aue,{size:14})})]})})]})]})})]})}function BTe(){const n=pi(a=>a.map),[e,t]=H.useState(0),[r,i]=H.useState(!1);H.useEffect(()=>{if(!n)return;const a=n.getView(),o=()=>{const l=a.getRotation(),c=l*180/Math.PI;t(c),i(Math.abs(l)>.087)};return o(),a.on("change:rotation",o),()=>{a.un("change:rotation",o)}},[n]);const s=()=>{n&&n.getView().animate({rotation:0,duration:300})};return f.jsx(In,{children:r&&f.jsx(wt.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},onClick:s,className:"fixed top-[60px] right-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Klik om noorden te herstellen",children:f.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",style:{transform:`rotate(${-e}deg)`},children:[f.jsx("path",{d:"M12 2 L14.5 12 L12 10 L9.5 12 Z",fill:"#EA4335"}),f.jsx("path",{d:"M12 22 L9.5 12 L12 14 L14.5 12 Z",fill:"white",stroke:"#9CA3AF",strokeWidth:"0.5"}),f.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"#374151"})]})})})}const GTe=[{name:"AHN4 Hoogtekaart Kleur",color:"blue",default:.85},{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN 0.5m",color:"blue",default:.7},{name:"TMK 1850",color:"amber",default:.8},{name:"Bonnebladen 1900",color:"amber",default:.8},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"Veengebieden",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"Terpen",color:"orange",default:.7},{name:"Essen",color:"amber",default:.6},{name:"AMK Monumenten",color:"purple",default:.45},{name:"AMK Romeins",color:"red",default:.6},{name:"AMK Steentijd",color:"amber",default:.6},{name:"AMK Vroege ME",color:"green",default:.6},{name:"AMK Late ME",color:"blue",default:.6},{name:"AMK Overig",color:"purple",default:.6},{name:"Paleokaart 9000 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 5500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 2750 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 1500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 100 n.Chr.",color:"indigo",default:.7},{name:"Paleokaart 800 n.Chr.",color:"indigo",default:.7},{name:"Verdedigingslinies",color:"red",default:.7},{name:"Inundatiegebieden",color:"red",default:.5},{name:"Gewaspercelen",color:"green",default:.6},{name:"Erfgoedlijnen",color:"purple",default:.7},{name:"Oude Kernen",color:"orange",default:.6},{name:"Relictenkaart Vlakken",color:"green",default:.5}],zTe={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function UTe(){const[n,e]=H.useState(!1),[t,r]=H.useState(!1),i=Ri(h=>h.visible),s=Ri(h=>h.opacity),a=Ri(h=>h.setLayerOpacity),o=GTe.filter(h=>i[h.name]);if(o.length===0)return null;const l=t?o:o.slice(0,3),c=o.length>3;return f.jsxs("div",{className:"fixed bottom-[112px] right-2 z-[900]",children:[f.jsxs(wt.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[f.jsx(zue,{size:22,strokeWidth:2,className:"text-gray-500"}),o.length>0&&f.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:o.length})]}),f.jsx(In,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),f.jsxs(wt.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[f.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),f.jsx("div",{className:"space-y-3",children:l.map(h=>{const g=s[h.name]??h.default;return f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:h.name,children:h.name}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("input",{type:"range",min:"0",max:"100",value:g*100,onChange:m=>a(h.name,parseInt(m.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${zTe[h.color]}`}),f.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(g*100),"%"]})]})]},h.name)})}),c&&f.jsx("button",{onClick:()=>r(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?f.jsxs(f.Fragment,{children:[f.jsx(zI,{size:14}),"Minder tonen"]}):f.jsxs(f.Fragment,{children:[f.jsx(nx,{size:14}),o.length-3," meer..."]})})]})]})})]})}function $Te(){const n=pi(R=>R.map),[e,t]=H.useState(!1),[r,i]=H.useState(""),[s,a]=H.useState([]),[o,l]=H.useState(!1),[c,h]=H.useState(!1),g=H.useRef(null),m=H.useRef(null),x=H.useRef();H.useEffect(()=>{e&&g.current&&g.current.focus()},[e]),H.useEffect(()=>{if(!e)return;const R=M=>{m.current&&!m.current.contains(M.target)&&y()};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[e]),H.useEffect(()=>{if(!e)return;const R=M=>{M.key==="Escape"&&y()};return document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R)},[e]),H.useEffect(()=>{if(x.current&&clearTimeout(x.current),r.length<2){a([]);return}return x.current=window.setTimeout(async()=>{h(!0);try{const M=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();M.response?.docs&&a(M.response.docs)}catch(R){console.error("Search error:",R),a([])}finally{h(!1)}},300),()=>{x.current&&clearTimeout(x.current)}},[r]);const y=()=>{t(!1),i(""),a([]),l(!1)},_=async R=>{try{const D=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(R)}`)).json();if(D.response?.docs?.[0]?.centroide_ll){const k=D.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(k)return{lng:parseFloat(k[1]),lat:parseFloat(k[2])}}}catch(M){console.error("Lookup error:",M)}return null},w=async R=>{if(!n)return;const M=await _(R.id);M&&n.getView().animate({center:kr([M.lng,M.lat]),zoom:16,duration:1e3}),y()},T=async(R,M)=>{M.stopPropagation();const D=await _(R.id);if(D){const B=`https://www.google.com/maps?q=${D.lat},${D.lng}`;window.open(B,"_blank")}y()},b={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?f.jsxs("div",{ref:m,className:"fixed left-[52px] right-14 z-[850]",style:b,children:[f.jsxs(wt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[f.jsx(a1,{size:18,className:"search-icon"}),f.jsx("input",{ref:g,type:"text",value:r,onChange:R=>{i(R.target.value),l(!0)},onFocus:()=>l(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),f.jsx("button",{onClick:y,className:"search-clear",title:"Sluiten",children:f.jsx(Xr,{size:18})})]}),f.jsx(In,{children:o&&s.length>0&&f.jsx(wt.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(R=>f.jsxs("li",{className:"search-result-item",children:[f.jsx("div",{className:"search-result-content",onClick:()=>w(R),children:f.jsx("span",{className:"search-result-text",children:R.weergavenaam})}),f.jsx("button",{className:"search-navigate-btn",onClick:M=>T(R,M),title:"Open in Google Maps",children:f.jsx(Iu,{size:20})})]},R.id))})}),o&&c&&f.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):f.jsx(wt.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:b,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:f.jsx(a1,{size:22,className:"text-gray-600"})})}function WTe(){const n=pi(i=>i.map),e=()=>{if(!n)return;const i=n.getView(),s=i.getZoom();s!==void 0&&i.animate({zoom:s+1,duration:200})},t=()=>{if(!n)return;const i=n.getView(),s=i.getZoom();s!==void 0&&i.animate({zoom:s-1,duration:200})};return f.jsxs("div",{className:"fixed right-2 z-[800] flex flex-col gap-1",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[f.jsx(wt.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:f.jsx(Xa,{size:18,className:"text-gray-600"})}),f.jsx(wt.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:f.jsx(bV,{size:18,className:"text-gray-600"})})]})}const HTe="detector2024",tA="detectorapp-auth";function KTe({children:n}){const[e,t]=H.useState(!1),[r,i]=H.useState(""),[s,a]=H.useState(!1),[o,l]=H.useState(""),[c,h]=H.useState(!0);H.useEffect(()=>{localStorage.getItem(tA)==="authenticated"&&t(!0),h(!1)},[]);const g=m=>{m.preventDefault(),l(""),r===HTe?(localStorage.setItem(tA,"authenticated"),t(!0)):(l("Onjuist wachtwoord"),i(""))};return c?f.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center",children:f.jsx("div",{className:"text-white text-lg",children:"Laden..."})}):e?f.jsx(f.Fragment,{children:n}):f.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:f.jsxs(wt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[f.jsxs("div",{className:"text-center mb-6",children:[f.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:f.jsx(OR,{size:32,className:"text-blue-600"})}),f.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"DetectorApp"}),f.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Test versie - Toegang beveiligd"})]}),f.jsxs("form",{onSubmit:g,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wachtwoord"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:s?"text":"password",value:r,onChange:m=>i(m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none pr-12",placeholder:"Voer wachtwoord in",autoFocus:!0}),f.jsx("button",{type:"button",onClick:()=>a(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?f.jsx(Uv,{size:20}):f.jsx($v,{size:20})})]})]}),o&&f.jsx(wt.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:o}),f.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Inloggen"})]}),f.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Alleen voor testers"})]})})}function XTe(){localStorage.removeItem(tA),window.location.reload()}function qTe({isOpen:n,onClose:e}){const t=hl(l=>l.vondsten),r={total:t.length,byType:{},byMaterial:{},byPeriod:{},byCondition:{},avgDepth:0,totalWeight:0,recent:t.slice(-5).reverse()};let i=0,s=0;t.forEach(l=>{r.byType[l.objectType]=(r.byType[l.objectType]||0)+1,r.byMaterial[l.material]=(r.byMaterial[l.material]||0)+1,r.byPeriod[l.period]=(r.byPeriod[l.period]||0)+1,l.condition&&(r.byCondition[l.condition]=(r.byCondition[l.condition]||0)+1),l.depth&&(i+=l.depth,s++),l.weight&&(r.totalWeight+=l.weight)}),r.avgDepth=s>0?Math.round(i/s):0;const a=l=>Object.entries(l).sort((c,h)=>h[1]-c[1]),o=l=>Math.max(...Object.values(l),1);return f.jsx(In,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(wV,{size:18}),f.jsx("span",{className:"font-medium",children:"Mijn Vondsten Dashboard"})]}),f.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:f.jsx(Xr,{size:18})})]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:t.length===0?f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(As,{size:48,className:"mx-auto mb-3 opacity-30"}),f.jsx("p",{className:"font-medium",children:"Nog geen vondsten"}),f.jsx("p",{className:"text-sm mt-1",children:"Voeg je eerste vondst toe via de oranje knop of long-press op de kaart"})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[f.jsx(QT,{icon:f.jsx(As,{size:20}),value:r.total,label:"Totaal",color:"bg-orange-100 text-orange-700"}),f.jsx(QT,{icon:f.jsx(s1,{size:20}),value:r.avgDepth>0?`${r.avgDepth}cm`:"-",label:"Gem. diepte",color:"bg-blue-100 text-blue-700"}),f.jsx(QT,{icon:f.jsx(Nue,{size:20}),value:r.totalWeight>0?`${r.totalWeight.toFixed(1)}g`:"-",label:"Tot. gewicht",color:"bg-green-100 text-green-700"})]}),f.jsx(a_,{title:"Per Type",data:a(r.byType),max:o(r.byType),color:"bg-orange-500"}),f.jsx(a_,{title:"Per Periode",data:a(r.byPeriod),max:o(r.byPeriod),color:"bg-amber-500"}),f.jsx(a_,{title:"Per Materiaal",data:a(r.byMaterial),max:o(r.byMaterial),color:"bg-blue-500"}),Object.keys(r.byCondition).length>0&&f.jsx(a_,{title:"Per Conditie",data:a(r.byCondition),max:o(r.byCondition),color:"bg-green-500"}),f.jsxs("div",{children:[f.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[f.jsx(LE,{size:14}),"Recente Vondsten"]}),f.jsx("div",{className:"space-y-2",children:r.recent.map(l=>f.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{children:[f.jsx("span",{className:"font-medium text-sm text-gray-800",children:l.objectType}),f.jsx("span",{className:"text-gray-400 mx-1",children:"-"}),f.jsx("span",{className:"text-sm text-gray-600",children:l.material})]}),f.jsx("span",{className:"text-xs text-gray-400",children:new Date(l.timestamp).toLocaleDateString("nl-NL")})]},l.id))})]})]})})]})]})})}function QT({icon:n,value:e,label:t,color:r}){return f.jsxs("div",{className:`rounded-lg p-3 ${r}`,children:[f.jsx("div",{className:"flex items-center gap-2 mb-1 opacity-70",children:n}),f.jsx("div",{className:"text-xl font-bold",children:e}),f.jsx("div",{className:"text-xs opacity-70",children:t})]})}function a_({title:n,data:e,max:t,color:r}){return e.length===0?null:f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:n}),f.jsx("div",{className:"space-y-1.5",children:e.slice(0,6).map(([i,s])=>f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-24 text-xs text-gray-600 truncate",title:i,children:i}),f.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden",children:f.jsx(wt.div,{className:`h-full ${r} rounded-full`,initial:{width:0},animate:{width:`${s/t*100}%`},transition:{duration:.5,ease:"easeOut"}})}),f.jsx("div",{className:"w-6 text-xs text-gray-600 text-right font-medium",children:s})]},i))})]})}function YTe(n){const{type:e,coordinates:t}=n,r=o=>kr(o),i=o=>o.map(r),s=o=>o.map(i),a=o=>o.map(s);switch(e){case"Point":return new gi(r(t));case"LineString":return new bi(i(t));case"Polygon":return new Ha(s(t));case"MultiPoint":return new Nd(i(t));case"MultiLineString":return new ic(s(t));case"MultiPolygon":return new ld(a(t));default:return console.warn(`Unsupported geometry type: ${e}`),null}}function ZTe(n,e,t){const r=n.color,i=10,s=5,a=14;let o=i;if(t>50?o=s:t>10?o=Math.max(s,i-(t-10)/10):t<2&&(o=a),e==="Point"||e==="MultiPoint")return new pn({image:new Ws({radius:o,fill:new rr({color:r}),stroke:new Yn({color:"#ffffff",width:2})})});if(e==="LineString"||e==="MultiLineString")return new pn({stroke:new Yn({color:r,width:3})});if(e==="Polygon"||e==="MultiPolygon"){const l=JTe(r,.3);return new pn({fill:new rr({color:l}),stroke:new Yn({color:r,width:2})})}return new pn({image:new Ws({radius:o,fill:new rr({color:r}),stroke:new Yn({color:"#ffffff",width:2})})})}function JTe(n,e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);if(t){const r=parseInt(t[1],16),i=parseInt(t[2],16),s=parseInt(t[3],16);return`rgba(${r}, ${i}, ${s}, ${e})`}return n}function QTe(){const n=pi(r=>r.map),e=Z1(r=>r.layers),t=H.useRef(new Map);return H.useEffect(()=>{if(!n)return;const r=new Set;e.forEach(i=>{r.add(i.id);const s=new mc;i.features.features.forEach((o,l)=>{if(!o.geometry)return;const c=YTe(o.geometry);if(!c)return;const h=new _r({geometry:c,...o.properties,layerType:"importedLayer",layerId:i.id,layerName:i.name,layerColor:i.color,featureIndex:l});h.setStyle((g,m)=>ZTe(i,o.geometry.type,m)),s.addFeature(h)});const a=t.current.get(i.id);if(a)a.setSource(s),a.setVisible(i.visible),a.setOpacity(i.opacity);else{const o=new Hu({source:s,zIndex:900,visible:i.visible,opacity:i.opacity,properties:{title:i.name,customLayerId:i.id}});n.addLayer(o),t.current.set(i.id,o)}}),t.current.forEach((i,s)=>{r.has(s)||(n.removeLayer(i),t.current.delete(s))})},[n,e]),H.useEffect(()=>()=>{n&&(t.current.forEach(r=>{n.removeLayer(r)}),t.current.clear())},[n]),null}bn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");LB(bn);function ebe(n){if(!n||n.length<2)return"unknown";const[e,t]=n;return e>=7e3&&e<=3e5&&t>=289e3&&t<=629e3?"RD":Math.abs(e)<=180&&Math.abs(t)<=90?"WGS84":"unknown"}function tbe(n){const[e,t]=n;return bn("EPSG:28992","EPSG:4326",[e,t])}function mz(n,e){return typeof n[0]=="number"?e(n):n.map(t=>mz(t,e))}function nbe(n){const e=n.coordinates;return!e||Array.isArray(e)&&e.length===0?null:n.type==="Point"?e:n.type==="LineString"||n.type==="MultiPoint"?e[0]:n.type==="Polygon"||n.type==="MultiLineString"?e[0]?.[0]:n.type==="MultiPolygon"?e[0]?.[0]?.[0]:null}async function rbe(n){const e=[],t=[];try{const r=await n.text(),i=JSON.parse(r);if(!i.type)return e.push('Ongeldig GeoJSON: geen "type" veld gevonden'),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}};let s=[];i.type==="FeatureCollection"?s=i.features||[]:i.type==="Feature"?s=[i]:i.type==="GeometryCollection"?s=(i.geometries||[]).map((c,h)=>({type:"Feature",geometry:c,properties:{id:h}})):s=[{type:"Feature",geometry:i,properties:{}}],s.length===0&&t.push("Geen features gevonden in bestand");let a="unknown",o=!1;if(s.length>0&&s[0].geometry){const c=nbe(s[0].geometry);c&&(a=ebe(c))}a==="RD"&&(t.push("Rijksdriehoek coordinaten gedetecteerd, worden omgezet naar WGS84"),o=!0,s=s.map(c=>{if(!c.geometry)return c;const h=mz(c.geometry.coordinates,tbe);return{...c,geometry:{...c.geometry,coordinates:h}}}),a="WGS84");const l=[...new Set(s.filter(c=>c.geometry).map(c=>c.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:s},errors:e,warnings:t,metadata:{featureCount:s.length,geometryTypes:l,coordinateSystem:a,transformed:o}}}catch(r){return e.push(`Fout bij parsen: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function ibe(n){const e=[],t=[];try{const r=await n.text(),s=new s1e({extractStyles:!1}).readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in KML bestand");const l=new oC().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,g)=>{const m={...h.properties},x=m.name||m.Name||`Feature ${g+1}`,y=m.description||m.Description||"";return{type:"Feature",geometry:h.geometry,properties:{...m,name:x,description:y}}}),c=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen KML: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function sbe(n){const e=[],t=[];try{const r=await n.text(),s=new _pe().readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in GPX bestand");const l=new oC().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,g)=>{const m={...h.properties},x=m.name||m.Name||`Waypoint ${g+1}`,y=m.desc||m.description||"",_=m.time||null,w=m.ele||null;return{type:"Feature",geometry:h.geometry,properties:{...m,name:x,description:y,time:_,elevation:w}}}),c=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return c.includes("LineString")&&t.push("GPX track routes worden als lijnen weergegeven"),{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen GPX: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function FC(n){switch(n.split(".").pop()?.toLowerCase()){case"geojson":case"json":return"geojson";case"kml":case"kmz":return"kml";case"gpx":return"gpx";default:return"unsupported"}}function abe(){return".geojson,.json,.kml,.gpx"}function VC(){return"GeoJSON, KML (Google My Maps), GPX"}async function obe(n){switch(FC(n.name)){case"geojson":return rbe(n);case"kml":return ibe(n);case"gpx":return sbe(n);case"unsupported":default:return{success:!1,features:{type:"FeatureCollection",features:[]},errors:[`Niet-ondersteund bestandsformaat: ${n.name}. Ondersteunde formaten: ${VC()}`],warnings:[],metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function lbe(n){return n.size>10485760?{valid:!1,error:`Bestand te groot (${(n.size/1024/1024).toFixed(1)} MB). Maximum is 10 MB.`}:FC(n.name)==="unsupported"?{valid:!1,error:`Niet-ondersteund bestandsformaat. Ondersteunde formaten: ${VC()}`}:n.name.toLowerCase().endsWith(".kmz")?{valid:!1,error:"KMZ bestanden worden nog niet ondersteund. Pak het bestand uit en importeer het .kml bestand."}:{valid:!0}}function cbe({isOpen:n,onClose:e}){const t=Z1(A=>A.addLayer),r=H.useRef(null),[i,s]=H.useState("idle"),[a,o]=H.useState(null),[l,c]=H.useState(null),[h,g]=H.useState(""),[m,x]=H.useState(null),[y,_]=H.useState(!1),w=H.useCallback(()=>{s("idle"),o(null),c(null),g(""),x(null),r.current&&(r.current.value="")},[]),T=H.useCallback(()=>{w(),e()},[w,e]),b=H.useCallback(async A=>{const C=lbe(A);if(!C.valid){x(C.error||"Ongeldig bestand"),s("error");return}o(A),s("parsing"),x(null);const O=A.name.replace(/\.[^/.]+$/,"");g(O);try{const P=await obe(A);if(!P.success){x(P.errors.join(`
`)),s("error");return}if(P.features.features.length===0){x("Geen features gevonden in het bestand"),s("error");return}c(P),s("preview")}catch(P){x(P instanceof Error?P.message:"Onbekende fout bij parsen"),s("error")}},[]),R=H.useCallback(A=>{const C=A.target.files?.[0];C&&b(C)},[b]),M=H.useCallback(A=>{A.preventDefault(),_(!0)},[]),D=H.useCallback(A=>{A.preventDefault(),_(!1)},[]),B=H.useCallback(A=>{A.preventDefault(),_(!1);const C=A.dataTransfer.files?.[0];C&&b(C)},[b]),k=H.useCallback(()=>{if(!l||!h.trim())return;const A=a?FC(a.name):"geojson";t({name:h.trim(),type:A==="unsupported"?"geojson":A,features:l.features,visible:!0,opacity:1,color:"",sourceFileName:a?.name||"unknown"}),T()},[l,h,a,t,T]);return f.jsx(In,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[80vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(ix,{size:18}),f.jsx("span",{className:"font-medium",children:"Laag Importeren"})]}),f.jsx("button",{onClick:T,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:f.jsx(Xr,{size:18})})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i==="idle"&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${y?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:M,onDragLeave:D,onDrop:B,children:[f.jsx($I,{size:40,className:"mx-auto text-gray-400 mb-3"}),f.jsx("p",{className:"text-gray-600 mb-2",children:"Sleep een bestand hierheen"}),f.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"of"}),f.jsx("button",{onClick:()=>r.current?.click(),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none",children:"Bestand kiezen"}),f.jsx("input",{ref:r,type:"file",accept:abe(),onChange:R,className:"hidden"})]}),f.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[f.jsx("p",{className:"font-medium",children:"Ondersteunde formaten:"}),f.jsx("p",{children:VC()})]})]}),i==="parsing"&&f.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[f.jsx(HI,{size:40,className:"text-purple-500 animate-spin mb-4"}),f.jsx("p",{className:"text-gray-600",children:"Bestand verwerken..."}),f.jsx("p",{className:"text-gray-400 text-sm",children:a?.name})]}),i==="error"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 rounded-lg",children:[f.jsx(EV,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-red-700",children:"Import mislukt"}),f.jsx("p",{className:"text-sm text-red-600 mt-1 whitespace-pre-wrap",children:m})]})]}),f.jsx("button",{onClick:w,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Opnieuw proberen"})]}),i==="preview"&&l&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[f.jsx(oce,{size:20,className:"text-green-500 flex-shrink-0 mt-0.5"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-green-700",children:"Bestand geladen"}),f.jsx("p",{className:"text-sm text-green-600",children:a?.name})]})]}),l.warnings.length>0&&f.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg",children:[f.jsx("p",{className:"font-medium text-amber-700 text-sm",children:"Let op:"}),f.jsx("ul",{className:"text-sm text-amber-600 mt-1 list-disc list-inside",children:l.warnings.map((A,C)=>f.jsx("li",{children:A},C))})]}),f.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-500",children:"Features:"}),f.jsx("span",{className:"ml-2 font-medium",children:l.metadata.featureCount})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-500",children:"Types:"}),f.jsx("span",{className:"ml-2 font-medium",children:l.metadata.geometryTypes.join(", ")||"-"})]})]})}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de laag"}),f.jsx("input",{type:"text",value:h,onChange:A=>g(A.target.value),placeholder:"Bijv. Mijn locaties",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),i==="preview"&&f.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex gap-2",children:[f.jsx("button",{onClick:w,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Annuleren"}),f.jsx("button",{onClick:k,disabled:!h.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:"Importeren"})]})]})]})})}function ube(){const{user:n,loading:e,error:t,signInWithGoogle:r,logout:i,initAuth:s}=AE();return H.useEffect(()=>{s()},[s]),e?f.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg text-gray-500",children:[f.jsx(hc,{size:16,className:"animate-pulse"}),f.jsx("span",{className:"text-sm",children:"Laden..."})]}):n?f.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-green-50 rounded-lg",children:[n.photoURL?f.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-8 h-8 rounded-full border-2 border-green-200",referrerPolicy:"no-referrer"}):f.jsx("div",{className:"w-8 h-8 rounded-full bg-green-200 flex items-center justify-center",children:f.jsx(qI,{size:16,className:"text-green-600"})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"text-sm font-medium text-green-800 truncate",children:n.displayName||n.email}),f.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[f.jsx(hc,{size:12}),"Cloud sync actief"]})]}),f.jsx("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:f.jsx(KI,{size:16})})]}):f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg text-gray-500",children:[f.jsx(gce,{size:16}),f.jsx("span",{className:"text-sm",children:"Alleen lokale opslag"})]}),f.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none",children:[f.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:[f.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),f.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),f.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),f.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),f.jsx("span",{className:"text-sm text-gray-700",children:"Inloggen met Google"})]}),t&&f.jsx("div",{className:"px-3 py-2 bg-red-50 text-red-700 text-xs rounded-lg",children:t})]})}const hbe="https://forms.gle/R5LCk11Bzu5XrkBj8";function dbe(){const{settingsPanelOpen:n,toggleSettingsPanel:e,vondstDashboardOpen:t,toggleVondstDashboard:r,openLayerManagerModal:i}=wr(),s=yn(),{presets:a,createPreset:o,deletePreset:l,updatePreset:c}=G9(),h=hl(Q=>Q.vondsten),g=Z1(Q=>Q.layers),{layers:m,updateLayer:x}=fs(),{devMode:y,setDevMode:_,tier:w}=oI(),[T,b]=H.useState(""),[R,M]=H.useState(!1),[D,B]=H.useState(!1),[k,A]=H.useState(null),[C,O]=H.useState(""),[P,z]=H.useState(null),[F,xe]=H.useState(""),[Ce,Ge]=H.useState("algemeen"),Ne=14*s.fontScale/100,ue=()=>{T.trim()&&(o(T.trim(),"Layers"),b(""),M(!1))},ke=(Q,ee)=>{A(Q),O(ee)},ae=Q=>{C.trim()&&(c(Q,{name:C.trim()}),console.log(` Preset hernoemd naar "${C.trim()}"`)),A(null),O("")},Z=()=>{A(null),O("")},V=[{id:"algemeen",label:"Algemeen",icon:f.jsx($ue,{size:14})},{id:"lagen",label:"Lagen",icon:f.jsx(za,{size:14})},{id:"vondsten",label:"Vondsten",icon:f.jsx(As,{size:14})}];return f.jsxs(f.Fragment,{children:[f.jsx(In,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",style:{fontSize:`${Ne}px`},children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(DR,{size:18,className:"text-white"}),f.jsx("span",{className:"font-medium text-white",children:"Instellingen"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[s.showFontSliders&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:s.fontScale,onInput:Q=>{s.setFontScale(parseInt(Q.target.value))},onChange:Q=>s.setFontScale(parseInt(Q.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${s.fontScale}%`}),f.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none ml-1",children:f.jsx(Xr,{size:18,className:"text-white",strokeWidth:2.5})})]})]}),f.jsx("div",{className:"flex border-b border-gray-200",children:V.map(Q=>f.jsxs("button",{onClick:()=>Ge(Q.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${Ce===Q.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[Q.icon,Q.label]},Q.id))}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",style:{fontSize:`${Ne}px`},children:[Ce==="algemeen"&&f.jsxs(f.Fragment,{children:[f.jsx(Ko,{title:"Account",icon:f.jsx(qI,{size:16}),children:f.jsx(ube,{})}),f.jsxs(Ko,{title:"Kaart",icon:f.jsx(XI,{size:16}),children:[f.jsx(fbe,{label:"Standaard achtergrond",children:f.jsxs("select",{value:s.defaultBackground,onChange:Q=>s.setDefaultBackground(Q.target.value),className:"px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},children:[f.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),f.jsx("option",{value:"OpenStreetMap",children:"OSM"}),f.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),f.jsx(Th,{label:"Schaalbalk tonen",checked:s.showScaleBar,onChange:s.setShowScaleBar})]}),f.jsxs(Ko,{title:"GPS",icon:f.jsx(rx,{size:16}),children:[f.jsx(Th,{label:"GPS aan bij start",checked:s.gpsAutoStart,onChange:s.setGpsAutoStart}),f.jsx(Th,{label:"Nauwkeurigheidscirkel",checked:s.showAccuracyCircle,onChange:s.setShowAccuracyCircle})]}),f.jsxs(Ko,{title:"Feedback",icon:f.jsx(Hue,{size:16}),children:[f.jsx(Th,{label:"Trillen bij acties",checked:s.hapticFeedback,onChange:s.setHapticFeedback}),f.jsx(Th,{label:"Spraakfeedback vondsten",checked:s.voiceFeedbackEnabled,onChange:s.setVoiceFeedbackEnabled}),s.voiceFeedbackEnabled&&f.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:[f.jsx(ghe,{size:12,className:"inline mr-1"}),"Spreekt vondst info uit bij toevoegen"]})]}),f.jsxs(Ko,{title:"Weer",icon:f.jsx(hc,{size:16}),children:[f.jsx(Th,{label:"Weerknop tonen",checked:s.showWeatherButton,onChange:s.setShowWeatherButton}),f.jsx("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:"Actueel weer, voorspelling en buienradar"})]}),f.jsxs(Ko,{title:"Development",icon:f.jsx(vce,{size:16}),children:[f.jsx(Th,{label:"Dev Mode (alles ontgrendeld)",checked:y,onChange:_}),f.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:["Huidige tier: ",f.jsx("span",{className:"font-medium text-blue-600",children:w}),y&&f.jsx("span",{className:"text-green-600",children:" (alle lagen ontgrendeld)"})]})]})]}),Ce==="lagen"&&f.jsxs(f.Fragment,{children:[f.jsx(Ko,{title:"Mijn lagen",icon:f.jsx(za,{size:16}),isOwn:!0,children:f.jsxs("div",{className:"space-y-1",children:[m.filter(Q=>!Q.archived).length===0?f.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Nog geen eigen lagen aangemaakt."}):m.filter(Q=>!Q.archived).map(Q=>f.jsx("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-gray-50 rounded",children:P===Q.id?f.jsx("input",{type:"text",value:F,onChange:ee=>xe(ee.target.value),onKeyDown:ee=>{ee.key==="Enter"?(F.trim()&&x(Q.id,{name:F.trim()}),z(null)):ee.key==="Escape"&&z(null)},onBlur:()=>{F.trim()&&x(Q.id,{name:F.trim()}),z(null)},autoFocus:!0,className:"flex-1 px-1.5 py-0.5 text-sm bg-orange-50 rounded outline-none focus:ring-1 focus:ring-orange-400"}):f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"flex-1 text-sm text-gray-700 truncate",children:Q.name}),f.jsxs("span",{className:"text-xs text-gray-400",children:[Q.points.length," punten"]}),f.jsx("button",{onClick:()=>{z(Q.id),xe(Q.name)},className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none bg-transparent",title:"Naam bewerken",children:f.jsx(ig,{size:12})})]})},Q.id)),f.jsxs("button",{onClick:()=>{i(),e()},className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx(DR,{size:14}),f.jsx("span",{children:"Lagen beheren"})]})]})}),f.jsx(Ko,{title:"Lagen importeren",icon:f.jsx(ix,{size:16}),children:f.jsxs("div",{className:"space-y-1",children:[g.length>0&&f.jsxs(f.Fragment,{children:[g.map(Q=>f.jsx(NV,{layer:Q},Q.id)),f.jsx("div",{className:"border-t border-gray-100 my-2"})]}),f.jsxs("button",{onClick:()=>B(!0),className:"flex items-center gap-2 px-2 py-1.5 text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx(Xa,{size:14}),f.jsx("span",{children:"Nieuwe laag importeren"})]}),f.jsx("p",{className:"text-gray-400 mt-1",style:{fontSize:"0.7em"},children:"GeoJSON, KML (Google My Maps), GPX"})]})}),f.jsx(Ko,{title:"Presets",icon:f.jsx(za,{size:16}),children:f.jsxs("div",{className:"space-y-2",children:[a.map(Q=>f.jsx("div",{className:"flex items-center justify-between py-1",children:k===Q.id?f.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[f.jsx("input",{type:"text",value:C,onChange:ee=>O(ee.target.value),onKeyDown:ee=>{ee.key==="Enter"&&ae(Q.id),ee.key==="Escape"&&Z()},className:"flex-1 px-2 py-0.5 bg-blue-50 rounded border border-blue-300 outline-none",style:{fontSize:"0.9em"},autoFocus:!0}),f.jsx("button",{onClick:()=>ae(Q.id),className:"px-2 py-0.5 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:"OK"}),f.jsx("button",{onClick:Z,className:"px-2 py-0.5 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:""})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:[Q.name,Q.isBuiltIn&&f.jsx("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:"(standaard)"})]}),f.jsxs("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:["(",Q.layers.length," lagen)"]})]}),!Q.isBuiltIn&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("button",{onClick:()=>ke(Q.id,Q.name),className:"p-1 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:f.jsx(ig,{size:14})}),f.jsx("button",{onClick:()=>l(Q.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:f.jsx(_c,{size:14})})]})]})},Q.id)),R?f.jsxs("div",{className:"flex gap-2 mt-2",children:[f.jsx("input",{type:"text",value:T,onChange:Q=>b(Q.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},onKeyDown:Q=>Q.key==="Enter"&&ue(),autoFocus:!0}),f.jsx("button",{onClick:ue,className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Opslaan"}),f.jsx("button",{onClick:()=>M(!1),className:"px-2 py-1 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Annuleren"})]}):f.jsxs("button",{onClick:()=>M(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx(Xa,{size:14}),f.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})})]}),Ce==="vondsten"&&f.jsx(f.Fragment,{children:f.jsxs(Ko,{title:"Vondsten",icon:f.jsx(As,{size:16}),isOwn:!0,children:[f.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Vondsten worden altijd lokaal op dit apparaat opgeslagen."}),f.jsxs("button",{onClick:r,className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx(wV,{size:14}),f.jsxs("span",{children:["Dashboard (",h.length," vondsten)"]})]}),f.jsx(gbe,{})]})})]}),f.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",style:{fontSize:`${Ne}px`},children:[f.jsxs("a",{href:hbe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[f.jsx(vV,{size:16}),f.jsx("span",{children:"Meld een bug"})]}),f.jsxs("button",{onClick:XTe,className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[f.jsx(KI,{size:16}),f.jsx("span",{children:"Uitloggen"})]}),f.jsx("p",{className:"text-gray-400 text-center",style:{fontSize:"0.75em"},children:"Instellingen worden lokaal opgeslagen"})]})]})]})}),f.jsx(qTe,{isOpen:t,onClose:r}),f.jsx(cbe,{isOpen:D,onClose:()=>B(!1)})]})}function Ko({title:n,icon:e,children:t,isOwn:r}){return f.jsxs("section",{children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[f.jsx("span",{className:r?"text-orange-600":"text-blue-600",children:e}),f.jsx("span",{className:`font-medium ${r?"text-orange-600":"text-gray-800"}`,style:{fontSize:"1em"},children:n})]}),f.jsx("div",{className:"space-y-2",children:t})]})}function fbe({label:n,children:e}){return f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),e]})}function Th({label:n,checked:e,onChange:t}){return f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),f.jsx("button",{onClick:()=>t(!e),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${e?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gray-300"}`,children:f.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${e?"left-[22px]":"left-0.5"}`})})]})}function gbe(){const[n,e]=H.useState(!1),{vondsten:t,exportAsGeoJSON:r,exportAsCSV:i,exportAsExcel:s,exportAsGPX:a,exportAsKML:o}=hl(),l=[{label:"Excel (.xlsx)",action:s,desc:"Spreadsheet"},{label:"CSV",action:i,desc:"Comma-separated"},{label:"GeoJSON",action:r,desc:"GIS software"},{label:"GPX",action:a,desc:"GPS apparaten"},{label:"KML",action:o,desc:"Google Earth"}],c=h=>{h(),e(!1)};return t.length===0?f.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-gray-400 bg-gray-100 rounded w-full cursor-not-allowed",style:{fontSize:"0.9em"},children:[f.jsx(zv,{size:14}),f.jsx("span",{children:"Geen vondsten om te exporteren"})]}):f.jsxs("div",{className:"relative mt-2",children:[f.jsxs("button",{onClick:()=>e(!n),className:"flex items-center justify-between gap-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(zv,{size:14}),f.jsxs("span",{children:["Exporteer vondsten (",t.length,")"]})]}),f.jsx("span",{style:{fontSize:"0.8em"},children:""})]}),n&&f.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden",children:l.map((h,g)=>f.jsxs("button",{onClick:()=>c(h.action),className:"w-full px-3 py-2 text-left hover:bg-blue-50 transition-colors border-0 outline-none flex justify-between items-center",style:{fontSize:"0.9em"},children:[f.jsx("span",{className:"text-gray-700",children:h.label}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:h.desc})]},g))})]})}const _w="2.30.66";function mbe({size:n=18}){return f.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[f.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),f.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),f.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),f.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function pbe(){const[n,e]=H.useState(!1),{user:t,loading:r,signInWithGoogle:i,logout:s}=AE(),{toggleInfoPanel:a,toggleSettingsPanel:o}=wr(),l=yn(P=>P.menuFontScale),c=yn(P=>P.setMenuFontScale),h=yn(P=>P.showFontSliders),g=yn(P=>P.setShowFontSliders),m=yn(P=>P.showVondstButton),x=yn(P=>P.setShowVondstButton),y=yn(P=>P.showRouteRecordButton),_=yn(P=>P.setShowRouteRecordButton),w=yn(P=>P.showCustomPointLayers),T=yn(P=>P.setShowCustomPointLayers),b=yn(P=>P.showWeatherButton),R=yn(P=>P.setShowWeatherButton),M={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},D=()=>e(!1),B=()=>{D(),a()},k=()=>{D(),o()},A=()=>{D(),i()},C=()=>{D(),s()},O=13*l/100;return f.jsxs(f.Fragment,{children:[f.jsx(wt.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:M,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?f.jsx(Xr,{size:22,className:"text-white"}):f.jsx(aue,{size:22,className:"text-gray-600"})}),f.jsx(In,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:D}),f.jsxs(wt.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)",fontSize:`${O}px`},children:[f.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",children:[f.jsx("span",{className:"font-medium text-white",style:{fontSize:`${O}px`},children:"Menu"}),h&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:l,onInput:P=>c(parseInt(P.target.value)),onChange:P=>c(parseInt(P.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${l}%`}),f.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),r?f.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:f.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):t?f.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:f.jsxs("div",{className:"flex items-center gap-3",children:[t.photoURL?f.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):f.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:f.jsx(qI,{size:16,className:"text-white"})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"font-medium text-gray-800 truncate",style:{fontSize:"0.85em"},children:t.displayName||"Gebruiker"}),f.jsx("div",{className:"text-green-600",style:{fontSize:"0.7em"},children:"Cloud sync actief"})]}),f.jsx("button",{onClick:C,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:f.jsx(KI,{size:16})})]})}):f.jsxs("button",{onClick:A,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent",children:[f.jsx(mbe,{size:18}),f.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Inloggen met Google"})]}),f.jsx("div",{className:"py-1",children:f.jsxs("button",{onClick:B,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50",style:{fontSize:"0.95em"},children:[f.jsx(WI,{size:18,className:"text-blue-500"}),f.jsx("span",{children:"Info & handleiding"})]})}),f.jsxs("div",{className:"py-1 border-t border-gray-100",children:[f.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(As,{size:18,className:"text-orange-500"}),f.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Vondst knop"})]}),f.jsx("button",{onClick:()=>x(!m),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${m?"bg-gradient-to-r from-orange-500 to-orange-600":"bg-gray-300"}`,children:f.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${m?"left-[22px]":"left-0.5"}`})})]}),f.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Wv,{size:18,className:"text-green-500"}),f.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Route knop"})]}),f.jsx("button",{onClick:()=>_(!y),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${y?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:f.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${y?"left-[22px]":"left-0.5"}`})})]}),f.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(hc,{size:18,className:"text-cyan-500"}),f.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Weer knop"})]}),f.jsx("button",{onClick:()=>R(!b),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${b?"bg-gradient-to-r from-cyan-500 to-cyan-600":"bg-gray-300"}`,children:f.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${b?"left-[22px]":"left-0.5"}`})})]}),f.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(za,{size:18,className:"text-amber-500"}),f.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Mijn lagen"})]}),f.jsx("button",{onClick:()=>T(!w),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${w?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gray-300"}`,children:f.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${w?"left-[22px]":"left-0.5"}`})})]}),f.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(CV,{size:18,className:"text-purple-500"}),f.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Tekstgrootte"})]}),f.jsx("button",{onClick:()=>g(!h),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${h?"bg-gradient-to-r from-purple-500 to-purple-600":"bg-gray-300"}`,children:f.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${h?"left-[22px]":"left-0.5"}`})})]})]}),f.jsx("div",{className:"mt-auto border-t border-gray-100",children:f.jsxs("button",{onClick:k,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50",style:{fontSize:"0.95em"},children:[f.jsx(DR,{size:18,className:"text-gray-500"}),f.jsx("span",{children:"Instellingen"})]})}),f.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400",style:{fontSize:"0.65em"},children:["DetectorApp NL v",_w]})]})]})})]})}const xbe="https://forms.gle/R5LCk11Bzu5XrkBj8";function ybe(){const{infoPanelOpen:n,toggleInfoPanel:e}=wr(),[t,r]=H.useState("info"),i=[{id:"info",label:"Info",icon:f.jsx(WI,{size:14})},{id:"functies",label:"Functies",icon:f.jsx($I,{size:14})},{id:"handleiding",label:"Handleiding",icon:f.jsx(Xle,{size:14})}];return f.jsx(In,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",children:[f.jsxs("span",{className:"font-medium text-white",children:["DetectorApp NL v",_w]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:f.jsx(Xr,{size:18,className:"text-white",strokeWidth:2.5})})]}),f.jsx("div",{className:"flex border-b border-gray-200",children:i.map(s=>f.jsxs("button",{onClick:()=>r(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&f.jsx(_be,{}),t==="functies"&&f.jsx(vbe,{}),t==="handleiding"&&f.jsx(wbe,{}),f.jsxs("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:[f.jsxs("a",{href:xbe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",children:[f.jsx(vV,{size:14}),f.jsx("span",{className:"text-sm",children:"Meld een bug of geef feedback"})]}),f.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["DetectorApp NL v",_w," - Gratis en zonder tracking"]})]})]})]})]})})}function _be(){return f.jsxs(f.Fragment,{children:[f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),f.jsx("p",{className:"text-gray-600",children:"DetectorApp NL is d gratis kaartapplicatie voor metaaldetectie, fossielen zoeken en archeologische verkenning in Nederland. Met 70+ kaartlagen, GPS tracking met richtingspijl, eigen lagen, cloud sync en uitgebreid vondstenbeheer."})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),f.jsxs("ul",{className:"space-y-2 text-gray-600",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"AMK Monumenten, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed, Essen, Archeo Onderzoeken"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN Hoogtekaarten, IKAW, Bodemkaart, Geomorfologie, Kadastrale Grenzen, Gewaspercelen"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Terpen, Parken, Kringloopwinkels, Musea, Speeltuinen, Strandjes"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Itiner-E / Wetenschappelijk"})," (CC BY 4.0)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Mindat.org"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Mineralen hotspots en vindplaatsen"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Paleontica / Fossielen data"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Fossiel hotspots en vindplaatsen"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Map5.nl / Kadaster"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Provinciale data"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Relictenkaart (Gelderland), Scheepswrakken (Zuid-Holland), Verdronken Dorpen (Zeeland)"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data, Expert advies, Bufferlagen"})]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy & Opslag"}),f.jsxs("div",{className:"text-gray-600 space-y-2",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Volledig anoniem mogelijk:"})," Je kunt deze app gebruiken zonder enige registratie of login. Al je data blijft dan 100% op je eigen apparaat."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Geen tracking:"})," Deze app verzamelt geen analytics, cookies, gebruiksstatistieken of persoonlijke gegevens. Er is geen server die je gedrag registreert."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Locatiegegevens:"})," Je GPS-positie wordt alleen gebruikt om je locatie op de kaart te tonen. Deze wordt niet opgeslagen of gedeeld met derden."]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Google Login - Wat betekent het?"}),f.jsxs("div",{className:"text-gray-600 space-y-2",children:[f.jsx("p",{className:"font-medium text-green-700",children:" Google login is volledig optioneel"}),f.jsx("p",{children:f.jsx("strong",{children:"Wat wordt gesynchroniseerd:"})}),f.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[f.jsx("li",{children:"Je eigen aangemaakte lagen (Mijn Lagen)"}),f.jsx("li",{children:"Je vondsten registraties"}),f.jsx("li",{children:"Je preset-instellingen"})]}),f.jsx("p",{children:f.jsx("strong",{children:"Wat NIET wordt gedeeld:"})}),f.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[f.jsx("li",{children:"Je GPS-locatie wordt niet opgeslagen in de cloud"}),f.jsx("li",{children:"Je zoekgeschiedenis wordt niet bewaard"}),f.jsx("li",{children:"Welke kaartlagen je bekijkt wordt niet geregistreerd"}),f.jsx("li",{children:"Niemand anders kan je data zien - alleen jij"})]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Waarom inloggen?"})," Alleen voor synchronisatie tussen apparaten (telefoon/tablet/PC) en als backup voor je vondsten."]}),f.jsx("p",{className:"text-xs text-gray-500 italic",children:"Tip: Gebruik de app gerust zonder login als je privacy belangrijker vindt dan synchronisatie. Alle functies werken ook offline."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zonder login (anoniem)"}),f.jsxs("div",{className:"text-gray-600 space-y-2",children:[f.jsx("p",{className:"font-medium text-blue-700",children:" 95% van de functies werkt zonder login"}),f.jsx("p",{children:f.jsx("strong",{children:"Beschikbaar zonder login:"})}),f.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[f.jsx("li",{children:"Alle 70+ kaartlagen bekijken"}),f.jsx("li",{children:"GPS tracking en navigatie"}),f.jsx("li",{children:"Vondsten registreren (lokaal opgeslagen)"}),f.jsx("li",{children:"Eigen lagen aanmaken (lokaal opgeslagen)"}),f.jsx("li",{children:"Export naar Excel/CSV/GeoJSON/GPX/KML"}),f.jsx("li",{children:"Lagen importeren"}),f.jsx("li",{children:"Alle presets en instellingen"})]}),f.jsx("p",{children:f.jsx("strong",{children:"Alleen met login:"})}),f.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[f.jsx("li",{children:"Synchronisatie tussen apparaten"}),f.jsx("li",{children:"Cloud backup van je vondsten"})]})]})]})]})}function vbe(){return f.jsxs(f.Fragment,{children:[f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(XI,{size:16,className:"text-blue-600"}),"Kaartlagen (70+)"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Basis:"})," CartoDB, OpenStreetMap, PDOK Luchtfoto"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Historisch:"})," TMK 1850, Bonnebladen 1900"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Hoogtekaarten:"})," AHN4 Hillshade, Multi-Hillshade, Hoogtekaart Kleur, AHN 0.5m"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Archeologie:"})," AMK Monumenten (per periode), Archeo Onderzoeken, IKAW, Essen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Romeins:"})," Romeinse wegen, Romeinse Forten met historische info, Limesweg"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Prehistorie:"})," Hunebedden, Grafheuvels, Terpen, Paleokaarten (7 periodes)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Militair:"})," WWII Bunkers, Slagvelden, Vliegvelden, Verdedigingslinies"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Erfgoed:"})," Rijksmonumenten, Kastelen, Runes, Religieus Erfgoed"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Terrein:"})," Veengebieden, Geomorfologie, Bodemkaart"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Percelen:"})," Gewaspercelen (met bouwplantoelichting), Kadastrale Grenzen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Recreatie:"})," Parken, Musea, Kringloopwinkels, Strandjes, Wandelroutes"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Provinciaal:"})," Relictenkaart, Scheepswrakken, Verdronken Dorpen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"UIKAV:"})," Uiterwaard data, Expert advies, Vlakken, Punten, Bufferlagen"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Uce,{size:16,className:"text-purple-600"}),"Mineralen & Fossielen"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Mineralen hotspots:"})," Vindplaatsen uit Mindat.org met mineralenlijst"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Goudrivieren:"})," Bekende locaties voor goud zoeken"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Fossiel hotspots:"})," Vindplaatsen met fossieltypen en periodes"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Premium lagen:"})," Gedetailleerde data (beschikbaar met account)"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(jce,{size:16,className:"text-orange-600"}),"Mijn Lagen"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Eigen lagen:"})," Maak lagen voor vakantie, projecten, etc."]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Toevoegen:"})," Tik op + in popup om monument/locatie aan laag toe te voegen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Polygonen:"})," Hele monumentgebieden worden opgeslagen, niet alleen een punt"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Originele info:"})," Popup content blijft behouden"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Kleuren:"})," Elke laag krijgt eigen kleur (aanpasbaar)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Import:"})," Laad GeoJSON, KML of GPX bestanden"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Export:"})," Exporteer lagen als GeoJSON"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(hc,{size:16,className:"text-green-600"}),"Google Cloud Sync"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Inloggen:"})," Via hamburger menu rechtsboven"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Synchronisatie:"})," Lagen en vondsten automatisch naar cloud"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Meerdere apparaten:"})," Altijd toegang tot je data"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Veilig:"})," Alleen jij hebt toegang tot je gegevens"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(rx,{size:16,className:"text-green-600"}),"GPS & Navigatie"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsx("li",{children:"Live GPS tracking met nauwkeurigheidscirkel"}),f.jsx("li",{children:"Richtingspijl draait mee met je telefoon"}),f.jsx("li",{children:"Kaart handmatig draaien + kompasknop naar noorden"}),f.jsx("li",{children:"Schaalbalk onderaan (aan/uit in Instellingen)"}),f.jsx("li",{children:"Open locatie in Google Maps vanuit popup"}),f.jsx("li",{children:"Zoekbalk voor adressen en plaatsen"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(As,{size:16,className:"text-orange-600"}),"Vondsten"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsx("li",{children:"Toevoegen via GPS locatie, long-press of handmatig"}),f.jsx("li",{children:"Velden: type, materiaal, periode, diepte, conditie, gewicht"}),f.jsx("li",{children:"Foto's toevoegen (link of upload)"}),f.jsx("li",{children:"Export: Excel, CSV, GeoJSON, GPX, KML"}),f.jsx("li",{children:"Dashboard met statistieken"}),f.jsx("li",{children:"Cloud sync met Google account"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(za,{size:16,className:"text-purple-600"}),"Presets"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Standaard:"})," Detectie, Steentijd, Romeins, Middeleeuwen, WOII, Analyse, Fossielen, Mineralen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Aanpasbaar:"})," Overschrijf preset met huidige lagen (diskette-icoon)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Eigen presets:"})," Maak nieuwe via Instellingen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Tekstgrootte:"})," Aanpasbaar per panel via slider"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(uue,{size:16,className:"text-cyan-600"}),"Perceelinformatie"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsx("li",{children:"Kadastrale aanduiding (gemeente, sectie, nummer)"}),f.jsx("li",{children:"Oppervlakte in m en hectare"}),f.jsx("li",{children:"Gewas en bouwplan met uitleg"}),f.jsx("li",{children:"Bodemtype met beschrijving"}),f.jsx("li",{children:"AHN hoogte in meters NAP"}),f.jsx("li",{children:"Hoogtekaart per perceel (bergje-icoon)"}),f.jsx("li",{children:"Link naar eigenaar opzoeken (Kadaster)"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Bue,{size:16,className:"text-red-600"}),"Monumenten & Erfgoed"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"AMK:"})," Archeologische Monumenten per periode"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Romeinse Forten:"})," Uitgebreide historische info per fort"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Rijksmonumenten:"})," Met bescherming en historie"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Verdedigingswerken:"})," Linies, forten, schansen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Popup info:"})," Directe uitleg over archeologische waarde"]})]})]})]})}function wbe(){return f.jsxs(f.Fragment,{children:[f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),f.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[f.jsxs("li",{children:["Tik op de ",f.jsx("strong",{children:"GPS knop"})," (rechtsonder, oranje) om je locatie te zien"]}),f.jsxs("li",{children:["Kies een ",f.jsx("strong",{children:"preset"})," (linksonder, laagjes-icoon) voor een snelle start"]}),f.jsxs("li",{children:["Of open ",f.jsx("strong",{children:"Kaartlagen"})," om individuele lagen aan te zetten"]}),f.jsx("li",{children:"Tik op objecten op de kaart voor gedetailleerde informatie"})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Hamburger Menu"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsx("p",{children:"Rechtsboven vind je het menu met:"}),f.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Google Login:"})," Synchroniseer je data naar de cloud"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Vondst toevoegen:"})," Registreer een nieuwe vondst"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Info & Handleiding:"})," Dit scherm"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Instellingen:"})," Presets, export, weergave"]})]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"GPS & Navigatie"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"GPS knop (oranje):"})," Aan/uit toggle voor locatie tracking."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Richtingspijl:"})," Blauwe pijl toont de richting van je telefoon."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Kaart draaien:"})," Met twee vingers of via kompas."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Kompasknop:"})," Verschijnt rechtsboven als kaart gedraaid is. Tik om naar noorden te draaien."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Google Maps:"})," Vanuit elke popup kun je direct navigeren."]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Locaties opslaan in Mijn Lagen"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 1:"})," Tik op een object op de kaart (monument, bunker, etc.)"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 2:"})," Tik op de ",f.jsx("strong",{children:"oranje +"})," knop in de popup header"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 3:"})," Kies een bestaande laag of maak een nieuwe aan"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Resultaat:"})," De locatie inclusief vorm (polygoon) en info wordt opgeslagen!"]}),f.jsx("p",{className:"text-gray-500 italic",children:"Tip: Maak lagen voor vakantiebestemmingen, projecten of interessante locaties."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vondst registreren"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Via GPS:"})," Open menu  Vondst toevoegen. Je locatie wordt automatisch ingevuld."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Via long-press:"}),' Houd je vinger op de kaart  kies "Vondst toevoegen".']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Handmatig:"}),' In het formulier  "Kies op kaart" voor exacte locatie.']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Foto's:"})," Voeg foto-links toe of upload direct."]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Presets gebruiken"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Toepassen:"})," Linksonder  preset kiezen."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Aanpassen:"})," Zet gewenste lagen aan  tik diskette-icoon naast preset."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Nieuw maken:"}),' Instellingen  Presets  "Huidige lagen opslaan".']})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Cloud Sync instellen"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 1:"})," Open hamburger menu rechtsboven"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 2:"}),' Tik op "Inloggen met Google"']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 3:"})," Kies je Google account"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Klaar!"})," Je lagen en vondsten worden automatisch gesynchroniseerd."]}),f.jsx("p",{className:"text-gray-500 italic",children:"Je data is veilig en alleen voor jou toegankelijk."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Lagen importeren"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 1:"})," Ga naar Instellingen (hamburger menu)"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 2:"}),' Scroll naar "Lagen importeren"']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 3:"})," Kies een GeoJSON, KML of GPX bestand"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Resultaat:"})," Nieuwe laag met je geimporteerde data!"]}),f.jsx("p",{className:"text-gray-500 italic",children:"Handig voor routes, waypoints of eigen datasets."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor detectie"}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[f.jsxs("li",{children:["Gebruik ",f.jsx("strong",{children:"AHN Hillshade"})," om relif te zien (grafheuvels, wallen)"]}),f.jsxs("li",{children:["Combineer ",f.jsx("strong",{children:"AMK"})," met ",f.jsx("strong",{children:"Gewaspercelen"})," voor slimme zoeklocaties"]}),f.jsxs("li",{children:["Check ",f.jsx("strong",{children:"IKAW"})," voor archeologische verwachting"]}),f.jsxs("li",{children:["Gebruik ",f.jsx("strong",{children:"historische kaarten"})," (TMK 1850) om oude structuren te vinden"]}),f.jsxs("li",{children:["Bekijk ",f.jsx("strong",{children:"Archeo Onderzoeken"})," voor eerdere vondsten in het gebied"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Bodemkaart"})," toont of grond geschikt is (popup legt uit)"]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor fossielen"}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[f.jsxs("li",{children:["Zet ",f.jsx("strong",{children:"Fossiel hotspots"})," aan voor bekende vindplaatsen"]}),f.jsxs("li",{children:["Bekijk ",f.jsx("strong",{children:"Paleokaarten"})," voor historische kustlijnen"]}),f.jsxs("li",{children:["Check ",f.jsx("strong",{children:"Geomorfologie"})," voor oude zeebodems en rivieren"]}),f.jsx("li",{children:"Popup toont welke fossielen op elke locatie gevonden zijn"})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor mineralen"}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[f.jsxs("li",{children:["Zet ",f.jsx("strong",{children:"Mineralen hotspots"})," aan voor vindplaatsen"]}),f.jsxs("li",{children:["Bekijk ",f.jsx("strong",{children:"Goudrivieren"})," voor goudzoekmogelijkheden"]}),f.jsx("li",{children:"Popup toont welke mineralen op elke locatie voorkomen"}),f.jsx("li",{children:"Links naar Mindat.org voor gedetailleerde info"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Iu,{size:16,className:"text-blue-600"}),"Handige links"]}),f.jsxs("ul",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("li",{children:[f.jsx("a",{href:"https://legendageomorfologie.wur.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Geomorfologie legenda (WUR)"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Uitgebreide uitleg over landvormen"})]}),f.jsxs("li",{children:[f.jsx("a",{href:"https://legenda-bodemkaart.bodemdata.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Bodemkaart legenda (BRO)"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Volledige bodemclassificatie"})]}),f.jsxs("li",{children:[f.jsx("a",{href:"https://www.mindat.org/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Mindat.org - Mineralen database"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Wereldwijde mineralen informatie"})]}),f.jsxs("li",{children:[f.jsx("a",{href:"https://www.cultureelerfgoed.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Rijksdienst voor Cultureel Erfgoed"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Officile monumenten informatie"})]})]})]})]})}function pz(n,e,t,r){const s=(r-e)*Math.PI/180,a=(t-n)*Math.PI/180,o=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function eb(n){let e=0;for(let t=1;t<n.length;t++)e+=pz(n[t-1].coordinates[0],n[t-1].coordinates[1],n[t].coordinates[0],n[t].coordinates[1]);return e}const To=Yi()(Ro((n,e)=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[],visibleRouteIds:new Set,heatmapEnabled:!1,gridEnabled:!1,gridCenter:null,gridSize:20,gridCount:10,gridColor:"rgba(139, 92, 246, 0.6)",autoPauseEnabled:!1,autoPauseSeconds:120,startRecording:()=>{n({state:"recording",currentPoints:[],startTime:Date.now(),pauseStartTime:null,totalPausedTime:0})},pauseRecording:()=>{const{state:t}=e();t==="recording"&&n({state:"paused",pauseStartTime:Date.now()})},resumeRecording:()=>{const{state:t,pauseStartTime:r,totalPausedTime:i}=e();if(t!=="paused"||!r)return;const s=Date.now()-r;n({state:"recording",pauseStartTime:null,totalPausedTime:i+s})},stopRecording:t=>{const{state:r,currentPoints:i,startTime:s,totalPausedTime:a,pauseStartTime:o}=e();if(r==="idle"||!s||i.length<2)return n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0}),null;const l=Date.now();let c=a;o&&(c+=l-o);const h=l-s-c,g=eb(i),m={id:crypto.randomUUID(),name:t||`Route ${new Date().toLocaleDateString("nl-NL")} ${new Date().toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,points:i,startTime:s,endTime:l,totalDistance:g,totalDuration:h,pausedDuration:c,createdAt:new Date().toISOString()};return n(x=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[m,...x.savedRoutes]})),m},cancelRecording:()=>{n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0})},addPoint:(t,r,i)=>{const{state:s,currentPoints:a}=e();if(s!=="recording")return;if(a.length>0){const l=a[a.length-1];if(pz(l.coordinates[0],l.coordinates[1],t,r)<2)return}const o={coordinates:[t,r],timestamp:Date.now(),accuracy:i};n({currentPoints:[...a,o]})},deleteRoute:t=>{n(r=>({savedRoutes:r.savedRoutes.filter(i=>i.id!==t)}))},renameRoute:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,name:r}:s)}))},clearAllRoutes:()=>{n({savedRoutes:[],visibleRouteIds:new Set})},toggleRouteVisibility:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.has(t)?i.delete(t):i.add(t),{visibleRouteIds:i}})},showRoute:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.add(t),{visibleRouteIds:i}})},hideRoute:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.delete(t),{visibleRouteIds:i}})},showAllRoutes:()=>{n(t=>({visibleRouteIds:new Set(t.savedRoutes.map(r=>r.id))}))},hideAllRoutes:()=>{n({visibleRouteIds:new Set})},toggleHeatmap:()=>{n(t=>({heatmapEnabled:!t.heatmapEnabled}))},setHeatmapEnabled:t=>{n({heatmapEnabled:t})},toggleGrid:()=>{n(t=>({gridEnabled:!t.gridEnabled}))},setGridEnabled:t=>{n({gridEnabled:t})},setGridCenter:t=>{n({gridCenter:t})},setGridSize:t=>{n({gridSize:t})},setGridCount:t=>{n({gridCount:t})},setGridColor:t=>{n({gridColor:t})},centerGridOnCurrentLocation:()=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(t=>{n({gridCenter:[t.coords.longitude,t.coords.latitude],gridEnabled:!0})},t=>{console.error("Could not get location:",t)})},setAutoPauseEnabled:t=>{n({autoPauseEnabled:t})},setAutoPauseSeconds:t=>{n({autoPauseSeconds:t})},importRouteFromGPX:(t,r)=>{try{const s=new DOMParser().parseFromString(t,"application/xml");if(s.querySelector("parsererror"))return{success:!1,error:"Ongeldig XML formaat"};const o=s.querySelectorAll("trkpt");if(o.length<2&&s.querySelectorAll("wpt").length<2)return{success:!1,error:"Geen route punten gevonden in GPX bestand"};const l=[];if((o.length>0?o:s.querySelectorAll("wpt")).forEach(w=>{const T=parseFloat(w.getAttribute("lat")||"0"),b=parseFloat(w.getAttribute("lon")||"0"),R=w.querySelector("time"),M=R?new Date(R.textContent||"").getTime():Date.now();!isNaN(T)&&!isNaN(b)&&l.push({coordinates:[b,T],timestamp:isNaN(M)?Date.now():M})}),l.length<2)return{success:!1,error:"Niet genoeg geldige punten in GPX bestand"};const h=s.querySelector("trk > name")?.textContent||s.querySelector("metadata > name")?.textContent||r||`Import ${new Date().toLocaleDateString("nl-NL")}`,g=eb(l),m=l[0].timestamp,x=l[l.length-1].timestamp,y=x-m,_={id:crypto.randomUUID(),name:h,points:l,startTime:m,endTime:x,totalDistance:g,totalDuration:y>0?y:0,pausedDuration:0,createdAt:new Date().toISOString()};return n(w=>({savedRoutes:[_,...w.savedRoutes]})),{success:!0,routeId:_.id}}catch(i){return console.error("GPX import error:",i),{success:!1,error:"Fout bij importeren van GPX bestand"}}},updateRouteNotes:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,notes:r}:s)}))},addPhotoToRoute:(t,r)=>{const i={...r,id:crypto.randomUUID(),timestamp:new Date().toISOString()};n(s=>({savedRoutes:s.savedRoutes.map(a=>a.id===t?{...a,photos:[...a.photos||[],i]}:a)}))},removePhotoFromRoute:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,photos:(s.photos||[]).filter(a=>a.id!==r)}:s)}))},getCurrentDistance:()=>{const{currentPoints:t}=e();return eb(t)},getCurrentDuration:()=>{const{state:t,startTime:r,totalPausedTime:i,pauseStartTime:s}=e();if(!r)return 0;const a=Date.now();let o=i;return t==="paused"&&s&&(o+=a-s),a-r-o},getAverageSpeed:()=>{const t=e().getCurrentDistance(),r=e().getCurrentDuration();return r===0?0:t/1e3/(r/36e5)}}),{name:"detectorapp-route-recording",version:2,partialize:n=>({savedRoutes:n.savedRoutes,visibleRouteIds:Array.from(n.visibleRouteIds),heatmapEnabled:n.heatmapEnabled,gridEnabled:n.gridEnabled,gridCenter:n.gridCenter,gridSize:n.gridSize,gridCount:n.gridCount,gridColor:n.gridColor,autoPauseEnabled:n.autoPauseEnabled,autoPauseSeconds:n.autoPauseSeconds}),merge:(n,e)=>({...e,...n,visibleRouteIds:new Set(n?.visibleRouteIds||[])})}));function xz(n){const e=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL"
  xmlns="http://www.topografix.com/GPX/1/1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">
  <metadata>
    <name>${n.name}</name>
    <time>${new Date(n.startTime).toISOString()}</time>
  </metadata>
  <trk>
    <name>${n.name}</name>
    <trkseg>
${n.points.map(s=>`      <trkpt lat="${s.coordinates[1]}" lon="${s.coordinates[0]}">
        <time>${new Date(s.timestamp).toISOString()}</time>
      </trkpt>`).join(`
`)}
    </trkseg>
  </trk>
</gpx>`,t=new Blob([e],{type:"application/gpx+xml"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=`${n.name.replace(/[^a-zA-Z0-9]/g,"-")}.gpx`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}let vu=null,_p=null;function yz(){if(typeof window>"u"||!("speechSynthesis"in window))return!1;vu=window.speechSynthesis;const n=()=>{const e=vu?.getVoices()||[];_p=e.find(t=>t.lang.startsWith("nl")||t.name.toLowerCase().includes("dutch")||t.name.toLowerCase().includes("nederland"))||null,!_p&&e.length>0&&(_p=e[0])};return n(),vu&&(vu.onvoiceschanged=n),!0}function Ebe(n,e){if(!vu&&!yz()||!vu)return;vu.cancel();const t=new SpeechSynthesisUtterance(n);_p&&(t.voice=_p),t.lang="nl-NL",t.rate=e?.rate,t.pitch=e?.pitch??1,t.volume=e?.volume??1,vu.speak(t)}function Sbe(n){const e=[];e.push(`${n.type} toegevoegd`),n.material&&n.material!=="Onbekend"&&e.push(`Materiaal: ${n.material}`),n.period&&n.period!=="Onbekend"&&e.push(`Periode: ${n.period}`),n.layerName&&n.layerName!=="Vondsten"&&e.push(`Opgeslagen in ${n.layerName}`);const t=e.join(". ");Ebe(t,{rate:1.1})}yz();function tb({label:n,value:e,onChange:t,options:r,required:i=!1,placeholder:s="Typ hier..."}){const[a,o]=H.useState(!1),[l,c]=H.useState(!1),[h,g]=H.useState(""),m=e&&!r.includes(e),x=()=>{c(!0),g(m?e:""),o(!1)},y=()=>{h.trim()&&t(h.trim()),c(!1)};return l?f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&f.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),f.jsx("input",{type:"text",value:h,onChange:_=>g(_.target.value),onKeyDown:_=>{_.key==="Enter"&&(_.preventDefault(),y()),_.key==="Escape"&&c(!1)},onBlur:y,placeholder:s,autoFocus:!0,className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}):f.jsxs("div",{className:"relative",children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&f.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),f.jsxs("button",{type:"button",onClick:()=>o(!a),className:"w-full flex items-center justify-between px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-left",style:{border:"none",outline:"none"},children:[f.jsxs("span",{className:e?"":"text-gray-400",children:[e||"Selecteer...",m&&f.jsx(eO,{size:12,className:"inline ml-1 text-orange-500"})]}),f.jsx(nx,{size:16,className:`text-gray-400 transition-transform ${a?"rotate-180":""}`})]}),a&&f.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[f.jsxs("button",{type:"button",onClick:x,className:"w-full px-3 py-2 text-left text-sm text-orange-600 hover:bg-orange-50 transition-colors flex items-center gap-2",style:{border:"none",outline:"none"},children:[f.jsx(eO,{size:12}),"Eigen invoer..."]}),f.jsx("div",{className:"border-t border-gray-100"}),r.map(_=>f.jsx("button",{type:"button",onClick:()=>{t(_),o(!1)},className:`w-full px-3 py-2 text-left text-sm transition-colors ${_===e?"bg-orange-50 text-orange-600":"text-gray-600 hover:bg-gray-50"}`,style:{border:"none",outline:"none"},children:_},_))]})]})}function _z({onClose:n,initialLocation:e}){const t=Wi(Fe=>Fe.position),r=pi(Fe=>Fe.map),i=wr(Fe=>Fe.vondstFormPhoto),s=fs(Fe=>Fe.layers),a=fs(Fe=>Fe.addPoint),o=yn(Fe=>Fe.voiceFeedbackEnabled),l=To(Fe=>Fe.state),c=To(Fe=>Fe.startTime);To(Fe=>Fe.savedRoutes);const h=()=>l==="idle"||!c?null:`Route ${new Date(c).toLocaleDateString("nl-NL")} ${new Date(c).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,g=l==="recording"||l==="paused",m=h(),[x,y]=H.useState(""),[_,w]=H.useState(""),[T,b]=H.useState(""),[R,M]=H.useState(""),[D,B]=H.useState(!1),[k,A]=H.useState(void 0),[C,O]=H.useState(void 0),[P,z]=H.useState(uo),[F,xe]=H.useState(i),[Ce,Ge]=H.useState(null);H.useEffect(()=>{if(F){const Fe=URL.createObjectURL(F);return Ge(Fe),()=>URL.revokeObjectURL(Fe)}else Ge(null)},[F]);const[Ne,ue]=H.useState(e?"map-pick":t?"gps":"map-center"),[ke,ae]=H.useState(e||null),[Z,V]=H.useState(!1),Q=()=>{if(Ne==="gps"&&t)return{lat:t.lat,lng:t.lng};if(Ne==="map-pick"&&ke)return ke;if(r){const Fe=r.getView().getCenter();if(Fe){const[Et,Ft]=Tn(Fe);return{lat:Ft,lng:Et}}}return null},ee=Q();H.useEffect(()=>{if(!Z||!r)return;const Fe=Et=>{const[Ft,Dt]=Tn(Et.coordinate);ae({lat:Dt,lng:Ft}),ue("map-pick"),V(!1)};return r.on("click",Fe),()=>r.un("click",Fe)},[Z,r]);const re=()=>V(!0),he=()=>{t&&(ue("gps"),ae(null))},Ve=()=>{const Fe=document.createElement("input");Fe.type="file",Fe.accept="image/*",Fe.capture="environment",Fe.onchange=Et=>{const Ft=Et.target.files?.[0];Ft&&xe(Ft)},Fe.click()},Be=()=>xe(null),ye=async Fe=>{Fe.preventDefault();const Et=Q();if(!Et){alert("Geen locatie beschikbaar");return}if(!_){alert("Vul een naam/type in");return}B(!0);try{let Ft=x||"";if(P===uo){const Xt=[];T&&Xt.push(`Materiaal: ${T}`),R&&Xt.push(`Periode: ${R}`),k&&Xt.push(`Gewicht: ${k}g`),C&&Xt.push(`Lengte: ${C}mm`),Xt.length>0&&(Ft=Xt.join(" | ")+(x?` | ${x}`:""))}a(P,{coordinates:[Et.lng,Et.lat],name:_,category:P===uo?_:"Overig",notes:Ft||"",...g&&c?{routeId:`recording-${c}`,routeName:m||void 0}:{}});const Dt=s.find(Xt=>Xt.id===P)?.name||"Vondsten";o&&Sbe({type:_,material:T||void 0,period:R||void 0,layerName:Dt}),alert(`Toegevoegd aan ${Dt}! `),n()}catch(Ft){alert("Fout bij opslaan: "+Ft.message)}finally{B(!1)}},pe=H.useMemo(()=>s.map(Fe=>({id:Fe.id,name:Fe.name,color:Fe.color})),[s]);return Z?f.jsx(wt.div,{className:"fixed bottom-0 left-0 right-0 z-[2000] p-4",initial:{y:100},animate:{y:0},exit:{y:100},children:f.jsxs("div",{className:"bg-orange-500 text-white rounded-xl shadow-xl p-4 flex items-center justify-between max-w-md mx-auto",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(i1,{size:24,className:"animate-pulse"}),f.jsxs("div",{children:[f.jsx("div",{className:"font-medium",children:"Tik op de kaart"}),f.jsx("div",{className:"text-sm opacity-90",children:"om locatie te kiezen"})]})]}),f.jsx("button",{onClick:()=>V(!1),className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"})]})}):f.jsx(wt.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:f.jsxs(wt.div,{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[f.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white px-5 py-4 flex justify-between items-center flex-shrink-0",children:[f.jsx("h2",{className:"text-lg font-semibold",children:"Nieuwe Vondst"}),f.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:f.jsx(Xr,{size:20})})]}),f.jsxs("form",{onSubmit:ye,className:"flex-1 overflow-y-auto",children:[f.jsxs("div",{className:"p-5 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto"}),Ce?f.jsxs("div",{className:"relative",children:[f.jsx("img",{src:Ce,alt:"Vondst",className:"w-full h-40 object-cover rounded-xl"}),f.jsx("button",{type:"button",onClick:Be,className:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors border-0 outline-none shadow-lg",children:f.jsx(_c,{size:16})})]}):f.jsxs("button",{type:"button",onClick:Ve,className:"w-full h-32 bg-gray-50 rounded-xl flex flex-col items-center justify-center gap-2 hover:bg-gray-100 transition-colors text-gray-500 border-2 border-dashed border-gray-200",style:{outline:"none"},children:[f.jsx(OE,{size:32}),f.jsx("span",{className:"text-sm",children:"Maak een foto"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Locatie"}),ee&&f.jsxs("div",{className:"bg-orange-50 rounded-xl px-4 py-3 mb-2",children:[f.jsxs("div",{className:"text-sm text-orange-800 font-mono",children:[ee.lat.toFixed(6),"N, ",ee.lng.toFixed(6),"E"]}),f.jsx("div",{className:"text-xs text-orange-600 mt-1",children:Ne==="gps"?" GPS locatie":Ne==="map-pick"?" Gekozen op kaart":" Kaart midden"})]}),!ee&&f.jsx("div",{className:"bg-red-50 rounded-xl px-4 py-3 mb-2",children:f.jsx("div",{className:"text-sm text-red-600",children:"Geen locatie beschikbaar"})}),f.jsxs("div",{className:"flex gap-2",children:[t&&Ne!=="gps"&&f.jsxs("button",{type:"button",onClick:he,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors border-0 outline-none",children:[f.jsx(rx,{size:16}),"GPS"]}),f.jsxs("button",{type:"button",onClick:re,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors border-0 outline-none",children:[f.jsx(i1,{size:16}),"Kies op kaart"]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opslaan naar"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:pe.map(Fe=>f.jsx("button",{type:"button",onClick:()=>z(Fe.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all border-0 outline-none ${P===Fe.id?"bg-gray-800 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:Fe.name},Fe.id))})]}),P===uo&&f.jsx(tb,{label:"Type vondst",value:_,onChange:w,options:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],required:!0,placeholder:"Typ type vondst..."}),P!==uo&&f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Naam",f.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),f.jsx("input",{type:"text",value:_,onChange:Fe=>w(Fe.target.value),placeholder:"Naam van het punt...",className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}),P===uo&&f.jsxs(f.Fragment,{children:[f.jsx(tb,{label:"Materiaal",value:T,onChange:b,options:["Brons","IJzer","Zilver","Goud","Koper","Lood","Tin","Keramiek","Steen","Glas","Bot","Hout","Leer","Onbekend"],placeholder:"Typ materiaal..."}),f.jsx(tb,{label:"Periode",value:R,onChange:M,options:["Steentijd","Bronstijd","IJzertijd","Romeins","Middeleeuws","Nieuwetijd","Modern","Onbekend"],placeholder:"Typ periode..."}),f.jsxs("div",{className:"flex gap-3",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Gewicht (g)"}),f.jsx("input",{type:"number",value:k??"",onChange:Fe=>A(Fe.target.value?parseFloat(Fe.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]}),f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Lengte (mm)"}),f.jsx("input",{type:"number",value:C??"",onChange:Fe=>O(Fe.target.value?parseFloat(Fe.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Notities"}),f.jsx("textarea",{value:x,onChange:Fe=>y(Fe.target.value),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all resize-none h-20",style:{border:"none",outline:"none"},placeholder:"Beschrijving, context, vindplaats details..."})]}),f.jsx("div",{className:"rounded-xl px-4 py-3 bg-orange-50",children:f.jsx("p",{className:"text-sm text-orange-700",children:' Opgeslagen in "Mijn Lagen" op dit apparaat'})})]}),f.jsxs("div",{className:"p-5 pt-0 flex gap-3",children:[f.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors font-medium border-0 outline-none",children:"Annuleren"}),f.jsx("button",{type:"submit",disabled:D||!ee||Z||!_,className:"flex-1 px-4 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium border-0 outline-none",children:D?"Opslaan...":"Opslaan"})]})]})]})})}function Tbe(){const{user:n,setUser:e,setLoading:t}=AE();return H.useEffect(()=>{const s=o6(Hh,a=>{e(a),t(!1)});return()=>s()},[e,t]),{user:n,loginAnonymous:async()=>{try{await vJ(Hh)}catch(s){console.error("Login failed:",s)}},logout:async()=>{try{await l6(Hh)}catch(s){console.error("Logout failed:",s)}},isAuthenticated:!!n}}function bbe(){const{isAuthenticated:n,loginAnonymous:e}=Tbe(),t=yn(c=>c.vondstenLocalOnly),r=yn(c=>c.showVondstButton),i=wr(c=>c.vondstFormOpen),s=wr(c=>c.vondstFormLocation),a=wr(c=>c.openVondstForm),o=wr(c=>c.closeVondstForm);if(!r)return null;const l=()=>{if(t){a();return}if(!n){confirm("Je moet ingelogd zijn om vondsten in de cloud op te slaan. Anoniem inloggen?")&&e();return}a()};return f.jsxs(f.Fragment,{children:[f.jsx(wt.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:l,title:"Vondst toevoegen",children:f.jsx(As,{size:22,strokeWidth:2})}),f.jsx(In,{children:i&&f.jsx(_z,{onClose:o,initialLocation:s||void 0})})]})}function Rbe(){const n=yn(pe=>pe.showRouteRecordButton),e=yn(pe=>pe.showVondstButton),t=wr(pe=>pe.toggleRouteDashboard),{state:r,startRecording:i,pauseRecording:s,resumeRecording:a,stopRecording:o,cancelRecording:l,addPoint:c,getCurrentDistance:h,getCurrentDuration:g,getAverageSpeed:m,currentPoints:x,savedRoutes:y,autoPauseEnabled:_,autoPauseSeconds:w}=To(),[T,b]=H.useState(!1),[R,M]=H.useState(""),[D,B]=H.useState(!1),[k,A]=H.useState(!1),C=H.useRef(null),O=H.useRef(null),P=H.useRef(null),z=pe=>{const Fe=Math.floor(pe/1e3),Et=Math.floor(Fe/3600),Ft=Math.floor(Fe%3600/60),Dt=Fe%60;return Et>0?`${Et}:${Ft.toString().padStart(2,"0")}:${Dt.toString().padStart(2,"0")}`:`${Ft}:${Dt.toString().padStart(2,"0")}`},F=pe=>pe<1e3?`${Math.round(pe)} m`:`${(pe/1e3).toFixed(2)} km`,xe=pe=>`${pe.toFixed(1)} km/h`,Ce=(pe,Fe,Et,Ft)=>{const Xt=(Ft-Fe)*Math.PI/180,en=(Et-pe)*Math.PI/180,ot=Math.sin(Xt/2)*Math.sin(Xt/2)+Math.cos(Fe*Math.PI/180)*Math.cos(Ft*Math.PI/180)*Math.sin(en/2)*Math.sin(en/2);return 6371e3*(2*Math.atan2(Math.sqrt(ot),Math.sqrt(1-ot)))};if(H.useEffect(()=>(r==="recording"?(A(!1),"geolocation"in navigator&&C.current===null&&(C.current=navigator.geolocation.watchPosition(pe=>{const Fe=pe.coords.longitude,Et=pe.coords.latitude,Ft=Date.now();c(Fe,Et,pe.coords.accuracy),_&&O.current?Ce(O.current.lon,O.current.lat,Fe,Et)>3?(O.current={lon:Fe,lat:Et,time:Ft},P.current&&(clearTimeout(P.current),P.current=null)):Ft-O.current.time>=w*1e3&&(s(),A(!0),O.current=null):O.current={lon:Fe,lat:Et,time:Ft}},pe=>{console.error("GPS error:",pe)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:1e3}))):(C.current!==null&&(navigator.geolocation.clearWatch(C.current),C.current=null),P.current&&(clearTimeout(P.current),P.current=null)),()=>{C.current!==null&&(navigator.geolocation.clearWatch(C.current),C.current=null),P.current&&(clearTimeout(P.current),P.current=null)}),[r,c,_,w,s]),!n)return null;const Ge=e?"right-[114px]":"right-[60px]",Ne=e?"right-[168px]":"right-[114px]",ue=()=>{i(),B(!0)},ke=()=>{s()},ae=()=>{a()},Z=()=>{M(`Route ${new Date().toLocaleDateString("nl-NL")}`),b(!0)},V=()=>{const pe=o(R);b(!1),B(!1),M(""),pe&&confirm(`Route "${pe.name}" opgeslagen! (${F(pe.totalDistance)})

Direct exporteren als GPX?`)&&xz(pe)},Q=()=>{x.length>2&&!confirm("Weet je zeker dat je de opname wilt annuleren? De route wordt niet opgeslagen.")||(l(),b(!1),B(!1))},ee=h(),re=g(),he=m(),Ve=pe=>{switch(pe){case"recording":return"bg-red-500 hover:bg-red-600";case"paused":return"bg-yellow-500 hover:bg-yellow-600";default:return"bg-green-500 hover:bg-green-600"}},Be=pe=>{switch(pe){case"recording":return f.jsx(RV,{size:22,strokeWidth:2});case"paused":return f.jsx(kV,{size:22,strokeWidth:2});default:return f.jsx(Wv,{size:22,strokeWidth:2})}},ye=()=>{switch(r){case"idle":ue();break;case"recording":ke();break;case"paused":ae();break}};return f.jsxs(f.Fragment,{children:[f.jsxs(wt.button,{className:`fixed bottom-2 ${Ge} z-[1000] w-11 h-11 ${Ve(r)} text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm`,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:ye,title:r==="idle"?"Route opnemen":r==="recording"?"Pauzeren":"Hervatten",children:[Be(r),r==="recording"&&f.jsx(wt.div,{className:"absolute inset-0 rounded-xl bg-red-400",animate:{opacity:[.5,0,.5]},transition:{duration:1.5,repeat:1/0}})]}),f.jsx(In,{children:r==="idle"&&y.length>0&&f.jsxs(wt.button,{className:`fixed bottom-2 ${Ne} z-[1000] w-11 h-11 bg-green-400 hover:bg-green-500 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none`,initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t,title:`Mijn routes (${y.length})`,children:[f.jsx(TV,{size:18,strokeWidth:2}),f.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-white text-green-600 text-xs font-bold rounded-full flex items-center justify-center shadow-sm",children:y.length})]})}),f.jsx(In,{children:(r==="recording"||r==="paused")&&f.jsx(wt.button,{className:`fixed bottom-2 ${Ne} z-[1000] w-11 h-11 bg-gray-700 hover:bg-gray-800 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none`,initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Z,title:"Stoppen en opslaan",children:f.jsx(Xue,{size:18,strokeWidth:2,fill:"currentColor"})})}),f.jsx(In,{children:D&&r!=="idle"&&f.jsxs(wt.div,{className:"fixed bottom-16 right-2 z-[999] bg-white/95 backdrop-blur-sm rounded-xl shadow-lg p-3 min-w-[180px]",initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:r==="recording"?" Opname":k?" Auto-pauze":" Gepauzeerd"}),f.jsx("button",{onClick:()=>B(!1),className:"p-0.5 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:f.jsx(Xr,{size:14})})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(s1,{size:16,className:"text-green-500"}),f.jsx("span",{className:"text-lg font-semibold text-gray-800",children:F(ee)})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Gv,{size:16,className:"text-blue-500"}),f.jsx(Abe,{duration:re,recordingState:r,formatTime:z})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Gce,{size:16,className:"text-green-500"}),f.jsx("span",{className:"text-sm text-gray-600",children:xe(he)})]}),f.jsxs("div",{className:"text-xs text-gray-400 pt-1 border-t border-gray-100",children:[x.length," punten opgenomen"]})]})]})}),f.jsx(In,{children:T&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1500] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>b(!1)}),f.jsxs(wt.div,{className:"fixed left-4 right-4 top-1/2 z-[1501] bg-white rounded-xl shadow-2xl p-4 max-w-sm mx-auto",initial:{opacity:0,scale:.9,y:"-40%"},animate:{opacity:1,scale:1,y:"-50%"},exit:{opacity:0,scale:.9,y:"-40%"},children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Route opslaan"}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 space-y-1",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Afstand:"}),f.jsx("span",{className:"font-medium",children:F(ee)})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Duur:"}),f.jsx("span",{className:"font-medium",children:z(re)})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Gem. snelheid:"}),f.jsx("span",{className:"font-medium",children:xe(he)})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Punten:"}),f.jsx("span",{className:"font-medium",children:x.length})]})]}),f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de route"}),f.jsx("input",{type:"text",value:R,onChange:pe=>M(pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Route naam...",autoFocus:!0})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:Q,className:"flex-1 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"}),f.jsxs("button",{onClick:V,disabled:x.length<2,className:"flex-1 px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-gray-300 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[f.jsx(IV,{size:16}),"Opslaan"]})]}),x.length<2&&f.jsx("p",{className:"text-xs text-red-500 text-center mt-2",children:"Minimaal 2 punten nodig om op te slaan"})]})]})})]})}function Abe({duration:n,recordingState:e,formatTime:t}){const[r,i]=H.useState(n);return H.useEffect(()=>{if(e!=="recording"){i(n);return}const s=setInterval(()=>{i(a=>a+1e3)},1e3);return()=>clearInterval(s)},[e,n]),H.useEffect(()=>{i(n)},[n]),f.jsx("span",{className:"text-lg font-semibold text-gray-800",children:t(r)})}function kbe(){const n=pi(s=>s.map),{currentPoints:e,state:t}=To(),r=H.useRef(null),i=H.useRef(null);return H.useEffect(()=>{if(!n)return;const s=new mc;i.current=s;const a=new Hu({source:s,zIndex:999,properties:{name:"route-recording-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),H.useEffect(()=>{if(!i.current||(i.current.clear(),t==="idle"||e.length===0))return;const s=e.map(a=>kr(a.coordinates));if(s.length>=2){const a=new _r({geometry:new bi(s)});a.setStyle(new pn({stroke:new Yn({color:t==="paused"?"rgba(234, 179, 8, 0.8)":"rgba(168, 85, 247, 0.8)",width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(a)}if(s.length>=1){const a=new _r({geometry:new gi(s[0])});a.setStyle(new pn({image:new Ws({radius:8,fill:new rr({color:"rgba(34, 197, 94, 1)"}),stroke:new Yn({color:"white",width:2})})})),i.current.addFeature(a)}if(s.length>=1){const a=new _r({geometry:new gi(s[s.length-1])});a.setStyle(new pn({image:new Ws({radius:6,fill:new rr({color:t==="paused"?"rgba(234, 179, 8, 1)":"rgba(168, 85, 247, 1)"}),stroke:new Yn({color:"white",width:2})})})),i.current.addFeature(a)}},[e,t]),null}const vD=["#a855f7","#3b82f6","#22c55e","#f97316","#ec4899","#14b8a6","#eab308","#8b5cf6"];function Ibe(){const n=pi(s=>s.map),{savedRoutes:e,visibleRouteIds:t}=To(),r=H.useRef(null),i=H.useRef(null);return H.useEffect(()=>{if(!n)return;const s=new mc;i.current=s;const a=new Hu({source:s,zIndex:998,properties:{name:"saved-routes-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),H.useEffect(()=>{if(!i.current)return;i.current.clear(),e.filter(a=>t.has(a.id)).forEach((a,o)=>{const l=vD[o%vD.length],c=a.points.map(_=>kr(_.coordinates));if(c.length<2)return;const h=new _r({geometry:new bi(c),routeId:a.id,routeName:a.name});h.setStyle(new pn({stroke:new Yn({color:l,width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(h);const g=new _r({geometry:new gi(c[0]),routeId:a.id,type:"start"});g.setStyle(new pn({image:new Ws({radius:8,fill:new rr({color:"#22c55e"}),stroke:new Yn({color:"white",width:2})}),text:new vo({text:"S",font:"bold 10px sans-serif",fill:new rr({color:"white"}),offsetY:1})})),i.current.addFeature(g);const m=new _r({geometry:new gi(c[c.length-1]),routeId:a.id,type:"end"});m.setStyle(new pn({image:new Ws({radius:8,fill:new rr({color:"#ef4444"}),stroke:new Yn({color:"white",width:2})}),text:new vo({text:"E",font:"bold 10px sans-serif",fill:new rr({color:"white"}),offsetY:1})})),i.current.addFeature(m);const x=Math.floor(c.length/2),y=new _r({geometry:new gi(c[x]),routeId:a.id,type:"label"});y.setStyle(new pn({text:new vo({text:a.name,font:"12px sans-serif",fill:new rr({color:"#1f2937"}),stroke:new Yn({color:"white",width:3}),offsetY:-15})})),i.current.addFeature(y)})},[e,t]),null}function Cbe(){const n=pi(a=>a.map),{savedRoutes:e,visibleRouteIds:t,heatmapEnabled:r}=To(),i=H.useRef(null),s=H.useRef(null);return H.useEffect(()=>{if(!n)return;const a=new mc;s.current=a;const o=new gX({source:a,blur:15,radius:10,weight:()=>1,gradient:["#00f","#0ff","#0f0","#ff0","#f00"],opacity:.6,zIndex:90});return i.current=o,n.addLayer(o),()=>{n&&i.current&&n.removeLayer(i.current)}},[n]),H.useEffect(()=>{if(!s.current||!i.current)return;if(s.current.clear(),!r){i.current.setVisible(!1);return}const a=e.filter(l=>t.has(l.id)),o=[];for(const l of a)for(const c of l.points){const h=new _r({geometry:new gi(kr(c.coordinates))});o.push(h)}s.current.addFeatures(o),i.current.setVisible(o.length>0)},[e,t,r]),null}function Pbe(n,e,t,r){const i=[],s=e/111e3,a=e/(111e3*Math.cos(n[1]*Math.PI/180)),o=Math.floor(t/2),l=n[0]-o*a,c=n[0]+o*a,h=n[1]-o*s,g=n[1]+o*s;for(let _=-o;_<=o;_++){const w=n[0]+_*a,T=[kr([w,h]),kr([w,g])],b=new _r({geometry:new bi(T),type:"grid-line"});b.setStyle(new pn({stroke:new Yn({color:r,width:_===0?2:1,lineDash:_===0?void 0:[5,5]})})),i.push(b)}for(let _=-o;_<=o;_++){const w=n[1]+_*s,T=[kr([l,w]),kr([c,w])],b=new _r({geometry:new bi(T),type:"grid-line"});b.setStyle(new pn({stroke:new Yn({color:r,width:_===0?2:1,lineDash:_===0?void 0:[5,5]})})),i.push(b)}const m="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let _=-o;_<o;_++)for(let w=-o;w<o;w++){const T=n[0]+(w+.5)*a,b=n[1]+(_+.5)*s,R=_+o,M=w+o;if(R>=0&&R<m.length){const D=`${m[R]}${M+1}`,B=new _r({geometry:new bi([kr([T,b]),kr([T,b])]),type:"grid-label"});B.setStyle(new pn({text:new vo({text:D,font:"12px sans-serif",fill:new rr({color:r}),stroke:new Yn({color:"rgba(255,255,255,0.8)",width:3})})})),i.push(B)}}const x=new _r({geometry:new bi([kr([n[0]-a*.2,n[1]]),kr([n[0]+a*.2,n[1]])]),type:"grid-center"});x.setStyle(new pn({stroke:new Yn({color:"#ef4444",width:3})})),i.push(x);const y=new _r({geometry:new bi([kr([n[0],n[1]-s*.2]),kr([n[0],n[1]+s*.2])]),type:"grid-center"});return y.setStyle(new pn({stroke:new Yn({color:"#ef4444",width:3})})),i.push(y),i}function Nbe(){const n=pi(l=>l.map),{gridEnabled:e,gridCenter:t,gridSize:r,gridCount:i,gridColor:s}=To(),a=H.useRef(null),o=H.useRef(null);return H.useEffect(()=>{if(!n)return;const l=new mc;o.current=l;const c=new Hu({source:l,zIndex:85,properties:{name:"grid-overlay-layer"}});return a.current=c,n.addLayer(c),()=>{a.current&&n&&n.removeLayer(a.current)}},[n]),H.useEffect(()=>{if(!o.current||!a.current)return;if(o.current.clear(),!e||!t){a.current.setVisible(!1);return}const l=Pbe(t,r,i,s);o.current.addFeatures(l),a.current.setVisible(!0)},[e,t,r,i,s]),null}function Mbe(n){const e=[];let t=0;return n.points.forEach((r,i)=>{if(i>0){const o=n.points[i-1],l=6371e3,c=(r.coordinates[1]-o.coordinates[1])*Math.PI/180,h=(r.coordinates[0]-o.coordinates[0])*Math.PI/180,g=Math.sin(c/2)*Math.sin(c/2)+Math.cos(o.coordinates[1]*Math.PI/180)*Math.cos(r.coordinates[1]*Math.PI/180)*Math.sin(h/2)*Math.sin(h/2),m=2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g));t+=l*m}const s=5,a=Math.sin(t/50)*2+Math.sin(t/120)*1.5+Math.sin(t/30+r.coordinates[0]*1e3)*.5;e.push({distance:t,elevation:Math.max(0,s+a)})}),e}function Lbe({route:n,onClose:e}){const t=H.useRef(null),[r,i]=H.useState([]),[s,a]=H.useState({min:0,max:0,gain:0,loss:0});H.useEffect(()=>{const l=Mbe(n);if(i(l),l.length>0){const c=l.map(y=>y.elevation),h=Math.min(...c),g=Math.max(...c);let m=0,x=0;for(let y=1;y<l.length;y++){const _=l[y].elevation-l[y-1].elevation;_>0?m+=_:x+=Math.abs(_)}a({min:h,max:g,gain:m,loss:x})}},[n]),H.useEffect(()=>{const l=t.current;if(!l||r.length<2)return;const c=l.getContext("2d");if(!c)return;const h=l.width,g=l.height,m={top:20,right:20,bottom:30,left:40};c.fillStyle="#f9fafb",c.fillRect(0,0,h,g);const x=Math.max(...r.map(D=>D.distance)),y=Math.min(...r.map(D=>D.elevation))-1,_=Math.max(...r.map(D=>D.elevation))+1,w=D=>m.left+D/x*(h-m.left-m.right),T=D=>g-m.bottom-(D-y)/(_-y)*(g-m.top-m.bottom);c.strokeStyle="#e5e7eb",c.lineWidth=1;const b=5;for(let D=0;D<=b;D++){const B=y+(_-y)*(D/b),k=T(B);c.beginPath(),c.moveTo(m.left,k),c.lineTo(h-m.right,k),c.stroke(),c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="right",c.fillText(`${B.toFixed(1)}m`,m.left-5,k+3)}const R=5;for(let D=0;D<=R;D++){const B=x/R*D,k=w(B);c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="center",c.fillText(B<1e3?`${Math.round(B)}m`:`${(B/1e3).toFixed(1)}km`,k,g-10)}c.beginPath(),c.moveTo(w(r[0].distance),g-m.bottom),r.forEach(D=>{c.lineTo(w(D.distance),T(D.elevation))}),c.lineTo(w(r[r.length-1].distance),g-m.bottom),c.closePath();const M=c.createLinearGradient(0,m.top,0,g-m.bottom);M.addColorStop(0,"rgba(139, 92, 246, 0.3)"),M.addColorStop(1,"rgba(139, 92, 246, 0.05)"),c.fillStyle=M,c.fill(),c.strokeStyle="#8b5cf6",c.lineWidth=2,c.lineJoin="round",c.lineCap="round",c.beginPath(),r.forEach((D,B)=>{const k=w(D.distance),A=T(D.elevation);B===0?c.moveTo(k,A):c.lineTo(k,A)}),c.stroke()},[r]);const o=l=>l<1e3?`${Math.round(l)} m`:`${(l/1e3).toFixed(2)} km`;return f.jsxs(wt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed inset-4 z-[1700] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[70vh]",children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(rg,{size:20}),f.jsx("span",{className:"font-medium",children:"Hoogteprofiel"})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:f.jsx(Xr,{size:18})})]}),f.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100",children:[f.jsx("h3",{className:"font-medium text-gray-800 truncate",children:n.name}),f.jsx("p",{className:"text-xs text-gray-500",children:o(n.totalDistance)})]}),f.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 border-b border-gray-100",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-blue-500 mb-1",children:f.jsx(bV,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Min"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.min.toFixed(1),"m"]})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-purple-500 mb-1",children:f.jsx(rg,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Max"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.max.toFixed(1),"m"]})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-green-500 mb-1",children:f.jsx(che,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Stijging"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.gain.toFixed(1),"m"]})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-red-500 mb-1",children:f.jsx(ohe,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Daling"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.loss.toFixed(1),"m"]})]})]}),f.jsx("div",{className:"flex-1 p-3",children:f.jsx("canvas",{ref:t,width:350,height:200,className:"w-full h-full"})}),f.jsx("div",{className:"px-4 py-2 bg-yellow-50 border-t border-yellow-100",children:f.jsxs("p",{className:"text-xs text-yellow-700",children:[f.jsx("strong",{children:"Let op:"})," Dit zijn gesimuleerde hoogtewaarden. Koppeling met AHN-data komt binnenkort."]})})]})}const Obe=n=>n<1e3?`${Math.round(n)} m`:`${(n/1e3).toFixed(2)} km`,Dbe=n=>{const e=Math.floor(n/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60);return t>0?`${t}u ${r}m`:`${r} min`},wD=n=>new Date(n).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});function jbe({route:n,onClose:e}){const{updateRouteNotes:t,addPhotoToRoute:r,removePhotoFromRoute:i}=To(),[s,a]=H.useState(n.notes||""),[o,l]=H.useState("info"),c=H.useRef(null),h=()=>{t(n.id,s)},g=async y=>{const _=y.target.files?.[0];if(!_)return;const w=URL.createObjectURL(_);r(n.id,{url:w,caption:_.name}),c.current&&(c.current.value="")},m=y=>{confirm("Foto verwijderen?")&&i(n.id,y)},x=To(y=>y.savedRoutes.find(_=>_.id===n.id))||n;return f.jsxs(wt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[1700] flex items-center justify-center p-4",children:[f.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),f.jsxs(wt.div,{initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},className:"relative bg-white rounded-xl shadow-2xl overflow-hidden w-full max-w-md max-h-[85vh] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("h3",{className:"font-medium truncate",children:x.name}),f.jsx("p",{className:"text-xs text-purple-200",children:wD(x.createdAt)})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none ml-2",children:f.jsx(Xr,{size:18})})]}),f.jsxs("div",{className:"flex border-b border-gray-200",children:[f.jsxs("button",{onClick:()=>l("info"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="info"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[f.jsx(As,{size:16,className:"inline mr-1"}),"Info"]}),f.jsxs("button",{onClick:()=>l("photos"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="photos"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[f.jsx(OE,{size:16,className:"inline mr-1"}),"Foto's (",x.photos?.length||0,")"]}),f.jsxs("button",{onClick:()=>l("notes"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="notes"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[f.jsx($I,{size:16,className:"inline mr-1"}),"Notities"]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[o==="info"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-purple-600 mb-1",children:[f.jsx(s1,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Afstand"})]}),f.jsx("p",{className:"text-lg font-semibold",children:Obe(x.totalDistance)})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[f.jsx(Gv,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Duur"})]}),f.jsx("p",{className:"text-lg font-semibold",children:Dbe(x.totalDuration)})]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[f.jsx(As,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Punten"})]}),f.jsxs("p",{className:"text-lg font-semibold",children:[x.points.length," GPS punten"]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-orange-600 mb-1",children:[f.jsx(LE,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Aangemaakt"})]}),f.jsx("p",{className:"text-sm",children:wD(x.createdAt)})]})]}),o==="photos"&&f.jsxs("div",{className:"space-y-4",children:[f.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:g,className:"hidden"}),f.jsxs("button",{onClick:()=>c.current?.click(),className:"w-full py-8 border-2 border-dashed border-purple-300 rounded-lg text-purple-500 hover:bg-purple-50 transition-colors flex flex-col items-center gap-2",children:[f.jsx(Xa,{size:24}),f.jsx("span",{className:"text-sm",children:"Foto toevoegen"})]}),x.photos&&x.photos.length>0?f.jsx("div",{className:"grid grid-cols-2 gap-2",children:x.photos.map(y=>f.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100",children:[f.jsx("img",{src:y.url,alt:y.caption||"Route foto",className:"w-full h-full object-cover"}),f.jsx("button",{onClick:()=>m(y.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors border-0 outline-none",children:f.jsx(_c,{size:12})}),y.caption&&f.jsx("div",{className:"absolute bottom-0 left-0 right-0 px-2 py-1 bg-black/50 text-white text-xs truncate",children:y.caption})]},y.id))}):f.jsx("p",{className:"text-center text-gray-400 text-sm py-4",children:"Nog geen foto's toegevoegd"})]}),o==="notes"&&f.jsxs("div",{className:"space-y-4",children:[f.jsx("textarea",{value:s,onChange:y=>a(y.target.value),placeholder:"Voeg notities toe over deze route...",className:"w-full h-48 p-3 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"}),f.jsx("button",{onClick:h,className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors border-0 outline-none",children:"Notities opslaan"})]})]})]})]})}function Fbe({route:n,size:e=80}){const t=H.useRef(null);return H.useEffect(()=>{const r=t.current;if(!r||n.points.length<2)return;const i=r.getContext("2d");if(!i)return;i.fillStyle="#f3f4f6",i.fillRect(0,0,e,e);const s=n.points.map(M=>M.coordinates[0]),a=n.points.map(M=>M.coordinates[1]),o=Math.min(...s),l=Math.max(...s),c=Math.min(...a),h=Math.max(...a),g=8,m=e-g*2,x=e-g*2,y=M=>l===o?e/2:g+(M-o)/(l-o)*m,_=M=>h===c?e/2:g+x-(M-c)/(h-c)*x;i.strokeStyle="#a855f7",i.lineWidth=2,i.lineCap="round",i.lineJoin="round",i.beginPath(),n.points.forEach((M,D)=>{const B=y(M.coordinates[0]),k=_(M.coordinates[1]);D===0?i.moveTo(B,k):i.lineTo(B,k)}),i.stroke();const w=y(n.points[0].coordinates[0]),T=_(n.points[0].coordinates[1]);i.fillStyle="#22c55e",i.beginPath(),i.arc(w,T,4,0,Math.PI*2),i.fill();const b=y(n.points[n.points.length-1].coordinates[0]),R=_(n.points[n.points.length-1].coordinates[1]);i.fillStyle="#ef4444",i.beginPath(),i.arc(b,R,4,0,Math.PI*2),i.fill()},[n,e]),n.points.length<2?f.jsx("div",{className:"bg-gray-100 rounded flex items-center justify-center text-gray-400",style:{width:e,height:e},children:f.jsx(As,{size:20})}):f.jsx("canvas",{ref:t,width:e,height:e,className:"rounded"})}const nb=n=>n<1e3?`${Math.round(n)} m`:`${(n/1e3).toFixed(2)} km`,rb=n=>{const e=Math.floor(n/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60);return t>0?`${t}u ${r}m`:`${r} min`},ED=n=>new Date(n).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric"});function Vbe({isOpen:n,onClose:e,onViewRoute:t}){const{savedRoutes:r,deleteRoute:i,renameRoute:s,clearAllRoutes:a,visibleRouteIds:o,toggleRouteVisibility:l,showAllRoutes:c,hideAllRoutes:h,heatmapEnabled:g,toggleHeatmap:m,gridEnabled:x,toggleGrid:y,centerGridOnCurrentLocation:_,gridSize:w,setGridSize:T,autoPauseEnabled:b,setAutoPauseEnabled:R,autoPauseSeconds:M,setAutoPauseSeconds:D,importRouteFromGPX:B}=To(),[k,A]=H.useState(null),[C,O]=H.useState(""),[P,z]=H.useState(!1),[F,xe]=H.useState(!1),[Ce,Ge]=H.useState(null),[Ne,ue]=H.useState(null),ke=H.useRef(null),ae=async ye=>{const pe=` ${ye.name}

 Afstand: ${nb(ye.totalDistance)}
 Duur: ${rb(ye.totalDuration)}
 ${ye.points.length} GPS punten
 ${ED(ye.createdAt)}

Opgenomen met DetectorApp NL`;if(navigator.share)try{await navigator.share({title:ye.name,text:pe});return}catch(Fe){Fe.name!=="AbortError"&&console.error("Share failed:",Fe)}try{await navigator.clipboard.writeText(pe),alert("Route info gekopieerd naar klembord!")}catch{prompt("Kopieer de route info:",pe)}},Z=async ye=>{const pe=ye.target.files?.[0];if(pe){try{const Fe=await pe.text(),Et=B(Fe,pe.name.replace(".gpx",""));Et.success?alert(`Route gemporteerd: ${pe.name}`):alert(`Import mislukt: ${Et.error}`)}catch{alert("Fout bij lezen van bestand")}ke.current&&(ke.current.value="")}},V=ye=>{A(ye.id),O(ye.name)},Q=ye=>{C.trim()&&s(ye,C.trim()),A(null),O("")},ee=ye=>{confirm(`Weet je zeker dat je "${ye.name}" wilt verwijderen?`)&&i(ye.id)},re=()=>{r.length!==0&&confirm(`Weet je zeker dat je alle ${r.length} routes wilt verwijderen? Dit kan niet ongedaan worden gemaakt.`)&&a()},he=ye=>{l(ye);const pe=r.find(Fe=>Fe.id===ye);pe&&t&&t(pe)},Ve=r.reduce((ye,pe)=>ye+pe.totalDistance,0),Be=r.reduce((ye,pe)=>ye+pe.totalDuration,0);return f.jsxs(f.Fragment,{children:[f.jsx(In,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Wv,{size:20}),f.jsx("span",{className:"font-medium",children:"Mijn Routes"}),f.jsxs("span",{className:"text-purple-200 text-sm",children:["(",r.length,")"]})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:f.jsx(Xr,{size:18})})]}),r.length>0&&f.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100 flex items-center justify-between text-sm",children:[f.jsxs("div",{className:"flex gap-4",children:[f.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[f.jsx(s1,{size:14}),f.jsxs("span",{children:["Totaal: ",nb(Ve)]})]}),f.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[f.jsx(Gv,{size:14}),f.jsx("span",{children:rb(Be)})]})]}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx("button",{onClick:()=>xe(!F),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${b?"bg-green-100 text-green-600":"text-purple-600 hover:bg-purple-100"}`,title:b?"Auto-pauze uit":"Auto-pauze aan",children:f.jsx(nhe,{size:14})}),f.jsx("button",{onClick:()=>z(!P),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${x?"bg-blue-100 text-blue-600":"text-purple-600 hover:bg-purple-100"}`,title:x?"Grid verbergen":"Grid tonen",children:f.jsx(SV,{size:14})}),f.jsx("button",{onClick:m,className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${g?"bg-orange-100 text-orange-600":"text-purple-600 hover:bg-purple-100"}`,title:g?"Heatmap verbergen":"Heatmap tonen",children:f.jsx(Nce,{size:14})}),f.jsx("button",{onClick:c,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle tonen",children:f.jsx($v,{size:14})}),f.jsx("button",{onClick:h,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle verbergen",children:f.jsx(Uv,{size:14})})]})]}),f.jsx(In,{children:P&&f.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:f.jsxs("div",{className:"px-4 py-3 bg-blue-50 space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Grid Assistent"}),f.jsx("button",{onClick:y,className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${x?"bg-blue-500 text-white":"bg-blue-200 text-blue-700"}`,children:x?"Aan":"Uit"})]}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsxs("button",{onClick:_,className:"flex-1 px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[f.jsx(i1,{size:14}),"Centreer op mijn locatie"]})}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("label",{className:"text-xs text-blue-700",children:["Celgrootte: ",w,"m"]}),f.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:w,onChange:ye=>T(Number(ye.target.value)),className:"w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer"}),f.jsxs("div",{className:"flex justify-between text-xs text-blue-600",children:[f.jsx("span",{children:"5m"}),f.jsx("span",{children:"50m"})]})]}),f.jsx("p",{className:"text-xs text-blue-600",children:"Gebruik het grid om systematisch een veld af te zoeken. Elk vak heeft een label (A1, B2, etc.) voor referentie."})]})})}),f.jsx(In,{children:F&&f.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:f.jsxs("div",{className:"px-4 py-3 bg-green-50 space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-sm font-medium text-green-800",children:"Auto-pauze"}),f.jsx("button",{onClick:()=>R(!b),className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${b?"bg-green-500 text-white":"bg-green-200 text-green-700"}`,children:b?"Aan":"Uit"})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("label",{className:"text-xs text-green-700",children:["Pauze na: ",M<60?`${M}s`:`${Math.floor(M/60)}m ${M%60}s`]}),f.jsx("input",{type:"range",min:"30",max:"300",step:"30",value:M,onChange:ye=>D(Number(ye.target.value)),className:"w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer"}),f.jsxs("div",{className:"flex justify-between text-xs text-green-600",children:[f.jsx("span",{children:"30s"}),f.jsx("span",{children:"5min"})]})]}),f.jsxs("p",{className:"text-xs text-green-600",children:["De opname pauzeert automatisch als je langer dan ",M<60?`${M} seconden`:`${Math.floor(M/60)} minuten`," stilstaat. Ideaal voor pauzes tijdens het detecteren."]})]})})}),f.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:r.length===0?f.jsxs("div",{className:"text-center py-12 text-gray-500",children:[f.jsx(Wv,{size:48,className:"mx-auto mb-3 text-gray-300"}),f.jsx("p",{className:"font-medium",children:"Nog geen routes"}),f.jsx("p",{className:"text-sm mt-1",children:"Start een opname om je eerste route vast te leggen"})]}):r.map(ye=>f.jsxs(wt.div,{layout:!0,className:"bg-gray-50 rounded-lg p-3 flex gap-3",children:[f.jsx(Fbe,{route:ye,size:70}),f.jsxs("div",{className:"flex-1 min-w-0",children:[k===ye.id?f.jsx("input",{type:"text",value:C,onChange:pe=>O(pe.target.value),onKeyDown:pe=>{pe.key==="Enter"&&Q(ye.id),pe.key==="Escape"&&A(null)},onBlur:()=>Q(ye.id),className:"w-full px-2 py-1 text-sm bg-white border border-purple-300 rounded outline-none focus:ring-2 focus:ring-purple-400",autoFocus:!0}):f.jsx("h3",{className:"font-medium text-gray-800 truncate",children:ye.name}),f.jsx("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(LE,{size:12}),ED(ye.createdAt)]})}),f.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-600",children:[f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(s1,{size:12}),nb(ye.totalDistance)]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(Gv,{size:12}),rb(ye.totalDuration)]}),f.jsxs("span",{children:[ye.points.length," punten"]})]})]}),f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("button",{onClick:()=>he(ye.id),className:`p-1.5 rounded transition-colors border-0 outline-none ${o.has(ye.id)?"bg-purple-100 text-purple-600":"text-gray-400 hover:text-purple-600 hover:bg-purple-50"}`,title:o.has(ye.id)?"Verbergen op kaart":"Tonen op kaart",children:o.has(ye.id)?f.jsx($v,{size:16}):f.jsx(Uv,{size:16})}),f.jsx("button",{onClick:()=>V(ye),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:f.jsx(ig,{size:16})}),f.jsx("button",{onClick:()=>ue(ye),className:"p-1.5 text-gray-400 hover:text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none",title:"Details & foto's",children:f.jsx(WI,{size:16})}),f.jsx("button",{onClick:()=>Ge(ye),className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Hoogteprofiel",children:f.jsx(rg,{size:16})}),f.jsx("button",{onClick:()=>ae(ye),className:"p-1.5 text-gray-400 hover:text-pink-600 hover:bg-pink-50 rounded transition-colors border-0 outline-none",title:"Delen",children:f.jsx(Fue,{size:16})}),f.jsx("button",{onClick:()=>xz(ye),className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteer als GPX",children:f.jsx(zv,{size:16})}),f.jsx("button",{onClick:()=>ee(ye),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:f.jsx(_c,{size:16})})]})]},ye.id))}),f.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",children:[f.jsx("input",{ref:ke,type:"file",accept:".gpx",onChange:Z,className:"hidden"}),f.jsxs("button",{onClick:()=>ke.current?.click(),className:"w-full px-3 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border-0 outline-none text-sm flex items-center justify-center gap-2",children:[f.jsx(ix,{size:16}),"GPX bestand importeren"]}),r.length>0&&f.jsx("button",{onClick:re,className:"w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none text-sm",children:"Alle routes verwijderen"})]})]})]})}),f.jsx(In,{children:Ce&&f.jsx(Lbe,{route:Ce,onClose:()=>Ge(null)})}),f.jsx(In,{children:Ne&&f.jsx(jbe,{route:Ne,onClose:()=>ue(null)})})]})}function Bbe({isOpen:n,onClose:e}){const[t,r]=H.useState(!0),[i,s]=H.useState(0),[a,o]=H.useState([]),[l,c]=H.useState([]),[h,g]=H.useState(7),[m,x]=H.useState("radar"),[y,_]=H.useState(""),[w,T]=H.useState([]),[b,R]=H.useState(!1),[M,D]=H.useState(null),[B,k]=H.useState(!1),A=H.useRef(null),C=Wi(ae=>ae.position),O=z9(ae=>ae.weatherData);H.useEffect(()=>{if(!n||m!=="radar")return;(async()=>{try{const V=await(await fetch("https://api.rainviewer.com/public/weather-maps.json")).json();if(V.radar?.past){const Q=[],ee=[];V.radar.past.forEach(re=>{Q.push(`https://tilecache.rainviewer.com${re.path}/256/{z}/{x}/{y}/2/1_1.png`),ee.push(re.time*1e3)}),V.radar?.nowcast&&V.radar.nowcast.forEach(re=>{Q.push(`https://tilecache.rainviewer.com${re.path}/256/{z}/{x}/{y}/2/1_1.png`),ee.push(re.time*1e3)}),o(Q),c(ee)}}catch(Z){console.error("Failed to fetch radar data:",Z)}})()},[n,m]),H.useEffect(()=>{if(!t||a.length===0||m!=="radar")return;const ae=setInterval(()=>{s(Z=>(Z+1)%a.length)},500);return()=>clearInterval(ae)},[t,a.length,m]),H.useEffect(()=>{if(!y||y.length<2){T([]);return}return A.current&&clearTimeout(A.current),A.current=setTimeout(async()=>{R(!0);try{const Z=await(await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(y)}&count=5&language=nl&format=json`)).json();Z.results?T(Z.results.map(V=>({name:V.name,admin1:V.admin1,country:V.country,latitude:V.latitude,longitude:V.longitude}))):T([])}catch{T([])}finally{R(!1)}},300),()=>{A.current&&clearTimeout(A.current)}},[y]);const P=M?.lat||C?.lat||52.1326,z=M?.lon||C?.lon||5.2913,F=M?.name||(C?"Huidige locatie":"Nederland"),xe=Math.pow(2,h),Ce=Math.floor((z+180)/360*xe),Ge=Math.floor((1-Math.log(Math.tan(P*Math.PI/180)+1/Math.cos(P*Math.PI/180))/Math.PI)/2*xe),Ne=()=>{if(l.length===0||!l[i])return"Laden...";new Date(l[i]);const ae=Date.now(),Z=Math.round((l[i]-ae)/6e4);return Math.abs(Z)<3?"Nu":Z<0?`${Z} min`:`+${Z} min`},ue=O?.precipitation48h||[],ke=ue.reduce((ae,Z,V)=>{if(V%4===0){const Q=ue.slice(V,V+4).reduce((ee,re)=>ee+re.precipitation,0);ae.push({time:Z.time,precip:Q})}return ae},[]);return n?f.jsx(In,{children:f.jsx(wt.div,{className:"fixed inset-0 z-[1800] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:f.jsx(wt.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:ae=>ae.stopPropagation(),children:f.jsxs("div",{className:"p-4 space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(UI,{size:20,className:"text-blue-500"}),f.jsx("span",{className:"font-semibold text-gray-800",children:"Buienradar"})]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("button",{onClick:()=>k(!B),className:`p-2 rounded-full transition-colors border-0 outline-none ${B?"bg-blue-100 text-blue-600":"hover:bg-gray-100 bg-transparent text-gray-500"}`,children:f.jsx(a1,{size:16})}),f.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:f.jsx(Xr,{size:16,className:"text-gray-500"})})]})]}),f.jsx(In,{children:B&&f.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"text",value:y,onChange:ae=>_(ae.target.value),placeholder:"Zoek locatie...",className:"w-full px-3 py-2 pl-9 bg-gray-100 rounded-lg border-0 outline-none focus:ring-2 focus:ring-blue-500 text-sm"}),f.jsx(a1,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]}),w.length>0&&f.jsx("div",{className:"bg-gray-50 rounded-lg overflow-hidden",children:w.map((ae,Z)=>f.jsxs("button",{onClick:()=>{D({lat:ae.latitude,lon:ae.longitude,name:ae.name}),_(""),T([]),k(!1)},className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-100 transition-colors border-0 outline-none bg-transparent text-left",children:[f.jsx(As,{size:14,className:"text-gray-400 flex-shrink-0"}),f.jsxs("div",{className:"min-w-0",children:[f.jsx("div",{className:"text-sm font-medium text-gray-800 truncate",children:ae.name}),f.jsxs("div",{className:"text-[10px] text-gray-500 truncate",children:[ae.admin1&&`${ae.admin1}, `,ae.country]})]})]},Z))}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("button",{onClick:()=>{D(null),_(""),k(!1)},className:"flex items-center gap-1.5 px-2 py-1 text-xs text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none bg-transparent",children:[f.jsx(i1,{size:12}),"Huidige locatie"]}),M&&f.jsx("span",{className:"text-[10px] text-gray-500",children:F})]})]})})}),!B&&M&&f.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-500",children:[f.jsx(As,{size:12}),f.jsx("span",{children:F})]}),f.jsxs("div",{className:"flex gap-1 p-1 bg-gray-100 rounded-lg",children:[f.jsxs("button",{onClick:()=>x("radar"),className:`flex-1 flex items-center justify-center gap-1.5 py-1.5 px-3 rounded-md text-sm font-medium transition-colors border-0 outline-none ${m==="radar"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:[f.jsx(wue,{size:14}),"Live radar"]}),f.jsxs("button",{onClick:()=>x("forecast"),className:`flex-1 flex items-center justify-center gap-1.5 py-1.5 px-3 rounded-md text-sm font-medium transition-colors border-0 outline-none ${m==="forecast"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:[f.jsx(LE,{size:14}),"48 uur"]})]}),m==="radar"?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"relative bg-gray-200 rounded-xl overflow-hidden",style:{aspectRatio:"1/1"},children:[f.jsx("div",{className:"absolute inset-0 grid grid-cols-3 grid-rows-3",children:[-1,0,1].map(ae=>[-1,0,1].map(Z=>f.jsx("img",{src:`https://tile.openstreetmap.org/${h}/${Ce+Z}/${Ge+ae}.png`,alt:"",className:"w-full h-full object-cover",style:{filter:"saturate(0.3) brightness(1.1)"}},`${Z}-${ae}-${h}`)))}),a.length>0&&f.jsx("div",{className:"absolute inset-0 grid grid-cols-3 grid-rows-3",children:[-1,0,1].map(ae=>[-1,0,1].map(Z=>f.jsx("img",{src:a[i]?.replace("{z}",h.toString()).replace("{x}",(Ce+Z).toString()).replace("{y}",(Ge+ae).toString()),alt:"",className:"w-full h-full object-cover",style:{mixBlendMode:"multiply"}},`radar-${Z}-${ae}-${h}`)))}),f.jsx("div",{className:"absolute top-2 right-2 bg-black/70 text-white px-2 py-1 rounded text-sm font-medium",children:Ne()}),f.jsxs("div",{className:"absolute top-2 left-2 flex flex-col gap-1",children:[f.jsx("button",{onClick:()=>g(ae=>Math.min(10,ae+1)),className:"w-8 h-8 bg-white/90 hover:bg-white rounded-lg shadow flex items-center justify-center border-0 outline-none transition-colors",disabled:h>=10,children:f.jsx(vhe,{size:16,className:h>=10?"text-gray-300":"text-gray-700"})}),f.jsx("button",{onClick:()=>g(ae=>Math.max(5,ae-1)),className:"w-8 h-8 bg-white/90 hover:bg-white rounded-lg shadow flex items-center justify-center border-0 outline-none transition-colors",disabled:h<=5,children:f.jsx(Ehe,{size:16,className:h<=5?"text-gray-300":"text-gray-700"})})]}),f.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:f.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full border-2 border-white shadow-lg"})})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("input",{type:"range",min:"0",max:Math.max(0,a.length-1),value:i,onChange:ae=>{r(!1),s(parseInt(ae.target.value))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),f.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[f.jsx("span",{children:"-1 uur"}),f.jsx("span",{children:"Nu"}),f.jsx("span",{children:"+30 min"})]})]}),f.jsx("div",{className:"flex items-center justify-center gap-3",children:f.jsxs("button",{onClick:()=>r(!t),className:"flex items-center gap-2 px-4 py-2 bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-xl transition-colors border-0 outline-none",children:[t?f.jsx(RV,{size:16}):f.jsx(kV,{size:16}),f.jsx("span",{className:"text-sm font-medium",children:t?"Pauzeren":"Afspelen"})]})}),f.jsxs("div",{className:"flex items-center justify-center gap-2 text-[10px] text-gray-500",children:[f.jsx("span",{children:"Licht"}),f.jsxs("div",{className:"flex h-2",children:[f.jsx("div",{className:"w-4 bg-blue-200 rounded-l"}),f.jsx("div",{className:"w-4 bg-blue-400"}),f.jsx("div",{className:"w-4 bg-blue-600"}),f.jsx("div",{className:"w-4 bg-purple-600"}),f.jsx("div",{className:"w-4 bg-red-500 rounded-r"})]}),f.jsx("span",{children:"Zwaar"})]})]}):f.jsx("div",{className:"space-y-3",children:ke.length>0?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[f.jsx("div",{className:"text-[10px] text-gray-500 mb-2",children:"Verwachte neerslag (mm/uur)"}),f.jsx("div",{className:"flex mb-1",children:[0,1].map(ae=>{const Z=new Date;Z.setDate(Z.getDate()+ae);const V=ae===0?"Vandaag":ae===1?"Morgen":Z.toLocaleDateString("nl-NL",{weekday:"short"});return f.jsx("div",{className:"flex-1 text-[10px] font-medium text-gray-600",children:V},ae)})}),f.jsx("div",{className:"relative h-24 flex items-end gap-px",children:ke.slice(0,48).map((ae,Z)=>{const V=Math.max(...ke.map(Ve=>Ve.precip),2),Q=ae.precip/V*100,ee=new Date(ae.time),re=ee.getHours()===0,he=ae.precip>4?"bg-purple-500":ae.precip>2?"bg-blue-600":ae.precip>1?"bg-blue-500":ae.precip>.5?"bg-blue-400":ae.precip>0?"bg-blue-300":"bg-gray-200";return f.jsx("div",{className:`flex-1 flex flex-col justify-end ${re?"border-l border-gray-300":""}`,children:f.jsx("div",{className:`w-full rounded-t-sm transition-all ${he}`,style:{height:`${Math.max(Q,ae.precip>0?4:2)}%`},title:`${ee.getHours()}:00 - ${ae.precip.toFixed(1)} mm`})},Z)})}),f.jsxs("div",{className:"flex mt-1 text-[8px] text-gray-400",children:[f.jsx("span",{className:"flex-1",children:"0u"}),f.jsx("span",{className:"flex-1 text-center",children:"12u"}),f.jsx("span",{className:"flex-1 text-center",children:"0u"}),f.jsx("span",{className:"flex-1 text-center",children:"12u"}),f.jsx("span",{className:"text-right",children:"0u"})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("div",{className:"bg-blue-50 rounded-lg p-2.5",children:[f.jsx("div",{className:"text-[10px] text-gray-500",children:"Vandaag totaal"}),f.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[ke.slice(0,24).reduce((ae,Z)=>ae+Z.precip,0).toFixed(1)," mm"]})]}),f.jsxs("div",{className:"bg-blue-50 rounded-lg p-2.5",children:[f.jsx("div",{className:"text-[10px] text-gray-500",children:"Morgen totaal"}),f.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[ke.slice(24,48).reduce((ae,Z)=>ae+Z.precip,0).toFixed(1)," mm"]})]})]}),f.jsxs("div",{className:"max-h-32 overflow-y-auto",children:[ke.filter(ae=>ae.precip>.1).slice(0,8).map((ae,Z)=>{const V=new Date(ae.time),Q=V.getDate()===new Date().getDate();return f.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-gray-100 last:border-0",children:[f.jsxs("span",{className:"text-sm text-gray-600",children:[Q?"Vandaag":"Morgen"," ",V.getHours(),":00"]}),f.jsxs("span",{className:`text-sm font-medium ${ae.precip>2?"text-blue-600":"text-gray-600"}`,children:[ae.precip.toFixed(1)," mm"]})]},Z)}),ke.filter(ae=>ae.precip>.1).length===0&&f.jsx("div",{className:"text-center py-4 text-sm text-green-600",children:"Geen neerslag verwacht"})]})]}):f.jsx("div",{className:"text-center py-8 text-gray-500",children:"Geen voorspellingsdata beschikbaar"})})]})})})}):null}const ib={lat:52.1326,lon:5.2913};function vz({code:n,size:e=18}){return n===0?f.jsx(Yue,{size:e,className:"text-yellow-500"}):n>=1&&n<=3?f.jsx(hc,{size:e,className:"text-gray-400"}):n===45||n===48?f.jsx(uce,{size:e,className:"text-gray-400"}):n>=51&&n<=67||n>=80&&n<=82?f.jsx(UI,{size:e,className:"text-blue-500"}):n>=71&&n<=77||n>=85&&n<=86?f.jsx(xce,{size:e,className:"text-cyan-500"}):n>=95?f.jsx(dce,{size:e,className:"text-purple-500"}):f.jsx(hc,{size:e,className:"text-gray-400"})}function Gbe({degrees:n,size:e=14}){return f.jsx("div",{style:{transform:`rotate(${n+180}deg)`},className:"inline-flex",children:f.jsx(rx,{size:e,className:"text-blue-500"})})}function zbe({data:n}){if(!n||n.length===0)return null;const e=Math.max(...n.map(r=>r.precipitation),.5),t=n.some(r=>r.precipitation>0);return f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-[10px] text-gray-500",children:"Neerslag 2 uur"}),!t&&f.jsx("span",{className:"text-[10px] text-green-600 font-medium",children:"Droog"})]}),f.jsxs("div",{className:"relative h-8 bg-gray-100 rounded-lg overflow-hidden",children:[f.jsx("div",{className:"absolute inset-0 flex items-end px-0.5",children:n.map((r,i)=>{const s=r.precipitation/e*100,a=r.precipitation>2?"bg-blue-600":r.precipitation>.5?"bg-blue-500":r.precipitation>0?"bg-blue-400":"bg-transparent";return f.jsx("div",{className:"flex-1 mx-px",children:f.jsx("div",{className:`w-full rounded-t transition-all ${a}`,style:{height:`${Math.max(s,r.precipitation>0?8:0)}%`}})},i)})}),f.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-1 text-[8px] text-gray-400",children:[f.jsx("span",{children:"Nu"}),f.jsx("span",{children:"+1u"}),f.jsx("span",{children:"+2u"})]})]})]})}function Ube({pollen:n}){const e=[{name:"Gras",value:n.grass},{name:"Berk",value:n.birch},{name:"Els",value:n.alder},{name:"Bijvoet",value:n.mugwort}].filter(i=>i.value>0).sort((i,s)=>s.value-i.value);if(e.length===0)return f.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] text-green-600",children:[f.jsx(Q5,{size:12}),f.jsx("span",{children:"Lage pollenconcentratie"})]});const t=e[0],r=t.value>=4?"text-red-500":t.value>=3?"text-orange-500":t.value>=2?"text-amber-500":"text-green-600";return f.jsxs("div",{className:`flex items-center gap-1.5 text-[10px] ${r}`,children:[f.jsx(Q5,{size:12}),f.jsxs("span",{children:[t.name,": ",t.value>=4?"Zeer hoog":t.value>=3?"Hoog":t.value>=2?"Matig":"Laag"]})]})}function $be({hourly:n}){const e=n.slice(0,6);return e.length===0?null:f.jsxs("div",{className:"space-y-1",children:[f.jsx("div",{className:"text-[10px] text-gray-500",children:"Komende uren"}),f.jsx("div",{className:"flex gap-1",children:e.map((t,r)=>{const i=new Date(t.time),s=r===0;return f.jsxs("div",{className:`flex flex-col items-center p-1.5 rounded-lg flex-1 ${s?"bg-blue-100":"bg-gray-50"}`,children:[f.jsx("span",{className:"text-[9px] text-gray-500",children:s?"Nu":`${i.getHours()}u`}),f.jsx(vz,{code:t.weatherCode,size:14}),f.jsxs("span",{className:"text-[10px] font-medium",children:[Math.round(t.temperature),""]})]},t.time)})})]})}function Wbe(){const n=yn(g=>g.showWeatherButton),e=Wi(),t=z9(),[r,i]=H.useState(!1),[s,a]=H.useState(!1);if(H.useEffect(()=>{if(!n)return;const g=e.position||ib;(!t.weatherData||Date.now()-t.weatherData.lastUpdated>600*1e3)&&t.fetchWeather(g.lat,g.lon)},[n,e.position?.lat]),H.useEffect(()=>{if(!n)return;const g=setInterval(()=>{const m=e.position||ib;t.fetchWeather(m.lat,m.lon)},600*1e3);return()=>clearInterval(g)},[n,e.position?.lat]),!n)return null;const o=t.weatherData?.current,l=t.weatherData?.hourly||[],c=t.weatherData?.precipitation15min||[],h=t.weatherData?.pollen;return f.jsxs(f.Fragment,{children:[r&&f.jsx("div",{className:"fixed inset-0 z-[1099]",onClick:()=>i(!1)}),f.jsx(wt.div,{className:"fixed left-2 z-[1100] bg-white shadow-lg border border-gray-200 select-none rounded-xl",style:r?{top:"0.5rem",bottom:"0.5rem",width:"200px",overflowY:"auto"}:{top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))",width:"auto",maxWidth:"200px"},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},layout:!0,children:t.isLoading&&!o?f.jsxs("div",{className:"p-3 flex items-center gap-2",children:[f.jsx(Sue,{size:16,className:"animate-spin text-blue-500"}),f.jsx("span",{className:"text-sm text-gray-500",children:"Laden..."})]}):o?f.jsxs("div",{className:"p-2.5",children:[f.jsxs("button",{onClick:()=>i(!r),className:"w-full border-0 outline-none bg-transparent p-0",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(vz,{code:o.weatherCode,size:24}),f.jsx("div",{className:"flex flex-col leading-tight",children:f.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[Math.round(o.temperature),""]})})]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(tO,{size:14,className:"text-gray-400"}),f.jsx("span",{className:"text-sm text-gray-600",children:Math.round(o.windSpeed)}),f.jsx(Gbe,{degrees:o.windDirection,size:12})]}),f.jsx("div",{className:"ml-auto",children:r?f.jsx(zI,{size:16,className:"text-gray-400"}):f.jsx(nx,{size:16,className:"text-gray-400"})})]}),f.jsxs("div",{className:"text-[11px] text-gray-500 text-left mt-1",children:[oie[o.weatherCode]||"Onbekend",f.jsxs("span",{className:"text-gray-400 ml-1",children:[" ",Math.round(o.apparentTemperature),""]})]})]}),f.jsx(In,{children:r&&f.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:f.jsxs("div",{className:"pt-2 mt-2 border-t border-gray-200/50 space-y-3",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[f.jsx(Rce,{size:12,className:"text-blue-500"}),f.jsx("span",{children:"Vocht"})]}),f.jsxs("div",{className:"text-sm font-bold text-blue-600",children:[o.humidity,"%"]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[f.jsx(tO,{size:12,className:"text-gray-500"}),f.jsx("span",{children:"Windstoten"})]}),f.jsxs("div",{className:"text-sm font-bold text-gray-600",children:[Math.round(o.windGusts)," km/u"]})]}),f.jsxs("div",{className:"bg-cyan-50 rounded-lg p-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[f.jsx(rx,{size:12,className:"text-cyan-500"}),f.jsx("span",{children:"Wind"})]}),f.jsx("div",{className:"text-sm font-bold text-cyan-600",children:lie(o.windDirection)})]}),f.jsxs("div",{className:"bg-purple-50 rounded-lg p-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[f.jsx(hc,{size:12,className:"text-purple-500"}),f.jsx("span",{children:"Bewolking"})]}),f.jsxs("div",{className:"text-sm font-bold text-purple-600",children:[o.cloudCover,"%"]})]})]}),f.jsxs("button",{onClick:()=>a(!0),className:"w-full flex items-center gap-2 p-2 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors border-0 cursor-pointer",children:[f.jsx(UI,{size:16,className:"text-blue-500"}),f.jsx("span",{className:"text-sm text-blue-700 font-medium",children:"Buienradar"}),f.jsx("span",{className:"text-xs text-blue-500 ml-auto",children:"Live"}),f.jsx(_g,{size:14,className:"text-blue-400"})]}),c.length>0&&f.jsx(zbe,{data:c}),l.length>0&&f.jsx($be,{hourly:l}),h&&f.jsx(Ube,{pollen:h}),f.jsxs("div",{className:"text-[9px] text-gray-400 text-center pt-1",children:["Bijgewerkt: ",new Date(t.weatherData.lastUpdated).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})]})]})})})]}):f.jsxs("button",{onClick:()=>{const g=e.position||ib;t.fetchWeather(g.lat,g.lon)},className:"p-3 flex items-center gap-2 border-0 outline-none bg-transparent",children:[f.jsx(hc,{size:18,className:"text-gray-400"}),f.jsx("span",{className:"text-sm text-gray-500",children:"Weer laden"})]})}),f.jsx(Bbe,{isOpen:s,onClose:()=>a(!1)})]})}const SD={Munt:"#f59e0b",Aardewerk:"#a16207",Gesp:"#6b7280",Fibula:"#8b5cf6",Ring:"#ec4899",Speld:"#6366f1",Sieraad:"#f43f5e",Gereedschap:"#64748b",Wapen:"#ef4444",Anders:"#3b82f6"},Hbe={Munt:"M",Aardewerk:"A",Gesp:"G",Fibula:"F",Ring:"R",Speld:"S",Sieraad:"Si",Gereedschap:"Gr",Wapen:"W",Anders:"?"};function Kbe(){const n=pi(i=>i.map),e=hl(i=>i.vondsten),t=yn(i=>i.showLocalVondsten),r=H.useRef(null);return H.useEffect(()=>{if(!n)return;const i=new mc;return e.forEach(s=>{const a=new _r({geometry:new gi(kr([s.location.lng,s.location.lat])),vondst:s}),o=SD[s.objectType]||SD.Anders,l=Hbe[s.objectType]||"?";a.setStyle((c,h)=>{let y=12;h>50?y=6:h>10?y=Math.max(6,12-(h-10)/10):h<2&&(y=14);const _=Math.max(8,Math.min(12,y-2));return new pn({image:new Ws({radius:y,fill:new rr({color:o}),stroke:new Yn({color:"#ffffff",width:y>8?2:1})}),text:y>=8?new vo({text:l,font:`bold ${_}px sans-serif`,fill:new rr({color:"#ffffff"}),offsetY:1}):void 0})}),i.addFeature(a)}),r.current?r.current.setSource(i):(r.current=new Hu({source:i,zIndex:1e3,properties:{title:"Mijn Vondsten"}}),r.current.setVisible(t),n.addLayer(r.current)),()=>{r.current&&n&&(n.removeLayer(r.current),r.current=null)}},[n,e]),H.useEffect(()=>{r.current&&r.current.setVisible(t)},[t]),null}const Xbe={Mineraal:"M",Fossiel:"F",Erfgoed:"E",Monument:"Mo",Overig:""};function qbe(n){const{type:e,coordinates:t}=n,r=s=>typeof s[0]=="number"?kr(s):s.map(r),i=r(t);switch(e){case"Point":return new gi(i);case"LineString":return new bi(i);case"Polygon":return new Ha(i);case"MultiPoint":return new Nd(i);case"MultiLineString":return new ic(i);case"MultiPolygon":return new ld(i);default:return new gi(kr(t))}}function Ybe(){const n=pi(i=>i.map),e=fs(i=>i.layers),t=yn(i=>i.showCustomPointLayers),r=H.useRef(new Map);return H.useEffect(()=>{if(!n)return;const i=new Set(e.map(s=>s.id));return r.current.forEach((s,a)=>{i.has(a)||(n.removeLayer(s),r.current.delete(a))}),e.forEach(s=>{const a=new mc;s.points.forEach(l=>{let c;const h=l.geometry&&l.geometry.type!=="Point";l.geometry?c=qbe(l.geometry):c=new gi(kr(l.coordinates));const g=new _r({geometry:c,layerType:"customPoint",customPoint:l,customLayerId:s.id,customLayerName:s.name,customLayerColor:s.color}),m=Xbe[l.category]||l.category.charAt(0).toUpperCase();if(h){const x=l.geometry.type;g.setStyle(()=>x==="Polygon"||x==="MultiPolygon"?new pn({fill:new rr({color:s.color+"40"}),stroke:new Yn({color:s.color,width:2})}):x==="LineString"||x==="MultiLineString"?new pn({stroke:new Yn({color:s.color,width:3})}):new pn({image:new Ws({radius:8,fill:new rr({color:s.color}),stroke:new Yn({color:"#ffffff",width:2})})}))}else g.setStyle((x,y)=>{let b=12;y>50?b=6:y>10?b=Math.max(6,12-(y-10)/10):y<2&&(b=14);const R=Math.max(8,Math.min(12,b-2));return new pn({image:new Ws({radius:b,fill:new rr({color:s.color}),stroke:new Yn({color:"#ffffff",width:b>8?2:1})}),text:b>=8?new vo({text:m,font:`bold ${R}px sans-serif`,fill:new rr({color:"#ffffff"}),offsetY:1}):void 0})});a.addFeature(g)});const o=r.current.get(s.id);if(o)o.setSource(a),o.setVisible(t&&s.visible);else{const l=new Hu({source:a,zIndex:950,properties:{title:s.name,customPointLayerId:s.id},visible:t&&s.visible});n.addLayer(l),r.current.set(s.id,l)}}),()=>{r.current.forEach(s=>{n&&n.removeLayer(s)}),r.current.clear()}},[n,e,t]),null}function Zbe(){const{createLayerModalOpen:n,closeCreateLayerModal:e}=wr(),{addLayer:t}=fs(),r=yn(),[i,s]=H.useState(""),[a,o]=H.useState([...iu]),[l,c]=H.useState(""),h=14*r.fontScale/100,g=()=>{const w=l.trim();w&&!a.includes(w)&&(o([...a,w]),c(""))},m=w=>{o(a.filter(T=>T!==w))},x=w=>{a.includes(w)?o(a.filter(T=>T!==w)):o([...a,w])},y=()=>{i.trim()&&(t(i.trim(),a),s(""),o([...iu]),c(""),e())},_=()=>{s(""),o([...iu]),c(""),e()};return f.jsx(In,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:_}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(za,{size:18}),f.jsx("span",{className:"font-medium",children:"Nieuwe laag"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:r.fontScale,onChange:w=>r.setFontScale(parseInt(w.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${r.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:_,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(Xr,{size:18})})]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{fontSize:`${h}px`},children:[f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam van de laag"}),f.jsx("input",{type:"text",value:i,onChange:w=>s(w.target.value),placeholder:"bijv. Vakantie Frankrijk 2026",className:"w-full px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Categorien"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:iu.map(w=>f.jsx("button",{onClick:()=>x(w),className:`px-3 py-1 rounded-full transition-colors border-0 outline-none ${a.includes(w)?"bg-orange-500 text-white":"bg-white text-gray-600 hover:bg-blue-50"}`,style:{fontSize:"0.9em"},children:w},w))})]}),a.filter(w=>!iu.includes(w)).length>0&&f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Eigen categorien"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:a.filter(w=>!iu.includes(w)).map(w=>f.jsxs("div",{className:"flex items-center",children:[f.jsx("button",{onClick:()=>x(w),className:"px-3 py-1 rounded-l-full bg-orange-500 text-white hover:bg-orange-600 transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:w}),f.jsx("button",{onClick:()=>m(w),className:"px-2 py-1 rounded-r-full bg-orange-600 text-white hover:bg-orange-700 transition-colors border-0 outline-none",title:"Verwijder categorie",children:f.jsx(_c,{size:12})})]},w))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Eigen categorie toevoegen"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",value:l,onChange:w=>c(w.target.value),placeholder:"bijv. Grot, Bron, ...",className:"flex-1 px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},onKeyDown:w=>w.key==="Enter"&&g()}),f.jsx("button",{onClick:g,disabled:!l.trim(),className:"px-3 py-2 bg-white hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors border-0 outline-none text-gray-600",children:f.jsx(Xa,{size:20})})]})]})]}),f.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${h}px`},children:[f.jsx("button",{onClick:_,className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),f.jsx("button",{onClick:y,disabled:!i.trim(),className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Aanmaken"})]})]})]})})}const wz=200,Jbe=.7;async function Qbe(n,e=wz){return new Promise((t,r)=>{const i=new Image,s=document.createElement("canvas"),a=s.getContext("2d");i.onload=()=>{let o=i.width,l=i.height;o>l?o>e&&(l=Math.round(l*e/o),o=e):l>e&&(o=Math.round(o*e/l),l=e),s.width=o,s.height=l,a?.drawImage(i,0,0,o,l),s.toBlob(c=>{c?t(c):r(new Error("Failed to create blob from canvas"))},"image/jpeg",Jbe)},i.onerror=()=>r(new Error("Failed to load image")),i.src=URL.createObjectURL(n)})}function eRe(n){return new Promise((e,t)=>{const r=new FileReader;r.onloadend=()=>{typeof r.result=="string"?e(r.result):t(new Error("Failed to convert blob to base64"))},r.onerror=()=>t(new Error("Failed to read blob")),r.readAsDataURL(n)})}async function tRe(n){const e=await Qbe(n,wz),t=await eRe(e);return{thumbnailBlob:e,thumbnailBase64:t}}function nRe(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const sb=5;function rRe({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:r}){const i=H.useRef(null),s=H.useRef(null),a=async l=>{const c=l.target.files;if(!c||c.length===0)return;const h=sb-n.length,g=Array.from(c).slice(0,h);for(const m of g)try{const{thumbnailBase64:x}=await tRe(m),y={id:nRe(),thumbnailBase64:x,createdAt:new Date().toISOString(),pendingUpload:!0};e(y)}catch(x){console.error("Failed to process image:",x)}l.target.value=""},o=n.length<sb;return f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",sb,")"]}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(l=>f.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[f.jsx("img",{src:l.thumbnailUrl||l.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!r&&f.jsx("button",{type:"button",onClick:()=>t(l.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:f.jsx(Xr,{size:12,className:"text-white"})}),l.pendingUpload&&f.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-orange-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Wacht..."})]},l.id)),o&&!r&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[f.jsx(OE,{size:20,className:"text-gray-400"}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),f.jsxs("button",{type:"button",onClick:()=>i.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[f.jsx(Xce,{size:20,className:"text-gray-400"}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),f.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:a,className:"hidden"}),f.jsx("input",{ref:i,type:"file",accept:"image/*",multiple:!0,onChange:a,className:"hidden"})]})}function iRe(){const{addPointModalOpen:n,addPointModalLayerId:e,addPointModalLocation:t,closeAddPointModal:r}=wr(),{addPoint:i,getLayer:s}=fs(),a=yn(),[o,l]=H.useState(""),[c,h]=H.useState(""),[g,m]=H.useState(""),[x,y]=H.useState([]),_=e?s(e):null,w=14*a.fontScale/100,T=()=>{!o.trim()||!e||!t||(i(e,{name:o.trim(),category:"Overig",notes:c.trim(),url:g.trim()||void 0,coordinates:[t.lng,t.lat],photos:x.length>0?x:void 0}),l(""),h(""),m(""),y([]),r())},b=()=>{l(""),h(""),m(""),y([]),r()};return _?f.jsx(In,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(As,{size:18}),f.jsx("span",{className:"font-medium",children:"Punt toevoegen"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:a.fontScale,onChange:R=>a.setFontScale(parseInt(R.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:b,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(Xr,{size:18})})]})]}),f.jsx("div",{className:"px-4 py-1.5",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:_.color}}),f.jsx("span",{className:"text-sm text-gray-600",children:_.name})]})}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{fontSize:`${w}px`},children:[f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam *"}),f.jsx("input",{type:"text",value:o,onChange:R=>l(R.target.value),className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),f.jsx(rRe,{photos:x,onAddPhoto:R=>y([...x,R]),onRemovePhoto:R=>y(x.filter(M=>M.id!==R))}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Notities"}),f.jsx("textarea",{value:c,onChange:R=>h(R.target.value),placeholder:"Beschrijving, tips, opmerkingen...",rows:2,className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors resize-none",style:{fontSize:"1em"}})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Link"}),f.jsx("input",{type:"url",value:g,onChange:R=>m(R.target.value),placeholder:"https://...",className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"}})]})]}),f.jsxs("div",{className:"p-3 flex gap-3",style:{fontSize:`${w}px`},children:[f.jsx("button",{onClick:b,className:"flex-1 px-4 py-1.5 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),f.jsx("button",{onClick:T,disabled:!o.trim(),className:"flex-1 px-4 py-1.5 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Toevoegen"})]})]})]})}):null}function sRe(){const{layerManagerModalOpen:n,closeLayerManagerModal:e,openCreateLayerModal:t,openLayerDashboard:r}=wr(),{layers:i,removeLayer:s,toggleVisibility:a,toggleArchived:o,exportLayerAsGeoJSON:l,importLayerFromGeoJSON:c}=fs(),h=yn(),g=14*h.fontScale/100,[m,x]=H.useState(null),[y,_]=H.useState(null),[w,T]=H.useState(null),[b,R]=H.useState(!1),M=i.filter(F=>!F.archived),D=i.filter(F=>F.archived),B=b?D:M,k=F=>{y===F?(s(F),_(null)):(_(F),setTimeout(()=>_(null),3e3))},A=F=>{l(F)},C=async F=>{const xe=F.target.files?.[0];if(xe){try{const Ce=await xe.text(),Ge=c(Ce);Ge.success||(T(Ge.error||"Import mislukt"),setTimeout(()=>T(null),3e3))}catch{T("Kon bestand niet lezen"),setTimeout(()=>T(null),3e3)}F.target.value=""}},O=()=>{x(null),_(null),T(null),R(!1),e()},P=F=>{r(F)},z=()=>{O(),t()};return f.jsx(In,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:O}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(za,{size:18}),f.jsx("span",{className:"font-medium",children:"Mijn Lagen beheren"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:h.fontScale,onChange:F=>h.setFontScale(parseInt(F.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${h.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:O,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(Xr,{size:18})})]})]}),f.jsxs("div",{className:"flex border-b border-gray-100",children:[f.jsxs("button",{onClick:()=>R(!1),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${b?"text-gray-500 hover:text-gray-700 hover:bg-gray-50":"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50"}`,children:["Actief (",M.length,")"]}),f.jsxs("button",{onClick:()=>R(!0),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none flex items-center justify-center gap-1 ${b?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[f.jsx(_V,{size:14}),"Archief (",D.length,")"]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${g}px`},children:[B.length===0?f.jsx("div",{className:"p-8 text-center text-gray-500",children:b?f.jsx("p",{style:{fontSize:"1em"},children:"Geen gearchiveerde lagen."}):f.jsxs(f.Fragment,{children:[f.jsx("p",{className:"mb-4",style:{fontSize:"1em"},children:"Je hebt nog geen eigen lagen."}),f.jsxs("button",{onClick:z,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:[f.jsx(Xa,{size:16,className:"inline mr-2"}),"Nieuwe laag aanmaken"]})]})}):f.jsx("div",{className:"divide-y divide-gray-100",children:B.map(F=>f.jsx(oRe,{layer:F,isExpanded:m===F.id,onToggleExpand:()=>x(m===F.id?null:F.id),onToggleVisibility:()=>a(F.id),onToggleArchived:()=>o(F.id),onOpenDashboard:()=>P(F.id),onExport:()=>A(F.id),onDelete:()=>k(F.id),confirmDelete:y===F.id,onRename:xe=>fs.getState().updateLayer(F.id,{name:xe}),onChangeColor:xe=>fs.getState().updateLayer(F.id,{color:xe})},F.id))}),w&&f.jsx("div",{className:"mx-4 my-2 p-3 bg-red-50 text-red-700 text-sm rounded-lg",children:w})]}),f.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${g}px`},children:[f.jsxs("label",{className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors cursor-pointer flex items-center justify-center gap-2 border-0 outline-none text-gray-600",children:[f.jsx(ix,{size:16}),f.jsx("span",{style:{fontSize:"1em"},children:"Importeren"}),f.jsx("input",{type:"file",accept:".geojson,.json",onChange:C,className:"hidden"})]}),f.jsxs("button",{onClick:z,className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",style:{fontSize:"1em"},children:[f.jsx(Xa,{size:16}),f.jsx("span",{children:"Nieuwe laag"})]})]})]})]})})}const aRe=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"];function oRe({layer:n,isExpanded:e,onToggleExpand:t,onToggleVisibility:r,onToggleArchived:i,onOpenDashboard:s,onExport:a,onDelete:o,confirmDelete:l,onRename:c,onChangeColor:h}){const[g,m]=H.useState(!1),[x,y]=H.useState(n.name),[_,w]=H.useState(!1),T=H.useRef(null);H.useEffect(()=>{g&&T.current&&(T.current.focus(),T.current.select())},[g]);const b=()=>{y(n.name),m(!0)},R=()=>{const A=x.trim();A&&A!==n.name&&c(A),m(!1)},M=()=>{y(n.name),m(!1)},D=A=>{A.key==="Enter"?R():A.key==="Escape"&&M()},B=n.points.filter(A=>A.status==="completed").length,k=n.points.length;return f.jsxs("div",{className:"bg-white",children:[f.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[f.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors border-0 outline-none bg-transparent",children:e?f.jsx(nx,{size:16}):f.jsx(_g,{size:16})}),f.jsxs("div",{className:"relative",children:[f.jsx("button",{onClick:()=>w(!_),className:"w-5 h-5 rounded-full flex-shrink-0 border-2 border-white shadow-sm hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),_&&f.jsx("div",{className:"absolute top-7 left-0 z-50 bg-white rounded-lg shadow-lg p-2 flex flex-wrap gap-1 w-24",children:aRe.map(A=>f.jsx("button",{onClick:()=>{h(A),w(!1)},className:`w-5 h-5 rounded-full border-2 hover:scale-110 transition-transform ${A===n.color?"border-gray-800":"border-white"}`,style:{backgroundColor:A}},A))})]}),g?f.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[f.jsx("input",{ref:T,type:"text",value:x,onChange:A=>y(A.target.value),onKeyDown:D,onBlur:R,className:"flex-1 px-2 py-1 text-gray-800 font-medium bg-orange-50 rounded outline-none focus:ring-2 focus:ring-orange-400"}),f.jsx("button",{onClick:R,className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Opslaan",children:f.jsx(uc,{size:16})})]}):f.jsxs("button",{onClick:s,className:"flex-1 min-w-0 text-left border-0 outline-none bg-transparent hover:bg-orange-50 rounded px-2 py-1 -ml-2 transition-colors",title:"Bekijk dashboard",children:[f.jsx("div",{className:"font-medium text-gray-800 truncate hover:text-orange-600",children:n.name}),f.jsx("div",{className:"text-xs text-gray-500",children:k>0?f.jsxs("span",{className:B===k?"text-green-600":"",children:[B,"/",k," voltooid"]}):"Geen punten"})]}),!g&&f.jsx("button",{onClick:b,className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam bewerken",children:f.jsx(ig,{size:16})}),f.jsx("button",{onClick:s,className:"p-2 text-orange-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Open dashboard",children:f.jsx(TV,{size:18})}),!n.archived&&f.jsx("button",{onClick:r,className:`p-2 rounded transition-colors border-0 outline-none ${n.visible?"text-blue-500 hover:bg-blue-50":"text-gray-400 hover:bg-gray-100"}`,title:n.visible?"Verbergen":"Tonen",children:n.visible?f.jsx($v,{size:18}):f.jsx(Uv,{size:18})}),f.jsx("button",{onClick:i,className:`p-2 rounded transition-colors border-0 outline-none ${n.archived?"text-green-500 hover:text-green-600 hover:bg-green-50":"text-gray-400 hover:text-amber-600 hover:bg-amber-50"}`,title:n.archived?"Herstellen":"Archiveren",children:n.archived?f.jsx(Ule,{size:18}):f.jsx(_V,{size:18})}),f.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteren als GeoJSON",children:f.jsx(zv,{size:18})}),f.jsx("button",{onClick:o,className:`p-2 rounded transition-colors border-0 outline-none ${l?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:l?"Klik nogmaals om te verwijderen":"Verwijderen",children:f.jsx(_c,{size:18})})]}),f.jsx(In,{children:e&&f.jsx(wt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:f.jsxs("div",{className:"px-4 pb-3 pl-12 space-y-2",children:[n.categories.length>0&&f.jsx("div",{className:"flex flex-wrap gap-1",children:n.categories.map(A=>f.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:A},A))}),n.points.length>0&&f.jsxs("div",{className:"text-xs text-gray-500 space-y-1 max-h-32 overflow-y-auto",children:[n.points.slice(0,5).map(A=>f.jsx("div",{className:"flex items-center gap-2",children:f.jsx("span",{className:`font-medium ${A.status==="completed"?"text-green-600 line-through":A.status==="skipped"?"text-gray-400 line-through":"text-gray-700"}`,children:A.name})},A.id)),n.points.length>5&&f.jsxs("div",{className:"text-gray-400",children:["...en ",n.points.length-5," meer"]})]}),f.jsxs("div",{className:"text-xs text-gray-400",children:["Aangemaakt: ",new Date(n.createdAt).toLocaleDateString("nl-NL")]})]})})})]})}function lRe(){const{layerDashboardOpen:n,layerDashboardLayerId:e,closeLayerDashboard:t}=wr(),{getLayer:r,setPointStatus:i,updatePoint:s,removePoint:a}=fs(),o=yn(),[l,c]=H.useState("all"),[h,g]=H.useState(null),[m,x]=H.useState(""),[y,_]=H.useState(null),w=e?r(e):null,T=14*o.fontScale/100;if(!w)return null;const b=w.points.filter(P=>l==="all"?!0:P.status===l),R=w.points.length,M=w.points.filter(P=>P.status==="completed").length,D=w.points.filter(P=>P.status==="todo").length,B=w.points.filter(P=>P.status==="skipped").length,k=(P,z)=>{i(w.id,P,z)},A=P=>{s(w.id,P,{notes:m}),g(null),x("")},C=P=>{y===P?(a(w.id,P),_(null)):(_(P),setTimeout(()=>_(null),3e3))},O=()=>{g(null),_(null),t()};return f.jsx(In,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(wt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:O}),f.jsxs(wt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/50",style:{backgroundColor:w.color}}),f.jsx("span",{className:"font-medium truncate",children:w.name})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:o.fontScale,onChange:P=>o.setFontScale(parseInt(P.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:O,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(Xr,{size:18})})]})]}),f.jsxs("div",{className:"px-4 py-2 bg-orange-50 flex items-center justify-between text-sm",children:[f.jsxs("span",{className:"text-orange-800 font-medium",children:[M,"/",R," voltooid"]}),f.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[f.jsxs("span",{className:"text-orange-600",children:[D," te doen"]}),B>0&&f.jsxs("span",{className:"text-gray-500",children:[B," overgeslagen"]})]})]}),f.jsx("div",{className:"flex border-b border-gray-100",children:["all","todo","completed","skipped"].map(P=>f.jsxs("button",{onClick:()=>c(P),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${l===P?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[P==="all"&&"Alles",P==="todo"&&"Te doen",P==="completed"&&"Voltooid",P==="skipped"&&"Overgeslagen"]},P))}),f.jsx("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${T}px`},children:b.length===0?f.jsx("div",{className:"p-8 text-center text-gray-500",children:f.jsx("p",{children:"Geen punten gevonden"})}):f.jsx("div",{className:"divide-y divide-gray-100",children:b.map(P=>f.jsx("div",{className:"p-3",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsxs("div",{className:"flex flex-col gap-1 pt-0.5",children:[f.jsx("button",{onClick:()=>k(P.id,P.status==="completed"?"todo":"completed"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${P.status==="completed"?"bg-green-100 hover:bg-green-200":"bg-gray-100 hover:bg-green-100"}`,title:P.status==="completed"?"Markeer als te doen":"Markeer als voltooid",children:f.jsx(uc,{size:14,className:P.status==="completed"?"text-green-600":"text-gray-400"})}),f.jsx("button",{onClick:()=>k(P.id,P.status==="skipped"?"todo":"skipped"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${P.status==="skipped"?"bg-gray-200 hover:bg-gray-300":"bg-gray-100 hover:bg-gray-200"}`,title:P.status==="skipped"?"Markeer als te doen":"Overslaan",children:f.jsx(Hle,{size:14,className:P.status==="skipped"?"text-gray-600":"text-gray-400"})})]}),P.photos&&P.photos.length>0&&f.jsxs("div",{className:"relative flex-shrink-0",children:[f.jsx("img",{src:P.photos[0].thumbnailUrl||P.photos[0].thumbnailBase64,alt:"Foto",className:"w-12 h-12 object-cover rounded border border-gray-200"}),P.photos.length>1&&f.jsxs("span",{className:"absolute -bottom-1 -right-1 bg-orange-500 text-white text-[9px] px-1 rounded-full",children:["+",P.photos.length-1]})]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:`font-medium truncate ${P.status==="completed"?"text-green-700 line-through":P.status==="skipped"?"text-gray-400 line-through":"text-gray-800"}`,children:P.name}),P.sourceLayer&&f.jsxs("span",{className:"text-xs text-gray-400 truncate",children:["via ",P.sourceLayer]})]}),h===P.id?f.jsxs("div",{className:"mt-2",children:[f.jsx("textarea",{value:m,onChange:z=>x(z.target.value),placeholder:"Notities...",rows:2,className:"w-full px-2 py-1 bg-white rounded border-0 outline-none hover:bg-blue-50 transition-colors resize-none text-sm",autoFocus:!0}),f.jsxs("div",{className:"flex gap-2 mt-1",children:[f.jsx("button",{onClick:()=>A(P.id),className:"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 border-0 outline-none",children:"Opslaan"}),f.jsx("button",{onClick:()=>{g(null),x("")},className:"px-2 py-1 text-xs bg-white text-gray-600 rounded hover:bg-blue-50 border-0 outline-none",children:"Annuleren"})]})]}):P.notes?f.jsx("p",{className:"text-sm text-gray-600 mt-1",children:P.notes}):null,P.url&&f.jsxs("a",{href:P.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-500 hover:text-blue-700 mt-1",children:[f.jsx(Iu,{size:12}),"Link"]})]}),f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("button",{onClick:()=>{g(P.id),x(P.notes)},className:"w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded border-0 outline-none",title:"Notities bewerken",children:f.jsx(mue,{size:14})}),f.jsx("button",{onClick:()=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${P.coordinates[1]},${P.coordinates[0]}`,"_blank")},className:"w-6 h-6 flex items-center justify-center text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded border-0 outline-none",title:"Navigeer naar",children:f.jsx(As,{size:14})}),f.jsx("button",{onClick:()=>C(P.id),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none ${y===P.id?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:y===P.id?"Klik nogmaals":"Verwijderen",children:f.jsx(_c,{size:14})})]})]})},P.id))})})]})]})})}class TD{buffer=[];size;weights;constructor(e=8){this.size=e,this.weights=Array.from({length:e},(r,i)=>Math.pow(2,i));const t=this.weights.reduce((r,i)=>r+i,0);this.weights=this.weights.map(r=>r/t)}add(e){if(this.buffer.length>0){const t=this.buffer[this.buffer.length-1];let r=e-t;r>180&&(e-=360),r<-180&&(e+=360)}this.buffer.push(e),this.buffer.length>this.size&&this.buffer.shift()}getSmoothed(){if(this.buffer.length===0)return null;if(this.buffer.length===1)return this.normalizeHeading(this.buffer[0]);let e=0,t=0;const r=this.size-this.buffer.length;for(let i=0;i<this.buffer.length;i++){const s=this.weights[r+i];e+=this.buffer[i]*s,t+=s}return this.normalizeHeading(e/t)}normalizeHeading(e){return(e%360+360)%360}clear(){this.buffer=[]}}function cRe(){const n=Wi(c=>c.tracking),e=Wi(c=>c.headingSource);Wi(c=>c.speed);const t=Wi(c=>c.setSmoothedHeading),r=H.useRef(new TD(6)),i=H.useRef(new TD(10)),s=H.useRef(0),a=H.useRef(null),o=33,l=H.useCallback((c,h)=>{const g=performance.now();if(g-s.current<o)return;const m=h==="gps"?r.current:i.current;m.add(c);const x=m.getSmoothed();x!==null&&(s.current=g,t(x))},[t]);H.useEffect(()=>{if(!n)return;const c=g=>{g.coords.heading!==null&&g.coords.speed!==null&&g.coords.speed>.8&&g.coords.accuracy<20&&l(g.coords.heading,"gps")},h=navigator.geolocation.watchPosition(c,()=>{},{enableHighAccuracy:!0,maximumAge:500,timeout:1e4});return()=>navigator.geolocation.clearWatch(h)},[n,l]),H.useEffect(()=>{if(!n||e!=="compass")return;let c=0;const h=50,g=x=>{const y=performance.now();if(!(y-c<h)&&(c=y,x.alpha!==null)){const _=(360-x.alpha)%360;l(_,"compass")}},m=x=>{const y=performance.now();y-c<h||(c=y,x.webkitCompassHeading!==void 0&&l(x.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",g),window.addEventListener("deviceorientation",m),()=>{window.removeEventListener("deviceorientationabsolute",g),window.removeEventListener("deviceorientation",m)}},[n,e,l]),H.useEffect(()=>{n||(r.current.clear(),i.current.clear())},[n]),H.useEffect(()=>()=>{a.current&&cancelAnimationFrame(a.current)},[])}function uRe(){const n=pi(i=>i.map),e=Ri(i=>i.setLayerOpacity),t=Ri(i=>i.visible),r=H.useRef(null);H.useEffect(()=>{if(!n)return;const i=()=>{const s=n.getView().getZoom();if(!s||r.current!==null&&Math.abs(s-r.current)<.5)return;r.current=s;const a=t["AHN 0.5m"],o=t["AHN4 Multi-Hillshade NL"];!a&&!o||(a&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),o&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return n.on("moveend",i),i(),()=>{n.un("moveend",i)}},[n,t,e])}const bD=2e3;function hRe(){const n=AE(m=>m.user),{layers:e,clearAll:t}=fs(),{vondsten:r,clearAll:i}=hl(),s=H.useRef(null),a=H.useRef(!0),o=H.useRef(""),l=H.useRef(""),c=H.useCallback(async m=>{if(n)try{const x=E0(pu,"users",n.uid);await b3(x,{layers:m,layersUpdatedAt:R3()},{merge:!0}),console.log(" Lagen gesynchroniseerd naar cloud")}catch(x){console.error(" Fout bij synchroniseren lagen:",x)}},[n]),h=H.useCallback(async m=>{if(n)try{const x=E0(pu,"users",n.uid);await b3(x,{vondsten:m,vondstenUpdatedAt:R3()},{merge:!0}),console.log(" Vondsten gesynchroniseerd naar cloud")}catch(x){console.error(" Fout bij synchroniseren vondsten:",x)}},[n]),g=H.useCallback(async()=>{if(n)try{const m=E0(pu,"users",n.uid),x=await yre(m);if(x.exists()){const y=x.data();if(y.layers&&Array.isArray(y.layers)){const _=y.layers,w=fs.getState().layers,T=[..._],b=new Set(_.map(R=>R.id));w.forEach(R=>{b.has(R.id)||T.push(R)}),fs.setState({layers:T}),o.current=JSON.stringify(T),console.log(` ${_.length} lagen geladen uit cloud`)}if(y.vondsten&&Array.isArray(y.vondsten)){const _=y.vondsten,w=hl.getState().vondsten,T=[..._],b=new Set(_.map(R=>R.id));w.forEach(R=>{b.has(R.id)||T.push(R)}),hl.setState({vondsten:T}),l.current=JSON.stringify(T),console.log(` ${_.length} vondsten geladen uit cloud`)}}else console.log(" Geen cloud data gevonden, lokale data wordt gesynchroniseerd..."),await c(e),await h(r);a.current=!1}catch(m){console.error(" Fout bij laden uit cloud:",m),a.current=!1}},[n,e,r,c,h]);return H.useEffect(()=>{n?(a.current=!0,g()):(a.current=!0,o.current="",l.current="")},[n?.uid]),H.useEffect(()=>{if(!n||a.current)return;const m=JSON.stringify(e);if(m!==o.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{o.current=m,c(e)},bD),()=>{s.current&&clearTimeout(s.current)}},[n,e,c]),H.useEffect(()=>{if(!n||a.current)return;const m=JSON.stringify(r);if(m!==l.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{l.current=m,h(r)},bD),()=>{s.current&&clearTimeout(s.current)}},[n,r,h]),{isLoggedIn:!!n,syncLayersToCloud:c,syncVondstenToCloud:h}}function dRe(){cRe(),uRe(),hRe();const e=14*yn(o=>o.fontScale)/100,t=wr(o=>o.vondstFormOpen),r=wr(o=>o.vondstFormLocation),i=wr(o=>o.closeVondstForm),s=wr(o=>o.routeDashboardOpen),a=wr(o=>o.toggleRouteDashboard);return f.jsx(KTe,{children:f.jsxs("div",{style:{fontSize:`${e}px`},children:[f.jsx(uie,{}),f.jsx(Rhe,{}),f.jsx(Kbe,{}),f.jsx(QTe,{}),f.jsx(Ybe,{}),f.jsx(kbe,{}),f.jsx(Ibe,{}),f.jsx(Cbe,{}),f.jsx(Nbe,{}),f.jsx(CTe,{}),f.jsx(NTe,{}),f.jsx($Te,{}),f.jsx(The,{}),f.jsx(bbe,{}),f.jsx(Rbe,{}),f.jsx(WTe,{}),f.jsx(khe,{}),f.jsx(Mhe,{}),f.jsx(UTe,{}),f.jsx(pbe,{}),f.jsx(VTe,{}),f.jsx(ybe,{}),f.jsx(BTe,{}),f.jsx(Wbe,{}),f.jsx(dbe,{}),f.jsx(Zbe,{}),f.jsx(iRe,{}),f.jsx(sRe,{}),f.jsx(lRe,{}),f.jsx(Vbe,{isOpen:s,onClose:a}),f.jsx(In,{children:t&&f.jsx(_z,{onClose:i,initialLocation:r||void 0})})]})})}console.log(`%c DetectorApp v${_w}`,"background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");jU.createRoot(document.getElementById("root")).render(f.jsx(dRe,{}));export{LK as A,wX as B,vr as C,_r as F,oC as G,yX as I,Dn as L,kt as N,BK as P,pn as S,Rh as T,_s as U,mc as V,pRe as W,Kf as X,QX as a,WX as b,Hu as c,Yn as d,Jt as e,gi as f,Lp as g,I1 as h,rr as i,vo as j,kr as k,bi as l,Ws as m,Yj as n,bn as p,LB as r,$A as u};
//# sourceMappingURL=index-Coaq9BTF.js.map
