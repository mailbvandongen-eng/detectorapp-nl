const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/romeinseFortenOL-DrdchQD0.js","assets/iconStyles-DOxnu6V_.js","assets/amkOL-CFD3kxY6.js","assets/layerLoaderOL-cS7H_ni8.js","assets/romeinsOL-5B5yGtr9.js","assets/kastelenOL-Dpw5W01-.js","assets/ruinesOL-BMoj8SfQ.js","assets/hunebeddenOL-DWH1N7k-.js","assets/uikavArcheoPuntenOL-DR8yk9XX.js","assets/uikavVlakkenOL-BtWVZezA.js","assets/uikavBufferlaagOL-xbShml2_.js","assets/uikavExpertOL-BbbD8_co.js","assets/uikavUiterwaardenOL-BtYuVBPo.js","assets/speeltuinenOL-DGOBr8-V.js","assets/museaOL-DEOhucJl.js","assets/strandjesOL-B-57zgVT.js","assets/parkenOL-GBSxaBrQ.js","assets/kringloopwinkelsOL-Dxc5IckD.js","assets/fossielenOL-DqQ0Dbrl.js","assets/fossielUtils-H_GaxjfC.js","assets/fossielenBelgieOL-BahvRq6Y.js","assets/fossielenDuitslandOL-CE2tK-9Q.js","assets/fossielenFrankrijkOL-DY0qrXKx.js","assets/bunkersOL-DLhUI2-H.js","assets/grafheuvelsOL-B-PNVwX4.js","assets/slagveldenOL-B1aoIAfd.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function BR(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var nS={exports:{}},tm={},rS={exports:{}},dn={};var C4;function tU(){if(C4)return dn;C4=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function m(ie){return ie===null||typeof ie!="object"?null:(ie=g&&ie[g]||ie["@@iterator"],typeof ie=="function"?ie:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,_={};function E(ie,V,Z){this.props=ie,this.context=V,this.refs=_,this.updater=Z||y}E.prototype.isReactComponent={},E.prototype.setState=function(ie,V){if(typeof ie!="object"&&typeof ie!="function"&&ie!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ie,V,"setState")},E.prototype.forceUpdate=function(ie){this.updater.enqueueForceUpdate(this,ie,"forceUpdate")};function T(){}T.prototype=E.prototype;function b(ie,V,Z){this.props=ie,this.context=V,this.refs=_,this.updater=Z||y}var R=b.prototype=new T;R.constructor=b,v(R,E.prototype),R.isPureReactComponent=!0;var N=Array.isArray,D=Object.prototype.hasOwnProperty,W={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function A(ie,V,Z){var te,se={},he=null,Ae=null;if(V!=null)for(te in V.ref!==void 0&&(Ae=V.ref),V.key!==void 0&&(he=""+V.key),V)D.call(V,te)&&!I.hasOwnProperty(te)&&(se[te]=V[te]);var Fe=arguments.length-2;if(Fe===1)se.children=Z;else if(1<Fe){for(var de=Array(Fe),Pe=0;Pe<Fe;Pe++)de[Pe]=arguments[Pe+2];se.children=de}if(ie&&ie.defaultProps)for(te in Fe=ie.defaultProps,Fe)se[te]===void 0&&(se[te]=Fe[te]);return{$$typeof:n,type:ie,key:he,ref:Ae,props:se,_owner:W.current}}function M(ie,V){return{$$typeof:n,type:ie.type,key:V,ref:ie.ref,props:ie.props,_owner:ie._owner}}function O(ie){return typeof ie=="object"&&ie!==null&&ie.$$typeof===n}function L(ie){var V={"=":"=0",":":"=2"};return"$"+ie.replace(/[=:]/g,function(Z){return V[Z]})}var z=/\/+/g;function j(ie,V){return typeof ie=="object"&&ie!==null&&ie.key!=null?L(""+ie.key):V.toString(36)}function Ee(ie,V,Z,te,se){var he=typeof ie;(he==="undefined"||he==="boolean")&&(ie=null);var Ae=!1;if(ie===null)Ae=!0;else switch(he){case"string":case"number":Ae=!0;break;case"object":switch(ie.$$typeof){case n:case e:Ae=!0}}if(Ae)return Ae=ie,se=se(Ae),ie=te===""?"."+j(Ae,0):te,N(se)?(Z="",ie!=null&&(Z=ie.replace(z,"$&/")+"/"),Ee(se,V,Z,"",function(Pe){return Pe})):se!=null&&(O(se)&&(se=M(se,Z+(!se.key||Ae&&Ae.key===se.key?"":(""+se.key).replace(z,"$&/")+"/")+ie)),V.push(se)),1;if(Ae=0,te=te===""?".":te+":",N(ie))for(var Fe=0;Fe<ie.length;Fe++){he=ie[Fe];var de=te+j(he,Fe);Ae+=Ee(he,V,Z,de,se)}else if(de=m(ie),typeof de=="function")for(ie=de.call(ie),Fe=0;!(he=ie.next()).done;)he=he.value,de=te+j(he,Fe++),Ae+=Ee(he,V,Z,de,se);else if(he==="object")throw V=String(ie),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(ie).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return Ae}function Ce(ie,V,Z){if(ie==null)return ie;var te=[],se=0;return Ee(ie,te,"","",function(he){return V.call(Z,he,se++)}),te}function Ge(ie){if(ie._status===-1){var V=ie._result;V=V(),V.then(function(Z){(ie._status===0||ie._status===-1)&&(ie._status=1,ie._result=Z)},function(Z){(ie._status===0||ie._status===-1)&&(ie._status=2,ie._result=Z)}),ie._status===-1&&(ie._status=0,ie._result=V)}if(ie._status===1)return ie._result.default;throw ie._result}var Le={current:null},ce={transition:null},Me={ReactCurrentDispatcher:Le,ReactCurrentBatchConfig:ce,ReactCurrentOwner:W};function Te(){throw Error("act(...) is not supported in production builds of React.")}return dn.Children={map:Ce,forEach:function(ie,V,Z){Ce(ie,function(){V.apply(this,arguments)},Z)},count:function(ie){var V=0;return Ce(ie,function(){V++}),V},toArray:function(ie){return Ce(ie,function(V){return V})||[]},only:function(ie){if(!O(ie))throw Error("React.Children.only expected to receive a single React element child.");return ie}},dn.Component=E,dn.Fragment=t,dn.Profiler=i,dn.PureComponent=b,dn.StrictMode=r,dn.Suspense=l,dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Me,dn.act=Te,dn.cloneElement=function(ie,V,Z){if(ie==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ie+".");var te=v({},ie.props),se=ie.key,he=ie.ref,Ae=ie._owner;if(V!=null){if(V.ref!==void 0&&(he=V.ref,Ae=W.current),V.key!==void 0&&(se=""+V.key),ie.type&&ie.type.defaultProps)var Fe=ie.type.defaultProps;for(de in V)D.call(V,de)&&!I.hasOwnProperty(de)&&(te[de]=V[de]===void 0&&Fe!==void 0?Fe[de]:V[de])}var de=arguments.length-2;if(de===1)te.children=Z;else if(1<de){Fe=Array(de);for(var Pe=0;Pe<de;Pe++)Fe[Pe]=arguments[Pe+2];te.children=Fe}return{$$typeof:n,type:ie.type,key:se,ref:he,props:te,_owner:Ae}},dn.createContext=function(ie){return ie={$$typeof:a,_currentValue:ie,_currentValue2:ie,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ie.Provider={$$typeof:s,_context:ie},ie.Consumer=ie},dn.createElement=A,dn.createFactory=function(ie){var V=A.bind(null,ie);return V.type=ie,V},dn.createRef=function(){return{current:null}},dn.forwardRef=function(ie){return{$$typeof:o,render:ie}},dn.isValidElement=O,dn.lazy=function(ie){return{$$typeof:h,_payload:{_status:-1,_result:ie},_init:Ge}},dn.memo=function(ie,V){return{$$typeof:c,type:ie,compare:V===void 0?null:V}},dn.startTransition=function(ie){var V=ce.transition;ce.transition={};try{ie()}finally{ce.transition=V}},dn.unstable_act=Te,dn.useCallback=function(ie,V){return Le.current.useCallback(ie,V)},dn.useContext=function(ie){return Le.current.useContext(ie)},dn.useDebugValue=function(){},dn.useDeferredValue=function(ie){return Le.current.useDeferredValue(ie)},dn.useEffect=function(ie,V){return Le.current.useEffect(ie,V)},dn.useId=function(){return Le.current.useId()},dn.useImperativeHandle=function(ie,V,Z){return Le.current.useImperativeHandle(ie,V,Z)},dn.useInsertionEffect=function(ie,V){return Le.current.useInsertionEffect(ie,V)},dn.useLayoutEffect=function(ie,V){return Le.current.useLayoutEffect(ie,V)},dn.useMemo=function(ie,V){return Le.current.useMemo(ie,V)},dn.useReducer=function(ie,V,Z){return Le.current.useReducer(ie,V,Z)},dn.useRef=function(ie){return Le.current.useRef(ie)},dn.useState=function(ie){return Le.current.useState(ie)},dn.useSyncExternalStore=function(ie,V,Z){return Le.current.useSyncExternalStore(ie,V,Z)},dn.useTransition=function(){return Le.current.useTransition()},dn.version="18.3.1",dn}var P4;function oy(){return P4||(P4=1,rS.exports=tU()),rS.exports}var M4;function nU(){if(M4)return tm;M4=1;var n=oy(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,c){var h,g={},m=null,y=null;c!==void 0&&(m=""+c),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(y=l.ref);for(h in l)r.call(l,h)&&!s.hasOwnProperty(h)&&(g[h]=l[h]);if(o&&o.defaultProps)for(h in l=o.defaultProps,l)g[h]===void 0&&(g[h]=l[h]);return{$$typeof:e,type:o,key:m,ref:y,props:g,_owner:i.current}}return tm.Fragment=t,tm.jsx=a,tm.jsxs=a,tm}var N4;function rU(){return N4||(N4=1,nS.exports=nU()),nS.exports}var f=rU(),ax={},iS={exports:{}},Ps={},sS={exports:{}},aS={};var L4;function iU(){return L4||(L4=1,(function(n){function e(ce,Me){var Te=ce.length;ce.push(Me);e:for(;0<Te;){var ie=Te-1>>>1,V=ce[ie];if(0<i(V,Me))ce[ie]=Me,ce[Te]=V,Te=ie;else break e}}function t(ce){return ce.length===0?null:ce[0]}function r(ce){if(ce.length===0)return null;var Me=ce[0],Te=ce.pop();if(Te!==Me){ce[0]=Te;e:for(var ie=0,V=ce.length,Z=V>>>1;ie<Z;){var te=2*(ie+1)-1,se=ce[te],he=te+1,Ae=ce[he];if(0>i(se,Te))he<V&&0>i(Ae,se)?(ce[ie]=Ae,ce[he]=Te,ie=he):(ce[ie]=se,ce[te]=Te,ie=te);else if(he<V&&0>i(Ae,Te))ce[ie]=Ae,ce[he]=Te,ie=he;else break e}}return Me}function i(ce,Me){var Te=ce.sortIndex-Me.sortIndex;return Te!==0?Te:ce.id-Me.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],h=1,g=null,m=3,y=!1,v=!1,_=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(ce){for(var Me=t(c);Me!==null;){if(Me.callback===null)r(c);else if(Me.startTime<=ce)r(c),Me.sortIndex=Me.expirationTime,e(l,Me);else break;Me=t(c)}}function N(ce){if(_=!1,R(ce),!v)if(t(l)!==null)v=!0,Ge(D);else{var Me=t(c);Me!==null&&Le(N,Me.startTime-ce)}}function D(ce,Me){v=!1,_&&(_=!1,T(A),A=-1),y=!0;var Te=m;try{for(R(Me),g=t(l);g!==null&&(!(g.expirationTime>Me)||ce&&!L());){var ie=g.callback;if(typeof ie=="function"){g.callback=null,m=g.priorityLevel;var V=ie(g.expirationTime<=Me);Me=n.unstable_now(),typeof V=="function"?g.callback=V:g===t(l)&&r(l),R(Me)}else r(l);g=t(l)}if(g!==null)var Z=!0;else{var te=t(c);te!==null&&Le(N,te.startTime-Me),Z=!1}return Z}finally{g=null,m=Te,y=!1}}var W=!1,I=null,A=-1,M=5,O=-1;function L(){return!(n.unstable_now()-O<M)}function z(){if(I!==null){var ce=n.unstable_now();O=ce;var Me=!0;try{Me=I(!0,ce)}finally{Me?j():(W=!1,I=null)}}else W=!1}var j;if(typeof b=="function")j=function(){b(z)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,Ce=Ee.port2;Ee.port1.onmessage=z,j=function(){Ce.postMessage(null)}}else j=function(){E(z,0)};function Ge(ce){I=ce,W||(W=!0,j())}function Le(ce,Me){A=E(function(){ce(n.unstable_now())},Me)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ce){ce.callback=null},n.unstable_continueExecution=function(){v||y||(v=!0,Ge(D))},n.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<ce?Math.floor(1e3/ce):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(ce){switch(m){case 1:case 2:case 3:var Me=3;break;default:Me=m}var Te=m;m=Me;try{return ce()}finally{m=Te}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ce,Me){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var Te=m;m=ce;try{return Me()}finally{m=Te}},n.unstable_scheduleCallback=function(ce,Me,Te){var ie=n.unstable_now();switch(typeof Te=="object"&&Te!==null?(Te=Te.delay,Te=typeof Te=="number"&&0<Te?ie+Te:ie):Te=ie,ce){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=Te+V,ce={id:h++,callback:Me,priorityLevel:ce,startTime:Te,expirationTime:V,sortIndex:-1},Te>ie?(ce.sortIndex=Te,e(c,ce),t(l)===null&&ce===t(c)&&(_?(T(A),A=-1):_=!0,Le(N,Te-ie))):(ce.sortIndex=V,e(l,ce),v||y||(v=!0,Ge(D))),ce},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(ce){var Me=m;return function(){var Te=m;m=Me;try{return ce.apply(this,arguments)}finally{m=Te}}}})(aS)),aS}var O4;function sU(){return O4||(O4=1,sS.exports=iU()),sS.exports}var D4;function aU(){if(D4)return Ps;D4=1;var n=oy(),e=sU();function t(u){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+u,p=1;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(u,d){a(u,d),a(u+"Capture",d)}function a(u,d){for(i[u]=d,u=0;u<d.length;u++)r.add(d[u])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},g={};function m(u){return l.call(g,u)?!0:l.call(h,u)?!1:c.test(u)?g[u]=!0:(h[u]=!0,!1)}function y(u,d,p,w){if(p!==null&&p.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return w?!1:p!==null?!p.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function v(u,d,p,w){if(d===null||typeof d>"u"||y(u,d,p,w))return!0;if(w)return!1;if(p!==null)switch(p.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function _(u,d,p,w,S,k,G){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=w,this.attributeNamespace=S,this.mustUseProperty=p,this.propertyName=u,this.type=d,this.sanitizeURL=k,this.removeEmptyString=G}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){E[u]=new _(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var d=u[0];E[d]=new _(d,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){E[u]=new _(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){E[u]=new _(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){E[u]=new _(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){E[u]=new _(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){E[u]=new _(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){E[u]=new _(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){E[u]=new _(u,5,!1,u.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function b(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var d=u.replace(T,b);E[d]=new _(d,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var d=u.replace(T,b);E[d]=new _(d,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var d=u.replace(T,b);E[d]=new _(d,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){E[u]=new _(u,1,!1,u.toLowerCase(),null,!1,!1)}),E.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){E[u]=new _(u,1,!1,u.toLowerCase(),null,!0,!0)});function R(u,d,p,w){var S=E.hasOwnProperty(d)?E[d]:null;(S!==null?S.type!==0:w||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(v(d,p,S,w)&&(p=null),w||S===null?m(d)&&(p===null?u.removeAttribute(d):u.setAttribute(d,""+p)):S.mustUseProperty?u[S.propertyName]=p===null?S.type===3?!1:"":p:(d=S.attributeName,w=S.attributeNamespace,p===null?u.removeAttribute(d):(S=S.type,p=S===3||S===4&&p===!0?"":""+p,w?u.setAttributeNS(w,d,p):u.setAttribute(d,p))))}var N=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),W=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),L=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),Ee=Symbol.for("react.suspense_list"),Ce=Symbol.for("react.memo"),Ge=Symbol.for("react.lazy"),Le=Symbol.for("react.offscreen"),ce=Symbol.iterator;function Me(u){return u===null||typeof u!="object"?null:(u=ce&&u[ce]||u["@@iterator"],typeof u=="function"?u:null)}var Te=Object.assign,ie;function V(u){if(ie===void 0)try{throw Error()}catch(p){var d=p.stack.trim().match(/\n( *(at )?)/);ie=d&&d[1]||""}return`
`+ie+u}var Z=!1;function te(u,d){if(!u||Z)return"";Z=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(Re){var w=Re}Reflect.construct(u,[],d)}else{try{d.call()}catch(Re){w=Re}u.call(d.prototype)}else{try{throw Error()}catch(Re){w=Re}u()}}catch(Re){if(Re&&w&&typeof Re.stack=="string"){for(var S=Re.stack.split(`
`),k=w.stack.split(`
`),G=S.length-1,ae=k.length-1;1<=G&&0<=ae&&S[G]!==k[ae];)ae--;for(;1<=G&&0<=ae;G--,ae--)if(S[G]!==k[ae]){if(G!==1||ae!==1)do if(G--,ae--,0>ae||S[G]!==k[ae]){var oe=`
`+S[G].replace(" at new "," at ");return u.displayName&&oe.includes("<anonymous>")&&(oe=oe.replace("<anonymous>",u.displayName)),oe}while(1<=G&&0<=ae);break}}}finally{Z=!1,Error.prepareStackTrace=p}return(u=u?u.displayName||u.name:"")?V(u):""}function se(u){switch(u.tag){case 5:return V(u.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return u=te(u.type,!1),u;case 11:return u=te(u.type.render,!1),u;case 1:return u=te(u.type,!0),u;default:return""}}function he(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case I:return"Fragment";case W:return"Portal";case M:return"Profiler";case A:return"StrictMode";case j:return"Suspense";case Ee:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case L:return(u.displayName||"Context")+".Consumer";case O:return(u._context.displayName||"Context")+".Provider";case z:var d=u.render;return u=u.displayName,u||(u=d.displayName||d.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case Ce:return d=u.displayName||null,d!==null?d:he(u.type)||"Memo";case Ge:d=u._payload,u=u._init;try{return he(u(d))}catch{}}return null}function Ae(u){var d=u.type;switch(u.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=d.render,u=u.displayName||u.name||"",d.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return he(d);case 8:return d===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function Fe(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function de(u){var d=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function Pe(u){var d=de(u)?"checked":"value",p=Object.getOwnPropertyDescriptor(u.constructor.prototype,d),w=""+u[d];if(!u.hasOwnProperty(d)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,k=p.set;return Object.defineProperty(u,d,{configurable:!0,get:function(){return S.call(this)},set:function(G){w=""+G,k.call(this,G)}}),Object.defineProperty(u,d,{enumerable:p.enumerable}),{getValue:function(){return w},setValue:function(G){w=""+G},stopTracking:function(){u._valueTracker=null,delete u[d]}}}}function Be(u){u._valueTracker||(u._valueTracker=Pe(u))}function It(u){if(!u)return!1;var d=u._valueTracker;if(!d)return!0;var p=d.getValue(),w="";return u&&(w=de(u)?u.checked?"true":"false":u.value),u=w,u!==p?(d.setValue(u),!0):!1}function Wt(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function Dt(u,d){var p=d.checked;return Te({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??u._wrapperState.initialChecked})}function Zt(u,d){var p=d.defaultValue==null?"":d.defaultValue,w=d.checked!=null?d.checked:d.defaultChecked;p=Fe(d.value!=null?d.value:p),u._wrapperState={initialChecked:w,initialValue:p,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function rn(u,d){d=d.checked,d!=null&&R(u,"checked",d,!1)}function ht(u,d){rn(u,d);var p=Fe(d.value),w=d.type;if(p!=null)w==="number"?(p===0&&u.value===""||u.value!=p)&&(u.value=""+p):u.value!==""+p&&(u.value=""+p);else if(w==="submit"||w==="reset"){u.removeAttribute("value");return}d.hasOwnProperty("value")?hn(u,d.type,p):d.hasOwnProperty("defaultValue")&&hn(u,d.type,Fe(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(u.defaultChecked=!!d.defaultChecked)}function rr(u,d,p){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var w=d.type;if(!(w!=="submit"&&w!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+u._wrapperState.initialValue,p||d===u.value||(u.value=d),u.defaultValue=d}p=u.name,p!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,p!==""&&(u.name=p)}function hn(u,d,p){(d!=="number"||Wt(u.ownerDocument)!==u)&&(p==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+p&&(u.defaultValue=""+p))}var cn=Array.isArray;function ir(u,d,p,w){if(u=u.options,d){d={};for(var S=0;S<p.length;S++)d["$"+p[S]]=!0;for(p=0;p<u.length;p++)S=d.hasOwnProperty("$"+u[p].value),u[p].selected!==S&&(u[p].selected=S),S&&w&&(u[p].defaultSelected=!0)}else{for(p=""+Fe(p),d=null,S=0;S<u.length;S++){if(u[S].value===p){u[S].selected=!0,w&&(u[S].defaultSelected=!0);return}d!==null||u[S].disabled||(d=u[S])}d!==null&&(d.selected=!0)}}function Pi(u,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return Te({},d,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function jn(u,d){var p=d.value;if(p==null){if(p=d.children,d=d.defaultValue,p!=null){if(d!=null)throw Error(t(92));if(cn(p)){if(1<p.length)throw Error(t(93));p=p[0]}d=p}d==null&&(d=""),p=d}u._wrapperState={initialValue:Fe(p)}}function Sr(u,d){var p=Fe(d.value),w=Fe(d.defaultValue);p!=null&&(p=""+p,p!==u.value&&(u.value=p),d.defaultValue==null&&u.defaultValue!==p&&(u.defaultValue=p)),w!=null&&(u.defaultValue=""+w)}function ai(u){var d=u.textContent;d===u._wrapperState.initialValue&&d!==""&&d!==null&&(u.value=d)}function _t(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pn(u,d){return u==null||u==="http://www.w3.org/1999/xhtml"?_t(d):u==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var bn,Et=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,p,w,S){MSApp.execUnsafeLocalFunction(function(){return u(d,p,w,S)})}:u})(function(u,d){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=d;else{for(bn=bn||document.createElement("div"),bn.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=bn.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;d.firstChild;)u.appendChild(d.firstChild)}});function sn(u,d){if(d){var p=u.firstChild;if(p&&p===u.lastChild&&p.nodeType===3){p.nodeValue=d;return}}u.textContent=d}var Nt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xi=["Webkit","ms","Moz","O"];Object.keys(Nt).forEach(function(u){Xi.forEach(function(d){d=d+u.charAt(0).toUpperCase()+u.substring(1),Nt[d]=Nt[u]})});function Mr(u,d,p){return d==null||typeof d=="boolean"||d===""?"":p||typeof d!="number"||d===0||Nt.hasOwnProperty(u)&&Nt[u]?(""+d).trim():d+"px"}function oi(u,d){u=u.style;for(var p in d)if(d.hasOwnProperty(p)){var w=p.indexOf("--")===0,S=Mr(p,d[p],w);p==="float"&&(p="cssFloat"),w?u.setProperty(p,S):u[p]=S}}var tn=Te({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Tr(u,d){if(d){if(tn[u]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,u));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function je(u,d){if(u.indexOf("-")===-1)return typeof d.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function xe(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Ot=null,P=null,ct=null;function U(u){if(u=Bg(u)){if(typeof Ot!="function")throw Error(t(280));var d=u.stateNode;d&&(d=w1(d),Ot(u.stateNode,u.type,d))}}function re(u){P?ct?ct.push(u):ct=[u]:P=u}function ee(){if(P){var u=P,d=ct;if(ct=P=null,U(u),d)for(u=0;u<d.length;u++)U(d[u])}}function ne(u,d){return u(d)}function ue(){}var Ie=!1;function Ve(u,d,p){if(Ie)return u(d,p);Ie=!0;try{return ne(u,d,p)}finally{Ie=!1,(P!==null||ct!==null)&&(ue(),ee())}}function He(u,d){var p=u.stateNode;if(p===null)return null;var w=w1(p);if(w===null)return null;p=w[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(u=u.type,w=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!w;break e;default:u=!1}if(u)return null;if(p&&typeof p!="function")throw Error(t(231,d,typeof p));return p}var Je=!1;if(o)try{var Qe={};Object.defineProperty(Qe,"passive",{get:function(){Je=!0}}),window.addEventListener("test",Qe,Qe),window.removeEventListener("test",Qe,Qe)}catch{Je=!1}function yt(u,d,p,w,S,k,G,ae,oe){var Re=Array.prototype.slice.call(arguments,3);try{d.apply(p,Re)}catch(Ke){this.onError(Ke)}}var St=!1,Rn=null,B=!1,Y=null,K={onError:function(u){St=!0,Rn=u}};function q(u,d,p,w,S,k,G,ae,oe){St=!1,Rn=null,yt.apply(K,arguments)}function J(u,d,p,w,S,k,G,ae,oe){if(q.apply(this,arguments),St){if(St){var Re=Rn;St=!1,Rn=null}else throw Error(t(198));B||(B=!0,Y=Re)}}function Q(u){var d=u,p=u;if(u.alternate)for(;d.return;)d=d.return;else{u=d;do d=u,(d.flags&4098)!==0&&(p=d.return),u=d.return;while(u)}return d.tag===3?p:null}function ve(u){if(u.tag===13){var d=u.memoizedState;if(d===null&&(u=u.alternate,u!==null&&(d=u.memoizedState)),d!==null)return d.dehydrated}return null}function Oe(u){if(Q(u)!==u)throw Error(t(188))}function _e(u){var d=u.alternate;if(!d){if(d=Q(u),d===null)throw Error(t(188));return d!==u?null:u}for(var p=u,w=d;;){var S=p.return;if(S===null)break;var k=S.alternate;if(k===null){if(w=S.return,w!==null){p=w;continue}break}if(S.child===k.child){for(k=S.child;k;){if(k===p)return Oe(S),u;if(k===w)return Oe(S),d;k=k.sibling}throw Error(t(188))}if(p.return!==w.return)p=S,w=k;else{for(var G=!1,ae=S.child;ae;){if(ae===p){G=!0,p=S,w=k;break}if(ae===w){G=!0,w=S,p=k;break}ae=ae.sibling}if(!G){for(ae=k.child;ae;){if(ae===p){G=!0,p=k,w=S;break}if(ae===w){G=!0,w=k,p=S;break}ae=ae.sibling}if(!G)throw Error(t(189))}}if(p.alternate!==w)throw Error(t(190))}if(p.tag!==3)throw Error(t(188));return p.stateNode.current===p?u:d}function Se(u){return u=_e(u),u!==null?be(u):null}function be(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var d=be(u);if(d!==null)return d;u=u.sibling}return null}var Xe=e.unstable_scheduleCallback,rt=e.unstable_cancelCallback,pt=e.unstable_shouldYield,qe=e.unstable_requestPaint,Ye=e.unstable_now,Ht=e.unstable_getCurrentPriorityLevel,Vn=e.unstable_ImmediatePriority,$n=e.unstable_UserBlockingPriority,pr=e.unstable_NormalPriority,Ha=e.unstable_LowPriority,ya=e.unstable_IdlePriority,qs=null,Gr=null;function wc(u){if(Gr&&typeof Gr.onCommitFiberRoot=="function")try{Gr.onCommitFiberRoot(qs,u,void 0,(u.current.flags&128)===128)}catch{}}var br=Math.clz32?Math.clz32:Ju,Ao=Math.log,xa=Math.LN2;function Ju(u){return u>>>=0,u===0?32:31-(Ao(u)/xa|0)|0}var ko=64,Ec=4194304;function Mn(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function _l(u,d){var p=u.pendingLanes;if(p===0)return 0;var w=0,S=u.suspendedLanes,k=u.pingedLanes,G=p&268435455;if(G!==0){var ae=G&~S;ae!==0?w=Mn(ae):(k&=G,k!==0&&(w=Mn(k)))}else G=p&~S,G!==0?w=Mn(G):k!==0&&(w=Mn(k));if(w===0)return 0;if(d!==0&&d!==w&&(d&S)===0&&(S=w&-w,k=d&-d,S>=k||S===16&&(k&4194240)!==0))return d;if((w&4)!==0&&(w|=p&16),d=u.entangledLanes,d!==0)for(u=u.entanglements,d&=w;0<d;)p=31-br(d),S=1<<p,w|=u[p],d&=~S;return w}function Qu(u,d){switch(u){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function eh(u,d){for(var p=u.suspendedLanes,w=u.pingedLanes,S=u.expirationTimes,k=u.pendingLanes;0<k;){var G=31-br(k),ae=1<<G,oe=S[G];oe===-1?((ae&p)===0||(ae&w)!==0)&&(S[G]=Qu(ae,d)):oe<=d&&(u.expiredLanes|=ae),k&=~ae}}function _g(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function vg(){var u=ko;return ko<<=1,(ko&4194240)===0&&(ko=64),u}function wg(u){for(var d=[],p=0;31>p;p++)d.push(u);return d}function th(u,d,p){u.pendingLanes|=d,d!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,d=31-br(d),u[d]=p}function LE(u,d){var p=u.pendingLanes&~d;u.pendingLanes=d,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=d,u.mutableReadLanes&=d,u.entangledLanes&=d,d=u.entanglements;var w=u.eventTimes;for(u=u.expirationTimes;0<p;){var S=31-br(p),k=1<<S;d[S]=0,w[S]=-1,u[S]=-1,p&=~k}}function Eg(u,d){var p=u.entangledLanes|=d;for(u=u.entanglements;p;){var w=31-br(p),S=1<<w;S&d|u[w]&d&&(u[w]|=d),p&=~S}}var vn=0;function Io(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var Sg,zd,Tg,bg,Rg,Co=!1,Ud=[],Po=null,Mo=null,Mi=null,nh=new Map,vl=new Map,Ys=[],s1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(u,d){switch(u){case"focusin":case"focusout":Po=null;break;case"dragenter":case"dragleave":Mo=null;break;case"mouseover":case"mouseout":Mi=null;break;case"pointerover":case"pointerout":nh.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":vl.delete(d.pointerId)}}function Ka(u,d,p,w,S,k){return u===null||u.nativeEvent!==k?(u={blockedOn:d,domEventName:p,eventSystemFlags:w,nativeEvent:k,targetContainers:[S]},d!==null&&(d=Bg(d),d!==null&&zd(d)),u):(u.eventSystemFlags|=w,d=u.targetContainers,S!==null&&d.indexOf(S)===-1&&d.push(S),u)}function a1(u,d,p,w,S){switch(d){case"focusin":return Po=Ka(Po,u,d,p,w,S),!0;case"dragenter":return Mo=Ka(Mo,u,d,p,w,S),!0;case"mouseover":return Mi=Ka(Mi,u,d,p,w,S),!0;case"pointerover":var k=S.pointerId;return nh.set(k,Ka(nh.get(k)||null,u,d,p,w,S)),!0;case"gotpointercapture":return k=S.pointerId,vl.set(k,Ka(vl.get(k)||null,u,d,p,w,S)),!0}return!1}function $d(u){var d=ah(u.target);if(d!==null){var p=Q(d);if(p!==null){if(d=p.tag,d===13){if(d=ve(p),d!==null){u.blockedOn=d,Rg(u.priority,function(){Tg(p)});return}}else if(d===3&&p.stateNode.current.memoizedState.isDehydrated){u.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}u.blockedOn=null}function sr(u){if(u.blockedOn!==null)return!1;for(var d=u.targetContainers;0<d.length;){var p=Wd(u.domEventName,u.eventSystemFlags,d[0],u.nativeEvent);if(p===null){p=u.nativeEvent;var w=new p.constructor(p.type,p);ye=w,p.target.dispatchEvent(w),ye=null}else return d=Bg(p),d!==null&&zd(d),u.blockedOn=p,!1;d.shift()}return!0}function o1(u,d,p){sr(u)&&p.delete(d)}function OE(){Co=!1,Po!==null&&sr(Po)&&(Po=null),Mo!==null&&sr(Mo)&&(Mo=null),Mi!==null&&sr(Mi)&&(Mi=null),nh.forEach(o1),vl.forEach(o1)}function Tc(u,d){u.blockedOn===d&&(u.blockedOn=null,Co||(Co=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,OE)))}function bc(u){function d(S){return Tc(S,u)}if(0<Ud.length){Tc(Ud[0],u);for(var p=1;p<Ud.length;p++){var w=Ud[p];w.blockedOn===u&&(w.blockedOn=null)}}for(Po!==null&&Tc(Po,u),Mo!==null&&Tc(Mo,u),Mi!==null&&Tc(Mi,u),nh.forEach(d),vl.forEach(d),p=0;p<Ys.length;p++)w=Ys[p],w.blockedOn===u&&(w.blockedOn=null);for(;0<Ys.length&&(p=Ys[0],p.blockedOn===null);)$d(p),p.blockedOn===null&&Ys.shift()}var wl=N.ReactCurrentBatchConfig,El=!0;function No(u,d,p,w){var S=vn,k=wl.transition;wl.transition=null;try{vn=1,Ag(u,d,p,w)}finally{vn=S,wl.transition=k}}function l1(u,d,p,w){var S=vn,k=wl.transition;wl.transition=null;try{vn=4,Ag(u,d,p,w)}finally{vn=S,wl.transition=k}}function Ag(u,d,p,w){if(El){var S=Wd(u,d,p,w);if(S===null)HE(u,d,w,Lo,p),Sc(u,w);else if(a1(S,u,d,p,w))w.stopPropagation();else if(Sc(u,w),d&4&&-1<s1.indexOf(u)){for(;S!==null;){var k=Bg(S);if(k!==null&&Sg(k),k=Wd(u,d,p,w),k===null&&HE(u,d,w,Lo,p),k===S)break;S=k}S!==null&&w.stopPropagation()}else HE(u,d,w,null,p)}}var Lo=null;function Wd(u,d,p,w){if(Lo=null,u=xe(w),u=ah(u),u!==null)if(d=Q(u),d===null)u=null;else if(p=d.tag,p===13){if(u=ve(d),u!==null)return u;u=null}else if(p===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;u=null}else d!==u&&(u=null);return Lo=u,null}function Hd(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ht()){case Vn:return 1;case $n:return 4;case pr:case Ha:return 16;case ya:return 536870912;default:return 16}default:return 16}}var Zs=null,Kd=null,Sl=null;function c1(){if(Sl)return Sl;var u,d=Kd,p=d.length,w,S="value"in Zs?Zs.value:Zs.textContent,k=S.length;for(u=0;u<p&&d[u]===S[u];u++);var G=p-u;for(w=1;w<=G&&d[p-w]===S[k-w];w++);return Sl=S.slice(u,1<w?1-w:void 0)}function rh(u){var d=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&d===13&&(u=13)):u=d,u===10&&(u=13),32<=u||u===13?u:0}function Oo(){return!0}function kg(){return!1}function qi(u){function d(p,w,S,k,G){this._reactName=p,this._targetInst=S,this.type=w,this.nativeEvent=k,this.target=G,this.currentTarget=null;for(var ae in u)u.hasOwnProperty(ae)&&(p=u[ae],this[ae]=p?p(k):k[ae]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?Oo:kg,this.isPropagationStopped=kg,this}return Te(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Oo)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Oo)},persist:function(){},isPersistent:Oo}),d}var Do={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ih=qi(Do),Rc=Te({},Do,{view:0,detail:0}),Xd=qi(Rc),qd,Yd,Js,sh=Te({},Rc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nn,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Js&&(Js&&u.type==="mousemove"?(qd=u.screenX-Js.screenX,Yd=u.screenY-Js.screenY):Yd=qd=0,Js=u),qd)},movementY:function(u){return"movementY"in u?u.movementY:Yd}}),Ig=qi(sh),u1=Te({},sh,{dataTransfer:0}),h1=qi(u1),Zd=Te({},Rc,{relatedTarget:0}),Ni=qi(Zd),d1=Te({},Do,{animationName:0,elapsedTime:0,pseudoElement:0}),f1=qi(d1),Ac=Te({},Do,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),x=qi(Ac),C=Te({},Do,{data:0}),F=qi(C),H={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},me={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ke={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ot(u){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(u):(u=ke[u])?!!d[u]:!1}function nn(){return ot}var zr=Te({},Rc,{key:function(u){if(u.key){var d=H[u.key]||u.key;if(d!=="Unidentified")return d}return u.type==="keypress"?(u=rh(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?me[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nn,charCode:function(u){return u.type==="keypress"?rh(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?rh(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Wn=qi(zr),Kr=Te({},sh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qs=qi(Kr),Tl=Te({},Rc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nn}),Fo=qi(Tl),jo=Te({},Do,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jd=qi(jo),Cg=Te({},sh,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),qG=qi(Cg),YG=[9,13,27,32],DE=o&&"CompositionEvent"in window,Pg=null;o&&"documentMode"in document&&(Pg=document.documentMode);var ZG=o&&"TextEvent"in window&&!Pg,EC=o&&(!DE||Pg&&8<Pg&&11>=Pg),SC=" ",TC=!1;function bC(u,d){switch(u){case"keyup":return YG.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function RC(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var Qd=!1;function JG(u,d){switch(u){case"compositionend":return RC(d);case"keypress":return d.which!==32?null:(TC=!0,SC);case"textInput":return u=d.data,u===SC&&TC?null:u;default:return null}}function QG(u,d){if(Qd)return u==="compositionend"||!DE&&bC(u,d)?(u=c1(),Sl=Kd=Zs=null,Qd=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return EC&&d.locale!=="ko"?null:d.data;default:return null}}var ez={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function AC(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d==="input"?!!ez[u.type]:d==="textarea"}function kC(u,d,p,w){re(w),d=x1(d,"onChange"),0<d.length&&(p=new ih("onChange","change",null,p,w),u.push({event:p,listeners:d}))}var Mg=null,Ng=null;function tz(u){HC(u,0)}function g1(u){var d=sf(u);if(It(d))return u}function nz(u,d){if(u==="change")return d}var IC=!1;if(o){var FE;if(o){var jE="oninput"in document;if(!jE){var CC=document.createElement("div");CC.setAttribute("oninput","return;"),jE=typeof CC.oninput=="function"}FE=jE}else FE=!1;IC=FE&&(!document.documentMode||9<document.documentMode)}function PC(){Mg&&(Mg.detachEvent("onpropertychange",MC),Ng=Mg=null)}function MC(u){if(u.propertyName==="value"&&g1(Ng)){var d=[];kC(d,Ng,u,xe(u)),Ve(tz,d)}}function rz(u,d,p){u==="focusin"?(PC(),Mg=d,Ng=p,Mg.attachEvent("onpropertychange",MC)):u==="focusout"&&PC()}function iz(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return g1(Ng)}function sz(u,d){if(u==="click")return g1(d)}function az(u,d){if(u==="input"||u==="change")return g1(d)}function oz(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var Xa=typeof Object.is=="function"?Object.is:oz;function Lg(u,d){if(Xa(u,d))return!0;if(typeof u!="object"||u===null||typeof d!="object"||d===null)return!1;var p=Object.keys(u),w=Object.keys(d);if(p.length!==w.length)return!1;for(w=0;w<p.length;w++){var S=p[w];if(!l.call(d,S)||!Xa(u[S],d[S]))return!1}return!0}function NC(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function LC(u,d){var p=NC(u);u=0;for(var w;p;){if(p.nodeType===3){if(w=u+p.textContent.length,u<=d&&w>=d)return{node:p,offset:d-u};u=w}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=NC(p)}}function OC(u,d){return u&&d?u===d?!0:u&&u.nodeType===3?!1:d&&d.nodeType===3?OC(u,d.parentNode):"contains"in u?u.contains(d):u.compareDocumentPosition?!!(u.compareDocumentPosition(d)&16):!1:!1}function DC(){for(var u=window,d=Wt();d instanceof u.HTMLIFrameElement;){try{var p=typeof d.contentWindow.location.href=="string"}catch{p=!1}if(p)u=d.contentWindow;else break;d=Wt(u.document)}return d}function VE(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d&&(d==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||d==="textarea"||u.contentEditable==="true")}function lz(u){var d=DC(),p=u.focusedElem,w=u.selectionRange;if(d!==p&&p&&p.ownerDocument&&OC(p.ownerDocument.documentElement,p)){if(w!==null&&VE(p)){if(d=w.start,u=w.end,u===void 0&&(u=d),"selectionStart"in p)p.selectionStart=d,p.selectionEnd=Math.min(u,p.value.length);else if(u=(d=p.ownerDocument||document)&&d.defaultView||window,u.getSelection){u=u.getSelection();var S=p.textContent.length,k=Math.min(w.start,S);w=w.end===void 0?k:Math.min(w.end,S),!u.extend&&k>w&&(S=w,w=k,k=S),S=LC(p,k);var G=LC(p,w);S&&G&&(u.rangeCount!==1||u.anchorNode!==S.node||u.anchorOffset!==S.offset||u.focusNode!==G.node||u.focusOffset!==G.offset)&&(d=d.createRange(),d.setStart(S.node,S.offset),u.removeAllRanges(),k>w?(u.addRange(d),u.extend(G.node,G.offset)):(d.setEnd(G.node,G.offset),u.addRange(d)))}}for(d=[],u=p;u=u.parentNode;)u.nodeType===1&&d.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<d.length;p++)u=d[p],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var cz=o&&"documentMode"in document&&11>=document.documentMode,ef=null,BE=null,Og=null,GE=!1;function FC(u,d,p){var w=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;GE||ef==null||ef!==Wt(w)||(w=ef,"selectionStart"in w&&VE(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),Og&&Lg(Og,w)||(Og=w,w=x1(BE,"onSelect"),0<w.length&&(d=new ih("onSelect","select",null,d,p),u.push({event:d,listeners:w}),d.target=ef)))}function m1(u,d){var p={};return p[u.toLowerCase()]=d.toLowerCase(),p["Webkit"+u]="webkit"+d,p["Moz"+u]="moz"+d,p}var tf={animationend:m1("Animation","AnimationEnd"),animationiteration:m1("Animation","AnimationIteration"),animationstart:m1("Animation","AnimationStart"),transitionend:m1("Transition","TransitionEnd")},zE={},jC={};o&&(jC=document.createElement("div").style,"AnimationEvent"in window||(delete tf.animationend.animation,delete tf.animationiteration.animation,delete tf.animationstart.animation),"TransitionEvent"in window||delete tf.transitionend.transition);function p1(u){if(zE[u])return zE[u];if(!tf[u])return u;var d=tf[u],p;for(p in d)if(d.hasOwnProperty(p)&&p in jC)return zE[u]=d[p];return u}var VC=p1("animationend"),BC=p1("animationiteration"),GC=p1("animationstart"),zC=p1("transitionend"),UC=new Map,$C="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kc(u,d){UC.set(u,d),s(d,[u])}for(var UE=0;UE<$C.length;UE++){var $E=$C[UE],uz=$E.toLowerCase(),hz=$E[0].toUpperCase()+$E.slice(1);kc(uz,"on"+hz)}kc(VC,"onAnimationEnd"),kc(BC,"onAnimationIteration"),kc(GC,"onAnimationStart"),kc("dblclick","onDoubleClick"),kc("focusin","onFocus"),kc("focusout","onBlur"),kc(zC,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dz=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dg));function WC(u,d,p){var w=u.type||"unknown-event";u.currentTarget=p,J(w,d,void 0,u),u.currentTarget=null}function HC(u,d){d=(d&4)!==0;for(var p=0;p<u.length;p++){var w=u[p],S=w.event;w=w.listeners;e:{var k=void 0;if(d)for(var G=w.length-1;0<=G;G--){var ae=w[G],oe=ae.instance,Re=ae.currentTarget;if(ae=ae.listener,oe!==k&&S.isPropagationStopped())break e;WC(S,ae,Re),k=oe}else for(G=0;G<w.length;G++){if(ae=w[G],oe=ae.instance,Re=ae.currentTarget,ae=ae.listener,oe!==k&&S.isPropagationStopped())break e;WC(S,ae,Re),k=oe}}}if(B)throw u=Y,B=!1,Y=null,u}function hr(u,d){var p=d[JE];p===void 0&&(p=d[JE]=new Set);var w=u+"__bubble";p.has(w)||(KC(d,u,2,!1),p.add(w))}function WE(u,d,p){var w=0;d&&(w|=4),KC(p,u,w,d)}var y1="_reactListening"+Math.random().toString(36).slice(2);function Fg(u){if(!u[y1]){u[y1]=!0,r.forEach(function(p){p!=="selectionchange"&&(dz.has(p)||WE(p,!1,u),WE(p,!0,u))});var d=u.nodeType===9?u:u.ownerDocument;d===null||d[y1]||(d[y1]=!0,WE("selectionchange",!1,d))}}function KC(u,d,p,w){switch(Hd(d)){case 1:var S=No;break;case 4:S=l1;break;default:S=Ag}p=S.bind(null,d,p,u),S=void 0,!Je||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(S=!0),w?S!==void 0?u.addEventListener(d,p,{capture:!0,passive:S}):u.addEventListener(d,p,!0):S!==void 0?u.addEventListener(d,p,{passive:S}):u.addEventListener(d,p,!1)}function HE(u,d,p,w,S){var k=w;if((d&1)===0&&(d&2)===0&&w!==null)e:for(;;){if(w===null)return;var G=w.tag;if(G===3||G===4){var ae=w.stateNode.containerInfo;if(ae===S||ae.nodeType===8&&ae.parentNode===S)break;if(G===4)for(G=w.return;G!==null;){var oe=G.tag;if((oe===3||oe===4)&&(oe=G.stateNode.containerInfo,oe===S||oe.nodeType===8&&oe.parentNode===S))return;G=G.return}for(;ae!==null;){if(G=ah(ae),G===null)return;if(oe=G.tag,oe===5||oe===6){w=k=G;continue e}ae=ae.parentNode}}w=w.return}Ve(function(){var Re=k,Ke=xe(p),Ze=[];e:{var $e=UC.get(u);if($e!==void 0){var vt=ih,Rt=u;switch(u){case"keypress":if(rh(p)===0)break e;case"keydown":case"keyup":vt=Wn;break;case"focusin":Rt="focus",vt=Ni;break;case"focusout":Rt="blur",vt=Ni;break;case"beforeblur":case"afterblur":vt=Ni;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":vt=Ig;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":vt=h1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":vt=Fo;break;case VC:case BC:case GC:vt=f1;break;case zC:vt=Jd;break;case"scroll":vt=Xd;break;case"wheel":vt=qG;break;case"copy":case"cut":case"paste":vt=x;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":vt=Qs}var Ct=(d&4)!==0,Ur=!Ct&&u==="scroll",ge=Ct?$e!==null?$e+"Capture":null:$e;Ct=[];for(var le=Re,we;le!==null;){we=le;var nt=we.stateNode;if(we.tag===5&&nt!==null&&(we=nt,ge!==null&&(nt=He(le,ge),nt!=null&&Ct.push(jg(le,nt,we)))),Ur)break;le=le.return}0<Ct.length&&($e=new vt($e,Rt,null,p,Ke),Ze.push({event:$e,listeners:Ct}))}}if((d&7)===0){e:{if($e=u==="mouseover"||u==="pointerover",vt=u==="mouseout"||u==="pointerout",$e&&p!==ye&&(Rt=p.relatedTarget||p.fromElement)&&(ah(Rt)||Rt[bl]))break e;if((vt||$e)&&($e=Ke.window===Ke?Ke:($e=Ke.ownerDocument)?$e.defaultView||$e.parentWindow:window,vt?(Rt=p.relatedTarget||p.toElement,vt=Re,Rt=Rt?ah(Rt):null,Rt!==null&&(Ur=Q(Rt),Rt!==Ur||Rt.tag!==5&&Rt.tag!==6)&&(Rt=null)):(vt=null,Rt=Re),vt!==Rt)){if(Ct=Ig,nt="onMouseLeave",ge="onMouseEnter",le="mouse",(u==="pointerout"||u==="pointerover")&&(Ct=Qs,nt="onPointerLeave",ge="onPointerEnter",le="pointer"),Ur=vt==null?$e:sf(vt),we=Rt==null?$e:sf(Rt),$e=new Ct(nt,le+"leave",vt,p,Ke),$e.target=Ur,$e.relatedTarget=we,nt=null,ah(Ke)===Re&&(Ct=new Ct(ge,le+"enter",Rt,p,Ke),Ct.target=we,Ct.relatedTarget=Ur,nt=Ct),Ur=nt,vt&&Rt)t:{for(Ct=vt,ge=Rt,le=0,we=Ct;we;we=nf(we))le++;for(we=0,nt=ge;nt;nt=nf(nt))we++;for(;0<le-we;)Ct=nf(Ct),le--;for(;0<we-le;)ge=nf(ge),we--;for(;le--;){if(Ct===ge||ge!==null&&Ct===ge.alternate)break t;Ct=nf(Ct),ge=nf(ge)}Ct=null}else Ct=null;vt!==null&&XC(Ze,$e,vt,Ct,!1),Rt!==null&&Ur!==null&&XC(Ze,Ur,Rt,Ct,!0)}}e:{if($e=Re?sf(Re):window,vt=$e.nodeName&&$e.nodeName.toLowerCase(),vt==="select"||vt==="input"&&$e.type==="file")var Mt=nz;else if(AC($e))if(IC)Mt=az;else{Mt=iz;var Bt=rz}else(vt=$e.nodeName)&&vt.toLowerCase()==="input"&&($e.type==="checkbox"||$e.type==="radio")&&(Mt=sz);if(Mt&&(Mt=Mt(u,Re))){kC(Ze,Mt,p,Ke);break e}Bt&&Bt(u,$e,Re),u==="focusout"&&(Bt=$e._wrapperState)&&Bt.controlled&&$e.type==="number"&&hn($e,"number",$e.value)}switch(Bt=Re?sf(Re):window,u){case"focusin":(AC(Bt)||Bt.contentEditable==="true")&&(ef=Bt,BE=Re,Og=null);break;case"focusout":Og=BE=ef=null;break;case"mousedown":GE=!0;break;case"contextmenu":case"mouseup":case"dragend":GE=!1,FC(Ze,p,Ke);break;case"selectionchange":if(cz)break;case"keydown":case"keyup":FC(Ze,p,Ke)}var Gt;if(DE)e:{switch(u){case"compositionstart":var Kt="onCompositionStart";break e;case"compositionend":Kt="onCompositionEnd";break e;case"compositionupdate":Kt="onCompositionUpdate";break e}Kt=void 0}else Qd?bC(u,p)&&(Kt="onCompositionEnd"):u==="keydown"&&p.keyCode===229&&(Kt="onCompositionStart");Kt&&(EC&&p.locale!=="ko"&&(Qd||Kt!=="onCompositionStart"?Kt==="onCompositionEnd"&&Qd&&(Gt=c1()):(Zs=Ke,Kd="value"in Zs?Zs.value:Zs.textContent,Qd=!0)),Bt=x1(Re,Kt),0<Bt.length&&(Kt=new F(Kt,u,null,p,Ke),Ze.push({event:Kt,listeners:Bt}),Gt?Kt.data=Gt:(Gt=RC(p),Gt!==null&&(Kt.data=Gt)))),(Gt=ZG?JG(u,p):QG(u,p))&&(Re=x1(Re,"onBeforeInput"),0<Re.length&&(Ke=new F("onBeforeInput","beforeinput",null,p,Ke),Ze.push({event:Ke,listeners:Re}),Ke.data=Gt))}HC(Ze,d)})}function jg(u,d,p){return{instance:u,listener:d,currentTarget:p}}function x1(u,d){for(var p=d+"Capture",w=[];u!==null;){var S=u,k=S.stateNode;S.tag===5&&k!==null&&(S=k,k=He(u,p),k!=null&&w.unshift(jg(u,k,S)),k=He(u,d),k!=null&&w.push(jg(u,k,S))),u=u.return}return w}function nf(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function XC(u,d,p,w,S){for(var k=d._reactName,G=[];p!==null&&p!==w;){var ae=p,oe=ae.alternate,Re=ae.stateNode;if(oe!==null&&oe===w)break;ae.tag===5&&Re!==null&&(ae=Re,S?(oe=He(p,k),oe!=null&&G.unshift(jg(p,oe,ae))):S||(oe=He(p,k),oe!=null&&G.push(jg(p,oe,ae)))),p=p.return}G.length!==0&&u.push({event:d,listeners:G})}var fz=/\r\n?/g,gz=/\u0000|\uFFFD/g;function qC(u){return(typeof u=="string"?u:""+u).replace(fz,`
`).replace(gz,"")}function _1(u,d,p){if(d=qC(d),qC(u)!==d&&p)throw Error(t(425))}function v1(){}var KE=null,XE=null;function qE(u,d){return u==="textarea"||u==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var YE=typeof setTimeout=="function"?setTimeout:void 0,mz=typeof clearTimeout=="function"?clearTimeout:void 0,YC=typeof Promise=="function"?Promise:void 0,pz=typeof queueMicrotask=="function"?queueMicrotask:typeof YC<"u"?function(u){return YC.resolve(null).then(u).catch(yz)}:YE;function yz(u){setTimeout(function(){throw u})}function ZE(u,d){var p=d,w=0;do{var S=p.nextSibling;if(u.removeChild(p),S&&S.nodeType===8)if(p=S.data,p==="/$"){if(w===0){u.removeChild(S),bc(d);return}w--}else p!=="$"&&p!=="$?"&&p!=="$!"||w++;p=S}while(p);bc(d)}function Ic(u){for(;u!=null;u=u.nextSibling){var d=u.nodeType;if(d===1||d===3)break;if(d===8){if(d=u.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return u}function ZC(u){u=u.previousSibling;for(var d=0;u;){if(u.nodeType===8){var p=u.data;if(p==="$"||p==="$!"||p==="$?"){if(d===0)return u;d--}else p==="/$"&&d++}u=u.previousSibling}return null}var rf=Math.random().toString(36).slice(2),Vo="__reactFiber$"+rf,Vg="__reactProps$"+rf,bl="__reactContainer$"+rf,JE="__reactEvents$"+rf,xz="__reactListeners$"+rf,_z="__reactHandles$"+rf;function ah(u){var d=u[Vo];if(d)return d;for(var p=u.parentNode;p;){if(d=p[bl]||p[Vo]){if(p=d.alternate,d.child!==null||p!==null&&p.child!==null)for(u=ZC(u);u!==null;){if(p=u[Vo])return p;u=ZC(u)}return d}u=p,p=u.parentNode}return null}function Bg(u){return u=u[Vo]||u[bl],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function sf(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(t(33))}function w1(u){return u[Vg]||null}var QE=[],af=-1;function Cc(u){return{current:u}}function dr(u){0>af||(u.current=QE[af],QE[af]=null,af--)}function lr(u,d){af++,QE[af]=u.current,u.current=d}var Pc={},Yi=Cc(Pc),Rs=Cc(!1),oh=Pc;function of(u,d){var p=u.type.contextTypes;if(!p)return Pc;var w=u.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===d)return w.__reactInternalMemoizedMaskedChildContext;var S={},k;for(k in p)S[k]=d[k];return w&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=d,u.__reactInternalMemoizedMaskedChildContext=S),S}function As(u){return u=u.childContextTypes,u!=null}function E1(){dr(Rs),dr(Yi)}function JC(u,d,p){if(Yi.current!==Pc)throw Error(t(168));lr(Yi,d),lr(Rs,p)}function QC(u,d,p){var w=u.stateNode;if(d=d.childContextTypes,typeof w.getChildContext!="function")return p;w=w.getChildContext();for(var S in w)if(!(S in d))throw Error(t(108,Ae(u)||"Unknown",S));return Te({},p,w)}function S1(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||Pc,oh=Yi.current,lr(Yi,u),lr(Rs,Rs.current),!0}function eP(u,d,p){var w=u.stateNode;if(!w)throw Error(t(169));p?(u=QC(u,d,oh),w.__reactInternalMemoizedMergedChildContext=u,dr(Rs),dr(Yi),lr(Yi,u)):dr(Rs),lr(Rs,p)}var Rl=null,T1=!1,e2=!1;function tP(u){Rl===null?Rl=[u]:Rl.push(u)}function vz(u){T1=!0,tP(u)}function Mc(){if(!e2&&Rl!==null){e2=!0;var u=0,d=vn;try{var p=Rl;for(vn=1;u<p.length;u++){var w=p[u];do w=w(!0);while(w!==null)}Rl=null,T1=!1}catch(S){throw Rl!==null&&(Rl=Rl.slice(u+1)),Xe(Vn,Mc),S}finally{vn=d,e2=!1}}return null}var lf=[],cf=0,b1=null,R1=0,_a=[],va=0,lh=null,Al=1,kl="";function ch(u,d){lf[cf++]=R1,lf[cf++]=b1,b1=u,R1=d}function nP(u,d,p){_a[va++]=Al,_a[va++]=kl,_a[va++]=lh,lh=u;var w=Al;u=kl;var S=32-br(w)-1;w&=~(1<<S),p+=1;var k=32-br(d)+S;if(30<k){var G=S-S%5;k=(w&(1<<G)-1).toString(32),w>>=G,S-=G,Al=1<<32-br(d)+S|p<<S|w,kl=k+u}else Al=1<<k|p<<S|w,kl=u}function t2(u){u.return!==null&&(ch(u,1),nP(u,1,0))}function n2(u){for(;u===b1;)b1=lf[--cf],lf[cf]=null,R1=lf[--cf],lf[cf]=null;for(;u===lh;)lh=_a[--va],_a[va]=null,kl=_a[--va],_a[va]=null,Al=_a[--va],_a[va]=null}var ea=null,ta=null,yr=!1,qa=null;function rP(u,d){var p=Ta(5,null,null,0);p.elementType="DELETED",p.stateNode=d,p.return=u,d=u.deletions,d===null?(u.deletions=[p],u.flags|=16):d.push(p)}function iP(u,d){switch(u.tag){case 5:var p=u.type;return d=d.nodeType!==1||p.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(u.stateNode=d,ea=u,ta=Ic(d.firstChild),!0):!1;case 6:return d=u.pendingProps===""||d.nodeType!==3?null:d,d!==null?(u.stateNode=d,ea=u,ta=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(p=lh!==null?{id:Al,overflow:kl}:null,u.memoizedState={dehydrated:d,treeContext:p,retryLane:1073741824},p=Ta(18,null,null,0),p.stateNode=d,p.return=u,u.child=p,ea=u,ta=null,!0):!1;default:return!1}}function r2(u){return(u.mode&1)!==0&&(u.flags&128)===0}function i2(u){if(yr){var d=ta;if(d){var p=d;if(!iP(u,d)){if(r2(u))throw Error(t(418));d=Ic(p.nextSibling);var w=ea;d&&iP(u,d)?rP(w,p):(u.flags=u.flags&-4097|2,yr=!1,ea=u)}}else{if(r2(u))throw Error(t(418));u.flags=u.flags&-4097|2,yr=!1,ea=u}}}function sP(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;ea=u}function A1(u){if(u!==ea)return!1;if(!yr)return sP(u),yr=!0,!1;var d;if((d=u.tag!==3)&&!(d=u.tag!==5)&&(d=u.type,d=d!=="head"&&d!=="body"&&!qE(u.type,u.memoizedProps)),d&&(d=ta)){if(r2(u))throw aP(),Error(t(418));for(;d;)rP(u,d),d=Ic(d.nextSibling)}if(sP(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(t(317));e:{for(u=u.nextSibling,d=0;u;){if(u.nodeType===8){var p=u.data;if(p==="/$"){if(d===0){ta=Ic(u.nextSibling);break e}d--}else p!=="$"&&p!=="$!"&&p!=="$?"||d++}u=u.nextSibling}ta=null}}else ta=ea?Ic(u.stateNode.nextSibling):null;return!0}function aP(){for(var u=ta;u;)u=Ic(u.nextSibling)}function uf(){ta=ea=null,yr=!1}function s2(u){qa===null?qa=[u]:qa.push(u)}var wz=N.ReactCurrentBatchConfig;function Gg(u,d,p){if(u=p.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(t(309));var w=p.stateNode}if(!w)throw Error(t(147,u));var S=w,k=""+u;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===k?d.ref:(d=function(G){var ae=S.refs;G===null?delete ae[k]:ae[k]=G},d._stringRef=k,d)}if(typeof u!="string")throw Error(t(284));if(!p._owner)throw Error(t(290,u))}return u}function k1(u,d){throw u=Object.prototype.toString.call(d),Error(t(31,u==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":u))}function oP(u){var d=u._init;return d(u._payload)}function lP(u){function d(ge,le){if(u){var we=ge.deletions;we===null?(ge.deletions=[le],ge.flags|=16):we.push(le)}}function p(ge,le){if(!u)return null;for(;le!==null;)d(ge,le),le=le.sibling;return null}function w(ge,le){for(ge=new Map;le!==null;)le.key!==null?ge.set(le.key,le):ge.set(le.index,le),le=le.sibling;return ge}function S(ge,le){return ge=Bc(ge,le),ge.index=0,ge.sibling=null,ge}function k(ge,le,we){return ge.index=we,u?(we=ge.alternate,we!==null?(we=we.index,we<le?(ge.flags|=2,le):we):(ge.flags|=2,le)):(ge.flags|=1048576,le)}function G(ge){return u&&ge.alternate===null&&(ge.flags|=2),ge}function ae(ge,le,we,nt){return le===null||le.tag!==6?(le=Y2(we,ge.mode,nt),le.return=ge,le):(le=S(le,we),le.return=ge,le)}function oe(ge,le,we,nt){var Mt=we.type;return Mt===I?Ke(ge,le,we.props.children,nt,we.key):le!==null&&(le.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===Ge&&oP(Mt)===le.type)?(nt=S(le,we.props),nt.ref=Gg(ge,le,we),nt.return=ge,nt):(nt=J1(we.type,we.key,we.props,null,ge.mode,nt),nt.ref=Gg(ge,le,we),nt.return=ge,nt)}function Re(ge,le,we,nt){return le===null||le.tag!==4||le.stateNode.containerInfo!==we.containerInfo||le.stateNode.implementation!==we.implementation?(le=Z2(we,ge.mode,nt),le.return=ge,le):(le=S(le,we.children||[]),le.return=ge,le)}function Ke(ge,le,we,nt,Mt){return le===null||le.tag!==7?(le=yh(we,ge.mode,nt,Mt),le.return=ge,le):(le=S(le,we),le.return=ge,le)}function Ze(ge,le,we){if(typeof le=="string"&&le!==""||typeof le=="number")return le=Y2(""+le,ge.mode,we),le.return=ge,le;if(typeof le=="object"&&le!==null){switch(le.$$typeof){case D:return we=J1(le.type,le.key,le.props,null,ge.mode,we),we.ref=Gg(ge,null,le),we.return=ge,we;case W:return le=Z2(le,ge.mode,we),le.return=ge,le;case Ge:var nt=le._init;return Ze(ge,nt(le._payload),we)}if(cn(le)||Me(le))return le=yh(le,ge.mode,we,null),le.return=ge,le;k1(ge,le)}return null}function $e(ge,le,we,nt){var Mt=le!==null?le.key:null;if(typeof we=="string"&&we!==""||typeof we=="number")return Mt!==null?null:ae(ge,le,""+we,nt);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case D:return we.key===Mt?oe(ge,le,we,nt):null;case W:return we.key===Mt?Re(ge,le,we,nt):null;case Ge:return Mt=we._init,$e(ge,le,Mt(we._payload),nt)}if(cn(we)||Me(we))return Mt!==null?null:Ke(ge,le,we,nt,null);k1(ge,we)}return null}function vt(ge,le,we,nt,Mt){if(typeof nt=="string"&&nt!==""||typeof nt=="number")return ge=ge.get(we)||null,ae(le,ge,""+nt,Mt);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case D:return ge=ge.get(nt.key===null?we:nt.key)||null,oe(le,ge,nt,Mt);case W:return ge=ge.get(nt.key===null?we:nt.key)||null,Re(le,ge,nt,Mt);case Ge:var Bt=nt._init;return vt(ge,le,we,Bt(nt._payload),Mt)}if(cn(nt)||Me(nt))return ge=ge.get(we)||null,Ke(le,ge,nt,Mt,null);k1(le,nt)}return null}function Rt(ge,le,we,nt){for(var Mt=null,Bt=null,Gt=le,Kt=le=0,vi=null;Gt!==null&&Kt<we.length;Kt++){Gt.index>Kt?(vi=Gt,Gt=null):vi=Gt.sibling;var kn=$e(ge,Gt,we[Kt],nt);if(kn===null){Gt===null&&(Gt=vi);break}u&&Gt&&kn.alternate===null&&d(ge,Gt),le=k(kn,le,Kt),Bt===null?Mt=kn:Bt.sibling=kn,Bt=kn,Gt=vi}if(Kt===we.length)return p(ge,Gt),yr&&ch(ge,Kt),Mt;if(Gt===null){for(;Kt<we.length;Kt++)Gt=Ze(ge,we[Kt],nt),Gt!==null&&(le=k(Gt,le,Kt),Bt===null?Mt=Gt:Bt.sibling=Gt,Bt=Gt);return yr&&ch(ge,Kt),Mt}for(Gt=w(ge,Gt);Kt<we.length;Kt++)vi=vt(Gt,ge,Kt,we[Kt],nt),vi!==null&&(u&&vi.alternate!==null&&Gt.delete(vi.key===null?Kt:vi.key),le=k(vi,le,Kt),Bt===null?Mt=vi:Bt.sibling=vi,Bt=vi);return u&&Gt.forEach(function(Gc){return d(ge,Gc)}),yr&&ch(ge,Kt),Mt}function Ct(ge,le,we,nt){var Mt=Me(we);if(typeof Mt!="function")throw Error(t(150));if(we=Mt.call(we),we==null)throw Error(t(151));for(var Bt=Mt=null,Gt=le,Kt=le=0,vi=null,kn=we.next();Gt!==null&&!kn.done;Kt++,kn=we.next()){Gt.index>Kt?(vi=Gt,Gt=null):vi=Gt.sibling;var Gc=$e(ge,Gt,kn.value,nt);if(Gc===null){Gt===null&&(Gt=vi);break}u&&Gt&&Gc.alternate===null&&d(ge,Gt),le=k(Gc,le,Kt),Bt===null?Mt=Gc:Bt.sibling=Gc,Bt=Gc,Gt=vi}if(kn.done)return p(ge,Gt),yr&&ch(ge,Kt),Mt;if(Gt===null){for(;!kn.done;Kt++,kn=we.next())kn=Ze(ge,kn.value,nt),kn!==null&&(le=k(kn,le,Kt),Bt===null?Mt=kn:Bt.sibling=kn,Bt=kn);return yr&&ch(ge,Kt),Mt}for(Gt=w(ge,Gt);!kn.done;Kt++,kn=we.next())kn=vt(Gt,ge,Kt,kn.value,nt),kn!==null&&(u&&kn.alternate!==null&&Gt.delete(kn.key===null?Kt:kn.key),le=k(kn,le,Kt),Bt===null?Mt=kn:Bt.sibling=kn,Bt=kn);return u&&Gt.forEach(function(eU){return d(ge,eU)}),yr&&ch(ge,Kt),Mt}function Ur(ge,le,we,nt){if(typeof we=="object"&&we!==null&&we.type===I&&we.key===null&&(we=we.props.children),typeof we=="object"&&we!==null){switch(we.$$typeof){case D:e:{for(var Mt=we.key,Bt=le;Bt!==null;){if(Bt.key===Mt){if(Mt=we.type,Mt===I){if(Bt.tag===7){p(ge,Bt.sibling),le=S(Bt,we.props.children),le.return=ge,ge=le;break e}}else if(Bt.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===Ge&&oP(Mt)===Bt.type){p(ge,Bt.sibling),le=S(Bt,we.props),le.ref=Gg(ge,Bt,we),le.return=ge,ge=le;break e}p(ge,Bt);break}else d(ge,Bt);Bt=Bt.sibling}we.type===I?(le=yh(we.props.children,ge.mode,nt,we.key),le.return=ge,ge=le):(nt=J1(we.type,we.key,we.props,null,ge.mode,nt),nt.ref=Gg(ge,le,we),nt.return=ge,ge=nt)}return G(ge);case W:e:{for(Bt=we.key;le!==null;){if(le.key===Bt)if(le.tag===4&&le.stateNode.containerInfo===we.containerInfo&&le.stateNode.implementation===we.implementation){p(ge,le.sibling),le=S(le,we.children||[]),le.return=ge,ge=le;break e}else{p(ge,le);break}else d(ge,le);le=le.sibling}le=Z2(we,ge.mode,nt),le.return=ge,ge=le}return G(ge);case Ge:return Bt=we._init,Ur(ge,le,Bt(we._payload),nt)}if(cn(we))return Rt(ge,le,we,nt);if(Me(we))return Ct(ge,le,we,nt);k1(ge,we)}return typeof we=="string"&&we!==""||typeof we=="number"?(we=""+we,le!==null&&le.tag===6?(p(ge,le.sibling),le=S(le,we),le.return=ge,ge=le):(p(ge,le),le=Y2(we,ge.mode,nt),le.return=ge,ge=le),G(ge)):p(ge,le)}return Ur}var hf=lP(!0),cP=lP(!1),I1=Cc(null),C1=null,df=null,a2=null;function o2(){a2=df=C1=null}function l2(u){var d=I1.current;dr(I1),u._currentValue=d}function c2(u,d,p){for(;u!==null;){var w=u.alternate;if((u.childLanes&d)!==d?(u.childLanes|=d,w!==null&&(w.childLanes|=d)):w!==null&&(w.childLanes&d)!==d&&(w.childLanes|=d),u===p)break;u=u.return}}function ff(u,d){C1=u,a2=df=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&d)!==0&&(ks=!0),u.firstContext=null)}function wa(u){var d=u._currentValue;if(a2!==u)if(u={context:u,memoizedValue:d,next:null},df===null){if(C1===null)throw Error(t(308));df=u,C1.dependencies={lanes:0,firstContext:u}}else df=df.next=u;return d}var uh=null;function u2(u){uh===null?uh=[u]:uh.push(u)}function uP(u,d,p,w){var S=d.interleaved;return S===null?(p.next=p,u2(d)):(p.next=S.next,S.next=p),d.interleaved=p,Il(u,w)}function Il(u,d){u.lanes|=d;var p=u.alternate;for(p!==null&&(p.lanes|=d),p=u,u=u.return;u!==null;)u.childLanes|=d,p=u.alternate,p!==null&&(p.childLanes|=d),p=u,u=u.return;return p.tag===3?p.stateNode:null}var Nc=!1;function h2(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hP(u,d){u=u.updateQueue,d.updateQueue===u&&(d.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function Cl(u,d){return{eventTime:u,lane:d,tag:0,payload:null,callback:null,next:null}}function Lc(u,d,p){var w=u.updateQueue;if(w===null)return null;if(w=w.shared,(An&2)!==0){var S=w.pending;return S===null?d.next=d:(d.next=S.next,S.next=d),w.pending=d,Il(u,p)}return S=w.interleaved,S===null?(d.next=d,u2(w)):(d.next=S.next,S.next=d),w.interleaved=d,Il(u,p)}function P1(u,d,p){if(d=d.updateQueue,d!==null&&(d=d.shared,(p&4194240)!==0)){var w=d.lanes;w&=u.pendingLanes,p|=w,d.lanes=p,Eg(u,p)}}function dP(u,d){var p=u.updateQueue,w=u.alternate;if(w!==null&&(w=w.updateQueue,p===w)){var S=null,k=null;if(p=p.firstBaseUpdate,p!==null){do{var G={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};k===null?S=k=G:k=k.next=G,p=p.next}while(p!==null);k===null?S=k=d:k=k.next=d}else S=k=d;p={baseState:w.baseState,firstBaseUpdate:S,lastBaseUpdate:k,shared:w.shared,effects:w.effects},u.updateQueue=p;return}u=p.lastBaseUpdate,u===null?p.firstBaseUpdate=d:u.next=d,p.lastBaseUpdate=d}function M1(u,d,p,w){var S=u.updateQueue;Nc=!1;var k=S.firstBaseUpdate,G=S.lastBaseUpdate,ae=S.shared.pending;if(ae!==null){S.shared.pending=null;var oe=ae,Re=oe.next;oe.next=null,G===null?k=Re:G.next=Re,G=oe;var Ke=u.alternate;Ke!==null&&(Ke=Ke.updateQueue,ae=Ke.lastBaseUpdate,ae!==G&&(ae===null?Ke.firstBaseUpdate=Re:ae.next=Re,Ke.lastBaseUpdate=oe))}if(k!==null){var Ze=S.baseState;G=0,Ke=Re=oe=null,ae=k;do{var $e=ae.lane,vt=ae.eventTime;if((w&$e)===$e){Ke!==null&&(Ke=Ke.next={eventTime:vt,lane:0,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null});e:{var Rt=u,Ct=ae;switch($e=d,vt=p,Ct.tag){case 1:if(Rt=Ct.payload,typeof Rt=="function"){Ze=Rt.call(vt,Ze,$e);break e}Ze=Rt;break e;case 3:Rt.flags=Rt.flags&-65537|128;case 0:if(Rt=Ct.payload,$e=typeof Rt=="function"?Rt.call(vt,Ze,$e):Rt,$e==null)break e;Ze=Te({},Ze,$e);break e;case 2:Nc=!0}}ae.callback!==null&&ae.lane!==0&&(u.flags|=64,$e=S.effects,$e===null?S.effects=[ae]:$e.push(ae))}else vt={eventTime:vt,lane:$e,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},Ke===null?(Re=Ke=vt,oe=Ze):Ke=Ke.next=vt,G|=$e;if(ae=ae.next,ae===null){if(ae=S.shared.pending,ae===null)break;$e=ae,ae=$e.next,$e.next=null,S.lastBaseUpdate=$e,S.shared.pending=null}}while(!0);if(Ke===null&&(oe=Ze),S.baseState=oe,S.firstBaseUpdate=Re,S.lastBaseUpdate=Ke,d=S.shared.interleaved,d!==null){S=d;do G|=S.lane,S=S.next;while(S!==d)}else k===null&&(S.shared.lanes=0);fh|=G,u.lanes=G,u.memoizedState=Ze}}function fP(u,d,p){if(u=d.effects,d.effects=null,u!==null)for(d=0;d<u.length;d++){var w=u[d],S=w.callback;if(S!==null){if(w.callback=null,w=p,typeof S!="function")throw Error(t(191,S));S.call(w)}}}var zg={},Bo=Cc(zg),Ug=Cc(zg),$g=Cc(zg);function hh(u){if(u===zg)throw Error(t(174));return u}function d2(u,d){switch(lr($g,d),lr(Ug,u),lr(Bo,zg),u=d.nodeType,u){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:pn(null,"");break;default:u=u===8?d.parentNode:d,d=u.namespaceURI||null,u=u.tagName,d=pn(d,u)}dr(Bo),lr(Bo,d)}function gf(){dr(Bo),dr(Ug),dr($g)}function gP(u){hh($g.current);var d=hh(Bo.current),p=pn(d,u.type);d!==p&&(lr(Ug,u),lr(Bo,p))}function f2(u){Ug.current===u&&(dr(Bo),dr(Ug))}var Rr=Cc(0);function N1(u){for(var d=u;d!==null;){if(d.tag===13){var p=d.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var g2=[];function m2(){for(var u=0;u<g2.length;u++)g2[u]._workInProgressVersionPrimary=null;g2.length=0}var L1=N.ReactCurrentDispatcher,p2=N.ReactCurrentBatchConfig,dh=0,Ar=null,li=null,xi=null,O1=!1,Wg=!1,Hg=0,Ez=0;function Zi(){throw Error(t(321))}function y2(u,d){if(d===null)return!1;for(var p=0;p<d.length&&p<u.length;p++)if(!Xa(u[p],d[p]))return!1;return!0}function x2(u,d,p,w,S,k){if(dh=k,Ar=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,L1.current=u===null||u.memoizedState===null?Rz:Az,u=p(w,S),Wg){k=0;do{if(Wg=!1,Hg=0,25<=k)throw Error(t(301));k+=1,xi=li=null,d.updateQueue=null,L1.current=kz,u=p(w,S)}while(Wg)}if(L1.current=j1,d=li!==null&&li.next!==null,dh=0,xi=li=Ar=null,O1=!1,d)throw Error(t(300));return u}function _2(){var u=Hg!==0;return Hg=0,u}function Go(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xi===null?Ar.memoizedState=xi=u:xi=xi.next=u,xi}function Ea(){if(li===null){var u=Ar.alternate;u=u!==null?u.memoizedState:null}else u=li.next;var d=xi===null?Ar.memoizedState:xi.next;if(d!==null)xi=d,li=u;else{if(u===null)throw Error(t(310));li=u,u={memoizedState:li.memoizedState,baseState:li.baseState,baseQueue:li.baseQueue,queue:li.queue,next:null},xi===null?Ar.memoizedState=xi=u:xi=xi.next=u}return xi}function Kg(u,d){return typeof d=="function"?d(u):d}function v2(u){var d=Ea(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=u;var w=li,S=w.baseQueue,k=p.pending;if(k!==null){if(S!==null){var G=S.next;S.next=k.next,k.next=G}w.baseQueue=S=k,p.pending=null}if(S!==null){k=S.next,w=w.baseState;var ae=G=null,oe=null,Re=k;do{var Ke=Re.lane;if((dh&Ke)===Ke)oe!==null&&(oe=oe.next={lane:0,action:Re.action,hasEagerState:Re.hasEagerState,eagerState:Re.eagerState,next:null}),w=Re.hasEagerState?Re.eagerState:u(w,Re.action);else{var Ze={lane:Ke,action:Re.action,hasEagerState:Re.hasEagerState,eagerState:Re.eagerState,next:null};oe===null?(ae=oe=Ze,G=w):oe=oe.next=Ze,Ar.lanes|=Ke,fh|=Ke}Re=Re.next}while(Re!==null&&Re!==k);oe===null?G=w:oe.next=ae,Xa(w,d.memoizedState)||(ks=!0),d.memoizedState=w,d.baseState=G,d.baseQueue=oe,p.lastRenderedState=w}if(u=p.interleaved,u!==null){S=u;do k=S.lane,Ar.lanes|=k,fh|=k,S=S.next;while(S!==u)}else S===null&&(p.lanes=0);return[d.memoizedState,p.dispatch]}function w2(u){var d=Ea(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=u;var w=p.dispatch,S=p.pending,k=d.memoizedState;if(S!==null){p.pending=null;var G=S=S.next;do k=u(k,G.action),G=G.next;while(G!==S);Xa(k,d.memoizedState)||(ks=!0),d.memoizedState=k,d.baseQueue===null&&(d.baseState=k),p.lastRenderedState=k}return[k,w]}function mP(){}function pP(u,d){var p=Ar,w=Ea(),S=d(),k=!Xa(w.memoizedState,S);if(k&&(w.memoizedState=S,ks=!0),w=w.queue,E2(_P.bind(null,p,w,u),[u]),w.getSnapshot!==d||k||xi!==null&&xi.memoizedState.tag&1){if(p.flags|=2048,Xg(9,xP.bind(null,p,w,S,d),void 0,null),_i===null)throw Error(t(349));(dh&30)!==0||yP(p,d,S)}return S}function yP(u,d,p){u.flags|=16384,u={getSnapshot:d,value:p},d=Ar.updateQueue,d===null?(d={lastEffect:null,stores:null},Ar.updateQueue=d,d.stores=[u]):(p=d.stores,p===null?d.stores=[u]:p.push(u))}function xP(u,d,p,w){d.value=p,d.getSnapshot=w,vP(d)&&wP(u)}function _P(u,d,p){return p(function(){vP(d)&&wP(u)})}function vP(u){var d=u.getSnapshot;u=u.value;try{var p=d();return!Xa(u,p)}catch{return!0}}function wP(u){var d=Il(u,1);d!==null&&Qa(d,u,1,-1)}function EP(u){var d=Go();return typeof u=="function"&&(u=u()),d.memoizedState=d.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kg,lastRenderedState:u},d.queue=u,u=u.dispatch=bz.bind(null,Ar,u),[d.memoizedState,u]}function Xg(u,d,p,w){return u={tag:u,create:d,destroy:p,deps:w,next:null},d=Ar.updateQueue,d===null?(d={lastEffect:null,stores:null},Ar.updateQueue=d,d.lastEffect=u.next=u):(p=d.lastEffect,p===null?d.lastEffect=u.next=u:(w=p.next,p.next=u,u.next=w,d.lastEffect=u)),u}function SP(){return Ea().memoizedState}function D1(u,d,p,w){var S=Go();Ar.flags|=u,S.memoizedState=Xg(1|d,p,void 0,w===void 0?null:w)}function F1(u,d,p,w){var S=Ea();w=w===void 0?null:w;var k=void 0;if(li!==null){var G=li.memoizedState;if(k=G.destroy,w!==null&&y2(w,G.deps)){S.memoizedState=Xg(d,p,k,w);return}}Ar.flags|=u,S.memoizedState=Xg(1|d,p,k,w)}function TP(u,d){return D1(8390656,8,u,d)}function E2(u,d){return F1(2048,8,u,d)}function bP(u,d){return F1(4,2,u,d)}function RP(u,d){return F1(4,4,u,d)}function AP(u,d){if(typeof d=="function")return u=u(),d(u),function(){d(null)};if(d!=null)return u=u(),d.current=u,function(){d.current=null}}function kP(u,d,p){return p=p!=null?p.concat([u]):null,F1(4,4,AP.bind(null,d,u),p)}function S2(){}function IP(u,d){var p=Ea();d=d===void 0?null:d;var w=p.memoizedState;return w!==null&&d!==null&&y2(d,w[1])?w[0]:(p.memoizedState=[u,d],u)}function CP(u,d){var p=Ea();d=d===void 0?null:d;var w=p.memoizedState;return w!==null&&d!==null&&y2(d,w[1])?w[0]:(u=u(),p.memoizedState=[u,d],u)}function PP(u,d,p){return(dh&21)===0?(u.baseState&&(u.baseState=!1,ks=!0),u.memoizedState=p):(Xa(p,d)||(p=vg(),Ar.lanes|=p,fh|=p,u.baseState=!0),d)}function Sz(u,d){var p=vn;vn=p!==0&&4>p?p:4,u(!0);var w=p2.transition;p2.transition={};try{u(!1),d()}finally{vn=p,p2.transition=w}}function MP(){return Ea().memoizedState}function Tz(u,d,p){var w=jc(u);if(p={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null},NP(u))LP(d,p);else if(p=uP(u,d,p,w),p!==null){var S=ms();Qa(p,u,w,S),OP(p,d,w)}}function bz(u,d,p){var w=jc(u),S={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null};if(NP(u))LP(d,S);else{var k=u.alternate;if(u.lanes===0&&(k===null||k.lanes===0)&&(k=d.lastRenderedReducer,k!==null))try{var G=d.lastRenderedState,ae=k(G,p);if(S.hasEagerState=!0,S.eagerState=ae,Xa(ae,G)){var oe=d.interleaved;oe===null?(S.next=S,u2(d)):(S.next=oe.next,oe.next=S),d.interleaved=S;return}}catch{}p=uP(u,d,S,w),p!==null&&(S=ms(),Qa(p,u,w,S),OP(p,d,w))}}function NP(u){var d=u.alternate;return u===Ar||d!==null&&d===Ar}function LP(u,d){Wg=O1=!0;var p=u.pending;p===null?d.next=d:(d.next=p.next,p.next=d),u.pending=d}function OP(u,d,p){if((p&4194240)!==0){var w=d.lanes;w&=u.pendingLanes,p|=w,d.lanes=p,Eg(u,p)}}var j1={readContext:wa,useCallback:Zi,useContext:Zi,useEffect:Zi,useImperativeHandle:Zi,useInsertionEffect:Zi,useLayoutEffect:Zi,useMemo:Zi,useReducer:Zi,useRef:Zi,useState:Zi,useDebugValue:Zi,useDeferredValue:Zi,useTransition:Zi,useMutableSource:Zi,useSyncExternalStore:Zi,useId:Zi,unstable_isNewReconciler:!1},Rz={readContext:wa,useCallback:function(u,d){return Go().memoizedState=[u,d===void 0?null:d],u},useContext:wa,useEffect:TP,useImperativeHandle:function(u,d,p){return p=p!=null?p.concat([u]):null,D1(4194308,4,AP.bind(null,d,u),p)},useLayoutEffect:function(u,d){return D1(4194308,4,u,d)},useInsertionEffect:function(u,d){return D1(4,2,u,d)},useMemo:function(u,d){var p=Go();return d=d===void 0?null:d,u=u(),p.memoizedState=[u,d],u},useReducer:function(u,d,p){var w=Go();return d=p!==void 0?p(d):d,w.memoizedState=w.baseState=d,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:d},w.queue=u,u=u.dispatch=Tz.bind(null,Ar,u),[w.memoizedState,u]},useRef:function(u){var d=Go();return u={current:u},d.memoizedState=u},useState:EP,useDebugValue:S2,useDeferredValue:function(u){return Go().memoizedState=u},useTransition:function(){var u=EP(!1),d=u[0];return u=Sz.bind(null,u[1]),Go().memoizedState=u,[d,u]},useMutableSource:function(){},useSyncExternalStore:function(u,d,p){var w=Ar,S=Go();if(yr){if(p===void 0)throw Error(t(407));p=p()}else{if(p=d(),_i===null)throw Error(t(349));(dh&30)!==0||yP(w,d,p)}S.memoizedState=p;var k={value:p,getSnapshot:d};return S.queue=k,TP(_P.bind(null,w,k,u),[u]),w.flags|=2048,Xg(9,xP.bind(null,w,k,p,d),void 0,null),p},useId:function(){var u=Go(),d=_i.identifierPrefix;if(yr){var p=kl,w=Al;p=(w&~(1<<32-br(w)-1)).toString(32)+p,d=":"+d+"R"+p,p=Hg++,0<p&&(d+="H"+p.toString(32)),d+=":"}else p=Ez++,d=":"+d+"r"+p.toString(32)+":";return u.memoizedState=d},unstable_isNewReconciler:!1},Az={readContext:wa,useCallback:IP,useContext:wa,useEffect:E2,useImperativeHandle:kP,useInsertionEffect:bP,useLayoutEffect:RP,useMemo:CP,useReducer:v2,useRef:SP,useState:function(){return v2(Kg)},useDebugValue:S2,useDeferredValue:function(u){var d=Ea();return PP(d,li.memoizedState,u)},useTransition:function(){var u=v2(Kg)[0],d=Ea().memoizedState;return[u,d]},useMutableSource:mP,useSyncExternalStore:pP,useId:MP,unstable_isNewReconciler:!1},kz={readContext:wa,useCallback:IP,useContext:wa,useEffect:E2,useImperativeHandle:kP,useInsertionEffect:bP,useLayoutEffect:RP,useMemo:CP,useReducer:w2,useRef:SP,useState:function(){return w2(Kg)},useDebugValue:S2,useDeferredValue:function(u){var d=Ea();return li===null?d.memoizedState=u:PP(d,li.memoizedState,u)},useTransition:function(){var u=w2(Kg)[0],d=Ea().memoizedState;return[u,d]},useMutableSource:mP,useSyncExternalStore:pP,useId:MP,unstable_isNewReconciler:!1};function Ya(u,d){if(u&&u.defaultProps){d=Te({},d),u=u.defaultProps;for(var p in u)d[p]===void 0&&(d[p]=u[p]);return d}return d}function T2(u,d,p,w){d=u.memoizedState,p=p(w,d),p=p==null?d:Te({},d,p),u.memoizedState=p,u.lanes===0&&(u.updateQueue.baseState=p)}var V1={isMounted:function(u){return(u=u._reactInternals)?Q(u)===u:!1},enqueueSetState:function(u,d,p){u=u._reactInternals;var w=ms(),S=jc(u),k=Cl(w,S);k.payload=d,p!=null&&(k.callback=p),d=Lc(u,k,S),d!==null&&(Qa(d,u,S,w),P1(d,u,S))},enqueueReplaceState:function(u,d,p){u=u._reactInternals;var w=ms(),S=jc(u),k=Cl(w,S);k.tag=1,k.payload=d,p!=null&&(k.callback=p),d=Lc(u,k,S),d!==null&&(Qa(d,u,S,w),P1(d,u,S))},enqueueForceUpdate:function(u,d){u=u._reactInternals;var p=ms(),w=jc(u),S=Cl(p,w);S.tag=2,d!=null&&(S.callback=d),d=Lc(u,S,w),d!==null&&(Qa(d,u,w,p),P1(d,u,w))}};function DP(u,d,p,w,S,k,G){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(w,k,G):d.prototype&&d.prototype.isPureReactComponent?!Lg(p,w)||!Lg(S,k):!0}function FP(u,d,p){var w=!1,S=Pc,k=d.contextType;return typeof k=="object"&&k!==null?k=wa(k):(S=As(d)?oh:Yi.current,w=d.contextTypes,k=(w=w!=null)?of(u,S):Pc),d=new d(p,k),u.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=V1,u.stateNode=d,d._reactInternals=u,w&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=S,u.__reactInternalMemoizedMaskedChildContext=k),d}function jP(u,d,p,w){u=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(p,w),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(p,w),d.state!==u&&V1.enqueueReplaceState(d,d.state,null)}function b2(u,d,p,w){var S=u.stateNode;S.props=p,S.state=u.memoizedState,S.refs={},h2(u);var k=d.contextType;typeof k=="object"&&k!==null?S.context=wa(k):(k=As(d)?oh:Yi.current,S.context=of(u,k)),S.state=u.memoizedState,k=d.getDerivedStateFromProps,typeof k=="function"&&(T2(u,d,k,p),S.state=u.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(d=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),d!==S.state&&V1.enqueueReplaceState(S,S.state,null),M1(u,p,S,w),S.state=u.memoizedState),typeof S.componentDidMount=="function"&&(u.flags|=4194308)}function mf(u,d){try{var p="",w=d;do p+=se(w),w=w.return;while(w);var S=p}catch(k){S=`
Error generating stack: `+k.message+`
`+k.stack}return{value:u,source:d,stack:S,digest:null}}function R2(u,d,p){return{value:u,source:null,stack:p??null,digest:d??null}}function A2(u,d){try{console.error(d.value)}catch(p){setTimeout(function(){throw p})}}var Iz=typeof WeakMap=="function"?WeakMap:Map;function VP(u,d,p){p=Cl(-1,p),p.tag=3,p.payload={element:null};var w=d.value;return p.callback=function(){H1||(H1=!0,z2=w),A2(u,d)},p}function BP(u,d,p){p=Cl(-1,p),p.tag=3;var w=u.type.getDerivedStateFromError;if(typeof w=="function"){var S=d.value;p.payload=function(){return w(S)},p.callback=function(){A2(u,d)}}var k=u.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(p.callback=function(){A2(u,d),typeof w!="function"&&(Dc===null?Dc=new Set([this]):Dc.add(this));var G=d.stack;this.componentDidCatch(d.value,{componentStack:G!==null?G:""})}),p}function GP(u,d,p){var w=u.pingCache;if(w===null){w=u.pingCache=new Iz;var S=new Set;w.set(d,S)}else S=w.get(d),S===void 0&&(S=new Set,w.set(d,S));S.has(p)||(S.add(p),u=Uz.bind(null,u,d,p),d.then(u,u))}function zP(u){do{var d;if((d=u.tag===13)&&(d=u.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return u;u=u.return}while(u!==null);return null}function UP(u,d,p,w,S){return(u.mode&1)===0?(u===d?u.flags|=65536:(u.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(d=Cl(-1,1),d.tag=2,Lc(p,d,1))),p.lanes|=1),u):(u.flags|=65536,u.lanes=S,u)}var Cz=N.ReactCurrentOwner,ks=!1;function gs(u,d,p,w){d.child=u===null?cP(d,null,p,w):hf(d,u.child,p,w)}function $P(u,d,p,w,S){p=p.render;var k=d.ref;return ff(d,S),w=x2(u,d,p,w,k,S),p=_2(),u!==null&&!ks?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~S,Pl(u,d,S)):(yr&&p&&t2(d),d.flags|=1,gs(u,d,w,S),d.child)}function WP(u,d,p,w,S){if(u===null){var k=p.type;return typeof k=="function"&&!q2(k)&&k.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(d.tag=15,d.type=k,HP(u,d,k,w,S)):(u=J1(p.type,null,w,d,d.mode,S),u.ref=d.ref,u.return=d,d.child=u)}if(k=u.child,(u.lanes&S)===0){var G=k.memoizedProps;if(p=p.compare,p=p!==null?p:Lg,p(G,w)&&u.ref===d.ref)return Pl(u,d,S)}return d.flags|=1,u=Bc(k,w),u.ref=d.ref,u.return=d,d.child=u}function HP(u,d,p,w,S){if(u!==null){var k=u.memoizedProps;if(Lg(k,w)&&u.ref===d.ref)if(ks=!1,d.pendingProps=w=k,(u.lanes&S)!==0)(u.flags&131072)!==0&&(ks=!0);else return d.lanes=u.lanes,Pl(u,d,S)}return k2(u,d,p,w,S)}function KP(u,d,p){var w=d.pendingProps,S=w.children,k=u!==null?u.memoizedState:null;if(w.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},lr(yf,na),na|=p;else{if((p&1073741824)===0)return u=k!==null?k.baseLanes|p:p,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:u,cachePool:null,transitions:null},d.updateQueue=null,lr(yf,na),na|=u,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},w=k!==null?k.baseLanes:p,lr(yf,na),na|=w}else k!==null?(w=k.baseLanes|p,d.memoizedState=null):w=p,lr(yf,na),na|=w;return gs(u,d,S,p),d.child}function XP(u,d){var p=d.ref;(u===null&&p!==null||u!==null&&u.ref!==p)&&(d.flags|=512,d.flags|=2097152)}function k2(u,d,p,w,S){var k=As(p)?oh:Yi.current;return k=of(d,k),ff(d,S),p=x2(u,d,p,w,k,S),w=_2(),u!==null&&!ks?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~S,Pl(u,d,S)):(yr&&w&&t2(d),d.flags|=1,gs(u,d,p,S),d.child)}function qP(u,d,p,w,S){if(As(p)){var k=!0;S1(d)}else k=!1;if(ff(d,S),d.stateNode===null)G1(u,d),FP(d,p,w),b2(d,p,w,S),w=!0;else if(u===null){var G=d.stateNode,ae=d.memoizedProps;G.props=ae;var oe=G.context,Re=p.contextType;typeof Re=="object"&&Re!==null?Re=wa(Re):(Re=As(p)?oh:Yi.current,Re=of(d,Re));var Ke=p.getDerivedStateFromProps,Ze=typeof Ke=="function"||typeof G.getSnapshotBeforeUpdate=="function";Ze||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(ae!==w||oe!==Re)&&jP(d,G,w,Re),Nc=!1;var $e=d.memoizedState;G.state=$e,M1(d,w,G,S),oe=d.memoizedState,ae!==w||$e!==oe||Rs.current||Nc?(typeof Ke=="function"&&(T2(d,p,Ke,w),oe=d.memoizedState),(ae=Nc||DP(d,p,ae,w,$e,oe,Re))?(Ze||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(d.flags|=4194308)):(typeof G.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=w,d.memoizedState=oe),G.props=w,G.state=oe,G.context=Re,w=ae):(typeof G.componentDidMount=="function"&&(d.flags|=4194308),w=!1)}else{G=d.stateNode,hP(u,d),ae=d.memoizedProps,Re=d.type===d.elementType?ae:Ya(d.type,ae),G.props=Re,Ze=d.pendingProps,$e=G.context,oe=p.contextType,typeof oe=="object"&&oe!==null?oe=wa(oe):(oe=As(p)?oh:Yi.current,oe=of(d,oe));var vt=p.getDerivedStateFromProps;(Ke=typeof vt=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(ae!==Ze||$e!==oe)&&jP(d,G,w,oe),Nc=!1,$e=d.memoizedState,G.state=$e,M1(d,w,G,S);var Rt=d.memoizedState;ae!==Ze||$e!==Rt||Rs.current||Nc?(typeof vt=="function"&&(T2(d,p,vt,w),Rt=d.memoizedState),(Re=Nc||DP(d,p,Re,w,$e,Rt,oe)||!1)?(Ke||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(w,Rt,oe),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(w,Rt,oe)),typeof G.componentDidUpdate=="function"&&(d.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof G.componentDidUpdate!="function"||ae===u.memoizedProps&&$e===u.memoizedState||(d.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||ae===u.memoizedProps&&$e===u.memoizedState||(d.flags|=1024),d.memoizedProps=w,d.memoizedState=Rt),G.props=w,G.state=Rt,G.context=oe,w=Re):(typeof G.componentDidUpdate!="function"||ae===u.memoizedProps&&$e===u.memoizedState||(d.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||ae===u.memoizedProps&&$e===u.memoizedState||(d.flags|=1024),w=!1)}return I2(u,d,p,w,k,S)}function I2(u,d,p,w,S,k){XP(u,d);var G=(d.flags&128)!==0;if(!w&&!G)return S&&eP(d,p,!1),Pl(u,d,k);w=d.stateNode,Cz.current=d;var ae=G&&typeof p.getDerivedStateFromError!="function"?null:w.render();return d.flags|=1,u!==null&&G?(d.child=hf(d,u.child,null,k),d.child=hf(d,null,ae,k)):gs(u,d,ae,k),d.memoizedState=w.state,S&&eP(d,p,!0),d.child}function YP(u){var d=u.stateNode;d.pendingContext?JC(u,d.pendingContext,d.pendingContext!==d.context):d.context&&JC(u,d.context,!1),d2(u,d.containerInfo)}function ZP(u,d,p,w,S){return uf(),s2(S),d.flags|=256,gs(u,d,p,w),d.child}var C2={dehydrated:null,treeContext:null,retryLane:0};function P2(u){return{baseLanes:u,cachePool:null,transitions:null}}function JP(u,d,p){var w=d.pendingProps,S=Rr.current,k=!1,G=(d.flags&128)!==0,ae;if((ae=G)||(ae=u!==null&&u.memoizedState===null?!1:(S&2)!==0),ae?(k=!0,d.flags&=-129):(u===null||u.memoizedState!==null)&&(S|=1),lr(Rr,S&1),u===null)return i2(d),u=d.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((d.mode&1)===0?d.lanes=1:u.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(G=w.children,u=w.fallback,k?(w=d.mode,k=d.child,G={mode:"hidden",children:G},(w&1)===0&&k!==null?(k.childLanes=0,k.pendingProps=G):k=Q1(G,w,0,null),u=yh(u,w,p,null),k.return=d,u.return=d,k.sibling=u,d.child=k,d.child.memoizedState=P2(p),d.memoizedState=C2,u):M2(d,G));if(S=u.memoizedState,S!==null&&(ae=S.dehydrated,ae!==null))return Pz(u,d,G,w,ae,S,p);if(k){k=w.fallback,G=d.mode,S=u.child,ae=S.sibling;var oe={mode:"hidden",children:w.children};return(G&1)===0&&d.child!==S?(w=d.child,w.childLanes=0,w.pendingProps=oe,d.deletions=null):(w=Bc(S,oe),w.subtreeFlags=S.subtreeFlags&14680064),ae!==null?k=Bc(ae,k):(k=yh(k,G,p,null),k.flags|=2),k.return=d,w.return=d,w.sibling=k,d.child=w,w=k,k=d.child,G=u.child.memoizedState,G=G===null?P2(p):{baseLanes:G.baseLanes|p,cachePool:null,transitions:G.transitions},k.memoizedState=G,k.childLanes=u.childLanes&~p,d.memoizedState=C2,w}return k=u.child,u=k.sibling,w=Bc(k,{mode:"visible",children:w.children}),(d.mode&1)===0&&(w.lanes=p),w.return=d,w.sibling=null,u!==null&&(p=d.deletions,p===null?(d.deletions=[u],d.flags|=16):p.push(u)),d.child=w,d.memoizedState=null,w}function M2(u,d){return d=Q1({mode:"visible",children:d},u.mode,0,null),d.return=u,u.child=d}function B1(u,d,p,w){return w!==null&&s2(w),hf(d,u.child,null,p),u=M2(d,d.pendingProps.children),u.flags|=2,d.memoizedState=null,u}function Pz(u,d,p,w,S,k,G){if(p)return d.flags&256?(d.flags&=-257,w=R2(Error(t(422))),B1(u,d,G,w)):d.memoizedState!==null?(d.child=u.child,d.flags|=128,null):(k=w.fallback,S=d.mode,w=Q1({mode:"visible",children:w.children},S,0,null),k=yh(k,S,G,null),k.flags|=2,w.return=d,k.return=d,w.sibling=k,d.child=w,(d.mode&1)!==0&&hf(d,u.child,null,G),d.child.memoizedState=P2(G),d.memoizedState=C2,k);if((d.mode&1)===0)return B1(u,d,G,null);if(S.data==="$!"){if(w=S.nextSibling&&S.nextSibling.dataset,w)var ae=w.dgst;return w=ae,k=Error(t(419)),w=R2(k,w,void 0),B1(u,d,G,w)}if(ae=(G&u.childLanes)!==0,ks||ae){if(w=_i,w!==null){switch(G&-G){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=(S&(w.suspendedLanes|G))!==0?0:S,S!==0&&S!==k.retryLane&&(k.retryLane=S,Il(u,S),Qa(w,u,S,-1))}return X2(),w=R2(Error(t(421))),B1(u,d,G,w)}return S.data==="$?"?(d.flags|=128,d.child=u.child,d=$z.bind(null,u),S._reactRetry=d,null):(u=k.treeContext,ta=Ic(S.nextSibling),ea=d,yr=!0,qa=null,u!==null&&(_a[va++]=Al,_a[va++]=kl,_a[va++]=lh,Al=u.id,kl=u.overflow,lh=d),d=M2(d,w.children),d.flags|=4096,d)}function QP(u,d,p){u.lanes|=d;var w=u.alternate;w!==null&&(w.lanes|=d),c2(u.return,d,p)}function N2(u,d,p,w,S){var k=u.memoizedState;k===null?u.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:w,tail:p,tailMode:S}:(k.isBackwards=d,k.rendering=null,k.renderingStartTime=0,k.last=w,k.tail=p,k.tailMode=S)}function e4(u,d,p){var w=d.pendingProps,S=w.revealOrder,k=w.tail;if(gs(u,d,w.children,p),w=Rr.current,(w&2)!==0)w=w&1|2,d.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=d.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&QP(u,p,d);else if(u.tag===19)QP(u,p,d);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===d)break e;for(;u.sibling===null;){if(u.return===null||u.return===d)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}w&=1}if(lr(Rr,w),(d.mode&1)===0)d.memoizedState=null;else switch(S){case"forwards":for(p=d.child,S=null;p!==null;)u=p.alternate,u!==null&&N1(u)===null&&(S=p),p=p.sibling;p=S,p===null?(S=d.child,d.child=null):(S=p.sibling,p.sibling=null),N2(d,!1,S,p,k);break;case"backwards":for(p=null,S=d.child,d.child=null;S!==null;){if(u=S.alternate,u!==null&&N1(u)===null){d.child=S;break}u=S.sibling,S.sibling=p,p=S,S=u}N2(d,!0,p,null,k);break;case"together":N2(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function G1(u,d){(d.mode&1)===0&&u!==null&&(u.alternate=null,d.alternate=null,d.flags|=2)}function Pl(u,d,p){if(u!==null&&(d.dependencies=u.dependencies),fh|=d.lanes,(p&d.childLanes)===0)return null;if(u!==null&&d.child!==u.child)throw Error(t(153));if(d.child!==null){for(u=d.child,p=Bc(u,u.pendingProps),d.child=p,p.return=d;u.sibling!==null;)u=u.sibling,p=p.sibling=Bc(u,u.pendingProps),p.return=d;p.sibling=null}return d.child}function Mz(u,d,p){switch(d.tag){case 3:YP(d),uf();break;case 5:gP(d);break;case 1:As(d.type)&&S1(d);break;case 4:d2(d,d.stateNode.containerInfo);break;case 10:var w=d.type._context,S=d.memoizedProps.value;lr(I1,w._currentValue),w._currentValue=S;break;case 13:if(w=d.memoizedState,w!==null)return w.dehydrated!==null?(lr(Rr,Rr.current&1),d.flags|=128,null):(p&d.child.childLanes)!==0?JP(u,d,p):(lr(Rr,Rr.current&1),u=Pl(u,d,p),u!==null?u.sibling:null);lr(Rr,Rr.current&1);break;case 19:if(w=(p&d.childLanes)!==0,(u.flags&128)!==0){if(w)return e4(u,d,p);d.flags|=128}if(S=d.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),lr(Rr,Rr.current),w)break;return null;case 22:case 23:return d.lanes=0,KP(u,d,p)}return Pl(u,d,p)}var t4,L2,n4,r4;t4=function(u,d){for(var p=d.child;p!==null;){if(p.tag===5||p.tag===6)u.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},L2=function(){},n4=function(u,d,p,w){var S=u.memoizedProps;if(S!==w){u=d.stateNode,hh(Bo.current);var k=null;switch(p){case"input":S=Dt(u,S),w=Dt(u,w),k=[];break;case"select":S=Te({},S,{value:void 0}),w=Te({},w,{value:void 0}),k=[];break;case"textarea":S=Pi(u,S),w=Pi(u,w),k=[];break;default:typeof S.onClick!="function"&&typeof w.onClick=="function"&&(u.onclick=v1)}Tr(p,w);var G;p=null;for(Re in S)if(!w.hasOwnProperty(Re)&&S.hasOwnProperty(Re)&&S[Re]!=null)if(Re==="style"){var ae=S[Re];for(G in ae)ae.hasOwnProperty(G)&&(p||(p={}),p[G]="")}else Re!=="dangerouslySetInnerHTML"&&Re!=="children"&&Re!=="suppressContentEditableWarning"&&Re!=="suppressHydrationWarning"&&Re!=="autoFocus"&&(i.hasOwnProperty(Re)?k||(k=[]):(k=k||[]).push(Re,null));for(Re in w){var oe=w[Re];if(ae=S?.[Re],w.hasOwnProperty(Re)&&oe!==ae&&(oe!=null||ae!=null))if(Re==="style")if(ae){for(G in ae)!ae.hasOwnProperty(G)||oe&&oe.hasOwnProperty(G)||(p||(p={}),p[G]="");for(G in oe)oe.hasOwnProperty(G)&&ae[G]!==oe[G]&&(p||(p={}),p[G]=oe[G])}else p||(k||(k=[]),k.push(Re,p)),p=oe;else Re==="dangerouslySetInnerHTML"?(oe=oe?oe.__html:void 0,ae=ae?ae.__html:void 0,oe!=null&&ae!==oe&&(k=k||[]).push(Re,oe)):Re==="children"?typeof oe!="string"&&typeof oe!="number"||(k=k||[]).push(Re,""+oe):Re!=="suppressContentEditableWarning"&&Re!=="suppressHydrationWarning"&&(i.hasOwnProperty(Re)?(oe!=null&&Re==="onScroll"&&hr("scroll",u),k||ae===oe||(k=[])):(k=k||[]).push(Re,oe))}p&&(k=k||[]).push("style",p);var Re=k;(d.updateQueue=Re)&&(d.flags|=4)}},r4=function(u,d,p,w){p!==w&&(d.flags|=4)};function qg(u,d){if(!yr)switch(u.tailMode){case"hidden":d=u.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?u.tail=null:p.sibling=null;break;case"collapsed":p=u.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?d||u.tail===null?u.tail=null:u.tail.sibling=null:w.sibling=null}}function Ji(u){var d=u.alternate!==null&&u.alternate.child===u.child,p=0,w=0;if(d)for(var S=u.child;S!==null;)p|=S.lanes|S.childLanes,w|=S.subtreeFlags&14680064,w|=S.flags&14680064,S.return=u,S=S.sibling;else for(S=u.child;S!==null;)p|=S.lanes|S.childLanes,w|=S.subtreeFlags,w|=S.flags,S.return=u,S=S.sibling;return u.subtreeFlags|=w,u.childLanes=p,d}function Nz(u,d,p){var w=d.pendingProps;switch(n2(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ji(d),null;case 1:return As(d.type)&&E1(),Ji(d),null;case 3:return w=d.stateNode,gf(),dr(Rs),dr(Yi),m2(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(u===null||u.child===null)&&(A1(d)?d.flags|=4:u===null||u.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,qa!==null&&(W2(qa),qa=null))),L2(u,d),Ji(d),null;case 5:f2(d);var S=hh($g.current);if(p=d.type,u!==null&&d.stateNode!=null)n4(u,d,p,w,S),u.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!w){if(d.stateNode===null)throw Error(t(166));return Ji(d),null}if(u=hh(Bo.current),A1(d)){w=d.stateNode,p=d.type;var k=d.memoizedProps;switch(w[Vo]=d,w[Vg]=k,u=(d.mode&1)!==0,p){case"dialog":hr("cancel",w),hr("close",w);break;case"iframe":case"object":case"embed":hr("load",w);break;case"video":case"audio":for(S=0;S<Dg.length;S++)hr(Dg[S],w);break;case"source":hr("error",w);break;case"img":case"image":case"link":hr("error",w),hr("load",w);break;case"details":hr("toggle",w);break;case"input":Zt(w,k),hr("invalid",w);break;case"select":w._wrapperState={wasMultiple:!!k.multiple},hr("invalid",w);break;case"textarea":jn(w,k),hr("invalid",w)}Tr(p,k),S=null;for(var G in k)if(k.hasOwnProperty(G)){var ae=k[G];G==="children"?typeof ae=="string"?w.textContent!==ae&&(k.suppressHydrationWarning!==!0&&_1(w.textContent,ae,u),S=["children",ae]):typeof ae=="number"&&w.textContent!==""+ae&&(k.suppressHydrationWarning!==!0&&_1(w.textContent,ae,u),S=["children",""+ae]):i.hasOwnProperty(G)&&ae!=null&&G==="onScroll"&&hr("scroll",w)}switch(p){case"input":Be(w),rr(w,k,!0);break;case"textarea":Be(w),ai(w);break;case"select":case"option":break;default:typeof k.onClick=="function"&&(w.onclick=v1)}w=S,d.updateQueue=w,w!==null&&(d.flags|=4)}else{G=S.nodeType===9?S:S.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=_t(p)),u==="http://www.w3.org/1999/xhtml"?p==="script"?(u=G.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof w.is=="string"?u=G.createElement(p,{is:w.is}):(u=G.createElement(p),p==="select"&&(G=u,w.multiple?G.multiple=!0:w.size&&(G.size=w.size))):u=G.createElementNS(u,p),u[Vo]=d,u[Vg]=w,t4(u,d,!1,!1),d.stateNode=u;e:{switch(G=je(p,w),p){case"dialog":hr("cancel",u),hr("close",u),S=w;break;case"iframe":case"object":case"embed":hr("load",u),S=w;break;case"video":case"audio":for(S=0;S<Dg.length;S++)hr(Dg[S],u);S=w;break;case"source":hr("error",u),S=w;break;case"img":case"image":case"link":hr("error",u),hr("load",u),S=w;break;case"details":hr("toggle",u),S=w;break;case"input":Zt(u,w),S=Dt(u,w),hr("invalid",u);break;case"option":S=w;break;case"select":u._wrapperState={wasMultiple:!!w.multiple},S=Te({},w,{value:void 0}),hr("invalid",u);break;case"textarea":jn(u,w),S=Pi(u,w),hr("invalid",u);break;default:S=w}Tr(p,S),ae=S;for(k in ae)if(ae.hasOwnProperty(k)){var oe=ae[k];k==="style"?oi(u,oe):k==="dangerouslySetInnerHTML"?(oe=oe?oe.__html:void 0,oe!=null&&Et(u,oe)):k==="children"?typeof oe=="string"?(p!=="textarea"||oe!=="")&&sn(u,oe):typeof oe=="number"&&sn(u,""+oe):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(i.hasOwnProperty(k)?oe!=null&&k==="onScroll"&&hr("scroll",u):oe!=null&&R(u,k,oe,G))}switch(p){case"input":Be(u),rr(u,w,!1);break;case"textarea":Be(u),ai(u);break;case"option":w.value!=null&&u.setAttribute("value",""+Fe(w.value));break;case"select":u.multiple=!!w.multiple,k=w.value,k!=null?ir(u,!!w.multiple,k,!1):w.defaultValue!=null&&ir(u,!!w.multiple,w.defaultValue,!0);break;default:typeof S.onClick=="function"&&(u.onclick=v1)}switch(p){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}}w&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Ji(d),null;case 6:if(u&&d.stateNode!=null)r4(u,d,u.memoizedProps,w);else{if(typeof w!="string"&&d.stateNode===null)throw Error(t(166));if(p=hh($g.current),hh(Bo.current),A1(d)){if(w=d.stateNode,p=d.memoizedProps,w[Vo]=d,(k=w.nodeValue!==p)&&(u=ea,u!==null))switch(u.tag){case 3:_1(w.nodeValue,p,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&_1(w.nodeValue,p,(u.mode&1)!==0)}k&&(d.flags|=4)}else w=(p.nodeType===9?p:p.ownerDocument).createTextNode(w),w[Vo]=d,d.stateNode=w}return Ji(d),null;case 13:if(dr(Rr),w=d.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(yr&&ta!==null&&(d.mode&1)!==0&&(d.flags&128)===0)aP(),uf(),d.flags|=98560,k=!1;else if(k=A1(d),w!==null&&w.dehydrated!==null){if(u===null){if(!k)throw Error(t(318));if(k=d.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(t(317));k[Vo]=d}else uf(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Ji(d),k=!1}else qa!==null&&(W2(qa),qa=null),k=!0;if(!k)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=p,d):(w=w!==null,w!==(u!==null&&u.memoizedState!==null)&&w&&(d.child.flags|=8192,(d.mode&1)!==0&&(u===null||(Rr.current&1)!==0?ci===0&&(ci=3):X2())),d.updateQueue!==null&&(d.flags|=4),Ji(d),null);case 4:return gf(),L2(u,d),u===null&&Fg(d.stateNode.containerInfo),Ji(d),null;case 10:return l2(d.type._context),Ji(d),null;case 17:return As(d.type)&&E1(),Ji(d),null;case 19:if(dr(Rr),k=d.memoizedState,k===null)return Ji(d),null;if(w=(d.flags&128)!==0,G=k.rendering,G===null)if(w)qg(k,!1);else{if(ci!==0||u!==null&&(u.flags&128)!==0)for(u=d.child;u!==null;){if(G=N1(u),G!==null){for(d.flags|=128,qg(k,!1),w=G.updateQueue,w!==null&&(d.updateQueue=w,d.flags|=4),d.subtreeFlags=0,w=p,p=d.child;p!==null;)k=p,u=w,k.flags&=14680066,G=k.alternate,G===null?(k.childLanes=0,k.lanes=u,k.child=null,k.subtreeFlags=0,k.memoizedProps=null,k.memoizedState=null,k.updateQueue=null,k.dependencies=null,k.stateNode=null):(k.childLanes=G.childLanes,k.lanes=G.lanes,k.child=G.child,k.subtreeFlags=0,k.deletions=null,k.memoizedProps=G.memoizedProps,k.memoizedState=G.memoizedState,k.updateQueue=G.updateQueue,k.type=G.type,u=G.dependencies,k.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),p=p.sibling;return lr(Rr,Rr.current&1|2),d.child}u=u.sibling}k.tail!==null&&Ye()>xf&&(d.flags|=128,w=!0,qg(k,!1),d.lanes=4194304)}else{if(!w)if(u=N1(G),u!==null){if(d.flags|=128,w=!0,p=u.updateQueue,p!==null&&(d.updateQueue=p,d.flags|=4),qg(k,!0),k.tail===null&&k.tailMode==="hidden"&&!G.alternate&&!yr)return Ji(d),null}else 2*Ye()-k.renderingStartTime>xf&&p!==1073741824&&(d.flags|=128,w=!0,qg(k,!1),d.lanes=4194304);k.isBackwards?(G.sibling=d.child,d.child=G):(p=k.last,p!==null?p.sibling=G:d.child=G,k.last=G)}return k.tail!==null?(d=k.tail,k.rendering=d,k.tail=d.sibling,k.renderingStartTime=Ye(),d.sibling=null,p=Rr.current,lr(Rr,w?p&1|2:p&1),d):(Ji(d),null);case 22:case 23:return K2(),w=d.memoizedState!==null,u!==null&&u.memoizedState!==null!==w&&(d.flags|=8192),w&&(d.mode&1)!==0?(na&1073741824)!==0&&(Ji(d),d.subtreeFlags&6&&(d.flags|=8192)):Ji(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function Lz(u,d){switch(n2(d),d.tag){case 1:return As(d.type)&&E1(),u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 3:return gf(),dr(Rs),dr(Yi),m2(),u=d.flags,(u&65536)!==0&&(u&128)===0?(d.flags=u&-65537|128,d):null;case 5:return f2(d),null;case 13:if(dr(Rr),u=d.memoizedState,u!==null&&u.dehydrated!==null){if(d.alternate===null)throw Error(t(340));uf()}return u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 19:return dr(Rr),null;case 4:return gf(),null;case 10:return l2(d.type._context),null;case 22:case 23:return K2(),null;case 24:return null;default:return null}}var z1=!1,Qi=!1,Oz=typeof WeakSet=="function"?WeakSet:Set,wt=null;function pf(u,d){var p=u.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(w){Nr(u,d,w)}else p.current=null}function O2(u,d,p){try{p()}catch(w){Nr(u,d,w)}}var i4=!1;function Dz(u,d){if(KE=El,u=DC(),VE(u)){if("selectionStart"in u)var p={start:u.selectionStart,end:u.selectionEnd};else e:{p=(p=u.ownerDocument)&&p.defaultView||window;var w=p.getSelection&&p.getSelection();if(w&&w.rangeCount!==0){p=w.anchorNode;var S=w.anchorOffset,k=w.focusNode;w=w.focusOffset;try{p.nodeType,k.nodeType}catch{p=null;break e}var G=0,ae=-1,oe=-1,Re=0,Ke=0,Ze=u,$e=null;t:for(;;){for(var vt;Ze!==p||S!==0&&Ze.nodeType!==3||(ae=G+S),Ze!==k||w!==0&&Ze.nodeType!==3||(oe=G+w),Ze.nodeType===3&&(G+=Ze.nodeValue.length),(vt=Ze.firstChild)!==null;)$e=Ze,Ze=vt;for(;;){if(Ze===u)break t;if($e===p&&++Re===S&&(ae=G),$e===k&&++Ke===w&&(oe=G),(vt=Ze.nextSibling)!==null)break;Ze=$e,$e=Ze.parentNode}Ze=vt}p=ae===-1||oe===-1?null:{start:ae,end:oe}}else p=null}p=p||{start:0,end:0}}else p=null;for(XE={focusedElem:u,selectionRange:p},El=!1,wt=d;wt!==null;)if(d=wt,u=d.child,(d.subtreeFlags&1028)!==0&&u!==null)u.return=d,wt=u;else for(;wt!==null;){d=wt;try{var Rt=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(Rt!==null){var Ct=Rt.memoizedProps,Ur=Rt.memoizedState,ge=d.stateNode,le=ge.getSnapshotBeforeUpdate(d.elementType===d.type?Ct:Ya(d.type,Ct),Ur);ge.__reactInternalSnapshotBeforeUpdate=le}break;case 3:var we=d.stateNode.containerInfo;we.nodeType===1?we.textContent="":we.nodeType===9&&we.documentElement&&we.removeChild(we.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(nt){Nr(d,d.return,nt)}if(u=d.sibling,u!==null){u.return=d.return,wt=u;break}wt=d.return}return Rt=i4,i4=!1,Rt}function Yg(u,d,p){var w=d.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var S=w=w.next;do{if((S.tag&u)===u){var k=S.destroy;S.destroy=void 0,k!==void 0&&O2(d,p,k)}S=S.next}while(S!==w)}}function U1(u,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var p=d=d.next;do{if((p.tag&u)===u){var w=p.create;p.destroy=w()}p=p.next}while(p!==d)}}function D2(u){var d=u.ref;if(d!==null){var p=u.stateNode;switch(u.tag){case 5:u=p;break;default:u=p}typeof d=="function"?d(u):d.current=u}}function s4(u){var d=u.alternate;d!==null&&(u.alternate=null,s4(d)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(d=u.stateNode,d!==null&&(delete d[Vo],delete d[Vg],delete d[JE],delete d[xz],delete d[_z])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function a4(u){return u.tag===5||u.tag===3||u.tag===4}function o4(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||a4(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function F2(u,d,p){var w=u.tag;if(w===5||w===6)u=u.stateNode,d?p.nodeType===8?p.parentNode.insertBefore(u,d):p.insertBefore(u,d):(p.nodeType===8?(d=p.parentNode,d.insertBefore(u,p)):(d=p,d.appendChild(u)),p=p._reactRootContainer,p!=null||d.onclick!==null||(d.onclick=v1));else if(w!==4&&(u=u.child,u!==null))for(F2(u,d,p),u=u.sibling;u!==null;)F2(u,d,p),u=u.sibling}function j2(u,d,p){var w=u.tag;if(w===5||w===6)u=u.stateNode,d?p.insertBefore(u,d):p.appendChild(u);else if(w!==4&&(u=u.child,u!==null))for(j2(u,d,p),u=u.sibling;u!==null;)j2(u,d,p),u=u.sibling}var Li=null,Za=!1;function Oc(u,d,p){for(p=p.child;p!==null;)l4(u,d,p),p=p.sibling}function l4(u,d,p){if(Gr&&typeof Gr.onCommitFiberUnmount=="function")try{Gr.onCommitFiberUnmount(qs,p)}catch{}switch(p.tag){case 5:Qi||pf(p,d);case 6:var w=Li,S=Za;Li=null,Oc(u,d,p),Li=w,Za=S,Li!==null&&(Za?(u=Li,p=p.stateNode,u.nodeType===8?u.parentNode.removeChild(p):u.removeChild(p)):Li.removeChild(p.stateNode));break;case 18:Li!==null&&(Za?(u=Li,p=p.stateNode,u.nodeType===8?ZE(u.parentNode,p):u.nodeType===1&&ZE(u,p),bc(u)):ZE(Li,p.stateNode));break;case 4:w=Li,S=Za,Li=p.stateNode.containerInfo,Za=!0,Oc(u,d,p),Li=w,Za=S;break;case 0:case 11:case 14:case 15:if(!Qi&&(w=p.updateQueue,w!==null&&(w=w.lastEffect,w!==null))){S=w=w.next;do{var k=S,G=k.destroy;k=k.tag,G!==void 0&&((k&2)!==0||(k&4)!==0)&&O2(p,d,G),S=S.next}while(S!==w)}Oc(u,d,p);break;case 1:if(!Qi&&(pf(p,d),w=p.stateNode,typeof w.componentWillUnmount=="function"))try{w.props=p.memoizedProps,w.state=p.memoizedState,w.componentWillUnmount()}catch(ae){Nr(p,d,ae)}Oc(u,d,p);break;case 21:Oc(u,d,p);break;case 22:p.mode&1?(Qi=(w=Qi)||p.memoizedState!==null,Oc(u,d,p),Qi=w):Oc(u,d,p);break;default:Oc(u,d,p)}}function c4(u){var d=u.updateQueue;if(d!==null){u.updateQueue=null;var p=u.stateNode;p===null&&(p=u.stateNode=new Oz),d.forEach(function(w){var S=Wz.bind(null,u,w);p.has(w)||(p.add(w),w.then(S,S))})}}function Ja(u,d){var p=d.deletions;if(p!==null)for(var w=0;w<p.length;w++){var S=p[w];try{var k=u,G=d,ae=G;e:for(;ae!==null;){switch(ae.tag){case 5:Li=ae.stateNode,Za=!1;break e;case 3:Li=ae.stateNode.containerInfo,Za=!0;break e;case 4:Li=ae.stateNode.containerInfo,Za=!0;break e}ae=ae.return}if(Li===null)throw Error(t(160));l4(k,G,S),Li=null,Za=!1;var oe=S.alternate;oe!==null&&(oe.return=null),S.return=null}catch(Re){Nr(S,d,Re)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)u4(d,u),d=d.sibling}function u4(u,d){var p=u.alternate,w=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(Ja(d,u),zo(u),w&4){try{Yg(3,u,u.return),U1(3,u)}catch(Ct){Nr(u,u.return,Ct)}try{Yg(5,u,u.return)}catch(Ct){Nr(u,u.return,Ct)}}break;case 1:Ja(d,u),zo(u),w&512&&p!==null&&pf(p,p.return);break;case 5:if(Ja(d,u),zo(u),w&512&&p!==null&&pf(p,p.return),u.flags&32){var S=u.stateNode;try{sn(S,"")}catch(Ct){Nr(u,u.return,Ct)}}if(w&4&&(S=u.stateNode,S!=null)){var k=u.memoizedProps,G=p!==null?p.memoizedProps:k,ae=u.type,oe=u.updateQueue;if(u.updateQueue=null,oe!==null)try{ae==="input"&&k.type==="radio"&&k.name!=null&&rn(S,k),je(ae,G);var Re=je(ae,k);for(G=0;G<oe.length;G+=2){var Ke=oe[G],Ze=oe[G+1];Ke==="style"?oi(S,Ze):Ke==="dangerouslySetInnerHTML"?Et(S,Ze):Ke==="children"?sn(S,Ze):R(S,Ke,Ze,Re)}switch(ae){case"input":ht(S,k);break;case"textarea":Sr(S,k);break;case"select":var $e=S._wrapperState.wasMultiple;S._wrapperState.wasMultiple=!!k.multiple;var vt=k.value;vt!=null?ir(S,!!k.multiple,vt,!1):$e!==!!k.multiple&&(k.defaultValue!=null?ir(S,!!k.multiple,k.defaultValue,!0):ir(S,!!k.multiple,k.multiple?[]:"",!1))}S[Vg]=k}catch(Ct){Nr(u,u.return,Ct)}}break;case 6:if(Ja(d,u),zo(u),w&4){if(u.stateNode===null)throw Error(t(162));S=u.stateNode,k=u.memoizedProps;try{S.nodeValue=k}catch(Ct){Nr(u,u.return,Ct)}}break;case 3:if(Ja(d,u),zo(u),w&4&&p!==null&&p.memoizedState.isDehydrated)try{bc(d.containerInfo)}catch(Ct){Nr(u,u.return,Ct)}break;case 4:Ja(d,u),zo(u);break;case 13:Ja(d,u),zo(u),S=u.child,S.flags&8192&&(k=S.memoizedState!==null,S.stateNode.isHidden=k,!k||S.alternate!==null&&S.alternate.memoizedState!==null||(G2=Ye())),w&4&&c4(u);break;case 22:if(Ke=p!==null&&p.memoizedState!==null,u.mode&1?(Qi=(Re=Qi)||Ke,Ja(d,u),Qi=Re):Ja(d,u),zo(u),w&8192){if(Re=u.memoizedState!==null,(u.stateNode.isHidden=Re)&&!Ke&&(u.mode&1)!==0)for(wt=u,Ke=u.child;Ke!==null;){for(Ze=wt=Ke;wt!==null;){switch($e=wt,vt=$e.child,$e.tag){case 0:case 11:case 14:case 15:Yg(4,$e,$e.return);break;case 1:pf($e,$e.return);var Rt=$e.stateNode;if(typeof Rt.componentWillUnmount=="function"){w=$e,p=$e.return;try{d=w,Rt.props=d.memoizedProps,Rt.state=d.memoizedState,Rt.componentWillUnmount()}catch(Ct){Nr(w,p,Ct)}}break;case 5:pf($e,$e.return);break;case 22:if($e.memoizedState!==null){f4(Ze);continue}}vt!==null?(vt.return=$e,wt=vt):f4(Ze)}Ke=Ke.sibling}e:for(Ke=null,Ze=u;;){if(Ze.tag===5){if(Ke===null){Ke=Ze;try{S=Ze.stateNode,Re?(k=S.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none"):(ae=Ze.stateNode,oe=Ze.memoizedProps.style,G=oe!=null&&oe.hasOwnProperty("display")?oe.display:null,ae.style.display=Mr("display",G))}catch(Ct){Nr(u,u.return,Ct)}}}else if(Ze.tag===6){if(Ke===null)try{Ze.stateNode.nodeValue=Re?"":Ze.memoizedProps}catch(Ct){Nr(u,u.return,Ct)}}else if((Ze.tag!==22&&Ze.tag!==23||Ze.memoizedState===null||Ze===u)&&Ze.child!==null){Ze.child.return=Ze,Ze=Ze.child;continue}if(Ze===u)break e;for(;Ze.sibling===null;){if(Ze.return===null||Ze.return===u)break e;Ke===Ze&&(Ke=null),Ze=Ze.return}Ke===Ze&&(Ke=null),Ze.sibling.return=Ze.return,Ze=Ze.sibling}}break;case 19:Ja(d,u),zo(u),w&4&&c4(u);break;case 21:break;default:Ja(d,u),zo(u)}}function zo(u){var d=u.flags;if(d&2){try{e:{for(var p=u.return;p!==null;){if(a4(p)){var w=p;break e}p=p.return}throw Error(t(160))}switch(w.tag){case 5:var S=w.stateNode;w.flags&32&&(sn(S,""),w.flags&=-33);var k=o4(u);j2(u,k,S);break;case 3:case 4:var G=w.stateNode.containerInfo,ae=o4(u);F2(u,ae,G);break;default:throw Error(t(161))}}catch(oe){Nr(u,u.return,oe)}u.flags&=-3}d&4096&&(u.flags&=-4097)}function Fz(u,d,p){wt=u,h4(u)}function h4(u,d,p){for(var w=(u.mode&1)!==0;wt!==null;){var S=wt,k=S.child;if(S.tag===22&&w){var G=S.memoizedState!==null||z1;if(!G){var ae=S.alternate,oe=ae!==null&&ae.memoizedState!==null||Qi;ae=z1;var Re=Qi;if(z1=G,(Qi=oe)&&!Re)for(wt=S;wt!==null;)G=wt,oe=G.child,G.tag===22&&G.memoizedState!==null?g4(S):oe!==null?(oe.return=G,wt=oe):g4(S);for(;k!==null;)wt=k,h4(k),k=k.sibling;wt=S,z1=ae,Qi=Re}d4(u)}else(S.subtreeFlags&8772)!==0&&k!==null?(k.return=S,wt=k):d4(u)}}function d4(u){for(;wt!==null;){var d=wt;if((d.flags&8772)!==0){var p=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Qi||U1(5,d);break;case 1:var w=d.stateNode;if(d.flags&4&&!Qi)if(p===null)w.componentDidMount();else{var S=d.elementType===d.type?p.memoizedProps:Ya(d.type,p.memoizedProps);w.componentDidUpdate(S,p.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var k=d.updateQueue;k!==null&&fP(d,k,w);break;case 3:var G=d.updateQueue;if(G!==null){if(p=null,d.child!==null)switch(d.child.tag){case 5:p=d.child.stateNode;break;case 1:p=d.child.stateNode}fP(d,G,p)}break;case 5:var ae=d.stateNode;if(p===null&&d.flags&4){p=ae;var oe=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":oe.autoFocus&&p.focus();break;case"img":oe.src&&(p.src=oe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var Re=d.alternate;if(Re!==null){var Ke=Re.memoizedState;if(Ke!==null){var Ze=Ke.dehydrated;Ze!==null&&bc(Ze)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Qi||d.flags&512&&D2(d)}catch($e){Nr(d,d.return,$e)}}if(d===u){wt=null;break}if(p=d.sibling,p!==null){p.return=d.return,wt=p;break}wt=d.return}}function f4(u){for(;wt!==null;){var d=wt;if(d===u){wt=null;break}var p=d.sibling;if(p!==null){p.return=d.return,wt=p;break}wt=d.return}}function g4(u){for(;wt!==null;){var d=wt;try{switch(d.tag){case 0:case 11:case 15:var p=d.return;try{U1(4,d)}catch(oe){Nr(d,p,oe)}break;case 1:var w=d.stateNode;if(typeof w.componentDidMount=="function"){var S=d.return;try{w.componentDidMount()}catch(oe){Nr(d,S,oe)}}var k=d.return;try{D2(d)}catch(oe){Nr(d,k,oe)}break;case 5:var G=d.return;try{D2(d)}catch(oe){Nr(d,G,oe)}}}catch(oe){Nr(d,d.return,oe)}if(d===u){wt=null;break}var ae=d.sibling;if(ae!==null){ae.return=d.return,wt=ae;break}wt=d.return}}var jz=Math.ceil,$1=N.ReactCurrentDispatcher,V2=N.ReactCurrentOwner,Sa=N.ReactCurrentBatchConfig,An=0,_i=null,Xr=null,Oi=0,na=0,yf=Cc(0),ci=0,Zg=null,fh=0,W1=0,B2=0,Jg=null,Is=null,G2=0,xf=1/0,Ml=null,H1=!1,z2=null,Dc=null,K1=!1,Fc=null,X1=0,Qg=0,U2=null,q1=-1,Y1=0;function ms(){return(An&6)!==0?Ye():q1!==-1?q1:q1=Ye()}function jc(u){return(u.mode&1)===0?1:(An&2)!==0&&Oi!==0?Oi&-Oi:wz.transition!==null?(Y1===0&&(Y1=vg()),Y1):(u=vn,u!==0||(u=window.event,u=u===void 0?16:Hd(u.type)),u)}function Qa(u,d,p,w){if(50<Qg)throw Qg=0,U2=null,Error(t(185));th(u,p,w),((An&2)===0||u!==_i)&&(u===_i&&((An&2)===0&&(W1|=p),ci===4&&Vc(u,Oi)),Cs(u,w),p===1&&An===0&&(d.mode&1)===0&&(xf=Ye()+500,T1&&Mc()))}function Cs(u,d){var p=u.callbackNode;eh(u,d);var w=_l(u,u===_i?Oi:0);if(w===0)p!==null&&rt(p),u.callbackNode=null,u.callbackPriority=0;else if(d=w&-w,u.callbackPriority!==d){if(p!=null&&rt(p),d===1)u.tag===0?vz(p4.bind(null,u)):tP(p4.bind(null,u)),pz(function(){(An&6)===0&&Mc()}),p=null;else{switch(Io(w)){case 1:p=Vn;break;case 4:p=$n;break;case 16:p=pr;break;case 536870912:p=ya;break;default:p=pr}p=T4(p,m4.bind(null,u))}u.callbackPriority=d,u.callbackNode=p}}function m4(u,d){if(q1=-1,Y1=0,(An&6)!==0)throw Error(t(327));var p=u.callbackNode;if(_f()&&u.callbackNode!==p)return null;var w=_l(u,u===_i?Oi:0);if(w===0)return null;if((w&30)!==0||(w&u.expiredLanes)!==0||d)d=Z1(u,w);else{d=w;var S=An;An|=2;var k=x4();(_i!==u||Oi!==d)&&(Ml=null,xf=Ye()+500,mh(u,d));do try{Gz();break}catch(ae){y4(u,ae)}while(!0);o2(),$1.current=k,An=S,Xr!==null?d=0:(_i=null,Oi=0,d=ci)}if(d!==0){if(d===2&&(S=_g(u),S!==0&&(w=S,d=$2(u,S))),d===1)throw p=Zg,mh(u,0),Vc(u,w),Cs(u,Ye()),p;if(d===6)Vc(u,w);else{if(S=u.current.alternate,(w&30)===0&&!Vz(S)&&(d=Z1(u,w),d===2&&(k=_g(u),k!==0&&(w=k,d=$2(u,k))),d===1))throw p=Zg,mh(u,0),Vc(u,w),Cs(u,Ye()),p;switch(u.finishedWork=S,u.finishedLanes=w,d){case 0:case 1:throw Error(t(345));case 2:ph(u,Is,Ml);break;case 3:if(Vc(u,w),(w&130023424)===w&&(d=G2+500-Ye(),10<d)){if(_l(u,0)!==0)break;if(S=u.suspendedLanes,(S&w)!==w){ms(),u.pingedLanes|=u.suspendedLanes&S;break}u.timeoutHandle=YE(ph.bind(null,u,Is,Ml),d);break}ph(u,Is,Ml);break;case 4:if(Vc(u,w),(w&4194240)===w)break;for(d=u.eventTimes,S=-1;0<w;){var G=31-br(w);k=1<<G,G=d[G],G>S&&(S=G),w&=~k}if(w=S,w=Ye()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*jz(w/1960))-w,10<w){u.timeoutHandle=YE(ph.bind(null,u,Is,Ml),w);break}ph(u,Is,Ml);break;case 5:ph(u,Is,Ml);break;default:throw Error(t(329))}}}return Cs(u,Ye()),u.callbackNode===p?m4.bind(null,u):null}function $2(u,d){var p=Jg;return u.current.memoizedState.isDehydrated&&(mh(u,d).flags|=256),u=Z1(u,d),u!==2&&(d=Is,Is=p,d!==null&&W2(d)),u}function W2(u){Is===null?Is=u:Is.push.apply(Is,u)}function Vz(u){for(var d=u;;){if(d.flags&16384){var p=d.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var w=0;w<p.length;w++){var S=p[w],k=S.getSnapshot;S=S.value;try{if(!Xa(k(),S))return!1}catch{return!1}}}if(p=d.child,d.subtreeFlags&16384&&p!==null)p.return=d,d=p;else{if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Vc(u,d){for(d&=~B2,d&=~W1,u.suspendedLanes|=d,u.pingedLanes&=~d,u=u.expirationTimes;0<d;){var p=31-br(d),w=1<<p;u[p]=-1,d&=~w}}function p4(u){if((An&6)!==0)throw Error(t(327));_f();var d=_l(u,0);if((d&1)===0)return Cs(u,Ye()),null;var p=Z1(u,d);if(u.tag!==0&&p===2){var w=_g(u);w!==0&&(d=w,p=$2(u,w))}if(p===1)throw p=Zg,mh(u,0),Vc(u,d),Cs(u,Ye()),p;if(p===6)throw Error(t(345));return u.finishedWork=u.current.alternate,u.finishedLanes=d,ph(u,Is,Ml),Cs(u,Ye()),null}function H2(u,d){var p=An;An|=1;try{return u(d)}finally{An=p,An===0&&(xf=Ye()+500,T1&&Mc())}}function gh(u){Fc!==null&&Fc.tag===0&&(An&6)===0&&_f();var d=An;An|=1;var p=Sa.transition,w=vn;try{if(Sa.transition=null,vn=1,u)return u()}finally{vn=w,Sa.transition=p,An=d,(An&6)===0&&Mc()}}function K2(){na=yf.current,dr(yf)}function mh(u,d){u.finishedWork=null,u.finishedLanes=0;var p=u.timeoutHandle;if(p!==-1&&(u.timeoutHandle=-1,mz(p)),Xr!==null)for(p=Xr.return;p!==null;){var w=p;switch(n2(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&E1();break;case 3:gf(),dr(Rs),dr(Yi),m2();break;case 5:f2(w);break;case 4:gf();break;case 13:dr(Rr);break;case 19:dr(Rr);break;case 10:l2(w.type._context);break;case 22:case 23:K2()}p=p.return}if(_i=u,Xr=u=Bc(u.current,null),Oi=na=d,ci=0,Zg=null,B2=W1=fh=0,Is=Jg=null,uh!==null){for(d=0;d<uh.length;d++)if(p=uh[d],w=p.interleaved,w!==null){p.interleaved=null;var S=w.next,k=p.pending;if(k!==null){var G=k.next;k.next=S,w.next=G}p.pending=w}uh=null}return u}function y4(u,d){do{var p=Xr;try{if(o2(),L1.current=j1,O1){for(var w=Ar.memoizedState;w!==null;){var S=w.queue;S!==null&&(S.pending=null),w=w.next}O1=!1}if(dh=0,xi=li=Ar=null,Wg=!1,Hg=0,V2.current=null,p===null||p.return===null){ci=1,Zg=d,Xr=null;break}e:{var k=u,G=p.return,ae=p,oe=d;if(d=Oi,ae.flags|=32768,oe!==null&&typeof oe=="object"&&typeof oe.then=="function"){var Re=oe,Ke=ae,Ze=Ke.tag;if((Ke.mode&1)===0&&(Ze===0||Ze===11||Ze===15)){var $e=Ke.alternate;$e?(Ke.updateQueue=$e.updateQueue,Ke.memoizedState=$e.memoizedState,Ke.lanes=$e.lanes):(Ke.updateQueue=null,Ke.memoizedState=null)}var vt=zP(G);if(vt!==null){vt.flags&=-257,UP(vt,G,ae,k,d),vt.mode&1&&GP(k,Re,d),d=vt,oe=Re;var Rt=d.updateQueue;if(Rt===null){var Ct=new Set;Ct.add(oe),d.updateQueue=Ct}else Rt.add(oe);break e}else{if((d&1)===0){GP(k,Re,d),X2();break e}oe=Error(t(426))}}else if(yr&&ae.mode&1){var Ur=zP(G);if(Ur!==null){(Ur.flags&65536)===0&&(Ur.flags|=256),UP(Ur,G,ae,k,d),s2(mf(oe,ae));break e}}k=oe=mf(oe,ae),ci!==4&&(ci=2),Jg===null?Jg=[k]:Jg.push(k),k=G;do{switch(k.tag){case 3:k.flags|=65536,d&=-d,k.lanes|=d;var ge=VP(k,oe,d);dP(k,ge);break e;case 1:ae=oe;var le=k.type,we=k.stateNode;if((k.flags&128)===0&&(typeof le.getDerivedStateFromError=="function"||we!==null&&typeof we.componentDidCatch=="function"&&(Dc===null||!Dc.has(we)))){k.flags|=65536,d&=-d,k.lanes|=d;var nt=BP(k,ae,d);dP(k,nt);break e}}k=k.return}while(k!==null)}v4(p)}catch(Mt){d=Mt,Xr===p&&p!==null&&(Xr=p=p.return);continue}break}while(!0)}function x4(){var u=$1.current;return $1.current=j1,u===null?j1:u}function X2(){(ci===0||ci===3||ci===2)&&(ci=4),_i===null||(fh&268435455)===0&&(W1&268435455)===0||Vc(_i,Oi)}function Z1(u,d){var p=An;An|=2;var w=x4();(_i!==u||Oi!==d)&&(Ml=null,mh(u,d));do try{Bz();break}catch(S){y4(u,S)}while(!0);if(o2(),An=p,$1.current=w,Xr!==null)throw Error(t(261));return _i=null,Oi=0,ci}function Bz(){for(;Xr!==null;)_4(Xr)}function Gz(){for(;Xr!==null&&!pt();)_4(Xr)}function _4(u){var d=S4(u.alternate,u,na);u.memoizedProps=u.pendingProps,d===null?v4(u):Xr=d,V2.current=null}function v4(u){var d=u;do{var p=d.alternate;if(u=d.return,(d.flags&32768)===0){if(p=Nz(p,d,na),p!==null){Xr=p;return}}else{if(p=Lz(p,d),p!==null){p.flags&=32767,Xr=p;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{ci=6,Xr=null;return}}if(d=d.sibling,d!==null){Xr=d;return}Xr=d=u}while(d!==null);ci===0&&(ci=5)}function ph(u,d,p){var w=vn,S=Sa.transition;try{Sa.transition=null,vn=1,zz(u,d,p,w)}finally{Sa.transition=S,vn=w}return null}function zz(u,d,p,w){do _f();while(Fc!==null);if((An&6)!==0)throw Error(t(327));p=u.finishedWork;var S=u.finishedLanes;if(p===null)return null;if(u.finishedWork=null,u.finishedLanes=0,p===u.current)throw Error(t(177));u.callbackNode=null,u.callbackPriority=0;var k=p.lanes|p.childLanes;if(LE(u,k),u===_i&&(Xr=_i=null,Oi=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||K1||(K1=!0,T4(pr,function(){return _f(),null})),k=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||k){k=Sa.transition,Sa.transition=null;var G=vn;vn=1;var ae=An;An|=4,V2.current=null,Dz(u,p),u4(p,u),lz(XE),El=!!KE,XE=KE=null,u.current=p,Fz(p),qe(),An=ae,vn=G,Sa.transition=k}else u.current=p;if(K1&&(K1=!1,Fc=u,X1=S),k=u.pendingLanes,k===0&&(Dc=null),wc(p.stateNode),Cs(u,Ye()),d!==null)for(w=u.onRecoverableError,p=0;p<d.length;p++)S=d[p],w(S.value,{componentStack:S.stack,digest:S.digest});if(H1)throw H1=!1,u=z2,z2=null,u;return(X1&1)!==0&&u.tag!==0&&_f(),k=u.pendingLanes,(k&1)!==0?u===U2?Qg++:(Qg=0,U2=u):Qg=0,Mc(),null}function _f(){if(Fc!==null){var u=Io(X1),d=Sa.transition,p=vn;try{if(Sa.transition=null,vn=16>u?16:u,Fc===null)var w=!1;else{if(u=Fc,Fc=null,X1=0,(An&6)!==0)throw Error(t(331));var S=An;for(An|=4,wt=u.current;wt!==null;){var k=wt,G=k.child;if((wt.flags&16)!==0){var ae=k.deletions;if(ae!==null){for(var oe=0;oe<ae.length;oe++){var Re=ae[oe];for(wt=Re;wt!==null;){var Ke=wt;switch(Ke.tag){case 0:case 11:case 15:Yg(8,Ke,k)}var Ze=Ke.child;if(Ze!==null)Ze.return=Ke,wt=Ze;else for(;wt!==null;){Ke=wt;var $e=Ke.sibling,vt=Ke.return;if(s4(Ke),Ke===Re){wt=null;break}if($e!==null){$e.return=vt,wt=$e;break}wt=vt}}}var Rt=k.alternate;if(Rt!==null){var Ct=Rt.child;if(Ct!==null){Rt.child=null;do{var Ur=Ct.sibling;Ct.sibling=null,Ct=Ur}while(Ct!==null)}}wt=k}}if((k.subtreeFlags&2064)!==0&&G!==null)G.return=k,wt=G;else e:for(;wt!==null;){if(k=wt,(k.flags&2048)!==0)switch(k.tag){case 0:case 11:case 15:Yg(9,k,k.return)}var ge=k.sibling;if(ge!==null){ge.return=k.return,wt=ge;break e}wt=k.return}}var le=u.current;for(wt=le;wt!==null;){G=wt;var we=G.child;if((G.subtreeFlags&2064)!==0&&we!==null)we.return=G,wt=we;else e:for(G=le;wt!==null;){if(ae=wt,(ae.flags&2048)!==0)try{switch(ae.tag){case 0:case 11:case 15:U1(9,ae)}}catch(Mt){Nr(ae,ae.return,Mt)}if(ae===G){wt=null;break e}var nt=ae.sibling;if(nt!==null){nt.return=ae.return,wt=nt;break e}wt=ae.return}}if(An=S,Mc(),Gr&&typeof Gr.onPostCommitFiberRoot=="function")try{Gr.onPostCommitFiberRoot(qs,u)}catch{}w=!0}return w}finally{vn=p,Sa.transition=d}}return!1}function w4(u,d,p){d=mf(p,d),d=VP(u,d,1),u=Lc(u,d,1),d=ms(),u!==null&&(th(u,1,d),Cs(u,d))}function Nr(u,d,p){if(u.tag===3)w4(u,u,p);else for(;d!==null;){if(d.tag===3){w4(d,u,p);break}else if(d.tag===1){var w=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Dc===null||!Dc.has(w))){u=mf(p,u),u=BP(d,u,1),d=Lc(d,u,1),u=ms(),d!==null&&(th(d,1,u),Cs(d,u));break}}d=d.return}}function Uz(u,d,p){var w=u.pingCache;w!==null&&w.delete(d),d=ms(),u.pingedLanes|=u.suspendedLanes&p,_i===u&&(Oi&p)===p&&(ci===4||ci===3&&(Oi&130023424)===Oi&&500>Ye()-G2?mh(u,0):B2|=p),Cs(u,d)}function E4(u,d){d===0&&((u.mode&1)===0?d=1:(d=Ec,Ec<<=1,(Ec&130023424)===0&&(Ec=4194304)));var p=ms();u=Il(u,d),u!==null&&(th(u,d,p),Cs(u,p))}function $z(u){var d=u.memoizedState,p=0;d!==null&&(p=d.retryLane),E4(u,p)}function Wz(u,d){var p=0;switch(u.tag){case 13:var w=u.stateNode,S=u.memoizedState;S!==null&&(p=S.retryLane);break;case 19:w=u.stateNode;break;default:throw Error(t(314))}w!==null&&w.delete(d),E4(u,p)}var S4;S4=function(u,d,p){if(u!==null)if(u.memoizedProps!==d.pendingProps||Rs.current)ks=!0;else{if((u.lanes&p)===0&&(d.flags&128)===0)return ks=!1,Mz(u,d,p);ks=(u.flags&131072)!==0}else ks=!1,yr&&(d.flags&1048576)!==0&&nP(d,R1,d.index);switch(d.lanes=0,d.tag){case 2:var w=d.type;G1(u,d),u=d.pendingProps;var S=of(d,Yi.current);ff(d,p),S=x2(null,d,w,u,S,p);var k=_2();return d.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,As(w)?(k=!0,S1(d)):k=!1,d.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,h2(d),S.updater=V1,d.stateNode=S,S._reactInternals=d,b2(d,w,u,p),d=I2(null,d,w,!0,k,p)):(d.tag=0,yr&&k&&t2(d),gs(null,d,S,p),d=d.child),d;case 16:w=d.elementType;e:{switch(G1(u,d),u=d.pendingProps,S=w._init,w=S(w._payload),d.type=w,S=d.tag=Kz(w),u=Ya(w,u),S){case 0:d=k2(null,d,w,u,p);break e;case 1:d=qP(null,d,w,u,p);break e;case 11:d=$P(null,d,w,u,p);break e;case 14:d=WP(null,d,w,Ya(w.type,u),p);break e}throw Error(t(306,w,""))}return d;case 0:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:Ya(w,S),k2(u,d,w,S,p);case 1:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:Ya(w,S),qP(u,d,w,S,p);case 3:e:{if(YP(d),u===null)throw Error(t(387));w=d.pendingProps,k=d.memoizedState,S=k.element,hP(u,d),M1(d,w,null,p);var G=d.memoizedState;if(w=G.element,k.isDehydrated)if(k={element:w,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},d.updateQueue.baseState=k,d.memoizedState=k,d.flags&256){S=mf(Error(t(423)),d),d=ZP(u,d,w,p,S);break e}else if(w!==S){S=mf(Error(t(424)),d),d=ZP(u,d,w,p,S);break e}else for(ta=Ic(d.stateNode.containerInfo.firstChild),ea=d,yr=!0,qa=null,p=cP(d,null,w,p),d.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(uf(),w===S){d=Pl(u,d,p);break e}gs(u,d,w,p)}d=d.child}return d;case 5:return gP(d),u===null&&i2(d),w=d.type,S=d.pendingProps,k=u!==null?u.memoizedProps:null,G=S.children,qE(w,S)?G=null:k!==null&&qE(w,k)&&(d.flags|=32),XP(u,d),gs(u,d,G,p),d.child;case 6:return u===null&&i2(d),null;case 13:return JP(u,d,p);case 4:return d2(d,d.stateNode.containerInfo),w=d.pendingProps,u===null?d.child=hf(d,null,w,p):gs(u,d,w,p),d.child;case 11:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:Ya(w,S),$P(u,d,w,S,p);case 7:return gs(u,d,d.pendingProps,p),d.child;case 8:return gs(u,d,d.pendingProps.children,p),d.child;case 12:return gs(u,d,d.pendingProps.children,p),d.child;case 10:e:{if(w=d.type._context,S=d.pendingProps,k=d.memoizedProps,G=S.value,lr(I1,w._currentValue),w._currentValue=G,k!==null)if(Xa(k.value,G)){if(k.children===S.children&&!Rs.current){d=Pl(u,d,p);break e}}else for(k=d.child,k!==null&&(k.return=d);k!==null;){var ae=k.dependencies;if(ae!==null){G=k.child;for(var oe=ae.firstContext;oe!==null;){if(oe.context===w){if(k.tag===1){oe=Cl(-1,p&-p),oe.tag=2;var Re=k.updateQueue;if(Re!==null){Re=Re.shared;var Ke=Re.pending;Ke===null?oe.next=oe:(oe.next=Ke.next,Ke.next=oe),Re.pending=oe}}k.lanes|=p,oe=k.alternate,oe!==null&&(oe.lanes|=p),c2(k.return,p,d),ae.lanes|=p;break}oe=oe.next}}else if(k.tag===10)G=k.type===d.type?null:k.child;else if(k.tag===18){if(G=k.return,G===null)throw Error(t(341));G.lanes|=p,ae=G.alternate,ae!==null&&(ae.lanes|=p),c2(G,p,d),G=k.sibling}else G=k.child;if(G!==null)G.return=k;else for(G=k;G!==null;){if(G===d){G=null;break}if(k=G.sibling,k!==null){k.return=G.return,G=k;break}G=G.return}k=G}gs(u,d,S.children,p),d=d.child}return d;case 9:return S=d.type,w=d.pendingProps.children,ff(d,p),S=wa(S),w=w(S),d.flags|=1,gs(u,d,w,p),d.child;case 14:return w=d.type,S=Ya(w,d.pendingProps),S=Ya(w.type,S),WP(u,d,w,S,p);case 15:return HP(u,d,d.type,d.pendingProps,p);case 17:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:Ya(w,S),G1(u,d),d.tag=1,As(w)?(u=!0,S1(d)):u=!1,ff(d,p),FP(d,w,S),b2(d,w,S,p),I2(null,d,w,!0,u,p);case 19:return e4(u,d,p);case 22:return KP(u,d,p)}throw Error(t(156,d.tag))};function T4(u,d){return Xe(u,d)}function Hz(u,d,p,w){this.tag=u,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ta(u,d,p,w){return new Hz(u,d,p,w)}function q2(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Kz(u){if(typeof u=="function")return q2(u)?1:0;if(u!=null){if(u=u.$$typeof,u===z)return 11;if(u===Ce)return 14}return 2}function Bc(u,d){var p=u.alternate;return p===null?(p=Ta(u.tag,d,u.key,u.mode),p.elementType=u.elementType,p.type=u.type,p.stateNode=u.stateNode,p.alternate=u,u.alternate=p):(p.pendingProps=d,p.type=u.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=u.flags&14680064,p.childLanes=u.childLanes,p.lanes=u.lanes,p.child=u.child,p.memoizedProps=u.memoizedProps,p.memoizedState=u.memoizedState,p.updateQueue=u.updateQueue,d=u.dependencies,p.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},p.sibling=u.sibling,p.index=u.index,p.ref=u.ref,p}function J1(u,d,p,w,S,k){var G=2;if(w=u,typeof u=="function")q2(u)&&(G=1);else if(typeof u=="string")G=5;else e:switch(u){case I:return yh(p.children,S,k,d);case A:G=8,S|=8;break;case M:return u=Ta(12,p,d,S|2),u.elementType=M,u.lanes=k,u;case j:return u=Ta(13,p,d,S),u.elementType=j,u.lanes=k,u;case Ee:return u=Ta(19,p,d,S),u.elementType=Ee,u.lanes=k,u;case Le:return Q1(p,S,k,d);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case O:G=10;break e;case L:G=9;break e;case z:G=11;break e;case Ce:G=14;break e;case Ge:G=16,w=null;break e}throw Error(t(130,u==null?u:typeof u,""))}return d=Ta(G,p,d,S),d.elementType=u,d.type=w,d.lanes=k,d}function yh(u,d,p,w){return u=Ta(7,u,w,d),u.lanes=p,u}function Q1(u,d,p,w){return u=Ta(22,u,w,d),u.elementType=Le,u.lanes=p,u.stateNode={isHidden:!1},u}function Y2(u,d,p){return u=Ta(6,u,null,d),u.lanes=p,u}function Z2(u,d,p){return d=Ta(4,u.children!==null?u.children:[],u.key,d),d.lanes=p,d.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},d}function Xz(u,d,p,w,S){this.tag=d,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wg(0),this.expirationTimes=wg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wg(0),this.identifierPrefix=w,this.onRecoverableError=S,this.mutableSourceEagerHydrationData=null}function J2(u,d,p,w,S,k,G,ae,oe){return u=new Xz(u,d,p,ae,oe),d===1?(d=1,k===!0&&(d|=8)):d=0,k=Ta(3,null,null,d),u.current=k,k.stateNode=u,k.memoizedState={element:w,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},h2(k),u}function qz(u,d,p){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:W,key:w==null?null:""+w,children:u,containerInfo:d,implementation:p}}function b4(u){if(!u)return Pc;u=u._reactInternals;e:{if(Q(u)!==u||u.tag!==1)throw Error(t(170));var d=u;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(As(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(u.tag===1){var p=u.type;if(As(p))return QC(u,p,d)}return d}function R4(u,d,p,w,S,k,G,ae,oe){return u=J2(p,w,!0,u,S,k,G,ae,oe),u.context=b4(null),p=u.current,w=ms(),S=jc(p),k=Cl(w,S),k.callback=d??null,Lc(p,k,S),u.current.lanes=S,th(u,S,w),Cs(u,w),u}function ex(u,d,p,w){var S=d.current,k=ms(),G=jc(S);return p=b4(p),d.context===null?d.context=p:d.pendingContext=p,d=Cl(k,G),d.payload={element:u},w=w===void 0?null:w,w!==null&&(d.callback=w),u=Lc(S,d,G),u!==null&&(Qa(u,S,G,k),P1(u,S,G)),G}function tx(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function A4(u,d){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var p=u.retryLane;u.retryLane=p!==0&&p<d?p:d}}function Q2(u,d){A4(u,d),(u=u.alternate)&&A4(u,d)}function Yz(){return null}var k4=typeof reportError=="function"?reportError:function(u){console.error(u)};function eS(u){this._internalRoot=u}nx.prototype.render=eS.prototype.render=function(u){var d=this._internalRoot;if(d===null)throw Error(t(409));ex(u,d,null,null)},nx.prototype.unmount=eS.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var d=u.containerInfo;gh(function(){ex(null,u,null,null)}),d[bl]=null}};function nx(u){this._internalRoot=u}nx.prototype.unstable_scheduleHydration=function(u){if(u){var d=bg();u={blockedOn:null,target:u,priority:d};for(var p=0;p<Ys.length&&d!==0&&d<Ys[p].priority;p++);Ys.splice(p,0,u),p===0&&$d(u)}};function tS(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function rx(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function I4(){}function Zz(u,d,p,w,S){if(S){if(typeof w=="function"){var k=w;w=function(){var Re=tx(G);k.call(Re)}}var G=R4(d,w,u,0,null,!1,!1,"",I4);return u._reactRootContainer=G,u[bl]=G.current,Fg(u.nodeType===8?u.parentNode:u),gh(),G}for(;S=u.lastChild;)u.removeChild(S);if(typeof w=="function"){var ae=w;w=function(){var Re=tx(oe);ae.call(Re)}}var oe=J2(u,0,!1,null,null,!1,!1,"",I4);return u._reactRootContainer=oe,u[bl]=oe.current,Fg(u.nodeType===8?u.parentNode:u),gh(function(){ex(d,oe,p,w)}),oe}function ix(u,d,p,w,S){var k=p._reactRootContainer;if(k){var G=k;if(typeof S=="function"){var ae=S;S=function(){var oe=tx(G);ae.call(oe)}}ex(d,G,u,S)}else G=Zz(p,d,u,S,w);return tx(G)}Sg=function(u){switch(u.tag){case 3:var d=u.stateNode;if(d.current.memoizedState.isDehydrated){var p=Mn(d.pendingLanes);p!==0&&(Eg(d,p|1),Cs(d,Ye()),(An&6)===0&&(xf=Ye()+500,Mc()))}break;case 13:gh(function(){var w=Il(u,1);if(w!==null){var S=ms();Qa(w,u,1,S)}}),Q2(u,1)}},zd=function(u){if(u.tag===13){var d=Il(u,134217728);if(d!==null){var p=ms();Qa(d,u,134217728,p)}Q2(u,134217728)}},Tg=function(u){if(u.tag===13){var d=jc(u),p=Il(u,d);if(p!==null){var w=ms();Qa(p,u,d,w)}Q2(u,d)}},bg=function(){return vn},Rg=function(u,d){var p=vn;try{return vn=u,d()}finally{vn=p}},Ot=function(u,d,p){switch(d){case"input":if(ht(u,p),d=p.name,p.type==="radio"&&d!=null){for(p=u;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<p.length;d++){var w=p[d];if(w!==u&&w.form===u.form){var S=w1(w);if(!S)throw Error(t(90));It(w),ht(w,S)}}}break;case"textarea":Sr(u,p);break;case"select":d=p.value,d!=null&&ir(u,!!p.multiple,d,!1)}},ne=H2,ue=gh;var Jz={usingClientEntryPoint:!1,Events:[Bg,sf,w1,re,ee,H2]},em={findFiberByHostInstance:ah,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Qz={bundleType:em.bundleType,version:em.version,rendererPackageName:em.rendererPackageName,rendererConfig:em.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=Se(u),u===null?null:u.stateNode},findFiberByHostInstance:em.findFiberByHostInstance||Yz,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sx.isDisabled&&sx.supportsFiber)try{qs=sx.inject(Qz),Gr=sx}catch{}}return Ps.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Jz,Ps.createPortal=function(u,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tS(d))throw Error(t(200));return qz(u,d,null,p)},Ps.createRoot=function(u,d){if(!tS(u))throw Error(t(299));var p=!1,w="",S=k4;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onRecoverableError!==void 0&&(S=d.onRecoverableError)),d=J2(u,1,!1,null,null,p,!1,w,S),u[bl]=d.current,Fg(u.nodeType===8?u.parentNode:u),new eS(d)},Ps.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var d=u._reactInternals;if(d===void 0)throw typeof u.render=="function"?Error(t(188)):(u=Object.keys(u).join(","),Error(t(268,u)));return u=Se(d),u=u===null?null:u.stateNode,u},Ps.flushSync=function(u){return gh(u)},Ps.hydrate=function(u,d,p){if(!rx(d))throw Error(t(200));return ix(null,u,d,!0,p)},Ps.hydrateRoot=function(u,d,p){if(!tS(u))throw Error(t(405));var w=p!=null&&p.hydratedSources||null,S=!1,k="",G=k4;if(p!=null&&(p.unstable_strictMode===!0&&(S=!0),p.identifierPrefix!==void 0&&(k=p.identifierPrefix),p.onRecoverableError!==void 0&&(G=p.onRecoverableError)),d=R4(d,null,u,1,p??null,S,!1,k,G),u[bl]=d.current,Fg(u),w)for(u=0;u<w.length;u++)p=w[u],S=p._getVersion,S=S(p._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[p,S]:d.mutableSourceEagerHydrationData.push(p,S);return new nx(d)},Ps.render=function(u,d,p){if(!rx(d))throw Error(t(200));return ix(null,u,d,!1,p)},Ps.unmountComponentAtNode=function(u){if(!rx(u))throw Error(t(40));return u._reactRootContainer?(gh(function(){ix(null,null,u,!1,function(){u._reactRootContainer=null,u[bl]=null})}),!0):!1},Ps.unstable_batchedUpdates=H2,Ps.unstable_renderSubtreeIntoContainer=function(u,d,p,w){if(!rx(p))throw Error(t(200));if(u==null||u._reactInternals===void 0)throw Error(t(38));return ix(u,d,p,!1,w)},Ps.version="18.3.1-next-f1338f8080-20240426",Ps}var F4;function oU(){if(F4)return iS.exports;F4=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),iS.exports=aU(),iS.exports}var j4;function lU(){if(j4)return ax;j4=1;var n=oU();return ax.createRoot=n.createRoot,ax.hydrateRoot=n.hydrateRoot,ax}var cU=lU();const uU=BR(cU);var X=oy();const hU=BR(X),Ls={ADD:"add",REMOVE:"remove"},A0={PROPERTYCHANGE:"propertychange"},Jt={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class ly{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function dU(n,e,t){let r,i;t=t||Hl;let s=0,a=n.length,o=!1;for(;s<a;)r=s+(a-s>>1),i=+t(n[r],e),i<0?s=r+1:(a=r,o=!i);return o?s:~s}function Hl(n,e){return n>e?1:n<e?-1:0}function fU(n,e){return n<e?1:n>e?-1:0}function uw(n,e,t){if(n[0]<=e)return 0;const r=n.length;if(e<=n[r-1])return r-1;if(typeof t=="function"){for(let i=1;i<r;++i){const s=n[i];if(s===e)return i;if(s<e)return t(e,n[i-1],s)>0?i-1:i}return r-1}if(t>0){for(let i=1;i<r;++i)if(n[i]<e)return i-1;return r-1}if(t<0){for(let i=1;i<r;++i)if(n[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(n[i]==e)return i;if(n[i]<e)return n[i-1]-e<e-n[i]?i-1:i}return r-1}function gU(n,e,t){for(;e<t;){const r=n[e];n[e]=n[t],n[t]=r,++e,--t}}function Bn(n,e){const t=Array.isArray(e)?e:[e],r=t.length;for(let i=0;i<r;i++)n[n.length]=t[i]}function hc(n,e){const t=n.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function mU(n,e,t){const r=e||Hl;return n.every(function(i,s){if(s===0)return!0;const a=r(n[s-1],i);return!(a>0||a===0)})}function dp(){return!0}function hw(){return!1}function fp(){}function tD(n){let e,t,r;return function(){const i=Array.prototype.slice.call(arguments);return(!t||this!==r||!hc(i,t))&&(r=this,t=i,e=n.apply(this,arguments)),e}}function nD(n){function e(){let t;try{t=n()}catch(r){return Promise.reject(r)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function ng(n){for(const e in n)delete n[e]}function td(n){let e;for(e in n)return!1;return!e}class ml{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let cy=class extends ly{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(t)||i.push(t)}dispatchEvent(e){const t=typeof e=="string",r=t?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const s=t?new ml(e):e;s.target||(s.target=this.eventTarget_||this);const a=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});r in a||(a[r]=0,o[r]=0),++a[r];let l;for(let c=0,h=i.length;c<h;++c)if("handleEvent"in i[c]?l=i[c].handleEvent(s):l=i[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--a[r]===0){let c=o[r];for(delete o[r];c--;)this.removeEventListener(r,fp);delete a[r]}return l}disposeInternal(){this.listeners_&&ng(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(t);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=fp,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}};function fn(n,e,t,r,i){if(i){const a=t;t=function(o){return n.removeEventListener(e,t),a.call(r??this,o)}}else r&&r!==n&&(t=t.bind(r));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function T_(n,e,t,r){return fn(n,e,t,r,!0)}function ar(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),ng(n))}class uy extends cy{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Jt.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=fn(this,e[s],t);return i}return fn(this,e,t)}onceInternal(e,t){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let s=0;s<i;++s)r[s]=T_(this,e[s],t)}else r=T_(this,e,t);return t.ol_key=r,r}unInternal(e,t){const r=t.ol_key;if(r)pU(r);else if(Array.isArray(e))for(let i=0,s=e.length;i<s;++i)this.removeEventListener(e[i],t);else this.removeEventListener(e,t)}}uy.prototype.on;uy.prototype.once;uy.prototype.un;function pU(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)ar(n[e]);else ar(n)}function $t(){throw new Error("Unimplemented abstract method.")}let yU=0;function Ut(n){return n.ol_uid||(n.ol_uid=String(++yU))}class V4 extends ml{constructor(e,t,r){super(e),this.key=t,this.oldValue=r}}class pl extends uy{constructor(e){super(),this.on,this.once,this.un,Ut(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new V4(r,e,t)),r=A0.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new V4(r,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,r){const i=this.values_||(this.values_={});if(r)i[e]=t;else{const s=i[e];i[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const r in e)this.set(r,e[r],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],td(this.values_)&&(this.values_=null),t||this.notify(e,r)}}}const B4={LENGTH:"length"};class ox extends ml{constructor(e,t,r){super(e),this.element=t,this.index=r}}class Ma extends pl{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,r=e.length;t<r;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)e(t[r],r,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(B4.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new ox(Ls.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)if(t[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new ox(Ls.REMOVE,t,e)),t}setAt(e,t){const r=this.getLength();if(e>=r){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const i=this.array_[e];this.array_[e]=t,this.dispatchEvent(new ox(Ls.REMOVE,i,e)),this.dispatchEvent(new ox(Ls.ADD,t,e))}updateLength_(){this.set(B4.LENGTH,this.array_.length)}assertUnique_(e,t){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===e&&i!==t)throw new Error("Duplicate item added to a unique collection")}}function Tn(n,e){if(!n)throw new Error(e)}let _r=class rD extends pl{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new rD(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(ar(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=fn(e,Jt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?xU(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function xU(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(Tn(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const wi={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function G4(n){const e=zs();for(let t=0,r=n.length;t<r;++t)Nm(e,n[t]);return e}function k0(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function iD(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function bd(n,e,t){let r,i;return e<n[0]?r=n[0]-e:n[2]<e?r=e-n[2]:r=0,t<n[1]?i=n[1]-t:n[3]<t?i=t-n[3]:i=0,r*r+i*i}function nd(n,e){return GR(n,e[0],e[1])}function ou(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function GR(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function $T(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=e[0],o=e[1];let l=wi.UNKNOWN;return a<t?l=l|wi.LEFT:a>i&&(l=l|wi.RIGHT),o<r?l=l|wi.BELOW:o>s&&(l=l|wi.ABOVE),l===wi.UNKNOWN&&(l=wi.INTERSECTING),l}function zs(){return[1/0,1/0,-1/0,-1/0]}function Iu(n,e,t,r,i){return i?(i[0]=n,i[1]=e,i[2]=t,i[3]=r,i):[n,e,t,r]}function hy(n){return Iu(1/0,1/0,-1/0,-1/0,n)}function sD(n,e){const t=n[0],r=n[1];return Iu(t,r,t,r,e)}function zR(n,e,t,r,i){const s=hy(i);return oD(s,n,e,t,r)}function rd(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function aD(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function Nm(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function oD(n,e,t,r,i){for(;t<r;t+=i)_U(n,e[t],e[t+1]);return n}function _U(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function lD(n,e){let t;return t=e(dw(n)),t||(t=e(fw(n)),t)||(t=e(gw(n)),t)||(t=e(Rd(n)),t)?t:!1}function WT(n){let e=0;return rg(n)||(e=gn(n)*Qr(n)),e}function dw(n){return[n[0],n[1]]}function fw(n){return[n[2],n[1]]}function cl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function vU(n,e){let t;if(e==="bottom-left")t=dw(n);else if(e==="bottom-right")t=fw(n);else if(e==="top-left")t=Rd(n);else if(e==="top-right")t=gw(n);else throw new Error("Invalid corner");return t}function b_(n,e,t,r,i){const[s,a,o,l,c,h,g,m]=cD(n,e,t,r);return Iu(Math.min(s,o,c,g),Math.min(a,l,h,m),Math.max(s,o,c,g),Math.max(a,l,h,m),i)}function cD(n,e,t,r){const i=e*r[0]/2,s=e*r[1]/2,a=Math.cos(t),o=Math.sin(t),l=i*a,c=i*o,h=s*a,g=s*o,m=n[0],y=n[1];return[m-l+g,y-c-h,m-l-g,y-c+h,m+l-g,y+c+h,m+l+g,y+c-h,m-l+g,y-c-h]}function Qr(n){return n[3]-n[1]}function Kl(n,e,t){const r=t||zs();return _s(n,e)?(n[0]>e[0]?r[0]=n[0]:r[0]=e[0],n[1]>e[1]?r[1]=n[1]:r[1]=e[1],n[2]<e[2]?r[2]=n[2]:r[2]=e[2],n[3]<e[3]?r[3]=n[3]:r[3]=e[3]):hy(r),r}function Rd(n){return[n[0],n[3]]}function gw(n){return[n[2],n[3]]}function gn(n){return n[2]-n[0]}function _s(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function rg(n){return n[2]<n[0]||n[3]<n[1]}function wU(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function EU(n,e,t){let r=!1;const i=$T(n,e),s=$T(n,t);if(i===wi.INTERSECTING||s===wi.INTERSECTING)r=!0;else{const a=n[0],o=n[1],l=n[2],c=n[3],h=e[0],g=e[1],m=t[0],y=t[1],v=(y-g)/(m-h);let _,E;s&wi.ABOVE&&!(i&wi.ABOVE)&&(_=m-(y-c)/v,r=_>=a&&_<=l),!r&&s&wi.RIGHT&&!(i&wi.RIGHT)&&(E=y-(m-l)*v,r=E>=o&&E<=c),!r&&s&wi.BELOW&&!(i&wi.BELOW)&&(_=m-(y-o)/v,r=_>=a&&_<=l),!r&&s&wi.LEFT&&!(i&wi.LEFT)&&(E=y-(m-a)*v,r=E>=o&&E<=c)}return r}function uD(n,e){const t=e.getExtent(),r=cl(n);if(e.canWrapX()&&(r[0]<t[0]||r[0]>=t[2])){const i=gn(t),a=Math.floor((r[0]-t[0])/i)*i;n[0]-=a,n[2]-=a}return n}function hD(n,e,t){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[r[0],n[1],r[2],n[3]]];uD(n,e);const i=gn(r);if(gn(n)>i&&!t)return[[r[0],n[1],r[2],n[3]]];if(n[0]<r[0])return[[n[0]+i,n[1],r[2],n[3]],[r[0],n[1],n[2],n[3]]];if(n[2]>r[2])return[[n[0],n[1],r[2],n[3]],[r[0],n[1],n[2]-i,n[3]]]}return[n]}function cr(n,e,t){return Math.min(Math.max(n,e),t)}function SU(n,e,t,r,i,s){const a=i-t,o=s-r;if(a!==0||o!==0){const l=((n-t)*a+(e-r)*o)/(a*a+o*o);l>1?(t=i,r=s):l>0&&(t+=a*l,r+=o*l)}return Kh(n,e,t,r)}function Kh(n,e,t,r){const i=t-n,s=r-e;return i*i+s*s}function TU(n){const e=n.length;for(let r=0;r<e;r++){let i=r,s=Math.abs(n[r][r]);for(let o=r+1;o<e;o++){const l=Math.abs(n[o][r]);l>s&&(s=l,i=o)}if(s===0)return null;const a=n[i];n[i]=n[r],n[r]=a;for(let o=r+1;o<e;o++){const l=-n[o][r]/n[r][r];for(let c=r;c<e+1;c++)r==c?n[o][c]=0:n[o][c]+=l*n[r][c]}}const t=new Array(e);for(let r=e-1;r>=0;r--){t[r]=n[r][e]/n[r][r];for(let i=r-1;i>=0;i--)n[i][e]-=n[i][r]*t[r]}return t}function z4(n){return n*180/Math.PI}function Xl(n){return n*Math.PI/180}function _u(n,e){const t=n%e;return t*e<0?t+e:t}function aa(n,e,t){return n+t*(e-n)}function dy(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function R_(n,e){return Math.round(dy(n,e))}function lx(n,e){return Math.floor(dy(n,e))}function lu(n,e){return Math.ceil(dy(n,e))}function HT(n,e,t){if(n>=e&&n<t)return n;const r=t-e;return((n-e)%r+r)%r+e}function nm(n,e,t){const r=""+n;let i=r.indexOf(".");return i=i===-1?r.length:i,i>e?r:new Array(1+e-i).join("0")+r}function dD(n,e){const t=(""+n).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(t.length,r.length);i++){const s=parseInt(t[i]||"0",10),a=parseInt(r[i]||"0",10);if(s>a)return 1;if(a>s)return-1}return 0}function bU(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function A_(n,e){let t=!0;for(let r=n.length-1;r>=0;--r)if(n[r]!=e[r]){t=!1;break}return t}function UR(n,e){const t=Math.cos(e),r=Math.sin(e),i=n[0]*t-n[1]*r,s=n[1]*t+n[0]*r;return n[0]=i,n[1]=s,n}function RU(n,e){return n[0]*=e,n[1]*=e,n}function fD(n,e){if(e.canWrapX()){const t=gn(e.getExtent()),r=gD(n,e,t);r&&(n[0]-=r*t)}return n}function gD(n,e,t){const r=e.getExtent();let i=0;return e.canWrapX()&&(n[0]<r[0]||n[0]>r[2])&&(t=t||gn(r),i=Math.floor((n[0]-r[0])/t)),i}function mD(...n){console.warn(...n)}const I0={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let mw=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||I0[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const fy=6378137,Jf=Math.PI*fy,AU=[-Jf,-Jf,Jf,Jf],kU=[-180,-85,180,85],cx=fy*Math.log(Math.tan(Math.PI/2));class vf extends mw{constructor(e){super({code:e,units:"m",extent:AU,global:!0,worldExtent:kU,getPointResolution:function(t,r){return t/Math.cosh(r[1]/fy)}})}}const U4=[new vf("EPSG:3857"),new vf("EPSG:102100"),new vf("EPSG:102113"),new vf("EPSG:900913"),new vf("http://www.opengis.net/def/crs/EPSG/0/3857"),new vf("http://www.opengis.net/gml/srs/epsg.xml#3857")];function IU(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r){e[s]=Jf*n[s]/180;let a=fy*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));a>cx?a=cx:a<-cx&&(a=-cx),e[s+1]=a}return e}function CU(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r)e[s]=180*n[s]/Jf,e[s+1]=360*Math.atan(Math.exp(n[s+1]/fy))/Math.PI-90;return e}const PU=6378137,$4=[-180,-90,180,90],MU=Math.PI*PU/180;class xh extends mw{constructor(e,t){super({code:e,units:"degrees",extent:$4,axisOrientation:t,global:!0,metersPerUnit:MU,worldExtent:$4})}}const W4=[new xh("CRS:84"),new xh("EPSG:4326","neu"),new xh("urn:ogc:def:crs:OGC:1.3:CRS84"),new xh("urn:ogc:def:crs:OGC:2:84"),new xh("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new xh("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new xh("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let KT={};function qx(n){return KT[n]||KT[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function NU(n,e){KT[n]=e}let u0={};function id(n,e,t){const r=n.getCode(),i=e.getCode();r in u0||(u0[r]={}),u0[r][i]=t}function Yx(n,e){return n in u0&&e in u0[n]?u0[n][e]:null}const k_=.9996,Da=.00669438,pw=Da*Da,yw=pw*Da,Fh=Da/(1-Da),H4=Math.sqrt(1-Da),C0=(1-H4)/(1+H4),pD=C0*C0,$R=pD*C0,WR=$R*C0,yD=WR*C0,xD=1-Da/4-3*pw/64-5*yw/256,LU=3*Da/8+3*pw/32+45*yw/1024,OU=15*pw/256+45*yw/1024,DU=35*yw/3072,FU=3/2*C0-27/32*$R+269/512*yD,jU=21/16*pD-55/32*WR,VU=151/96*$R-417/128*yD,BU=1097/512*WR,I_=6378137;function GU(n,e,t){const r=n-5e5,a=(t.north?e:e-1e7)/k_/(I_*xD),o=a+FU*Math.sin(2*a)+jU*Math.sin(4*a)+VU*Math.sin(6*a)+BU*Math.sin(8*a),l=Math.sin(o),c=l*l,h=Math.cos(o),g=l/h,m=g*g,y=m*m,v=1-Da*c,_=Math.sqrt(1-Da*c),E=I_/_,T=(1-Da)/v,b=Fh*h**2,R=b*b,N=r/(E*k_),D=N*N,W=D*N,I=W*N,A=I*N,M=A*N,O=o-g/T*(D/2-I/24*(5+3*m+10*b-4*R-9*Fh))+M/720*(61+90*m+298*b+45*y-252*Fh-3*R);let L=(N-W/6*(1+2*m+b)+A/120*(5-2*b+28*m-3*R+8*Fh+24*y))/h;return L=HT(L+Xl(_D(t.number)),-Math.PI,Math.PI),[z4(L),z4(O)]}const K4=-80,X4=84,zU=-180,UU=180;function $U(n,e,t){n=HT(n,zU,UU),e<K4?e=K4:e>X4&&(e=X4);const r=Xl(e),i=Math.sin(r),s=Math.cos(r),a=i/s,o=a*a,l=o*o,c=Xl(n),h=_D(t.number),g=Xl(h),m=I_/Math.sqrt(1-Da*i**2),y=Fh*s**2,v=s*HT(c-g,-Math.PI,Math.PI),_=v*v,E=_*v,T=E*v,b=T*v,R=b*v,N=I_*(xD*r-LU*Math.sin(2*r)+OU*Math.sin(4*r)-DU*Math.sin(6*r)),D=k_*m*(v+E/6*(1-o+y)+b/120*(5-18*o+l+72*y-58*Fh))+5e5;let W=k_*(N+m*a*(_/2+T/24*(5-o+9*y+4*y**2)+R/720*(61-58*o+l+600*y-330*Fh)));return t.north||(W+=1e7),[D,W]}function _D(n){return(n-1)*6-180+3}const WU=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function vD(n){let e=0;for(const i of WU){const s=n.match(i);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,r=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(r=!0,t=e-32600),t?{number:t,north:r}:null}function q4(n,e){return function(t,r,i,s){const a=t.length;i=i>1?i:2,s=s??i,r||(i>2?r=t.slice():r=new Array(a));for(let o=0;o<a;o+=s){const l=t[o],c=t[o+1],h=n(l,c,e);r[o]=h[0],r[o+1]=h[1]}return r}}function HU(n){return vD(n)?new mw({code:n,units:"m"}):null}function KU(n){const e=vD(n.getCode());return e?{forward:q4($U,e),inverse:q4(GU,e)}:null}const XU=63710088e-1;function Y4(n,e,t){t=t||XU;const r=Xl(n[1]),i=Xl(e[1]),s=(i-r)/2,a=Xl(e[0]-n[0])/2,o=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(i);return 2*t*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}const qU=[KU],YU=[HU];let XT=!0;function wD(n){XT=!1}function HR(n,e){if(e!==void 0){for(let t=0,r=n.length;t<r;++t)e[t]=n[t];e=e}else e=n.slice();return e}function C_(n){NU(n.getCode(),n),id(n,n,HR)}function ZU(n){n.forEach(C_)}function nr(n){if(typeof n!="string")return n;const e=qx(n);if(e)return e;for(const t of YU){const r=t(n);if(r)return r}return null}function P_(n,e,t,r){n=nr(n);let i;const s=n.getPointResolutionFunc();if(s){if(i=s(e,t),r&&r!==n.getUnits()){const a=n.getMetersPerUnit();a&&(i=i*a/I0[r])}}else{const a=n.getUnits();if(a=="degrees"&&!r||r=="degrees")i=e;else{const o=XR(n,nr("EPSG:4326"));if(!o&&a!=="degrees")i=e*n.getMetersPerUnit();else{let c=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];c=o(c,c,2);const h=Y4(c.slice(0,2),c.slice(2,4)),g=Y4(c.slice(4,6),c.slice(6,8));i=(h+g)/2}const l=r?I0[r]:n.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function qT(n){ZU(n),n.forEach(function(e){n.forEach(function(t){e!==t&&id(e,t,HR)})})}function JU(n,e,t,r){n.forEach(function(i){e.forEach(function(s){id(i,s,t),id(s,i,r)})})}function KR(n,e){return n?typeof n=="string"?nr(n):n:nr(e)}function YT(n){return(function(e,t,r,i){const s=e.length;r=r!==void 0?r:2,i=i??r,t=t!==void 0?t:new Array(s);for(let a=0;a<s;a+=i){const o=n(e.slice(a,a+r)),l=o.length;for(let c=0,h=i;c<h;++c)t[a+c]=c>=l?e[a+c]:o[c]}return t})}function QU(n,e,t,r){const i=nr(n),s=nr(e);id(i,s,YT(t)),id(s,i,YT(r))}function kr(n,e){return wD(),gy(n,"EPSG:4326","EPSG:3857")}function En(n,e){const t=gy(n,"EPSG:3857","EPSG:4326"),r=t[0];return(r<-180||r>180)&&(t[0]=_u(r+180,360)-180),t}function Xh(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||XR(n,e)===HR)&&t}function XR(n,e){const t=n.getCode(),r=e.getCode();let i=Yx(t,r);if(i)return i;let s=null,a=null;for(const l of qU)s||(s=l(n)),a||(a=l(e));if(!s&&!a)return null;const o="EPSG:4326";if(a)if(s)i=oS(s.inverse,a.forward);else{const l=Yx(t,o);l&&(i=oS(l,a.forward))}else{const l=Yx(o,r);l&&(i=oS(s.inverse,l))}return i&&(C_(n),C_(e),id(n,e,i)),i}function oS(n,e){return function(t,r,i,s){return r=n(t,r,i,s),e(r,r,i,s)}}function gp(n,e){const t=nr(n),r=nr(e);return XR(t,r)}function gy(n,e,t){const r=gp(e,t);if(!r){const i=nr(e).getCode(),s=nr(t).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return r(n,void 0,n.length)}function ZT(n,e){return n}function Fl(n,e){return XT&&!A_(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(XT=!1,mD("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function ED(n,e){return n}function Yo(n,e){return n}function Z4(n,e,t){return function(r){let i,s;if(n.canWrapX()){const a=n.getExtent(),o=gn(a);r=r.slice(0),s=gD(r,n,o),s&&(r[0]=r[0]-s*o),r[0]=cr(r[0],a[0],a[2]),r[1]=cr(r[1],a[1],a[3]),i=t(r)}else i=t(r);return s&&e.canWrapX()&&(i[0]+=s*gn(e.getExtent())),i}}function e$(){qT(U4),qT(W4),JU(W4,U4,IU,CU)}e$();const t$=new Array(6);function fi(){return[1,0,0,1,0,0]}function SD(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=n[4],o=n[5],l=e[0],c=e[1],h=e[2],g=e[3],m=e[4],y=e[5];return n[0]=t*l+i*c,n[1]=r*l+s*c,n[2]=t*h+i*g,n[3]=r*h+s*g,n[4]=t*m+i*y+a,n[5]=r*m+s*y+o,n}function n$(n,e,t,r,i,s,a){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n[4]=s,n[5]=a,n}function TD(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Fr(n,e){const t=e[0],r=e[1];return e[0]=n[0]*t+n[2]*r+n[4],e[1]=n[1]*t+n[3]*r+n[5],e}function r$(n,e,t){return SD(n,n$(t$,1,0,0,1,e,t))}function Va(n,e,t,r,i,s,a,o){const l=Math.sin(s),c=Math.cos(s);return n[0]=r*c,n[1]=i*l,n[2]=-r*l,n[3]=i*c,n[4]=a*r*c-o*r*l+e,n[5]=a*i*l+o*i*c+t,n}function mp(n,e){const t=i$(e);Tn(t!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=e[5];return n[0]=a/t,n[1]=-i/t,n[2]=-s/t,n[3]=r/t,n[4]=(s*l-a*o)/t,n[5]=-(r*l-i*o)/t,n}function i$(n){return n[0]*n[3]-n[1]*n[2]}const s$=[1e5,1e5,1e5,1e5,2,2];function a$(n){return"matrix("+n.join(", ")+")"}function JT(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function o$(n,e){const t=JT(n),r=JT(e);for(let i=0;i<6;++i)if(Math.round((t[i]-r[i])*s$[i])!==0)return!1;return!0}function el(n,e,t,r,i,s,a){s=s||[],a=a||2;let o=0;for(let l=e;l<t;l+=r){const c=n[l],h=n[l+1];s[o++]=i[0]*c+i[2]*h+i[4],s[o++]=i[1]*c+i[3]*h+i[5];for(let g=2;g<a;g++)s[o++]=n[l+g]}return s&&s.length!=o&&(s.length=o),s}function bD(n,e,t,r,i,s,a){a=a||[];const o=Math.cos(i),l=Math.sin(i),c=s[0],h=s[1];let g=0;for(let m=e;m<t;m+=r){const y=n[m]-c,v=n[m+1]-h;a[g++]=c+y*o-v*l,a[g++]=h+y*l+v*o;for(let _=m+2;_<m+r;++_)a[g++]=n[_]}return a&&a.length!=g&&(a.length=g),a}function l$(n,e,t,r,i,s,a,o){o=o||[];const l=a[0],c=a[1];let h=0;for(let g=e;g<t;g+=r){const m=n[g]-l,y=n[g+1]-c;o[h++]=l+i*m,o[h++]=c+s*y;for(let v=g+2;v<g+r;++v)o[h++]=n[v]}return o&&o.length!=h&&(o.length=h),o}function c$(n,e,t,r,i,s,a){a=a||[];let o=0;for(let l=e;l<t;l+=r){a[o++]=n[l]+i,a[o++]=n[l+1]+s;for(let c=l+2;c<l+r;++c)a[o++]=n[c]}return a&&a.length!=o&&(a.length=o),a}const J4=fi(),u$=[NaN,NaN];class RD extends pl{constructor(){super(),this.extent_=zs(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=tD((e,t,r)=>{if(!r)return this.getSimplifiedGeometry(t);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return $t()}closestPointXY(e,t,r,i){return $t()}containsXY(e,t){return this.closestPointXY(e,t,u$,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return $t()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&hy(t),this.extentRevision_=this.getRevision()}return wU(this.extent_,e)}rotate(e,t){$t()}scale(e,t,r){$t()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return $t()}getType(){return $t()}applyTransform(e){$t()}intersectsExtent(e){return $t()}translate(e,t){$t()}transform(e,t){const r=nr(e),i=r.getUnits()=="tile-pixels"?function(s,a,o){const l=r.getExtent(),c=r.getWorldExtent(),h=Qr(c)/Qr(l);Va(J4,c[0],c[3],h,-h,0,0,0);const g=el(s,0,s.length,o,J4,a),m=gp(r,t);return m?m(g,g,o):g}:gp(r,t);return this.applyTransform(i),this}}class Ad extends RD{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return zR(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return $t()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=Q4(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){$t()}setLayout(e,t,r){let i;if(e)i=Q4(e);else{for(let s=0;s<r;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}i=t.length,e=kd(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();bD(r,0,r.length,i,e,t,r),this.changed()}}scale(e,t,r){t===void 0&&(t=e),r||(r=cl(this.getExtent()));const i=this.getFlatCoordinates();if(i){const s=this.getStride();l$(i,0,i.length,s,e,t,r,i),this.changed()}}translate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();c$(r,0,r.length,i,e,t,r),this.changed()}}}function kd(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function Q4(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function h$(n,e,t){const r=n.getFlatCoordinates();if(!r)return null;const i=n.getStride();return el(r,0,r.length,i,e,t)}function eM(n,e,t,r,i,s,a){const o=n[e],l=n[e+1],c=n[t]-o,h=n[t+1]-l;let g;if(c===0&&h===0)g=e;else{const m=((i-o)*c+(s-l)*h)/(c*c+h*h);if(m>1)g=t;else if(m>0){for(let y=0;y<r;++y)a[y]=aa(n[e+y],n[t+y],m);a.length=r;return}else g=e}for(let m=0;m<r;++m)a[m]=n[g+m];a.length=r}function qR(n,e,t,r,i){let s=n[e],a=n[e+1];for(e+=r;e<t;e+=r){const o=n[e],l=n[e+1],c=Kh(s,a,o,l);c>i&&(i=c),s=o,a=l}return i}function YR(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=qR(n,e,o,r,i),e=o}return i}function d$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=YR(n,e,o,r,i),e=o[o.length-1]}return i}function ZR(n,e,t,r,i,s,a,o,l,c,h){if(e==t)return c;let g,m;if(i===0){if(m=Kh(a,o,n[e],n[e+1]),m<c){for(g=0;g<r;++g)l[g]=n[e+g];return l.length=r,m}return c}h=h||[NaN,NaN];let y=e+r;for(;y<t;)if(eM(n,y-r,y,r,a,o,h),m=Kh(a,o,h[0],h[1]),m<c){for(c=m,g=0;g<r;++g)l[g]=h[g];l.length=r,y+=r}else y+=r*Math.max((Math.sqrt(m)-Math.sqrt(c))/i|0,1);if(s&&(eM(n,t-r,e,r,a,o,h),m=Kh(a,o,h[0],h[1]),m<c)){for(c=m,g=0;g<r;++g)l[g]=h[g];l.length=r}return c}function JR(n,e,t,r,i,s,a,o,l,c,h){h=h||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const y=t[g];c=ZR(n,e,y,r,i,s,a,o,l,c,h),e=y}return c}function f$(n,e,t,r,i,s,a,o,l,c,h){h=h||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const y=t[g];c=JR(n,e,y,r,i,s,a,o,l,c,h),e=y[y.length-1]}return c}function g$(n,e,t,r){for(let i=0,s=t.length;i<s;++i)n[e++]=t[i];return e}function xw(n,e,t,r){for(let i=0,s=t.length;i<s;++i){const a=t[i];for(let o=0;o<r;++o)n[e++]=a[o]}return e}function my(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=xw(n,e,t[a],r);i[s++]=l,e=l}return i.length=s,i}function AD(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=my(n,e,t[a],r,i[s]);l.length===0&&(l[0]=e),i[s++]=l,e=l[l.length-1]}return i.length=s,i}function cu(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=e;a<t;a+=r)i[s++]=n.slice(a,a+r);return i.length=s,i}function pp(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=cu(n,e,l,r,i[s]),e=l}return i.length=s,i}function QT(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=l.length===1&&l[0]===e?[]:pp(n,e,l,r,i[s]),e=l[l.length-1]}return i.length=s,i}function M_(n,e,t,r,i,s,a){let o,l;const c=(t-e)/r;if(c===1)o=e;else if(c===2)o=e,l=i;else if(c!==0){let h=n[e],g=n[e+1],m=0;const y=[0];for(let E=e+r;E<t;E+=r){const T=n[E],b=n[E+1];m+=Math.sqrt((T-h)*(T-h)+(b-g)*(b-g)),y.push(m),h=T,g=b}const v=i*m,_=dU(y,v);_<0?(l=(v-y[-_-2])/(y[-_-1]-y[-_-2]),o=e+(-_-2)*r):o=e+_*r}a=a>1?a:2,s=s||new Array(a);for(let h=0;h<a;++h)s[h]=o===void 0?NaN:l===void 0?n[o+h]:aa(n[o+h],n[o+r+h],l);return s}function eb(n,e,t,r,i,s){if(t==e)return null;let a;if(i<n[e+r-1])return s?(a=n.slice(e,e+r),a[r-1]=i,a):null;if(n[t-1]<i)return s?(a=n.slice(t-r,t),a[r-1]=i,a):null;if(i==n[e+r-1])return n.slice(e,e+r);let o=e/r,l=t/r;for(;o<l;){const m=o+l>>1;i<n[(m+1)*r-1]?l=m:o=m+1}const c=n[o*r-1];if(i==c)return n.slice((o-1)*r,(o-1)*r+r);const h=n[(o+1)*r-1],g=(i-c)/(h-c);a=[];for(let m=0;m<r-1;++m)a.push(aa(n[(o-1)*r+m],n[o*r+m],g));return a.push(i),a}function m$(n,e,t,r,i,s,a){if(a)return eb(n,e,t[t.length-1],r,i,s);let o;if(i<n[r-1])return s?(o=n.slice(0,r),o[r-1]=i,o):null;if(n[n.length-1]<i)return s?(o=n.slice(n.length-r),o[r-1]=i,o):null;for(let l=0,c=t.length;l<c;++l){const h=t[l];if(e!=h){if(i<n[e+r-1])return null;if(i<=n[h-1])return eb(n,e,h,r,i,!1);e=h}}return null}function p$(n,e,t,r,i){return!lD(i,function(a){return!jh(n,e,t,r,a[0],a[1])})}function jh(n,e,t,r,i,s){let a=0,o=n[t-r],l=n[t-r+1];for(;e<t;e+=r){const c=n[e],h=n[e+1];l<=s?h>s&&(c-o)*(s-l)-(i-o)*(h-l)>0&&a++:h<=s&&(c-o)*(s-l)-(i-o)*(h-l)<0&&a--,o=c,l=h}return a!==0}function QR(n,e,t,r,i,s){if(t.length===0||!jh(n,e,t[0],r,i,s))return!1;for(let a=1,o=t.length;a<o;++a)if(jh(n,t[a-1],t[a],r,i,s))return!1;return!0}function y$(n,e,t,r,i,s){if(t.length===0)return!1;for(let a=0,o=t.length;a<o;++a){const l=t[a];if(QR(n,e,l,r,i,s))return!0;e=l[l.length-1]}return!1}function kD(n,e,t,r,i){let s;for(e+=r;e<t;e+=r)if(s=i(n.slice(e-r,e),n.slice(e,e+r)),s)return s;return!1}function _w(n,e,t,r,i,s){return s=s??oD(zs(),n,e,t,r),_s(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:kD(n,e,t,r,function(a,o){return EU(i,a,o)}):!1}function x$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){if(_w(n,e,t[s],r,i))return!0;e=t[s]}return!1}function ID(n,e,t,r,i){return!!(_w(n,e,t,r,i)||jh(n,e,t,r,i[0],i[1])||jh(n,e,t,r,i[0],i[3])||jh(n,e,t,r,i[2],i[1])||jh(n,e,t,r,i[2],i[3]))}function CD(n,e,t,r,i){if(!ID(n,e,t[0],r,i))return!1;if(t.length===1)return!0;for(let s=1,a=t.length;s<a;++s)if(p$(n,t[s-1],t[s],r,i)&&!_w(n,t[s-1],t[s],r,i))return!1;return!0}function _$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(CD(n,e,o,r,i))return!0;e=o[o.length-1]}return!1}function eA(n,e,t,r){let i=n[e],s=n[e+1],a=0;for(let o=e+r;o<t;o+=r){const l=n[o],c=n[o+1];a+=Math.sqrt((l-i)*(l-i)+(c-s)*(c-s)),i=l,s=c}return a}function vw(n,e,t,r,i,s,a){const o=(t-e)/r;if(o<3){for(;e<t;e+=r)s[a++]=n[e],s[a++]=n[e+1];return a}const l=new Array(o);l[0]=1,l[o-1]=1;const c=[e,t-r];let h=0;for(;c.length>0;){const g=c.pop(),m=c.pop();let y=0;const v=n[m],_=n[m+1],E=n[g],T=n[g+1];for(let b=m+r;b<g;b+=r){const R=n[b],N=n[b+1],D=SU(R,N,v,_,E,T);D>y&&(h=b,y=D)}y>i&&(l[(h-e)/r]=1,m+r<h&&c.push(m,h),h+r<g&&c.push(h,g))}for(let g=0;g<o;++g)l[g]&&(s[a++]=n[e+g*r],s[a++]=n[e+g*r+1]);return a}function PD(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l];a=vw(n,e,h,r,i,s,a),o.push(a),e=h}return a}function Eh(n,e){return e*Math.round(n/e)}function v$(n,e,t,r,i,s,a){if(e==t)return a;let o=Eh(n[e],i),l=Eh(n[e+1],i);e+=r,s[a++]=o,s[a++]=l;let c,h;do if(c=Eh(n[e],i),h=Eh(n[e+1],i),e+=r,e==t)return s[a++]=c,s[a++]=h,a;while(c==o&&h==l);for(;e<t;){const g=Eh(n[e],i),m=Eh(n[e+1],i);if(e+=r,g==c&&m==h)continue;const y=c-o,v=h-l,_=g-o,E=m-l;if(y*E==v*_&&(y<0&&_<y||y==_||y>0&&_>y)&&(v<0&&E<v||v==E||v>0&&E>v)){c=g,h=m;continue}s[a++]=c,s[a++]=h,o=c,l=h,c=g,h=m}return s[a++]=c,s[a++]=h,a}function tA(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l];a=v$(n,e,h,r,i,s,a),o.push(a),e=h}return a}function w$(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l],g=[];a=tA(n,e,h,r,i,s,a,g),o.push(g),e=h[h.length-1]}return a}class Ti extends Ad{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){Bn(this.flatCoordinates,e),this.changed()}clone(){const e=new Ti(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(qR(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ZR(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,r,i))}forEachSegment(e){return kD(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,eb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return cu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return M_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return eA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=vw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Ti(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return _w(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xw(this.flatCoordinates,0,e,this.stride),this.changed()}}let gi=class MD extends Ad{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new MD(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){const s=this.flatCoordinates,a=Kh(e,t,s[0],s[1]);if(a<i){const o=this.stride;for(let l=0;l<o;++l)r[l]=s[l];return r.length=o,a}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return sD(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return GR(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=g$(this.flatCoordinates,0,e,this.stride),this.changed()}};const Si={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},sd=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",E$=sd.includes("safari")&&!sd.includes("chrom"),S$=E$&&(sd.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(sd)),T$=sd.includes("webkit")&&!sd.includes("edge"),ND=sd.includes("macintosh"),b$=typeof devicePixelRatio<"u"?devicePixelRatio:1,ua=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,nA=typeof Image<"u"&&Image.prototype.decode,LD=typeof createImageBitmap=="function",OD=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Tt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function ti(n,e,t,r){let i;return t&&t.length?i=t.shift():ua?i=new class extends OffscreenCanvas{style={}}(n??300,e??150):i=document.createElement("canvas"),n&&(i.width=n),e&&(i.height=e),i.getContext("2d",r)}let lS;function N_(){return lS||(lS=ti(1,1)),lS}function ww(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function tM(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function R$(n){for(;n.lastChild;)n.lastChild.remove()}function A$(n,e){const t=n.childNodes;for(let r=0;;++r){const i=t[r],s=e[r];if(!i&&!s)break;if(i!==s){if(!i){n.appendChild(s);continue}if(!s){n.removeChild(i),--r;continue}n.insertBefore(s,i)}}}function DD(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const r=this.childNodes.indexOf(t);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,t,r){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,r)}})}function uu(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const rA=[NaN,NaN,NaN,0];let cS;function k$(){return cS||(cS=ti(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),cS}const I$=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,C$=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,P$=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,M$=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function ux(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function Lm(n){throw new Error('failed to parse "'+n+'" as color')}function FD(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(C$)||n.match(I$)||n.match(P$);if(s){const a=s[4],o=100/255;return[cr(ux(s[1],o)+.5|0,0,255),cr(ux(s[2],o)+.5|0,0,255),cr(ux(s[3],o)+.5|0,0,255),a!==void 0?cr(ux(a,100),0,1):1]}Lm(n)}if(n.startsWith("#")){if(M$.test(n)){const s=n.substring(1),a=s.length<=4?1:2,o=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=a){let h=parseInt(s.substring(l,l+a),16);a===1&&(h+=h<<4),o[l/a]=h}return o[3]=o[3]/255,o}Lm(n)}const e=k$();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&Lm(n));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return FD(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=dy(i[3]/255,3),i}function N$(n){return typeof n=="string"?n:sA(n)}const L$=1024,rm={};let uS=0;function O$(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function hS(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function dS(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function fS(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function gS(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function nM(n){const e=fS(n[0]),t=fS(n[1]),r=fS(n[2]),i=gS(e*.222488403+t*.716873169+r*.06060791),s=500*(gS(e*.452247074+t*.399439023+r*.148375274)-i),a=200*(i-gS(e*.016863605+t*.117638439+r*.865350722)),o=Math.atan2(a,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+a*a),o<0?o+360:o,n[3]]}function D$(n){const e=(n[0]+16)/116,t=n[1],r=n[2]*Math.PI/180,i=dS(e),s=dS(e+t/500*Math.cos(r)),a=dS(e-t/200*Math.sin(r)),o=hS(s*3.021973625-i*1.617392459-a*.404875592),l=hS(s*-.943766287+i*1.916279586+a*.027607165),c=hS(s*.069407491-i*.22898585+a*1.159737864);return[cr(o+.5|0,0,255),cr(l+.5|0,0,255),cr(c+.5|0,0,255),n[3]]}function iA(n){if(n==="none")return rA;if(rm.hasOwnProperty(n))return rm[n];if(uS>=L$){let t=0;for(const r in rm)(t++&3)===0&&(delete rm[r],--uS)}const e=FD(n);e.length!==4&&Lm(n);for(const t of e)isNaN(t)&&Lm(n);return rm[n]=e,++uS,e}function Ba(n){return Array.isArray(n)?n:iA(n)}function sA(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let r=n[2];r!=(r|0)&&(r=r+.5|0);const i=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+r+","+i+")"}class jD extends cy{constructor(e,t,r,i){super(),this.extent=e,this.pixelRatio_=r,this.resolution=t,this.state=typeof i=="function"?Tt.IDLE:i,this.image_=null,this.loader=typeof i=="function"?i:null}changed(){this.dispatchEvent(Jt.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==Tt.IDLE&&this.loader){this.state=Tt.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;nD(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(r=>{"image"in r&&(this.image_=r.image),"extent"in r&&(this.extent=r.extent),"resolution"in r&&(this.resolution=r.resolution),"pixelRatio"in r&&(this.pixelRatio_=r.pixelRatio),(r instanceof HTMLImageElement||LD&&r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement)&&(this.image_=r),this.state=Tt.LOADED}).catch(r=>{this.state=Tt.ERROR,console.error(r)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function F$(n,e,t){const r=n;let i=!0,s=!1,a=!1;const o=[T_(r,Jt.LOAD,function(){a=!0,s||e()})];return r.src&&nA?(s=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(a?e():t())})):o.push(T_(r,Jt.ERROR,t)),function(){i=!1,o.forEach(ar)}}function j$(n,e){return new Promise((t,r)=>{function i(){a(),t(n)}function s(){a(),r(new Error("Image load error"))}function a(){n.removeEventListener("load",i),n.removeEventListener("error",s)}n.addEventListener("load",i),n.addEventListener("error",s)})}function VD(n,e){return e&&(n.src=e),n.src&&nA?new Promise((t,r)=>n.decode().then(()=>t(n)).catch(i=>n.complete&&n.width?t(n):r(i))):j$(n)}function BD(n,e){return e&&(n.src=e),n.src&&nA&&LD?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):VD(n)}class V${constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const r=this.cache_[t];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,r){const i=mS(e,t,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,t,r){const i=mS(e,t,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,t,r,i,s){const a=mS(e,t,r),o=a in this.cache_;this.cache_[a]=i,s&&(i.getImageState()===Tt.IDLE&&i.load(),i.getImageState()===Tt.LOADING?i.ready().then(()=>{this.patternCache_[a]=N_().createPattern(i.getImage(1),"repeat")}):this.patternCache_[a]=N_().createPattern(i.getImage(1),"repeat")),o||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function mS(n,e,t){const r=t?Ba(t):"null";return e+":"+n+":"+r}const Na=new V$;let im=null;class GD extends cy{constructor(e,t,r,i,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=s,this.imageState_=i===void 0?Tt.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Tt.LOADED){im||(im=ti(1,1,void 0,{willReadFrequently:!0})),im.drawImage(this.image_,0,0);try{im.getImageData(0,0,1,1),this.tainted_=!1}catch{im=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Jt.CHANGE)}handleImageError_(){this.imageState_=Tt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Tt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],r=ti(e,t);r.fillRect(0,0,e,t),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Tt.IDLE){this.image_||this.initializeImage_(),this.imageState_=Tt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&VD(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Tt.LOADED)return;const t=this.image_,r=ti(Math.ceil(t.width*e),Math.ceil(t.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(t,0,0),r.globalCompositeOperation="multiply",r.fillStyle=N$(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Tt.LOADED||this.imageState_===Tt.ERROR)e();else{const t=()=>{(this.imageState_===Tt.LOADED||this.imageState_===Tt.ERROR)&&(this.removeEventListener(Jt.CHANGE,t),e())};this.addEventListener(Jt.CHANGE,t)}})),this.ready_}}function L_(n,e,t,r,i,s){let a=e===void 0?void 0:Na.get(e,t,i);return a||(a=new GD(n,n&&"src"in n?n.src||void 0:e,t,r,i),Na.set(e,t,i,a,s)),s&&a&&!Na.getPattern(e,t,i)&&Na.set(e,t,i,a,s),a}function Zo(n){return n?Array.isArray(n)?sA(n):typeof n=="object"&&"src"in n?B$(n):n:null}function B$(n){if(!n.offset||!n.size)return Na.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Na.getPattern(e,void 0,n.color);if(t)return t;const r=Na.get(n.src,"anonymous",null);if(r.getImageState()!==Tt.LOADED)return null;const i=ti(n.size[0],n.size[1]);return i.drawImage(r.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),L_(i.canvas,e,void 0,Tt.LOADED,n.color,!0),Na.getPattern(e,void 0,n.color)}class zD{drawCustom(e,t,r,i,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,r){}drawFeature(e,t,r){}drawGeometryCollection(e,t,r){}drawLineString(e,t,r){}drawMultiLineString(e,t,r){}drawMultiPoint(e,t,r){}drawMultiPolygon(e,t,r){}drawPoint(e,t,r){}drawPolygon(e,t,r){}drawText(e,t,r){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const hx="ol-hidden",py="ol-unselectable",aA="ol-control",rM="ol-collapsed",G$=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),iM=["style","variant","weight","size","lineHeight","family"],tb={normal:400,bold:700},nb=function(n){const e=n.match(G$);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=iM.length;r<i;++r){const s=e[r+1];s!==void 0&&(t[iM[r]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in tb&&(t.weight=tb[t.weight]),t.families=t.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),t},UD="10px sans-serif",Os="#000",P0="round",ql=[],Yl=0,M0="round",yp=10,xp="#000",_p="center",O_="middle",Vh=[0,0,0,0],vp=1,Vf=new pl;let sm=null,sM;const rb={},z$=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function U$(n,e,t){return`${n} ${e} 16px "${t}"`}const $$=(function(){let e,t;async function r(s){await t.ready;const a=await t.load(s);if(a.length===0)return!1;const o=nb(s),l=o.families[0].toLowerCase(),c=o.weight;return a.some(h=>{const g=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),m=tb[h.weight]||h.weight;return g===l&&h.style===o.style&&m==c})}async function i(){await t.ready;let s=!0;const a=Vf.getProperties(),o=Object.keys(a).filter(l=>a[l]<100);for(let l=o.length-1;l>=0;--l){const c=o[l];let h=a[c];h<100&&(await r(c)?(ng(rb),Vf.set(c,100)):(h+=10,Vf.set(c,h,!0),h<100&&(s=!1)))}e=void 0,s||(e=setTimeout(i,100))}return async function(s){t||(t=ua?self.fonts:document.fonts);const a=nb(s);if(!a)return;const o=a.families;let l=!1;for(const c of o){if(z$.has(c))continue;const h=U$(a.style,a.weight,c);Vf.get(h)===void 0&&(Vf.set(h,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(i,100))}})(),W$=(function(){let n;return function(e){let t=rb[e];if(t==null){if(ua){const r=nb(e),i=$D(e,"g");t=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);rb[e]=t}return t}})();function $D(n,e){return sm||(sm=ti(1,1)),n!=sM&&(sm.font=n,sM=sm.font),sm.measureText(e)}function WD(n,e){return $D(n,e).width}function aM(n,e,t){if(e in t)return t[e];const r=e.split(`
`).reduce((i,s)=>Math.max(i,WD(n,s)),0);return t[e]=r,r}function H$(n,e){const t=[],r=[],i=[];let s=0,a=0,o=0,l=0;for(let c=0,h=e.length;c<=h;c+=2){const g=e[c];if(g===`
`||c===h){s=Math.max(s,a),i.push(a),a=0,o+=l,l=0;continue}const m=e[c+1]||n.font,y=WD(m,g);t.push(y),a+=y;const v=W$(m);r.push(v),l=Math.max(l,v)}return{width:s,height:o,widths:t,heights:r,lineWidths:i}}function K$(n,e,t,r,i,s,a,o,l,c,h){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=g=>g.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),r.contextInstructions?(n.translate(l,c),n.scale(h[0],h[1]),X$(r,n)):h[0]<0||h[1]<0?(n.translate(l,c),n.scale(h[0],h[1]),n.drawImage(r,i,s,a,o,0,0,a,o)):n.drawImage(r,i,s,a,o,l,c,a*h[0],o*h[1]),n.restore()}function X$(n,e){const t=n.contextInstructions;for(let r=0,i=t.length;r<i;r+=2)Array.isArray(t[r+1])?e[t[r]].apply(e,t[r+1]):e[t[r]]=t[r+1]}class q$ extends zD{constructor(e,t,r,i,s,a,o){super(),this.context_=e,this.pixelRatio_=t,this.extent_=r,this.transform_=i,this.transformRotation_=i?dy(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=a,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=fi()}drawImages_(e,t,r,i){if(!this.image_)return;const s=el(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_,o=this.tmpLocalTransform_,l=a.globalAlpha;this.imageOpacity_!=1&&(a.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,g=s.length;h<g;h+=2){const m=s[h]-this.imageAnchorX_,y=s[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const v=m+this.imageAnchorX_,_=y+this.imageAnchorY_;Va(o,v,_,1,1,c,-v,-_),a.save(),a.transform.apply(a,o),a.translate(v,_),a.scale(this.imageScale_[0],this.imageScale_[1]),a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),a.restore()}else a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,m,y,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(a.globalAlpha=l)}drawText_(e,t,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=el(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_;let o=this.textRotation_;for(this.transformRotation_===0&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);t<r;t+=i){const l=s[t]+this.textOffsetX_,c=s[t+1]+this.textOffsetY_;o!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(a.save(),a.translate(l-this.textOffsetX_,c-this.textOffsetY_),a.rotate(o),a.translate(this.textOffsetX_,this.textOffsetY_),a.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&a.strokeText(this.text_,0,0),this.textFillState_&&a.fillText(this.text_,0,0),a.restore()):(this.textStrokeState_&&a.strokeText(this.text_,l,c),this.textFillState_&&a.fillText(this.text_,l,c))}}moveToLineTo_(e,t,r,i,s){const a=this.context_,o=el(e,t,r,i,this.transform_,this.pixelCoordinates_);a.moveTo(o[0],o[1]);let l=o.length;s&&(l-=2);for(let c=2;c<l;c+=2)a.lineTo(o[c],o[c+1]);return s&&a.closePath(),r}drawRings_(e,t,r,i){for(let s=0,a=r.length;s<a;++s)t=this.moveToLineTo_(e,t,r[s],i,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!_s(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=h$(e,this.transform_,this.pixelCoordinates_),r=t[2]-t[0],i=t[3]-t[1],s=Math.sqrt(r*r+i*i),a=this.context_;a.beginPath(),a.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const r=t.getGeometryFunction()(e);r&&(this.setStyle(t),this.drawGeometry(r))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let r=0,i=t.length;r<i;++r)this.drawGeometry(t[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!_s(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(_s(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let s=0;const a=e.getEnds(),o=e.getStride();r.beginPath();for(let l=0,c=a.length;l<c;++l)s=this.moveToLineTo_(i,s,a[l],o,!1);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!_s(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!_s(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getOrientedFlatCoordinates();let i=0;const s=e.getEndss(),a=e.getStride();t.beginPath();for(let o=0,l=s.length;o<l;++o){const c=s[o];i=this.drawRings_(r,i,c,a)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,t.lineCap=e.lineCap),hc(r.lineDash,e.lineDash)||t.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:_p;r?(r.font!=e.font&&(r.font=e.font,t.font=e.font),r.textAlign!=i&&(r.textAlign=i,t.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=i,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:Zo(r||Os)}}if(!t)this.strokeState_=null;else{const r=t.getColor(),i=t.getLineCap(),s=t.getLineDash(),a=t.getLineDashOffset(),o=t.getLineJoin(),l=t.getWidth(),c=t.getMiterLimit(),h=s||ql;this.strokeState_={lineCap:i!==void 0?i:P0,lineDash:this.pixelRatio_===1?h:h.map(g=>g*this.pixelRatio_),lineDashOffset:(a||Yl)*this.pixelRatio_,lineJoin:o!==void 0?o:M0,lineWidth:(l!==void 0?l:vp)*this.pixelRatio_,miterLimit:c!==void 0?c:yp,strokeStyle:Zo(r||xp)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=t[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const a=e.getScaleArray();this.imageScale_=[a[0]*this.pixelRatio_/r,a[1]*this.pixelRatio_/r],this.imageWidth_=t[0]*r}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const y=t.getColor();this.textFillState_={fillStyle:Zo(y||Os)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const y=r.getColor(),v=r.getLineCap(),_=r.getLineDash(),E=r.getLineDashOffset(),T=r.getLineJoin(),b=r.getWidth(),R=r.getMiterLimit();this.textStrokeState_={lineCap:v!==void 0?v:P0,lineDash:_||ql,lineDashOffset:E||Yl,lineJoin:T!==void 0?T:M0,lineWidth:b!==void 0?b:vp,miterLimit:R!==void 0?R:yp,strokeStyle:Zo(y||xp)}}const i=e.getFont(),s=e.getOffsetX(),a=e.getOffsetY(),o=e.getRotateWithView(),l=e.getRotation(),c=e.getScaleArray(),h=e.getText(),g=e.getTextAlign(),m=e.getTextBaseline();this.textState_={font:i!==void 0?i:UD,textAlign:g!==void 0?g:_p,textBaseline:m!==void 0?m:O_},this.text_=h!==void 0?Array.isArray(h)?h.reduce((y,v,_)=>y+=_%2?" ":v,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=a!==void 0?this.pixelRatio_*a:0,this.textRotateWithView_=o!==void 0?o:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const Y$=.5,HD={Point:iW,LineString:tW,Polygon:aW,MultiPoint:sW,MultiLineString:nW,MultiPolygon:rW,GeometryCollection:eW,Circle:J$};function Z$(n,e){return parseInt(Ut(n),10)-parseInt(Ut(e),10)}function oM(n,e){const t=KD(n,e);return t*t}function KD(n,e){return Y$*n/e}function J$(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,a),l.drawCircle(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r)}}function lM(n,e,t,r,i,s,a,o){const l=[],c=t.getImage();if(c){let m=!0;const y=c.getImageState();y==Tt.LOADED||y==Tt.ERROR?m=!1:y==Tt.IDLE&&c.load(),m&&l.push(c.ready())}const h=t.getFill();h&&h.loading()&&l.push(h.ready());const g=l.length>0;return g&&Promise.all(l).then(()=>i(null)),Q$(n,e,t,r,s,a,o),g}function Q$(n,e,t,r,i,s,a){const o=t.getGeometryFunction()(e);if(!o)return;const l=o.simplifyTransformed(r,i);if(t.getRenderer())XD(n,l,t,e,a);else{const h=HD[l.getType()];h(n,l,t,e,a,s)}}function XD(n,e,t,r,i){if(e.getType()=="GeometryCollection"){const a=e.getGeometries();for(let o=0,l=a.length;o<l;++o)XD(n,a[o],t,r,i);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,r,t.getRenderer(),t.getHitDetectionRenderer(),i)}function eW(n,e,t,r,i,s){const a=e.getGeometriesArray();let o,l;for(o=0,l=a.length;o<l;++o){const c=HD[a[o].getType()];c(n,a[o],t,r,i,s)}}function tW(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function nW(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawMultiLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function rW(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(a||s){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawMultiPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}function iW(n,e,t,r,i,s){const a=t.getImage(),o=t.getText(),l=o&&o.getText(),c=s&&a&&l?{}:void 0;if(a){if(a.getImageState()!=Tt.LOADED)return;const h=n.getBuilder(t.getZIndex(),"Image");h.setImageStyle(a,c),h.drawPoint(e,r,i)}if(l){const h=n.getBuilder(t.getZIndex(),"Text");h.setTextStyle(o,c),h.drawText(e,r,i)}}function sW(n,e,t,r,i,s){const a=t.getImage(),o=a&&a.getOpacity()!==0,l=t.getText(),c=l&&l.getText(),h=s&&o&&c?{}:void 0;if(o){if(a.getImageState()!=Tt.LOADED)return;const g=n.getBuilder(t.getZIndex(),"Image");g.setImageStyle(a,h),g.drawMultiPoint(e,r,i)}if(c){const g=n.getBuilder(t.getZIndex(),"Text");g.setTextStyle(l,h),g.drawText(e,r,i)}}function aW(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}let oW=!1;function lW(n,e,t,r,i,s,a){const o=new XMLHttpRequest;o.open("GET",typeof n=="function"?n(t,r,i):n,!0),e.getType()=="arraybuffer"&&(o.responseType="arraybuffer"),o.withCredentials=oW,o.onload=function(l){if(!o.status||o.status>=200&&o.status<300){const c=e.getType();try{let h;c=="text"||c=="json"?h=o.responseText:c=="xml"?h=o.responseXML||o.responseText:c=="arraybuffer"&&(h=o.response),h?s(e.readFeatures(h,{extent:t,featureProjection:i}),e.readProjection(h)):a()}catch{a()}}else a()},o.onerror=a,o.send()}function cM(n,e){return function(t,r,i,s,a){lW(n,e,t,r,i,(o,l)=>{this.addFeatures(o),s!==void 0&&s(o)},()=>{this.changed(),a!==void 0&&a()})}}function cW(n,e){return[[-1/0,-1/0,1/0,1/0]]}function qD(n,e,t,r){const i=[];let s=zs();for(let a=0,o=t.length;a<o;++a){const l=t[a];s=zR(n,e,l[0],r),i.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return i}function oA(n,e,t,r,i,s,a){let o,l,c,h,g,m,y;const v=i[s+1],_=[];for(let b=0,R=t.length;b<R;++b){const N=t[b];for(h=n[N-r],m=n[N-r+1],o=e;o<N;o+=r)g=n[o],y=n[o+1],(v<=m&&y<=v||m<=v&&v<=y)&&(c=(v-m)/(y-m)*(g-h)+h,_.push(c)),h=g,m=y}let E=NaN,T=-1/0;for(_.sort(Hl),h=_[0],o=1,l=_.length;o<l;++o){g=_[o];const b=Math.abs(g-h);b>T&&(c=(h+g)/2,QR(n,e,t,r,c,v)&&(E=c,T=b)),h=g}return isNaN(E)&&(E=i[s]),a?(a.push(E,v,T),a):[E,v,T]}function YD(n,e,t,r,i){let s=[];for(let a=0,o=t.length;a<o;++a){const l=t[a];s=oA(n,e,l,r,i,2*a,s),e=l[l.length-1]}return s}function uW(n,e,t,r){for(;e<t-r;){for(let i=0;i<r;++i){const s=n[e+i];n[e+i]=n[t-r+i],n[t-r+i]=s}e+=r,t-=r}}function lA(n,e,t,r){let i=0,s=n[t-r],a=n[t-r+1];for(;e<t;e+=r){const o=n[e],l=n[e+1];i+=(o-s)*(l+a),s=o,a=l}return i===0?void 0:i>0}function cA(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=lA(n,e,o,r);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=o}return!0}function ZD(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(!cA(n,e,o,r,i))return!1;o.length&&(e=o[o.length-1])}return!0}function D_(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=lA(n,e,o,r);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&uW(n,e,o,r),e=o}return e}function ib(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s)e=D_(n,e,t[s],r,i);return e}function JD(n,e){const t=[];let r=0,i=0,s;for(let a=0,o=e.length;a<o;++a){const l=e[a],c=lA(n,r,l,2);if(s===void 0&&(s=c),c===s)t.push(e.slice(i,a+1));else{if(t.length===0)continue;t[t.length-1].push(e[i])}i=a+1,r=l}return t}class po extends RD{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(ar),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let t=0,r=e.length;t<r;++t)this.changeEventsKeys_.push(fn(e[t],Jt.CHANGE,this.changed,this))}clone(){const e=new po(pS(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<bd(this.getExtent(),e,t))return i;const s=this.geometries_;for(let a=0,o=s.length;a<o;++a)i=s[a].closestPointXY(e,t,r,i);return i}containsXY(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)if(r[i].containsXY(e,t))return!0;return!1}computeExtent(e){hy(e);const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)aD(e,t[r].getExtent());return e}getGeometries(){return pS(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],r=this.geometries_;let i=!1;for(let s=0,a=r.length;s<a;++s){const o=r[s],l=o.getSimplifiedGeometry(e);t.push(l),l!==o&&(i=!0)}return i?new po(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].rotate(e,t);this.changed()}scale(e,t,r){r||(r=cl(this.getExtent()));const i=this.geometries_;for(let s=0,a=i.length;s<a;++s)i[s].scale(e,t,r);this.changed()}setGeometries(e){this.setGeometriesArray(pS(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()}translate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function pS(n){return n.map(e=>e.clone())}function QD(n,e,t,r){let i=0;const s=n[t-r],a=n[t-r+1];let o=0,l=0;for(;e<t;e+=r){const c=n[e]-s,h=n[e+1]-a;i+=l*c-o*h,o=c,l=h}return i/2}function eF(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=QD(n,e,o,r),e=o}return i}function hW(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=eF(n,e,o,r),e=o[o.length-1]}return i}class wp extends Ad{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new wp(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(qR(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ZR(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,r,i))}getArea(){return QD(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return cu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=vw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new wp(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xw(this.flatCoordinates,0,e,this.stride),this.changed()}}class nc extends Ad{constructor(e,t,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&r)this.setFlatCoordinates(t,e),this.ends_=r;else{const i=e,s=[],a=[];for(let l=0,c=i.length;l<c;++l){const h=i[l];Bn(s,h.getFlatCoordinates()),a.push(s.length)}const o=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(o,s),this.ends_=a}}appendLineString(e){Bn(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new nc(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(YR(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),JR(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,r,i))}getCoordinateAtM(e,t,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,r=r!==void 0?r:!1,m$(this.flatCoordinates,0,this.ends_,this.stride,e,t,r))}getCoordinates(){return pp(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new Ti(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,r=this.layout,i=[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a],c=new Ti(e.slice(s,l),r);i.push(c),s=l}return i}getLength(){const e=this.ends_;let t=0,r=0;for(let i=0,s=e.length;i<s;++i)r+=eA(this.flatCoordinates,t,e[i],this.stride),t=e[i];return r}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let r=0;const i=this.ends_,s=this.stride;for(let a=0,o=i.length;a<o;++a){const l=i[a],c=M_(t,r,l,s,.5);Bn(e,c),r=l}return e}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=PD(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,r),new nc(t,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return x$(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=my(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}class Id extends Ad{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){Bn(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new Id(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<bd(this.getExtent(),e,t))return i;const s=this.flatCoordinates,a=this.stride;for(let o=0,l=s.length;o<l;o+=a){const c=Kh(e,t,s[o],s[o+1]);if(c<i){i=c;for(let h=0;h<a;++h)r[h]=s[o+h];r.length=a}}return i}getCoordinates(){return cu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new gi(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,r=this.stride,i=[];for(let s=0,a=e.length;s<a;s+=r){const o=new gi(e.slice(s,s+r),t);i.push(o)}return i}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,r=this.stride;for(let i=0,s=t.length;i<s;i+=r){const a=t[i],o=t[i+1];if(GR(e,a,o))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xw(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ga extends Ad{constructor(e,t,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&r?(this.setFlatCoordinates(t,e),this.ends_=r):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Bn(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Ga(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(YR(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),JR(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return QR(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return eF(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),D_(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,pp(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=cl(this.getExtent());this.flatInteriorPoint_=oA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new gi(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new wp(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,r=this.ends_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a],c=new wp(t.slice(s,l),e);i.push(c),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;cA(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=D_(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=tA(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,r),new Ga(t,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return CD(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=my(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function uM(n){if(rg(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],r=n[2],i=n[3],s=[e,t,e,i,r,i,r,t,e,t];return new Ga(s,"XY",[s.length])}class ad extends Ad{constructor(e,t,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){const i=e,s=[],a=[];for(let o=0,l=i.length;o<l;++o){const c=i[o],h=s.length,g=c.getEnds();for(let m=0,y=g.length;m<y;++m)g[m]+=h;Bn(s,c.getFlatCoordinates()),a.push(g)}t=i.length===0?this.getLayout():i[0].getLayout(),e=s,r=a}t!==void 0&&r?(this.setFlatCoordinates(t,e),this.endss_=r):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const r=this.flatCoordinates.length;Bn(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let i=0,s=t.length;i<s;++i)t[i]+=r}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=this.endss_[i].slice();const r=new ad(this.flatCoordinates.slice(),this.layout,t);return r.applyProperties(this),r}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(d$(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),f$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return y$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return hW(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),ib(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,QT(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=qD(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=YD(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Id(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;ZD(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=ib(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=w$(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,r),new ad(t,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const r=this.endss_[e].slice(),i=r[r.length-1];if(t!==0)for(let s=0,a=r.length;s<a;++s)r[s]-=t;return new Ga(this.flatCoordinates.slice(t,i),this.layout,r)}getPolygons(){const e=this.layout,t=this.flatCoordinates,r=this.endss_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a].slice(),c=l[l.length-1];if(s!==0)for(let g=0,m=l.length;g<m;++g)l[g]-=s;const h=new Ga(t.slice(s,c),e,l);i.push(h),s=c}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return _$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const r=AD(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{const i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const hM=fi();class Ds{constructor(e,t,r,i,s,a){this.styleFunction,this.extent_,this.id_=a,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=s,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?sD(this.flatCoordinates_):zR(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=cl(this.getExtent());this.flatInteriorPoints_=oA(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=JD(this.flatCoordinates_,this.ends_),t=qD(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=YD(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=M_(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const r=this.ends_;for(let i=0,s=r.length;i<s;++i){const a=r[i],o=M_(e,t,a,2,.5);Bn(this.flatMidpoints_,o),t=a}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=nr(e);const t=e.getExtent(),r=e.getWorldExtent();if(t&&r){const i=Qr(r)/Qr(t);Va(hM,r[0],r[3],i,-i,0,0,0),el(this.flatCoordinates_,0,this.flatCoordinates_.length,2,hM,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Ds(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=tD((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=vw(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=PD(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=tA(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new Ds(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Ds.prototype.getFlatCoordinates=Ds.prototype.getOrientedFlatCoordinates;function tF(n,e,t=0,r=n.length-1,i=dW){for(;r>t;){if(r-t>600){const l=r-t+1,c=e-t+1,h=Math.log(l),g=.5*Math.exp(2*h/3),m=.5*Math.sqrt(h*g*(l-g)/l)*(c-l/2<0?-1:1),y=Math.max(t,Math.floor(e-c*g/l+m)),v=Math.min(r,Math.floor(e+(l-c)*g/l+m));tF(n,e,y,v,i)}const s=n[e];let a=t,o=r;for(am(n,t,e),i(n[r],s)>0&&am(n,t,r);a<o;){for(am(n,a,o),a++,o--;i(n[a],s)<0;)a++;for(;i(n[o],s)>0;)o--}i(n[t],s)===0?am(n,t,o):(o++,am(n,o,r)),o<=e&&(t=o+1),e<=o&&(r=o-1)}}function am(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function dW(n,e){return n<e?-1:n>e?1:0}let nF=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const r=[];if(!fx(e,t))return r;const i=this.toBBox,s=[];for(;t;){for(let a=0;a<t.children.length;a++){const o=t.children[a],l=t.leaf?i(o):o;fx(e,l)&&(t.leaf?r.push(o):xS(e,l)?this._all(o,r):s.push(o))}t=s.pop()}return r}collides(e){let t=this.data;if(!fx(e,t))return!1;const r=[];for(;t;){for(let i=0;i<t.children.length;i++){const s=t.children[i],a=t.leaf?this.toBBox(s):s;if(fx(e,a)){if(t.leaf||xS(e,a))return!0;r.push(s)}}t=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const r=this.data;this.data=t,t=r}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Bf([]),this}remove(e,t){if(!e)return this;let r=this.data;const i=this.toBBox(e),s=[],a=[];let o,l,c;for(;r||s.length;){if(r||(r=s.pop(),l=s[s.length-1],o=a.pop(),c=!0),r.leaf){const h=fW(e,r.children,t);if(h!==-1)return r.children.splice(h,1),s.push(r),this._condense(s),this}!c&&!r.leaf&&xS(r,i)?(s.push(r),a.push(o),o=0,l=r,r=r.children[0]):l?(o++,r=l.children[o],c=!1):r=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,i){const s=r-t+1;let a=this._maxEntries,o;if(s<=a)return o=Bf(e.slice(t,r+1)),wf(o,this.toBBox),o;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),o=Bf([]),o.leaf=!1,o.height=i;const l=Math.ceil(s/a),c=l*Math.ceil(Math.sqrt(a));dM(e,t,r,c,this.compareMinX);for(let h=t;h<=r;h+=c){const g=Math.min(h+c-1,r);dM(e,h,g,l,this.compareMinY);for(let m=h;m<=g;m+=l){const y=Math.min(m+l-1,g);o.children.push(this._build(e,m,y,i-1))}}return wf(o,this.toBBox),o}_chooseSubtree(e,t,r,i){for(;i.push(t),!(t.leaf||i.length-1===r);){let s=1/0,a=1/0,o;for(let l=0;l<t.children.length;l++){const c=t.children[l],h=yS(c),g=pW(e,c)-h;g<a?(a=g,s=h<s?h:s,o=c):g===a&&h<s&&(s=h,o=c)}t=o||t.children[0]}return t}_insert(e,t,r){const i=r?e:this.toBBox(e),s=[],a=this._chooseSubtree(i,this.data,t,s);for(a.children.push(e),xm(a,i);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(i,s,t)}_split(e,t){const r=e[t],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);const a=this._chooseSplitIndex(r,s,i),o=Bf(r.children.splice(a,r.children.length-a));o.height=r.height,o.leaf=r.leaf,wf(r,this.toBBox),wf(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(r,o)}_splitRoot(e,t){this.data=Bf([e,t]),this.data.height=e.height+1,this.data.leaf=!1,wf(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let i,s=1/0,a=1/0;for(let o=t;o<=r-t;o++){const l=ym(e,0,o,this.toBBox),c=ym(e,o,r,this.toBBox),h=yW(l,c),g=yS(l)+yS(c);h<s?(s=h,i=o,a=g<a?g:a):h===s&&g<a&&(a=g,i=o)}return i||r-t}_chooseSplitAxis(e,t,r){const i=e.leaf?this.compareMinX:gW,s=e.leaf?this.compareMinY:mW,a=this._allDistMargin(e,t,r,i),o=this._allDistMargin(e,t,r,s);a<o&&e.children.sort(i)}_allDistMargin(e,t,r,i){e.children.sort(i);const s=this.toBBox,a=ym(e,0,t,s),o=ym(e,r-t,r,s);let l=dx(a)+dx(o);for(let c=t;c<r-t;c++){const h=e.children[c];xm(a,e.leaf?s(h):h),l+=dx(a)}for(let c=r-t-1;c>=t;c--){const h=e.children[c];xm(o,e.leaf?s(h):h),l+=dx(o)}return l}_adjustParentBBoxes(e,t,r){for(let i=r;i>=0;i--)xm(t[i],e)}_condense(e){for(let t=e.length-1,r;t>=0;t--)e[t].children.length===0?t>0?(r=e[t-1].children,r.splice(r.indexOf(e[t]),1)):this.clear():wf(e[t],this.toBBox)}};function fW(n,e,t){if(!t)return e.indexOf(n);for(let r=0;r<e.length;r++)if(t(n,e[r]))return r;return-1}function wf(n,e){ym(n,0,n.children.length,e,n)}function ym(n,e,t,r,i){i||(i=Bf(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=e;s<t;s++){const a=n.children[s];xm(i,n.leaf?r(a):a)}return i}function xm(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function gW(n,e){return n.minX-e.minX}function mW(n,e){return n.minY-e.minY}function yS(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function dx(n){return n.maxX-n.minX+(n.maxY-n.minY)}function pW(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function yW(n,e){const t=Math.max(n.minX,e.minX),r=Math.max(n.minY,e.minY),i=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,i-t)*Math.max(0,s-r)}function xS(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function fx(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Bf(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function dM(n,e,t,r,i){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=r)continue;const a=e+Math.ceil((t-e)/r/2)*r;tF(n,a,e,t,i),s.push(e,a,a,t)}}class fM{constructor(e){this.rbush_=new nF(e),this.items_={}}insert(e,t){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(r),this.items_[Ut(t)]=r}load(e,t){const r=new Array(t.length);for(let i=0,s=t.length;i<s;i++){const a=e[i],o=t[i],l={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:o};r[i]=l,this.items_[Ut(o)]=l}this.rbush_.load(r)}remove(e){const t=Ut(e),r=this.items_[t];return delete this.items_[t],this.rbush_.remove(r)!==null}update(e,t){const r=this.items_[Ut(t)],i=[r.minX,r.minY,r.maxX,r.maxY];rd(i,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let r;for(let i=0,s=e.length;i<s;i++)if(r=t(e[i]),r)return r;return r}isEmpty(){return td(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return Iu(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class uA extends pl{constructor(e){super(),this.projection=nr(e.projection),this.attributions_=gM(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(r,i){t.viewResolver=r,t.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=gM(e),this.changed()}setState(e){this.state_=e,this.changed()}}function gM(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const ns={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class zc extends ml{constructor(e,t,r){super(e),this.feature=t,this.features=r}}class dc extends uA{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=fp,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(Tn(this.format_,"`format` must be set when `url` is set"),this.loader_=cM(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:cW;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new fM:null,this.loadedExtentsRtree_=new fM,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!t&&r===void 0&&(r=new Ma(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=Ut(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new zc(ns.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Ds||(this.featureChangeKeys_[e]=[fn(t,Jt.CHANGE,this.handleFeatureChange_,this),fn(t,A0.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let r=!0;if(t.getId()!==void 0){const i=String(t.getId());if(!(i in this.idIndex_))this.idIndex_[i]=t;else if(t instanceof Ds){const s=this.idIndex_[i];s instanceof Ds?Array.isArray(s)?s.push(t):this.idIndex_[i]=[s,t]:r=!1}else r=!1}return r&&(Tn(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],r=[],i=[];for(let s=0,a=e.length;s<a;s++){const o=e[s],l=Ut(o);this.addToIndex_(l,o)&&r.push(o)}for(let s=0,a=r.length;s<a;s++){const o=r[s],l=Ut(o);this.setupChangeEvents_(l,o);const c=o.getGeometry();if(c){const h=c.getExtent();t.push(h),i.push(o)}else this.nullGeometryFeatures_[l]=o}if(this.featuresRtree_&&this.featuresRtree_.load(t,i),this.hasListener(ns.ADDFEATURE))for(let s=0,a=r.length;s<a;s++)this.dispatchEvent(new zc(ns.ADDFEATURE,r[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(ns.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),this.addEventListener(ns.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),e.addEventListener(Ls.ADD,r=>{t||(t=!0,this.addFeature(r.element),t=!1)}),e.addEventListener(Ls.REMOVE,r=>{t||(t=!0,this.removeFeature(r.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(ar);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new zc(ns.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const s=i.getGeometry();if(s instanceof Ds||s.intersectsCoordinate(e))return t(i)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof Ds||i.intersectsExtent(e)){const s=t(r);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),td(this.nullGeometryFeatures_)||Bn(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){t.push(r)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=hD(e,t);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const r=e[0],i=e[1];let s=null;const a=[NaN,NaN];let o=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||dp,this.featuresRtree_.forEachInExtent(l,function(c){if(t(c)){const h=c.getGeometry(),g=o;if(o=h instanceof Ds?0:h.closestPointXY(r,i,a,o),o<g){s=c;const m=Math.sqrt(o);l[0]=r-m,l[1]=i-m,l[2]=r+m,l[3]=i+m}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,r=Ut(t),i=t.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);else{const a=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(a,t)):this.featuresRtree_&&this.featuresRtree_.update(a,t)}const s=t.getId();if(s!==void 0){const a=s.toString();this.idIndex_[a]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[a]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new zc(ns.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:Ut(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&td(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,r){const i=this.loadedExtentsRtree_,s=this.strategy_(e,t,r);for(let a=0,o=s.length;a<o;++a){const l=s[a];i.forEachInExtent(l,function(h){return ou(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new zc(ns.FEATURESLOADSTART)),this.loader_.call(this,l,t,r,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new zc(ns.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new zc(ns.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,r=t.forEachInExtent(e,function(i){if(rd(i.extent,e))return i});r&&t.remove(r)}removeFeatures(e){let t=!1;for(let r=0,i=e.length;r<i;++r)t=this.removeFeatureInternal(e[r])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=Ut(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(ar),delete this.featureChangeKeys_[t];const i=e.getId();if(i!==void 0){const s=i.toString(),a=this.idIndex_[s];a===e?delete this.idIndex_[s]:Array.isArray(a)&&(a.splice(a.indexOf(e),1),a.length===1&&(this.idIndex_[s]=a[0]))}return delete this.uidIndex_[t],this.hasListener(ns.REMOVEFEATURE)&&this.dispatchEvent(new zc(ns.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){Tn(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(cM(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class tr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new tr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=L_(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Tt.IDLE&&t.load(),t.getImageState()===Tt.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?Ut(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:Ba(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class qn{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new qn({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function mM(n){return n[0]>0&&n[1]>0}function xW(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function ws(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Ew{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=ws(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Ew({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return $t()}getImage(e){return $t()}getHitDetectionImage(){return $t()}getPixelRatio(e){return 1}getImageState(){return $t()}getImageSize(){return $t()}getOrigin(){return $t()}getSize(){return $t()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ws(e)}listenImageChange(e){$t()}load(){$t()}unlistenImageChange(e){$t()}ready(){return Promise.resolve()}}class Sw extends Ew{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Tt.LOADING:Tt.LOADED,this.imageState_===Tt.LOADING&&this.ready().then(()=>this.imageState_=Tt.LOADED),this.render()}clone(){const e=this.getScale(),t=new Sw({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-t[0]/r[0],e[1]/2+t[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let i=Na.get(r,null,null)?.getImage(1);if(!i){const s=this.renderOptions_,a=Math.ceil(s.size*e),o=ti(a,a);this.draw_(s,o,e),i=o.canvas,Na.set(r,null,null,new GD(i,void 0,null,Tt.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,r){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){const W=i;i=s,s=W}const a=this.radius2_===void 0?this.points_:this.points_*2,o=2*Math.PI/a,l=s*Math.sin(o),c=Math.sqrt(s*s-l*l),h=i-c,g=Math.sqrt(l*l+h*h),m=g/l;if(e==="miter"&&m<=r)return m*t;const y=t/2/m,v=t/2*(h/g),E=Math.sqrt((i+y)*(i+y)+v*v)-i;if(this.radius2_===void 0||e==="bevel")return E*2;const T=i*Math.sin(o),b=Math.sqrt(i*i-T*T),R=s-b,D=Math.sqrt(T*T+R*R)/T;if(D<=r){const W=D*t/2-s-i;return 2*Math.max(E,W)}return E*2}createRenderOptions(){let e=P0,t=M0,r=0,i=null,s=0,a,o=0;this.stroke_&&(a=Zo(this.stroke_.getColor()??xp),o=this.stroke_.getWidth()??vp,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??M0,e=this.stroke_.getLineCap()??P0,r=this.stroke_.getMiterLimit()??yp);const l=this.calculateLineJoinSize_(t,o,r),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:a,strokeWidth:o,size:h,lineCap:e,lineDash:i,lineDashOffset:s,lineJoin:t,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,r){if(t.scale(r,r),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let i=this.fill_.getColor();i===null&&(i=Os),t.fillStyle=Zo(i),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=Ba(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(t=ti(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const r=this.radius;if(t===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,a=2*Math.PI/t;for(let o=0;o<t;o++){const l=s+o*a,c=o%2===0?r:i;e.lineTo(c*Math.cos(l),c*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Os,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Us extends Sw{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Us({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class mn{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=pM,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new mn({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=pM,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function _W(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(Tn(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let _S=null;function rF(n,e){if(!_S){const t=new tr({color:"rgba(255,255,255,0.4)"}),r=new qn({color:"#3399CC",width:1.25});_S=[new mn({image:new Us({fill:t,stroke:r,radius:5}),fill:t,stroke:r})]}return _S}function pM(n){return n.getGeometry()}const vW="#333";class yo{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=ws(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new tr({color:vW}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new yo({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof tr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ws(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Zr={ANIMATING:0,INTERACTING:1},jt={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},gx=[jt.FILL],hu=[jt.STROKE],Bh=[jt.BEGIN_PATH],yM=[jt.CLOSE_PATH];class yy extends zD{constructor(e,t,r,i){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(r){return r*t})}appendFlatPointCoordinates(e,t){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,s=this.coordinates;let a=s.length;for(let o=0,l=e.length;o<l;o+=t)i[0]=e[o],i[1]=e[o+1],nd(r,i)&&(s[a++]=i[0],s[a++]=i[1]);return a}appendFlatLineCoordinates(e,t,r,i,s,a){const o=this.coordinates;let l=o.length;const c=this.getBufferedMaxExtent();a&&(t+=i);let h=e[t],g=e[t+1];const m=this.tmpCoordinate_;let y=!0,v,_,E;for(v=t+i;v<r;v+=i)m[0]=e[v],m[1]=e[v+1],E=$T(c,m),E!==_?(y&&(o[l++]=h,o[l++]=g,y=!1),o[l++]=m[0],o[l++]=m[1]):E===wi.INTERSECTING?(o[l++]=m[0],o[l++]=m[1],y=!1):y=!0,h=m[0],g=m[1],_=E;return(s&&y||v===t+i)&&(o[l++]=h,o[l++]=g),l}drawCustomCoordinates_(e,t,r,i,s){for(let a=0,o=r.length;a<o;++a){const l=r[a],c=this.appendFlatLineCoordinates(e,t,l,i,!1,!1);s.push(c),t=l}return t}drawCustom(e,t,r,i,s){this.beginGeometry(e,t,s);const a=e.getType(),o=e.getStride(),l=this.coordinates.length;let c,h,g,m,y;switch(a){case"MultiPolygon":c=e.getOrientedFlatCoordinates(),m=[];const v=e.getEndss();y=0;for(let _=0,E=v.length;_<E;++_){const T=[];y=this.drawCustomCoordinates_(c,y,v[_],o,T),m.push(T)}this.instructions.push([jt.CUSTOM,l,m,e,r,QT,s]),this.hitDetectionInstructions.push([jt.CUSTOM,l,m,e,i||r,QT,s]);break;case"Polygon":case"MultiLineString":g=[],c=a=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),y=this.drawCustomCoordinates_(c,0,e.getEnds(),o,g),this.instructions.push([jt.CUSTOM,l,g,e,r,pp,s]),this.hitDetectionInstructions.push([jt.CUSTOM,l,g,e,i||r,pp,s]);break;case"LineString":case"Circle":c=e.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,o,!1,!1),this.instructions.push([jt.CUSTOM,l,h,e,r,cu,s]),this.hitDetectionInstructions.push([jt.CUSTOM,l,h,e,i||r,cu,s]);break;case"MultiPoint":c=e.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,o),h>l&&(this.instructions.push([jt.CUSTOM,l,h,e,r,cu,s]),this.hitDetectionInstructions.push([jt.CUSTOM,l,h,e,i||r,cu,s]));break;case"Point":c=e.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([jt.CUSTOM,l,h,e,r,void 0,s]),this.hitDetectionInstructions.push([jt.CUSTOM,l,h,e,i||r,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,r){this.beginGeometryInstruction1_=[jt.BEGIN_GEOMETRY,t,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[jt.BEGIN_GEOMETRY,t,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const r=e.length;let i,s,a=-1;for(t=0;t<r;++t)i=e[t],s=i[0],s==jt.END_GEOMETRY?a=t:s==jt.BEGIN_GEOMETRY&&(i[2]=t,gU(this.hitDetectionInstructions,a,t),a=-1)}fillStyleToState(e,t={}){if(e){const r=e.getColor();t.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,t.fillStyle=Zo(r||Os)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const r=e.getColor();t.strokeStyle=Zo(r||xp);const i=e.getLineCap();t.lineCap=i!==void 0?i:P0;const s=e.getLineDash();t.lineDash=s?s.slice():ql;const a=e.getLineDashOffset();t.lineDashOffset=a||Yl;const o=e.getLineJoin();t.lineJoin=o!==void 0?o:M0;const l=e.getWidth();t.lineWidth=l!==void 0?l:vp;const c=e.getMiterLimit();t.miterLimit=c!==void 0?c:yp,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(t,r)}createFill(e){const t=e.fillStyle,r=[jt.SET_FILL_STYLE,t];return typeof t!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[jt.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,t){const r=e.strokeStyle,i=e.lineCap,s=e.lineDash,a=e.lineDashOffset,o=e.lineJoin,l=e.lineWidth,c=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||s!=e.currentLineDash&&!hc(e.currentLineDash,s)||e.currentLineDashOffset!=a||e.currentLineJoin!=o||e.currentLineWidth!=l||e.currentMiterLimit!=c)&&(t.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=s,e.currentLineDashOffset=a,e.currentLineJoin=o,e.currentLineWidth=l,e.currentMiterLimit=c)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[jt.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=iD(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;k0(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class wW extends yy{constructor(e,t,r,i){super(e,t,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,r){if(!this.image_||this.maxExtent&&!nd(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=e.getStride(),a=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([jt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([jt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,r){if(!this.image_)return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=[];for(let l=0,c=i.length;l<c;l+=e.getStride())(!this.maxExtent||nd(this.maxExtent,i.slice(l,l+2)))&&s.push(i[l],i[l+1]);const a=this.coordinates.length,o=this.appendFlatPointCoordinates(s,2);this.instructions.push([jt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([jt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const r=e.getAnchor(),i=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class EW extends yy{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinates_(e,t,r,i){const s=this.coordinates.length,a=this.appendFlatLineCoordinates(e,t,r,i,!1,!1),o=[jt.MOVE_TO_LINE_TO,s,a];return this.instructions.push(o),this.hitDetectionInstructions.push(o),r}drawLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([jt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ql,Yl],Bh);const o=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(o,0,o.length,l),this.hitDetectionInstructions.push(hu),this.endGeometry(t)}drawMultiLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([jt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ql,Yl],Bh);const o=e.getEnds(),l=e.getFlatCoordinates(),c=e.getStride();let h=0;for(let g=0,m=o.length;g<m;++g)h=this.drawFlatCoordinates_(l,h,o[g],c);this.hitDetectionInstructions.push(hu),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(hu),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(hu),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Bh)}}class xM extends yy{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinatess_(e,t,r,i){const s=this.state,a=s.fillStyle!==void 0,o=s.strokeStyle!==void 0,l=r.length;this.instructions.push(Bh),this.hitDetectionInstructions.push(Bh);for(let c=0;c<l;++c){const h=r[c],g=this.coordinates.length,m=this.appendFlatLineCoordinates(e,t,h,i,!0,!o),y=[jt.MOVE_TO_LINE_TO,g,m];this.instructions.push(y),this.hitDetectionInstructions.push(y),o&&(this.instructions.push(yM),this.hitDetectionInstructions.push(yM)),t=h}return a&&(this.instructions.push(gx),this.hitDetectionInstructions.push(gx)),o&&(this.instructions.push(hu),this.hitDetectionInstructions.push(hu)),t}drawCircle(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([jt.SET_FILL_STYLE,Os]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([jt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ql,Yl]);const o=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,l,!1,!1);const h=[jt.CIRCLE,c];this.instructions.push(Bh,h),this.hitDetectionInstructions.push(Bh,h),i.fillStyle!==void 0&&(this.instructions.push(gx),this.hitDetectionInstructions.push(gx)),i.strokeStyle!==void 0&&(this.instructions.push(hu),this.hitDetectionInstructions.push(hu)),this.endGeometry(t)}drawPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([jt.SET_FILL_STYLE,Os]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([jt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ql,Yl]);const o=e.getEnds(),l=e.getOrientedFlatCoordinates(),c=e.getStride();this.drawFlatCoordinatess_(l,0,o,c),this.endGeometry(t)}drawMultiPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([jt.SET_FILL_STYLE,Os]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([jt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ql,Yl]);const o=e.getEndss(),l=e.getOrientedFlatCoordinates(),c=e.getStride();let h=0;for(let g=0,m=o.length;g<m;++g)h=this.drawFlatCoordinatess_(l,h,o[g],c);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let r=0,i=t.length;r<i;++r)t[r]=Eh(t[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function SW(n,e,t,r,i){const s=[];let a=t,o=0,l=e.slice(t,2);for(;o<n&&a+i<r;){const[c,h]=l.slice(-2),g=e[a+i],m=e[a+i+1],y=Math.sqrt((g-c)*(g-c)+(m-h)*(m-h));if(o+=y,o>=n){const v=(n-o+y)/y,_=aa(c,g,v),E=aa(h,m,v);l.push(_,E),s.push(l),l=[_,E],o==n&&(a+=i),o=0}else if(o<n)l.push(e[a+i],e[a+i+1]),a+=i;else{const v=y-o,_=aa(c,g,v/y),E=aa(h,m,v/y);l.push(_,E),s.push(l),l=[_,E],o=0,a+=i}}return o>0&&s.push(l),s}function TW(n,e,t,r,i){let s=t,a=t,o=0,l=0,c=t,h,g,m,y,v,_,E,T,b,R;for(g=t;g<r;g+=i){const N=e[g],D=e[g+1];v!==void 0&&(b=N-v,R=D-_,y=Math.sqrt(b*b+R*R),E!==void 0&&(l+=m,h=Math.acos((E*b+T*R)/(m*y)),h>n&&(l>o&&(o=l,s=c,a=g),l=0,c=g-i)),m=y,E=b,T=R),v=N,_=D}return l+=y,l>o?[c,g]:[s,a]}const F_={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class bW extends yy{constructor(e,t,r,i){super(e,t,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Os]={fillStyle:Os},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,r){const i=this.textFillState_,s=this.textStrokeState_,a=this.textState_;if(this.text_===""||!a||!i&&!s)return;const o=this.coordinates;let l=o.length;const c=e.getType();let h=null,g=e.getStride();if(a.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!_s(this.maxExtent,e.getExtent()))return;let m;if(h=e.getFlatCoordinates(),c=="LineString")m=[h.length];else if(c=="MultiLineString")m=e.getEnds();else if(c=="Polygon")m=e.getEnds().slice(0,1);else if(c=="MultiPolygon"){const E=e.getEndss();m=[];for(let T=0,b=E.length;T<b;++T)m.push(E[T][0])}this.beginGeometry(e,t,r);const y=a.repeat,v=y?void 0:a.textAlign;let _=0;for(let E=0,T=m.length;E<T;++E){let b;y?b=SW(y*this.resolution,h,_,m[E],g):b=[h.slice(_,m[E])];for(let R=0,N=b.length;R<N;++R){const D=b[R];let W=0,I=D.length;if(v==null){const M=TW(a.maxAngle,D,0,D.length,2);W=M[0],I=M[1]}for(let M=W;M<I;M+=g)o.push(D[M],D[M+1]);const A=o.length;_=m[E],this.drawChars_(l,A),l=A}}this.endGeometry(t)}else{let m=a.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=e.getFlatCoordinates();break;case"LineString":h=e.getFlatMidpoint();break;case"Circle":h=e.getCenter();break;case"MultiLineString":h=e.getFlatMidpoints(),g=2;break;case"Polygon":h=e.getFlatInteriorPoint(),a.overflow||m.push(h[2]/this.resolution),g=3;break;case"MultiPolygon":const N=e.getFlatInteriorPoints();h=[];for(let D=0,W=N.length;D<W;D+=3)a.overflow||m.push(N[D+2]/this.resolution),h.push(N[D],N[D+1]);if(h.length===0)return;g=2;break}const y=this.appendFlatPointCoordinates(h,g);if(y===l)return;if(m&&(y-l)/2!==h.length/g){let N=l/2;m=m.filter((D,W)=>{const I=o[(N+W)*2]===h[W*g]&&o[(N+W)*2+1]===h[W*g+1];return I||--N,I})}this.saveTextStates_();const v=a.backgroundFill?this.createFill(this.fillStyleToState(a.backgroundFill)):null,_=a.backgroundStroke?this.createStroke(this.strokeStyleToState(a.backgroundStroke)):null;this.beginGeometry(e,t,r);let E=a.padding;if(E!=Vh&&(a.scale[0]<0||a.scale[1]<0)){let N=a.padding[0],D=a.padding[1],W=a.padding[2],I=a.padding[3];a.scale[0]<0&&(D=-D,I=-I),a.scale[1]<0&&(N=-N,W=-W),E=[N,D,W,I]}const T=this.pixelRatio;this.instructions.push([jt.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,E==Vh?Vh:E.map(function(N){return N*T}),v,_,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]);const b=1/T,R=v?v.slice(0):null;R&&(R[1]=Os),this.hitDetectionInstructions.push([jt.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[b,b],NaN,this.declutterMode_,this.declutterImageWithText_,E,R,_,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Os:this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||_p,justify:t.justify,textBaseline:t.textBaseline||O_,scale:t.scale});const a=this.fillKey_;r&&(a in this.fillStates||(this.fillStates[a]={fillStyle:r.fillStyle}))}drawChars_(e,t){const r=this.textStrokeState_,i=this.textState_,s=this.strokeKey_,a=this.textKey_,o=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=F_[i.textBaseline],h=this.textOffsetY_*l,g=this.text_,m=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([jt.DRAW_CHARS,e,t,c,i.overflow,o,i.maxAngle,l,h,s,m*l,g,a,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([jt.DRAW_CHARS,e,t,c,i.overflow,o&&Os,i.maxAngle,l,h,s,m*l,g,a,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let r,i,s;if(!e)this.text_="";else{const a=e.getFill();a?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=Zo(a.getColor()||Os)):(i=null,this.textFillState_=i);const o=e.getStroke();if(!o)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const _=o.getLineDash(),E=o.getLineDashOffset(),T=o.getWidth(),b=o.getMiterLimit();s.lineCap=o.getLineCap()||P0,s.lineDash=_?_.slice():ql,s.lineDashOffset=E===void 0?Yl:E,s.lineJoin=o.getLineJoin()||M0,s.lineWidth=T===void 0?vp:T,s.miterLimit=b===void 0?yp:b,s.strokeStyle=Zo(o.getColor()||xp)}r=this.textState_;const l=e.getFont()||UD;$$(l);const c=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||O_,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||Vh,r.scale=c===void 0?[1,1]:c;const h=e.getOffsetX(),g=e.getOffsetY(),m=e.getRotateWithView(),y=e.getKeepUpright(),v=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=g===void 0?0:g,this.textRotateWithView_=m===void 0?!1:m,this.textKeepUpright_=y===void 0?!0:y,this.textRotation_=v===void 0?0:v,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:Ut(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+Ut(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const RW={Circle:xM,Default:yy,Image:wW,LineString:EW,Polygon:xM,Text:bW};class AW{constructor(e,t,r,i){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const r=this.buildersByZIndex_[t];for(const i in r){const s=r[i].finish();e[t][i]=s}}return e}getBuilder(e,t){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let s=i[t];if(s===void 0){const a=RW[t];s=new a(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=s}return s}}function kW(n,e,t,r,i,s,a,o,l,c,h,g,m=!0){let y=n[e],v=n[e+1],_=0,E=0,T=0,b=0;function R(){_=y,E=v,e+=r,y=n[e],v=n[e+1],b+=T,T=Math.sqrt((y-_)*(y-_)+(v-E)*(v-E))}do R();while(e<t-r&&b+T<s);let N=T===0?0:(s-b)/T;const D=aa(_,y,N),W=aa(E,v,N),I=e-r,A=b,M=s+o*l(c,i,h);for(;e<t-r&&b+T<M;)R();N=T===0?0:(M-b)/T;const O=aa(_,y,N),L=aa(E,v,N);let z=!1;if(m)if(g){const Le=[D,W,O,L];bD(Le,0,4,2,g,Le,Le),z=Le[0]>Le[2]}else z=D>O;const j=Math.PI,Ee=[],Ce=I+r===e;e=I,T=0,b=A,y=n[e],v=n[e+1];let Ge;if(Ce){R(),Ge=Math.atan2(v-E,y-_),z&&(Ge+=Ge>0?-j:j);const Le=(O+D)/2,ce=(L+W)/2;return Ee[0]=[Le,ce,(M-s)/2,Ge,i],Ee}i=i.replace(/\n/g," ");for(let Le=0,ce=i.length;Le<ce;){R();let Me=Math.atan2(v-E,y-_);if(z&&(Me+=Me>0?-j:j),Ge!==void 0){let se=Me-Ge;if(se+=se>j?-2*j:se<-j?2*j:0,Math.abs(se)>a)return null}Ge=Me;const Te=Le;let ie=0;for(;Le<ce;++Le){const se=z?ce-Le-1:Le,he=o*l(c,i[se],h);if(e+r<t&&b+T<s+ie+he/2)break;ie+=he}if(Le===Te)continue;const V=z?i.substring(ce-Te,ce-Le):i.substring(Te,Le);N=T===0?0:(s+ie/2-b)/T;const Z=aa(_,y,N),te=aa(E,v,N);Ee.push([Z,te,ie/2,Me,V]),s+=ie}return Ee}class iF{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(N_(),{get:(e,t)=>{if(typeof N_()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,r)=>(this.push_(t,r),!0)})}push_(...e){const t=this.instructions_,r=this.zIndex+this.offset_;t[r]||(t[r]=[]),t[r].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let r=0,i=t.length;r<i;++r){const s=t[r];if(typeof s=="function"){s(e);continue}const a=t[++r];if(typeof e[s]=="function")e[s](...a);else{if(typeof a=="function"){e[s]=a(e);continue}e[s]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Ef=zs(),Uc=[],Nl=[],Ll=[],$c=[];function _M(n){return n[3].declutterBox}const vM=new RegExp("[-----]");function vS(n,e){return e==="start"?e=vM.test(n)?"right":"left":e==="end"&&(e=vM.test(n)?"left":"right"),F_[e]}function IW(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function CW(n,e,t){return t%2===0&&(n+=e),n}class PW{constructor(e,t,r,i,s){this.overlaps=r,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=fi(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new iF:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,r,i){const s=e+t+r+i;if(this.labels_[s])return this.labels_[s];const a=i?this.strokeStates[i]:null,o=r?this.fillStates[r]:null,l=this.textStates[t],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],g=l.justify?F_[l.justify]:vS(Array.isArray(e)?e[0]:e,l.textAlign||_p),m=i&&a.lineWidth?a.lineWidth:0,y=Array.isArray(e)?e:String(e).split(`
`).reduce(IW,[]),{width:v,height:_,widths:E,heights:T,lineWidths:b}=H$(l,y),R=v+m,N=[],D=(R+2)*h[0],W=(_+m)*h[1],I={width:D<0?Math.floor(D):Math.ceil(D),height:W<0?Math.floor(W):Math.ceil(W),contextInstructions:N};(h[0]!=1||h[1]!=1)&&N.push("scale",h),i&&(N.push("strokeStyle",a.strokeStyle),N.push("lineWidth",m),N.push("lineCap",a.lineCap),N.push("lineJoin",a.lineJoin),N.push("miterLimit",a.miterLimit),N.push("setLineDash",[a.lineDash]),N.push("lineDashOffset",a.lineDashOffset)),r&&N.push("fillStyle",o.fillStyle),N.push("textBaseline","middle"),N.push("textAlign","center");const A=.5-g;let M=g*R+A*m;const O=[],L=[];let z=0,j=0,Ee=0,Ce=0,Ge;for(let Le=0,ce=y.length;Le<ce;Le+=2){const Me=y[Le];if(Me===`
`){j+=z,z=0,M=g*R+A*m,++Ce;continue}const Te=y[Le+1]||l.font;Te!==Ge&&(i&&O.push("font",Te),r&&L.push("font",Te),Ge=Te),z=Math.max(z,T[Ee]);const ie=[Me,M+A*E[Ee]+g*(E[Ee]-b[Ce]),.5*(m+z)+j];M+=E[Ee],i&&O.push("strokeText",ie),r&&L.push("fillText",ie),++Ee}return Array.prototype.push.apply(N,O),Array.prototype.push.apply(N,L),this.labels_[s]=I,I}replayTextBackground_(e,t,r,i,s,a,o){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,t),a&&(this.alignAndScaleFill_=a[2],e.fillStyle=a[1],this.fill_(e)),o&&(this.setStrokeStyle_(e,o),e.stroke())}calculateImageOrLabelDimensions_(e,t,r,i,s,a,o,l,c,h,g,m,y,v,_,E){o*=m[0],l*=m[1];let T=r-o,b=i-l;const R=s+c>e?e-c:s,N=a+h>t?t-h:a,D=v[3]+R*m[0]+v[1],W=v[0]+N*m[1]+v[2],I=T-v[3],A=b-v[0];(_||g!==0)&&(Uc[0]=I,$c[0]=I,Uc[1]=A,Nl[1]=A,Nl[0]=I+D,Ll[0]=Nl[0],Ll[1]=A+W,$c[1]=Ll[1]);let M;return g!==0?(M=Va(fi(),r,i,1,1,g,-r,-i),Fr(M,Uc),Fr(M,Nl),Fr(M,Ll),Fr(M,$c),Iu(Math.min(Uc[0],Nl[0],Ll[0],$c[0]),Math.min(Uc[1],Nl[1],Ll[1],$c[1]),Math.max(Uc[0],Nl[0],Ll[0],$c[0]),Math.max(Uc[1],Nl[1],Ll[1],$c[1]),Ef)):Iu(Math.min(I,I+D),Math.min(A,A+W),Math.max(I,I+D),Math.max(A,A+W),Ef),y&&(T=Math.round(T),b=Math.round(b)),{drawImageX:T,drawImageY:b,drawImageW:R,drawImageH:N,originX:c,originY:h,declutterBox:{minX:Ef[0],minY:Ef[1],maxX:Ef[2],maxY:Ef[3],value:E},canvasTransform:M,scale:m}}replayImageOrLabel_(e,t,r,i,s,a,o){const l=!!(a||o),c=i.declutterBox,h=o?o[2]*i.scale[0]/2:0;return c.minX-h<=t[0]&&c.maxX+h>=0&&c.minY-h<=t[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(e,Uc,Nl,Ll,$c,a,o),K$(e,i.canvasTransform,s,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const r=Fr(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,r,i){const s=this.textStates[t],a=this.createLabel(e,t,i,r),o=this.strokeStates[r],l=this.pixelRatio,c=vS(Array.isArray(e)?e[0]:e,s.textAlign||_p),h=F_[s.textBaseline||O_],g=o&&o.lineWidth?o.lineWidth:0,m=a.width/l-2*s.scale[0],y=c*m+2*(.5-c)*g,v=h*a.height/l+2*(.5-h)*g;return{label:a,anchorX:y,anchorY:v}}execute_(e,t,r,i,s,a,o,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&hc(r,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=el(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),TD(this.renderedTransform_,r));let g=0;const m=i.length;let y=0,v,_,E,T,b,R,N,D,W,I,A,M,O,L=0,z=0;const j=this.coordinateCache_,Ee=this.viewRotation_,Ce=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,Ge={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Ee},Le=this.instructions!=i||this.overlaps?0:200;let ce,Me,Te,ie;for(;g<m;){const V=i[g];switch(V[0]){case jt.BEGIN_GEOMETRY:ce=V[1],ie=V[3],ce.getGeometry()?o!==void 0&&!_s(o,ie.getExtent())?g=V[2]+1:++g:g=V[2],c&&(c.zIndex=V[4]);break;case jt.BEGIN_PATH:L>Le&&(this.fill_(e),L=0),z>Le&&(e.stroke(),z=0),!L&&!z&&(e.beginPath(),b=NaN,R=NaN),++g;break;case jt.CIRCLE:y=V[1];const te=h[y],se=h[y+1],he=h[y+2],Ae=h[y+3],Fe=he-te,de=Ae-se,Pe=Math.sqrt(Fe*Fe+de*de);e.moveTo(te+Pe,se),e.arc(te,se,Pe,0,2*Math.PI,!0),++g;break;case jt.CLOSE_PATH:e.closePath(),++g;break;case jt.CUSTOM:y=V[1],v=V[2];const Be=V[3],It=V[4],Wt=V[5];Ge.geometry=Be,Ge.feature=ce,g in j||(j[g]=[]);const Dt=j[g];Wt?Wt(h,y,v,2,Dt):(Dt[0]=h[y],Dt[1]=h[y+1],Dt.length=2),c&&(c.zIndex=V[6]),It(Dt,Ge),++g;break;case jt.DRAW_IMAGE:y=V[1],v=V[2],W=V[3],_=V[4],E=V[5];let Zt=V[6];const rn=V[7],ht=V[8],rr=V[9],hn=V[10];let cn=V[11];const ir=V[12];let Pi=V[13];T=V[14]||"declutter";const jn=V[15];if(!W&&V.length>=20){I=V[19],A=V[20],M=V[21],O=V[22];const ee=this.drawLabelWithPointPlacement_(I,A,M,O);W=ee.label,V[3]=W;const ne=V[23];_=(ee.anchorX-ne)*this.pixelRatio,V[4]=_;const ue=V[24];E=(ee.anchorY-ue)*this.pixelRatio,V[5]=E,Zt=W.height,V[6]=Zt,Pi=W.width,V[13]=Pi}let Sr;V.length>25&&(Sr=V[25]);let ai,_t,pn;V.length>17?(ai=V[16],_t=V[17],pn=V[18]):(ai=Vh,_t=null,pn=null),hn&&Ce?cn+=Ee:!hn&&!Ce&&(cn-=Ee);let bn=0;for(;y<v;y+=2){if(Sr&&Sr[bn++]<Pi/this.pixelRatio)continue;const ee=this.calculateImageOrLabelDimensions_(W.width,W.height,h[y],h[y+1],Pi,Zt,_,E,ht,rr,cn,ir,s,ai,!!_t||!!pn,ce),ne=[e,t,W,ee,rn,_t,pn];if(l){let ue,Ie,Ve;if(jn){const Qe=v-y;if(!jn[Qe]){jn[Qe]={args:ne,declutterMode:T};continue}const yt=jn[Qe];ue=yt.args,Ie=yt.declutterMode,delete jn[Qe],Ve=_M(ue)}let He,Je;if(ue&&(Ie!=="declutter"||!l.collides(Ve))&&(He=!0),(T!=="declutter"||!l.collides(ee.declutterBox))&&(Je=!0),Ie==="declutter"&&T==="declutter"){const Qe=He&&Je;He=Qe,Je=Qe}He&&(Ie!=="none"&&l.insert(Ve),this.replayImageOrLabel_.apply(this,ue)),Je&&(T!=="none"&&l.insert(ee.declutterBox),this.replayImageOrLabel_.apply(this,ne))}else this.replayImageOrLabel_.apply(this,ne)}++g;break;case jt.DRAW_CHARS:const Et=V[1],sn=V[2],Nt=V[3],Xi=V[4];O=V[5];const Mr=V[6],oi=V[7],tn=V[8];M=V[9];const Tr=V[10];I=V[11],Array.isArray(I)&&(I=I.reduce(CW,"")),A=V[12];const je=[V[13],V[13]];T=V[14]||"declutter";const ye=V[15],xe=this.textStates[A],Ot=xe.font,P=[xe.scale[0]*oi,xe.scale[1]*oi];let ct;Ot in this.widths_?ct=this.widths_[Ot]:(ct={},this.widths_[Ot]=ct);const U=eA(h,Et,sn,2),re=Math.abs(P[0])*aM(Ot,I,ct);if(Xi||re<=U){const ee=this.textStates[A].textAlign,ne=(U-re)*vS(I,ee),ue=kW(h,Et,sn,2,I,ne,Mr,Math.abs(P[0]),aM,Ot,ct,Ce?0:this.viewRotation_,ye);e:if(ue){const Ie=[];let Ve,He,Je,Qe,yt;if(M)for(Ve=0,He=ue.length;Ve<He;++Ve){yt=ue[Ve],Je=yt[4],Qe=this.createLabel(Je,A,"",M),_=yt[2]+(P[0]<0?-Tr:Tr),E=Nt*Qe.height+(.5-Nt)*2*Tr*P[1]/P[0]-tn;const St=this.calculateImageOrLabelDimensions_(Qe.width,Qe.height,yt[0],yt[1],Qe.width,Qe.height,_,E,0,0,yt[3],je,!1,Vh,!1,ce);if(l&&T==="declutter"&&l.collides(St.declutterBox))break e;Ie.push([e,t,Qe,St,1,null,null])}if(O)for(Ve=0,He=ue.length;Ve<He;++Ve){yt=ue[Ve],Je=yt[4],Qe=this.createLabel(Je,A,O,""),_=yt[2],E=Nt*Qe.height-tn;const St=this.calculateImageOrLabelDimensions_(Qe.width,Qe.height,yt[0],yt[1],Qe.width,Qe.height,_,E,0,0,yt[3],je,!1,Vh,!1,ce);if(l&&T==="declutter"&&l.collides(St.declutterBox))break e;Ie.push([e,t,Qe,St,1,null,null])}l&&T!=="none"&&l.load(Ie.map(_M));for(let St=0,Rn=Ie.length;St<Rn;++St)this.replayImageOrLabel_.apply(this,Ie[St])}}++g;break;case jt.END_GEOMETRY:if(a!==void 0){ce=V[1];const ee=a(ce,ie,T);if(ee)return ee}++g;break;case jt.FILL:Le?L++:this.fill_(e),++g;break;case jt.MOVE_TO_LINE_TO:for(y=V[1],v=V[2],Me=h[y],Te=h[y+1],e.moveTo(Me,Te),b=Me+.5|0,R=Te+.5|0,y+=2;y<v;y+=2)Me=h[y],Te=h[y+1],N=Me+.5|0,D=Te+.5|0,(y==v-2||N!==b||D!==R)&&(e.lineTo(Me,Te),b=N,R=D);++g;break;case jt.SET_FILL_STYLE:this.alignAndScaleFill_=V[2],L&&(this.fill_(e),L=0,z&&(e.stroke(),z=0)),e.fillStyle=V[1],++g;break;case jt.SET_STROKE_STYLE:z&&(e.stroke(),z=0),this.setStrokeStyle_(e,V),++g;break;case jt.STROKE:Le?z++:e.stroke(),++g;break;default:++g;break}}L&&this.fill_(e),z&&e.stroke()}execute(e,t,r,i,s,a){this.viewRotation_=i,this.execute_(e,t,r,this.instructions,s,void 0,void 0,a)}executeHitDetection(e,t,r,i,s){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,i,s)}}const Ph=["Polygon","Circle","LineString","Image","Text","Default"],sF=["Image","Text"],MW=Ph.filter(n=>!sF.includes(n));class NW{constructor(e,t,r,i,s,a,o){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=t,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=fi(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,o)}clip(e,t){const r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,t){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const s=e[r];for(const a in s){const o=s[a];i[a]=new PW(this.resolution_,this.pixelRatio_,this.overlaps_,o,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const r=this.executorsByZIndex_[t];for(let i=0,s=e.length;i<s;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,t,r,i,s,a){i=Math.round(i);const o=i*2+1,l=Va(this.hitDetectionTransform_,i+.5,i+.5,1/t,-1/t,-r,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=ti(o,o));const h=this.hitDetectionContext_;h.canvas.width!==o||h.canvas.height!==o?(h.canvas.width=o,h.canvas.height=o):c||h.clearRect(0,0,o,o);let g;this.renderBuffer_!==void 0&&(g=zs(),Nm(g,e),k0(g,t*(this.renderBuffer_+i),g));const m=LW(i);let y;function v(D,W,I){const A=h.getImageData(0,0,o,o).data;for(let M=0,O=m.length;M<O;M++)if(A[m[M]]>0){if(!a||I==="none"||y!=="Image"&&y!=="Text"||a.includes(D)){const L=(m[M]-3)/4,z=i-L%o,j=i-(L/o|0),Ee=s(D,W,z*z+j*j);if(Ee)return Ee}h.clearRect(0,0,o,o);break}}const _=Object.keys(this.executorsByZIndex_).map(Number);_.sort(Hl);let E,T,b,R,N;for(E=_.length-1;E>=0;--E){const D=_[E].toString();for(b=this.executorsByZIndex_[D],T=Ph.length-1;T>=0;--T)if(y=Ph[T],R=b[y],R!==void 0&&(N=R.executeHitDetection(h,l,r,v,g),N))return N}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const r=t[0],i=t[1],s=t[2],a=t[3],o=[r,i,r,a,s,a,s,i];return el(o,0,8,2,e,o),o}isEmpty(){return td(this.executorsByZIndex_)}execute(e,t,r,i,s,a,o){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(o?fU:Hl),a=a||Ph;const c=Ph.length;for(let h=0,g=l.length;h<g;++h){const m=l[h].toString(),y=this.executorsByZIndex_[m];for(let v=0,_=a.length;v<_;++v){const E=a[v],T=y[E];if(T!==void 0){const b=o===null?void 0:T.getZIndexContext(),R=b?b.getContext():e,N=this.maxExtent_&&E!=="Image"&&E!=="Text";if(N&&(R.save(),this.clip(R,r)),!b||E==="Text"||E==="Image"?T.execute(R,t,r,i,s,o):b.pushFunction(D=>T.execute(D,t,r,i,s,o)),N&&R.restore(),b){b.offset();const D=l[h]*c+Ph.indexOf(E);this.deferredZIndexContexts_[D]||(this.deferredZIndexContexts_[D]=[]),this.deferredZIndexContexts_[D].push(b)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Hl);for(let r=0,i=t.length;r<i;++r)e[t[r]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[r]].length=0}}const wS={};function LW(n){if(wS[n]!==void 0)return wS[n];const e=n*2+1,t=n*n,r=new Array(t+1);for(let s=0;s<=n;++s)for(let a=0;a<=n;++a){const o=s*s+a*a;if(o>t)break;let l=r[o];l||(l=[],r[o]=l),l.push(((n+s)*e+(n+a))*4+3),s>0&&l.push(((n-s)*e+(n+a))*4+3),a>0&&(l.push(((n+s)*e+(n-a))*4+3),s>0&&l.push(((n-s)*e+(n-a))*4+3))}const i=[];for(let s=0,a=r.length;s<a;++s)r[s]&&i.push(...r[s]);return wS[n]=i,i}function wM(n,e,t,r){return t!==void 0&&r!==void 0?[t/n,r/e]:t!==void 0?t/n:r!==void 0?r/e:1}let xy=class aF extends Ew{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const a=e.img!==void 0?e.img:null;let o=e.src;Tn(!(o!==void 0&&a),"`image` and `src` cannot be provided at the same time"),(o===void 0||o.length===0)&&a&&(o=a.src||Ut(a)),Tn(o!==void 0&&o.length>0,"A defined and non-empty `src` or `image` must be provided"),Tn(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=Tt.IDLE:a!==void 0&&("complete"in a?a.complete?l=a.src?Tt.LOADED:Tt.IDLE:l=Tt.LOADING:l=Tt.LOADED),this.color_=e.color!==void 0?Ba(e.color):null,this.iconImage_=L_(a,o,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let c,h;if(e.size)[c,h]=e.size;else{const g=this.getImage(1);if(g.width&&g.height)c=g.width,h=g.height;else if(g instanceof HTMLImageElement){this.initialOptions_=e;const m=()=>{if(this.unlistenImageChange(m),!this.initialOptions_)return;const y=this.iconImage_.getSize();this.setScale(wM(y[0],y[1],e.width,e.height))};this.listenImageChange(m);return}}c!==void 0&&this.setScale(wM(c,h,e.width,e.height))}}clone(){let e,t,r;return this.initialOptions_?(t=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new aF({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),r=this.getScaleArray();return[e[0]-t[0]/r[0],e[1]+t[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),r=this.iconImage_.getSize();if(!t||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=L_(null,e,this.crossOrigin_,Tt.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Tt.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Tt.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Jt.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Jt.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Xo=.5;function OW(n,e,t,r,i,s,a,o,l){const c=i,h=n[0]*Xo,g=n[1]*Xo,m=ti(h,g);m.imageSmoothingEnabled=!1;const y=m.canvas,v=new q$(m,Xo,i,null,a,o,null),_=t.length,E=Math.floor((256*256*256-1)/_),T={};for(let R=1;R<=_;++R){const N=t[R-1],D=N.getStyleFunction()||r;if(!D)continue;let W=D(N,s);if(!W)continue;Array.isArray(W)||(W=[W]);const A=(R*E).toString(16).padStart(7,"#00000");for(let M=0,O=W.length;M<O;++M){const L=W[M],z=L.getGeometryFunction()(N);if(!z||!_s(c,z.getExtent()))continue;const j=L.clone(),Ee=j.getFill();Ee&&Ee.setColor(A);const Ce=j.getStroke();Ce&&(Ce.setColor(A),Ce.setLineDash(null)),j.setText(void 0);const Ge=L.getImage();if(Ge){const Te=Ge.getImageSize();if(!Te)continue;const ie=ti(Te[0],Te[1],void 0,{alpha:!1}),V=ie.canvas;ie.fillStyle=A,ie.fillRect(0,0,V.width,V.height),j.setImage(new xy({img:V,anchor:Ge.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:Ge.getOrigin(),opacity:1,size:Ge.getSize(),scale:Ge.getScale(),rotation:Ge.getRotation(),rotateWithView:Ge.getRotateWithView()}))}const Le=j.getZIndex()||0;let ce=T[Le];ce||(ce={},T[Le]=ce,ce.Polygon=[],ce.Circle=[],ce.LineString=[],ce.Point=[]);const Me=z.getType();if(Me==="GeometryCollection"){const Te=z.getGeometriesArrayRecursive();for(let ie=0,V=Te.length;ie<V;++ie){const Z=Te[ie];ce[Z.getType().replace("Multi","")].push(Z,j)}}else ce[Me.replace("Multi","")].push(z,j)}}const b=Object.keys(T).map(Number).sort(Hl);for(let R=0,N=b.length;R<N;++R){const D=T[b[R]];for(const W in D){const I=D[W];for(let A=0,M=I.length;A<M;A+=2){v.setStyle(I[A+1]);for(let O=0,L=e.length;O<L;++O)v.setTransform(e[O]),v.drawGeometry(I[A])}}}return m.getImageData(0,0,y.width,y.height)}function DW(n,e,t){const r=[];if(t){const i=Math.floor(Math.round(n[0])*Xo),s=Math.floor(Math.round(n[1])*Xo),a=(cr(i,0,t.width-1)+cr(s,0,t.height-1)*t.width)*4,o=t.data[a],l=t.data[a+1],h=t.data[a+2]+256*(l+256*o),g=Math.floor((256*256*256-1)/e.length);h&&h%g===0&&r.push(e[h/g-1])}return r}class Om extends ml{constructor(e,t,r,i){super(e),this.inversePixelTransform=t,this.frameState=r,this.context=i}}const FW=5;class oF extends uy{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=FW}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return $t()}getData(e){return null}prepareFrame(e){return $t()}renderFrame(e,t){return $t()}forEachFeatureAtCoordinate(e,t,r,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Tt.LOADED||t.getState()===Tt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Tt.LOADED&&t!=Tt.ERROR&&e.addEventListener(Jt.CHANGE,this.boundHandleImageChange_),t==Tt.IDLE&&(e.load(),t=e.getState()),t==Tt.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const EM=[];let Gf=null;function jW(){Gf=ti(1,1,void 0,{willReadFrequently:!0})}class hA extends oF{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=fi(),this.pixelTransform=fi(),this.inversePixelTransform=fi(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,r){Gf||jW(),Gf.clearRect(0,0,1,1);let i;try{Gf.drawImage(e,t,r,1,1,0,0,1,1),i=Gf.getImageData(0,0,1,1).data}catch{return Gf=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,t,r){const i=this.getLayer().getClassName();let s,a;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&hc(Ba(e.style.backgroundColor),Ba(r)))){const o=e.firstElementChild;uu(o)&&(a=o.getContext("2d"))}if(a&&o$(a.canvas.style.transform,t)?(this.container=e,this.context=a,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=ua?DD():document.createElement("div"),s.className=i;let o=s.style;o.position="absolute",o.width="100%",o.height="100%",a=ti();const l=a.canvas;s.appendChild(l),o=l.style,o.position="absolute",o.left="0",o.transformOrigin="top left",this.container=s,this.context=a}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,t,r){const i=Rd(r),s=gw(r),a=fw(r),o=dw(r);Fr(t.coordinateToPixelTransform,i),Fr(t.coordinateToPixelTransform,s),Fr(t.coordinateToPixelTransform,a),Fr(t.coordinateToPixelTransform,o);const l=this.inversePixelTransform;Fr(l,i),Fr(l,s),Fr(l,a),Fr(l,o),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.clip()}prepareContainer(e,t){const r=e.extent,i=e.viewState.resolution,s=e.viewState.rotation,a=e.pixelRatio,o=Math.round(gn(r)/i*a),l=Math.round(Qr(r)/i*a);Va(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,s,-o/2,-l/2),mp(this.inversePixelTransform,this.pixelTransform);const c=a$(this.pixelTransform);if(this.useContainer(t,c,this.getBackground(e)),!this.containerReused){const h=this.context.canvas;h.width!=o||h.height!=l?(h.width=o,h.height=l):this.context.clearRect(0,0,o,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){const s=new Om(e,this.inversePixelTransform,r,t);i.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Si.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Si.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new iF),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Si.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Si.POSTRENDER,this.context,e))}getRenderTransform(e,t,r,i,s,a,o){const l=s/2,c=a/2,h=i/t,g=-h,m=-e[0]+o,y=-e[1];return Va(this.tempTransform,l,c,h,g,-r,m,y)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class VW extends hA{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=zs(),this.wrappedRenderedExtent_=zs(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,r){const i=t.extent,s=t.viewState,a=s.center,o=s.resolution,l=s.projection,c=s.rotation,h=l.getExtent(),g=this.getLayer().getSource(),m=this.getLayer().getDeclutter(),y=t.pixelRatio,v=t.viewHints,_=!(v[Zr.ANIMATING]||v[Zr.INTERACTING]),E=this.context,T=Math.round(gn(i)/o*y),b=Math.round(Qr(i)/o*y),R=g.getWrapX()&&l.canWrapX(),N=R?gn(h):null,D=R?Math.ceil((i[2]-h[2])/N)+1:1;let W=R?Math.floor((i[0]-h[0])/N):0;do{let I=this.getRenderTransform(a,o,0,y,T,b,W*N);t.declutter&&(I=I.slice(0)),e.execute(E,[E.canvas.width,E.canvas.height],I,c,_,r===void 0?Ph:r?sF:MW,r?m&&t.declutter[m]:void 0)}while(++W<D)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=ti(this.context.canvas.width,this.context.canvas.height,EM))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,ww(this.context),EM.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,t);const s=this.context,a=this.replayGroup_;let o=a&&!a.isEmpty();if(!o&&!(this.getLayer().hasListener(Si.PRERENDER)||this.getLayer().hasListener(Si.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),i.projection,this.clipped_=!1,o&&r.extent&&this.clipping){const l=Yo(r.extent);o=_s(l,e.extent),this.clipped_=o&&!ou(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return o&&this.renderWorlds(a,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,s=this.renderedResolution_,a=this.renderedRotation_,o=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],g=r[0]*Xo,m=r[1]*Xo;h.push(this.getRenderTransform(i,s,a,Xo,g,m,0).slice());const y=c.getSource(),v=o.getExtent();if(y.getWrapX()&&o.canWrapX()&&!ou(v,l)){let _=l[0];const E=gn(v);let T=0,b;for(;_<v[0];)--T,b=E*T,h.push(this.getRenderTransform(i,s,a,Xo,g,m,b).slice()),_+=E;for(T=0,_=l[2];_>v[2];)++T,b=E*T,h.push(this.getRenderTransform(i,s,a,Xo,g,m,b).slice()),_-=E}this.hitDetectionImageData_=OW(r,h,this.renderedFeatures_,c.getStyleFunction(),l,s,a,oM(s,this.renderedPixelRatio_))}t(DW(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,r,i,s){if(!this.replayGroup_)return;const a=t.viewState.resolution,o=t.viewState.rotation,l=this.getLayer(),c={},h=function(m,y,v){const _=Ut(m),E=c[_];if(E){if(E!==!0&&v<E.distanceSq){if(v===0)return c[_]=!0,s.splice(s.lastIndexOf(E),1),i(m,l,y);E.geometry=y,E.distanceSq=v}}else{if(v===0)return c[_]=!0,i(m,l,y);s.push(c[_]={feature:m,layer:l,geometry:y,distanceSq:v,callback:i})}},g=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,a,o,r,h,g?t.declutter?.[g]?.all().map(m=>m.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),r=t.getSource();if(!r)return!1;const i=e.viewHints[Zr.ANIMATING],s=e.viewHints[Zr.INTERACTING],a=t.getUpdateWhileAnimating(),o=t.getUpdateWhileInteracting();if(this.ready&&!a&&i||!o&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,c=e.viewState,h=c.projection,g=c.resolution,m=e.pixelRatio,y=t.getRevision(),v=t.getRenderBuffer();let _=t.getRenderOrder();_===void 0&&(_=Z$);const E=c.center.slice(),T=k0(l,v*g),b=T.slice(),R=[T.slice()],N=h.getExtent();if(r.getWrapX()&&h.canWrapX()&&!ou(N,e.extent)){const Ee=gn(N),Ce=Math.max(gn(T)/2,Ee);T[0]=N[0]-Ce,T[2]=N[2]+Ce,fD(E,h);const Ge=uD(R[0],h);Ge[0]<N[0]&&Ge[2]<N[2]?R.push([Ge[0]+Ee,Ge[1],Ge[2]+Ee,Ge[3]]):Ge[0]>N[0]&&Ge[2]>N[2]&&R.push([Ge[0]-Ee,Ge[1],Ge[2]-Ee,Ge[3]])}if(this.ready&&this.renderedResolution_==g&&this.renderedRevision_==y&&this.renderedRenderOrder_==_&&this.renderedFrameDeclutter_===!!e.declutter&&ou(this.wrappedRenderedExtent_,T))return hc(this.renderedExtent_,b)||(this.hitDetectionImageData_=null,this.renderedExtent_=b),this.renderedCenter_=E,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const D=new AW(KD(g,m),T,g,m);let W;for(let Ee=0,Ce=R.length;Ee<Ce;++Ee)r.loadFeatures(R[Ee],g,h);const I=oM(g,m);let A=!0;const M=(Ee,Ce)=>{let Ge;const Le=Ee.getStyleFunction()||t.getStyleFunction();if(Le&&(Ge=Le(Ee,g)),Ge){const ce=this.renderFeature(Ee,I,Ge,D,W,this.getLayer().getDeclutter(),Ce);A=A&&!ce}},O=ED(T),L=r.getFeaturesInExtent(O);_&&L.sort(_);for(let Ee=0,Ce=L.length;Ee<Ce;++Ee)M(L[Ee],Ee);this.renderedFeatures_=L,this.ready=A;const z=D.finish(),j=new NW(T,g,m,r.getOverlaps(),z,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=g,this.renderedRevision_=y,this.renderedRenderOrder_=_,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=b,this.wrappedRenderedExtent_=T,this.renderedCenter_=E,this.renderedProjection_=h,this.renderedPixelRatio_=m,this.replayGroup_=j,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,r,i,s,a,o){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let c=0,h=r.length;c<h;++c)l=lM(i,e,r[c],t,this.boundHandleStyleImageChange_,s,a,o)||l;else l=lM(i,e,r,t,this.boundHandleStyleImageChange_,s,a,o);return l}}let Cd=0;const Jr=1<<Cd++,At=1<<Cd++,di=1<<Cd++,vr=1<<Cd++,$s=1<<Cd++,La=1<<Cd++,mx=Math.pow(2,Cd)-1,dA={[Jr]:"boolean",[At]:"number",[di]:"string",[vr]:"color",[$s]:"number[]",[La]:"size"},BW=Object.keys(dA).map(Number).sort(Hl);function GW(n){return n in dA}function Qf(n){const e=[];for(const t of BW)_m(n,t)&&e.push(dA[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function _m(n,e){return(n&e)===e}function Ho(n,e){return n===e}class hi{constructor(e,t){if(!GW(e))throw new Error(`literal expressions must have a specific type, got ${Qf(e)}`);this.type=e,this.value=t}}class lF{constructor(e,t,...r){this.type=e,this.operator=t,this.args=r}}function fA(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Ai(n,e,t){switch(typeof n){case"boolean":{if(Ho(e,di))return new hi(di,n?"true":"false");if(!_m(e,Jr))throw new Error(`got a boolean, but expected ${Qf(e)}`);return new hi(Jr,n)}case"number":{if(Ho(e,La))return new hi(La,ws(n));if(Ho(e,Jr))return new hi(Jr,!!n);if(Ho(e,di))return new hi(di,n.toString());if(!_m(e,At))throw new Error(`got a number, but expected ${Qf(e)}`);return new hi(At,n)}case"string":{if(Ho(e,vr))return new hi(vr,iA(n));if(Ho(e,Jr))return new hi(Jr,!!n);if(!_m(e,di))throw new Error(`got a string, but expected ${Qf(e)}`);return new hi(di,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return JW(n,e,t);for(const r of n)if(typeof r!="number")throw new Error("expected an array of numbers");if(Ho(e,La)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new hi(La,n)}if(Ho(e,vr)){if(n.length===3)return new hi(vr,[...n,1]);if(n.length===4)return new hi(vr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!_m(e,$s))throw new Error(`got an array of numbers, but expected ${Qf(e)}`);return new hi($s,n)}const pe={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},zW={[pe.Get]:Xt(an(1,1/0),SM),[pe.Var]:Xt(an(1,1),UW),[pe.Has]:Xt(an(1,1/0),SM),[pe.Id]:Xt($W,Sf),[pe.Concat]:Xt(an(2,1/0),Nn(di)),[pe.GeometryType]:Xt(WW,Sf),[pe.LineMetric]:Xt(Sf),[pe.Resolution]:Xt(ES,Sf),[pe.Zoom]:Xt(ES,Sf),[pe.Time]:Xt(ES,Sf),[pe.Any]:Xt(an(2,1/0),Nn(Jr)),[pe.All]:Xt(an(2,1/0),Nn(Jr)),[pe.Not]:Xt(an(1,1),Nn(Jr)),[pe.Equal]:Xt(an(2,2),Nn(mx)),[pe.NotEqual]:Xt(an(2,2),Nn(mx)),[pe.GreaterThan]:Xt(an(2,2),Nn(At)),[pe.GreaterThanOrEqualTo]:Xt(an(2,2),Nn(At)),[pe.LessThan]:Xt(an(2,2),Nn(At)),[pe.LessThanOrEqualTo]:Xt(an(2,2),Nn(At)),[pe.Multiply]:Xt(an(2,1/0),TM),[pe.Coalesce]:Xt(an(2,1/0),TM),[pe.Divide]:Xt(an(2,2),Nn(At)),[pe.Add]:Xt(an(2,1/0),Nn(At)),[pe.Subtract]:Xt(an(2,2),Nn(At)),[pe.Clamp]:Xt(an(3,3),Nn(At)),[pe.Mod]:Xt(an(2,2),Nn(At)),[pe.Pow]:Xt(an(2,2),Nn(At)),[pe.Abs]:Xt(an(1,1),Nn(At)),[pe.Floor]:Xt(an(1,1),Nn(At)),[pe.Ceil]:Xt(an(1,1),Nn(At)),[pe.Round]:Xt(an(1,1),Nn(At)),[pe.Sin]:Xt(an(1,1),Nn(At)),[pe.Cos]:Xt(an(1,1),Nn(At)),[pe.Atan]:Xt(an(1,2),Nn(At)),[pe.Sqrt]:Xt(an(1,1),Nn(At)),[pe.Match]:Xt(an(4,1/0),bM,KW),[pe.Between]:Xt(an(3,3),Nn(At)),[pe.Interpolate]:Xt(an(6,1/0),bM,XW),[pe.Case]:Xt(an(3,1/0),HW,qW),[pe.In]:Xt(an(2,2),YW),[pe.Number]:Xt(an(1,1/0),Nn(mx)),[pe.String]:Xt(an(1,1/0),Nn(mx)),[pe.Array]:Xt(an(1,1/0),Nn(At)),[pe.Color]:Xt(an(1,4),Nn(At)),[pe.Band]:Xt(an(1,3),Nn(At)),[pe.Palette]:Xt(an(2,2),ZW),[pe.ToString]:Xt(an(1,1),Nn(Jr|At|di|vr))};function SM(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=n[s+1];switch(typeof a){case"number":{i[s]=new hi(At,a);break}case"string":{i[s]=new hi(di,a);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${a}`)}s===0&&t.properties.add(String(a))}return i}function UW(n,e,t){const r=n[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return t.variables.add(r),[new hi(di,r)]}function $W(n,e,t){t.featureId=!0}function WW(n,e,t){t.geometryType=!0}function ES(n,e,t){t.mapState=!0}function Sf(n,e,t){const r=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function an(n,e){return function(t,r,i){const s=t[0],a=t.length-1;if(n===e){if(a!==n){const o=n===1?"":"s";throw new Error(`expected ${n} argument${o} for ${s}, got ${a}`)}}else if(a<n||a>e){const o=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${o} arguments for ${s}, got ${a}`)}}}function TM(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=Ai(n[s+1],e,t);i[s]=a}return i}function Nn(n){return function(e,t,r){const i=e.length-1,s=new Array(i);for(let a=0;a<i;++a){const o=Ai(e[a+1],n,r);s[a]=o}return s}}function HW(n,e,t){const r=n[0],i=n.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function bM(n,e,t){const r=n[0],i=n.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function KW(n,e,t){const r=n.length-1,i=di|At|Jr,s=Ai(n[1],i,t),a=Ai(n[n.length-1],e,t),o=new Array(r-2);for(let l=0;l<r-2;l+=2){try{const c=Ai(n[l+2],s.type,t);o[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=Ai(n[l+3],a.type,t);o[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...o,a]}function XW(n,e,t){const r=n[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const s=new hi(At,i);let a;try{a=Ai(n[2],At,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const o=new Array(n.length-3);for(let l=0;l<o.length;l+=2){try{const c=Ai(n[l+3],At,t);o[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=Ai(n[l+4],e,t);o[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,a,...o]}function qW(n,e,t){const r=Ai(n[n.length-1],e,t),i=new Array(n.length-1);for(let s=0;s<i.length-1;s+=2){try{const a=Ai(n[s+1],Jr,t);i[s]=a}catch(a){throw new Error(`failed to parse argument ${s} of case expression: ${a.message}`)}try{const a=Ai(n[s+2],r.type,t);i[s+1]=a}catch(a){throw new Error(`failed to parse argument ${s+1} of case expression: ${a.message}`)}}return i[i.length-1]=r,i}function YW(n,e,t){let r=n[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=di}else i=At;const s=new Array(r.length);for(let o=0;o<s.length;o++)try{const l=Ai(r[o],i,t);s[o]=l}catch(l){throw new Error(`failed to parse haystack item ${o} for "in" expression: ${l.message}`)}return[Ai(n[1],i,t),...s]}function ZW(n,e,t){let r;try{r=Ai(n[1],At,t)}catch(a){throw new Error(`failed to parse first argument in palette expression: ${a.message}`)}const i=n[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const s=new Array(i.length);for(let a=0;a<s.length;a++){let o;try{o=Ai(i[a],vr,t)}catch(l){throw new Error(`failed to parse color at index ${a} in palette expression: ${l.message}`)}if(!(o instanceof hi))throw new Error(`the palette color at index ${a} must be a literal value`);s[a]=o}return[r,...s]}function Xt(...n){return function(e,t,r){const i=e[0];let s;for(let a=0;a<n.length;a++){const o=n[a](e,t,r);if(a==n.length-1){if(!o)throw new Error("expected last argument validator to return the parsed args");s=o}}return new lF(t,i,...s)}}function JW(n,e,t){const r=n[0],i=zW[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(n,e,t)}function gA(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return gA(n.getGeometries()[0]);default:return""}}function cF(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function fc(n,e,t){const r=Ai(n,e,t);return So(r)}function So(n,e){if(n instanceof hi){if(n.type===vr&&typeof n.value=="string"){const r=iA(n.value);return function(){return r}}return function(){return n.value}}const t=n.operator;switch(t){case pe.Number:case pe.String:case pe.Coalesce:return QW(n);case pe.Get:case pe.Var:case pe.Has:return eH(n);case pe.Id:return r=>r.featureId;case pe.GeometryType:return r=>r.geometryType;case pe.Concat:{const r=n.args.map(i=>So(i));return i=>"".concat(...r.map(s=>s(i).toString()))}case pe.Resolution:return r=>r.resolution;case pe.Any:case pe.All:case pe.Between:case pe.In:case pe.Not:return nH(n);case pe.Equal:case pe.NotEqual:case pe.LessThan:case pe.LessThanOrEqualTo:case pe.GreaterThan:case pe.GreaterThanOrEqualTo:return tH(n);case pe.Multiply:case pe.Divide:case pe.Add:case pe.Subtract:case pe.Clamp:case pe.Mod:case pe.Pow:case pe.Abs:case pe.Floor:case pe.Ceil:case pe.Round:case pe.Sin:case pe.Cos:case pe.Atan:case pe.Sqrt:return rH(n);case pe.Case:return iH(n);case pe.Match:return sH(n);case pe.Interpolate:return aH(n);case pe.ToString:return oH(n);default:throw new Error(`Unsupported operator ${t}`)}}function QW(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=So(n.args[s]);switch(t){case pe.Coalesce:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o<"u"&&o!==null)return o}throw new Error("Expected one of the values to be non-null")};case pe.Number:case pe.String:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o===t)return o}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function eH(n,e){const r=n.args[0].value;switch(n.operator){case pe.Get:return i=>{const s=n.args;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;a=a[h]}return a};case pe.Var:return i=>i.variables[r];case pe.Has:return i=>{const s=n.args;if(!(r in i.properties))return!1;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;if(!a||!Object.hasOwn(a,h))return!1;a=a[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function tH(n,e){const t=n.operator,r=So(n.args[0]),i=So(n.args[1]);switch(t){case pe.Equal:return s=>r(s)===i(s);case pe.NotEqual:return s=>r(s)!==i(s);case pe.LessThan:return s=>r(s)<i(s);case pe.LessThanOrEqualTo:return s=>r(s)<=i(s);case pe.GreaterThan:return s=>r(s)>i(s);case pe.GreaterThanOrEqualTo:return s=>r(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function nH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=So(n.args[s]);switch(t){case pe.Any:return s=>{for(let a=0;a<r;++a)if(i[a](s))return!0;return!1};case pe.All:return s=>{for(let a=0;a<r;++a)if(!i[a](s))return!1;return!0};case pe.Between:return s=>{const a=i[0](s),o=i[1](s),l=i[2](s);return a>=o&&a<=l};case pe.In:return s=>{const a=i[0](s);for(let o=1;o<r;++o)if(a===i[o](s))return!0;return!1};case pe.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function rH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=So(n.args[s]);switch(t){case pe.Multiply:return s=>{let a=1;for(let o=0;o<r;++o)a*=i[o](s);return a};case pe.Divide:return s=>i[0](s)/i[1](s);case pe.Add:return s=>{let a=0;for(let o=0;o<r;++o)a+=i[o](s);return a};case pe.Subtract:return s=>i[0](s)-i[1](s);case pe.Clamp:return s=>{const a=i[0](s),o=i[1](s);if(a<o)return o;const l=i[2](s);return a>l?l:a};case pe.Mod:return s=>i[0](s)%i[1](s);case pe.Pow:return s=>Math.pow(i[0](s),i[1](s));case pe.Abs:return s=>Math.abs(i[0](s));case pe.Floor:return s=>Math.floor(i[0](s));case pe.Ceil:return s=>Math.ceil(i[0](s));case pe.Round:return s=>Math.round(i[0](s));case pe.Sin:return s=>Math.sin(i[0](s));case pe.Cos:return s=>Math.cos(i[0](s));case pe.Atan:return r===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case pe.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function iH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=So(n.args[i]);return i=>{for(let s=0;s<t-1;s+=2)if(r[s](i))return r[s+1](i);return r[t-1](i)}}function sH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=So(n.args[i]);return i=>{const s=r[0](i);for(let a=1;a<t-1;a+=2)if(s===r[a](i))return r[a+1](i);return r[t-1](i)}}function aH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=So(n.args[i]);return i=>{const s=r[0](i),a=r[1](i);let o,l;for(let c=2;c<t;c+=2){const h=r[c](i);let g=r[c+1](i);const m=Array.isArray(g);if(m&&(g=O$(g)),h>=a)return c===2?g:m?lH(s,a,o,l,h,g):vm(s,a,o,l,h,g);o=h,l=g}return l}}function oH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=So(n.args[s]);switch(t){case pe.ToString:return s=>{const a=i[0](s);return n.args[0].type===vr?sA(a):a.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function vm(n,e,t,r,i,s){const a=i-t;if(a===0)return r;const o=e-t,l=n===1?o/a:(Math.pow(n,o)-1)/(Math.pow(n,a)-1);return r+l*(s-r)}function lH(n,e,t,r,i,s){if(i-t===0)return r;const o=nM(r),l=nM(s);let c=l[2]-o[2];c>180?c-=360:c<-180&&(c+=360);const h=[vm(n,e,t,o[0],i,l[0]),vm(n,e,t,o[1],i,l[1]),o[2]+vm(n,e,t,0,i,c),vm(n,e,t,r[3],i,s[3])];return D$(h)}function cH(n){return!0}function uH(n){const e=fA(),t=hH(n,e),r=cF();return function(i,s){if(r.properties=i.getPropertiesInternal(),r.resolution=s,e.featureId){const a=i.getId();a!==void 0?r.featureId=a:r.featureId=null}return e.geometryType&&(r.geometryType=gA(i.getGeometry())),t(r)}}function RM(n){const e=fA(),t=n.length,r=new Array(t);for(let a=0;a<t;++a)r[a]=sb(n[a],e);const i=cF(),s=new Array(t);return function(a,o){if(i.properties=a.getPropertiesInternal(),i.resolution=o,e.featureId){const c=a.getId();c!==void 0?i.featureId=c:i.featureId=null}let l=0;for(let c=0;c<t;++c){const h=r[c](i);h&&(s[l]=h,l+=1)}return s.length=l,s}}function hH(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i){const s=n[i],a="filter"in s?fc(s.filter,Jr,e):cH;let o;if(Array.isArray(s.style)){const l=s.style.length;o=new Array(l);for(let c=0;c<l;++c)o[c]=sb(s.style[c],e)}else o=[sb(s.style,e)];r[i]={filter:a,styles:o}}return function(i){const s=[];let a=!1;for(let o=0;o<t;++o){const l=r[o].filter;if(l(i)&&!(n[o].else&&a)){a=!0;for(const c of r[o].styles){const h=c(i);h&&s.push(h)}}}return s}}function sb(n,e){const t=Ep(n,"",e),r=Sp(n,"",e),i=dH(n,e),s=fH(n,e),a=Fs(n,"z-index",e);if(!t&&!r&&!i&&!s&&!td(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const o=new mn;return function(l){let c=!0;if(t){const h=t(l);h&&(c=!1),o.setFill(h)}if(r){const h=r(l);h&&(c=!1),o.setStroke(h)}if(i){const h=i(l);h&&(c=!1),o.setText(h)}if(s){const h=s(l);h&&(c=!1),o.setImage(h)}return a&&o.setZIndex(a(l)),c?null:o}}function Ep(n,e,t){let r;if(e+"fill-pattern-src"in n)r=yH(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;r=mA(n,e+"fill-color",t)}if(!r)return null;const i=new tr;return function(s){const a=r(s);return a===rA?null:(i.setColor(a),i)}}function Sp(n,e,t){const r=Fs(n,e+"stroke-width",t),i=mA(n,e+"stroke-color",t);if(!r&&!i)return null;const s=Vl(n,e+"stroke-line-cap",t),a=Vl(n,e+"stroke-line-join",t),o=uF(n,e+"stroke-line-dash",t),l=Fs(n,e+"stroke-line-dash-offset",t),c=Fs(n,e+"stroke-miter-limit",t),h=new qn;return function(g){if(i){const m=i(g);if(m===rA)return null;h.setColor(m)}if(r&&h.setWidth(r(g)),s){const m=s(g);if(m!=="butt"&&m!=="round"&&m!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(m)}if(a){const m=a(g);if(m!=="bevel"&&m!=="round"&&m!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(m)}return o&&h.setLineDash(o(g)),l&&h.setLineDashOffset(l(g)),c&&h.setMiterLimit(c(g)),h}}function dH(n,e){const t="text-",r=Vl(n,t+"value",e);if(!r)return null;const i=Ep(n,t,e),s=Ep(n,t+"background-",e),a=Sp(n,t,e),o=Sp(n,t+"background-",e),l=Vl(n,t+"font",e),c=Fs(n,t+"max-angle",e),h=Fs(n,t+"offset-x",e),g=Fs(n,t+"offset-y",e),m=h0(n,t+"overflow",e),y=Vl(n,t+"placement",e),v=Fs(n,t+"repeat",e),_=Tw(n,t+"scale",e),E=h0(n,t+"rotate-with-view",e),T=Fs(n,t+"rotation",e),b=Vl(n,t+"align",e),R=Vl(n,t+"justify",e),N=Vl(n,t+"baseline",e),D=h0(n,t+"keep-upright",e),W=uF(n,t+"padding",e),I=bw(n,t+"declutter-mode"),A=new yo({declutterMode:I});return function(M){if(A.setText(r(M)),i&&A.setFill(i(M)),s&&A.setBackgroundFill(s(M)),a&&A.setStroke(a(M)),o&&A.setBackgroundStroke(o(M)),l&&A.setFont(l(M)),c&&A.setMaxAngle(c(M)),h&&A.setOffsetX(h(M)),g&&A.setOffsetY(g(M)),m&&A.setOverflow(m(M)),y){const O=y(M);if(O!=="point"&&O!=="line")throw new Error("Expected point or line for text-placement");A.setPlacement(O)}if(v&&A.setRepeat(v(M)),_&&A.setScale(_(M)),E&&A.setRotateWithView(E(M)),T&&A.setRotation(T(M)),b){const O=b(M);if(O!=="left"&&O!=="center"&&O!=="right"&&O!=="end"&&O!=="start")throw new Error("Expected left, right, center, start, or end for text-align");A.setTextAlign(O)}if(R){const O=R(M);if(O!=="left"&&O!=="right"&&O!=="center")throw new Error("Expected left, right, or center for text-justify");A.setJustify(O)}if(N){const O=N(M);if(O!=="bottom"&&O!=="top"&&O!=="middle"&&O!=="alphabetic"&&O!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");A.setTextBaseline(O)}return W&&A.setPadding(W(M)),D&&A.setKeepUpright(D(M)),A}}function fH(n,e){return"icon-src"in n?gH(n,e):"shape-points"in n?mH(n,e):"circle-radius"in n?pH(n,e):null}function gH(n,e){const t="icon-",r=t+"src",i=hF(n[r],r),s=j_(n,t+"anchor",e),a=Tw(n,t+"scale",e),o=Fs(n,t+"opacity",e),l=j_(n,t+"displacement",e),c=Fs(n,t+"rotation",e),h=h0(n,t+"rotate-with-view",e),g=kM(n,t+"anchor-origin"),m=IM(n,t+"anchor-x-units"),y=IM(n,t+"anchor-y-units"),v=wH(n,t+"color"),_=_H(n,t+"cross-origin"),E=vH(n,t+"offset"),T=kM(n,t+"offset-origin"),b=V_(n,t+"width"),R=V_(n,t+"height"),N=xH(n,t+"size"),D=bw(n,t+"declutter-mode"),W=new xy({src:i,anchorOrigin:g,anchorXUnits:m,anchorYUnits:y,color:v,crossOrigin:_,offset:E,offsetOrigin:T,height:R,width:b,size:N,declutterMode:D});return function(I){return o&&W.setOpacity(o(I)),l&&W.setDisplacement(l(I)),c&&W.setRotation(c(I)),h&&W.setRotateWithView(h(I)),a&&W.setScale(a(I)),s&&W.setAnchor(s(I)),W}}function mH(n,e){const t="shape-",r=t+"points",i=t+"radius",s=ab(n[r],r),a=ab(n[i],i),o=Ep(n,t,e),l=Sp(n,t,e),c=Tw(n,t+"scale",e),h=j_(n,t+"displacement",e),g=Fs(n,t+"rotation",e),m=h0(n,t+"rotate-with-view",e),y=V_(n,t+"radius2"),v=V_(n,t+"angle"),_=bw(n,t+"declutter-mode"),E=new Sw({points:s,radius:a,radius2:y,angle:v,declutterMode:_});return function(T){return o&&E.setFill(o(T)),l&&E.setStroke(l(T)),h&&E.setDisplacement(h(T)),g&&E.setRotation(g(T)),m&&E.setRotateWithView(m(T)),c&&E.setScale(c(T)),E}}function pH(n,e){const t="circle-",r=Ep(n,t,e),i=Sp(n,t,e),s=Fs(n,t+"radius",e),a=Tw(n,t+"scale",e),o=j_(n,t+"displacement",e),l=Fs(n,t+"rotation",e),c=h0(n,t+"rotate-with-view",e),h=bw(n,t+"declutter-mode"),g=new Us({radius:5,declutterMode:h});return function(m){return s&&g.setRadius(s(m)),r&&g.setFill(r(m)),i&&g.setStroke(i(m)),o&&g.setDisplacement(o(m)),l&&g.setRotation(l(m)),c&&g.setRotateWithView(c(m)),a&&g.setScale(a(m)),g}}function Fs(n,e,t){if(!(e in n))return;const r=fc(n[e],At,t);return function(i){return ab(r(i),e)}}function Vl(n,e,t){if(!(e in n))return null;const r=fc(n[e],di,t);return function(i){return hF(r(i),e)}}function yH(n,e,t){const r=Vl(n,e+"pattern-src",t),i=AM(n,e+"pattern-offset",t),s=AM(n,e+"pattern-size",t),a=mA(n,e+"color",t);return function(o){return{src:r(o),offset:i&&i(o),size:s&&s(o),color:a&&a(o)}}}function h0(n,e,t){if(!(e in n))return null;const r=fc(n[e],Jr,t);return function(i){const s=r(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function mA(n,e,t){if(!(e in n))return null;const r=fc(n[e],vr,t);return function(i){return dF(r(i),e)}}function uF(n,e,t){if(!(e in n))return null;const r=fc(n[e],$s,t);return function(i){return _y(r(i),e)}}function j_(n,e,t){if(!(e in n))return null;const r=fc(n[e],$s,t);return function(i){const s=_y(r(i),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function AM(n,e,t){if(!(e in n))return null;const r=fc(n[e],$s,t);return function(i){return fF(r(i),e)}}function Tw(n,e,t){if(!(e in n))return null;const r=fc(n[e],$s|At,t);return function(i){return EH(r(i),e)}}function V_(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function xH(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return ws(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function _H(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function kM(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function IM(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function vH(n,e){const t=n[e];if(t!==void 0)return _y(t,e)}function bw(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function wH(n,e){const t=n[e];if(t!==void 0)return dF(t,e)}function _y(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let r=0;r<t;++r)if(typeof n[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function hF(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function ab(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function dF(n,e){if(typeof n=="string")return n;const t=_y(n,e),r=t.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function fF(n,e){const t=_y(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function EH(n,e){return typeof n=="number"?n:fF(n,e)}const eo={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function CM(n,e,t){return(function(r,i,s,a,o){if(!r)return;if(!i&&!e)return r;const l=e?0:s[0]*i,c=e?0:s[1]*i,h=o?o[0]:0,g=o?o[1]:0;let m=n[0]+l/2+h,y=n[2]-l/2+h,v=n[1]+c/2+g,_=n[3]-c/2+g;m>y&&(m=(y+m)/2,y=m),v>_&&(v=(_+v)/2,_=v);let E=cr(r[0],m,y),T=cr(r[1],v,_);if(a&&t&&i){const b=30*i;E+=-b*Math.log(1+Math.max(0,m-r[0])/b)+b*Math.log(1+Math.max(0,r[0]-y)/b),T+=-b*Math.log(1+Math.max(0,v-r[1])/b)+b*Math.log(1+Math.max(0,r[1]-_)/b)}return[E,T]})}function SH(n){return n}function gF(n){return Math.pow(n,3)}function ig(n){return 1-gF(1-n)}function TH(n){return 3*n*n-2*n*n*n}function bH(n){return n}function pA(n,e,t,r){const i=gn(e)/t[0],s=Qr(e)/t[1];return r?Math.min(n,Math.max(i,s)):Math.min(n,Math.min(i,s))}function yA(n,e,t){let r=Math.min(n,e);const i=50;return r*=Math.log(1+i*Math.max(0,n/e-1))/i+1,t&&(r=Math.max(r,t),r/=Math.log(1+i*Math.max(0,t/n-1))/i+1),cr(r,t/2,e*2)}function RH(n,e,t,r){return e=e!==void 0?e:!0,(function(i,s,a,o){if(i!==void 0){const l=n[0],c=n[n.length-1],h=t?pA(l,t,a,r):l;if(o)return e?yA(i,h,c):cr(i,c,h);const g=Math.min(h,i),m=Math.floor(uw(n,g,s));return n[m]>h&&m<n.length-1?n[m+1]:n[m]}})}function AH(n,e,t,r,i,s){return r=r!==void 0?r:!0,t=t!==void 0?t:0,(function(a,o,l,c){if(a!==void 0){const h=i?pA(e,i,l,s):e;if(c)return r?yA(a,h,t):cr(a,t,h);const g=1e-9,m=Math.ceil(Math.log(e/h)/Math.log(n)-g),y=-o*(.5-g)+.5,v=Math.min(h,a),_=Math.floor(Math.log(e/v)/Math.log(n)+y),E=Math.max(m,_),T=e/Math.pow(n,E);return cr(T,t,h)}})}function PM(n,e,t,r,i){return t=t!==void 0?t:!0,(function(s,a,o,l){if(s!==void 0){const c=r?pA(n,r,o,i):n;return!t||!l?cr(s,e,c):yA(s,c,e)}})}function xA(n){if(n!==void 0)return 0}function MM(n){if(n!==void 0)return n}function kH(n){const e=2*Math.PI/n;return(function(t,r){if(r)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function IH(n){const e=Xl(5);return(function(t,r){return r||t===void 0?t:Math.abs(t)<=e?0:t})}const CH=42,_A=256,SS=0;class qo extends pl{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=KR(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&wD(),e.center&&(e.center=Fl(e.center,this.projection_)),e.extent&&(e.extent=Yo(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const o in eo)delete t[o];this.setProperties(t,!0);const r=MH(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=PH(e),s=r.constraint,a=NH(e);this.constraints_={center:i,resolution:s,rotation:a},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),a=s/2*(i[3]-t[3]+t[1]-i[1]),o=s/2*(i[0]-t[0]+t[2]-i[2]);this.setCenterInternal([r[0]+a,r[1]-o])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let r=0;r<t.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=Fl(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=Fl(i.anchor,this.getProjection())),t[r]=i}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,r;t>1&&typeof arguments[t-1]=="function"&&(r=arguments[t-1],--t);let i=0;for(;i<t&&!this.isDef();++i){const h=arguments[i];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(i===t){r&&px(r,!0);return}let s=Date.now(),a=this.targetCenter_.slice(),o=this.targetResolution_,l=this.targetRotation_;const c=[];for(;i<t;++i){const h=arguments[i],g={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||TH,callback:r};if(h.center&&(g.sourceCenter=a,g.targetCenter=h.center.slice(),a=g.targetCenter),h.zoom!==void 0?(g.sourceResolution=o,g.targetResolution=this.getResolutionForZoom(h.zoom),o=g.targetResolution):h.resolution&&(g.sourceResolution=o,g.targetResolution=h.resolution,o=g.targetResolution),h.rotation!==void 0){g.sourceRotation=l;const m=_u(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;g.targetRotation=l+m,l=g.targetRotation}LH(g)?g.complete=!0:s+=g.duration,c.push(g)}this.animations_.push(c),this.setHint(Zr.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Zr.ANIMATING]>0}getInteracting(){return this.hints_[Zr.INTERACTING]>0}cancelAnimations(){this.setHint(Zr.ANIMATING,-this.hints_[Zr.ANIMATING]);let e;for(let t=0,r=this.animations_.length;t<r;++t){const i=this.animations_[t];if(i[0].callback&&px(i[0].callback,!1),!e)for(let s=0,a=i.length;s<a;++s){const o=i[s];if(!o.complete){e=o.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let s=!0;for(let a=0,o=i.length;a<o;++a){const l=i[a];if(l.complete)continue;const c=e-l.start;let h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const g=l.easing(h);if(l.sourceCenter){const m=l.sourceCenter[0],y=l.sourceCenter[1],v=l.targetCenter[0],_=l.targetCenter[1];this.nextCenter_=l.targetCenter;const E=m+g*(v-m),T=y+g*(_-y);this.targetCenter_=[E,T]}if(l.sourceResolution&&l.targetResolution){const m=g===1?l.targetResolution:l.sourceResolution+g*(l.targetResolution-l.sourceResolution);if(l.anchor){const y=this.getViewportSize_(this.getRotation()),v=this.constraints_.resolution(m,0,y,!0);this.targetCenter_=this.calculateCenterZoom(v,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const m=g===1?_u(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+g*(l.targetRotation-l.sourceRotation);if(l.anchor){const y=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(y,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=m}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[r]=null,this.setHint(Zr.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const a=i[0].callback;a&&px(a,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-t[0],i[1]-t[1]],UR(r,e-this.getRotation()),bU(r,t)),r}calculateCenterZoom(e,t){let r;const i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){const a=t[0]-e*(t[0]-i[0])/s,o=t[1]-e*(t[1]-i[1])/s;r=[a,o]}return r}getViewportSize_(e){const t=this.viewportSize_;if(e){const r=t[0],i=t[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&ZT(e,this.getProjection())}getCenterInternal(){return this.get(eo.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return ED(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();Tn(t,"The view center is not defined");const r=this.getResolution();Tn(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return Tn(i!==void 0,"The view rotation is not defined"),b_(t,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(eo.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Yo(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const r=gn(e)/t[0],i=Qr(e)/t[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(t/r)/Math.log(e);return(function(s){return t/Math.pow(e,s*i)})}getRotation(){return this.get(eo.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/t;return(function(a){return Math.log(r/a)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const r=this.padding_;return r&&(t=[t[0]-r[1]-r[3],t[1]-r[0]-r[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const s=this.padding_;if(s){const a=this.getViewportSizeMinusPadding_();i=TS(i,this.getViewportSize_(),[a[0]/2+s[3],a[1]/2+s[0]],t,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,r,i;if(this.resolutions_){const s=uw(this.resolutions_,e,1);t=s,r=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=r/this.resolutions_[s+1]}else r=this.maxResolution_,i=this.zoomFactor_;return t+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=cr(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(r,cr(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let r;if(Tn(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){Tn(!rg(e),"Cannot fit empty extent provided as `geometry`");const i=Yo(e,this.getProjection());r=uM(i)}else if(e.getType()==="Circle"){const i=Yo(e.getExtent(),this.getProjection());r=uM(i),r.rotate(this.getRotation(),cl(i))}else r=e;this.fitInternal(r,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),r=Math.cos(t),i=Math.sin(-t),s=e.getFlatCoordinates(),a=e.getStride();let o=1/0,l=1/0,c=-1/0,h=-1/0;for(let g=0,m=s.length;g<m;g+=a){const y=s[g]*r-s[g+1]*i,v=s[g]*i+s[g+1]*r;o=Math.min(o,y),l=Math.min(l,v),c=Math.max(c,y),h=Math.max(h,v)}return[o,l,c,h]}fitInternal(e,t){t=t||{};let r=t.size;r||(r=this.getViewportSizeMinusPadding_());const i=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let a;t.minResolution!==void 0?a=t.minResolution:t.maxZoom!==void 0?a=this.getResolutionForZoom(t.maxZoom):a=0;const o=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(o,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?a:Math.max(l,a),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),h=Math.sin(c),g=Math.cos(c),m=cl(o);m[0]+=(i[1]-i[3])/2*l,m[1]+=(i[0]-i[2])/2*l;const y=m[0]*g-m[1]*h,v=m[1]*g+m[0]*h,_=this.getConstrainedCenter([y,v],l),E=t.callback?t.callback:fp;t.duration!==void 0?this.animateInternal({resolution:l,center:_,duration:t.duration,easing:t.easing},E):(this.targetResolution_=l,this.targetCenter_=_,this.applyTargetState_(!1,!0),px(E,!0))}centerOn(e,t,r){this.centerOnInternal(Fl(e,this.getProjection()),t,r)}centerOnInternal(e,t,r){this.setCenterInternal(TS(e,t,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,r,i){let s;const a=this.padding_;if(a&&e){const o=this.getViewportSizeMinusPadding_(-r),l=TS(e,i,[o[0]/2+a[3],o[1]/2+a[0]],t,r);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=ZT(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Fl(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,i,r);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Fl(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);t&&(this.targetCenter_=this.calculateCenterRotate(i,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Fl(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const r=this.getAnimating()||this.getInteracting()||t,i=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,0,s,r),o=this.constraints_.center(this.targetCenter_,a,s,r,this.calculateCenterShift(this.targetCenter_,a,i,s));this.get(eo.ROTATION)!==i&&this.set(eo.ROTATION,i),this.get(eo.RESOLUTION)!==a&&(this.set(eo.RESOLUTION,a),this.set("zoom",this.getZoom(),!0)),(!o||!this.get(eo.CENTER)||!A_(this.get(eo.CENTER),o))&&this.set(eo.CENTER,o),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,r){e=e!==void 0?e:200;const i=t||0,s=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,i,a),l=this.constraints_.center(this.targetCenter_,o,a,!1,this.calculateCenterShift(this.targetCenter_,o,s,a));if(e===0&&!this.cancelAnchor_){this.targetResolution_=o,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==o||this.getRotation()!==s||!this.getCenterInternal()||!A_(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:o,duration:e,easing:ig,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Zr.INTERACTING,1)}endInteraction(e,t,r){r=r&&Fl(r,this.getProjection()),this.endInteractionInternal(e,t,r)}endInteractionInternal(e,t,r){this.getInteracting()&&(this.setHint(Zr.INTERACTING,-1),this.resolveConstraints(e,t,r))}getConstrainedCenter(e,t){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),r)}getConstrainedZoom(e,t){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,t))}getConstrainedResolution(e,t){t=t||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,r)}}function px(n,e){setTimeout(function(){n(e)},0)}function PH(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return CM(n.extent,n.constrainOnlyCenter,t)}const e=KR(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,CM(t,!1,!1)}return SH}function MH(n){let e,t,r,a=n.minZoom!==void 0?n.minZoom:SS,o=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,c=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,g=n.showFullExtent!==void 0?n.showFullExtent:!1,m=KR(n.projection,"EPSG:3857"),y=m.getExtent();let v=n.constrainOnlyCenter,_=n.extent;if(!c&&!_&&m.isGlobal()&&(v=!1,_=y),n.resolutions!==void 0){const E=n.resolutions;t=E[a],r=E[o]!==void 0?E[o]:E[E.length-1],n.constrainResolution?e=RH(E,h,!v&&_,g):e=PM(t,r,h,!v&&_,g)}else{const T=(y?Math.max(gn(y),Qr(y)):360*I0.degrees/m.getMetersPerUnit())/_A/Math.pow(2,SS),b=T/Math.pow(2,28-SS);t=n.maxResolution,t!==void 0?a=0:t=T/Math.pow(l,a),r=n.minResolution,r===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?r=t/Math.pow(l,o):r=T/Math.pow(l,o):r=b),o=a+Math.floor(Math.log(t/r)/Math.log(l)),r=t/Math.pow(l,o-a),n.constrainResolution?e=AH(l,t,r,h,!v&&_,g):e=PM(t,r,h,!v&&_,g)}return{constraint:e,maxResolution:t,minResolution:r,minZoom:a,zoomFactor:l}}function NH(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?IH():t===!1?MM:typeof t=="number"?kH(t):MM}return xA}function LH(n){return!(n.sourceCenter&&n.targetCenter&&!A_(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function TS(n,e,t,r,i){const s=Math.cos(-i);let a=Math.sin(-i),o=n[0]*s-n[1]*a,l=n[1]*s+n[0]*a;o+=(e[0]/2-t[0])*r,l+=(t[1]-e[1]/2)*r,a=-a;const c=o*s-l*a,h=l*s+o*a;return[c,h]}const Ln={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class mF extends pl{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Ln.OPACITY]=e.opacity!==void 0?e.opacity:1,Tn(typeof t[Ln.OPACITY]=="number","Layer opacity must be a number"),t[Ln.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Ln.Z_INDEX]=e.zIndex,t[Ln.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Ln.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Ln.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Ln.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return t.opacity=cr(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=r===void 0&&!t.managed?1/0:r,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return $t()}getLayerStatesArray(e){return $t()}getExtent(){return this.get(Ln.EXTENT)}getMaxResolution(){return this.get(Ln.MAX_RESOLUTION)}getMinResolution(){return this.get(Ln.MIN_RESOLUTION)}getMinZoom(){return this.get(Ln.MIN_ZOOM)}getMaxZoom(){return this.get(Ln.MAX_ZOOM)}getOpacity(){return this.get(Ln.OPACITY)}getSourceState(){return $t()}getVisible(){return this.get(Ln.VISIBLE)}getZIndex(){return this.get(Ln.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Ln.EXTENT,e)}setMaxResolution(e){this.set(Ln.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Ln.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Ln.MAX_ZOOM,e)}setMinZoom(e){this.set(Ln.MIN_ZOOM,e)}setOpacity(e){Tn(typeof e=="number","Layer opacity must be a number"),this.set(Ln.OPACITY,e)}setVisible(e){this.set(Ln.VISIBLE,e)}setZIndex(e){this.set(Ln.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class vy extends mF{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Ln.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Ln.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(ar(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=fn(e,Jt.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof qo?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&r&&(t.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(t.layerStatesArray){if(i=t.layerStatesArray.find(a=>a.layer===this),!i)return!1}else i=this.getLayerState();const s=this.getExtent();return vA(i,t.viewState)&&(!s||_s(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const r=e instanceof qo?e.getViewStateAndExtent():e;let i=t(r);return Array.isArray(i)||(i=[i]),i}render(e,t){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Ln.MAP,e)}getMapInternal(){return this.get(Ln.MAP)}setMap(e){this.mapPrecomposeKey_&&(ar(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(ar(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=fn(e,Si.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=fn(this,Jt.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,r=this.getLayerState(!1);Tn(!t.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(r)}setSource(e){this.set(Ln.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function vA(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const r=e.zoom;return r>n.minZoom&&r<=n.maxZoom}const NM={RENDER_ORDER:"renderOrder"};class Rw extends vy{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(NM.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new nF(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(NM.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?rF:e;const t=OH(e);this.styleFunction_=e===null?void 0:_W(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function OH(n){if(n===void 0)return rF;if(!n)return null;if(typeof n=="function"||n instanceof mn)return n;if(!Array.isArray(n))return RM([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof mn){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!(a instanceof mn))throw new Error("Expected a list of style instances");i[s]=a}return i}if("style"in t){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!("style"in a))throw new Error("Expected a list of rules with a style property");i[s]=a}return uH(i)}return RM(n)}class $u extends Rw{constructor(e){super(e)}createRenderer(){return new VW(this)}}const Wc={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class tu extends ml{constructor(e,t){super(e),this.layer=t}}const bS={LAYERS:"layers"};let Aw=class pF extends mF{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let r=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(bS.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new Ma(r.slice(),{unique:!0}):Tn(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new Ma(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(ar),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(fn(e,Ls.ADD,this.handleLayersAdd_,this),fn(e,Ls.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(ar);ng(this.listenerKeys_);const t=e.getArray();for(let r=0,i=t.length;r<i;r++){const s=t[r];this.registerLayerListeners_(s),this.dispatchEvent(new tu(Wc.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[fn(e,A0.PROPERTYCHANGE,this.handleLayerChange_,this),fn(e,Jt.CHANGE,this.handleLayerChange_,this)];e instanceof pF&&t.push(fn(e,Wc.ADDLAYER,this.handleLayerGroupAdd_,this),fn(e,Wc.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[Ut(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new tu(Wc.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new tu(Wc.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new tu(Wc.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,r=Ut(t);this.listenerKeys_[r].forEach(ar),delete this.listenerKeys_[r],this.dispatchEvent(new tu(Wc.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(bS.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const r=t.getArray();for(let i=0,s=r.length;i<s;++i)this.dispatchEvent(new tu(Wc.REMOVELAYER,r[i]))}this.set(bS.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],r=t.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(t)});const i=this.getLayerState();let s=i.zIndex;!e&&i.zIndex===void 0&&(s=0);for(let a=r,o=t.length;a<o;a++){const l=t[a];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=Kl(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}};const Vt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function yF(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ob(n,e){return n[0]=e[0],n[1]=e[1],n[4]=e[2],n[5]=e[3],n[12]=e[4],n[13]=e[5],n}const B_=34962,wA=34963,DH=35044,RS=35048,FH=5121,jH=5123,VH=5125,xF=5126,LM=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function BH(n,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!S$},e);const t=LM.length;for(let r=0;r<t;++r)try{const i=n.getContext(LM[r],e);if(i)return i}catch{}return null}const GH={STATIC_DRAW:DH};class AS{constructor(e,t){this.array_=null,this.type_=e,Tn(e===B_||e===wA,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=t!==void 0?t:GH.STATIC_DRAW}ofSize(e){return this.array_=new(yx(this.type_))(e),this}fromArray(e){return this.array_=yx(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(yx(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}setArray(e){const t=yx(this.type_);if(!(e instanceof t))throw new Error(`Expected ${t}`);this.array_=e}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function yx(n){switch(n){case B_:return Float32Array;case wA:return Uint32Array;default:return Float32Array}}const xx={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},zH=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,UH=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class OM{constructor(e){this.gl_=e.webGlContext;const t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer(),this.depthBuffer_=t.createRenderbuffer();const r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e.vertexShader||zH),t.compileShader(r);const i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,e.fragmentShader||UH),t.compileShader(i),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,r),t.attachShader(this.renderTargetProgram_,i),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(a=>{this.uniforms_.push({value:e.uniforms[a],location:t.getUniformLocation(this.renderTargetProgram_,a)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(e){const t=this.getGL(),r=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.getDepthBuffer()),t.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;const i=0,s=t.RGBA,a=0,o=t.RGBA,l=t.UNSIGNED_BYTE,c=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,i,s,r[0],r[1],a,o,l,c),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,r[0],r[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer_)}}apply(e,t,r,i){const s=this.getGL(),a=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,t?t.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!t){const l=Ut(s.canvas);if(!e.renderTargets[l]){const c=s.getContextAttributes();c&&c.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,a[0],a[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const o=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,o),this.applyUniforms(e),r&&r(s,e),s.drawArrays(s.TRIANGLES,0,6),i&&i(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const t=this.getGL();let r,i=1;this.uniforms_.forEach(function(s){if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof ImageData)s.texture||(s.texture=t.createTexture()),t.activeTexture(t[`TEXTURE${i}`]),t.bindTexture(t.TEXTURE_2D,s.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,r.width,r.height,0,t.UNSIGNED_BYTE,new Uint8Array(r.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.uniform1i(s.location,i++);else if(Array.isArray(r))switch(r.length){case 2:t.uniform2f(s.location,r[0],r[1]);return;case 3:t.uniform3f(s.location,r[0],r[1],r[2]);return;case 4:t.uniform4f(s.location,r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&t.uniform1f(s.location,r)})}}const jl={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},ji={UNSIGNED_BYTE:FH,UNSIGNED_SHORT:jH,UNSIGNED_INT:VH,FLOAT:xF},G_={};function DM(n){return"shared/"+n}let FM=0;function $H(){const n="unique/"+FM;return FM+=1,n}function WH(n){let e=G_[n];if(!e){const t=document.createElement("canvas");t.width=1,t.height=1,t.style.position="absolute",t.style.left="0",e={users:0,context:BH(t)},G_[n]=e}return e.users+=1,e.context}function HH(n){const e=G_[n];if(!e||(e.users-=1,e.users>0))return;const t=e.context,r=t.getExtension("WEBGL_lose_context");r&&r.loseContext();const i=t.canvas;i.width=1,i.height=1,delete G_[n]}class KH extends ly{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?DM(e.canvasCacheKey):$H(),this.gl_=WH(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const t=this.gl_.canvas;t.addEventListener(xx.LOST,this.boundHandleWebGLContextLost_),t.addEventListener(xx.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=fi(),this.offsetScaleMatrix_=fi(),this.tmpMat4_=yF(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(r=>new OM({webGlContext:this.gl_,scaleRatio:r.scaleRatio,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms})):[new OM({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const t in e)this.uniforms_.push({name:t,value:e[t]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===DM(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t}getInstancedRenderingExtension_(){const e=this.getExtension("ANGLE_instanced_arrays");return Tn(!!e,"WebGL extension 'ANGLE_instanced_arrays' is required for vector rendering"),e}bindBuffer(e){const t=this.gl_,r=Ut(e);let i=this.bufferCache_[r];if(!i){const s=t.createBuffer();i={buffer:e,webGlBuffer:s},this.bufferCache_[r]=i}t.bindBuffer(e.getType(),i.webGlBuffer)}flushBufferData(e){const t=this.gl_;this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const t=Ut(e);delete this.bufferCache_[t]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(xx.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(xx.RESTORED,this.boundHandleWebGLContextRestored_),HH(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,t,r){const i=this.gl_,s=this.getCanvas(),a=e.size,o=e.pixelRatio;(s.width!==a[0]*o||s.height!==a[1]*o)&&(s.width=a[0]*o,s.height=a[1]*o,s.style.width=a[0]+"px",s.style.height=a[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.depthRange(0,1),i.clearDepth(1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,t?i.ZERO:i.ONE_MINUS_SRC_ALPHA),r?(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL)):i.disable(i.DEPTH_TEST)}bindFrameBuffer(e,t){const r=this.getGL();r.bindFramebuffer(r.FRAMEBUFFER,e),t&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0)}bindInitialFrameBuffer(){const e=this.getGL(),t=this.postProcessPasses_[0].getFrameBuffer();e.bindFramebuffer(e.FRAMEBUFFER,t);const r=this.postProcessPasses_[0].getRenderTargetTexture();e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0)}bindTexture(e,t,r){const i=this.gl_;i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,e),i.uniform1i(this.getUniformLocation(r),t)}bindAttribute(e,t,r){const i=this.getGL();this.bindBuffer(e);const s=this.getAttributeLocation(t);i.enableVertexAttribArray(s),i.vertexAttribPointer(s,r,i.FLOAT,!1,0,0)}prepareDrawToRenderTarget(e,t,r,i){const s=this.gl_,a=t.getSize();s.bindFramebuffer(s.FRAMEBUFFER,t.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,t.getDepthbuffer()),s.viewport(0,0,a[0],a[1]),s.bindTexture(s.TEXTURE_2D,t.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,r?s.ZERO:s.ONE_MINUS_SRC_ALPHA),i?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(e,t){const r=this.gl_;this.getExtension("OES_element_index_uint");const i=r.UNSIGNED_INT,s=4,a=t-e,o=e*s;r.drawElements(r.TRIANGLES,a,i,o)}drawElementsInstanced(e,t,r){const i=this.gl_;this.getExtension("OES_element_index_uint");const s=this.getInstancedRenderingExtension_(),a=i.UNSIGNED_INT,o=4,l=t-e,c=e*o;s.drawElementsInstancedANGLE(i.TRIANGLES,l,a,c,r);for(let h=0;h<this.maxAttributeCount_;h++)s.vertexAttribDivisorANGLE(h,0)}finalizeDraw(e,t,r){for(let i=0,s=this.postProcessPasses_.length;i<s;i++)i===s-1?this.postProcessPasses_[i].apply(e,null,t,r):this.postProcessPasses_[i].apply(e,this.postProcessPasses_[i+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const t=e.size,r=e.viewState.rotation,i=e.pixelRatio;this.setUniformFloatValue(jl.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(jl.ZOOM,e.viewState.zoom),this.setUniformFloatValue(jl.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(jl.PIXEL_RATIO,i),this.setUniformFloatVec2(jl.VIEWPORT_SIZE_PX,[t[0],t[1]]),this.setUniformFloatValue(jl.ROTATION,r)}applyHitDetectionUniform(e){const t=this.getUniformLocation(jl.HIT_DETECTION);this.getGL().uniform1i(t,e?1:0),e&&this.setUniformFloatValue(jl.PIXEL_RATIO,.5)}applyUniforms(e){const t=this.gl_;let r,i=0;this.uniforms_.forEach(s=>{if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData||r instanceof WebGLTexture){r instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=r):s.texture||(s.prevValue=void 0,s.texture=t.createTexture()),this.bindTexture(s.texture,i,s.name),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const a=!(r instanceof HTMLImageElement)||r.complete;!(r instanceof WebGLTexture)&&a&&s.prevValue!==r&&(s.prevValue=r,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)),i++}else if(Array.isArray(r)&&r.length===6)this.setUniformMatrixValue(s.name,ob(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:t.uniform2f(this.getUniformLocation(s.name),r[0],r[1]);return;case 3:t.uniform3f(this.getUniformLocation(s.name),r[0],r[1],r[2]);return;case 4:t.uniform4f(this.getUniformLocation(s.name),r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&t.uniform1f(this.getUniformLocation(s.name),r)})}useProgram(e,t){this.disableAllAttributes_(),this.gl_.useProgram(e),this.currentProgram_=e,t&&(this.applyFrameState(t),this.applyUniforms(t))}compileShader(e,t){const r=this.gl_,i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}getProgram(e,t){const r=this.gl_,i=this.compileShader(e,r.FRAGMENT_SHADER),s=this.compileShader(t,r.VERTEX_SHADER),a=r.createProgram();if(r.attachShader(a,i),r.attachShader(a,s),r.linkProgram(a),!r.getShaderParameter(i,r.COMPILE_STATUS)){const o=`Fragment shader compilation failed: ${r.getShaderInfoLog(i)}`;throw new Error(o)}if(r.deleteShader(i),!r.getShaderParameter(s,r.COMPILE_STATUS)){const o=`Vertex shader compilation failed: ${r.getShaderInfoLog(s)}`;throw new Error(o)}if(r.deleteShader(s),!r.getProgramParameter(a,r.LINK_STATUS)){const o=`GL program linking failed: ${r.getProgramInfoLog(a)}`;throw new Error(o)}return a}getUniformLocation(e){const t=Ut(this.currentProgram_);return this.uniformLocationsByProgram_[t]===void 0&&(this.uniformLocationsByProgram_[t]={}),this.uniformLocationsByProgram_[t][e]===void 0&&(this.uniformLocationsByProgram_[t][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[t][e]}getAttributeLocation(e){const t=Ut(this.currentProgram_);return this.attribLocationsByProgram_[t]===void 0&&(this.attribLocationsByProgram_[t]={}),this.attribLocationsByProgram_[t][e]===void 0&&(this.attribLocationsByProgram_[t][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[t][e]}makeProjectionTransform(e,t){const r=e.size,i=e.viewState.rotation,s=e.viewState.resolution,a=e.viewState.center;return Va(t,0,0,2/(s*r[0]),2/(s*r[1]),-i,-a[0],-a[1]),t}setUniformFloatValue(e,t){this.gl_.uniform1f(this.getUniformLocation(e),t)}setUniformFloatVec2(e,t){this.gl_.uniform2fv(this.getUniformLocation(e),t)}setUniformFloatVec4(e,t){this.gl_.uniform4fv(this.getUniformLocation(e),t)}setUniformMatrixValue(e,t){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,t)}disableAllAttributes_(){for(let e=0;e<this.maxAttributeCount_;e++)this.gl_.disableVertexAttribArray(e)}enableAttributeArray_(e,t,r,i,s,a){const o=this.getAttributeLocation(e);o<0||(this.gl_.enableVertexAttribArray(o),this.gl_.vertexAttribPointer(o,t,r,!1,i,s),a&&this.getInstancedRenderingExtension_().vertexAttribDivisorANGLE(o,1))}enableAttributes_(e,t){const r=XH(e);let i=0;for(let s=0;s<e.length;s++){const a=e[s];a.name&&this.enableAttributeArray_(a.name,a.size,a.type||xF,r,i,t),i+=a.size*_F(a.type)}}enableAttributes(e){this.enableAttributes_(e,!1)}enableAttributesInstanced(e){this.enableAttributes_(e,!0)}handleWebGLContextLost(e){ng(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,t,r,i){const s=this.gl_;r=r||s.createTexture();const a=i?s.NEAREST:s.LINEAR;s.bindTexture(s.TEXTURE_2D,r),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE);const o=0,l=s.RGBA,c=0,h=s.RGBA,g=s.UNSIGNED_BYTE;return t instanceof Uint8Array?s.texImage2D(s.TEXTURE_2D,o,l,e[0],e[1],c,h,g,t):t?s.texImage2D(s.TEXTURE_2D,o,l,h,g,t):s.texImage2D(s.TEXTURE_2D,o,l,e[0],e[1],c,h,g,null),r}}function XH(n){let e=0;for(let t=0;t<n.length;t++){const r=n[t];e+=r.size*_F(r.type)}return e}function _F(n){switch(n){case ji.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case ji.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case ji.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case ji.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class EA extends cy{constructor(e,t,r){super(),r=r||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(Jt.CHANGE)}release(){this.setState(Vt.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Vt.EMPTY){if(this.state!==Vt.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){$t()}getAlpha(e,t){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=t,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=t-r+1e3/60;return i>=this.transition_?1:gF(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function lb(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const qH=new Error("disposed"),YH=[256,256];class jM extends EA{constructor(e){const t=Vt.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=lb(this.data_);return e?[e.width,e.height]:YH}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Vt.IDLE&&this.state!==Vt.ERROR)return;this.state=Vt.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Vt.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Vt.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(qH),this.controller_=null),super.disposeInternal()}}class vF extends EA{constructor(e,t,r,i,s,a){super(e,t,a),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_,ua?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,i!==null&&(this.image_.crossOrigin=i)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Vt.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Vt.ERROR,this.unlistenImage_(),this.image_=ZH(),this.changed()}handleImageLoad_(){if(ua)this.state=Vt.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Vt.LOADED:this.state=Vt.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Vt.ERROR&&(this.state=Vt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Vt.IDLE&&(this.state=Vt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=F$(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function ZH(){const n=ti(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let kS;const d0=[];function VM(n,e,t,r,i){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(r,i),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,r)+1,Math.max(t,i)),n.restore()}function IS(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function JH(){if(kS===void 0){const n=ti(6,6,d0);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",VM(n,4,5,4,0),VM(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;kS=IS(e,0)||IS(e,4)||IS(e,8),ww(n),d0.push(n.canvas)}return kS}function z_(n,e,t,r){const i=gy(t,e,n);let s=P_(e,r,t);const a=e.getMetersPerUnit();a!==void 0&&(s*=a);const o=n.getMetersPerUnit();o!==void 0&&(s/=o);const l=n.getExtent();if(!l||nd(l,i)){const c=P_(n,s,i)/s;isFinite(c)&&c>0&&(s/=c)}return s}function QH(n,e,t,r){const i=cl(t);let s=z_(n,e,i,r);return(!isFinite(s)||s<=0)&&lD(t,function(a){return s=z_(n,e,a,r),isFinite(s)&&s>0}),s}function wF(n,e,t,r,i,s,a,o,l,c,h,g,m,y){const v=ti(Math.round(t*n),Math.round(t*e),d0);if(g||(v.imageSmoothingEnabled=!1),l.length===0)return v.canvas;v.scale(t,t);function _(D){return Math.round(D*t)/t}v.globalCompositeOperation="lighter";const E=zs();l.forEach(function(D,W,I){aD(E,D.extent)});let T;const b=t/r,R=(g?1:1+Math.pow(2,-24))/b;(!m||l.length!==1||c!==0)&&(T=ti(Math.round(gn(E)*b),Math.round(Qr(E)*b),d0),g||(T.imageSmoothingEnabled=!1),l.forEach(function(D,W,I){if(D.image.width>0&&D.image.height>0){if(D.clipExtent){T.save();const z=(D.clipExtent[0]-E[0])*b,j=-(D.clipExtent[3]-E[3])*b,Ee=gn(D.clipExtent)*b,Ce=Qr(D.clipExtent)*b;T.rect(g?z:Math.round(z),g?j:Math.round(j),g?Ee:Math.round(z+Ee)-Math.round(z),g?Ce:Math.round(j+Ce)-Math.round(j)),T.clip()}const A=(D.extent[0]-E[0])*b,M=-(D.extent[3]-E[3])*b,O=gn(D.extent)*b,L=Qr(D.extent)*b;T.drawImage(D.image,c,c,D.image.width-2*c,D.image.height-2*c,g?A:Math.round(A),g?M:Math.round(M),g?O:Math.round(A+O)-Math.round(A),g?L:Math.round(M+L)-Math.round(M)),D.clipExtent&&T.restore()}}));const N=Rd(a);return o.getTriangles().forEach(function(D,W,I){const A=D.source,M=D.target;let O=A[0][0],L=A[0][1],z=A[1][0],j=A[1][1],Ee=A[2][0],Ce=A[2][1];const Ge=_((M[0][0]-N[0])/s),Le=_(-(M[0][1]-N[1])/s),ce=_((M[1][0]-N[0])/s),Me=_(-(M[1][1]-N[1])/s),Te=_((M[2][0]-N[0])/s),ie=_(-(M[2][1]-N[1])/s),V=O,Z=L;O=0,L=0,z-=V,j-=Z,Ee-=V,Ce-=Z;const te=[[z,j,0,0,ce-Ge],[Ee,Ce,0,0,Te-Ge],[0,0,z,j,Me-Le],[0,0,Ee,Ce,ie-Le]],se=TU(te);if(!se)return;if(v.save(),v.beginPath(),JH()||!g){v.moveTo(ce,Me);const Ae=4,Fe=Ge-ce,de=Le-Me;for(let Pe=0;Pe<Ae;Pe++)v.lineTo(ce+_((Pe+1)*Fe/Ae),Me+_(Pe*de/(Ae-1))),Pe!=Ae-1&&v.lineTo(ce+_((Pe+1)*Fe/Ae),Me+_((Pe+1)*de/(Ae-1)));v.lineTo(Te,ie)}else v.moveTo(ce,Me),v.lineTo(Ge,Le),v.lineTo(Te,ie);v.clip(),v.transform(se[0],se[2],se[1],se[3],Ge,Le),v.translate(E[0]-V,E[3]-Z);let he;if(T)he=T.canvas,v.scale(R,-R);else{const Ae=l[0],Fe=Ae.extent;he=Ae.image,v.scale(gn(Fe)/he.width,-Qr(Fe)/he.height)}v.drawImage(he,0,0),v.restore()}),T&&(ww(T),d0.push(T.canvas)),h&&(v.save(),v.globalCompositeOperation="source-over",v.strokeStyle="black",v.lineWidth=1,o.getTriangles().forEach(function(D,W,I){const A=D.target,M=(A[0][0]-N[0])/s,O=-(A[0][1]-N[1])/s,L=(A[1][0]-N[0])/s,z=-(A[1][1]-N[1])/s,j=(A[2][0]-N[0])/s,Ee=-(A[2][1]-N[1])/s;v.beginPath(),v.moveTo(L,z),v.lineTo(M,O),v.lineTo(j,Ee),v.closePath(),v.stroke()}),v.restore()),v.canvas}const eK=10,BM=.25;class EF{constructor(e,t,r,i,s,a,o){this.sourceProj_=e,this.targetProj_=t;let l={};const c=o?YT(R=>Fr(o,gy(R,this.targetProj_,this.sourceProj_))):gp(this.targetProj_,this.sourceProj_);this.transformInv_=function(R){const N=R[0]+"/"+R[1];return l[N]||(l[N]=c(R)),l[N]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&gn(i)>=gn(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?gn(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?gn(this.targetProj_.getExtent()):null;const h=Rd(r),g=gw(r),m=fw(r),y=dw(r),v=this.transformInv_(h),_=this.transformInv_(g),E=this.transformInv_(m),T=this.transformInv_(y),b=eK+(a?Math.max(0,Math.ceil(Math.log2(WT(r)/(a*a*256*256)))):0);if(this.addQuad_(h,g,m,y,v,_,E,T,b),this.wrapsXInSource_){let R=1/0;this.triangles_.forEach(function(N,D,W){R=Math.min(R,N.source[0][0],N.source[1][0],N.source[2][0])}),this.triangles_.forEach(N=>{if(Math.max(N.source[0][0],N.source[1][0],N.source[2][0])-R>this.sourceWorldWidth_/2){const D=[[N.source[0][0],N.source[0][1]],[N.source[1][0],N.source[1][1]],[N.source[2][0],N.source[2][1]]];D[0][0]-R>this.sourceWorldWidth_/2&&(D[0][0]-=this.sourceWorldWidth_),D[1][0]-R>this.sourceWorldWidth_/2&&(D[1][0]-=this.sourceWorldWidth_),D[2][0]-R>this.sourceWorldWidth_/2&&(D[2][0]-=this.sourceWorldWidth_);const W=Math.min(D[0][0],D[1][0],D[2][0]);Math.max(D[0][0],D[1][0],D[2][0])-W<this.sourceWorldWidth_/2&&(N.source=D)}})}l={}}addTriangle_(e,t,r,i,s,a){this.triangles_.push({source:[i,s,a],target:[e,t,r]})}addQuad_(e,t,r,i,s,a,o,l,c){const h=G4([s,a,o,l]),g=this.sourceWorldWidth_?gn(h)/this.sourceWorldWidth_:null,m=this.sourceWorldWidth_,y=this.sourceProj_.canWrapX()&&g>.5&&g<1;let v=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const E=G4([e,t,r,i]);v=gn(E)/this.targetWorldWidth_>BM||v}!y&&this.sourceProj_.isGlobal()&&g&&(v=g>BM||v)}if(!v&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!_s(h,this.maxSourceExtent_))return;let _=0;if(!v&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)v=!0;else if(_=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(o[0])||!isFinite(o[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),_!=1&&_!=2&&_!=4&&_!=8)return}if(c>0){if(!v){const E=[(e[0]+r[0])/2,(e[1]+r[1])/2],T=this.transformInv_(E);let b;y?b=(_u(s[0],m)+_u(o[0],m))/2-_u(T[0],m):b=(s[0]+o[0])/2-T[0];const R=(s[1]+o[1])/2-T[1];v=b*b+R*R>this.errorThresholdSquared_}if(v){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const E=[(t[0]+r[0])/2,(t[1]+r[1])/2],T=this.transformInv_(E),b=[(i[0]+e[0])/2,(i[1]+e[1])/2],R=this.transformInv_(b);this.addQuad_(e,t,E,b,s,a,T,R,c-1),this.addQuad_(b,E,r,i,R,T,o,l,c-1)}else{const E=[(e[0]+t[0])/2,(e[1]+t[1])/2],T=this.transformInv_(E),b=[(r[0]+i[0])/2,(r[1]+i[1])/2],R=this.transformInv_(b);this.addQuad_(e,E,b,i,s,T,R,l,c-1),this.addQuad_(E,t,r,b,T,a,o,R,c-1)}return}}if(y){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(_&11)==0&&this.addTriangle_(e,r,i,s,o,l),(_&14)==0&&this.addTriangle_(e,r,t,s,o,a),_&&((_&13)==0&&this.addTriangle_(t,i,e,a,l,s),(_&7)==0&&this.addTriangle_(t,i,r,a,l,o))}calculateSourceExtent(){const e=zs();return this.triangles_.forEach(function(t,r,i){const s=t.source;Nm(e,s[0]),Nm(e,s[1]),Nm(e,s[2])}),e}getTriangles(){return this.triangles_}}const SF=.5;class TF extends EA{constructor(e,t,r,i,s,a,o,l,c,h,g,m){super(s,Vt.IDLE,m),this.renderEdges_=g!==void 0?g:!1,this.pixelRatio_=o,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=i,this.wrappedTileCoord_=a||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const y=i.getTileCoordExtent(this.wrappedTileCoord_),v=this.targetTileGrid_.getExtent();let _=this.sourceTileGrid_.getExtent();const E=v?Kl(y,v):y;if(WT(E)===0){this.state=Vt.EMPTY;return}const T=e.getExtent();T&&(_?_=Kl(_,T):_=T);const b=i.getResolution(this.wrappedTileCoord_[0]),R=QH(e,r,E,b);if(!isFinite(R)||R<=0){this.state=Vt.EMPTY;return}const N=h!==void 0?h:SF;if(this.triangulation_=new EF(e,r,E,_,R*N,b),this.triangulation_.getTriangles().length===0){this.state=Vt.EMPTY;return}this.sourceZ_=t.getZForResolution(R);let D=this.triangulation_.calculateSourceExtent();if(_&&(e.canWrapX()?(D[1]=cr(D[1],_[1],_[3]),D[3]=cr(D[3],_[1],_[3])):D=Kl(D,_)),!WT(D))this.state=Vt.EMPTY;else{let W=0,I=0;e.canWrapX()&&(W=gn(T),I=Math.floor((D[0]-T[0])/W)),hD(D.slice(),e,!0).forEach(M=>{const O=t.getTileRangeForExtentAndZ(M,this.sourceZ_);for(let L=O.minX;L<=O.maxX;L++)for(let z=O.minY;z<=O.maxY;z++){const j=c(this.sourceZ_,L,z,o);if(j){const Ee=I*W;this.sourceTiles_.push({tile:j,offset:Ee})}}++I}),this.sourceTiles_.length===0&&(this.state=Vt.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const r=t.tile;if(r&&r.getState()==Vt.LOADED){const i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=t.offset,i[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:i,clipExtent:s,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Vt.ERROR;else{const t=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(t),i=typeof r=="number"?r:r[0],s=typeof r=="number"?r:r[1],a=this.targetTileGrid_.getResolution(t),o=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=wF(i,s,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),a,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Vt.LOADED}this.changed()}load(){if(this.state==Vt.IDLE){this.state=Vt.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const r=t.getState();if(r==Vt.IDLE||r==Vt.LOADING){e++;const i=fn(t,Jt.CHANGE,s=>{const a=t.getState();(a==Vt.LOADED||a==Vt.ERROR||a==Vt.EMPTY)&&(ar(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},r,i){t.getState()==Vt.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(ar),this.sourcesListenerKeys_=null}release(){this.canvas_&&(ww(this.canvas_.getContext("2d")),d0.push(this.canvas_),this.canvas_=null),super.release()}}class SA{constructor(e,t,r,i){this.minX=e,this.maxX=t,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Tf(n,e,t,r,i){return i!==void 0?(i.minX=n,i.maxX=e,i.minY=t,i.maxY=r,i):new SA(n,e,t,r)}class GM{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof ly&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const r=this.entries_[e];return Tn(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const t=this.entries_[e];return Tn(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.key_;return e}getValues(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){Tn(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function U_(n,e,t,r){return r!==void 0?(r[0]=n,r[1]=e,r[2]=t,r):[n,e,t]}function tK(n,e,t){return n+"/"+e+"/"+t}function Zx(n,e,t,r,i){return`${Ut(n)},${e},${tK(t,r,i)}`}function bF(n){return nK(n[0],n[1],n[2])}function nK(n,e,t){return(e<<n)+t}function rK(n,e){const t=n[0],r=n[1],i=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(r,i):!0}class TA extends oF{constructor(e,t){super(e),t=t||{},this.inversePixelTransform_=fi(),this.postProcesses_=t.postProcesses,this.uniforms_=t.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},e.addChangeListener(Ln.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(Si.PRECOMPOSE)){const i=new Om(Si.PRECOMPOSE,void 0,t,e);r.dispatchEvent(i)}}dispatchPostComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(Si.POSTCOMPOSE)){const i=new Om(Si.POSTCOMPOSE,void 0,t,e);r.dispatchEvent(i)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let t=!0,r=-1,i;for(let a=0,o=e.layerStatesArray.length;a<o;a++){const l=e.layerStatesArray[a].layer,c=l.getRenderer();if(!(c instanceof TA)){t=!0;continue}const h=l.getClassName();if((t||h!==i)&&(r+=1,t=!1),i=h,c===this)break}const s="map/"+e.mapId+"/group/"+r;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new KH({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),i&&(this.helper.getCanvas().className=i),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}clearCache(){}disposeInternal(){this.clearCache(),this.removeHelper(),this.getLayer()?.removeChangeListener(Ln.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){Va(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);const s=new Om(e,this.inversePixelTransform_,r,t);i.dispatchEvent(s)}}preRender(e,t){this.dispatchRenderEvent_(Si.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(Si.POSTRENDER,e,t)}}const CS={TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight"};class iK{constructor(e,t){this.name=e,this.data=t,this.texture_=null}getTexture(e){if(!this.texture_){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}function sK(n,e){return`operator_${n}_${Object.keys(e.functions).length}`}function vu(n){const e=n.toString();return e.includes(".")?e:e+".0"}function bA(n){if(n.length<2||n.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${n.length}(${n.map(vu).join(", ")})`}function Jx(n){const e=Ba(n),t=e.length>3?e[3]:1;return bA([e[0]/255,e[1]/255,e[2]/255,t])}function aK(n){const e=ws(n);return bA(e)}const PS={};let oK=0;function Tp(n){return n in PS||(PS[n]=oK++),PS[n]}function Bl(n){return vu(Tp(n))}function RA(n){return"u_var_"+n}function RF(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const MS="getBandValue",lK="u_paletteTextures",AF="featureId",kF="geometryType",cb=-9999999;function cK(n,e,t,r){const i=Ai(n,e,t);return AA(i,e,r)}function In(n){return(e,t,r)=>{const i=t.args.length,s=new Array(i);for(let a=0;a<i;++a)s[a]=AA(t.args[a],r,e);return n(s,e)}}const uK={[pe.Get]:(n,e)=>{const r=e.args[0].value;r in n.properties||(n.properties[r]={name:r,type:e.type});let s="a_prop_"+r;return Ho(e.type,Jr)&&(s=`(${s} > 0.0)`),s},[pe.Id]:n=>(n.featureId=!0,"a_"+AF),[pe.GeometryType]:n=>(n.geometryType=!0,"a_"+kF),[pe.LineMetric]:()=>"currentLineMetric",[pe.Var]:(n,e)=>{const r=e.args[0].value;r in n.variables||(n.variables[r]={name:r,type:e.type});let s=RA(r);return Ho(e.type,Jr)&&(s=`(${s} > 0.0)`),s},[pe.Has]:(n,e)=>{const r=e.args[0].value;return r in n.properties||(n.properties[r]={name:r,type:e.type}),`(a_prop_${r} != ${vu(cb)})`},[pe.Resolution]:()=>"u_resolution",[pe.Zoom]:()=>"u_zoom",[pe.Time]:()=>"u_time",[pe.Any]:In(n=>`(${n.join(" || ")})`),[pe.All]:In(n=>`(${n.join(" && ")})`),[pe.Not]:In(([n])=>`(!${n})`),[pe.Equal]:In(([n,e])=>`(${n} == ${e})`),[pe.NotEqual]:In(([n,e])=>`(${n} != ${e})`),[pe.GreaterThan]:In(([n,e])=>`(${n} > ${e})`),[pe.GreaterThanOrEqualTo]:In(([n,e])=>`(${n} >= ${e})`),[pe.LessThan]:In(([n,e])=>`(${n} < ${e})`),[pe.LessThanOrEqualTo]:In(([n,e])=>`(${n} <= ${e})`),[pe.Multiply]:In(n=>`(${n.join(" * ")})`),[pe.Divide]:In(([n,e])=>`(${n} / ${e})`),[pe.Add]:In(n=>`(${n.join(" + ")})`),[pe.Subtract]:In(([n,e])=>`(${n} - ${e})`),[pe.Clamp]:In(([n,e,t])=>`clamp(${n}, ${e}, ${t})`),[pe.Mod]:In(([n,e])=>`mod(${n}, ${e})`),[pe.Pow]:In(([n,e])=>`pow(${n}, ${e})`),[pe.Abs]:In(([n])=>`abs(${n})`),[pe.Floor]:In(([n])=>`floor(${n})`),[pe.Ceil]:In(([n])=>`ceil(${n})`),[pe.Round]:In(([n])=>`floor(${n} + 0.5)`),[pe.Sin]:In(([n])=>`sin(${n})`),[pe.Cos]:In(([n])=>`cos(${n})`),[pe.Atan]:In(([n,e])=>e!==void 0?`atan(${n}, ${e})`:`atan(${n})`),[pe.Sqrt]:In(([n])=>`sqrt(${n})`),[pe.Match]:In(n=>{const e=n[0],t=n[n.length-1];let r=null;for(let i=n.length-3;i>=1;i-=2){const s=n[i],a=n[i+1];r=`(${e} == ${s} ? ${a} : ${r||t})`}return r}),[pe.Between]:In(([n,e,t])=>`(${n} >= ${e} && ${n} <= ${t})`),[pe.Interpolate]:In(([n,e,...t])=>{let r="";for(let i=0;i<t.length-2;i+=2){const s=t[i],a=r||t[i+1],o=t[i+2],l=t[i+3];let c;n===vu(1)?c=`(${e} - ${s}) / (${o} - ${s})`:c=`(pow(${n}, (${e} - ${s})) - 1.0) / (pow(${n}, (${o} - ${s})) - 1.0)`,r=`mix(${a}, ${l}, clamp(${c}, 0.0, 1.0))`}return r}),[pe.Case]:In(n=>{const e=n[n.length-1];let t=null;for(let r=n.length-3;r>=0;r-=2){const i=n[r],s=n[r+1];t=`(${i} ? ${s} : ${t||e})`}return t}),[pe.In]:In(([n,...e],t)=>{const r=sK("in",t),i=[];for(let s=0;s<e.length;s+=1)i.push(`  if (inputValue == ${e[s]}) { return true; }`);return t.functions[r]=`bool ${r}(float inputValue) {
${i.join(`
`)}
  return false;
}`,`${r}(${n})`}),[pe.Array]:In(n=>`vec${n.length}(${n.join(", ")})`),[pe.Color]:In(n=>{if(n.length===1)return`vec4(vec3(${n[0]} / 255.0), 1.0)`;if(n.length===2)return`vec4(vec3(${n[0]} / 255.0), ${n[1]})`;const e=n.slice(0,3).map(r=>`${r} / 255.0`);if(n.length===3)return`vec4(${e.join(", ")}, 1.0)`;const t=n[3];return`vec4(${e.join(", ")}, ${t})`}),[pe.Band]:In(([n,e,t],r)=>{if(!(MS in r.functions)){let i="";const s=r.bandCount||1;for(let a=0;a<s;a++){const o=Math.floor(a/4);let l=a%4;a===s-1&&l===1&&(l=3);const c=`${CS.TILE_TEXTURE_ARRAY}[${o}]`;i+=`  if (band == ${a+1}.0) {
    return texture2D(${c}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}r.functions[MS]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${CS.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${CS.TEXTURE_PIXEL_HEIGHT};
${i}
}`}return`${MS}(${n}, ${e??"0.0"}, ${t??"0.0"})`}),[pe.Palette]:(n,e)=>{const[t,...r]=e.args,i=r.length,s=new Uint8Array(i*4);for(let c=0;c<r.length;c++){const h=r[c].value,g=Ba(h),m=c*4;s[m]=g[0],s[m+1]=g[1],s[m+2]=g[2],s[m+3]=g[3]*255}n.paletteTextures||(n.paletteTextures=[]);const a=`${lK}[${n.paletteTextures.length}]`,o=new iK(a,s);n.paletteTextures.push(o);const l=AA(t,At,n);return`texture2D(${a}, vec2((${l} + 0.5) / ${i}.0, 0.5))`}};function AA(n,e,t){if(n instanceof lF){const r=uK[n.operator];if(r===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(n.operator)}`);return r(t,n,e)}if((n.type&At)>0)return vu(n.value);if((n.type&Jr)>0)return n.value.toString();if((n.type&di)>0)return Bl(n.value.toString());if((n.type&vr)>0)return Jx(n.value);if((n.type&$s)>0)return bA(n.value);if((n.type&La)>0)return aK(n.value);throw new Error(`Unexpected expression ${n.value} (expected type ${Qf(e)})`)}function hK(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const zM=.985;function qt(n,e,t){const r=fA();return cK(e,t,r,n)}function dK(n){const e=Ba(n),t=e[0]*256,r=e[1],i=e[2]*256,s=Math.round(e[3]*255);return[t+r,i+s]}const fK=`vec4 unpackColor(vec2 packedColor) {
  return vec4(
    min(floor(packedColor[0] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[0], 256.0) / 255.0, 1.0),
    min(floor(packedColor[1] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[1], 256.0) / 255.0, 1.0)
  );
}`;function kA(n){return n===vr||n===La?2:n===$s?4:1}function ub(n){const e=kA(n);return e>1?`vec${e}`:"float"}function IF(n,e){for(const t in e.variables){const r=e.variables[t],i=RA(r.name);let s=ub(r.type);r.type===vr&&(s="vec4"),n.addUniform(i,s)}for(const t in e.properties){const r=e.properties[t],i=ub(r.type),s=`a_prop_${r.name}`;r.type===vr?n.addAttribute(s,i,`unpackColor(${s})`,"vec4"):n.addAttribute(s,i)}for(const t in e.functions)n.addVertexShaderFunction(e.functions[t]),n.addFragmentShaderFunction(e.functions[t])}function CF(n,e){const t={};for(const r in n.variables){const i=n.variables[r],s=RA(i.name);t[s]=()=>{const a=e[i.name];if(typeof a=="number")return a;if(typeof a=="boolean")return a?1:0;if(i.type===vr){const o=[...Ba(a||"#eee")];return o[0]/=255,o[1]/=255,o[2]/=255,o[3]??=1,o}return typeof a=="string"?Tp(a):a}}return t}function PF(n){const e={};for(const t in n.properties){const r=n.properties[t],i=s=>{const a=s.get(r.name);return r.type===vr?dK([...Ba(a||"#eee")]):typeof a=="string"?Tp(a):typeof a=="boolean"?a?1:0:a};e[`prop_${r.name}`]={size:kA(r.type),callback:i}}return e}const bf=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders

${fK}
`,Rf=hK();class MF{constructor(){this.uniforms_=[],this.attributes_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${vu(Rf["circle-radius"])} + ${vu(Rf["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=Jx(Rf["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=vu(Rf["stroke-width"]),this.strokeColorExpression_=Jx(Rf["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=Bl("round"),this.strokeJoinExpression_=Bl("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.strokePatternLengthExpression_=null,this.hasFill_=!1,this.fillColorExpression_=Jx(Rf["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e,t){return this.uniforms_.push({name:e,type:t}),this}addAttribute(e,t,r,i){return this.attributes_.push({name:e,type:t,varyingName:e.replace(/^a_/,"v_"),varyingType:i??t,varyingExpression:r??e}),this}setSymbolSizeExpression(e){return this.hasSymbol_=!0,this.symbolSizeExpression_=e,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(e){return this.hasSymbol_=!0,this.symbolColorExpression_=e,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.hasStroke_=!0,this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.hasStroke_=!0,this.strokeColorExpression_=e,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(e){return this.strokeOffsetExpression_=e,this}setStrokeCapExpression(e){return this.strokeCapExpression_=e,this}setStrokeJoinExpression(e){return this.strokeJoinExpression_=e,this}setStrokeMiterLimitExpression(e){return this.strokeMiterLimitExpression_=e,this}setStrokeDistanceFieldExpression(e){return this.strokeDistanceFieldExpression_=e,this}setStrokePatternLengthExpression(e){return this.strokePatternLengthExpression_=e,this}getStrokePatternLengthExpression(){return this.strokePatternLengthExpression_}setFillColorExpression(e){return this.hasFill_=!0,this.fillColorExpression_=e,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(e){return this.vertexShaderFunctions_.includes(e)?this:(this.vertexShaderFunctions_.push(e),this)}addFragmentShaderFunction(e){return this.fragmentShaderFunctions_.includes(e)?this:(this.fragmentShaderFunctions_.push(e),this)}getSymbolVertexShader(){return this.hasSymbol_?`${bf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_localPosition;
attribute vec2 a_hitColor;

varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx + a_localPosition * halfSizePx * vec2(1., -1.);
  float angle = ${this.symbolRotationExpression_}${this.symbolRotateWithView_?" + u_rotation":""};
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = mix(texCoord.s, texCoord.p, a_localPosition.x * 0.5 + 0.5);
  float v = mix(texCoord.t, texCoord.q, a_localPosition.y * 0.5 + 0.5);
  v_texCoord = vec2(u, v);
  v_hitColor = unpackColor(a_hitColor);
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y);
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${bf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${bf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute vec2 a_localPosition;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_angleTangentSum;
attribute float a_distanceLow;
attribute float a_distanceHigh;
attribute vec2 a_joinAngles;
attribute vec2 a_hitColor;

varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float startEndRatio = a_localPosition.x * 0.5 + 0.5;
  currentLineMetric = mix(a_measureStart, a_measureEnd, startEndRatio);
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);

  // compute current vertex position
  float normalDir = -1. * a_localPosition.y;
  float tangentDir = -1. * a_localPosition.x;
  float angle = mix(v_angleStart, v_angleEnd, startEndRatio);
  vec2 joinDirection;
  vec2 positionPx = mix(segmentStartPx, segmentEndPx, startEndRatio);
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${zM} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStartPx = segmentStartPx;
  v_segmentEndPx = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = unpackColor(a_hitColor);

  v_distancePx = a_distanceLow / u_resolution - (lineOffsetPx * a_angleTangentSum);
  float distanceHighPx = a_distanceHigh / u_resolution;
  ${this.strokePatternLengthExpression_!==null?`v_distancePx = mod(v_distancePx, ${this.strokePatternLengthExpression_});
  distanceHighPx = mod(distanceHighPx, ${this.strokePatternLengthExpression_});
  `:""}v_distancePx += distanceHighPx;

  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${bf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${zM}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${Bl("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${Bl("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${Bl("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${Bl("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

float distanceFromSegment(vec2 point, vec2 start, vec2 end) {
  vec2 tangent = end - start;
  vec2 startToPoint = point - start;
  // inspire by capsule fn in https://iquilezles.org/articles/distfunctions/
  float h = clamp(dot(startToPoint, tangent) / dot(tangent, tangent), 0.0, 1.0);
  return length(startToPoint - tangent * h);
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}

  vec2 currentPointPx = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPointPx);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLengthPx = length(v_segmentEndPx - v_segmentStartPx);
  segmentLengthPx = max(segmentLengthPx, 1.17549429e-38); // avoid divide by zero
  vec2 segmentTangent = (v_segmentEndPx - v_segmentStartPx) / segmentLengthPx;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPointPx = currentPointPx - v_segmentStartPx;
  float lengthToPointPx = max(0., min(dot(segmentTangent, startToPointPx), segmentLengthPx));
  float currentLengthPx = lengthToPointPx + v_distancePx;
  float currentRadiusPx = distanceFromSegment(currentPointPx, v_segmentStartPx, v_segmentEndPx);
  float currentRadiusRatio = dot(segmentNormal, startToPointPx) * 2. / v_width;
  currentLineMetric = mix(v_measureStart, v_measureEnd, lengthToPointPx / segmentLengthPx);

  if (${this.discardExpression_}) { discard; }

  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPointPx, v_segmentEndPx, v_segmentStartPx, v_width, v_angleEnd, capType, joinType);
  float distanceField = max(
    segmentDistanceField(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distanceField = max(distanceField, ${this.strokeDistanceFieldExpression_});

  vec4 color = ${this.strokeColorExpression_};
  color.a *= smoothstep(0.5, -0.5, distanceField);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${bf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_hitColor;

varying vec4 v_hitColor;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = unpackColor(a_hitColor);
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${bf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec4 v_hitColor;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}}class $_{constructor(){this.globalCounter_=0,this.refToFeature_=new Map,this.uidToRef_=new Map,this.freeGlobalRef_=[],this.polygonBatch={entries:{},geometriesCount:0,verticesCount:0,ringsCount:0},this.pointBatch={entries:{},geometriesCount:0},this.lineStringBatch={entries:{},geometriesCount:0,verticesCount:0}}addFeatures(e,t){for(let r=0;r<e.length;r++)this.addFeature(e[r],t)}addFeature(e,t){let r=e.getGeometry();r&&(t&&(r=r.clone(),r.applyTransform(t)),this.addGeometry_(r,e))}clearFeatureEntryInPointBatch_(e){const t=Ut(e),r=this.pointBatch.entries[t];if(r)return this.pointBatch.geometriesCount-=r.flatCoordss.length,delete this.pointBatch.entries[t],r}clearFeatureEntryInLineStringBatch_(e){const t=Ut(e),r=this.lineStringBatch.entries[t];if(r)return this.lineStringBatch.verticesCount-=r.verticesCount,this.lineStringBatch.geometriesCount-=r.flatCoordss.length,delete this.lineStringBatch.entries[t],r}clearFeatureEntryInPolygonBatch_(e){const t=Ut(e),r=this.polygonBatch.entries[t];if(r)return this.polygonBatch.verticesCount-=r.verticesCount,this.polygonBatch.ringsCount-=r.ringsCount,this.polygonBatch.geometriesCount-=r.flatCoordss.length,delete this.polygonBatch.entries[t],r}addGeometry_(e,t){const r=e.getType();switch(r){case"GeometryCollection":{const i=e.getGeometriesArray();for(const s of i)this.addGeometry_(s,t);break}case"MultiPolygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEndss(),t,Ut(t),i.getStride());break}case"MultiLineString":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),t,Ut(t),i.getStride());break}case"MultiPoint":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,t,Ut(t),i.getStride());break}case"Polygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),t,Ut(t),i.getStride());break}case"Point":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,t,Ut(t),i.getStride());break}case"LineString":case"LinearRing":{const i=e,s=i.getStride();this.addCoordinates_(r,i.getFlatCoordinates(),null,t,Ut(t),s,i.getLayout?.());break}}}addCoordinates_(e,t,r,i,s,a,o){let l;switch(e){case"MultiPolygon":{const c=r;for(let h=0,g=c.length;h<g;h++){let m=c[h];const y=h>0?c[h-1]:null,v=y?y[y.length-1]:0,_=m[m.length-1];m=v>0?m.map(E=>E-v):m,this.addCoordinates_("Polygon",t.slice(v,_),m,i,s,a,o)}break}case"MultiLineString":{const c=r;for(let h=0,g=c.length;h<g;h++){const m=h>0?c[h-1]:0;this.addCoordinates_("LineString",t.slice(m,c[h]),null,i,s,a,o)}break}case"MultiPoint":for(let c=0,h=t.length;c<h;c+=a)this.addCoordinates_("Point",t.slice(c,c+2),null,i,s,null,null);break;case"Polygon":{const c=r;if(i instanceof Ds){const m=JD(t,c);if(m.length>1){this.addCoordinates_("MultiPolygon",t,m,i,s,a,o);return}}this.polygonBatch.entries[s]||(this.polygonBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0,ringsCount:0,ringsVerticesCounts:[]})),l=t.length/a;const h=r.length,g=r.map((m,y,v)=>y>0?(m-v[y-1])/a:m/a);this.polygonBatch.verticesCount+=l,this.polygonBatch.ringsCount+=h,this.polygonBatch.geometriesCount++,this.polygonBatch.entries[s].flatCoordss.push(gK(t,a)),this.polygonBatch.entries[s].ringsVerticesCounts.push(g),this.polygonBatch.entries[s].verticesCount+=l,this.polygonBatch.entries[s].ringsCount+=h;for(let m=0,y=c.length;m<y;m++){const v=m>0?c[m-1]:0;this.addCoordinates_("LinearRing",t.slice(v,c[m]),null,i,s,a,o)}break}case"Point":this.pointBatch.entries[s]||(this.pointBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[]})),this.pointBatch.geometriesCount++,this.pointBatch.entries[s].flatCoordss.push(t);break;case"LineString":case"LinearRing":this.lineStringBatch.entries[s]||(this.lineStringBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0})),l=t.length/a,this.lineStringBatch.verticesCount+=l,this.lineStringBatch.geometriesCount++,this.lineStringBatch.entries[s].flatCoordss.push(mK(t,a,o)),this.lineStringBatch.entries[s].verticesCount+=l;break}}addRefToEntry_(e,t){const r=this.uidToRef_.get(e),i=r||this.freeGlobalRef_.pop()||++this.globalCounter_;return t.ref=i,r||(this.refToFeature_.set(i,t.feature),this.uidToRef_.set(e,i)),t}removeRef_(e,t){if(!e)throw new Error("This feature has no ref: "+t);this.refToFeature_.delete(e),this.uidToRef_.delete(t),this.freeGlobalRef_.push(e)}changeFeature(e,t){if(!this.uidToRef_.get(Ut(e)))return;this.removeFeature(e);let r=e.getGeometry();r&&(t&&(r=r.clone(),r.applyTransform(t)),this.addGeometry_(r,e))}removeFeature(e){let t=this.clearFeatureEntryInPointBatch_(e);t=this.clearFeatureEntryInPolygonBatch_(e)||t,t=this.clearFeatureEntryInLineStringBatch_(e)||t,t&&this.removeRef_(t.ref,Ut(t.feature))}clear(){this.polygonBatch.entries={},this.polygonBatch.geometriesCount=0,this.polygonBatch.verticesCount=0,this.polygonBatch.ringsCount=0,this.lineStringBatch.entries={},this.lineStringBatch.geometriesCount=0,this.lineStringBatch.verticesCount=0,this.pointBatch.entries={},this.pointBatch.geometriesCount=0,this.globalCounter_=0,this.freeGlobalRef_=[],this.refToFeature_.clear(),this.uidToRef_.clear()}getFeatureFromRef(e){return this.refToFeature_.get(e)}isEmpty(){return this.globalCounter_===0}filter(e){const t=new $_;t.globalCounter_=this.globalCounter_,t.uidToRef_=this.uidToRef_,t.refToFeature_=this.refToFeature_;let r=!0;for(const i of this.refToFeature_.values())e(i)&&(t.addFeature(i),r=!1);return r?new $_:t}}function gK(n,e){return e===2?n:n.filter((t,r)=>r%e<2)}function mK(n,e,t){return e===3&&t==="XYM"?n:e===4?n.filter((r,i)=>i%e!==2):e===3?n.map((r,i)=>i%e!==2?r:0):new Array(n.length*1.5).fill(0).map((r,i)=>i%3===2?0:n[Math.round(i/1.5)])}function pK(){const n='function t(t,n,x=2){const o=n&&n.length,i=o?n[0]*x:t.length;let f=e(t,0,i,x,!0);const l=[];if(!f||f.next===f.prev)return l;let c,y,h;if(o&&(f=function(t,n,r,x){const o=[];for(let r=0,i=n.length;r<i;r++){const f=e(t,n[r]*x,r<i-1?n[r+1]*x:t.length,x,!1);f===f.next&&(f.steiner=!0),o.push(a(f))}o.sort(u);for(let t=0;t<o.length;t++)r=s(o[t],r);return r}(t,n,f,x)),t.length>80*x){c=t[0],y=t[1];let e=c,n=y;for(let r=x;r<i;r+=x){const x=t[r],o=t[r+1];x<c&&(c=x),o<y&&(y=o),x>e&&(e=x),o>n&&(n=o)}h=Math.max(e-c,n-y),h=0!==h?32767/h:0}return r(f,l,x,c,y,h,0),l}function e(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=d(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=d(x/r|0,t[x],t[x+1],o);return o&&b(o,o.next)&&(w(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(w(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function r(t,e,u,s,l,a,y){if(!t)return;!y&&a&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=c(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,f=0;for(let t=0;t<n&&(f++,i=i.nextZ,i);t++);let u=n;for(;f>0||u>0&&i;)0!==f&&(0===u||!i||x.z<=i.z)?(r=x,x=x.nextZ,f--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,s,l,a);let h=t;for(;t.prev!==t.next;){const c=t.prev,p=t.next;if(a?o(t,s,l,a):x(t))e.push(c.i,t.i,p.i),w(t),t=p.next,h=p.next;else if((t=p)===h){y?1===y?r(t=i(n(t),e),e,u,s,l,a,2):2===y&&f(t,e,u,s,l,a):r(n(t),e,u,s,l,a,1);break}}}function x(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,f=e.y,u=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(f,u,s),a=Math.max(x,o,i),y=Math.max(f,u,s);let p=r.next;for(;p!==e;){if(p.x>=l&&p.x<=a&&p.y>=c&&p.y<=y&&h(x,f,o,u,i,s,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,r){const x=t.prev,o=t,i=t.next;if(v(x,o,i)>=0)return!1;const f=x.x,u=o.x,s=i.x,l=x.y,a=o.y,y=i.y,p=Math.min(f,u,s),b=Math.min(l,a,y),M=Math.max(f,u,s),m=Math.max(l,a,y),A=c(p,b,e,n,r),g=c(M,m,e,n,r);let Z=t.prevZ,d=t.nextZ;for(;Z&&Z.z>=A&&d&&d.z<=g;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;Z&&Z.z>=A;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;d&&d.z<=g;){if(d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function i(t,e){let r=t;do{const n=r.prev,x=r.next.next;!b(n,x)&&M(n,r,r.next,x)&&g(n,x)&&g(x,n)&&(e.push(n.i,r.i,x.i),w(r),w(r.next),r=t=x),r=r.next}while(r!==t);return n(r)}function f(t,e,x,o,i,f){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.i!==t.i&&p(u,t)){let s=Z(u,t);return u=n(u,u.next),s=n(s,s.next),r(u,e,x,o,i,f,0),void r(s,e,x,o,i,f,0)}t=t.next}u=u.next}while(u!==t)}function u(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function s(t,e){const r=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(b(t,n))return n;do{if(b(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const f=o,u=o.x,s=o.y;let c=1/0;n=o;do{if(r>=n.x&&n.x>=u&&r!==n.x&&y(x<s?r:i,x,u,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);g(n,t)&&(e<c||e===c&&(n.x>o.x||n.x===o.x&&l(o,n)))&&(o=n,c=e)}n=n.next}while(n!==f);return o}(t,e);if(!r)return e;const x=Z(r,t);return n(x,x.next),n(r,r.next)}function l(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function c(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function a(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,x,o,i,f){return(x-i)*(e-f)>=(t-i)*(o-f)&&(t-i)*(r-f)>=(n-i)*(e-f)&&(n-i)*(o-f)>=(x-i)*(r-f)}function h(t,e,n,r,x,o,i,f){return!(t===i&&e===f)&&y(t,e,n,r,x,o,i,f)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&M(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(g(t,e)&&g(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||b(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function M(t,e,n,r){const x=A(v(t,e,n)),o=A(v(t,e,r)),i=A(v(n,r,t)),f=A(v(n,r,e));return x!==o&&i!==f||(!(0!==x||!m(t,n,e))||(!(0!==o||!m(t,r,e))||(!(0!==i||!m(n,t,r))||!(0!==f||!m(n,e,r)))))}function m(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function g(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function Z(t,e){const n=F(t.i,t.x,t.y),r=F(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function d(t,e,n,r){const x=F(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function E(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function I(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],f=e[3],u=e[4],s=e[5];return t[0]=f/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-f*u)/n,t[5]=-(x*s-o*u)/n,t}new Array(6);const z=[],B={vertexAttributesPosition:0,instanceAttributesPosition:0,indicesPosition:0};function P(t,e,n,r,x){const o=t[e++],i=t[e++],f=z;f.length=r;for(let n=0;n<f.length;n++)f[n]=t[e+n];let u=x?x.instanceAttributesPosition:0;return n[u++]=o,n[u++]=i,f.length&&(n.set(f,u),u+=f.length),B.instanceAttributesPosition=u,B}function N(t,e,n,r,x,o,i,f,u,s){const l=[t[e],t[e+1]],c=[t[n],t[n+1]],a=t[e+2],y=t[n+2],h=E(f,[...l]),p=E(f,[...c]);function v(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),f=[(n[0]-t[0])/i,(n[1]-t[1])/i];let u=0===r||0===i?0:Math.acos((s=f[0]*x[0]+f[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;u=Math.max(u,1e-5);return f[0]*o[0]+f[1]*o[1]>0?u:2*Math.PI-u}let b=-1,M=-1,m=s;const A=null!==x;if(null!==r){b=v(h,p,E(f,[...[t[r],t[r+1]]])),Math.cos(b)<=.985&&(m+=Math.tan((b-Math.PI)/2))}if(A){M=v(p,h,E(f,[...[t[x],t[x+1]]])),Math.cos(M)<=.985&&(m+=Math.tan((Math.PI-M)/2))}const g=Math.pow(2,24),Z=u%g,d=Math.floor(u/g)*g;return o.push(l[0],l[1],a,c[0],c[1],y,b,M,Z,d,s),o.push(...i),{length:u+Math.sqrt((p[0]-h[0])*(p[0]-h[0])+(p[1]-h[1])*(p[1]-h[1])),angle:m}}function R(e,n,r,x,o){const i=2+o;let f=n;const u=e.slice(f,f+o);f+=o;const s=e[f++];let l=0;const c=new Array(s-1);for(let t=0;t<s;t++)l+=e[f++],t<s-1&&(c[t]=l);const a=e.slice(f,f+2*l),y=t(a,c,2);for(let t=0;t<y.length;t++)x.push(y[t]+r.length/i);for(let t=0;t<a.length;t+=2)r.push(a[t],a[t+1],...u);return f+2*l}const S="GENERATE_POLYGON_BUFFERS",T="GENERATE_POINT_BUFFERS",_="GENERATE_LINE_STRING_BUFFERS",O=self;O.onmessage=t=>{const e=t.data;switch(e.type){case T:{const t=2,n=2,r=e.customAttributesSize,x=n+r,o=new Float32Array(e.renderInstructions),i=o.length/x*(t+r),f=Uint32Array.from([0,1,3,1,2,3]),u=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),s=new Float32Array(i);let l;for(let t=0;t<o.length;t+=x)l=P(o,t,s,r,l);const c=Object.assign({indicesBuffer:f.buffer,vertexAttributesBuffer:u.buffer,instanceAttributesBuffer:s.buffer,renderInstructions:o.buffer},e);O.postMessage(c,[u.buffer,s.buffer,f.buffer,o.buffer]);break}case _:{const t=[],n=e.customAttributesSize,r=3,x=new Float32Array(e.renderInstructions);let o=0;const i=[1,0,0,1,0,0];let f,u;for(I(i,e.renderInstructionsTransform);o<x.length;){u=Array.from(x.slice(o,o+n)),o+=n,f=x[o++];const e=o,s=o+(f-1)*r,l=x[e]===x[s]&&x[e+1]===x[s+1];let c=0,a=0;for(let n=0;n<f-1;n++){let y=null;n>0?y=o+(n-1)*r:l&&(y=s-r);let h=null;n<f-2?h=o+(n+2)*r:l&&(h=e+r);const p=N(x,o+n*r,o+(n+1)*r,y,h,t,u,i,c,a);c=p.length,a=p.angle}o+=f*r}const s=Uint32Array.from([0,1,3,1,2,3]),l=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),c=Float32Array.from(t),a=Object.assign({indicesBuffer:s.buffer,vertexAttributesBuffer:l.buffer,instanceAttributesBuffer:c.buffer,renderInstructions:x.buffer},e);O.postMessage(a,[l.buffer,c.buffer,s.buffer,x.buffer]);break}case S:{const t=[],n=[],r=e.customAttributesSize,x=new Float32Array(e.renderInstructions);let o=0;for(;o<x.length;)o=R(x,o,t,n,r);const i=Uint32Array.from(n),f=Float32Array.from(t),u=Float32Array.from([]),s=Object.assign({indicesBuffer:i.buffer,vertexAttributesBuffer:f.buffer,instanceAttributesBuffer:u.buffer,renderInstructions:x.buffer},e);O.postMessage(s,[f.buffer,u.buffer,i.buffer,x.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(n,"binary").toString("base64"):URL.createObjectURL(new Blob([n],{type:"application/javascript"})))}const NS={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};function yK(n,e){e=e||[];const t=256,r=t-1,i=Math.floor(n/t/t/t)/r,s=Math.floor(n/t/t)%t/r,a=Math.floor(n/t)%t/r,o=n%t/r;return e[0]=i*256*255+s*255,e[1]=a*256*255+o*255,e}function xK(n){let e=0;const t=256,r=t-1;return e+=Math.round(n[0]*t*t*t*r),e+=Math.round(n[1]*t*t*r),e+=Math.round(n[2]*t*r),e+=Math.round(n[3]*r),e}function IA(n,e,t,r){let i=0;for(const s in e){const a=e[s],o=a.callback.call(t,t.feature);let l=o?.[0]??o;l===cb&&console.warn('The "has" operator might return false positives.'),l===void 0?l=cb:l===null&&(l=0),n[r+i++]=l,!(!a.size||a.size===1)&&(n[r+i++]=o[1],!(a.size<3)&&(n[r+i++]=o[2],!(a.size<4)&&(n[r+i++]=o[3])))}return i}function kw(n){return Object.keys(n).reduce((e,t)=>e+(n[t].size||1),0)}function _K(n,e,t,r){const i=(2+kw(t))*n.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++)s[0]=l.flatCoordss[c][0],s[1]=l.flatCoordss[c][1],Fr(r,s),e[a++]=s[0],e[a++]=s[1],a+=IA(e,t,l,a)}return e}function vK(n,e,t,r){const i=3*n.verticesCount+(1+kw(t))*n.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,el(l.flatCoordss[c],0,s.length,3,r,s,3),a+=IA(e,t,l,a),e[a++]=s.length/3;for(let g=0,m=s.length;g<m;g+=3)e[a++]=s[g],e[a++]=s[g+1],e[a++]=s[g+2]}}return e}function wK(n,e,t,r){const i=2*n.verticesCount+(1+kw(t))*n.geometriesCount+n.ringsCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,el(l.flatCoordss[c],0,s.length,2,r,s),a+=IA(e,t,l,a),e[a++]=l.ringsVerticesCounts[c].length;for(let g=0,m=l.ringsVerticesCounts[c].length;g<m;g++)e[a++]=l.ringsVerticesCounts[c][g];for(let g=0,m=s.length;g<m;g+=2)e[a++]=s[g],e[a++]=s[g+1]}}return e}function W_(n){return(JSON.stringify(n).split("").reduce((t,r)=>(t<<5)-t+r.charCodeAt(0),0)>>>0).toString()}function CA(n,e,t,r){if(`${r}radius`in n&&r!=="icon-"){let i=qt(t,n[`${r}radius`],At);if(`${r}radius2`in n){const s=qt(t,n[`${r}radius2`],At);i=`max(${i}, ${s})`}`${r}stroke-width`in n&&(i=`(${i} + ${qt(t,n[`${r}stroke-width`],At)} * 0.5)`),e.setSymbolSizeExpression(`vec2(${i} * 2. + 0.5)`)}if(`${r}scale`in n){const i=qt(t,n[`${r}scale`],La);e.setSymbolSizeExpression(`${e.getSymbolSizeExpression()} * ${i}`)}`${r}displacement`in n&&e.setSymbolOffsetExpression(qt(t,n[`${r}displacement`],$s)),`${r}rotation`in n&&e.setSymbolRotationExpression(qt(t,n[`${r}rotation`],At)),`${r}rotate-with-view`in n&&e.setSymbolRotateWithView(!!n[`${r}rotate-with-view`])}function NF(n,e,t,r,i){let s="vec4(0.)";if(e!==null&&(s=e),t!==null&&r!==null){const l=`smoothstep(-${r} + 0.63, -${r} - 0.58, ${n})`;s=`mix(${t}, ${s}, ${l})`}const a=`(1.0 - smoothstep(-0.63, 0.58, ${n}))`;let o=`${s} * vec4(1.0, 1.0, 1.0, ${a})`;return i!==null&&(o=`${o} * vec4(1.0, 1.0, 1.0, ${i})`),o}function PA(n,e,t,r,i){const s=new Image;s.crossOrigin=n[`${r}cross-origin`]===void 0?"anonymous":n[`${r}cross-origin`],Tn(typeof n[`${r}src`]=="string",`WebGL layers do not support expressions for the ${r}src style property`),s.src=n[`${r}src`],t[`u_texture${i}_size`]=()=>s.complete?[s.width,s.height]:[0,0],e.addUniform(`u_texture${i}_size`,"vec2");const a=`u_texture${i}_size`;return t[`u_texture${i}`]=s,e.addUniform(`u_texture${i}`,"sampler2D"),a}function MA(n,e,t,r,i){let s=qt(t,n[`${e}offset`],La);if(`${e}offset-origin`in n)switch(n[`${e}offset-origin`]){case"top-right":s=`vec2(${r}.x, 0.) + ${i} * vec2(-1., 0.) + ${s} * vec2(-1., 1.)`;break;case"bottom-left":s=`vec2(0., ${r}.y) + ${i} * vec2(0., -1.) + ${s} * vec2(1., -1.)`;break;case"bottom-right":s=`${r} - ${i} - ${s}`;break}return s}function EK(n,e,t,r){r.functions.circleDistanceField=`float circleDistanceField(vec2 point, float radius) {
  return length(point) - radius;
}`,CA(n,e,r,"circle-");let i=null;"circle-opacity"in n&&(i=qt(r,n["circle-opacity"],At));let s="coordsPx";"circle-scale"in n&&(s=`coordsPx / ${qt(r,n["circle-scale"],La)}`);let a=null;"circle-fill-color"in n&&(a=qt(r,n["circle-fill-color"],vr));let o=null;"circle-stroke-color"in n&&(o=qt(r,n["circle-stroke-color"],vr));let l=qt(r,n["circle-radius"],At),c=null;"circle-stroke-width"in n&&(c=qt(r,n["circle-stroke-width"],At),l=`(${l} + ${c} * 0.5)`);const h=`circleDistanceField(${s}, ${l})`,g=NF(h,a,o,c,i);e.setSymbolColorExpression(g)}function SK(n,e,t,r){r.functions.round=`float round(float v) {
  return sign(v) * floor(abs(v) + 0.5);
}`,r.functions.starDistanceField=`float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round(beta / alpha) * alpha; // angle in sector
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  vec2 tipToPoint = inSector + vec2(-radius, 0.);
  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);
  return dot(normalize(edgeNormal), tipToPoint);
}`,r.functions.regularDistanceField=`float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float radiusIn = radius * cos(PI / numPoints);
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  return inSector.x - radiusIn;
}`,CA(n,e,r,"shape-");let i=null;"shape-opacity"in n&&(i=qt(r,n["shape-opacity"],At));let s="coordsPx";"shape-scale"in n&&(s=`coordsPx / ${qt(r,n["shape-scale"],La)}`);let a=null;"shape-fill-color"in n&&(a=qt(r,n["shape-fill-color"],vr));let o=null;"shape-stroke-color"in n&&(o=qt(r,n["shape-stroke-color"],vr));let l=null;"shape-stroke-width"in n&&(l=qt(r,n["shape-stroke-width"],At));const c=qt(r,n["shape-points"],At);let h="0.";"shape-angle"in n&&(h=qt(r,n["shape-angle"],At));let g,m=qt(r,n["shape-radius"],At);if(l!==null&&(m=`${m} + ${l} * 0.5`),"shape-radius2"in n){let v=qt(r,n["shape-radius2"],At);l!==null&&(v=`${v} + ${l} * 0.5`),g=`starDistanceField(${s}, ${c}, ${m}, ${v}, ${h})`}else g=`regularDistanceField(${s}, ${c}, ${m}, ${h})`;const y=NF(g,a,o,l,i);e.setSymbolColorExpression(y)}function TK(n,e,t,r){let i="vec4(1.0)";"icon-color"in n&&(i=qt(r,n["icon-color"],vr)),"icon-opacity"in n&&(i=`${i} * vec4(1.0, 1.0, 1.0, ${qt(r,n["icon-opacity"],At)})`);const s=W_(n["icon-src"]),a=PA(n,e,t,"icon-",s);if(e.setSymbolColorExpression(`${i} * texture2D(u_texture${s}, v_texCoord)`).setSymbolSizeExpression(a),"icon-width"in n&&"icon-height"in n&&e.setSymbolSizeExpression(`vec2(${qt(r,n["icon-width"],At)}, ${qt(r,n["icon-height"],At)})`),"icon-offset"in n&&"icon-size"in n){const o=qt(r,n["icon-size"],$s),l=e.getSymbolSizeExpression();e.setSymbolSizeExpression(o);const c=MA(n,"icon-",r,"v_quadSizePx",o);e.setTextureCoordinateExpression(`(vec4((${c}).xyxy) + vec4(0., 0., ${o})) / (${l}).xyxy`)}if(CA(n,e,r,"icon-"),"icon-anchor"in n){const o=qt(r,n["icon-anchor"],$s);let l="1.0";"icon-scale"in n&&(l=qt(r,n["icon-scale"],La));let c;n["icon-anchor-x-units"]==="pixels"&&n["icon-anchor-y-units"]==="pixels"?c=`${o} * ${l}`:n["icon-anchor-x-units"]==="pixels"?c=`${o} * vec2(vec2(${l}).x, v_quadSizePx.y)`:n["icon-anchor-y-units"]==="pixels"?c=`${o} * vec2(v_quadSizePx.x, vec2(${l}).x)`:c=`${o} * v_quadSizePx`;let h=`v_quadSizePx * vec2(0.5, -0.5) + ${c} * vec2(-1., 1.)`;if("icon-anchor-origin"in n)switch(n["icon-anchor-origin"]){case"top-right":h=`v_quadSizePx * -0.5 + ${c}`;break;case"bottom-left":h=`v_quadSizePx * 0.5 - ${c}`;break;case"bottom-right":h=`v_quadSizePx * vec2(-0.5, 0.5) + ${c} * vec2(1., -1.)`;break}e.setSymbolOffsetExpression(`${e.getSymbolOffsetExpression()} + ${h}`)}}function bK(n,e,t,r){if("stroke-color"in n&&e.setStrokeColorExpression(qt(r,n["stroke-color"],vr)),"stroke-pattern-src"in n){const i=W_(n["stroke-pattern-src"]),s=PA(n,e,t,"stroke-pattern-",i);let a=s,o="vec2(0.)";"stroke-pattern-offset"in n&&"stroke-pattern-size"in n&&(a=qt(r,n["stroke-pattern-size"],$s),o=MA(n,"stroke-pattern-",r,s,a));let l="0.";"stroke-pattern-spacing"in n&&(l=qt(r,n["stroke-pattern-spacing"],At));let c="0.";"stroke-pattern-start-offset"in n&&(c=qt(r,n["stroke-pattern-start-offset"],At)),r.functions.sampleStrokePattern=`vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float startOffsetPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {
  float currentLengthScaled = (currentLengthPx - startOffsetPx) * sampleSize.y / lineWidth;
  float spacingScaled = spacingPx * sampleSize.y / lineWidth;
  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));
  float isInsideOfPattern = step(uCoordPx, sampleSize.x);
  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;
  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);
  vCoordPx = clamp(vCoordPx, 0.5, sampleSize.y - 0.5);
  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;
  return texture2D(texture, texCoord) * vec4(1.0, 1.0, 1.0, isInsideOfPattern);
}`;const h=`u_texture${i}`;let g="1.";"stroke-color"in n&&(g=e.getStrokeColorExpression()),e.setStrokeColorExpression(`${g} * sampleStrokePattern(${h}, ${s}, ${o}, ${a}, ${l}, ${c}, currentLengthPx, currentRadiusRatio, v_width)`),r.functions.computeStrokePatternLength=`float computeStrokePatternLength(vec2 sampleSize, float spacingPx, float lineWidth) {
  float patternLengthPx = sampleSize.x / sampleSize.y * lineWidth;
  return patternLengthPx + spacingPx;
}`,e.setStrokePatternLengthExpression(`computeStrokePatternLength(${a}, ${l}, v_width)`)}if("stroke-width"in n&&e.setStrokeWidthExpression(qt(r,n["stroke-width"],At)),"stroke-offset"in n&&e.setStrokeOffsetExpression(qt(r,n["stroke-offset"],At)),"stroke-line-cap"in n&&e.setStrokeCapExpression(qt(r,n["stroke-line-cap"],di)),"stroke-line-join"in n&&e.setStrokeJoinExpression(qt(r,n["stroke-line-join"],di)),"stroke-miter-limit"in n&&e.setStrokeMiterLimitExpression(qt(r,n["stroke-miter-limit"],At)),"stroke-line-dash"in n){r.functions.getSingleDashDistance=`float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType, float lineWidth) {
  float localDistance = mod(distance, dashLengthTotal);
  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;
  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);
  if (capType == ${Bl("square")}) {
    distanceSegment -= lineWidth * 0.5;
  } else if (capType == ${Bl("round")}) {
    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - lineWidth * 0.5);
  }
  return distanceSegment;
}`;let i=n["stroke-line-dash"].map(v=>qt(r,v,At));i.length%2===1&&(i=[...i,...i]);let s="0.";"stroke-line-dash-offset"in n&&(s=qt(r,n["stroke-line-dash-offset"],At));const o=`dashDistanceField_${W_(n["stroke-line-dash"])}`,l=i.map((v,_)=>`float dashLength${_}`).join(", "),c=i.map((v,_)=>`dashLength${_}`).join(" + ");let h="0.",g=`getSingleDashDistance(distance, radius, ${h}, dashLength0, totalDashLength, capType, lineWidth)`;for(let v=2;v<i.length;v+=2)h=`${h} + dashLength${v-2} + dashLength${v-1}`,g=`min(${g}, getSingleDashDistance(distance, radius, ${h}, dashLength${v}, totalDashLength, capType, lineWidth))`;r.functions[o]=`float ${o}(float distance, float radius, float capType, float lineWidth, ${l}) {
  float totalDashLength = ${c};
  return ${g};
}`;const m=i.map((v,_)=>`${v}`).join(", ");e.setStrokeDistanceFieldExpression(`${o}(currentLengthPx + ${s}, currentRadiusPx, capType, v_width, ${m})`);let y=i.join(" + ");e.getStrokePatternLengthExpression()&&(r.functions.combinePatternLengths=`float combinePatternLengths(float patternLength1, float patternLength2) {
  return patternLength1 * patternLength2;
}`,y=`combinePatternLengths(${e.getStrokePatternLengthExpression()}, ${y})`),e.setStrokePatternLengthExpression(y)}}function RK(n,e,t,r){if("fill-color"in n&&e.setFillColorExpression(qt(r,n["fill-color"],vr)),"fill-pattern-src"in n){const i=W_(n["fill-pattern-src"]),s=PA(n,e,t,"fill-pattern-",i);let a=s,o="vec2(0.)";"fill-pattern-offset"in n&&"fill-pattern-size"in n&&(a=qt(r,n["fill-pattern-size"],$s),o=MA(n,"fill-pattern-",r,s,a)),r.functions.sampleFillPattern=`vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {
  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);
  vec2 pxRelativePos = pxPosition - pxOrigin;
  // rotate the relative position from origin by the current view rotation
  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));
  // sample position is computed according to the sample offset & size
  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);
  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));
  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright
  return texture2D(texture, (samplePos + textureOffset) / textureSize);
}`;const l=`u_texture${i}`;let c="1.";"fill-color"in n&&(c=e.getFillColorExpression()),e.setFillColorExpression(`${c} * sampleFillPattern(${l}, ${s}, ${o}, ${a}, pxOrigin, pxPos)`)}}function UM(n,e,t){const r=RF(),i=new MF,s={};if("icon-src"in n?TK(n,i,s,r):"shape-points"in n?SK(n,i,s,r):"circle-radius"in n&&EK(n,i,s,r),bK(n,i,s,r),RK(n,i,s,r),t){const l=qt(r,t,Jr);i.setFragmentDiscardExpression(`!${l}`)}const a={};function o(l,c,h,g){if(!r[l])return;const m=ub(h),y=kA(h);i.addAttribute(`a_${c}`,m),a[c]={size:y,callback:g}}return o("geometryType",kF,di,l=>Tp(gA(l.getGeometry()))),o("featureId",AF,di|At,l=>{const c=l.getId()??null;return typeof c=="string"?Tp(c):c}),IF(i,r),{builder:i,attributes:{...a,...PF(r)},uniforms:{...s,...CF(r,e)}}}const AK=[];let LS;function kK(){return LS||(LS=pK()),LS}let IK=0;const ba={POSITION:"a_position",LOCAL_POSITION:"a_localPosition",SEGMENT_START:"a_segmentStart",SEGMENT_END:"a_segmentEnd",MEASURE_START:"a_measureStart",MEASURE_END:"a_measureEnd",ANGLE_TANGENT_SUM:"a_angleTangentSum",JOIN_ANGLES:"a_joinAngles",DISTANCE_LOW:"a_distanceLow",DISTANCE_HIGH:"a_distanceHigh"};class CK{constructor(e,t,r,i){this.helper_,this.hitDetectionEnabled_=!!i,this.styleShaders=PK(e,t),this.customAttributes_={},this.uniforms_={},this.hitDetectionEnabled_&&(this.customAttributes_.hitColor={callback(){return yK(this.ref,AK)},size:2});for(const s of this.styleShaders){for(const a in s.attributes)a in this.customAttributes_||(this.customAttributes_[a]=s.attributes[a]);for(const a in s.uniforms)a in this.uniforms_||(this.uniforms_[a]=s.uniforms[a])}this.renderPasses_=this.styleShaders.map(s=>{const a={},o=Object.entries(this.customAttributes_).map(([l,c])=>({name:l in s.attributes||l==="hitColor"?`a_${l}`:null,size:c.size||1,type:ji.FLOAT}));return s.builder.getFillVertexShader()&&(a.fillRenderPass={vertexShader:s.builder.getFillVertexShader(),fragmentShader:s.builder.getFillFragmentShader(),attributesDesc:[{name:ba.POSITION,size:2,type:ji.FLOAT},...o],instancedAttributesDesc:[],instancePrimitiveVertexCount:3}),s.builder.getStrokeVertexShader()&&(a.strokeRenderPass={vertexShader:s.builder.getStrokeVertexShader(),fragmentShader:s.builder.getStrokeFragmentShader(),attributesDesc:[{name:ba.LOCAL_POSITION,size:2,type:ji.FLOAT}],instancedAttributesDesc:[{name:ba.SEGMENT_START,size:2,type:ji.FLOAT},{name:ba.MEASURE_START,size:1,type:ji.FLOAT},{name:ba.SEGMENT_END,size:2,type:ji.FLOAT},{name:ba.MEASURE_END,size:1,type:ji.FLOAT},{name:ba.JOIN_ANGLES,size:2,type:ji.FLOAT},{name:ba.DISTANCE_LOW,size:1,type:ji.FLOAT},{name:ba.DISTANCE_HIGH,size:1,type:ji.FLOAT},{name:ba.ANGLE_TANGENT_SUM,size:1,type:ji.FLOAT},...o],instancePrimitiveVertexCount:6}),s.builder.getSymbolVertexShader()&&(a.symbolRenderPass={vertexShader:s.builder.getSymbolVertexShader(),fragmentShader:s.builder.getSymbolFragmentShader(),attributesDesc:[{name:ba.LOCAL_POSITION,size:2,type:ji.FLOAT}],instancedAttributesDesc:[{name:ba.POSITION,size:2,type:ji.FLOAT},...o],instancePrimitiveVertexCount:6}),a}),this.hasFill_=this.renderPasses_.some(s=>s.fillRenderPass),this.hasStroke_=this.renderPasses_.some(s=>s.strokeRenderPass),this.hasSymbol_=this.renderPasses_.some(s=>s.symbolRenderPass),this.setHelper(r)}async generateBuffers(e,t){if(e.isEmpty())return null;const r=this.generateRenderInstructions_(e,t),[i,s,a]=await Promise.all([this.generateBuffersForType_(r.polygonInstructions,"Polygon",t),this.generateBuffersForType_(r.lineStringInstructions,"LineString",t),this.generateBuffersForType_(r.pointInstructions,"Point",t)]),o=mp(fi(),t);return{polygonBuffers:i,lineStringBuffers:s,pointBuffers:a,invertVerticesTransform:o}}generateRenderInstructions_(e,t){const r=this.hasFill_?wK(e.polygonBatch,new Float32Array(0),this.customAttributes_,t):null,i=this.hasStroke_?vK(e.lineStringBatch,new Float32Array(0),this.customAttributes_,t):null,s=this.hasSymbol_?_K(e.pointBatch,new Float32Array(0),this.customAttributes_,t):null;return{polygonInstructions:r,lineStringInstructions:i,pointInstructions:s}}generateBuffersForType_(e,t,r){if(e===null)return null;const i=IK++;let s;switch(t){case"Polygon":s=NS.GENERATE_POLYGON_BUFFERS;break;case"LineString":s=NS.GENERATE_LINE_STRING_BUFFERS;break;case"Point":s=NS.GENERATE_POINT_BUFFERS;break}const a={id:i,type:s,renderInstructions:e.buffer,renderInstructionsTransform:r,customAttributesSize:kw(this.customAttributes_)},o=kK();return o.postMessage(a,[e.buffer]),e=null,new Promise(l=>{const c=h=>{const g=h.data;if(g.id!==i||(o.removeEventListener("message",c),!this.helper_.getGL()))return;const m=new AS(wA,RS).fromArrayBuffer(g.indicesBuffer),y=new AS(B_,RS).fromArrayBuffer(g.vertexAttributesBuffer),v=new AS(B_,RS).fromArrayBuffer(g.instanceAttributesBuffer);this.helper_.flushBufferData(m),this.helper_.flushBufferData(y),this.helper_.flushBufferData(v),l([m,y,v])};o.addEventListener("message",c)})}render(e,t,r){for(const i of this.renderPasses_)i.fillRenderPass&&this.renderInternal_(e.polygonBuffers[0],e.polygonBuffers[1],e.polygonBuffers[2],i.fillRenderPass,t,r),i.strokeRenderPass&&this.renderInternal_(e.lineStringBuffers[0],e.lineStringBuffers[1],e.lineStringBuffers[2],i.strokeRenderPass,t,r),i.symbolRenderPass&&this.renderInternal_(e.pointBuffers[0],e.pointBuffers[1],e.pointBuffers[2],i.symbolRenderPass,t,r)}renderInternal_(e,t,r,i,s,a){const o=e.getSize();if(o===0)return;const l=i.instancedAttributesDesc.length;if(this.helper_.useProgram(i.program,s),this.helper_.bindBuffer(t),this.helper_.bindBuffer(e),this.helper_.enableAttributes(i.attributesDesc),this.helper_.bindBuffer(r),this.helper_.enableAttributesInstanced(i.instancedAttributesDesc),a(),l){const c=i.instancedAttributesDesc.reduce((g,m)=>g+(m.size||1),0),h=r.getSize()/c;this.helper_.drawElementsInstanced(0,o,h)}else this.helper_.drawElements(0,o)}setHelper(e,t=null){this.helper_=e;for(const r of this.renderPasses_)r.fillRenderPass&&(r.fillRenderPass.program=this.helper_.getProgram(r.fillRenderPass.fragmentShader,r.fillRenderPass.vertexShader)),r.strokeRenderPass&&(r.strokeRenderPass.program=this.helper_.getProgram(r.strokeRenderPass.fragmentShader,r.strokeRenderPass.vertexShader)),r.symbolRenderPass&&(r.symbolRenderPass.program=this.helper_.getProgram(r.symbolRenderPass.fragmentShader,r.symbolRenderPass.vertexShader));this.helper_.addUniforms(this.uniforms_),t&&(t.polygonBuffers&&(this.helper_.flushBufferData(t.polygonBuffers[0]),this.helper_.flushBufferData(t.polygonBuffers[1]),this.helper_.flushBufferData(t.polygonBuffers[2])),t.lineStringBuffers&&(this.helper_.flushBufferData(t.lineStringBuffers[0]),this.helper_.flushBufferData(t.lineStringBuffers[1]),this.helper_.flushBufferData(t.lineStringBuffers[2])),t.pointBuffers&&(this.helper_.flushBufferData(t.pointBuffers[0]),this.helper_.flushBufferData(t.pointBuffers[1]),this.helper_.flushBufferData(t.pointBuffers[2])))}}function PK(n,e){const t=Array.isArray(n)?n:[n];if("style"in t[0]){const r=[],i=t,s=[];for(const a of i){const o=Array.isArray(a.style)?a.style:[a.style];let l=a.filter;a.else&&s.length&&(l=["all",...s.map(h=>["!",h])],a.filter&&l.push(a.filter),l.length<3&&(l=l[1])),a.filter&&s.push(a.filter);const c=o.map(h=>UM(h,e,l));r.push(...c)}return r}return"builder"in t[0]?t:t.map(r=>UM(r,e,null))}const Uo=new Uint8Array(4);class MK{constructor(e,t){this.helper_=e;const r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.depthbuffer_=r.createRenderbuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){hc(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,t){if(e<0||t<0||e>this.size_[0]||t>=this.size_[1])return Uo[0]=0,Uo[1]=0,Uo[2]=0,Uo[3]=0,Uo;this.readAll();const r=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return Uo[0]=this.data_[r*4],Uo[1]=this.data_[r*4+1],Uo[2]=this.data_[r*4+2],Uo[3]=this.data_[r*4+3],Uo}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),t.bindRenderbuffer(t.RENDERBUFFER,this.depthbuffer_),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e[0],e[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}}function NK(n,e){const t=n.viewState.projection,i=e.getSource().getWrapX()&&t.canWrapX(),s=t.getExtent(),a=n.extent,o=i?gn(s):null,l=i?Math.ceil((a[2]-s[2])/o)+1:1;return[i?Math.floor((a[0]-s[0])/o):0,l,o]}const Af={...jl,RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",GLOBAL_ALPHA:"u_globalAlpha"};class LK extends TA{constructor(e,t){const r={[Af.RENDER_EXTENT]:[0,0,0,0],[Af.PATTERN_ORIGIN]:[0,0],[Af.GLOBAL_ALPHA]:1};super(e,{uniforms:r,postProcesses:t.postProcesses}),this.hitDetectionEnabled_=!t.disableHitDetection,this.hitRenderTarget_,this.sourceRevision_=-1,this.previousExtent_=zs(),this.currentTransform_=fi(),this.tmpCoords_=[0,0],this.tmpTransform_=fi(),this.tmpMat4_=yF(),this.currentFrameStateTransform_=fi(),this.styleVariables_={},this.style_=[],this.styleRenderer_=null,this.buffers_=null,this.applyOptions_(t),this.batch_=new $_,this.initialFeaturesAdded_=!1,this.sourceListenKeys_=null}addInitialFeatures_(e){const t=this.getLayer().getSource();let r;this.batch_.addFeatures(t.getFeatures(),r),this.sourceListenKeys_=[fn(t,ns.ADDFEATURE,this.handleSourceFeatureAdded_.bind(this,r)),fn(t,ns.CHANGEFEATURE,this.handleSourceFeatureChanged_.bind(this,r),this),fn(t,ns.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),fn(t,ns.CLEAR,this.handleSourceFeatureClear_,this)]}applyOptions_(e){this.styleVariables_=e.variables,this.style_=e.style}createRenderers_(){this.buffers_=null,this.styleRenderer_=new CK(this.style_,this.styleVariables_,this.helper,this.hitDetectionEnabled_)}reset(e){this.applyOptions_(e),this.helper&&this.createRenderers_(),super.reset(e)}afterHelperCreated(){this.styleRenderer_?this.styleRenderer_.setHelper(this.helper,this.buffers_):this.createRenderers_(),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new MK(this.helper))}handleSourceFeatureAdded_(e,t){const r=t.feature;this.batch_.addFeature(r,e)}handleSourceFeatureChanged_(e,t){const r=t.feature;this.batch_.changeFeature(r,e)}handleSourceFeatureDelete_(e){const t=e.feature;this.batch_.removeFeature(t)}handleSourceFeatureClear_(){this.batch_.clear()}applyUniforms_(e){TD(this.tmpTransform_,this.currentFrameStateTransform_),SD(this.tmpTransform_,e),this.helper.setUniformMatrixValue(Af.PROJECTION_MATRIX,ob(this.tmpMat4_,this.tmpTransform_)),mp(this.tmpTransform_,this.tmpTransform_),this.helper.setUniformMatrixValue(Af.SCREEN_TO_WORLD_MATRIX,ob(this.tmpMat4_,this.tmpTransform_)),this.tmpCoords_[0]=0,this.tmpCoords_[1]=0,mp(this.tmpTransform_,e),Fr(this.tmpTransform_,this.tmpCoords_),this.helper.setUniformFloatVec2(Af.PATTERN_ORIGIN,this.tmpCoords_)}renderFrame(e){const t=this.helper.getGL();this.preRender(t,e);const[r,i,s]=NK(e,this.getLayer());this.helper.prepareDraw(e),this.renderWorlds(e,!1,r,i,s),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const a=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,r,i,s),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),a}prepareFrameInternal(e){this.initialFeaturesAdded_||(this.addInitialFeatures_(e),this.initialFeaturesAdded_=!0);const t=this.getLayer(),r=t.getSource(),i=e.viewState,s=!e.viewHints[Zr.ANIMATING]&&!e.viewHints[Zr.INTERACTING],a=!rd(this.previousExtent_,e.extent),o=this.sourceRevision_<r.getRevision();if(o&&(this.sourceRevision_=r.getRevision()),s&&(a||o)){const l=i.projection,c=i.resolution,h=t instanceof Rw?t.getRenderBuffer():0,g=k0(e.extent,h*c);r.loadFeatures(g,c,l),this.ready=!1;const m=this.helper.makeProjectionTransform(e,fi());this.styleRenderer_.generateBuffers(this.batch_,m).then(y=>{this.buffers_&&this.disposeBuffers(this.buffers_),this.buffers_=y,this.ready=!0,this.getLayer().changed()}),this.previousExtent_=e.extent.slice()}return!0}renderWorlds(e,t,r,i,s){let a=r;t&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0));do this.helper.makeProjectionTransform(e,this.currentFrameStateTransform_),r$(this.currentFrameStateTransform_,a*s,0),this.buffers_&&this.styleRenderer_.render(this.buffers_,e,()=>{this.applyUniforms_(this.buffers_.invertVerticesTransform),this.helper.applyHitDetectionUniform(t)});while(++a<i)}forEachFeatureAtCoordinate(e,t,r,i,s){if(Tn(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.styleRenderer_||!this.hitDetectionEnabled_)return;const a=Fr(t.coordinateToPixelTransform,e.slice()),o=this.hitRenderTarget_.readPixel(a[0]/2,a[1]/2),l=[o[0]/255,o[1]/255,o[2]/255,o[3]/255],c=xK(l),h=this.batch_.getFeatureFromRef(c);if(h)return i(h,this.getLayer(),null)}disposeBuffers(e){const t=r=>{for(const i of r)i&&this.helper.deleteBuffer(i)};e.pointBuffers&&t(e.pointBuffers),e.lineStringBuffers&&t(e.lineStringBuffers),e.polygonBuffers&&t(e.polygonBuffers)}disposeInternal(){this.buffers_&&this.disposeBuffers(this.buffers_),this.sourceListenKeys_&&(this.sourceListenKeys_.forEach(function(e){ar(e)}),this.sourceListenKeys_=null),super.disposeInternal()}renderDeclutter(){}}const Ol={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},OK=["#00f","#0ff","#0f0","#ff0","#f00"];class DK extends Rw{constructor(e){e=e||{};const t=Object.assign({},e);delete t.gradient,delete t.radius,delete t.blur,delete t.weight,super(t),this.filter_=e.filter??!0,this.styleVariables_=e.variables||{},this.gradient_=null,this.addChangeListener(Ol.GRADIENT,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:OK),this.setBlur(e.blur!==void 0?e.blur:15),this.setRadius(e.radius!==void 0?e.radius:8);const r=e.weight?e.weight:"weight";this.weight_=r,this.setRenderOrder(null)}getBlur(){return this.get(Ol.BLUR)}getGradient(){return this.get(Ol.GRADIENT)}getRadius(){return this.get(Ol.RADIUS)}handleGradientChanged_(){this.gradient_=FK(this.getGradient())}setBlur(e){const t=this.get(Ol.BLUR);if(this.set(Ol.BLUR,e),typeof e=="number"&&typeof t=="number"){this.changed();return}this.clearRenderer()}setGradient(e){this.set(Ol.GRADIENT,e)}setRadius(e){const t=this.get(Ol.RADIUS);if(this.set(Ol.RADIUS,e),typeof e=="number"&&typeof t=="number"){this.changed();return}this.clearRenderer()}setFilter(e){this.filter_=e,this.changed(),this.clearRenderer()}setWeight(e){this.weight_=e,this.changed(),this.clearRenderer()}createRenderer(){const e=new MF,t=RF(),r=qt(t,this.filter_,Jr);let i=qt(t,this.getRadius(),At),s=qt(t,this.getBlur(),At);const a={};typeof this.getBlur()=="number"&&(s="a_blur",a.a_blur=()=>this.getBlur(),e.addUniform("a_blur","float")),typeof this.getRadius()=="number"&&(i="a_radius",a.a_radius=()=>this.getRadius(),e.addUniform("a_radius","float"));const o={};let l=null;if(typeof this.weight_=="string"||typeof this.weight_=="function"){const g=typeof this.weight_=="string"?m=>m.get(this.weight_):this.weight_;o.prop_weight={size:1,callback:m=>{const y=g(m);return y!==void 0?cr(y,0,1):1}},l="a_prop_weight",e.addAttribute("a_prop_weight","float")}else{const g=["clamp",this.weight_,0,1];l=qt(t,g,At)}e.addFragmentShaderFunction(`float getBlurSlope() {
  float blur = max(1., ${s});
  float radius = ${i};
  return radius / blur;
}`).setSymbolSizeExpression(`vec2(${i} + ${s}) * 2.`).setSymbolColorExpression(`vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * getBlurSlope()) * ${l})`).setStrokeColorExpression(`vec4(smoothstep(0., 1., (1. - length(currentRadiusPx * 2. / v_width)) * getBlurSlope()) * ${l})`).setStrokeWidthExpression(`(${i} + ${s}) * 2.`).setFillColorExpression(`vec4(${l})`).setFragmentDiscardExpression(`!${r}`),IF(e,t);const c=PF(t),h=CF(t,this.styleVariables_);return new LK(this,{className:this.getClassName(),variables:this.styleVariables_,style:{builder:e,attributes:{...c,...o},uniforms:{...h,...a}},disableHitDetection:!1,postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}renderDeclutter(){}}function FK(n){const r=ti(1,256),i=r.createLinearGradient(0,0,1,256),s=1/(n.length-1);for(let a=0,o=n.length;a<o;++a)i.addColorStop(a*s,n[a]);return r.fillStyle=i,r.fillRect(0,0,1,256),r.canvas}class jK extends hA{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,s=i.resolution,a=this.getLayer().getSource(),o=e.viewHints;let l=e.extent;if(t.extent!==void 0&&(l=Kl(l,Yo(t.extent,i.projection))),!o[Zr.ANIMATING]&&!o[Zr.INTERACTING]&&!rg(l))if(a){const c=i.projection,h=a.getImage(l,s,r,c);h&&(this.loadImage(h)?this.image=h:h.getState()===Tt.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=Fr(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!nd(s,i))return null;const a=this.image.getExtent(),o=this.image.getImage(),l=gn(a),c=Math.floor(o.width*((i[0]-a[0])/l));if(c<0||c>=o.width)return null;const h=Qr(a),g=Math.floor(o.height*((a[3]-i[1])/h));return g<0||g>=o.height?null:this.getImageData(o,c,g)}renderFrame(e,t){const r=this.image,i=r.getExtent(),s=r.getResolution(),[a,o]=Array.isArray(s)?s:[s,s],l=r.getPixelRatio(),c=e.layerStatesArray[e.layerIndex],h=e.pixelRatio,g=e.viewState,m=g.center,y=g.resolution,v=h*a/(y*l),_=h*o/(y*l);this.prepareContainer(e,t);const E=this.context.canvas.width,T=this.context.canvas.height,b=this.getRenderContext(e);let R=!1,N=!0;if(c.extent){const M=Yo(c.extent,g.projection);N=_s(M,e.extent),R=N&&!ou(M,e.extent),R&&this.clipUnrotated(b,e,M)}const D=r.getImage(),W=Va(this.tempTransform,E/2,T/2,v,_,0,l*(i[0]-m[0])/a,l*(m[1]-i[3])/o);this.renderedResolution=o*h/l;const I=D.width*W[0],A=D.height*W[3];if(this.getLayer().getSource().getInterpolate()||(b.imageSmoothingEnabled=!1),this.preRender(b,e),N&&I>=.5&&A>=.5){const M=W[4],O=W[5],L=c.opacity;L!==1&&(b.save(),b.globalAlpha=L),b.drawImage(D,0,0,+D.width,+D.height,M,O,I,A),L!==1&&b.restore()}return this.postRender(this.context,e),R&&b.restore(),b.imageSmoothingEnabled=!0,this.container}}class VK extends vy{constructor(e){e=e||{},super(e)}}class BK extends VK{constructor(e){super(e)}createRenderer(){return new jK(this)}getData(e){return super.getData(e)}}function OS(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const r=n[t],i=r.has(e);return i||r.add(e),!i}function GK(n,e,t){const r=n[t];return r?r.delete(e):!1}function $M(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Kl(e,Yo(t.extent,n.viewState.projection)));const r=t.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(n.viewState.projection).getExtent();i&&(e=Kl(e,i))}return e}class zK extends hA{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=zs(),this.tempTileRange_=new SA(0,0,0,0),this.tempTileCoord_=U_(0,0,0);const r=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new GM(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new GM(512)),this.sourceTileCache_}getOrCreateTile(e,t,r,i){const s=this.tileCache_,o=this.getLayer().getSource(),l=Zx(o,o.getKey(),e,t,r);let c;if(s.containsKey(l))c=s.get(l);else{const h=i.viewState.projection,g=o.getProjection();if(c=o.getTile(e,t,r,i.pixelRatio,h,!g||Xh(g,h)?void 0:this.getSourceTileCache()),!c)return null;s.set(l,c)}return c}getTile(e,t,r,i){const s=this.getOrCreateTile(e,t,r,i);return s||null}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=Fr(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!nd(s,i))return null;const a=t.viewState,o=r.getRenderSource(),l=o.getTileGridForProjection(a.projection),c=o.getTilePixelRatio(t.pixelRatio);for(let h=l.getZForResolution(a.resolution);h>=l.getMinZoom();--h){const g=l.getTileCoordForCoordAndZ(i,h),m=this.getTile(h,g[1],g[2],t);if(!m||m.getState()!==Vt.LOADED)continue;const y=l.getOrigin(h),v=ws(l.getTileSize(h)),_=l.getResolution(h);let E;if(m instanceof vF||m instanceof TF)E=m.getImage();else if(m instanceof jM){if(E=lb(m.getData()),!E)continue}else continue;const T=Math.floor(c*((i[0]-y[0])/_-g[1]*v[0])),b=Math.floor(c*((y[1]-i[1])/_-g[2]*v[1])),R=Math.round(c*o.getGutterForProjection(a.projection));return this.getImageData(E,T+R,b+R)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const r=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,r,i,s){const a=e.viewState,o=this.getLayer(),l=o.getRenderSource(),c=l.getTileGridForProjection(a.projection),h=Ut(l);h in e.wantedTiles||(e.wantedTiles[h]={});const g=e.wantedTiles[h],m=o.getMapInternal(),y=Math.max(r-s,c.getMinZoom(),c.getZForResolution(Math.min(o.getMaxResolution(),m?m.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),v=a.rotation,_=v?cD(a.center,a.resolution,v,e.size):void 0;for(let E=r;E>=y;--E){const T=c.getTileRangeForExtentAndZ(t,E,this.tempTileRange_),b=c.getResolution(E);for(let R=T.minX;R<=T.maxX;++R)for(let N=T.minY;N<=T.maxY;++N){if(v&&!c.tileCoordIntersectsViewport([E,R,N],_))continue;const D=this.getTile(E,R,N,e);if(!D||!OS(i,D,E))continue;const I=D.getKey();if(g[I]=!0,D.getState()===Vt.IDLE&&!e.tileQueue.isKeyQueued(I)){const A=U_(E,R,N,this.tempTileCoord_);e.tileQueue.enqueue([D,h,c.getTileCoordCenter(A),b])}}}}findStaleTile_(e,t){const r=this.tileCache_,i=e[0],s=e[1],a=e[2],o=this.getStaleKeys();for(let l=0;l<o.length;++l){const c=Zx(this.getLayer().getSource(),o[l],i,s,a);if(r.containsKey(c)){const h=r.peek(c);if(h.getState()===Vt.LOADED)return h.endTransition(Ut(this)),OS(t,h,i),!0}}return!1}findAltTiles_(e,t,r,i){const s=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!s)return!1;let a=!0;const o=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let g=s.minY;g<=s.maxY;++g){const m=Zx(l,c,r,h,g);let y=!1;if(o.containsKey(m)){const v=o.peek(m);v.getState()===Vt.LOADED&&(OS(i,v,r),y=!0)}y||(a=!1)}return a}renderFrame(e,t){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,s=i.projection,a=i.resolution,o=i.center,l=e.pixelRatio,c=this.getLayer(),h=c.getSource(),g=h.getTileGridForProjection(s),m=g.getZForResolution(a,h.zDirection),y=g.getResolution(m),v=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==v&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=v):this.renderedSourceKey_=v;let _=e.extent;const E=h.getTilePixelRatio(l);this.prepareContainer(e,t);const T=this.context.canvas.width,b=this.context.canvas.height,R=r.extent&&Yo(r.extent);R&&(_=Kl(_,Yo(r.extent)));const N=y*T/2/E,D=y*b/2/E,W=[o[0]-N,o[1]-D,o[0]+N,o[1]+D],I={};this.renderedTiles.length=0;const A=c.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const ce=g.getZForResolution(i.nextResolution,h.zDirection),Me=$M(e,e.nextExtent);this.enqueueTiles(e,Me,ce,I,A)}const M=$M(e,_);if(this.enqueueTiles(e,M,m,I,0),A>0&&setTimeout(()=>{this.enqueueTiles(e,M,m-1,I,A-1)},0),!(m in I))return this.container;const O=Ut(this),L=e.time;for(const ce of I[m]){const Me=ce.getState();if(Me===Vt.EMPTY)continue;const Te=ce.tileCoord;if(Me===Vt.LOADED&&ce.getAlpha(O,L)===1){ce.endTransition(O);continue}if(Me!==Vt.ERROR&&(this.renderComplete=!1),this.findStaleTile_(Te,I)){GK(I,ce,m),e.animate=!0;continue}if(this.findAltTiles_(g,Te,m+1,I))continue;const Z=g.getMinZoom();for(let te=m-1;te>=Z&&!this.findAltTiles_(g,Te,te,I);--te);}const z=y/a*l/E,j=this.getRenderContext(e);Va(this.tempTransform,T/2,b/2,z,z,0,-T/2,-b/2),r.extent&&this.clipUnrotated(j,e,R),h.getInterpolate()||(j.imageSmoothingEnabled=!1),this.preRender(j,e);const Ee=Object.keys(I).map(Number);Ee.sort(Hl);let Ce;const Ge=[],Le=[];for(let ce=Ee.length-1;ce>=0;--ce){const Me=Ee[ce],Te=h.getTilePixelSize(Me,l,s),V=g.getResolution(Me)/y,Z=Te[0]*V*z,te=Te[1]*V*z,se=g.getTileCoordForCoordAndZ(Rd(W),Me),he=g.getTileCoordExtent(se),Ae=Fr(this.tempTransform,[E*(he[0]-W[0])/y,E*(W[3]-he[3])/y]),Fe=E*h.getGutterForProjection(s);for(const de of I[Me]){if(de.getState()!==Vt.LOADED)continue;const Pe=de.tileCoord,Be=se[1]-Pe[1],It=Math.round(Ae[0]-(Be-1)*Z),Wt=se[2]-Pe[2],Dt=Math.round(Ae[1]-(Wt-1)*te),Zt=Math.round(Ae[0]-Be*Z),rn=Math.round(Ae[1]-Wt*te),ht=It-Zt,rr=Dt-rn,hn=Ee.length===1;let cn=!1;Ce=[Zt,rn,Zt+ht,rn,Zt+ht,rn+rr,Zt,rn+rr];for(let ir=0,Pi=Ge.length;ir<Pi;++ir)if(!hn&&Me<Le[ir]){const jn=Ge[ir];_s([Zt,rn,Zt+ht,rn+rr],[jn[0],jn[3],jn[4],jn[7]])&&(cn||(j.save(),cn=!0),j.beginPath(),j.moveTo(Ce[0],Ce[1]),j.lineTo(Ce[2],Ce[3]),j.lineTo(Ce[4],Ce[5]),j.lineTo(Ce[6],Ce[7]),j.moveTo(jn[6],jn[7]),j.lineTo(jn[4],jn[5]),j.lineTo(jn[2],jn[3]),j.lineTo(jn[0],jn[1]),j.clip())}Ge.push(Ce),Le.push(Me),this.drawTile(de,e,Zt,rn,ht,rr,Fe,hn),cn&&j.restore(),this.renderedTiles.unshift(de),this.updateUsedTiles(e.usedTiles,h,de)}}if(this.renderedResolution=y,this.extentChanged=!this.renderedExtent_||!rd(this.renderedExtent_,W),this.renderedExtent_=W,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&j.restore(),j.imageSmoothingEnabled=!0,this.renderComplete){const ce=(Me,Te)=>{const ie=Ut(h),V=Te.wantedTiles[ie],Z=V?Object.keys(V).length:0;this.updateCacheSize(Z),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(ce)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,r,i,s,a,o,l){let c;if(e instanceof jM){if(c=lb(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;const h=this.getRenderContext(t),g=Ut(this),m=t.layerStatesArray[t.layerIndex],y=m.opacity*(l?e.getAlpha(g,t.time):1),v=y!==h.globalAlpha;v&&(h.save(),h.globalAlpha=y),h.drawImage(c,o,o,c.width-2*o,c.height-2*o,r,i,s,a),v&&h.restore(),y!==m.opacity?t.animate=!0:l&&e.endTransition(g)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,r){const i=Ut(t);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const _x={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class UK extends vy{constructor(e){e=e||{};const t=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(_x.PRELOAD)}setPreload(e){this.set(_x.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(_x.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(_x.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Sh extends UK{constructor(e){super(e)}createRenderer(){return new zK(this,{cacheSize:this.getCacheSize()})}}function hb(n){return Array.isArray(n)?Math.min(...n):n}const kf=[0,0,0],Hc=5;class LF{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Tn(mU(this.resolutions_,(i,s)=>s-i),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!t)t=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Tn(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Rd(r)),Tn(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Tn(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:_A,Tn(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,s)=>{const a=new SA(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const o=this.getTileRangeForExtentAndZ(r,s);a.minX=Math.max(o.minX,a.minX),a.maxX=Math.min(o.maxX,a.maxX),a.minY=Math.max(o.minY,a.minY),a.maxY=Math.min(o.maxY,a.maxY)}return a}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,t,r){const i=this.getTileRangeForExtentAndZ(e,t);for(let s=i.minX,a=i.maxX;s<=a;++s)for(let o=i.minY,l=i.maxY;o<=l;++o)r([t,s,o])}forEachTileCoordParentTileRange(e,t,r,i){let s,a,o,l=null,c=e[0]-1;for(this.zoomFactor_===2?(a=e[1],o=e[2]):l=this.getTileCoordExtent(e,i);c>=this.minZoom;){if(a!==void 0&&o!==void 0?(a=Math.floor(a/2),o=Math.floor(o/2),s=Tf(a,a,o,o,r)):s=this.getTileRangeForExtentAndZ(l,c,r),t(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,a=e[2]*2;return Tf(s,s+1,a,a+1,t)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,r){if(t>this.maxZoom||t<this.minZoom)return null;const i=e[0],s=e[1],a=e[2];if(t===i)return Tf(s,a,s,a,r);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-i),c=Math.floor(s*l),h=Math.floor(a*l);if(t<i)return Tf(c,c,h,h,r);const g=Math.floor(l*(s+1))-1,m=Math.floor(l*(a+1))-1;return Tf(c,g,h,m,r)}const o=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t,r)}getTileRangeForExtentAndZ(e,t,r){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,kf);const i=kf[1],s=kf[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,kf);const a=kf[1],o=kf[2];return Tf(i,a,s,o,r)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=ws(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*r,t[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,t){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=ws(this.getTileSize(e[0]),this.tmpSize_),a=r[0]+e[1]*s[0]*i,o=r[1]-(e[2]+1)*s[1]*i,l=a+s[0]*i,c=o+s[1]*i;return Iu(a,o,l,c,t)}getTileCoordForCoordAndResolution(e,t,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r)}getTileCoordForXYAndResolution_(e,t,r,i,s){const a=this.getZForResolution(r),o=r/this.getResolution(a),l=this.getOrigin(a),c=ws(this.getTileSize(a),this.tmpSize_);let h=o*(e-l[0])/r/c[0],g=o*(l[1]-t)/r/c[1];return i?(h=lu(h,Hc)-1,g=lu(g,Hc)-1):(h=lx(h,Hc),g=lx(g,Hc)),U_(a,h,g,s)}getTileCoordForXYAndZ_(e,t,r,i,s){const a=this.getOrigin(r),o=this.getResolution(r),l=ws(this.getTileSize(r),this.tmpSize_);let c=(e-a[0])/o/l[0],h=(a[1]-t)/o/l[1];return i?(c=lu(c,Hc)-1,h=lu(h,Hc)-1):(c=lx(c,Hc),h=lx(h,Hc)),U_(r,c,h,s)}getTileCoordForCoordAndZ(e,t,r){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const r=uw(this.resolutions_,e,t||0);return cr(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return ID(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,r=new Array(t);for(let i=this.minZoom;i<t;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function OF(n){let e=n.getDefaultTileGrid();return e||(e=KK(n),n.setDefaultTileGrid(e)),e}function $K(n,e,t){const r=e[0],i=n.getTileCoordCenter(e),s=NA(t);if(!nd(s,i)){const a=gn(s),o=Math.ceil((s[0]-i[0])/a);return i[0]+=a*o,n.getTileCoordForCoordAndZ(i,r)}return e}function WK(n,e,t,r){r=r!==void 0?r:"top-left";const i=DF(n,e,t);return new LF({extent:n,origin:vU(n,r),resolutions:i,tileSize:t})}function HK(n){const e=n||{},t=e.extent||nr("EPSG:3857").getExtent(),r={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:DF(t,e.maxZoom,e.tileSize,e.maxResolution)};return new LF(r)}function DF(n,e,t,r){e=e!==void 0?e:CH,t=ws(t!==void 0?t:_A);const i=Qr(n),s=gn(n);r=r>0?r:Math.max(s/t[0],i/t[1]);const a=e+1,o=new Array(a);for(let l=0;l<a;++l)o[l]=r/Math.pow(2,l);return o}function KK(n,e,t,r){const i=NA(n);return WK(i,e,t,r)}function NA(n){n=nr(n);let e=n.getExtent();if(!e){const t=180*I0.degrees/n.getMetersPerUnit();e=Iu(-t,-t,t,t)}return e}function LA(n,e){const t=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&t.push(i+"="+encodeURIComponent(e[i]))});const r=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+r}const XK=/\{z\}/g,qK=/\{x\}/g,YK=/\{y\}/g,ZK=/\{-y\}/g;function JK(n,e,t,r,i){return n.replace(XK,e.toString()).replace(qK,t.toString()).replace(YK,r.toString()).replace(ZK,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function QK(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const r=t[1].charCodeAt(0),i=t[2].charCodeAt(0);let s;for(s=r;s<=i;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const r=parseInt(t[2],10);for(let i=parseInt(t[1],10);i<=r;i++)e.push(n.replace(t[0],i.toString()));return e}return e.push(n),e}function eX(n,e){return(function(t,r,i){if(!t)return;let s;const a=t[0];if(e){const o=e.getFullTileRange(a);o&&(s=o.getHeight()-1)}return JK(n,a,t[1],t[2],s)})}function tX(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=eX(n[i],e);return nX(r)}function nX(n){return n.length===1?n[0]:(function(e,t,r){if(!e)return;const i=bF(e),s=_u(i,n.length);return n[s](e,t,r)})}class rX extends uA{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&ws(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||Ut(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,r,i,s,a){return $t()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:OF(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,r){const i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(t),a=ws(i.getTileSize(e),this.tmpSize);return s==1?a:xW(a,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const r=t!==void 0?t:this.getProjection(),i=t!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=$K(i,e,r)),rK(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class iX extends ml{constructor(e,t){super(e),this.tile=t}}const DS={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class OA extends rX{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===OA.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,r=Ut(t),i=t.getState();let s;i==Vt.LOADING?(this.tileLoadingKeys_[r]=!0,s=DS.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],s=i==Vt.ERROR?DS.TILELOADERROR:i==Vt.LOADED?DS.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new iX(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=QK(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(tX(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,r){}}class FF extends OA{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:jF,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:vF,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Xh(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Xh(t,e)))return this.tileGrid;const r=Ut(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=OF(e)),this.tileGridForProjection[r]}createTile_(e,t,r,i,s,a){const o=[e,t,r],l=this.getTileCoordForTileUrlFunction(o,s),c=l?this.tileUrlFunction(l,i,s):void 0,h=new this.tileClass(o,c!==void 0?Vt.IDLE:Vt.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=a,h.addEventListener(Jt.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,t,r,i,s,a){const o=this.getProjection();if(!o||!s||Xh(o,s))return this.getTileInternal(e,t,r,i,o||s);const l=[e,t,r],c=this.getKey(),h=this.getTileGridForProjection(o),g=this.getTileGridForProjection(s),m=this.getTileCoordForTileUrlFunction(l,s),y=new TF(o,h,s,g,l,m,this.getTilePixelRatio(i),this.getGutter(),(v,_,E,T)=>this.getTileInternal(v,_,E,T,o,a),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return y.key=c,y}getTileInternal(e,t,r,i,s,a){const o=this.getKey(),l=Zx(this,o,e,t,r);if(a&&a.containsKey(l))return a.get(l);const c=this.createTile_(e,t,r,i,s,o);return a?.set(l,c),c}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const r=nr(e);if(r){const i=Ut(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=t)}}}function jF(n,e){if(ua){const t=n.getCrossOrigin();let r="same-origin",i="same-origin";t==="anonymous"||t===""?(r="cors",i="omit"):t==="use-credentials"&&(r="cors",i="include"),fetch(e,{mode:r,credentials:i}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const a=n.getImage();a.width=s.width,a.height=s.height,a.getContext("2d").drawImage(s,0,0),s.close?.(),a.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class zf extends FF{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:HK({extent:NA(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const sX="modulepreload",aX=function(n){return"/detectorapp-nl/"+n},WM={},xt=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let l=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");i=l(t.map(c=>{if(c=aX(c),c in WM)return;WM[c]=!0;const h=c.endsWith(".css"),g=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${g}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":sX,h||(m.as="script"),m.crossOrigin="",m.href=c,o&&m.setAttribute("nonce",o),document.head.appendChild(m),h)return new Promise((y,v)=>{m.addEventListener("load",y),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};class oX extends jD{constructor(e,t,r,i,s,a,o){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let c=t.getExtent();c&&t.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);const h=c?Kl(r,c):r,g=cl(h),m=z_(e,t,g,i),y=SF,v=new EF(e,t,h,l,m*y,i),_=v.calculateSourceExtent(),E=rg(_)?null:a(_,m,s),T=E?Tt.IDLE:Tt.EMPTY,b=E?E.getPixelRatio():1;super(r,i,b,T),this.targetProj_=t,this.maxSourceExtent_=l,this.triangulation_=v,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=E,this.sourcePixelRatio_=b,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==Tt.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==Tt.LOADED){const t=gn(this.targetExtent_)/this.targetResolution_,r=Qr(this.targetExtent_)/this.targetResolution_;this.canvas_=wF(t,r,this.sourcePixelRatio_,hb(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==Tt.IDLE){this.state=Tt.LOADING,this.changed();const e=this.sourceImage_.getState();e==Tt.LOADED||e==Tt.ERROR?this.reproject_():(this.sourceListenerKey_=fn(this.sourceImage_,Jt.CHANGE,t=>{const r=this.sourceImage_.getState();(r==Tt.LOADED||r==Tt.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){ar(this.sourceListenerKey_),this.sourceListenerKey_=null}}const du=4,FS={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class lX extends ml{constructor(e,t){super(e),this.image=t}}class cX extends uA{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const r=uw(t,e,0);e=t[r]}return e}getImage(e,t,r,i){const s=this.getProjection();if(!s||!i||Xh(s,i))return s&&(i=s),this.getImageInternal(e,t,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Xh(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==t&&rd(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new oX(s,i,e,t,r,(a,o,l)=>this.getImageInternal(a,o,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,r,i){if(this.loader){const s=VF(e,t,r,1),a=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&ou(this.wantedExtent_,s)||ou(this.image.getExtent(),s))&&(this.wantedResolution_&&hb(this.wantedResolution_)===a||hb(this.image.getResolution())===a)))return this.image;this.wantedProjection_=i,this.wantedExtent_=s,this.wantedResolution_=a,this.image=new jD(s,a,r,this.loader),this.image.addEventListener(Jt.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let r;switch(t.getState()){case Tt.LOADING:this.loading=!0,r=FS.IMAGELOADSTART;break;case Tt.LOADED:this.loading=!1,r=FS.IMAGELOADEND;break;case Tt.ERROR:this.loading=!1,r=FS.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new lX(r,t))}}function uX(n,e){n.getImage().src=e}function VF(n,e,t,r){const i=e/t,s=cl(n),a=lu(gn(n)/i,du),o=lu(Qr(n)/i,du),l=lu((r-1)*a/2,du),c=a+2*l,h=lu((r-1)*o/2,du),g=o+2*h;return b_(s,i,0,[c,g])}function hX(n,e,t,r,i,s){const a=i.getCode().split(/:(?=\d+$)/).pop(),o=t/r,l=[R_(gn(e)/o,du),R_(Qr(e)/o,du)];s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=a,s.IMAGESR=a,s.DPI=Math.round(s.DPI?s.DPI*r:90*r);const c=n.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return LA(c,s)}function dX(n){const e=n.load?n.load:BD,t=nr(n.projection||"EPSG:3857"),r=n.ratio??1.5,i=n.crossOrigin??null;return function(s,a,o){o=n.hidpi?o:1;const l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(l,n.params),s=VF(s,a,o,r);const c=hX(n.url,s,a,o,t,l),h=new Image;return h.crossOrigin=i,e(h,c).then(g=>{const m=gn(s)/g.width*o;return{image:g,extent:s,resolution:m,pixelRatio:o}})}}class fX extends cX{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:uX,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,t,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=dX({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,a)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,a),BD(s))})),super.getImageInternal(e,t,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const db="1.3.0";function gX(n,e,t,r,i){i.WIDTH=t[0],i.HEIGHT=t[1];const s=r.getAxisOrientation(),a=dD(i.VERSION,"1.3")>=0;i[a?"CRS":"SRS"]=r.getCode();const o=a&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=o.join(","),LA(n,i)}function mX(n,e,t,r,i,s,a){s=Object.assign({REQUEST:"GetMap"},s);const o=e/t,l=[R_(gn(n)/o,du),R_(Qr(n)/o,du)];if(t!=1)switch(a){case"geoserver":const h=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+h:s.FORMAT_OPTIONS="dpi:"+h;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return gX(i,n,l,r,s)}function HM(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:db,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const pX='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class yX extends zf{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[pX];const r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",i=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,a)=>{const o=s.getImage();!ua&&o instanceof HTMLImageElement&&(o.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||jF)(s,a)},transition:e.transition,url:i,wrapX:e.wrapX,zDirection:e.zDirection})}}const H_=1/0;class xX{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,ng(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,r=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){Tn(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=H_?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,r=this.priorities_,i=t.length,s=t[e],a=r[e],o=e;for(;e<i>>1;){const l=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),h=c<i&&r[c]<r[l]?c:l;t[e]=t[h],r[e]=r[h],e=h}t[e]=s,r[e]=a,this.siftDown_(o,e)}siftDown_(e,t){const r=this.elements_,i=this.priorities_,s=r[t],a=i[t];for(;t>e;){const o=this.getParentIndex_(t);if(i[o]>a)r[t]=r[o],i[t]=i[o],t=o;else break}r[t]=s,i[t]=a}reprioritize(){const e=this.priorityFunction_,t=this.elements_,r=this.priorities_;let i=0;const s=t.length;let a,o,l;for(o=0;o<s;++o)a=t[o],l=e(a),l==H_?delete this.queuedElements_[this.keyFunction_(a)]:(r[i]=l,t[i++]=a);t.length=i,r.length=i,this.heapify_()}}class _X extends xX{constructor(e,t){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Jt.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,r=t.getState();if(r===Vt.LOADED||r===Vt.ERROR||r===Vt.EMPTY){r!==Vt.ERROR&&t.removeEventListener(Jt.CHANGE,this.boundHandleTileChange_);const i=t.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let r=0;for(;this.tilesLoading_<e&&r<t&&this.getCount()>0;){const i=this.dequeue()[0],s=i.getKey();i.getState()===Vt.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++r,i.load())}}}function vX(n,e,t,r,i){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return H_;const s=n.viewState.center,a=r[0]-s[0],o=r[1]-s[1];return 65536*Math.log(i)+Math.sqrt(a*a+o*o)/i}class wX extends FF{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=zs(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,r,i){const s=nr(r),a=this.getProjection()||s;let o=this.getTileGrid();o||(o=this.getTileGridForProjection(a));const l=gy(e,s,a),c=z_(a,s,e,t),h=o.getZForResolution(c,this.zDirection),g=o.getResolution(h),m=o.getTileCoordForCoordAndZ(l,h);if(o.getResolutions().length<=m[0])return;let y=o.getTileCoordExtent(m,this.tmpExtent_);const v=this.gutter_;v!==0&&(y=k0(y,g*v,y));const _={QUERY_LAYERS:this.params_.LAYERS};Object.assign(_,HM(this.params_,"GetFeatureInfo"),i);const E=Math.floor((l[0]-y[0])/g),T=Math.floor((y[3]-l[1])/g);return _[this.v13_?"I":"X"]=E,_[this.v13_?"J":"Y"]=T,this.getRequestUrl_(m,y,1,a||s,_)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const r={SERVICE:"WMS",VERSION:db,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;r.LAYER=i}if(e!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;r.SCALE=e*i/s}return Object.assign(r,t),LA(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,r,i,s){const a=this.urls;if(!a)return;let o;if(a.length==1)o=a[0];else{const l=_u(bF(e),a.length);o=a[l]}return mX(t,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,o,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const r in this.params_)t[e++]=r+"-"+this.params_[r];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||db;this.v13_=dD(e,"1.3")>=0}tileUrlFunction(e,t,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=i.getResolution(e[0]);let a=i.getTileCoordExtent(e,this.tmpExtent_);const o=this.gutter_;o!==0&&(a=k0(a,s*o,a));const l=Object.assign({},HM(this.params_,"GetMap"));return this.getRequestUrl_(e,a,t,r,l)}}class Uf extends ml{constructor(e,t,r){super(e),this.map=t,this.frameState=r!==void 0?r:null}}class Jc extends Uf{constructor(e,t,r,i,s,a){super(e,t,s),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=a}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Lr={SINGLECLICK:"singleclick",CLICK:Jt.CLICK,DBLCLICK:Jt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},fb={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class EX extends cy{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=fn(r,fb.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=fn(r,fb.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Jt.TOUCHMOVE,this.boundHandleTouchMove_,OD?{passive:!1}:!1)}emulateClick_(e){let t=new Jc(Lr.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Jc(Lr.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new Jc(Lr.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const t=e,r=t.pointerId;if(t.type==Lr.POINTERUP||t.type==Lr.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==t.target){delete this.trackedTouches_[i];break}}else(t.type==Lr.POINTERDOWN||t.type==Lr.POINTERMOVE)&&(this.trackedTouches_[r]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Jc(Lr.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(ar),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Jc(Lr.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(fn(r,Lr.POINTERMOVE,this.handlePointerMove_,this),fn(r,Lr.POINTERUP,this.handlePointerUp_,this),fn(this.element_,Lr.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(fn(this.element_.getRootNode(),Lr.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Jc(Lr.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Jc(Lr.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(ar(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Jt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(ar(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(ar),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Qc={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},ts={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Iw extends pl{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,r=this.listenerKeys.length;t<r;++t)ar(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==fp&&this.listenerKeys.push(fn(e,Qc.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class SX extends Iw{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",a=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=a):this.collapseLabel_=s;const o=e.label!==void 0?e.label:"i";typeof o=="string"?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=i):this.label_=o;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(Jt.CLICK,this.handleClick_.bind(this),!1);const c=t+" "+py+" "+aA+(this.collapsed_&&this.collapsible_?" "+rM:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=c,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),r=new Set(t.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(i=>nD(()=>i))),r=t.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!hc(t,this.renderedAttributions_)){R$(this.ulElement_);for(let i=0,s=t.length;i<s;++i){const a=document.createElement("li");a.innerHTML=t[i],this.ulElement_.appendChild(a)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(rM),this.collapsed_?tM(this.collapseLabel_,this.label_):tM(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class TX extends Iw{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const s=e.tipLabel?e.tipLabel:"Reset rotation",a=document.createElement("button");a.className=t+"-reset",a.setAttribute("type","button"),a.title=s,a.appendChild(this.label_),a.addEventListener(Jt.CLICK,this.handleClick_.bind(this),!1);const o=t+" "+py+" "+aA,l=this.element;l.className=o,l.appendChild(a),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(hx)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const r=t.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:ig}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const r=t.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const s=this.element.classList.contains(hx);!s&&r===0?this.element.classList.add(hx):s&&r!==0&&this.element.classList.remove(hx)}this.label_.style.transform=i}this.rotation_=r}}class bX extends Iw{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",a=e.zoomInLabel!==void 0?e.zoomInLabel:"+",o=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",c=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(Jt.CLICK,this.handleClick_.bind(this,r),!1);const g=document.createElement("button");g.className=s,g.setAttribute("type","button"),g.title=c,g.appendChild(typeof o=="string"?document.createTextNode(o):o),g.addEventListener(Jt.CLICK,this.handleClick_.bind(this,-r),!1);const m=t+" "+py+" "+aA,y=this.element;y.className=m,y.appendChild(h),y.appendChild(g),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const s=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:ig})):r.setZoom(s)}}}function RX(n){n=n||{};const e=new Ma;return(n.zoom===void 0||n.zoom)&&e.push(new bX(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new TX(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new SX(n.attributionOptions)),e}class AX{constructor(e,t,r){this.decay_=e,this.minVelocity_=t,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let r=t-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[t+2]-this.points_[r+2];if(i<1e3/60)return!1;const s=this.points_[t]-this.points_[r],a=this.points_[t+1]-this.points_[r+1];return this.angle_=Math.atan2(a,s),this.initialVelocity_=Math.sqrt(s*s+a*a)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const KM={ACTIVE:"active"};class wy extends pl{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(KM.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(KM.ACTIVE,e)}setMap(e){this.map_=e}}function kX(n,e,t){const r=n.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:bH,center:n.getConstrainedCenter(i)})}}function DA(n,e,t,r){const i=n.getZoom();if(i===void 0)return;const s=n.getConstrainedZoom(i+e),a=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:a,anchor:t,duration:r!==void 0?r:250,easing:ig})}class IX extends wy{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Lr.DBLCLICK){const r=e.originalEvent,i=e.map,s=e.coordinate,a=r.shiftKey?-this.delta_:this.delta_,o=i.getView();DA(o,a,s,this.duration_),r.preventDefault(),t=!0}return!t}}function gb(n){const e=arguments;return function(t){let r=!0;for(let i=0,s=e.length;i<s&&(r=r&&e[i](t),!!r);++i);return r}}const CX=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},PX=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),r=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(r):e.contains(r)},BF=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?PX(n):!0},MX=dp,GF=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(T$&&ND&&e.ctrlKey)},zF=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},NX=function(n){const e=n.originalEvent;return ND?e.metaKey:e.ctrlKey},LX=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},UF=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},jS=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},OX=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class Ey extends wy{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Lr.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Lr.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==Lr.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==Lr.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function FA(n){const e=n.length;let t=0,r=0;for(let i=0;i<e;i++)t+=n[i].clientX,r+=n[i].clientY;return{clientX:t/e,clientY:r/e}}class DX extends Ey{constructor(e){super({stopDown:hw}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:gb(zF,OX);this.condition_=e.onFocusOnly?gb(BF,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const r=this.targetPointers,i=t.getEventPixel(FA(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=e.map.getView();RU(s,o.getResolution()),UR(s,o.getRotation()),o.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,r=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),a=r.getCenterInternal(),o=t.getPixelFromCoordinateInternal(a),l=t.getCoordinateFromPixelInternal([o[0]-i*Math.cos(s),o[1]-i*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:ig})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class FX extends Ey{constructor(e){e=e||{},super({stopDown:hw}),this.condition_=e.condition?e.condition:CX,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!jS(e))return;const t=e.map,r=t.getView();if(r.getConstraints().rotation===xA)return;const i=t.getSize(),s=e.pixel,a=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){const o=a-this.lastAngle_;r.adjustRotationInternal(-o)}this.lastAngle_=a}handleUpEvent(e){return jS(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return jS(e)&&GF(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class jX extends ly{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],t[0])+r,i.top=Math.min(e[1],t[1])+r,i.width=Math.abs(t[0]-e[0])+r,i.height=Math.abs(t[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Ga([i])}getGeometry(){return this.geometry_}}const If={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class om extends ml{constructor(e,t,r){super(e),this.coordinate=t,this.mapBrowserEvent=r}}class VX extends Ey{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new jX(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??GF,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,r){const i=r[0]-t[0],s=r[1]-t[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new om(If.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new om(t?If.BOXEND:If.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new om(If.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new om(If.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new om(If.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class BX extends VX{constructor(e){e=e||{};const t=e.condition?e.condition:LX;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=r.rotatedExtentForGeometry(i),a=r.getResolutionForExtentInternal(s),o=r.getResolution()/a;i=i.clone(),i.scale(o*o)}r.fitInternal(i,{duration:this.duration_,easing:ig})}}const _h={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class GX extends wy{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return zF(t)&&UF(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Jt.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==_h.DOWN||i==_h.LEFT||i==_h.RIGHT||i==_h.UP)){const a=e.map.getView(),o=a.getResolution()*this.pixelDelta_;let l=0,c=0;i==_h.DOWN?c=-o:i==_h.LEFT?l=-o:i==_h.RIGHT?l=o:c=o;const h=[l,c];UR(h,a.getRotation()),kX(a,h,this.duration_),r.preventDefault(),t=!0}}return!t}}class zX extends wy{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!NX(t)&&UF(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Jt.KEYDOWN||e.type==Jt.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const s=e.map,a=i==="+"?this.delta_:-this.delta_,o=s.getView();DA(o,a,void 0,this.duration_),r.preventDefault(),t=!0}}return!t}}const UX=40,$X=300;class WX extends wy{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:MX;this.condition_=e.onFocusOnly?gb(BF,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Jt.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=UX;break;case WheelEvent.DOM_DELTA_PAGE:s*=$X;break}if(s===0)return!1;this.lastDelta_=s;const a=Date.now();this.startTime_===void 0&&(this.startTime_=a),(!this.mode_||a-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const o=r.getView();if(this.mode_==="trackpad"&&!(o.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=a,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(a-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let r=-cr(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),DA(t,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class HX extends Ey{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=hw),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const r=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const a=e.map,o=a.getView();o.getConstraints().rotation!==xA&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(FA(this.targetPointers))),this.rotating_&&(a.render(),o.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class KX extends Ey{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=hw),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const r=this.targetPointers[0],i=this.targetPointers[1],s=r.clientX-i.clientX,a=r.clientY-i.clientY,o=Math.sqrt(s*s+a*a);this.lastDistance_!==void 0&&(t=this.lastDistance_/o),this.lastDistance_=o;const l=e.map,c=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(FA(this.targetPointers))),l.render(),c.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function XX(n){n=n||{};const e=new Ma,t=new AX(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new FX),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new IX({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new DX({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new HX),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new KX({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new GX),e.push(new zX({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new WX({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new BX({duration:n.zoomDuration})),e}class qX extends ly{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){$t()}calculateMatrices2D(e){const t=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;Va(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),mp(i,r)}forEachFeatureAtCoordinate(e,t,r,i,s,a,o,l){let c;const h=t.viewState;function g(N,D,W,I){return s.call(a,D,N?W:null,I)}const m=h.projection,y=fD(e.slice(),m),v=[[0,0]];if(m.canWrapX()&&i){const N=m.getExtent(),D=gn(N);v.push([-D,0],[D,0])}const _=t.layerStatesArray,E=_.length,T=[],b=[];for(let N=0;N<v.length;N++)for(let D=E-1;D>=0;--D){const W=_[D],I=W.layer;if(I.hasRenderer()&&vA(W,h)&&o.call(l,I)){const A=I.getRenderer(),M=I.getSource();if(A&&M){const O=M.getWrapX()?y:e,L=g.bind(null,W.managed);b[0]=O[0]+v[N][0],b[1]=O[1]+v[N][1],c=A.forEachFeatureAtCoordinate(b,t,r,L,T)}if(c)return c}}if(T.length===0)return;const R=1/T.length;return T.forEach((N,D)=>N.distanceSq+=D*R),T.sort((N,D)=>N.distanceSq-D.distanceSq),T.some(N=>c=N.callback(N.feature,N.layer,N.geometry)),c}hasFeatureAtCoordinate(e,t,r,i,s,a){return this.forEachFeatureAtCoordinate(e,t,r,i,dp,this,s,a)!==void 0}getMap(){return this.map_}renderFrame(e){$t()}scheduleExpireIconCache(e){Na.canExpireCache()&&e.postRenderFunctions.push(YX)}}function YX(n,e){Na.expire()}class ZX extends qX{constructor(e){super(e),this.fontChangeListenerKey_=fn(Vf,A0.PROPERTYCHANGE,e.redrawText,e),this.element_=ua?DD():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=py+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const r=this.getMap();if(r.hasListener(e)){const i=new Om(e,void 0,t);r.dispatchEvent(i)}}disposeInternal(){ar(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Si.PRECOMPOSE,e);const t=e.layerStatesArray.sort((c,h)=>c.zIndex-h.zIndex);t.some(c=>c.layer instanceof Rw&&c.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let a=null;for(let c=0,h=t.length;c<h;++c){const g=t[c];e.layerIndex=c;const m=g.layer,y=m.getSourceState();if(!vA(g,i)||y!="ready"&&y!="undefined"){m.unrender();continue}const v=m.render(e,a);v&&(v!==a&&(this.children_.push(v),a=v),s.push(g))}this.declutter(e,s),A$(this.element_,this.children_);const l=this.getMap().getTargetElement();if(uu(l)){const c=l.getContext("2d");for(const h of this.children_){const g=h.firstElementChild||h,m=h.style.backgroundColor;if(m&&(!uu(g)||g.width>0)&&(c.fillStyle=m,c.fillRect(0,0,l.width,l.height)),uu(g)&&g.width>0){const y=h.style.opacity||g.style.opacity;c.globalAlpha=y===""?1:Number(y);const v=g.style.transform;if(v)c.setTransform(...JT(v));else{const _=parseFloat(g.style.width)/g.width,E=parseFloat(g.style.height)/g.height;c.setTransform(_,0,0,E,0,0)}c.drawImage(g,0,0)}}c.globalAlpha=1,c.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Si.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let r=t.length-1;r>=0;--r){const i=t[r],s=i.layer;s.getDeclutter()&&s.renderDeclutter(e,i)}t.forEach(r=>r.layer.renderDeferred(e))}}}function $F(n){if(n instanceof vy){n.setMapInternal(null);return}n instanceof Aw&&n.getLayers().forEach($F)}function WF(n,e){if(n instanceof vy){n.setMapInternal(e);return}if(n instanceof Aw){const t=n.getLayers().getArray();for(let r=0,i=t.length;r<i;++r)WF(t[r],e)}}let JX=class extends pl{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=QX(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:b$,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=fi(),this.pixelToCoordinateTransform_=fi(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,ua||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,ua||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(ua?new Ma:RX()),this.interactions=t.interactions||(ua?new Ma:XX({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new _X(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(ts.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(ts.VIEW,this.handleViewChanged_),this.addChangeListener(ts.SIZE,this.handleSizeChanged_),this.addChangeListener(ts.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const r=this;e.view&&!(e.view instanceof qo)&&e.view.then(function(i){r.setView(new qo(i))}),this.controls.addEventListener(Ls.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(Ls.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(Ls.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(Ls.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(Ls.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(Ls.REMOVE,i=>{const s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){WF(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const s=r.hitTolerance!==void 0?r.hitTolerance:0,a=r.layerFilter!==void 0?r.layerFilter:dp,o=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,o,t,null,a,null)}getFeaturesAtPixel(e,t){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},t),r}getAllLayers(){const e=[];function t(r){r.forEach(function(i){i instanceof Aw?t(i.getLayers()):e.push(i)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const i=t.layerFilter!==void 0?t.layerFilter:dp,s=t.hitTolerance!==void 0?t.hitTolerance:0,a=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,a,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=r.width/i[0],a=r.height/i[1],o="changedTouches"in e?e.changedTouches[0]:e;return[(o.clientX-r.left)/s,(o.clientY-r.top)/a]}getTarget(){return this.get(ts.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return ZT(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?Fr(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(ts.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Ma){t.setLayers(e);return}const r=t.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,r=e.length;t<r;++t){const i=e[t];if(!i.visible)continue;const s=i.layer.getRenderer();if(s&&!s.ready)return!0;const a=i.layer.getSource();if(a&&a.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Fl(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?Fr(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(ts.SIZE)}getView(){return this.get(ts.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,r,i){return vX(this.frameState_,e,t,r,i)}handleBrowserEvent(e,t){t=t||e.type;const r=new Jc(t,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,r=t.type;if(r===fb.POINTERDOWN||r===Jt.WHEEL||r===Jt.KEYDOWN){const i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,a=t.target,o=s instanceof ShadowRoot?s.host===a?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(a)||!o.contains(a))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){const a=i[s];if(a.getMap()!==this||!a.getActive()||!this.getTargetElement())continue;if(!a.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,s=i;if(e){const a=e.viewHints;if(a[Zr.ANIMATING]||a[Zr.INTERACTING]){const o=Date.now()-e.time>8;i=o?0:8,s=o?0:2}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Si.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Si.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Uf(Qc.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Uf(Qc.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,s=r.length;i<s;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,i=this.targetChangeHandlerKeys_.length;r<i;++r)ar(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Jt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Jt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!uu(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(uu(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new ZX(this)),!uu(t)){this.mapBrowserEventHandler_=new EX(this,this.moveTolerance_);for(const i in Lr)this.mapBrowserEventHandler_.addEventListener(Lr[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Jt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Jt.WHEEL,this.boundHandleBrowserEvent_,OD?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{const i=t.getRootNode();r=i instanceof ShadowRoot?i.host:t}if(this.targetChangeHandlerKeys_=[fn(r,Jt.KEYDOWN,this.handleBrowserEvent,this),fn(r,Jt.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const i=t.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(ar(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(ar(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=fn(e,A0.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=fn(e,Jt.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(ar),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new tu("addlayer",e)),this.layerGroupPropertyListenerKeys_=[fn(e,A0.PROPERTYCHANGE,this.render,this),fn(e,Jt.CHANGE,this.render,this),fn(e,"addlayer",this.handleLayerAdd_,this),fn(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,r=e.length;t<r;++t){const i=e[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){$F(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),r=this.getView(),i=this.frameState_;let s=null;if(t!==void 0&&mM(t)&&r&&r.isDef()){const a=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=r.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:b_(o.center,o.resolution,o.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:o,viewHints:a,wantedTiles:{},mapId:Ut(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const l=isNaN(o.nextRotation)?o.rotation:o.nextRotation;s.nextExtent=b_(o.nextCenter,o.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!rg(this.previousExtent_)&&!rd(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Uf(Qc.MOVESTART,this,i)),this.previousExtent_=hy(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Zr.ANIMATING]&&!s.viewHints[Zr.INTERACTING]&&!rd(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Uf(Qc.MOVEEND,this,s)),iD(s.extent,this.previousExtent_))),this.dispatchEvent(new Uf(Qc.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Qc.LOADSTART)||this.hasListener(Qc.LOADEND)||this.hasListener(Si.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new tu("removelayer",t)),this.set(ts.LAYERGROUP,e)}setSize(e){this.set(ts.SIZE,e)}setTarget(e){this.set(ts.TARGET,e)}setView(e){if(!e||e instanceof qo){this.set(ts.VIEW,e);return}this.set(ts.VIEW,new qo);const t=this;e.then(function(r){t.setView(new qo(r))})}updateSize(){const e=this.getTargetElement();let t;if(e){let i,s;if(uu(e))i=e.width,s=e.height;else{const a=getComputedStyle(e);i=e.offsetWidth-parseFloat(a.borderLeftWidth)-parseFloat(a.paddingLeft)-parseFloat(a.paddingRight)-parseFloat(a.borderRightWidth),s=e.offsetHeight-parseFloat(a.borderTopWidth)-parseFloat(a.paddingTop)-parseFloat(a.paddingBottom)-parseFloat(a.borderBottomWidth)}!isNaN(i)&&!isNaN(s)&&(t=[Math.max(0,i),Math.max(0,s)],!mM(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&mD("No map visible because the map container's width or height are 0."))}const r=this.getSize();t&&(!r||!hc(t,r))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function QX(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},r=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Aw({layers:n.layers});t[ts.LAYERGROUP]=r,t[ts.TARGET]=n.target,t[ts.VIEW]=n.view instanceof qo?n.view:new qo;let i;n.controls!==void 0&&(Array.isArray(n.controls)?i=new Ma(n.controls.slice()):(Tn(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Ma(n.interactions.slice()):(Tn(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let a;return n.overlays!==void 0?Array.isArray(n.overlays)?a=new Ma(n.overlays.slice()):(Tn(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),a=n.overlays):a=new Ma,{controls:i,interactions:s,keyboardEventTarget:e,overlays:a,values:t}}const VS="units",eq=[1,2,5],lm=25.4/.28;class tq extends Iw{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const r=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+py,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(VS,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(VS)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(VS,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,r=e.projection,i=this.getUnits(),s=i=="degrees"?"degrees":"m";let a=P_(r,e.resolution,t,s);const o=this.minWidth_*(this.dpi_||lm)/lm,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||lm)/lm:void 0;let c=o*a,h="";if(i=="degrees"){const R=I0.degrees;c*=R,c<R/60?(h="",a*=3600):c<R?(h="",a*=60):h=""}else if(i=="imperial")c<.9144?(h="in",a/=.0254):c<1609.344?(h="ft",a/=.3048):(h="mi",a/=1609.344);else if(i=="nautical")a/=1852,h="NM";else if(i=="metric")c<1e-6?(h="nm",a*=1e9):c<.001?(h="m",a*=1e6):c<1?(h="mm",a*=1e3):c<1e3?h="m":(h="km",a/=1e3);else if(i=="us")c<.9144?(h="in",a*=39.37):c<1609.344?(h="ft",a/=.30480061):(h="mi",a/=1609.3472);else throw new Error("Invalid units");let g=3*Math.floor(Math.log(o*a)/Math.log(10)),m,y,v,_=0,E,T;for(;;){v=Math.floor(g/3);const R=Math.pow(10,v);if(m=eq[(g%3+3)%3]*R,y=Math.round(m/a),isNaN(y)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&y>=l){m=_,y=E,v=T;break}else if(y>=o)break;_=m,E=y,T=v,++g}const b=this.scaleBar_?this.createScaleBar(y,m,h):m.toFixed(v<0?-v:0)+" "+h;this.renderedHTML_!=b&&(this.innerElement_.innerHTML=b,this.renderedHTML_=b),this.renderedWidth_!=y&&(this.innerElement_.style.width=y+"px",this.renderedWidth_=y),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,r){const i=this.getScaleForResolution(),s=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),a=this.scaleBarSteps_,o=e/a,l=[this.createMarker("absolute")];for(let h=0;h<a;++h){const g=h%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${g}" style="width: ${o}px;"></div>`+this.createMarker("relative")+(h%2===0||a===2?this.createStepText(h,e,!1,t,r):"")+"</div>")}return l.push(this.createStepText(a,e,!0,t,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,r,i,s){const o=(e===0?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:t/this.scaleBarSteps_*-1,c=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${c}px;left: ${r?t+"px":"unset"};">`+o+"</div>"}getScaleForResolution(){const e=P_(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||lm,r=1e3/25.4;return e*r*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const nq={},XM=n=>{let e;const t=new Set,r=(h,g)=>{const m=typeof h=="function"?h(e):h;if(!Object.is(m,e)){const y=e;e=g??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(v=>v(e,y))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(nq?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},c=e=n(r,i,l);return l},rq=n=>n?XM(n):XM;var BS={exports:{}},GS={},zS={exports:{}},US={};var qM;function iq(){if(qM)return US;qM=1;var n=oy();function e(g,m){return g===m&&(g!==0||1/g===1/m)||g!==g&&m!==m}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue;function o(g,m){var y=m(),v=r({inst:{value:y,getSnapshot:m}}),_=v[0].inst,E=v[1];return s(function(){_.value=y,_.getSnapshot=m,l(_)&&E({inst:_})},[g,y,m]),i(function(){return l(_)&&E({inst:_}),g(function(){l(_)&&E({inst:_})})},[g]),a(y),y}function l(g){var m=g.getSnapshot;g=g.value;try{var y=m();return!t(g,y)}catch{return!0}}function c(g,m){return m()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return US.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:h,US}var YM;function sq(){return YM||(YM=1,zS.exports=iq()),zS.exports}var ZM;function aq(){if(ZM)return GS;ZM=1;var n=oy(),e=sq();function t(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=n.useRef,a=n.useEffect,o=n.useMemo,l=n.useDebugValue;return GS.useSyncExternalStoreWithSelector=function(c,h,g,m,y){var v=s(null);if(v.current===null){var _={hasValue:!1,value:null};v.current=_}else _=v.current;v=o(function(){function T(W){if(!b){if(b=!0,R=W,W=m(W),y!==void 0&&_.hasValue){var I=_.value;if(y(I,W))return N=I}return N=W}if(I=N,r(R,W))return I;var A=m(W);return y!==void 0&&y(I,A)?(R=W,I):(R=W,N=A)}var b=!1,R,N,D=g===void 0?null:g;return[function(){return T(h())},D===null?void 0:function(){return T(D())}]},[h,g,m,y]);var E=i(c,v[0],v[1]);return a(function(){_.hasValue=!0,_.value=E},[E]),l(E),E},GS}var JM;function oq(){return JM||(JM=1,BS.exports=aq()),BS.exports}var lq=oq();const cq=BR(lq),HF={},{useDebugValue:uq}=hU,{useSyncExternalStoreWithSelector:hq}=cq;let QM=!1;const dq=n=>n;function fq(n,e=dq,t){(HF?"production":void 0)!=="production"&&t&&!QM&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),QM=!0);const r=hq(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return uq(r),r}const gq=n=>{(HF?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?rq(n):n,t=(r,i)=>fq(e,r,i);return Object.assign(t,e),t},bs=n=>gq;var KF=Symbol.for("immer-nothing"),eN=Symbol.for("immer-draftable"),fa=Symbol.for("immer-state");function lo(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var bp=Object.getPrototypeOf;function N0(n){return!!n&&!!n[fa]}function od(n){return n?XF(n)||Array.isArray(n)||!!n[eN]||!!n.constructor?.[eN]||Sy(n)||Pw(n):!1}var mq=Object.prototype.constructor.toString(),tN=new WeakMap;function XF(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let r=tN.get(t);return r===void 0&&(r=Function.toString.call(t),tN.set(t,r)),r===mq}function K_(n,e,t=!0){Cw(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(i=>{e(i,n[i],n)}):n.forEach((r,i)=>e(i,r,n))}function Cw(n){const e=n[fa];return e?e.type_:Array.isArray(n)?1:Sy(n)?2:Pw(n)?3:0}function mb(n,e){return Cw(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function qF(n,e,t){const r=Cw(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function pq(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function Sy(n){return n instanceof Map}function Pw(n){return n instanceof Set}function Th(n){return n.copy_||n.base_}function pb(n,e){if(Sy(n))return new Map(n);if(Pw(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=XF(n);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[fa];let i=Reflect.ownKeys(r);for(let s=0;s<i.length;s++){const a=i[s],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[a]})}return Object.create(bp(n),r)}else{const r=bp(n);if(r!==null&&t)return{...n};const i=Object.create(r);return Object.assign(i,n)}}function jA(n,e=!1){return Mw(n)||N0(n)||!od(n)||(Cw(n)>1&&Object.defineProperties(n,{set:vx,add:vx,clear:vx,delete:vx}),Object.freeze(n),e&&Object.values(n).forEach(t=>jA(t,!0))),n}function yq(){lo(2)}var vx={value:yq};function Mw(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var xq={};function ld(n){const e=xq[n];return e||lo(0,n),e}var Rp;function YF(){return Rp}function _q(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function nN(n,e){e&&(ld("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function yb(n){xb(n),n.drafts_.forEach(vq),n.drafts_=null}function xb(n){n===Rp&&(Rp=n.parent_)}function rN(n){return Rp=_q(Rp,n)}function vq(n){const e=n[fa];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function iN(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[fa].modified_&&(yb(e),lo(4)),od(n)&&(n=X_(e,n),e.parent_||q_(e,n)),e.patches_&&ld("Patches").generateReplacementPatches_(t[fa].base_,n,e.patches_,e.inversePatches_)):n=X_(e,t,[]),yb(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==KF?n:void 0}function X_(n,e,t){if(Mw(e))return e;const r=n.immer_.shouldUseStrictIteration(),i=e[fa];if(!i)return K_(e,(s,a)=>sN(n,i,e,s,a,t),r),e;if(i.scope_!==n)return e;if(!i.modified_)return q_(n,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let a=s,o=!1;i.type_===3&&(a=new Set(s),s.clear(),o=!0),K_(a,(l,c)=>sN(n,i,s,l,c,t,o),r),q_(n,s,!1),t&&n.patches_&&ld("Patches").generatePatches_(i,t,n.patches_,n.inversePatches_)}return i.copy_}function sN(n,e,t,r,i,s,a){if(i==null||typeof i!="object"&&!a)return;const o=Mw(i);if(!(o&&!a)){if(N0(i)){const l=s&&e&&e.type_!==3&&!mb(e.assigned_,r)?s.concat(r):void 0,c=X_(n,i,l);if(qF(t,r,c),N0(c))n.canAutoFreeze_=!1;else return}else a&&t.add(i);if(od(i)&&!o){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===i&&o)return;X_(n,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(Sy(t)?t.has(r):Object.prototype.propertyIsEnumerable.call(t,r))&&q_(n,i)}}}function q_(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&jA(e,t)}function wq(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:YF(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=VA;t&&(i=[r],s=Ap);const{revoke:a,proxy:o}=Proxy.revocable(i,s);return r.draft_=o,r.revoke_=a,o}var VA={get(n,e){if(e===fa)return n;const t=Th(n);if(!mb(t,e))return Eq(n,t,e);const r=t[e];return n.finalized_||!od(r)?r:r===$S(n.base_,e)?(WS(n),n.copy_[e]=vb(r,n)):r},has(n,e){return e in Th(n)},ownKeys(n){return Reflect.ownKeys(Th(n))},set(n,e,t){const r=ZF(Th(n),e);if(r?.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const i=$S(Th(n),e),s=i?.[fa];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(pq(t,i)&&(t!==void 0||mb(n.base_,e)))return!0;WS(n),_b(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return $S(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,WS(n),_b(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Th(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){lo(11)},getPrototypeOf(n){return bp(n.base_)},setPrototypeOf(){lo(12)}},Ap={};K_(VA,(n,e)=>{Ap[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Ap.deleteProperty=function(n,e){return Ap.set.call(this,n,e,void 0)};Ap.set=function(n,e,t){return VA.set.call(this,n[0],e,t,n[0])};function $S(n,e){const t=n[fa];return(t?Th(t):n)[e]}function Eq(n,e,t){const r=ZF(e,t);return r?"value"in r?r.value:r.get?.call(n.draft_):void 0}function ZF(n,e){if(!(e in n))return;let t=bp(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=bp(t)}}function _b(n){n.modified_||(n.modified_=!0,n.parent_&&_b(n.parent_))}function WS(n){n.copy_||(n.copy_=pb(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var Sq=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const a=this;return function(l=s,...c){return a.produce(l,h=>t.call(this,h,...c))}}typeof t!="function"&&lo(6),r!==void 0&&typeof r!="function"&&lo(7);let i;if(od(e)){const s=rN(this),a=vb(e,void 0);let o=!0;try{i=t(a),o=!1}finally{o?yb(s):xb(s)}return nN(s,r),iN(i,s)}else if(!e||typeof e!="object"){if(i=t(e),i===void 0&&(i=e),i===KF&&(i=void 0),this.autoFreeze_&&jA(i,!0),r){const s=[],a=[];ld("Patches").generateReplacementPatches_(e,i,s,a),r(s,a)}return i}else lo(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let r,i;return[this.produce(e,t,(a,o)=>{r=a,i=o}),r,i]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){od(n)||lo(8),N0(n)&&(n=Tq(n));const e=rN(this),t=vb(n,void 0);return t[fa].isManual_=!0,xb(e),t}finishDraft(n,e){const t=n&&n[fa];(!t||!t.isManual_)&&lo(9);const{scope_:r}=t;return nN(r,e),iN(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const i=e[t];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}t>-1&&(e=e.slice(t+1));const r=ld("Patches").applyPatches_;return N0(n)?r(n,e):this.produce(n,i=>r(i,e))}};function vb(n,e){const t=Sy(n)?ld("MapSet").proxyMap_(n,e):Pw(n)?ld("MapSet").proxySet_(n,e):wq(n,e);return(e?e.scope_:YF()).drafts_.push(t),t}function Tq(n){return N0(n)||lo(10,n),JF(n)}function JF(n){if(!od(n)||Mw(n))return n;const e=n[fa];let t,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=pb(n,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else t=pb(n,!0);return K_(t,(i,s)=>{qF(t,i,JF(s))},r),e&&(e.finalized_=!1),t}var bq=new Sq,Rq=bq.produce;const Aq=n=>(e,t,r)=>(r.setState=(i,s,...a)=>{const o=typeof i=="function"?Rq(i):i;return e(o,s,...a)},n(r.setState,t,r)),sg=Aq,xs=bs()(sg((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.2,minRotationSpeed:8,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:r}=e();r!==null&&navigator.geolocation.clearWatch(r),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(r=>{r.position={lat:t.coords.latitude,lng:t.coords.longitude},r.accuracy=t.coords.accuracy,r.speed=t.coords.speed;const i=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<i)){r.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){r.headingSource="gps";const o=t.coords.heading;e().updateHeading(o,"gps")}else r.headingSource="compass"})},updateHeading:(t,r="compass")=>{n(i=>{const{smoothHeading:s,config:a}=e();if(s===null){i.smoothHeading=t,i.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=r==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(r==="gps"?.5:.35);i.smoothHeading=(h+360)%360,i.heading=t})},setSmoothedHeading:t=>{n(r=>{r.smoothHeading=t,r.heading=t})},setWatchId:t=>{n(r=>{r.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),Nw={"TMK 1850":{name:"TMK 1850",factory:async()=>null,immediateLoad:!0,tier:"premium"},"Bonnebladen 1900":{name:"Bonnebladen 1900",factory:async()=>null,immediateLoad:!0,tier:"premium"},"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await xt(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await xt(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await xt(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await xt(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await xt(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE IJzertijd":{name:"FAMKE IJzertijd",factory:async()=>{const{createFAMKEIJzertijdLayerOL:n}=await xt(async()=>{const{createFAMKEIJzertijdLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createFAMKEIJzertijdLayerOL:e}},[]);return n()},immediateLoad:!0},Essen:{name:"Essen",factory:async()=>{const{createEssenLayerOL:n}=await xt(async()=>{const{createEssenLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createEssenLayerOL:e}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await xt(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createRijksmonumentenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await xt(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await xt(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createWerelderfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await xt(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-DcA_l8aM.js");return{createTerpenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await xt(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-FybUCg_t.js");return{createLiniesLayerOL:e}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await xt(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-FybUCg_t.js");return{createInundatiesLayerOL:e}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await xt(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-FybUCg_t.js");return{createMilitaireObjectenLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:n}=await xt(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-Dhyea86B.js");return{createPaleo800ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:n}=await xt(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-Dhyea86B.js");return{createPaleo100ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:n}=await xt(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-Dhyea86B.js");return{createPaleo500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:n}=await xt(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-Dhyea86B.js");return{createPaleo1500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:n}=await xt(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-Dhyea86B.js");return{createPaleo2750vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:n}=await xt(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-Dhyea86B.js");return{createPaleo5500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:n}=await xt(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-Dhyea86B.js");return{createPaleo9000vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:n}=await xt(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-DiaCVvwt.js");return{createReligieusErfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hoogtekaart Kleur":{name:"AHN4 Hoogtekaart Kleur",factory:async()=>{const{createAHN4ColorElevationLayerOL:n}=await xt(async()=>{const{createAHN4ColorElevationLayerOL:e}=await import("./hillshadeLayers-BRjLJDPV.js");return{createAHN4ColorElevationLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await xt(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-BRjLJDPV.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await xt(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-BRjLJDPV.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:n}=await xt(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createGewaspercelenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:n}=await xt(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createKadastraleKaartLayerOL:e}},[]);return n()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:n}=await xt(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createScheepswrakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:n}=await xt(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createWoonheuvelsLayerOL:e}},[]);return n()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:n}=await xt(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./romeinseFortenOL-DrdchQD0.js");return{createRomeinseFortenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},"Romeinse Forten Lijnen":{name:"Romeinse Forten Lijnen",factory:async()=>{const{createRomeinseFortenLijnenLayerOL:n}=await xt(async()=>{const{createRomeinseFortenLijnenLayerOL:e}=await import("./romeinseFortenOL-DrdchQD0.js");return{createRomeinseFortenLijnenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:n}=await xt(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createWindmolensLayerOL:e}},[]);return n()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:n}=await xt(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createErfgoedlijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:n}=await xt(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createOudeKernenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenPuntenLayerOL:n}=await xt(async()=>{const{createRelictenPuntenLayerOL:e}=await import("./relictenGelderlandOL-BU021-rr.js");return{createRelictenPuntenLayerOL:e}},[]);return n()},immediateLoad:!1},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:n}=await xt(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:n}=await xt(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:n}=await xt(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-DXDWLmaQ.js");return{createVerdronkenDorpenLayerOL:e}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await xt(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-CFD3kxY6.js");return{createAMKLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Romeins":{name:"AMK Romeins",factory:async()=>{const{createAMKRomeinsLayerOL:n}=await xt(async()=>{const{createAMKRomeinsLayerOL:e}=await import("./amkOL-CFD3kxY6.js");return{createAMKRomeinsLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Steentijd":{name:"AMK Steentijd",factory:async()=>{const{createAMKSteentijdLayerOL:n}=await xt(async()=>{const{createAMKSteentijdLayerOL:e}=await import("./amkOL-CFD3kxY6.js");return{createAMKSteentijdLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Vroege ME":{name:"AMK Vroege ME",factory:async()=>{const{createAMKVroegeMELayerOL:n}=await xt(async()=>{const{createAMKVroegeMELayerOL:e}=await import("./amkOL-CFD3kxY6.js");return{createAMKVroegeMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Late ME":{name:"AMK Late ME",factory:async()=>{const{createAMKLateMELayerOL:n}=await xt(async()=>{const{createAMKLateMELayerOL:e}=await import("./amkOL-CFD3kxY6.js");return{createAMKLateMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Overig":{name:"AMK Overig",factory:async()=>{const{createAMKOverigLayerOL:n}=await xt(async()=>{const{createAMKOverigLayerOL:e}=await import("./amkOL-CFD3kxY6.js");return{createAMKOverigLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"Romeinse wegen (regio)":{name:"Romeinse wegen (regio)",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await xt(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-5B5yGtr9.js");return{createRomeinseWegenLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1},"Romeinse wegen (Wereld)":{name:"Romeinse wegen (Wereld)",factory:async()=>{const{createRomeinseWegenWereldLayerOL:n}=await xt(async()=>{const{createRomeinseWegenWereldLayerOL:e}=await import("./romeinsOL-5B5yGtr9.js");return{createRomeinseWegenWereldLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await xt(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-Dpw5W01-.js");return{createKastelenLayerOL:e}},__vite__mapDeps([5,1]));return n()},immediateLoad:!1},Runes:{name:"Runes",factory:async()=>{const{createRuinesLayerOL:n}=await xt(async()=>{const{createRuinesLayerOL:e}=await import("./ruinesOL-BMoj8SfQ.js");return{createRuinesLayerOL:e}},__vite__mapDeps([6,1]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await xt(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-BPcug3Qq.js");return{createVeengebiedenLayerOL:e}},[]);return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await xt(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-DWH1N7k-.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([7,1]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await xt(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-DR8yk9XX.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([8,3,1]));return n()},immediateLoad:!1,tier:"premium"},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await xt(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-BtWVZezA.js");return{createUIKAVVlakkenLayerOL:e}},__vite__mapDeps([9,3]));return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await xt(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-xbShml2_.js");return{createUIKAVBufferlaagLayerOL:e}},__vite__mapDeps([10,3]));return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await xt(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-BbbD8_co.js");return{createUIKAVExpertLayerOL:e}},__vite__mapDeps([11,3]));return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await xt(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-BtYuVBPo.js");return{createUIKAVUiterwaardenLayerOL:e}},__vite__mapDeps([12,3]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await xt(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-DGOBr8-V.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([13,3,1]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await xt(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-DEOhucJl.js");return{createMuseaLayerOL:e}},__vite__mapDeps([14,3,1]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await xt(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-B-57zgVT.js");return{createStrandjesLayerOL:e}},__vite__mapDeps([15,3]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await xt(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-GBSxaBrQ.js");return{createParkenLayerOL:e}},__vite__mapDeps([16,3]));return n()},immediateLoad:!1},Kringloopwinkels:{name:"Kringloopwinkels",factory:async()=>{const{createKringloopwinkelsLayerOL:n}=await xt(async()=>{const{createKringloopwinkelsLayerOL:e}=await import("./kringloopwinkelsOL-Dxc5IckD.js");return{createKringloopwinkelsLayerOL:e}},__vite__mapDeps([17,1]));return n()},immediateLoad:!1},Ruiterpaden:{name:"Ruiterpaden",factory:async()=>{const{createRuiterpadenLayerOL:n}=await xt(async()=>{const{createRuiterpadenLayerOL:e}=await import("./ruiterpadenOL-BpdNKu1w.js");return{createRuiterpadenLayerOL:e}},[]);return n()},immediateLoad:!1},Laarzenpaden:{name:"Laarzenpaden",factory:async()=>{const{createLaarzenpadenLayerOL:n}=await xt(async()=>{const{createLaarzenpadenLayerOL:e}=await import("./laarzenpadenOL-DNaMDBRX.js");return{createLaarzenpadenLayerOL:e}},[]);return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await xt(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-DqQ0Dbrl.js");return{createFossielenLayerOL:e}},__vite__mapDeps([18,19,1]));return n()},immediateLoad:!1,tier:"premium"},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await xt(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-BahvRq6Y.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([20,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["be"]},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await xt(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-CE2tK-9Q.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([21,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["de"]},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await xt(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-DY0qrXKx.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([22,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["fr"]},"Fossiel Hotspots":{name:"Fossiel Hotspots",factory:async()=>{const{createFossielHotspotsLayerOL:n}=await xt(async()=>{const{createFossielHotspotsLayerOL:e}=await import("./fossielHotspotsOL-DKQUzIs8.js");return{createFossielHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"Mineralen Hotspots":{name:"Mineralen Hotspots",factory:async()=>{const{createMineralenHotspotsLayerOL:n}=await xt(async()=>{const{createMineralenHotspotsLayerOL:e}=await import("./mineralenHotspotsOL-C8na8do1.js");return{createMineralenHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Goudrivieren:{name:"Goudrivieren",factory:async()=>{const{createGoudrivierenLayerOL:n}=await xt(async()=>{const{createGoudrivierenLayerOL:e}=await import("./goudrivierenOL-CuFM3rC2.js");return{createGoudrivierenLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Wandelroutes:{name:"Wandelroutes",factory:async()=>{const{createWandelroutesLayer:n}=await xt(async()=>{const{createWandelroutesLayer:e}=await import("./wandelroutesOL-BzGHrmSP.js");return{createWandelroutesLayer:e}},[]);return n()},immediateLoad:!1,tier:"free",regions:["nl","be"]},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await xt(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-DLhUI2-H.js");return{createBunkersLayerOL:e}},__vite__mapDeps([23,1]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await xt(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-B-PNVwX4.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([24,1]));return n()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:n}=await xt(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-B1aoIAfd.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([25,1]));return n()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:n}=await xt(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-d73ZABVQ.js");return{createVliegveldenLayerOL:e}},[]);return n()},immediateLoad:!1}};function kq(){return Object.values(Nw).filter(n=>n.immediateLoad)}const pi=bs()(sg((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(r=>{r.map=t})},setRotation:t=>{n(r=>{if(r.rotation=t,r.map&&r.rotationEnabled){const i=t*Math.PI/180;r.map.getView().setRotation(i)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),bi=bs()(sg((n,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,"FAMKE IJzertijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"AMK Romeins":!1,"AMK Steentijd":!1,"AMK Vroege ME":!1,"AMK Late ME":!1,"AMK Overig":!1,"Archeo Onderzoeken":!1,"Romeinse wegen (regio)":!1,"Romeinse wegen (Wereld)":!1,Kastelen:!1,IKAW:!1,Essen:!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hoogtekaart Kleur":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN 0.5m":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Ruiterpaden:!1,Laarzenpaden:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1,"Mijn Vondsten":!0},opacity:{"AHN4 Hoogtekaart Kleur":.85,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN 0.5m":.7,"TMK 1850":.8,"Bonnebladen 1900":.8,Geomorfologie:.5,Bodemkaart:.6,Veengebieden:.6,IKAW:.5,"FAMKE Steentijd":.6,"FAMKE IJzertijd":.6,Essen:.6,Terpen:.7,"AMK Monumenten":.45,"AMK Romeins":.6,"AMK Steentijd":.6,"AMK Vroege ME":.6,"AMK Late ME":.6,"AMK Overig":.6,"Paleokaart 9000 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 800 n.Chr.":.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},toggleLayer:t=>{const r=e(),i=!r.visible[t];n(s=>{s.visible[t]=i}),i&&!r.layers[t]?e().loadLayer(t):r.layers[t]&&r.layers[t].setVisible(i)},setLayerVisibility:(t,r)=>{const i=e();n(s=>{s.visible[t]=r;const a=s.layers[t];a&&a.setVisible(r)}),r&&!i.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,r)=>{n(i=>{i.opacity[t]=r;const s=i.layers[t];s&&s.setOpacity(r)})},registerLayer:(t,r)=>{n(i=>{i.layers[t]=r,i.loadingState[t]="loaded",i.visible[t]!==void 0&&r.setVisible(i.visible[t]),i.opacity[t]!==void 0&&r.setOpacity(i.opacity[t])})},unregisterLayer:t=>{n(r=>{delete r.layers[t],delete r.loadingState[t]})},loadLayer:async t=>{const r=e();if(r.loadingState[t]==="loading"||r.layers[t])return;const i=Nw[t];if(!i){console.warn(` Layer "${t}" not found in registry`);return}const s=pi.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(a=>{a.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const a=await i.factory();if(!a)throw new Error("Factory returned null");const o=e();a.setVisible(o.visible[t]??!1),o.opacity[t]!==void 0&&a.setOpacity(o.opacity[t]),s.addLayer(a),n(l=>{l.layers[t]=a,l.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(a){console.error(` Failed to load layer "${t}":`,a),n(o=>{o.loadingState[t]="error"})}}}))),wr=bs()(sg((n,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,vondstFormOpen:!1,vondstFormLocation:null,vondstFormPhoto:null,vondstDashboardOpen:!1,createLayerModalOpen:!1,addPointModalOpen:!1,addPointModalLayerId:null,addPointModalLocation:null,layerManagerModalOpen:!1,layerDashboardOpen:!1,layerDashboardLayerId:null,routeDashboardOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(t=>{t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1})},toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleBackgroundsPanel:()=>{n(t=>{const r=t.backgroundsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{n(t=>{const r=t.themesPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{n(t=>{const r=t.settingsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(t=>{const r=t.infoPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.infoPanelOpen=!0)})},togglePresetsPanel:()=>{n(t=>{const r=t.presetsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.presetsPanelOpen=!0)})},toggleCategory:t=>{n(r=>{r.collapsedCategories.has(t)?r.collapsedCategories.delete(t):r.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(r=>{r.layerControlOpen=t})},setLegendOpen:t=>{n(r=>{r.legendOpen=t})},openVondstForm:(t,r)=>{n(i=>{i.backgroundsPanelOpen=!1,i.themesPanelOpen=!1,i.settingsPanelOpen=!1,i.infoPanelOpen=!1,i.presetsPanelOpen=!1,i.vondstFormOpen=!0,i.vondstFormLocation=t||null,i.vondstFormPhoto=r||null})},closeVondstForm:()=>{n(t=>{t.vondstFormOpen=!1,t.vondstFormLocation=null,t.vondstFormPhoto=null})},toggleVondstDashboard:()=>{n(t=>{const r=t.vondstDashboardOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,t.vondstDashboardOpen=!r})},openCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!0})},closeCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!1})},openAddPointModal:(t,r)=>{n(i=>{i.addPointModalOpen=!0,i.addPointModalLayerId=t,i.addPointModalLocation=r})},closeAddPointModal:()=>{n(t=>{t.addPointModalOpen=!1,t.addPointModalLayerId=null,t.addPointModalLocation=null})},openLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!0})},closeLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!1})},openLayerDashboard:t=>{n(r=>{r.layerDashboardOpen=!0,r.layerDashboardLayerId=t,r.layerManagerModalOpen=!1})},closeLayerDashboard:()=>{n(t=>{t.layerDashboardOpen=!1,t.layerDashboardLayerId=null})},toggleRouteDashboard:()=>{n(t=>{t.routeDashboardOpen=!t.routeDashboardOpen})}}))),Iq=()=>{};var aN={};const QF=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Cq=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],o=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},ej={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,o=a?n[i+1]:0,l=i+2<n.length,c=l?n[i+2]:0,h=s>>2,g=(s&3)<<4|o>>4;let m=(o&15)<<2|c>>6,y=c&63;l||(y=64,a||(m=64)),r.push(t[h],t[g],t[m],t[y])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(QF(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Cq(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],o=i<n.length?t[n.charAt(i)]:0;++i;const c=i<n.length?t[n.charAt(i)]:64;++i;const g=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||o==null||c==null||g==null)throw new Pq;const m=s<<2|o>>4;if(r.push(m),c!==64){const y=o<<4&240|c>>2;if(r.push(y),g!==64){const v=c<<6&192|g;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Pq extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Mq=function(n){const e=QF(n);return ej.encodeByteArray(e,!0)},Y_=function(n){return Mq(n).replace(/\./g,"")},tj=function(n){try{return ej.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function nj(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Nq=()=>nj().__FIREBASE_DEFAULTS__,Lq=()=>{if(typeof process>"u"||typeof aN>"u")return;const n=aN.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Oq=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&tj(n[1]);return e&&JSON.parse(e)},Lw=()=>{try{return Iq()||Nq()||Lq()||Oq()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},rj=n=>Lw()?.emulatorHosts?.[n],ij=n=>{const e=rj(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},sj=()=>Lw()?.config,aj=n=>Lw()?.[`_${n}`];class Dq{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Pd(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function BA(n){return(await fetch(n,{credentials:"include"})).ok}function oj(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Y_(JSON.stringify(t)),Y_(JSON.stringify(a)),""].join(".")}const Dm={};function Fq(){const n={prod:[],emulator:[]};for(const e of Object.keys(Dm))Dm[e]?n.emulator.push(e):n.prod.push(e);return n}function jq(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let oN=!1;function GA(n,e){if(typeof window>"u"||typeof document>"u"||!Pd(window.location.host)||Dm[n]===e||Dm[n]||oN)return;Dm[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",s=Fq().prod.length>0;function a(){const m=document.getElementById(r);m&&m.remove()}function o(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{oN=!0,a()},m}function h(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function g(){const m=jq(r),y=t("text"),v=document.getElementById(y)||document.createElement("span"),_=t("learnmore"),E=document.getElementById(_)||document.createElement("a"),T=t("preprendIcon"),b=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const R=m.element;o(R),h(E,_);const N=c();l(b,T),R.append(b,v,E,N),document.body.appendChild(R)}s?(v.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function mi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Vq(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mi())}function lj(){const n=Lw()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Bq(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Gq(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function zq(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Uq(){const n=mi();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function cj(){return!lj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function uj(){return!lj()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function hj(){try{return typeof indexedDB=="object"}catch{return!1}}function $q(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const Wq="FirebaseError";class yl extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Wq,Object.setPrototypeOf(this,yl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ty.prototype.create)}}class Ty{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?Hq(s,r):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new yl(i,o,r)}}function Hq(n,e){return n.replace(Kq,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const Kq=/\{\$([^}]+)}/g;function Xq(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function cd(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(lN(s)&&lN(a)){if(!cd(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function lN(n){return n!==null&&typeof n=="object"}function by(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function qq(n,e){const t=new Yq(n,e);return t.subscribe.bind(t)}class Yq{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Zq(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=HS),i.error===void 0&&(i.error=HS),i.complete===void 0&&(i.complete=HS);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Zq(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function HS(){}function Ci(n){return n&&n._delegate?n._delegate:n}class Cu{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const bh="[DEFAULT]";class Jq{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Dq;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(eY(e))try{this.getOrInitializeService({instanceIdentifier:bh})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=bh){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=bh){return this.instances.has(e)}getOptions(e=bh){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);r===o&&a.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Qq(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=bh){return this.component?this.component.multipleInstances?e:bh:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Qq(n){return n===bh?void 0:n}function eY(n){return n.instantiationMode==="EAGER"}class tY{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Jq(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var yn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(yn||(yn={}));const nY={debug:yn.DEBUG,verbose:yn.VERBOSE,info:yn.INFO,warn:yn.WARN,error:yn.ERROR,silent:yn.SILENT},rY=yn.INFO,iY={[yn.DEBUG]:"log",[yn.VERBOSE]:"log",[yn.INFO]:"info",[yn.WARN]:"warn",[yn.ERROR]:"error"},sY=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=iY[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class zA{constructor(e){this.name=e,this._logLevel=rY,this._logHandler=sY,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?nY[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yn.DEBUG,...e),this._logHandler(this,yn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yn.VERBOSE,...e),this._logHandler(this,yn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yn.INFO,...e),this._logHandler(this,yn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yn.WARN,...e),this._logHandler(this,yn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yn.ERROR,...e),this._logHandler(this,yn.ERROR,...e)}}const aY=(n,e)=>e.some(t=>n instanceof t);let cN,uN;function oY(){return cN||(cN=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function lY(){return uN||(uN=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const dj=new WeakMap,wb=new WeakMap,fj=new WeakMap,KS=new WeakMap,UA=new WeakMap;function cY(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(wu(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&dj.set(t,n)}).catch(()=>{}),UA.set(e,n),e}function uY(n){if(wb.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});wb.set(n,e)}let Eb={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return wb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||fj.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return wu(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function hY(n){Eb=n(Eb)}function dY(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(XS(this),e,...t);return fj.set(r,e.sort?e.sort():[e]),wu(r)}:lY().includes(n)?function(...e){return n.apply(XS(this),e),wu(dj.get(this))}:function(...e){return wu(n.apply(XS(this),e))}}function fY(n){return typeof n=="function"?dY(n):(n instanceof IDBTransaction&&uY(n),aY(n,oY())?new Proxy(n,Eb):n)}function wu(n){if(n instanceof IDBRequest)return cY(n);if(KS.has(n))return KS.get(n);const e=fY(n);return e!==n&&(KS.set(n,e),UA.set(e,n)),e}const XS=n=>UA.get(n);function gY(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),o=wu(a);return r&&a.addEventListener("upgradeneeded",l=>{r(wu(a.result),l.oldVersion,l.newVersion,wu(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const mY=["get","getKey","getAll","getAllKeys","count"],pY=["put","add","delete","clear"],qS=new Map;function hN(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(qS.get(e))return qS.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=pY.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||mY.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(o.shift())),(await Promise.all([c[t](...o),i&&l.done]))[0]};return qS.set(e,s),s}hY(n=>({...n,get:(e,t,r)=>hN(e,t)||n.get(e,t,r),has:(e,t)=>!!hN(e,t)||n.has(e,t)}));class yY{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(xY(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function xY(n){return n.getComponent()?.type==="VERSION"}const Sb="@firebase/app",dN="0.14.6";const rc=new zA("@firebase/app"),_Y="@firebase/app-compat",vY="@firebase/analytics-compat",wY="@firebase/analytics",EY="@firebase/app-check-compat",SY="@firebase/app-check",TY="@firebase/auth",bY="@firebase/auth-compat",RY="@firebase/database",AY="@firebase/data-connect",kY="@firebase/database-compat",IY="@firebase/functions",CY="@firebase/functions-compat",PY="@firebase/installations",MY="@firebase/installations-compat",NY="@firebase/messaging",LY="@firebase/messaging-compat",OY="@firebase/performance",DY="@firebase/performance-compat",FY="@firebase/remote-config",jY="@firebase/remote-config-compat",VY="@firebase/storage",BY="@firebase/storage-compat",GY="@firebase/firestore",zY="@firebase/ai",UY="@firebase/firestore-compat",$Y="firebase",WY="12.6.0";const Tb="[DEFAULT]",HY={[Sb]:"fire-core",[_Y]:"fire-core-compat",[wY]:"fire-analytics",[vY]:"fire-analytics-compat",[SY]:"fire-app-check",[EY]:"fire-app-check-compat",[TY]:"fire-auth",[bY]:"fire-auth-compat",[RY]:"fire-rtdb",[AY]:"fire-data-connect",[kY]:"fire-rtdb-compat",[IY]:"fire-fn",[CY]:"fire-fn-compat",[PY]:"fire-iid",[MY]:"fire-iid-compat",[NY]:"fire-fcm",[LY]:"fire-fcm-compat",[OY]:"fire-perf",[DY]:"fire-perf-compat",[FY]:"fire-rc",[jY]:"fire-rc-compat",[VY]:"fire-gcs",[BY]:"fire-gcs-compat",[GY]:"fire-fst",[UY]:"fire-fst-compat",[zY]:"fire-vertex","fire-js":"fire-js",[$Y]:"fire-js-all"};const Z_=new Map,KY=new Map,bb=new Map;function fN(n,e){try{n.container.addComponent(e)}catch(t){rc.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ud(n){const e=n.name;if(bb.has(e))return rc.debug(`There were multiple attempts to register component ${e}.`),!1;bb.set(e,n);for(const t of Z_.values())fN(t,n);for(const t of KY.values())fN(t,n);return!0}function Ow(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ca(n){return n==null?!1:n.settings!==void 0}const XY={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Eu=new Ty("app","Firebase",XY);class qY{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Cu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Eu.create("app-deleted",{appName:this._name})}}const Md=WY;function gj(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Tb,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Eu.create("bad-app-name",{appName:String(i)});if(t||(t=sj()),!t)throw Eu.create("no-options");const s=Z_.get(i);if(s){if(cd(t,s.options)&&cd(r,s.config))return s;throw Eu.create("duplicate-app",{appName:i})}const a=new tY(i);for(const l of bb.values())a.addComponent(l);const o=new qY(t,r,a);return Z_.set(i,o),o}function $A(n=Tb){const e=Z_.get(n);if(!e&&n===Tb&&sj())return gj();if(!e)throw Eu.create("no-app",{appName:n});return e}function tl(n,e,t){let r=HY[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rc.warn(a.join(" "));return}ud(new Cu(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const YY="firebase-heartbeat-database",ZY=1,kp="firebase-heartbeat-store";let YS=null;function mj(){return YS||(YS=gY(YY,ZY,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(kp)}catch(t){console.warn(t)}}}}).catch(n=>{throw Eu.create("idb-open",{originalErrorMessage:n.message})})),YS}async function JY(n){try{const t=(await mj()).transaction(kp),r=await t.objectStore(kp).get(pj(n));return await t.done,r}catch(e){if(e instanceof yl)rc.warn(e.message);else{const t=Eu.create("idb-get",{originalErrorMessage:e?.message});rc.warn(t.message)}}}async function gN(n,e){try{const r=(await mj()).transaction(kp,"readwrite");await r.objectStore(kp).put(e,pj(n)),await r.done}catch(t){if(t instanceof yl)rc.warn(t.message);else{const r=Eu.create("idb-set",{originalErrorMessage:t?.message});rc.warn(r.message)}}}function pj(n){return`${n.name}!${n.options.appId}`}const QY=1024,eZ=30;class tZ{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new rZ(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=mN();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>eZ){const i=iZ(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){rc.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=mN(),{heartbeatsToSend:t,unsentEntries:r}=nZ(this._heartbeatsCache.heartbeats),i=Y_(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return rc.warn(e),""}}}function mN(){return new Date().toISOString().substring(0,10)}function nZ(n,e=QY){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),pN(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),pN(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class rZ{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return hj()?$q().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await JY(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return gN(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return gN(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function pN(n){return Y_(JSON.stringify({version:2,heartbeats:n})).length}function iZ(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function sZ(n){ud(new Cu("platform-logger",e=>new yY(e),"PRIVATE")),ud(new Cu("heartbeat",e=>new tZ(e),"PRIVATE")),tl(Sb,dN,n),tl(Sb,dN,"esm2020"),tl("fire-js","")}sZ("");function yj(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const aZ=yj,xj=new Ty("auth","Firebase",yj());const J_=new zA("@firebase/auth");function oZ(n,...e){J_.logLevel<=yn.WARN&&J_.warn(`Auth (${Md}): ${n}`,...e)}function Qx(n,...e){J_.logLevel<=yn.ERROR&&J_.error(`Auth (${Md}): ${n}`,...e)}function ul(n,...e){throw HA(n,...e)}function xo(n,...e){return HA(n,...e)}function WA(n,e,t){const r={...aZ(),[e]:t};return new Ty("auth","Firebase",r).create(e,{appName:n.name})}function Su(n){return WA(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function lZ(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&ul(n,"argument-error"),WA(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function HA(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return xj.create(n,...e)}function Yt(n,e,...t){if(!n)throw HA(e,...t)}function Gl(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Qx(e),new Error(e)}function ic(n,e){n||Gl(e)}function Rb(){return typeof self<"u"&&self.location?.href||""}function cZ(){return yN()==="http:"||yN()==="https:"}function yN(){return typeof self<"u"&&self.location?.protocol||null}function uZ(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(cZ()||Gq()||"connection"in navigator)?navigator.onLine:!0}function hZ(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Ry{constructor(e,t){this.shortDelay=e,this.longDelay=t,ic(t>e,"Short delay should be less than long delay!"),this.isMobile=Vq()||zq()}get(){return uZ()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function KA(n,e){ic(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class _j{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const dZ={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const fZ=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],gZ=new Ry(3e4,6e4);function Dw(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ag(n,e,t,r,i={}){return vj(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const o=by({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:e,headers:l,...s};return Bq()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&Pd(n.emulatorConfig.host)&&(c.credentials="include"),_j.fetch()(await Ej(n,n.config.apiHost,t,o),c)})}async function vj(n,e,t){n._canInitEmulator=!1;const r={...dZ,...e};try{const i=new mZ(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw wx(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw wx(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw wx(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw wx(n,"user-disabled",a);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw WA(n,h,c);ul(n,h)}}catch(i){if(i instanceof yl)throw i;ul(n,"network-request-failed",{message:String(i)})}}async function wj(n,e,t,r,i={}){const s=await ag(n,e,t,r,i);return"mfaPendingCredential"in s&&ul(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function Ej(n,e,t,r){const i=`${e}${t}?${r}`,s=n,a=s.config.emulator?KA(n.config,i):`${n.config.apiScheme}://${i}`;return fZ.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}class mZ{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(xo(this.auth,"network-request-failed")),gZ.get())})}}function wx(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=xo(n,e,r);return i.customData._tokenResponse=t,i}async function pZ(n,e){return ag(n,"POST","/v1/accounts:delete",e)}async function Q_(n,e){return ag(n,"POST","/v1/accounts:lookup",e)}function Fm(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function yZ(n,e=!1){const t=Ci(n),r=await t.getIdToken(e),i=XA(r);Yt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:Fm(ZS(i.auth_time)),issuedAtTime:Fm(ZS(i.iat)),expirationTime:Fm(ZS(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function ZS(n){return Number(n)*1e3}function XA(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Qx("JWT malformed, contained fewer than 3 sections"),null;try{const i=tj(t);return i?JSON.parse(i):(Qx("Failed to decode base64 JWT payload"),null)}catch(i){return Qx("Caught error parsing JWT payload as JSON",i?.toString()),null}}function xN(n){const e=XA(n);return Yt(e,"internal-error"),Yt(typeof e.exp<"u","internal-error"),Yt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Ip(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof yl&&xZ(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function xZ({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class _Z{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ab{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fm(this.lastLoginAt),this.creationTime=Fm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ev(n){const e=n.auth,t=await n.getIdToken(),r=await Ip(n,Q_(e,{idToken:t}));Yt(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=i.providerUserInfo?.length?Sj(i.providerUserInfo):[],a=wZ(n.providerData,s),o=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!a?.length,c=o?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Ab(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(n,h)}async function vZ(n){const e=Ci(n);await ev(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function wZ(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Sj(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function EZ(n,e){const t=await vj(n,{},async()=>{const r=by({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await Ej(n,i,"/v1/token",`key=${s}`),o=await n._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:r};return n.emulatorConfig&&Pd(n.emulatorConfig.host)&&(l.credentials="include"),_j.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function SZ(n,e){return ag(n,"POST","/v2/accounts:revokeToken",Dw(n,e))}class f0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Yt(e.idToken,"internal-error"),Yt(typeof e.idToken<"u","internal-error"),Yt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):xN(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Yt(e.length!==0,"internal-error");const t=xN(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Yt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await EZ(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new f0;return r&&(Yt(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Yt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Yt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new f0,this.toJSON())}_performRefresh(){return Gl("not implemented")}}function Kc(n,e){Yt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class fo{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new _Z(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ab(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Ip(this,this.stsTokenManager.getToken(this.auth,e));return Yt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return yZ(this,e)}reload(){return vZ(this)}_assign(e){this!==e&&(Yt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new fo({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Yt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await ev(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ca(this.auth.app))return Promise.reject(Su(this.auth));const e=await this.getIdToken();return await Ip(this,pZ(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:g,emailVerified:m,isAnonymous:y,providerData:v,stsTokenManager:_}=t;Yt(g&&_,e,"internal-error");const E=f0.fromJSON(this.name,_);Yt(typeof g=="string",e,"internal-error"),Kc(r,e.name),Kc(i,e.name),Yt(typeof m=="boolean",e,"internal-error"),Yt(typeof y=="boolean",e,"internal-error"),Kc(s,e.name),Kc(a,e.name),Kc(o,e.name),Kc(l,e.name),Kc(c,e.name),Kc(h,e.name);const T=new fo({uid:g,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:y,photoURL:a,phoneNumber:s,tenantId:o,stsTokenManager:E,createdAt:c,lastLoginAt:h});return v&&Array.isArray(v)&&(T.providerData=v.map(b=>({...b}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new f0;i.updateFromServerResponse(t);const s=new fo({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await ev(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Yt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Sj(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,o=new f0;o.updateFromIdToken(r);const l=new fo({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ab(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,c),l}}const _N=new Map;function zl(n){ic(n instanceof Function,"Expected a class definition");let e=_N.get(n);return e?(ic(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,_N.set(n,e),e)}class Tj{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Tj.type="NONE";const vN=Tj;function e_(n,e,t){return`firebase:${n}:${e}:${t}`}class g0{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=e_(this.userKey,i.apiKey,s),this.fullPersistenceKey=e_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Q_(this.auth,{idToken:e}).catch(()=>{});return t?fo._fromGetAccountInfoResponse(this.auth,t,e):null}return fo._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new g0(zl(vN),e,r);const i=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||zl(vN);const a=e_(r,e.config.apiKey,e.name);let o=null;for(const c of t)try{const h=await c._get(a);if(h){let g;if(typeof h=="string"){const m=await Q_(e,{idToken:h}).catch(()=>{});if(!m)break;g=await fo._fromGetAccountInfoResponse(e,m,h)}else g=fo._fromJSON(e,h);c!==s&&(o=g),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new g0(s,e,r):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new g0(s,e,r))}}function wN(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(kj(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(bj(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Cj(e))return"Blackberry";if(Pj(e))return"Webos";if(Rj(e))return"Safari";if((e.includes("chrome/")||Aj(e))&&!e.includes("edge/"))return"Chrome";if(Ij(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function bj(n=mi()){return/firefox\//i.test(n)}function Rj(n=mi()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Aj(n=mi()){return/crios\//i.test(n)}function kj(n=mi()){return/iemobile/i.test(n)}function Ij(n=mi()){return/android/i.test(n)}function Cj(n=mi()){return/blackberry/i.test(n)}function Pj(n=mi()){return/webos/i.test(n)}function qA(n=mi()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function TZ(n=mi()){return qA(n)&&!!window.navigator?.standalone}function bZ(){return Uq()&&document.documentMode===10}function Mj(n=mi()){return qA(n)||Ij(n)||Pj(n)||Cj(n)||/windows phone/i.test(n)||kj(n)}function Nj(n,e=[]){let t;switch(n){case"Browser":t=wN(mi());break;case"Worker":t=`${wN(mi())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Md}/${r}`}class RZ{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function AZ(n,e={}){return ag(n,"GET","/v2/passwordPolicy",Dw(n,e))}const kZ=6;class IZ{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??kZ,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class CZ{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new EN(this),this.idTokenSubscription=new EN(this),this.beforeStateQueue=new RZ(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xj,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=zl(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await g0.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Q_(this,{idToken:e}),r=await fo._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ca(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,a=r?._redirectEventId,o=await this.tryRedirectSignIn(e);(!s||s===a)&&o?.user&&(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Yt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ev(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=hZ()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ca(this.app))return Promise.reject(Su(this));const t=e?Ci(e):null;return t&&Yt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Yt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ca(this.app)?Promise.reject(Su(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ca(this.app)?Promise.reject(Su(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zl(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await AZ(this),t=new IZ(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ty("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await SZ(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&zl(e)||this._popupRedirectResolver;Yt(t,this,"argument-error"),this.redirectPersistenceManager=await g0.create(this,[zl(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Yt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Yt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Nj(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ca(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&oZ(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ay(n){return Ci(n)}class EN{constructor(e){this.auth=e,this.observer=null,this.addObserver=qq(t=>this.observer=t)}get next(){return Yt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let YA={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function PZ(n){YA=n}function MZ(n){return YA.loadJS(n)}function NZ(){return YA.gapiScript}function LZ(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function OZ(n,e){const t=Ow(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(cd(s,e??{}))return i;ul(i,"already-initialized")}return t.initialize({options:e})}function DZ(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(zl);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function FZ(n,e,t){const r=Ay(n);Yt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=Lj(e),{host:a,port:o}=jZ(e),l=o===null?"":`:${o}`,c={url:`${s}//${a}${l}/`},h=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Yt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Yt(cd(c,r.config.emulator)&&cd(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Pd(a)?(BA(`${s}//${a}${l}`),GA("Auth",!0)):VZ()}function Lj(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function jZ(n){const e=Lj(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:SN(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:SN(a)}}}function SN(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function VZ(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Oj{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Gl("not implemented")}_getIdTokenResponse(e){return Gl("not implemented")}_linkToIdToken(e,t){return Gl("not implemented")}_getReauthenticationResolver(e){return Gl("not implemented")}}async function m0(n,e){return wj(n,"POST","/v1/accounts:signInWithIdp",Dw(n,e))}const BZ="http://localhost";class hd extends Oj{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new hd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ul("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const a=new hd(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return m0(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,m0(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,m0(e,t)}buildRequest(){const e={requestUri:BZ,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=by(t)}return e}}class ZA{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ky extends ZA{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ru extends ky{constructor(){super("facebook.com")}static credential(e){return hd._fromParams({providerId:ru.PROVIDER_ID,signInMethod:ru.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ru.credentialFromTaggedObject(e)}static credentialFromError(e){return ru.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ru.credential(e.oauthAccessToken)}catch{return null}}}ru.FACEBOOK_SIGN_IN_METHOD="facebook.com";ru.PROVIDER_ID="facebook.com";class co extends ky{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return hd._fromParams({providerId:co.PROVIDER_ID,signInMethod:co.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return co.credentialFromTaggedObject(e)}static credentialFromError(e){return co.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return co.credential(t,r)}catch{return null}}}co.GOOGLE_SIGN_IN_METHOD="google.com";co.PROVIDER_ID="google.com";class iu extends ky{constructor(){super("github.com")}static credential(e){return hd._fromParams({providerId:iu.PROVIDER_ID,signInMethod:iu.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return iu.credentialFromTaggedObject(e)}static credentialFromError(e){return iu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return iu.credential(e.oauthAccessToken)}catch{return null}}}iu.GITHUB_SIGN_IN_METHOD="github.com";iu.PROVIDER_ID="github.com";class su extends ky{constructor(){super("twitter.com")}static credential(e,t){return hd._fromParams({providerId:su.PROVIDER_ID,signInMethod:su.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return su.credentialFromTaggedObject(e)}static credentialFromError(e){return su.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return su.credential(t,r)}catch{return null}}}su.TWITTER_SIGN_IN_METHOD="twitter.com";su.PROVIDER_ID="twitter.com";async function GZ(n,e){return wj(n,"POST","/v1/accounts:signUp",Dw(n,e))}class Pu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await fo._fromIdTokenResponse(e,r,i),a=TN(r);return new Pu({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=TN(r);return new Pu({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function TN(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function zZ(n){if(ca(n.app))return Promise.reject(Su(n));const e=Ay(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Pu({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await GZ(e,{returnSecureToken:!0}),r=await Pu._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class tv extends yl{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,tv.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new tv(e,t,r,i)}}function Dj(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?tv._fromErrorAndOperation(n,s,e,r):s})}async function UZ(n,e,t=!1){const r=await Ip(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Pu._forOperation(n,"link",r)}async function $Z(n,e,t=!1){const{auth:r}=n;if(ca(r.app))return Promise.reject(Su(r));const i="reauthenticate";try{const s=await Ip(n,Dj(r,i,e,n),t);Yt(s.idToken,r,"internal-error");const a=XA(s.idToken);Yt(a,r,"internal-error");const{sub:o}=a;return Yt(n.uid===o,r,"user-mismatch"),Pu._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&ul(r,"user-mismatch"),s}}async function WZ(n,e,t=!1){if(ca(n.app))return Promise.reject(Su(n));const r="signIn",i=await Dj(n,r,e),s=await Pu._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}function HZ(n,e,t,r){return Ci(n).onIdTokenChanged(e,t,r)}function KZ(n,e,t){return Ci(n).beforeAuthStateChanged(e,t)}function Fj(n,e,t,r){return Ci(n).onAuthStateChanged(e,t,r)}function jj(n){return Ci(n).signOut()}const nv="__sak";class Vj{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(nv,"1"),this.storage.removeItem(nv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const XZ=1e3,qZ=10;class Bj extends Vj{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Mj(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);bZ()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,qZ):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},XZ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Bj.type="LOCAL";const YZ=Bj;class Gj extends Vj{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Gj.type="SESSION";const zj=Gj;function ZZ(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Fw{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Fw(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const o=Array.from(a).map(async c=>c(t.origin,s)),l=await ZZ(o);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Fw.receivers=[];function JA(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class JZ{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=JA("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(g){const m=g;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(m.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function nl(){return window}function QZ(n){nl().location.href=n}function Uj(){return typeof nl().WorkerGlobalScope<"u"&&typeof nl().importScripts=="function"}async function eJ(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function tJ(){return navigator?.serviceWorker?.controller||null}function nJ(){return Uj()?self:null}const $j="firebaseLocalStorageDb",rJ=1,rv="firebaseLocalStorage",Wj="fbase_key";class Iy{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function jw(n,e){return n.transaction([rv],e?"readwrite":"readonly").objectStore(rv)}function iJ(){const n=indexedDB.deleteDatabase($j);return new Iy(n).toPromise()}function kb(){const n=indexedDB.open($j,rJ);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(rv,{keyPath:Wj})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(rv)?e(r):(r.close(),await iJ(),e(await kb()))})})}async function bN(n,e,t){const r=jw(n,!0).put({[Wj]:e,value:t});return new Iy(r).toPromise()}async function sJ(n,e){const t=jw(n,!1).get(e),r=await new Iy(t).toPromise();return r===void 0?null:r.value}function RN(n,e){const t=jw(n,!0).delete(e);return new Iy(t).toPromise()}const aJ=800,oJ=3;class Hj{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await kb(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>oJ)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Uj()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Fw._getInstance(nJ()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await eJ(),!this.activeServiceWorker)return;this.sender=new JZ(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||tJ()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await kb();return await bN(e,nv,"1"),await RN(e,nv),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>bN(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>sJ(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>RN(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=jw(i,!1).getAll();return new Iy(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),aJ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Hj.type="LOCAL";const lJ=Hj;new Ry(3e4,6e4);function Kj(n,e){return e?zl(e):(Yt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class QA extends Oj{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return m0(e,this._buildIdpRequest())}_linkToIdToken(e,t){return m0(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return m0(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function cJ(n){return WZ(n.auth,new QA(n),n.bypassAuthState)}function uJ(n){const{auth:e,user:t}=n;return Yt(t,e,"internal-error"),$Z(t,new QA(n),n.bypassAuthState)}async function hJ(n){const{auth:e,user:t}=n;return Yt(t,e,"internal-error"),UZ(t,new QA(n),n.bypassAuthState)}class Xj{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return cJ;case"linkViaPopup":case"linkViaRedirect":return hJ;case"reauthViaPopup":case"reauthViaRedirect":return uJ;default:ul(this.auth,"internal-error")}}resolve(e){ic(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ic(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const dJ=new Ry(2e3,1e4);async function AN(n,e,t){if(ca(n.app))return Promise.reject(xo(n,"operation-not-supported-in-this-environment"));const r=Ay(n);lZ(n,e,ZA);const i=Kj(r,t);return new Gh(r,"signInViaPopup",e,i).executeNotNull()}class Gh extends Xj{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Gh.currentPopupAction&&Gh.currentPopupAction.cancel(),Gh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Yt(e,this.auth,"internal-error"),e}async onExecution(){ic(this.filter.length===1,"Popup operations only handle one event");const e=JA();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(xo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(xo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Gh.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(xo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,dJ.get())};e()}}Gh.currentPopupAction=null;const fJ="pendingRedirect",t_=new Map;class gJ extends Xj{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=t_.get(this.auth._key());if(!e){try{const r=await mJ(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}t_.set(this.auth._key(),e)}return this.bypassAuthState||t_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function mJ(n,e){const t=xJ(e),r=yJ(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function pJ(n,e){t_.set(n._key(),e)}function yJ(n){return zl(n._redirectPersistence)}function xJ(n){return e_(fJ,n.config.apiKey,n.name)}async function _J(n,e,t=!1){if(ca(n.app))return Promise.reject(Su(n));const r=Ay(n),i=Kj(r,e),a=await new gJ(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const vJ=600*1e3;class wJ{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!EJ(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!qj(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(xo(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=vJ&&this.cachedEventUids.clear(),this.cachedEventUids.has(kN(e))}saveEventToCache(e){this.cachedEventUids.add(kN(e)),this.lastProcessedEventTime=Date.now()}}function kN(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function qj({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function EJ(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qj(n);default:return!1}}async function SJ(n,e={}){return ag(n,"GET","/v1/projects",e)}const TJ=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,bJ=/^https?/;async function RJ(n){if(n.config.emulator)return;const{authorizedDomains:e}=await SJ(n);for(const t of e)try{if(AJ(t))return}catch{}ul(n,"unauthorized-domain")}function AJ(n){const e=Rb(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!bJ.test(t))return!1;if(TJ.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const kJ=new Ry(3e4,6e4);function IN(){const n=nl().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function IJ(n){return new Promise((e,t)=>{function r(){IN(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{IN(),t(xo(n,"network-request-failed"))},timeout:kJ.get()})}if(nl().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(nl().gapi?.load)r();else{const i=LZ("iframefcb");return nl()[i]=()=>{gapi.load?r():t(xo(n,"network-request-failed"))},MZ(`${NZ()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw n_=null,e})}let n_=null;function CJ(n){return n_=n_||IJ(n),n_}const PJ=new Ry(5e3,15e3),MJ="__/auth/iframe",NJ="emulator/auth/iframe",LJ={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},OJ=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function DJ(n){const e=n.config;Yt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?KA(e,NJ):`https://${n.config.authDomain}/${MJ}`,r={apiKey:e.apiKey,appName:n.name,v:Md},i=OJ.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${by(r).slice(1)}`}async function FJ(n){const e=await CJ(n),t=nl().gapi;return Yt(t,n,"internal-error"),e.open({where:document.body,url:DJ(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:LJ,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=xo(n,"network-request-failed"),o=nl().setTimeout(()=>{s(a)},PJ.get());function l(){nl().clearTimeout(o),i(r)}r.ping(l).then(l,()=>{s(a)})}))}const jJ={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},VJ=500,BJ=600,GJ="_blank",zJ="http://localhost";class CN{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function UJ(n,e,t,r=VJ,i=BJ){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={...jJ,width:r.toString(),height:i.toString(),top:s,left:a},c=mi().toLowerCase();t&&(o=Aj(c)?GJ:t),bj(c)&&(e=e||zJ,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[y,v])=>`${m}${y}=${v},`,"");if(TZ(c)&&o!=="_self")return $J(e||"",o),new CN(null);const g=window.open(e||"",o,h);Yt(g,n,"popup-blocked");try{g.focus()}catch{}return new CN(g)}function $J(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const WJ="__/auth/handler",HJ="emulator/auth/handler",KJ=encodeURIComponent("fac");async function PN(n,e,t,r,i,s){Yt(n.config.authDomain,n,"auth-domain-config-required"),Yt(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Md,eventId:i};if(e instanceof ZA){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Xq(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,g]of Object.entries({}))a[h]=g}if(e instanceof ky){const h=e.getScopes().filter(g=>g!=="");h.length>0&&(a.scopes=h.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const l=await n._getAppCheckToken(),c=l?`#${KJ}=${encodeURIComponent(l)}`:"";return`${XJ(n)}?${by(o).slice(1)}${c}`}function XJ({config:n}){return n.emulator?KA(n,HJ):`https://${n.authDomain}/${WJ}`}const JS="webStorageSupport";class qJ{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zj,this._completeRedirectFn=_J,this._overrideRedirectResult=pJ}async _openPopup(e,t,r,i){ic(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await PN(e,t,r,Rb(),i);return UJ(e,s,JA())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await PN(e,t,r,Rb(),i);return QZ(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(ic(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await FJ(e),r=new wJ(e);return t.register("authEvent",i=>(Yt(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(JS,{type:JS},i=>{const s=i?.[0]?.[JS];s!==void 0&&t(!!s),ul(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=RJ(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Mj()||Rj()||qA()}}const YJ=qJ;var MN="@firebase/auth",NN="1.12.0";class ZJ{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Yt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function JJ(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function QJ(n){ud(new Cu("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Yt(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Nj(n)},c=new CZ(r,i,s,l);return DZ(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ud(new Cu("auth-internal",e=>{const t=Ay(e.getProvider("auth").getImmediate());return(r=>new ZJ(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),tl(MN,NN,JJ(n)),tl(MN,NN,"esm2020")}const eQ=300,tQ=aj("authIdTokenMaxAge")||eQ;let LN=null;const nQ=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>tQ)return;const i=t?.token;LN!==i&&(LN=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function rQ(n=$A()){const e=Ow(n,"auth");if(e.isInitialized())return e.getImmediate();const t=OZ(n,{popupRedirectResolver:YJ,persistence:[lJ,YZ,zj]}),r=aj("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=nQ(s.toString());KZ(t,a,()=>a(t.currentUser)),HZ(t,o=>a(o))}}const i=rj("auth");return i&&FZ(t,`http://${i}`),t}function iQ(){return document.getElementsByTagName("head")?.[0]??document}PZ({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=xo("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",iQ().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});QJ("Browser");var sQ="firebase",aQ="12.7.0";tl(sQ,aQ,"app");var ON=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Tu,Yj;(function(){var n;function e(I,A){function M(){}M.prototype=A.prototype,I.F=A.prototype,I.prototype=new M,I.prototype.constructor=I,I.D=function(O,L,z){for(var j=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)j[Ee-2]=arguments[Ee];return A.prototype[L].apply(O,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,A,M){M||(M=0);const O=Array(16);if(typeof A=="string")for(var L=0;L<16;++L)O[L]=A.charCodeAt(M++)|A.charCodeAt(M++)<<8|A.charCodeAt(M++)<<16|A.charCodeAt(M++)<<24;else for(L=0;L<16;++L)O[L]=A[M++]|A[M++]<<8|A[M++]<<16|A[M++]<<24;A=I.g[0],M=I.g[1],L=I.g[2];let z=I.g[3],j;j=A+(z^M&(L^z))+O[0]+3614090360&4294967295,A=M+(j<<7&4294967295|j>>>25),j=z+(L^A&(M^L))+O[1]+3905402710&4294967295,z=A+(j<<12&4294967295|j>>>20),j=L+(M^z&(A^M))+O[2]+606105819&4294967295,L=z+(j<<17&4294967295|j>>>15),j=M+(A^L&(z^A))+O[3]+3250441966&4294967295,M=L+(j<<22&4294967295|j>>>10),j=A+(z^M&(L^z))+O[4]+4118548399&4294967295,A=M+(j<<7&4294967295|j>>>25),j=z+(L^A&(M^L))+O[5]+1200080426&4294967295,z=A+(j<<12&4294967295|j>>>20),j=L+(M^z&(A^M))+O[6]+2821735955&4294967295,L=z+(j<<17&4294967295|j>>>15),j=M+(A^L&(z^A))+O[7]+4249261313&4294967295,M=L+(j<<22&4294967295|j>>>10),j=A+(z^M&(L^z))+O[8]+1770035416&4294967295,A=M+(j<<7&4294967295|j>>>25),j=z+(L^A&(M^L))+O[9]+2336552879&4294967295,z=A+(j<<12&4294967295|j>>>20),j=L+(M^z&(A^M))+O[10]+4294925233&4294967295,L=z+(j<<17&4294967295|j>>>15),j=M+(A^L&(z^A))+O[11]+2304563134&4294967295,M=L+(j<<22&4294967295|j>>>10),j=A+(z^M&(L^z))+O[12]+1804603682&4294967295,A=M+(j<<7&4294967295|j>>>25),j=z+(L^A&(M^L))+O[13]+4254626195&4294967295,z=A+(j<<12&4294967295|j>>>20),j=L+(M^z&(A^M))+O[14]+2792965006&4294967295,L=z+(j<<17&4294967295|j>>>15),j=M+(A^L&(z^A))+O[15]+1236535329&4294967295,M=L+(j<<22&4294967295|j>>>10),j=A+(L^z&(M^L))+O[1]+4129170786&4294967295,A=M+(j<<5&4294967295|j>>>27),j=z+(M^L&(A^M))+O[6]+3225465664&4294967295,z=A+(j<<9&4294967295|j>>>23),j=L+(A^M&(z^A))+O[11]+643717713&4294967295,L=z+(j<<14&4294967295|j>>>18),j=M+(z^A&(L^z))+O[0]+3921069994&4294967295,M=L+(j<<20&4294967295|j>>>12),j=A+(L^z&(M^L))+O[5]+3593408605&4294967295,A=M+(j<<5&4294967295|j>>>27),j=z+(M^L&(A^M))+O[10]+38016083&4294967295,z=A+(j<<9&4294967295|j>>>23),j=L+(A^M&(z^A))+O[15]+3634488961&4294967295,L=z+(j<<14&4294967295|j>>>18),j=M+(z^A&(L^z))+O[4]+3889429448&4294967295,M=L+(j<<20&4294967295|j>>>12),j=A+(L^z&(M^L))+O[9]+568446438&4294967295,A=M+(j<<5&4294967295|j>>>27),j=z+(M^L&(A^M))+O[14]+3275163606&4294967295,z=A+(j<<9&4294967295|j>>>23),j=L+(A^M&(z^A))+O[3]+4107603335&4294967295,L=z+(j<<14&4294967295|j>>>18),j=M+(z^A&(L^z))+O[8]+1163531501&4294967295,M=L+(j<<20&4294967295|j>>>12),j=A+(L^z&(M^L))+O[13]+2850285829&4294967295,A=M+(j<<5&4294967295|j>>>27),j=z+(M^L&(A^M))+O[2]+4243563512&4294967295,z=A+(j<<9&4294967295|j>>>23),j=L+(A^M&(z^A))+O[7]+1735328473&4294967295,L=z+(j<<14&4294967295|j>>>18),j=M+(z^A&(L^z))+O[12]+2368359562&4294967295,M=L+(j<<20&4294967295|j>>>12),j=A+(M^L^z)+O[5]+4294588738&4294967295,A=M+(j<<4&4294967295|j>>>28),j=z+(A^M^L)+O[8]+2272392833&4294967295,z=A+(j<<11&4294967295|j>>>21),j=L+(z^A^M)+O[11]+1839030562&4294967295,L=z+(j<<16&4294967295|j>>>16),j=M+(L^z^A)+O[14]+4259657740&4294967295,M=L+(j<<23&4294967295|j>>>9),j=A+(M^L^z)+O[1]+2763975236&4294967295,A=M+(j<<4&4294967295|j>>>28),j=z+(A^M^L)+O[4]+1272893353&4294967295,z=A+(j<<11&4294967295|j>>>21),j=L+(z^A^M)+O[7]+4139469664&4294967295,L=z+(j<<16&4294967295|j>>>16),j=M+(L^z^A)+O[10]+3200236656&4294967295,M=L+(j<<23&4294967295|j>>>9),j=A+(M^L^z)+O[13]+681279174&4294967295,A=M+(j<<4&4294967295|j>>>28),j=z+(A^M^L)+O[0]+3936430074&4294967295,z=A+(j<<11&4294967295|j>>>21),j=L+(z^A^M)+O[3]+3572445317&4294967295,L=z+(j<<16&4294967295|j>>>16),j=M+(L^z^A)+O[6]+76029189&4294967295,M=L+(j<<23&4294967295|j>>>9),j=A+(M^L^z)+O[9]+3654602809&4294967295,A=M+(j<<4&4294967295|j>>>28),j=z+(A^M^L)+O[12]+3873151461&4294967295,z=A+(j<<11&4294967295|j>>>21),j=L+(z^A^M)+O[15]+530742520&4294967295,L=z+(j<<16&4294967295|j>>>16),j=M+(L^z^A)+O[2]+3299628645&4294967295,M=L+(j<<23&4294967295|j>>>9),j=A+(L^(M|~z))+O[0]+4096336452&4294967295,A=M+(j<<6&4294967295|j>>>26),j=z+(M^(A|~L))+O[7]+1126891415&4294967295,z=A+(j<<10&4294967295|j>>>22),j=L+(A^(z|~M))+O[14]+2878612391&4294967295,L=z+(j<<15&4294967295|j>>>17),j=M+(z^(L|~A))+O[5]+4237533241&4294967295,M=L+(j<<21&4294967295|j>>>11),j=A+(L^(M|~z))+O[12]+1700485571&4294967295,A=M+(j<<6&4294967295|j>>>26),j=z+(M^(A|~L))+O[3]+2399980690&4294967295,z=A+(j<<10&4294967295|j>>>22),j=L+(A^(z|~M))+O[10]+4293915773&4294967295,L=z+(j<<15&4294967295|j>>>17),j=M+(z^(L|~A))+O[1]+2240044497&4294967295,M=L+(j<<21&4294967295|j>>>11),j=A+(L^(M|~z))+O[8]+1873313359&4294967295,A=M+(j<<6&4294967295|j>>>26),j=z+(M^(A|~L))+O[15]+4264355552&4294967295,z=A+(j<<10&4294967295|j>>>22),j=L+(A^(z|~M))+O[6]+2734768916&4294967295,L=z+(j<<15&4294967295|j>>>17),j=M+(z^(L|~A))+O[13]+1309151649&4294967295,M=L+(j<<21&4294967295|j>>>11),j=A+(L^(M|~z))+O[4]+4149444226&4294967295,A=M+(j<<6&4294967295|j>>>26),j=z+(M^(A|~L))+O[11]+3174756917&4294967295,z=A+(j<<10&4294967295|j>>>22),j=L+(A^(z|~M))+O[2]+718787259&4294967295,L=z+(j<<15&4294967295|j>>>17),j=M+(z^(L|~A))+O[9]+3951481745&4294967295,I.g[0]=I.g[0]+A&4294967295,I.g[1]=I.g[1]+(L+(j<<21&4294967295|j>>>11))&4294967295,I.g[2]=I.g[2]+L&4294967295,I.g[3]=I.g[3]+z&4294967295}r.prototype.v=function(I,A){A===void 0&&(A=I.length);const M=A-this.blockSize,O=this.C;let L=this.h,z=0;for(;z<A;){if(L==0)for(;z<=M;)i(this,I,z),z+=this.blockSize;if(typeof I=="string"){for(;z<A;)if(O[L++]=I.charCodeAt(z++),L==this.blockSize){i(this,O),L=0;break}}else for(;z<A;)if(O[L++]=I[z++],L==this.blockSize){i(this,O),L=0;break}}this.h=L,this.o+=A},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var A=1;A<I.length-8;++A)I[A]=0;A=this.o*8;for(var M=I.length-8;M<I.length;++M)I[M]=A&255,A/=256;for(this.v(I),I=Array(16),A=0,M=0;M<4;++M)for(let O=0;O<32;O+=8)I[A++]=this.g[M]>>>O&255;return I};function s(I,A){var M=o;return Object.prototype.hasOwnProperty.call(M,I)?M[I]:M[I]=A(I)}function a(I,A){this.h=A;const M=[];let O=!0;for(let L=I.length-1;L>=0;L--){const z=I[L]|0;O&&z==A||(M[L]=z,O=!1)}this.g=M}var o={};function l(I){return-128<=I&&I<128?s(I,function(A){return new a([A|0],A<0?-1:0)}):new a([I|0],I<0?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return g;if(I<0)return E(c(-I));const A=[];let M=1;for(let O=0;I>=M;O++)A[O]=I/M|0,M*=4294967296;return new a(A,0)}function h(I,A){if(I.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(I.charAt(0)=="-")return E(h(I.substring(1),A));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=c(Math.pow(A,8));let O=g;for(let z=0;z<I.length;z+=8){var L=Math.min(8,I.length-z);const j=parseInt(I.substring(z,z+L),A);L<8?(L=c(Math.pow(A,L)),O=O.j(L).add(c(j))):(O=O.j(M),O=O.add(c(j)))}return O}var g=l(0),m=l(1),y=l(16777216);n=a.prototype,n.m=function(){if(_(this))return-E(this).m();let I=0,A=1;for(let M=0;M<this.g.length;M++){const O=this.i(M);I+=(O>=0?O:4294967296+O)*A,A*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(v(this))return"0";if(_(this))return"-"+E(this).toString(I);const A=c(Math.pow(I,6));var M=this;let O="";for(;;){const L=N(M,A).g;M=T(M,L.j(A));let z=((M.g.length>0?M.g[0]:M.h)>>>0).toString(I);if(M=L,v(M))return z+O;for(;z.length<6;)z="0"+z;O=z+O}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function v(I){if(I.h!=0)return!1;for(let A=0;A<I.g.length;A++)if(I.g[A]!=0)return!1;return!0}function _(I){return I.h==-1}n.l=function(I){return I=T(this,I),_(I)?-1:v(I)?0:1};function E(I){const A=I.g.length,M=[];for(let O=0;O<A;O++)M[O]=~I.g[O];return new a(M,~I.h).add(m)}n.abs=function(){return _(this)?E(this):this},n.add=function(I){const A=Math.max(this.g.length,I.g.length),M=[];let O=0;for(let L=0;L<=A;L++){let z=O+(this.i(L)&65535)+(I.i(L)&65535),j=(z>>>16)+(this.i(L)>>>16)+(I.i(L)>>>16);O=j>>>16,z&=65535,j&=65535,M[L]=j<<16|z}return new a(M,M[M.length-1]&-2147483648?-1:0)};function T(I,A){return I.add(E(A))}n.j=function(I){if(v(this)||v(I))return g;if(_(this))return _(I)?E(this).j(E(I)):E(E(this).j(I));if(_(I))return E(this.j(E(I)));if(this.l(y)<0&&I.l(y)<0)return c(this.m()*I.m());const A=this.g.length+I.g.length,M=[];for(var O=0;O<2*A;O++)M[O]=0;for(O=0;O<this.g.length;O++)for(let L=0;L<I.g.length;L++){const z=this.i(O)>>>16,j=this.i(O)&65535,Ee=I.i(L)>>>16,Ce=I.i(L)&65535;M[2*O+2*L]+=j*Ce,b(M,2*O+2*L),M[2*O+2*L+1]+=z*Ce,b(M,2*O+2*L+1),M[2*O+2*L+1]+=j*Ee,b(M,2*O+2*L+1),M[2*O+2*L+2]+=z*Ee,b(M,2*O+2*L+2)}for(I=0;I<A;I++)M[I]=M[2*I+1]<<16|M[2*I];for(I=A;I<2*A;I++)M[I]=0;return new a(M,0)};function b(I,A){for(;(I[A]&65535)!=I[A];)I[A+1]+=I[A]>>>16,I[A]&=65535,A++}function R(I,A){this.g=I,this.h=A}function N(I,A){if(v(A))throw Error("division by zero");if(v(I))return new R(g,g);if(_(I))return A=N(E(I),A),new R(E(A.g),E(A.h));if(_(A))return A=N(I,E(A)),new R(E(A.g),A.h);if(I.g.length>30){if(_(I)||_(A))throw Error("slowDivide_ only works with positive integers.");for(var M=m,O=A;O.l(I)<=0;)M=D(M),O=D(O);var L=W(M,1),z=W(O,1);for(O=W(O,2),M=W(M,2);!v(O);){var j=z.add(O);j.l(I)<=0&&(L=L.add(M),z=j),O=W(O,1),M=W(M,1)}return A=T(I,L.j(A)),new R(L,A)}for(L=g;I.l(A)>=0;){for(M=Math.max(1,Math.floor(I.m()/A.m())),O=Math.ceil(Math.log(M)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),z=c(M),j=z.j(A);_(j)||j.l(I)>0;)M-=O,z=c(M),j=z.j(A);v(z)&&(z=m),L=L.add(z),I=T(I,j)}return new R(L,I)}n.B=function(I){return N(this,I).h},n.and=function(I){const A=Math.max(this.g.length,I.g.length),M=[];for(let O=0;O<A;O++)M[O]=this.i(O)&I.i(O);return new a(M,this.h&I.h)},n.or=function(I){const A=Math.max(this.g.length,I.g.length),M=[];for(let O=0;O<A;O++)M[O]=this.i(O)|I.i(O);return new a(M,this.h|I.h)},n.xor=function(I){const A=Math.max(this.g.length,I.g.length),M=[];for(let O=0;O<A;O++)M[O]=this.i(O)^I.i(O);return new a(M,this.h^I.h)};function D(I){const A=I.g.length+1,M=[];for(let O=0;O<A;O++)M[O]=I.i(O)<<1|I.i(O-1)>>>31;return new a(M,I.h)}function W(I,A){const M=A>>5;A%=32;const O=I.g.length-M,L=[];for(let z=0;z<O;z++)L[z]=A>0?I.i(z+M)>>>A|I.i(z+M+1)<<32-A:I.i(z+M);return new a(L,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Yj=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=h,Tu=a}).apply(typeof ON<"u"?ON:typeof self<"u"?self:typeof window<"u"?window:{});var Ex=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Zj,wm,Jj,r_,Ib,Qj,e6,t6;(function(){var n,e=Object.defineProperty;function t(x){x=[typeof globalThis=="object"&&globalThis,x,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ex=="object"&&Ex];for(var C=0;C<x.length;++C){var F=x[C];if(F&&F.Math==Math)return F}throw Error("Cannot find global object")}var r=t(this);function i(x,C){if(C)e:{var F=r;x=x.split(".");for(var H=0;H<x.length-1;H++){var me=x[H];if(!(me in F))break e;F=F[me]}x=x[x.length-1],H=F[x],C=C(H),C!=H&&C!=null&&e(F,x,{configurable:!0,writable:!0,value:C})}}i("Symbol.dispose",function(x){return x||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(x){return x||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(x){return x||function(C){var F=[],H;for(H in C)Object.prototype.hasOwnProperty.call(C,H)&&F.push([H,C[H]]);return F}});var s=s||{},a=this||self;function o(x){var C=typeof x;return C=="object"&&x!=null||C=="function"}function l(x,C,F){return x.call.apply(x.bind,arguments)}function c(x,C,F){return c=l,c.apply(null,arguments)}function h(x,C){var F=Array.prototype.slice.call(arguments,1);return function(){var H=F.slice();return H.push.apply(H,arguments),x.apply(this,H)}}function g(x,C){function F(){}F.prototype=C.prototype,x.Z=C.prototype,x.prototype=new F,x.prototype.constructor=x,x.Ob=function(H,me,ke){for(var ot=Array(arguments.length-2),nn=2;nn<arguments.length;nn++)ot[nn-2]=arguments[nn];return C.prototype[me].apply(H,ot)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?x=>x&&AsyncContext.Snapshot.wrap(x):x=>x;function y(x){const C=x.length;if(C>0){const F=Array(C);for(let H=0;H<C;H++)F[H]=x[H];return F}return[]}function v(x,C){for(let H=1;H<arguments.length;H++){const me=arguments[H];var F=typeof me;if(F=F!="object"?F:me?Array.isArray(me)?"array":F:"null",F=="array"||F=="object"&&typeof me.length=="number"){F=x.length||0;const ke=me.length||0;x.length=F+ke;for(let ot=0;ot<ke;ot++)x[F+ot]=me[ot]}else x.push(me)}}class _{constructor(C,F){this.i=C,this.j=F,this.h=0,this.g=null}get(){let C;return this.h>0?(this.h--,C=this.g,this.g=C.next,C.next=null):C=this.i(),C}}function E(x){a.setTimeout(()=>{throw x},0)}function T(){var x=I;let C=null;return x.g&&(C=x.g,x.g=x.g.next,x.g||(x.h=null),C.next=null),C}class b{constructor(){this.h=this.g=null}add(C,F){const H=R.get();H.set(C,F),this.h?this.h.next=H:this.g=H,this.h=H}}var R=new _(()=>new N,x=>x.reset());class N{constructor(){this.next=this.g=this.h=null}set(C,F){this.h=C,this.g=F,this.next=null}reset(){this.next=this.g=this.h=null}}let D,W=!1,I=new b,A=()=>{const x=Promise.resolve(void 0);D=()=>{x.then(M)}};function M(){for(var x;x=T();){try{x.h.call(x.g)}catch(F){E(F)}var C=R;C.j(x),C.h<100&&(C.h++,x.next=C.g,C.g=x)}W=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(x,C){this.type=x,this.g=this.target=C,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var x=!1,C=Object.defineProperty({},"passive",{get:function(){x=!0}});try{const F=()=>{};a.addEventListener("test",F,C),a.removeEventListener("test",F,C)}catch{}return x})();function j(x){return/^[\s\xa0]*$/.test(x)}function Ee(x,C){L.call(this,x?x.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,x&&this.init(x,C)}g(Ee,L),Ee.prototype.init=function(x,C){const F=this.type=x.type,H=x.changedTouches&&x.changedTouches.length?x.changedTouches[0]:null;this.target=x.target||x.srcElement,this.g=C,C=x.relatedTarget,C||(F=="mouseover"?C=x.fromElement:F=="mouseout"&&(C=x.toElement)),this.relatedTarget=C,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0),this.button=x.button,this.key=x.key||"",this.ctrlKey=x.ctrlKey,this.altKey=x.altKey,this.shiftKey=x.shiftKey,this.metaKey=x.metaKey,this.pointerId=x.pointerId||0,this.pointerType=x.pointerType,this.state=x.state,this.i=x,x.defaultPrevented&&Ee.Z.h.call(this)},Ee.prototype.h=function(){Ee.Z.h.call(this);const x=this.i;x.preventDefault?x.preventDefault():x.returnValue=!1};var Ce="closure_listenable_"+(Math.random()*1e6|0),Ge=0;function Le(x,C,F,H,me){this.listener=x,this.proxy=null,this.src=C,this.type=F,this.capture=!!H,this.ha=me,this.key=++Ge,this.da=this.fa=!1}function ce(x){x.da=!0,x.listener=null,x.proxy=null,x.src=null,x.ha=null}function Me(x,C,F){for(const H in x)C.call(F,x[H],H,x)}function Te(x,C){for(const F in x)C.call(void 0,x[F],F,x)}function ie(x){const C={};for(const F in x)C[F]=x[F];return C}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Z(x,C){let F,H;for(let me=1;me<arguments.length;me++){H=arguments[me];for(F in H)x[F]=H[F];for(let ke=0;ke<V.length;ke++)F=V[ke],Object.prototype.hasOwnProperty.call(H,F)&&(x[F]=H[F])}}function te(x){this.src=x,this.g={},this.h=0}te.prototype.add=function(x,C,F,H,me){const ke=x.toString();x=this.g[ke],x||(x=this.g[ke]=[],this.h++);const ot=he(x,C,H,me);return ot>-1?(C=x[ot],F||(C.fa=!1)):(C=new Le(C,this.src,ke,!!H,me),C.fa=F,x.push(C)),C};function se(x,C){const F=C.type;if(F in x.g){var H=x.g[F],me=Array.prototype.indexOf.call(H,C,void 0),ke;(ke=me>=0)&&Array.prototype.splice.call(H,me,1),ke&&(ce(C),x.g[F].length==0&&(delete x.g[F],x.h--))}}function he(x,C,F,H){for(let me=0;me<x.length;++me){const ke=x[me];if(!ke.da&&ke.listener==C&&ke.capture==!!F&&ke.ha==H)return me}return-1}var Ae="closure_lm_"+(Math.random()*1e6|0),Fe={};function de(x,C,F,H,me){if(Array.isArray(C)){for(let ke=0;ke<C.length;ke++)de(x,C[ke],F,H,me);return null}return F=rr(F),x&&x[Ce]?x.J(C,F,o(H)?!!H.capture:!1,me):Pe(x,C,F,!1,H,me)}function Pe(x,C,F,H,me,ke){if(!C)throw Error("Invalid event type");const ot=o(me)?!!me.capture:!!me;let nn=rn(x);if(nn||(x[Ae]=nn=new te(x)),F=nn.add(C,F,H,ot,ke),F.proxy)return F;if(H=Be(),F.proxy=H,H.src=x,H.listener=F,x.addEventListener)z||(me=ot),me===void 0&&(me=!1),x.addEventListener(C.toString(),H,me);else if(x.attachEvent)x.attachEvent(Dt(C.toString()),H);else if(x.addListener&&x.removeListener)x.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return F}function Be(){function x(F){return C.call(x.src,x.listener,F)}const C=Zt;return x}function It(x,C,F,H,me){if(Array.isArray(C))for(var ke=0;ke<C.length;ke++)It(x,C[ke],F,H,me);else H=o(H)?!!H.capture:!!H,F=rr(F),x&&x[Ce]?(x=x.i,ke=String(C).toString(),ke in x.g&&(C=x.g[ke],F=he(C,F,H,me),F>-1&&(ce(C[F]),Array.prototype.splice.call(C,F,1),C.length==0&&(delete x.g[ke],x.h--)))):x&&(x=rn(x))&&(C=x.g[C.toString()],x=-1,C&&(x=he(C,F,H,me)),(F=x>-1?C[x]:null)&&Wt(F))}function Wt(x){if(typeof x!="number"&&x&&!x.da){var C=x.src;if(C&&C[Ce])se(C.i,x);else{var F=x.type,H=x.proxy;C.removeEventListener?C.removeEventListener(F,H,x.capture):C.detachEvent?C.detachEvent(Dt(F),H):C.addListener&&C.removeListener&&C.removeListener(H),(F=rn(C))?(se(F,x),F.h==0&&(F.src=null,C[Ae]=null)):ce(x)}}}function Dt(x){return x in Fe?Fe[x]:Fe[x]="on"+x}function Zt(x,C){if(x.da)x=!0;else{C=new Ee(C,this);const F=x.listener,H=x.ha||x.src;x.fa&&Wt(x),x=F.call(H,C)}return x}function rn(x){return x=x[Ae],x instanceof te?x:null}var ht="__closure_events_fn_"+(Math.random()*1e9>>>0);function rr(x){return typeof x=="function"?x:(x[ht]||(x[ht]=function(C){return x.handleEvent(C)}),x[ht])}function hn(){O.call(this),this.i=new te(this),this.M=this,this.G=null}g(hn,O),hn.prototype[Ce]=!0,hn.prototype.removeEventListener=function(x,C,F,H){It(this,x,C,F,H)};function cn(x,C){var F,H=x.G;if(H)for(F=[];H;H=H.G)F.push(H);if(x=x.M,H=C.type||C,typeof C=="string")C=new L(C,x);else if(C instanceof L)C.target=C.target||x;else{var me=C;C=new L(H,x),Z(C,me)}me=!0;let ke,ot;if(F)for(ot=F.length-1;ot>=0;ot--)ke=C.g=F[ot],me=ir(ke,H,!0,C)&&me;if(ke=C.g=x,me=ir(ke,H,!0,C)&&me,me=ir(ke,H,!1,C)&&me,F)for(ot=0;ot<F.length;ot++)ke=C.g=F[ot],me=ir(ke,H,!1,C)&&me}hn.prototype.N=function(){if(hn.Z.N.call(this),this.i){var x=this.i;for(const C in x.g){const F=x.g[C];for(let H=0;H<F.length;H++)ce(F[H]);delete x.g[C],x.h--}}this.G=null},hn.prototype.J=function(x,C,F,H){return this.i.add(String(x),C,!1,F,H)},hn.prototype.K=function(x,C,F,H){return this.i.add(String(x),C,!0,F,H)};function ir(x,C,F,H){if(C=x.i.g[String(C)],!C)return!0;C=C.concat();let me=!0;for(let ke=0;ke<C.length;++ke){const ot=C[ke];if(ot&&!ot.da&&ot.capture==F){const nn=ot.listener,zr=ot.ha||ot.src;ot.fa&&se(x.i,ot),me=nn.call(zr,H)!==!1&&me}}return me&&!H.defaultPrevented}function Pi(x,C){if(typeof x!="function")if(x&&typeof x.handleEvent=="function")x=c(x.handleEvent,x);else throw Error("Invalid listener argument");return Number(C)>2147483647?-1:a.setTimeout(x,C||0)}function jn(x){x.g=Pi(()=>{x.g=null,x.i&&(x.i=!1,jn(x))},x.l);const C=x.h;x.h=null,x.m.apply(null,C)}class Sr extends O{constructor(C,F){super(),this.m=C,this.l=F,this.h=null,this.i=!1,this.g=null}j(C){this.h=arguments,this.g?this.i=!0:jn(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ai(x){O.call(this),this.h=x,this.g={}}g(ai,O);var _t=[];function pn(x){Me(x.g,function(C,F){this.g.hasOwnProperty(F)&&Wt(C)},x),x.g={}}ai.prototype.N=function(){ai.Z.N.call(this),pn(this)},ai.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var bn=a.JSON.stringify,Et=a.JSON.parse,sn=class{stringify(x){return a.JSON.stringify(x,void 0)}parse(x){return a.JSON.parse(x,void 0)}};function Nt(){}function Xi(){}var Mr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function oi(){L.call(this,"d")}g(oi,L);function tn(){L.call(this,"c")}g(tn,L);var Tr={},je=null;function ye(){return je=je||new hn}Tr.Ia="serverreachability";function xe(x){L.call(this,Tr.Ia,x)}g(xe,L);function Ot(x){const C=ye();cn(C,new xe(C))}Tr.STAT_EVENT="statevent";function P(x,C){L.call(this,Tr.STAT_EVENT,x),this.stat=C}g(P,L);function ct(x){const C=ye();cn(C,new P(C,x))}Tr.Ja="timingevent";function U(x,C){L.call(this,Tr.Ja,x),this.size=C}g(U,L);function re(x,C){if(typeof x!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){x()},C)}function ee(){this.g=!0}ee.prototype.ua=function(){this.g=!1};function ne(x,C,F,H,me,ke){x.info(function(){if(x.g)if(ke){var ot="",nn=ke.split("&");for(let Wn=0;Wn<nn.length;Wn++){var zr=nn[Wn].split("=");if(zr.length>1){const Kr=zr[0];zr=zr[1];const Qs=Kr.split("_");ot=Qs.length>=2&&Qs[1]=="type"?ot+(Kr+"="+zr+"&"):ot+(Kr+"=redacted&")}}}else ot=null;else ot=ke;return"XMLHTTP REQ ("+H+") [attempt "+me+"]: "+C+`
`+F+`
`+ot})}function ue(x,C,F,H,me,ke,ot){x.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+me+"]: "+C+`
`+F+`
`+ke+" "+ot})}function Ie(x,C,F,H){x.info(function(){return"XMLHTTP TEXT ("+C+"): "+He(x,F)+(H?" "+H:"")})}function Ve(x,C){x.info(function(){return"TIMEOUT: "+C})}ee.prototype.info=function(){};function He(x,C){if(!x.g)return C;if(!C)return null;try{const ke=JSON.parse(C);if(ke){for(x=0;x<ke.length;x++)if(Array.isArray(ke[x])){var F=ke[x];if(!(F.length<2)){var H=F[1];if(Array.isArray(H)&&!(H.length<1)){var me=H[0];if(me!="noop"&&me!="stop"&&me!="close")for(let ot=1;ot<H.length;ot++)H[ot]=""}}}}return bn(ke)}catch{return C}}var Je={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Qe={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},yt;function St(){}g(St,Nt),St.prototype.g=function(){return new XMLHttpRequest},yt=new St;function Rn(x){return encodeURIComponent(String(x))}function B(x){var C=1;x=x.split(":");const F=[];for(;C>0&&x.length;)F.push(x.shift()),C--;return x.length&&F.push(x.join(":")),F}function Y(x,C,F,H){this.j=x,this.i=C,this.l=F,this.S=H||1,this.V=new ai(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new K}function K(){this.i=null,this.g="",this.h=!1}var q={},J={};function Q(x,C,F){x.M=1,x.A=_l(xa(C)),x.u=F,x.R=!0,ve(x,null)}function ve(x,C){x.F=Date.now(),be(x),x.B=xa(x.A);var F=x.B,H=x.S;Array.isArray(H)||(H=[String(H)]),bg(F.i,"t",H),x.C=0,F=x.j.L,x.h=new K,x.g=u1(x.j,F?C:null,!x.u),x.P>0&&(x.O=new Sr(c(x.Y,x,x.g),x.P)),C=x.V,F=x.g,H=x.ba;var me="readystatechange";Array.isArray(me)||(me&&(_t[0]=me.toString()),me=_t);for(let ke=0;ke<me.length;ke++){const ot=de(F,me[ke],H||C.handleEvent,!1,C.h||C);if(!ot)break;C.g[ot.key]=ot}C=x.J?ie(x.J):{},x.u?(x.v||(x.v="POST"),C["Content-Type"]="application/x-www-form-urlencoded",x.g.ea(x.B,x.v,x.u,C)):(x.v="GET",x.g.ea(x.B,x.v,null,C)),Ot(),ne(x.i,x.v,x.B,x.l,x.S,x.u)}Y.prototype.ba=function(x){x=x.target;const C=this.O;C&&No(x)==3?C.j():this.Y(x)},Y.prototype.Y=function(x){try{if(x==this.g)e:{const nn=No(this.g),zr=this.g.ya(),Wn=this.g.ca();if(!(nn<3)&&(nn!=3||this.g&&(this.h.h||this.g.la()||l1(this.g)))){this.K||nn!=4||zr==7||(zr==8||Wn<=0?Ot(3):Ot(2)),rt(this);var C=this.g.ca();this.X=C;var F=Oe(this);if(this.o=C==200,ue(this.i,this.v,this.B,this.l,this.S,nn,C),this.o){if(this.U&&!this.L){t:{if(this.g){var H,me=this.g;if((H=me.g?me.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(H)){var ke=H;break t}}ke=null}if(x=ke)Ie(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ye(this,x);else{this.o=!1,this.m=3,ct(12),qe(this),pt(this);break e}}if(this.R){x=!0;let Kr;for(;!this.K&&this.C<F.length;)if(Kr=Se(this,F),Kr==J){nn==4&&(this.m=4,ct(14),x=!1),Ie(this.i,this.l,null,"[Incomplete Response]");break}else if(Kr==q){this.m=4,ct(15),Ie(this.i,this.l,F,"[Invalid Chunk]"),x=!1;break}else Ie(this.i,this.l,Kr,null),Ye(this,Kr);if(_e(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),nn!=4||F.length!=0||this.h.h||(this.m=1,ct(16),x=!1),this.o=this.o&&x,!x)Ie(this.i,this.l,F,"[Invalid Chunked Response]"),qe(this),pt(this);else if(F.length>0&&!this.W){this.W=!0;var ot=this.j;ot.g==this&&ot.aa&&!ot.P&&(ot.j.info("Great, no buffering proxy detected. Bytes received: "+F.length),ih(ot),ot.P=!0,ct(11))}}else Ie(this.i,this.l,F,null),Ye(this,F);nn==4&&qe(this),this.o&&!this.K&&(nn==4?qd(this.j,this):(this.o=!1,be(this)))}else Ag(this.g),C==400&&F.indexOf("Unknown SID")>0?(this.m=3,ct(12)):(this.m=0,ct(13)),qe(this),pt(this)}}}catch{}};function Oe(x){if(!_e(x))return x.g.la();const C=l1(x.g);if(C==="")return"";let F="";const H=C.length,me=No(x.g)==4;if(!x.h.i){if(typeof TextDecoder>"u")return qe(x),pt(x),"";x.h.i=new a.TextDecoder}for(let ke=0;ke<H;ke++)x.h.h=!0,F+=x.h.i.decode(C[ke],{stream:!(me&&ke==H-1)});return C.length=0,x.h.g+=F,x.C=0,x.h.g}function _e(x){return x.g?x.v=="GET"&&x.M!=2&&x.j.Aa:!1}function Se(x,C){var F=x.C,H=C.indexOf(`
`,F);return H==-1?J:(F=Number(C.substring(F,H)),isNaN(F)?q:(H+=1,H+F>C.length?J:(C=C.slice(H,H+F),x.C=H+F,C)))}Y.prototype.cancel=function(){this.K=!0,qe(this)};function be(x){x.T=Date.now()+x.H,Xe(x,x.H)}function Xe(x,C){if(x.D!=null)throw Error("WatchDog timer not null");x.D=re(c(x.aa,x),C)}function rt(x){x.D&&(a.clearTimeout(x.D),x.D=null)}Y.prototype.aa=function(){this.D=null;const x=Date.now();x-this.T>=0?(Ve(this.i,this.B),this.M!=2&&(Ot(),ct(17)),qe(this),this.m=2,pt(this)):Xe(this,this.T-x)};function pt(x){x.j.I==0||x.K||qd(x.j,x)}function qe(x){rt(x);var C=x.O;C&&typeof C.dispose=="function"&&C.dispose(),x.O=null,pn(x.V),x.g&&(C=x.g,x.g=null,C.abort(),C.dispose())}function Ye(x,C){try{var F=x.j;if(F.I!=0&&(F.g==x||Ha(F.h,x))){if(!x.L&&Ha(F.h,x)&&F.I==3){try{var H=F.Ba.g.parse(C)}catch{H=null}if(Array.isArray(H)&&H.length==3){var me=H;if(me[0]==0){e:if(!F.v){if(F.g)if(F.g.F+3e3<x.F)Xd(F),Zs(F);else break e;Do(F),ct(18)}}else F.xa=me[1],0<F.xa-F.K&&me[2]<37500&&F.F&&F.A==0&&!F.C&&(F.C=re(c(F.Va,F),6e3));pr(F.h)<=1&&F.ta&&(F.ta=void 0)}else Js(F,11)}else if((x.L||F.g==x)&&Xd(F),!j(C))for(me=F.Ba.g.parse(C),C=0;C<me.length;C++){let Wn=me[C];const Kr=Wn[0];if(!(Kr<=F.K))if(F.K=Kr,Wn=Wn[1],F.I==2)if(Wn[0]=="c"){F.M=Wn[1],F.ba=Wn[2];const Qs=Wn[3];Qs!=null&&(F.ka=Qs,F.j.info("VER="+F.ka));const Tl=Wn[4];Tl!=null&&(F.za=Tl,F.j.info("SVER="+F.za));const Fo=Wn[5];Fo!=null&&typeof Fo=="number"&&Fo>0&&(H=1.5*Fo,F.O=H,F.j.info("backChannelRequestTimeoutMs_="+H)),H=F;const jo=x.g;if(jo){const Jd=jo.g?jo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Jd){var ke=H.h;ke.g||Jd.indexOf("spdy")==-1&&Jd.indexOf("quic")==-1&&Jd.indexOf("h2")==-1||(ke.j=ke.l,ke.g=new Set,ke.h&&(ya(ke,ke.h),ke.h=null))}if(H.G){const Cg=jo.g?jo.g.getResponseHeader("X-HTTP-Session-Id"):null;Cg&&(H.wa=Cg,Mn(H.J,H.G,Cg))}}F.I=3,F.l&&F.l.ra(),F.aa&&(F.T=Date.now()-x.F,F.j.info("Handshake RTT: "+F.T+"ms")),H=F;var ot=x;if(H.na=Ig(H,H.L?H.ba:null,H.W),ot.L){qs(H.h,ot);var nn=ot,zr=H.O;zr&&(nn.H=zr),nn.D&&(rt(nn),be(nn)),H.g=ot}else qi(H);F.i.length>0&&Sl(F)}else Wn[0]!="stop"&&Wn[0]!="close"||Js(F,7);else F.I==3&&(Wn[0]=="stop"||Wn[0]=="close"?Wn[0]=="stop"?Js(F,7):Hd(F):Wn[0]!="noop"&&F.l&&F.l.qa(Wn),F.A=0)}}Ot(4)}catch{}}var Ht=class{constructor(x,C){this.g=x,this.map=C}};function Vn(x){this.l=x||10,a.PerformanceNavigationTiming?(x=a.performance.getEntriesByType("navigation"),x=x.length>0&&(x[0].nextHopProtocol=="hq"||x[0].nextHopProtocol=="h2")):x=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=x?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function $n(x){return x.h?!0:x.g?x.g.size>=x.j:!1}function pr(x){return x.h?1:x.g?x.g.size:0}function Ha(x,C){return x.h?x.h==C:x.g?x.g.has(C):!1}function ya(x,C){x.g?x.g.add(C):x.h=C}function qs(x,C){x.h&&x.h==C?x.h=null:x.g&&x.g.has(C)&&x.g.delete(C)}Vn.prototype.cancel=function(){if(this.i=Gr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const x of this.g.values())x.cancel();this.g.clear()}};function Gr(x){if(x.h!=null)return x.i.concat(x.h.G);if(x.g!=null&&x.g.size!==0){let C=x.i;for(const F of x.g.values())C=C.concat(F.G);return C}return y(x.i)}var wc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function br(x,C){if(x){x=x.split("&");for(let F=0;F<x.length;F++){const H=x[F].indexOf("=");let me,ke=null;H>=0?(me=x[F].substring(0,H),ke=x[F].substring(H+1)):me=x[F],C(me,ke?decodeURIComponent(ke.replace(/\+/g," ")):"")}}}function Ao(x){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let C;x instanceof Ao?(this.l=x.l,Ju(this,x.j),this.o=x.o,this.g=x.g,ko(this,x.u),this.h=x.h,Ec(this,Rg(x.i)),this.m=x.m):x&&(C=String(x).match(wc))?(this.l=!1,Ju(this,C[1]||"",!0),this.o=Qu(C[2]||""),this.g=Qu(C[3]||"",!0),ko(this,C[4]),this.h=Qu(C[5]||"",!0),Ec(this,C[6]||"",!0),this.m=Qu(C[7]||"")):(this.l=!1,this.i=new vn(null,this.l))}Ao.prototype.toString=function(){const x=[];var C=this.j;C&&x.push(eh(C,vg,!0),":");var F=this.g;return(F||C=="file")&&(x.push("//"),(C=this.o)&&x.push(eh(C,vg,!0),"@"),x.push(Rn(F).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),F=this.u,F!=null&&x.push(":",String(F))),(F=this.h)&&(this.g&&F.charAt(0)!="/"&&x.push("/"),x.push(eh(F,F.charAt(0)=="/"?th:wg,!0))),(F=this.i.toString())&&x.push("?",F),(F=this.m)&&x.push("#",eh(F,Eg)),x.join("")},Ao.prototype.resolve=function(x){const C=xa(this);let F=!!x.j;F?Ju(C,x.j):F=!!x.o,F?C.o=x.o:F=!!x.g,F?C.g=x.g:F=x.u!=null;var H=x.h;if(F)ko(C,x.u);else if(F=!!x.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var me=C.h.lastIndexOf("/");me!=-1&&(H=C.h.slice(0,me+1)+H)}if(me=H,me==".."||me==".")H="";else if(me.indexOf("./")!=-1||me.indexOf("/.")!=-1){H=me.lastIndexOf("/",0)==0,me=me.split("/");const ke=[];for(let ot=0;ot<me.length;){const nn=me[ot++];nn=="."?H&&ot==me.length&&ke.push(""):nn==".."?((ke.length>1||ke.length==1&&ke[0]!="")&&ke.pop(),H&&ot==me.length&&ke.push("")):(ke.push(nn),H=!0)}H=ke.join("/")}else H=me}return F?C.h=H:F=x.i.toString()!=="",F?Ec(C,Rg(x.i)):F=!!x.m,F&&(C.m=x.m),C};function xa(x){return new Ao(x)}function Ju(x,C,F){x.j=F?Qu(C,!0):C,x.j&&(x.j=x.j.replace(/:$/,""))}function ko(x,C){if(C){if(C=Number(C),isNaN(C)||C<0)throw Error("Bad port number "+C);x.u=C}else x.u=null}function Ec(x,C,F){C instanceof vn?(x.i=C,Ud(x.i,x.l)):(F||(C=eh(C,LE)),x.i=new vn(C,x.l))}function Mn(x,C,F){x.i.set(C,F)}function _l(x){return Mn(x,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),x}function Qu(x,C){return x?C?decodeURI(x.replace(/%25/g,"%2525")):decodeURIComponent(x):""}function eh(x,C,F){return typeof x=="string"?(x=encodeURI(x).replace(C,_g),F&&(x=x.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x):null}function _g(x){return x=x.charCodeAt(0),"%"+(x>>4&15).toString(16)+(x&15).toString(16)}var vg=/[#\/\?@]/g,wg=/[#\?:]/g,th=/[#\?]/g,LE=/[#\?@]/g,Eg=/#/g;function vn(x,C){this.h=this.g=null,this.i=x||null,this.j=!!C}function Io(x){x.g||(x.g=new Map,x.h=0,x.i&&br(x.i,function(C,F){x.add(decodeURIComponent(C.replace(/\+/g," ")),F)}))}n=vn.prototype,n.add=function(x,C){Io(this),this.i=null,x=Co(this,x);let F=this.g.get(x);return F||this.g.set(x,F=[]),F.push(C),this.h+=1,this};function Sg(x,C){Io(x),C=Co(x,C),x.g.has(C)&&(x.i=null,x.h-=x.g.get(C).length,x.g.delete(C))}function zd(x,C){return Io(x),C=Co(x,C),x.g.has(C)}n.forEach=function(x,C){Io(this),this.g.forEach(function(F,H){F.forEach(function(me){x.call(C,me,H,this)},this)},this)};function Tg(x,C){Io(x);let F=[];if(typeof C=="string")zd(x,C)&&(F=F.concat(x.g.get(Co(x,C))));else for(x=Array.from(x.g.values()),C=0;C<x.length;C++)F=F.concat(x[C]);return F}n.set=function(x,C){return Io(this),this.i=null,x=Co(this,x),zd(this,x)&&(this.h-=this.g.get(x).length),this.g.set(x,[C]),this.h+=1,this},n.get=function(x,C){return x?(x=Tg(this,x),x.length>0?String(x[0]):C):C};function bg(x,C,F){Sg(x,C),F.length>0&&(x.i=null,x.g.set(Co(x,C),y(F)),x.h+=F.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const x=[],C=Array.from(this.g.keys());for(let H=0;H<C.length;H++){var F=C[H];const me=Rn(F);F=Tg(this,F);for(let ke=0;ke<F.length;ke++){let ot=me;F[ke]!==""&&(ot+="="+Rn(F[ke])),x.push(ot)}}return this.i=x.join("&")};function Rg(x){const C=new vn;return C.i=x.i,x.g&&(C.g=new Map(x.g),C.h=x.h),C}function Co(x,C){return C=String(C),x.j&&(C=C.toLowerCase()),C}function Ud(x,C){C&&!x.j&&(Io(x),x.i=null,x.g.forEach(function(F,H){const me=H.toLowerCase();H!=me&&(Sg(this,H),bg(this,me,F))},x)),x.j=C}function Po(x,C){const F=new ee;if(a.Image){const H=new Image;H.onload=h(Mi,F,"TestLoadImage: loaded",!0,C,H),H.onerror=h(Mi,F,"TestLoadImage: error",!1,C,H),H.onabort=h(Mi,F,"TestLoadImage: abort",!1,C,H),H.ontimeout=h(Mi,F,"TestLoadImage: timeout",!1,C,H),a.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=x}else C(!1)}function Mo(x,C){const F=new ee,H=new AbortController,me=setTimeout(()=>{H.abort(),Mi(F,"TestPingServer: timeout",!1,C)},1e4);fetch(x,{signal:H.signal}).then(ke=>{clearTimeout(me),ke.ok?Mi(F,"TestPingServer: ok",!0,C):Mi(F,"TestPingServer: server error",!1,C)}).catch(()=>{clearTimeout(me),Mi(F,"TestPingServer: error",!1,C)})}function Mi(x,C,F,H,me){try{me&&(me.onload=null,me.onerror=null,me.onabort=null,me.ontimeout=null),H(F)}catch{}}function nh(){this.g=new sn}function vl(x){this.i=x.Sb||null,this.h=x.ab||!1}g(vl,Nt),vl.prototype.g=function(){return new Ys(this.i,this.h)};function Ys(x,C){hn.call(this),this.H=x,this.o=C,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(Ys,hn),n=Ys.prototype,n.open=function(x,C){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=x,this.D=C,this.readyState=1,Ka(this)},n.send=function(x){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const C={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};x&&(C.body=x),(this.H||a).fetch(new Request(this.D,C)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Sc(this)),this.readyState=0},n.Pa=function(x){if(this.g&&(this.l=x,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=x.headers,this.readyState=2,Ka(this)),this.g&&(this.readyState=3,Ka(this),this.g)))if(this.responseType==="arraybuffer")x.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in x){if(this.j=x.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;s1(this)}else x.text().then(this.Oa.bind(this),this.ga.bind(this))};function s1(x){x.j.read().then(x.Ma.bind(x)).catch(x.ga.bind(x))}n.Ma=function(x){if(this.g){if(this.o&&x.value)this.response.push(x.value);else if(!this.o){var C=x.value?x.value:new Uint8Array(0);(C=this.B.decode(C,{stream:!x.done}))&&(this.response=this.responseText+=C)}x.done?Sc(this):Ka(this),this.readyState==3&&s1(this)}},n.Oa=function(x){this.g&&(this.response=this.responseText=x,Sc(this))},n.Na=function(x){this.g&&(this.response=x,Sc(this))},n.ga=function(){this.g&&Sc(this)};function Sc(x){x.readyState=4,x.l=null,x.j=null,x.B=null,Ka(x)}n.setRequestHeader=function(x,C){this.A.append(x,C)},n.getResponseHeader=function(x){return this.h&&this.h.get(x.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const x=[],C=this.h.entries();for(var F=C.next();!F.done;)F=F.value,x.push(F[0]+": "+F[1]),F=C.next();return x.join(`\r
`)};function Ka(x){x.onreadystatechange&&x.onreadystatechange.call(x)}Object.defineProperty(Ys.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(x){this.m=x?"include":"same-origin"}});function a1(x){let C="";return Me(x,function(F,H){C+=H,C+=":",C+=F,C+=`\r
`}),C}function $d(x,C,F){e:{for(H in F){var H=!1;break e}H=!0}H||(F=a1(F),typeof x=="string"?F!=null&&Rn(F):Mn(x,C,F))}function sr(x){hn.call(this),this.headers=new Map,this.L=x||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(sr,hn);var o1=/^https?$/i,OE=["POST","PUT"];n=sr.prototype,n.Fa=function(x){this.H=x},n.ea=function(x,C,F,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+x);C=C?C.toUpperCase():"GET",this.D=x,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():yt.g(),this.g.onreadystatechange=m(c(this.Ca,this));try{this.B=!0,this.g.open(C,String(x),!0),this.B=!1}catch(ke){Tc(this,ke);return}if(x=F||"",F=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var me in H)F.set(me,H[me]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const ke of H.keys())F.set(ke,H.get(ke));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(F.keys()).find(ke=>ke.toLowerCase()=="content-type"),me=a.FormData&&x instanceof a.FormData,!(Array.prototype.indexOf.call(OE,C,void 0)>=0)||H||me||F.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ke,ot]of F)this.g.setRequestHeader(ke,ot);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(x),this.v=!1}catch(ke){Tc(this,ke)}};function Tc(x,C){x.h=!1,x.g&&(x.j=!0,x.g.abort(),x.j=!1),x.l=C,x.o=5,bc(x),El(x)}function bc(x){x.A||(x.A=!0,cn(x,"complete"),cn(x,"error"))}n.abort=function(x){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=x||7,cn(this,"complete"),cn(this,"abort"),El(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),El(this,!0)),sr.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?wl(this):this.Xa())},n.Xa=function(){wl(this)};function wl(x){if(x.h&&typeof s<"u"){if(x.v&&No(x)==4)setTimeout(x.Ca.bind(x),0);else if(cn(x,"readystatechange"),No(x)==4){x.h=!1;try{const ke=x.ca();e:switch(ke){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var C=!0;break e;default:C=!1}var F;if(!(F=C)){var H;if(H=ke===0){let ot=String(x.D).match(wc)[1]||null;!ot&&a.self&&a.self.location&&(ot=a.self.location.protocol.slice(0,-1)),H=!o1.test(ot?ot.toLowerCase():"")}F=H}if(F)cn(x,"complete"),cn(x,"success");else{x.o=6;try{var me=No(x)>2?x.g.statusText:""}catch{me=""}x.l=me+" ["+x.ca()+"]",bc(x)}}finally{El(x)}}}}function El(x,C){if(x.g){x.m&&(clearTimeout(x.m),x.m=null);const F=x.g;x.g=null,C||cn(x,"ready");try{F.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function No(x){return x.g?x.g.readyState:0}n.ca=function(){try{return No(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(x){if(this.g){var C=this.g.responseText;return x&&C.indexOf(x)==0&&(C=C.substring(x.length)),Et(C)}};function l1(x){try{if(!x.g)return null;if("response"in x.g)return x.g.response;switch(x.F){case"":case"text":return x.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in x.g)return x.g.mozResponseArrayBuffer}return null}catch{return null}}function Ag(x){const C={};x=(x.g&&No(x)>=2&&x.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<x.length;H++){if(j(x[H]))continue;var F=B(x[H]);const me=F[0];if(F=F[1],typeof F!="string")continue;F=F.trim();const ke=C[me]||[];C[me]=ke,ke.push(F)}Te(C,function(H){return H.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Lo(x,C,F){return F&&F.internalChannelParams&&F.internalChannelParams[x]||C}function Wd(x){this.za=0,this.i=[],this.j=new ee,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Lo("failFast",!1,x),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Lo("baseRetryDelayMs",5e3,x),this.Za=Lo("retryDelaySeedMs",1e4,x),this.Ta=Lo("forwardChannelMaxRetries",2,x),this.va=Lo("forwardChannelRequestTimeoutMs",2e4,x),this.ma=x&&x.xmlHttpFactory||void 0,this.Ua=x&&x.Rb||void 0,this.Aa=x&&x.useFetchStreams||!1,this.O=void 0,this.L=x&&x.supportsCrossDomainXhr||!1,this.M="",this.h=new Vn(x&&x.concurrentRequestLimit),this.Ba=new nh,this.S=x&&x.fastHandshake||!1,this.R=x&&x.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=x&&x.Pb||!1,x&&x.ua&&this.j.ua(),x&&x.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&x&&x.detectBufferingProxy||!1,this.ia=void 0,x&&x.longPollingTimeout&&x.longPollingTimeout>0&&(this.ia=x.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Wd.prototype,n.ka=8,n.I=1,n.connect=function(x,C,F,H){ct(0),this.W=x,this.H=C||{},F&&H!==void 0&&(this.H.OSID=F,this.H.OAID=H),this.F=this.X,this.J=Ig(this,null,this.W),Sl(this)};function Hd(x){if(Kd(x),x.I==3){var C=x.V++,F=xa(x.J);if(Mn(F,"SID",x.M),Mn(F,"RID",C),Mn(F,"TYPE","terminate"),Oo(x,F),C=new Y(x,x.j,C),C.M=2,C.A=_l(xa(F)),F=!1,a.navigator&&a.navigator.sendBeacon)try{F=a.navigator.sendBeacon(C.A.toString(),"")}catch{}!F&&a.Image&&(new Image().src=C.A,F=!0),F||(C.g=u1(C.j,null),C.g.ea(C.A)),C.F=Date.now(),be(C)}sh(x)}function Zs(x){x.g&&(ih(x),x.g.cancel(),x.g=null)}function Kd(x){Zs(x),x.v&&(a.clearTimeout(x.v),x.v=null),Xd(x),x.h.cancel(),x.m&&(typeof x.m=="number"&&a.clearTimeout(x.m),x.m=null)}function Sl(x){if(!$n(x.h)&&!x.m){x.m=!0;var C=x.Ea;D||A(),W||(D(),W=!0),I.add(C,x),x.D=0}}function c1(x,C){return pr(x.h)>=x.h.j-(x.m?1:0)?!1:x.m?(x.i=C.G.concat(x.i),!0):x.I==1||x.I==2||x.D>=(x.Sa?0:x.Ta)?!1:(x.m=re(c(x.Ea,x,C),Yd(x,x.D)),x.D++,!0)}n.Ea=function(x){if(this.m)if(this.m=null,this.I==1){if(!x){this.V=Math.floor(Math.random()*1e5),x=this.V++;const me=new Y(this,this.j,x);let ke=this.o;if(this.U&&(ke?(ke=ie(ke),Z(ke,this.U)):ke=this.U),this.u!==null||this.R||(me.J=ke,ke=null),this.S)e:{for(var C=0,F=0;F<this.i.length;F++){t:{var H=this.i[F];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(C+=H,C>4096){C=F;break e}if(C===4096||F===this.i.length-1){C=F+1;break e}}C=1e3}else C=1e3;C=kg(this,me,C),F=xa(this.J),Mn(F,"RID",x),Mn(F,"CVER",22),this.G&&Mn(F,"X-HTTP-Session-Id",this.G),Oo(this,F),ke&&(this.R?C="headers="+Rn(a1(ke))+"&"+C:this.u&&$d(F,this.u,ke)),ya(this.h,me),this.Ra&&Mn(F,"TYPE","init"),this.S?(Mn(F,"$req",C),Mn(F,"SID","null"),me.U=!0,Q(me,F,null)):Q(me,F,C),this.I=2}}else this.I==3&&(x?rh(this,x):this.i.length==0||$n(this.h)||rh(this))};function rh(x,C){var F;C?F=C.l:F=x.V++;const H=xa(x.J);Mn(H,"SID",x.M),Mn(H,"RID",F),Mn(H,"AID",x.K),Oo(x,H),x.u&&x.o&&$d(H,x.u,x.o),F=new Y(x,x.j,F,x.D+1),x.u===null&&(F.J=x.o),C&&(x.i=C.G.concat(x.i)),C=kg(x,F,1e3),F.H=Math.round(x.va*.5)+Math.round(x.va*.5*Math.random()),ya(x.h,F),Q(F,H,C)}function Oo(x,C){x.H&&Me(x.H,function(F,H){Mn(C,H,F)}),x.l&&Me({},function(F,H){Mn(C,H,F)})}function kg(x,C,F){F=Math.min(x.i.length,F);const H=x.l?c(x.l.Ka,x.l,x):null;e:{var me=x.i;let nn=-1;for(;;){const zr=["count="+F];nn==-1?F>0?(nn=me[0].g,zr.push("ofs="+nn)):nn=0:zr.push("ofs="+nn);let Wn=!0;for(let Kr=0;Kr<F;Kr++){var ke=me[Kr].g;const Qs=me[Kr].map;if(ke-=nn,ke<0)nn=Math.max(0,me[Kr].g-100),Wn=!1;else try{ke="req"+ke+"_"||"";try{var ot=Qs instanceof Map?Qs:Object.entries(Qs);for(const[Tl,Fo]of ot){let jo=Fo;o(Fo)&&(jo=bn(Fo)),zr.push(ke+Tl+"="+encodeURIComponent(jo))}}catch(Tl){throw zr.push(ke+"type="+encodeURIComponent("_badmap")),Tl}}catch{H&&H(Qs)}}if(Wn){ot=zr.join("&");break e}}ot=void 0}return x=x.i.splice(0,F),C.G=x,ot}function qi(x){if(!x.g&&!x.v){x.Y=1;var C=x.Da;D||A(),W||(D(),W=!0),I.add(C,x),x.A=0}}function Do(x){return x.g||x.v||x.A>=3?!1:(x.Y++,x.v=re(c(x.Da,x),Yd(x,x.A)),x.A++,!0)}n.Da=function(){if(this.v=null,Rc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var x=4*this.T;this.j.info("BP detection timer enabled: "+x),this.B=re(c(this.Wa,this),x)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ct(10),Zs(this),Rc(this))};function ih(x){x.B!=null&&(a.clearTimeout(x.B),x.B=null)}function Rc(x){x.g=new Y(x,x.j,"rpc",x.Y),x.u===null&&(x.g.J=x.o),x.g.P=0;var C=xa(x.na);Mn(C,"RID","rpc"),Mn(C,"SID",x.M),Mn(C,"AID",x.K),Mn(C,"CI",x.F?"0":"1"),!x.F&&x.ia&&Mn(C,"TO",x.ia),Mn(C,"TYPE","xmlhttp"),Oo(x,C),x.u&&x.o&&$d(C,x.u,x.o),x.O&&(x.g.H=x.O);var F=x.g;x=x.ba,F.M=1,F.A=_l(xa(C)),F.u=null,F.R=!0,ve(F,x)}n.Va=function(){this.C!=null&&(this.C=null,Zs(this),Do(this),ct(19))};function Xd(x){x.C!=null&&(a.clearTimeout(x.C),x.C=null)}function qd(x,C){var F=null;if(x.g==C){Xd(x),ih(x),x.g=null;var H=2}else if(Ha(x.h,C))F=C.G,qs(x.h,C),H=1;else return;if(x.I!=0){if(C.o)if(H==1){F=C.u?C.u.length:0,C=Date.now()-C.F;var me=x.D;H=ye(),cn(H,new U(H,F)),Sl(x)}else qi(x);else if(me=C.m,me==3||me==0&&C.X>0||!(H==1&&c1(x,C)||H==2&&Do(x)))switch(F&&F.length>0&&(C=x.h,C.i=C.i.concat(F)),me){case 1:Js(x,5);break;case 4:Js(x,10);break;case 3:Js(x,6);break;default:Js(x,2)}}}function Yd(x,C){let F=x.Qa+Math.floor(Math.random()*x.Za);return x.isActive()||(F*=2),F*C}function Js(x,C){if(x.j.info("Error code "+C),C==2){var F=c(x.bb,x),H=x.Ua;const me=!H;H=new Ao(H||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ju(H,"https"),_l(H),me?Po(H.toString(),F):Mo(H.toString(),F)}else ct(2);x.I=0,x.l&&x.l.pa(C),sh(x),Kd(x)}n.bb=function(x){x?(this.j.info("Successfully pinged google.com"),ct(2)):(this.j.info("Failed to ping google.com"),ct(1))};function sh(x){if(x.I=0,x.ja=[],x.l){const C=Gr(x.h);(C.length!=0||x.i.length!=0)&&(v(x.ja,C),v(x.ja,x.i),x.h.i.length=0,y(x.i),x.i.length=0),x.l.oa()}}function Ig(x,C,F){var H=F instanceof Ao?xa(F):new Ao(F);if(H.g!="")C&&(H.g=C+"."+H.g),ko(H,H.u);else{var me=a.location;H=me.protocol,C=C?C+"."+me.hostname:me.hostname,me=+me.port;const ke=new Ao(null);H&&Ju(ke,H),C&&(ke.g=C),me&&ko(ke,me),F&&(ke.h=F),H=ke}return F=x.G,C=x.wa,F&&C&&Mn(H,F,C),Mn(H,"VER",x.ka),Oo(x,H),H}function u1(x,C,F){if(C&&!x.L)throw Error("Can't create secondary domain capable XhrIo object.");return C=x.Aa&&!x.ma?new sr(new vl({ab:F})):new sr(x.ma),C.Fa(x.L),C}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function h1(){}n=h1.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Zd(){}Zd.prototype.g=function(x,C){return new Ni(x,C)};function Ni(x,C){hn.call(this),this.g=new Wd(C),this.l=x,this.h=C&&C.messageUrlParams||null,x=C&&C.messageHeaders||null,C&&C.clientProtocolHeaderRequired&&(x?x["X-Client-Protocol"]="webchannel":x={"X-Client-Protocol":"webchannel"}),this.g.o=x,x=C&&C.initMessageHeaders||null,C&&C.messageContentType&&(x?x["X-WebChannel-Content-Type"]=C.messageContentType:x={"X-WebChannel-Content-Type":C.messageContentType}),C&&C.sa&&(x?x["X-WebChannel-Client-Profile"]=C.sa:x={"X-WebChannel-Client-Profile":C.sa}),this.g.U=x,(x=C&&C.Qb)&&!j(x)&&(this.g.u=x),this.A=C&&C.supportsCrossDomainXhr||!1,this.v=C&&C.sendRawJson||!1,(C=C&&C.httpSessionIdParam)&&!j(C)&&(this.g.G=C,x=this.h,x!==null&&C in x&&(x=this.h,C in x&&delete x[C])),this.j=new Ac(this)}g(Ni,hn),Ni.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ni.prototype.close=function(){Hd(this.g)},Ni.prototype.o=function(x){var C=this.g;if(typeof x=="string"){var F={};F.__data__=x,x=F}else this.v&&(F={},F.__data__=bn(x),x=F);C.i.push(new Ht(C.Ya++,x)),C.I==3&&Sl(C)},Ni.prototype.N=function(){this.g.l=null,delete this.j,Hd(this.g),delete this.g,Ni.Z.N.call(this)};function d1(x){oi.call(this),x.__headers__&&(this.headers=x.__headers__,this.statusCode=x.__status__,delete x.__headers__,delete x.__status__);var C=x.__sm__;if(C){e:{for(const F in C){x=F;break e}x=void 0}(this.i=x)&&(x=this.i,C=C!==null&&x in C?C[x]:void 0),this.data=C}else this.data=x}g(d1,oi);function f1(){tn.call(this),this.status=1}g(f1,tn);function Ac(x){this.g=x}g(Ac,h1),Ac.prototype.ra=function(){cn(this.g,"a")},Ac.prototype.qa=function(x){cn(this.g,new d1(x))},Ac.prototype.pa=function(x){cn(this.g,new f1)},Ac.prototype.oa=function(){cn(this.g,"b")},Zd.prototype.createWebChannel=Zd.prototype.g,Ni.prototype.send=Ni.prototype.o,Ni.prototype.open=Ni.prototype.m,Ni.prototype.close=Ni.prototype.close,t6=function(){return new Zd},e6=function(){return ye()},Qj=Tr,Ib={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Je.NO_ERROR=0,Je.TIMEOUT=8,Je.HTTP_ERROR=6,r_=Je,Qe.COMPLETE="complete",Jj=Qe,Xi.EventType=Mr,Mr.OPEN="a",Mr.CLOSE="b",Mr.ERROR="c",Mr.MESSAGE="d",hn.prototype.listen=hn.prototype.J,wm=Xi,sr.prototype.listenOnce=sr.prototype.K,sr.prototype.getLastError=sr.prototype.Ha,sr.prototype.getLastErrorCode=sr.prototype.ya,sr.prototype.getStatus=sr.prototype.ca,sr.prototype.getResponseJson=sr.prototype.La,sr.prototype.getResponseText=sr.prototype.la,sr.prototype.send=sr.prototype.ea,sr.prototype.setWithCredentials=sr.prototype.Fa,Zj=sr}).apply(typeof Ex<"u"?Ex:typeof self<"u"?self:typeof window<"u"?window:{});const DN="@firebase/firestore",FN="4.9.3";let zi=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};zi.UNAUTHENTICATED=new zi(null),zi.GOOGLE_CREDENTIALS=new zi("google-credentials-uid"),zi.FIRST_PARTY=new zi("first-party-uid"),zi.MOCK_USER=new zi("mock-user");let og="12.7.0";const dd=new zA("@firebase/firestore");function $f(){return dd.logLevel}function et(n,...e){if(dd.logLevel<=yn.DEBUG){const t=e.map(ek);dd.debug(`Firestore (${og}): ${n}`,...t)}}function vs(n,...e){if(dd.logLevel<=yn.ERROR){const t=e.map(ek);dd.error(`Firestore (${og}): ${n}`,...t)}}function fd(n,...e){if(dd.logLevel<=yn.WARN){const t=e.map(ek);dd.warn(`Firestore (${og}): ${n}`,...t)}}function ek(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function kt(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,n6(n,r,t)}function n6(n,e,t){let r=`FIRESTORE (${og}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw vs(r),new Error(r)}function Lt(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||n6(e,i,r)}function en(n,e){return n}const De={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ut extends yl{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class rl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class r6{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class oQ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(zi.UNAUTHENTICATED)))}shutdown(){}}class lQ{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class cQ{constructor(e){this.t=e,this.currentUser=zi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Lt(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new rl;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new rl,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const l=s;e.enqueueRetryable((async()=>{await l.promise,await i(this.currentUser)}))},o=l=>{et("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>o(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(et("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new rl)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(et("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Lt(typeof r.accessToken=="string",31837,{l:r}),new r6(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Lt(e===null||typeof e=="string",2055,{h:e}),new zi(e)}}class uQ{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=zi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class hQ{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new uQ(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(zi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class jN{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dQ{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ca(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Lt(this.o===void 0,3512);const r=s=>{s.error!=null&&et("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,et("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{et("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):et("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new jN(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Lt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new jN(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function fQ(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class tk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=fQ(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function Qt(n,e){return n<e?-1:n>e?1:0}function Cb(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return QS(i)===QS(s)?Qt(i,s):QS(i)?1:-1}return Qt(n.length,e.length)}const gQ=55296,mQ=57343;function QS(n){const e=n.charCodeAt(0);return e>=gQ&&e<=mQ}function L0(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function i6(n){return n+"\0"}const VN="__name__";class Ko{constructor(e,t,r){t===void 0?t=0:t>e.length&&kt(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&kt(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ko.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ko?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=Ko.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Qt(e.length,t.length)}static compareSegments(e,t){const r=Ko.isNumericId(e),i=Ko.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Ko.extractNumericId(e).compare(Ko.extractNumericId(t)):Cb(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Tu.fromString(e.substring(4,e.length-2))}}class Fn extends Ko{construct(e,t,r){return new Fn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ut(De.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Fn(t)}static emptyPath(){return new Fn([])}}const pQ=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Cr extends Ko{construct(e,t,r){return new Cr(e,t,r)}static isValidIdentifier(e){return pQ.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Cr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===VN}static keyField(){return new Cr([VN])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ut(De.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new ut(De.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ut(De.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(r+=o,i++):(s(),i++)}if(s(),a)throw new ut(De.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Cr(t)}static emptyPath(){return new Cr([])}}class ft{constructor(e){this.path=e}static fromPath(e){return new ft(Fn.fromString(e))}static fromName(e){return new ft(Fn.fromString(e).popFirst(5))}static empty(){return new ft(Fn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Fn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Fn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ft(new Fn(e.slice()))}}function s6(n,e,t){if(!t)throw new ut(De.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function yQ(n,e,t,r){if(e===!0&&r===!0)throw new ut(De.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function BN(n){if(!ft.isDocumentKey(n))throw new ut(De.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function GN(n){if(ft.isDocumentKey(n))throw new ut(De.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function a6(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Vw(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":kt(12329,{type:typeof n})}function za(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ut(De.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Vw(n);throw new ut(De.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ei(n,e){const t={typeString:n};return e&&(t.value=e),t}function Cy(n,e){if(!a6(n))throw new ut(De.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new ut(De.INVALID_ARGUMENT,t);return!0}const zN=-62135596800,UN=1e6;class Xn{static now(){return Xn.fromMillis(Date.now())}static fromDate(e){return Xn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*UN);return new Xn(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ut(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ut(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<zN)throw new ut(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ut(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/UN}_compareTo(e){return this.seconds===e.seconds?Qt(this.nanoseconds,e.nanoseconds):Qt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Xn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Cy(e,Xn._jsonSchema))return new Xn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-zN;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Xn._jsonSchemaVersion="firestore/timestamp/1.0",Xn._jsonSchema={type:ei("string",Xn._jsonSchemaVersion),seconds:ei("number"),nanoseconds:ei("number")};class Ft{static fromTimestamp(e){return new Ft(e)}static min(){return new Ft(new Xn(0,0))}static max(){return new Ft(new Xn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Cp=-1;class iv{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Pb(n){return n.fields.find((e=>e.kind===2))}function Rh(n){return n.fields.filter((e=>e.kind!==2))}iv.UNKNOWN_ID=-1;class i_{constructor(e,t){this.fieldPath=e,this.kind=t}}class Pp{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Pp(0,ga.min())}}function xQ(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ft.fromTimestamp(r===1e9?new Xn(t+1,0):new Xn(t,r));return new ga(i,ft.empty(),e)}function o6(n){return new ga(n.readTime,n.key,Cp)}class ga{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ga(Ft.min(),ft.empty(),Cp)}static max(){return new ga(Ft.max(),ft.empty(),Cp)}}function nk(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ft.comparator(n.documentKey,e.documentKey),t!==0?t:Qt(n.largestBatchId,e.largestBatchId))}const l6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class c6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Nd(n){if(n.code!==De.FAILED_PRECONDITION||n.message!==l6)throw n;et("LocalStore","Unexpectedly lost primary lease")}class fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&kt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new fe(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof fe?t:fe.resolve(t)}catch(t){return fe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):fe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):fe.reject(t)}static resolve(e){return new fe(((t,r)=>{t(e)}))}static reject(e){return new fe(((t,r)=>{r(e)}))}static waitFor(e){return new fe(((t,r)=>{let i=0,s=0,a=!1;e.forEach((o=>{++i,o.next((()=>{++s,a&&s===i&&t()}),(l=>r(l)))})),a=!0,s===i&&t()}))}static or(e){let t=fe.resolve(!1);for(const r of e)t=t.next((i=>i?fe.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new fe(((r,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;t(e[c]).next((h=>{a[c]=h,++o,o===s&&r(a)}),(h=>i(h)))}}))}static doWhile(e,t){return new fe(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}const ia="SimpleDb";class Bw{static open(e,t,r,i){try{return new Bw(t,e.transaction(i,r))}catch(s){throw new jm(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new rl,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new jm(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=rk(r.target.error);this.S.reject(new jm(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(et(ia,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new vQ(t)}}class bu{static delete(e){return et(ia,"Removing database:",e),Mh(nj().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!hj())return!1;if(bu.F())return!0;const e=mi(),t=bu.M(e),r=0<t&&t<10,i=u6(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,bu.M(mi())===12.2&&vs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(et(ia,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new jm(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new ut(De.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new ut(De.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new jm(e,a))},i.onupgradeneeded=s=>{et(ia,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.N.k(a,i.transaction,s.oldVersion,this.version).next((()=>{et(ia,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.L(e);const o=Bw.open(this.db,e,s?"readonly":"readwrite",r),l=i(o).next((c=>(o.C(),c))).catch((c=>(o.abort(c),fe.reject(c)))).toPromise();return l.catch((()=>{})),await o.D,l}catch(o){const l=o,c=l.name!=="FirebaseError"&&a<3;if(et(ia,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function u6(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class _Q{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Mh(this.U.delete())}}class jm extends ut{constructor(e,t){super(De.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Wu(n){return n.name==="IndexedDbTransactionError"}class vQ{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(et(ia,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(et(ia,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Mh(r)}add(e){return et(ia,"ADD",this.store.name,e,e),Mh(this.store.add(e))}get(e){return Mh(this.store.get(e)).next((t=>(t===void 0&&(t=null),et(ia,"GET",this.store.name,e,t),t)))}delete(e){return et(ia,"DELETE",this.store.name,e),Mh(this.store.delete(e))}count(){return et(ia,"COUNT",this.store.name),Mh(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new fe(((a,o)=>{s.onerror=l=>{o(l.target.error)},s.onsuccess=l=>{a(l.target.result)}}))}{const s=this.cursor(r),a=[];return this.H(s,((o,l)=>{a.push(l)})).next((()=>a))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new fe(((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}}))}Z(e,t){et(ia,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((s,a,o)=>o.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new fe(((r,i)=>{t.onerror=s=>{const a=rk(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next((o=>{o?a.continue():r()})):r()}}))}H(e,t){const r=[];return new fe(((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const o=a.target.result;if(!o)return void i();const l=new _Q(o),c=t(o.primaryKey,o.value,l);if(c instanceof fe){const h=c.catch((g=>(l.done(),fe.reject(g))));r.push(h)}l.isDone?i():l.G===null?o.continue():o.continue(l.G)}})).next((()=>fe.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Mh(n){return new fe(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=rk(r.target.error);t(i)}}))}let $N=!1;function rk(n){const e=bu.M(mi());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new ut("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return $N||($N=!0,setTimeout((()=>{throw r}),0)),r}}return n}const Vm="IndexBackfiller";class wQ{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){et(Vm,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();et(Vm,`Documents written: ${t}`)}catch(t){Wu(t)?et(Vm,"Ignoring IndexedDB error during index backfill: ",t):await Nd(t)}await this.re(6e4)}))}}class EQ{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,s=!0;return fe.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((a=>{if(a!==null&&!r.has(a))return et(Vm,`Processing collection: ${a}`),this.oe(e,a,i).next((o=>{i-=o,r.add(a)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next((()=>this._e(i,s))).next((o=>(et(Vm,`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,t,o)))).next((()=>a.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{const a=o6(s);nk(a,r)>0&&(r=a)})),new ga(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Oa{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Oa.ce=-1;const qh=-1;function Gw(n){return n==null}function Mp(n){return n===0&&1/n==-1/0}function SQ(n){return typeof n=="number"&&Number.isInteger(n)&&!Mp(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const sv="";function cs(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=WN(e)),e=TQ(n.get(t),e);return WN(e)}function TQ(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case sv:t+="";break;default:t+=s}}return t}function WN(n){return n+sv+""}function Jo(n){const e=n.length;if(Lt(e>=2,64408,{path:n}),e===2)return Lt(n.charAt(0)===sv&&n.charAt(1)==="",56145,{path:n}),Fn.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf(sv,s);switch((a<0||a>t)&&kt(50515,{path:n}),n.charAt(a+1)){case"":const o=n.substring(s,a);let l;i.length===0?l=o:(i+=o,l=i,i=""),r.push(l);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:kt(61167,{path:n})}s=a+2}return new Fn(r)}const Ah="remoteDocuments",Py="owner",Cf="owner",Np="mutationQueues",bQ="userId",ao="mutations",HN="batchId",zh="userMutationsIndex",KN=["userId","batchId"];function s_(n,e){return[n,cs(e)]}function h6(n,e,t){return[n,cs(e),t]}const RQ={},O0="documentMutations",av="remoteDocumentsV14",AQ=["prefixPath","collectionGroup","readTime","documentId"],a_="documentKeyIndex",kQ=["prefixPath","collectionGroup","documentId"],d6="collectionGroupIndex",IQ=["collectionGroup","readTime","prefixPath","documentId"],Lp="remoteDocumentGlobal",Mb="remoteDocumentGlobalKey",D0="targets",f6="queryTargetsIndex",CQ=["canonicalId","targetId"],F0="targetDocuments",PQ=["targetId","path"],ik="documentTargetsIndex",MQ=["path","targetId"],ov="targetGlobalKey",Yh="targetGlobal",Op="collectionParents",NQ=["collectionId","parent"],j0="clientMetadata",LQ="clientId",zw="bundles",OQ="bundleId",Uw="namedQueries",DQ="name",sk="indexConfiguration",FQ="indexId",Nb="collectionGroupIndex",jQ="collectionGroup",Bm="indexState",VQ=["indexId","uid"],g6="sequenceNumberIndex",BQ=["uid","sequenceNumber"],Gm="indexEntries",GQ=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],m6="documentKeyIndex",zQ=["indexId","uid","orderedDocumentKey"],$w="documentOverlays",UQ=["userId","collectionPath","documentId"],Lb="collectionPathOverlayIndex",$Q=["userId","collectionPath","largestBatchId"],p6="collectionGroupOverlayIndex",WQ=["userId","collectionGroup","largestBatchId"],ak="globals",HQ="name",y6=[Np,ao,O0,Ah,D0,Py,Yh,F0,j0,Lp,Op,zw,Uw],KQ=[...y6,$w],x6=[Np,ao,O0,av,D0,Py,Yh,F0,j0,Lp,Op,zw,Uw,$w],_6=x6,ok=[..._6,sk,Bm,Gm],XQ=ok,v6=[...ok,ak],qQ=v6;class Ob extends c6{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function yi(n,e){const t=en(n);return bu.O(t.le,e)}function XN(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Hu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function w6(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Er{constructor(e,t){this.comparator=e,this.root=t||Ui.EMPTY}insert(e,t){return new Er(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ui.BLACK,null,null))}remove(e){return new Er(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ui.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Sx(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Sx(this.root,e,this.comparator,!1)}getReverseIterator(){return new Sx(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Sx(this.root,e,this.comparator,!0)}}class Sx{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ui{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Ui.RED,this.left=i??Ui.EMPTY,this.right=s??Ui.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Ui(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ui.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Ui.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ui.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ui.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw kt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw kt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw kt(27949);return e+(this.isRed()?0:1)}}Ui.EMPTY=null,Ui.RED=!0,Ui.BLACK=!1;Ui.EMPTY=new class{constructor(){this.size=0}get key(){throw kt(57766)}get value(){throw kt(16141)}get color(){throw kt(16727)}get left(){throw kt(29726)}get right(){throw kt(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Ui(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Jn{constructor(e){this.comparator=e,this.data=new Er(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new qN(this.data.getIterator())}getIteratorFrom(e){return new qN(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Jn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Jn(this.comparator);return t.data=e,t}}class qN{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Pf(n){return n.hasNext()?n.getNext():void 0}class Vs{constructor(e){this.fields=e,e.sort(Cr.comparator)}static empty(){return new Vs([])}unionWith(e){let t=new Jn(Cr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Vs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return L0(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class E6 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ri{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new E6("Invalid base64 string: "+s):s}})(e);return new ri(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new ri(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Qt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ri.EMPTY_BYTE_STRING=new ri("");const YQ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sc(n){if(Lt(!!n,39018),typeof n=="string"){let e=0;const t=YQ.exec(n);if(Lt(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:xr(n.seconds),nanos:xr(n.nanos)}}function xr(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ac(n){return typeof n=="string"?ri.fromBase64String(n):ri.fromUint8Array(n)}const S6="server_timestamp",T6="__type__",b6="__previous_value__",R6="__local_write_time__";function lk(n){return(n?.mapValue?.fields||{})[T6]?.stringValue===S6}function Ww(n){const e=n.mapValue.fields[b6];return lk(e)?Ww(e):e}function Dp(n){const e=sc(n.mapValue.fields[R6].timestampValue);return new Xn(e.seconds,e.nanos)}class ZQ{constructor(e,t,r,i,s,a,o,l,c,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const lv="(default)";class gd{constructor(e,t){this.projectId=e,this.database=t||lv}static empty(){return new gd("","")}get isDefaultDatabase(){return this.database===lv}isEqual(e){return e instanceof gd&&e.projectId===this.projectId&&e.database===this.database}}const ck="__type__",A6="__max__",fu={mapValue:{fields:{__type__:{stringValue:A6}}}},uk="__vector__",V0="value",o_={nullValue:"NULL_VALUE"};function Mu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?lk(n)?4:k6(n)?9007199254740991:Hw(n)?10:11:kt(28295,{value:n})}function hl(n,e){if(n===e)return!0;const t=Mu(n);if(t!==Mu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Dp(n).isEqual(Dp(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=sc(i.timestampValue),o=sc(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return ac(i.bytesValue).isEqual(ac(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return xr(i.geoPointValue.latitude)===xr(s.geoPointValue.latitude)&&xr(i.geoPointValue.longitude)===xr(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return xr(i.integerValue)===xr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=xr(i.doubleValue),o=xr(s.doubleValue);return a===o?Mp(a)===Mp(o):isNaN(a)&&isNaN(o)}return!1})(n,e);case 9:return L0(n.arrayValue.values||[],e.arrayValue.values||[],hl);case 10:case 11:return(function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(XN(a)!==XN(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!hl(a[l],o[l])))return!1;return!0})(n,e);default:return kt(52216,{left:n})}}function Fp(n,e){return(n.values||[]).find((t=>hl(t,e)))!==void 0}function Nu(n,e){if(n===e)return 0;const t=Mu(n),r=Mu(e);if(t!==r)return Qt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Qt(n.booleanValue,e.booleanValue);case 2:return(function(s,a){const o=xr(s.integerValue||s.doubleValue),l=xr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1})(n,e);case 3:return YN(n.timestampValue,e.timestampValue);case 4:return YN(Dp(n),Dp(e));case 5:return Cb(n.stringValue,e.stringValue);case 6:return(function(s,a){const o=ac(s),l=ac(a);return o.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const h=Qt(o[c],l[c]);if(h!==0)return h}return Qt(o.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,a){const o=Qt(xr(s.latitude),xr(a.latitude));return o!==0?o:Qt(xr(s.longitude),xr(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return ZN(n.arrayValue,e.arrayValue);case 10:return(function(s,a){const o=s.fields||{},l=a.fields||{},c=o[V0]?.arrayValue,h=l[V0]?.arrayValue,g=Qt(c?.values?.length||0,h?.values?.length||0);return g!==0?g:ZN(c,h)})(n.mapValue,e.mapValue);case 11:return(function(s,a){if(s===fu.mapValue&&a===fu.mapValue)return 0;if(s===fu.mapValue)return 1;if(a===fu.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let g=0;g<l.length&&g<h.length;++g){const m=Cb(l[g],h[g]);if(m!==0)return m;const y=Nu(o[l[g]],c[h[g]]);if(y!==0)return y}return Qt(l.length,h.length)})(n.mapValue,e.mapValue);default:throw kt(23264,{he:t})}}function YN(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Qt(n,e);const t=sc(n),r=sc(e),i=Qt(t.seconds,r.seconds);return i!==0?i:Qt(t.nanos,r.nanos)}function ZN(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Nu(t[i],r[i]);if(s)return s}return Qt(t.length,r.length)}function B0(n){return Db(n)}function Db(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=sc(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ac(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ft.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=Db(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${Db(t.fields[a])}`;return i+"}"})(n.mapValue):kt(61005,{value:n})}function l_(n){switch(Mu(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ww(n);return e?16+l_(e):16;case 5:return 2*n.stringValue.length;case 6:return ac(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+l_(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Hu(r.fields,((s,a)=>{i+=s.length+l_(a)})),i})(n.mapValue);default:throw kt(13486,{value:n})}}function jp(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Fb(n){return!!n&&"integerValue"in n}function Vp(n){return!!n&&"arrayValue"in n}function JN(n){return!!n&&"nullValue"in n}function QN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function c_(n){return!!n&&"mapValue"in n}function Hw(n){return(n?.mapValue?.fields||{})[ck]?.stringValue===uk}function zm(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Hu(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=zm(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=zm(n.arrayValue.values[t]);return e}return{...n}}function k6(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===A6}const I6={mapValue:{fields:{[ck]:{stringValue:uk},[V0]:{arrayValue:{}}}}};function JQ(n){return"nullValue"in n?o_:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?jp(gd.empty(),ft.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Hw(n)?I6:{mapValue:{}}:kt(35942,{value:n})}function QQ(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?jp(gd.empty(),ft.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?I6:"mapValue"in n?Hw(n)?{mapValue:{}}:fu:kt(61959,{value:n})}function eL(n,e){const t=Nu(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function tL(n,e){const t=Nu(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class as{constructor(e){this.value=e}static empty(){return new as({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!c_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=zm(t)}setAll(e){let t=Cr.emptyPath(),r={},i=[];e.forEach(((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=o.popLast()}a?r[o.lastSegment()]=zm(a):i.push(o.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());c_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return hl(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];c_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Hu(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new as(zm(this.value))}}function C6(n){const e=[];return Hu(n.fields,((t,r)=>{const i=new Cr([t]);if(c_(r)){const s=C6(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)})),new Vs(e)}class Vr{constructor(e,t,r,i,s,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Vr(e,0,Ft.min(),Ft.min(),Ft.min(),as.empty(),0)}static newFoundDocument(e,t,r,i){return new Vr(e,1,t,Ft.min(),r,i,0)}static newNoDocument(e,t){return new Vr(e,2,t,Ft.min(),Ft.min(),as.empty(),0)}static newUnknownDocument(e,t){return new Vr(e,3,t,Ft.min(),Ft.min(),as.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ft.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=as.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=as.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ft.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class G0{constructor(e,t){this.position=e,this.inclusive=t}}function nL(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=ft.comparator(ft.fromName(a.referenceValue),t.key):r=Nu(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function rL(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!hl(n.position[t],e.position[t]))return!1;return!0}class cv{constructor(e,t="asc"){this.field=e,this.dir=t}}function eee(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class P6{}class xn extends P6{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new tee(e,t,r):t==="array-contains"?new iee(e,r):t==="in"?new F6(e,r):t==="not-in"?new see(e,r):t==="array-contains-any"?new aee(e,r):new xn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new nee(e,r):new ree(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Nu(t,this.value)):t!==null&&Mu(this.value)===Mu(t)&&this.matchesComparison(Nu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return kt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Yn extends P6{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Yn(e,t)}matches(e){return z0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function z0(n){return n.op==="and"}function jb(n){return n.op==="or"}function hk(n){return M6(n)&&z0(n)}function M6(n){for(const e of n.filters)if(e instanceof Yn)return!1;return!0}function Vb(n){if(n instanceof xn)return n.field.canonicalString()+n.op.toString()+B0(n.value);if(hk(n))return n.filters.map((e=>Vb(e))).join(",");{const e=n.filters.map((t=>Vb(t))).join(",");return`${n.op}(${e})`}}function N6(n,e){return n instanceof xn?(function(r,i){return i instanceof xn&&r.op===i.op&&r.field.isEqual(i.field)&&hl(r.value,i.value)})(n,e):n instanceof Yn?(function(r,i){return i instanceof Yn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,a,o)=>s&&N6(a,i.filters[o])),!0):!1})(n,e):void kt(19439)}function L6(n,e){const t=n.filters.concat(e);return Yn.create(t,n.op)}function O6(n){return n instanceof xn?(function(t){return`${t.field.canonicalString()} ${t.op} ${B0(t.value)}`})(n):n instanceof Yn?(function(t){return t.op.toString()+" {"+t.getFilters().map(O6).join(" ,")+"}"})(n):"Filter"}class tee extends xn{constructor(e,t,r){super(e,t,r),this.key=ft.fromName(r.referenceValue)}matches(e){const t=ft.comparator(e.key,this.key);return this.matchesComparison(t)}}class nee extends xn{constructor(e,t){super(e,"in",t),this.keys=D6("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class ree extends xn{constructor(e,t){super(e,"not-in",t),this.keys=D6("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function D6(n,e){return(e.arrayValue?.values||[]).map((t=>ft.fromName(t.referenceValue)))}class iee extends xn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Vp(t)&&Fp(t.arrayValue,this.value)}}class F6 extends xn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Fp(this.value.arrayValue,t)}}class see extends xn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Fp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Fp(this.value.arrayValue,t)}}class aee extends xn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Vp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Fp(this.value.arrayValue,r)))}}class oee{constructor(e,t=null,r=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Te=null}}function Bb(n,e=null,t=[],r=[],i=null,s=null,a=null){return new oee(n,e,t,r,i,s,a)}function md(n){const e=en(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Vb(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),Gw(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>B0(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>B0(r))).join(",")),e.Te=t}return e.Te}function My(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!eee(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!N6(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!rL(n.startAt,e.startAt)&&rL(n.endAt,e.endAt)}function uv(n){return ft.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function hv(n,e){return n.filters.filter((t=>t instanceof xn&&t.field.isEqual(e)))}function iL(n,e,t){let r=o_,i=!0;for(const s of hv(n,e)){let a=o_,o=!0;switch(s.op){case"<":case"<=":a=JQ(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,o=!1;break;case"!=":case"not-in":a=o_}eL({value:r,inclusive:i},{value:a,inclusive:o})<0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];eL({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function sL(n,e,t){let r=fu,i=!0;for(const s of hv(n,e)){let a=fu,o=!0;switch(s.op){case">=":case">":a=QQ(s.value),o=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,o=!1;break;case"!=":case"not-in":a=fu}tL({value:r,inclusive:i},{value:a,inclusive:o})>0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];tL({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class Ny{constructor(e,t=null,r=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function lee(n,e,t,r,i,s,a,o){return new Ny(n,e,t,r,i,s,a,o)}function Kw(n){return new Ny(n)}function aL(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function j6(n){return n.collectionGroup!==null}function Um(n){const e=en(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Jn(Cr.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(o=o.add(c.field))}))})),o})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new cv(s,r))})),t.has(Cr.keyField().canonicalString())||e.Ie.push(new cv(Cr.keyField(),r))}return e.Ie}function Fa(n){const e=en(n);return e.Ee||(e.Ee=cee(e,Um(n))),e.Ee}function cee(n,e){if(n.limitType==="F")return Bb(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new cv(i.field,s)}));const t=n.endAt?new G0(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new G0(n.startAt.position,n.startAt.inclusive):null;return Bb(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Gb(n,e){const t=n.filters.concat([e]);return new Ny(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function zb(n,e,t){return new Ny(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Xw(n,e){return My(Fa(n),Fa(e))&&n.limitType===e.limitType}function V6(n){return`${md(Fa(n))}|lt:${n.limitType}`}function Wf(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>O6(i))).join(", ")}]`),Gw(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>B0(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>B0(i))).join(",")),`Target(${r})`})(Fa(n))}; limitType=${n.limitType})`}function Ly(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ft.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of Um(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,o,l){const c=nL(a,o,l);return a.inclusive?c<=0:c<0})(r.startAt,Um(r),i)||r.endAt&&!(function(a,o,l){const c=nL(a,o,l);return a.inclusive?c>=0:c>0})(r.endAt,Um(r),i))})(n,e)}function uee(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function B6(n){return(e,t)=>{let r=!1;for(const i of Um(n)){const s=hee(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function hee(n,e,t){const r=n.field.isKeyField()?ft.comparator(e.key,t.key):(function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?Nu(l,c):kt(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return kt(19790,{direction:n.dir})}}class gc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Hu(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return w6(this.inner)}size(){return this.innerSize}}const dee=new Er(ft.comparator);function ha(){return dee}const G6=new Er(ft.comparator);function Em(...n){let e=G6;for(const t of n)e=e.insert(t.key,t);return e}function z6(n){let e=G6;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Qo(){return $m()}function U6(){return $m()}function $m(){return new gc((n=>n.toString()),((n,e)=>n.isEqual(e)))}const fee=new Er(ft.comparator),gee=new Jn(ft.comparator);function un(...n){let e=gee;for(const t of n)e=e.add(t);return e}const mee=new Jn(Qt);function pee(){return mee}function dk(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mp(e)?"-0":e}}function $6(n){return{integerValue:""+n}}function yee(n,e){return SQ(e)?$6(e):dk(n,e)}class qw{constructor(){this._=void 0}}function xee(n,e,t){return n instanceof U0?(function(i,s){const a={fields:{[T6]:{stringValue:S6},[R6]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&lk(s)&&(s=Ww(s)),s&&(a.fields[b6]=s),{mapValue:a}})(t,e):n instanceof $0?H6(n,e):n instanceof W0?K6(n,e):(function(i,s){const a=W6(i,s),o=oL(a)+oL(i.Ae);return Fb(a)&&Fb(i.Ae)?$6(o):dk(i.serializer,o)})(n,e)}function _ee(n,e,t){return n instanceof $0?H6(n,e):n instanceof W0?K6(n,e):t}function W6(n,e){return n instanceof Bp?(function(r){return Fb(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class U0 extends qw{}class $0 extends qw{constructor(e){super(),this.elements=e}}function H6(n,e){const t=X6(e);for(const r of n.elements)t.some((i=>hl(i,r)))||t.push(r);return{arrayValue:{values:t}}}class W0 extends qw{constructor(e){super(),this.elements=e}}function K6(n,e){let t=X6(e);for(const r of n.elements)t=t.filter((i=>!hl(i,r)));return{arrayValue:{values:t}}}class Bp extends qw{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function oL(n){return xr(n.integerValue||n.doubleValue)}function X6(n){return Vp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class q6{constructor(e,t){this.field=e,this.transform=t}}function vee(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof $0&&i instanceof $0||r instanceof W0&&i instanceof W0?L0(r.elements,i.elements,hl):r instanceof Bp&&i instanceof Bp?hl(r.Ae,i.Ae):r instanceof U0&&i instanceof U0})(n.transform,e.transform)}class wee{constructor(e,t){this.version=e,this.transformResults=t}}class os{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new os}static exists(e){return new os(void 0,e)}static updateTime(e){return new os(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function u_(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Yw{}function Y6(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Zw(n.key,os.none()):new lg(n.key,n.data,os.none());{const t=n.data,r=as.empty();let i=new Jn(Cr.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new mc(n.key,r,new Vs(i.toArray()),os.none())}}function Eee(n,e,t){n instanceof lg?(function(i,s,a){const o=i.value.clone(),l=cL(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()})(n,e,t):n instanceof mc?(function(i,s,a){if(!u_(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=cL(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Z6(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Wm(n,e,t,r){return n instanceof lg?(function(s,a,o,l){if(!u_(s.precondition,a))return o;const c=s.value.clone(),h=uL(s.fieldTransforms,l,a);return c.setAll(h),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null})(n,e,t,r):n instanceof mc?(function(s,a,o,l){if(!u_(s.precondition,a))return o;const c=uL(s.fieldTransforms,l,a),h=a.data;return h.setAll(Z6(s)),h.setAll(c),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((g=>g.field)))})(n,e,t,r):(function(s,a,o){return u_(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o})(n,e,t)}function See(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=W6(r.transform,i||null);s!=null&&(t===null&&(t=as.empty()),t.set(r.field,s))}return t||null}function lL(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&L0(r,i,((s,a)=>vee(s,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class lg extends Yw{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class mc extends Yw{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Z6(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function cL(n,e,t){const r=new Map;Lt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,o=e.data.field(s.field);r.set(s.field,_ee(a,o,t[i]))}return r}function uL(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,xee(s,a,e))}return r}class Zw extends Yw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class J6 extends Yw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class fk{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Eee(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Wm(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Wm(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=U6();return this.mutations.forEach((i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const l=Y6(a,o);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Ft.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),un())}isEqual(e){return this.batchId===e.batchId&&L0(this.mutations,e.mutations,((t,r)=>lL(t,r)))&&L0(this.baseMutations,e.baseMutations,((t,r)=>lL(t,r)))}}class gk{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Lt(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return fee})();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new gk(e,t,r,i)}}class mk{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Tee{constructor(e,t){this.count=e,this.unchangedNames=t}}var Yr,wn;function bee(n){switch(n){case De.OK:return kt(64938);case De.CANCELLED:case De.UNKNOWN:case De.DEADLINE_EXCEEDED:case De.RESOURCE_EXHAUSTED:case De.INTERNAL:case De.UNAVAILABLE:case De.UNAUTHENTICATED:return!1;case De.INVALID_ARGUMENT:case De.NOT_FOUND:case De.ALREADY_EXISTS:case De.PERMISSION_DENIED:case De.FAILED_PRECONDITION:case De.ABORTED:case De.OUT_OF_RANGE:case De.UNIMPLEMENTED:case De.DATA_LOSS:return!0;default:return kt(15467,{code:n})}}function Q6(n){if(n===void 0)return vs("GRPC error has no .code"),De.UNKNOWN;switch(n){case Yr.OK:return De.OK;case Yr.CANCELLED:return De.CANCELLED;case Yr.UNKNOWN:return De.UNKNOWN;case Yr.DEADLINE_EXCEEDED:return De.DEADLINE_EXCEEDED;case Yr.RESOURCE_EXHAUSTED:return De.RESOURCE_EXHAUSTED;case Yr.INTERNAL:return De.INTERNAL;case Yr.UNAVAILABLE:return De.UNAVAILABLE;case Yr.UNAUTHENTICATED:return De.UNAUTHENTICATED;case Yr.INVALID_ARGUMENT:return De.INVALID_ARGUMENT;case Yr.NOT_FOUND:return De.NOT_FOUND;case Yr.ALREADY_EXISTS:return De.ALREADY_EXISTS;case Yr.PERMISSION_DENIED:return De.PERMISSION_DENIED;case Yr.FAILED_PRECONDITION:return De.FAILED_PRECONDITION;case Yr.ABORTED:return De.ABORTED;case Yr.OUT_OF_RANGE:return De.OUT_OF_RANGE;case Yr.UNIMPLEMENTED:return De.UNIMPLEMENTED;case Yr.DATA_LOSS:return De.DATA_LOSS;default:return kt(39323,{code:n})}}(wn=Yr||(Yr={}))[wn.OK=0]="OK",wn[wn.CANCELLED=1]="CANCELLED",wn[wn.UNKNOWN=2]="UNKNOWN",wn[wn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wn[wn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wn[wn.NOT_FOUND=5]="NOT_FOUND",wn[wn.ALREADY_EXISTS=6]="ALREADY_EXISTS",wn[wn.PERMISSION_DENIED=7]="PERMISSION_DENIED",wn[wn.UNAUTHENTICATED=16]="UNAUTHENTICATED",wn[wn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wn[wn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wn[wn.ABORTED=10]="ABORTED",wn[wn.OUT_OF_RANGE=11]="OUT_OF_RANGE",wn[wn.UNIMPLEMENTED=12]="UNIMPLEMENTED",wn[wn.INTERNAL=13]="INTERNAL",wn[wn.UNAVAILABLE=14]="UNAVAILABLE",wn[wn.DATA_LOSS=15]="DATA_LOSS";function Ree(){return new TextEncoder}const Aee=new Tu([4294967295,4294967295],0);function hL(n){const e=Ree().encode(n),t=new Yj;return t.update(e),new Uint8Array(t.digest())}function dL(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Tu([t,r],0),new Tu([i,s],0)]}class pk{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Sm(`Invalid padding: ${t}`);if(r<0)throw new Sm(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Sm(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Sm(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Tu.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Tu.fromNumber(r)));return i.compare(Aee)===1&&(i=new Tu([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=hL(e),[r,i]=dL(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new pk(s,i,t);return r.forEach((o=>a.insert(o))),a}insert(e){if(this.ge===0)return;const t=hL(e),[r,i]=dL(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Sm extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Jw{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Oy.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Jw(Ft.min(),i,new Er(Qt),ha(),un())}}class Oy{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Oy(r,t,un(),un(),un())}}class h_{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class e8{constructor(e,t){this.targetId=e,this.Ce=t}}class t8{constructor(e,t,r=ri.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class fL{constructor(){this.ve=0,this.Fe=gL(),this.Me=ri.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=un(),t=un(),r=un();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:kt(38017,{changeType:s})}})),new Oy(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=gL()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Lt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class kee{constructor(e){this.Ge=e,this.ze=new Map,this.je=ha(),this.Je=Tx(),this.He=Tx(),this.Ye=new Er(Qt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:kt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(uv(s))if(r===0){const a=new ft(s.path);this.et(t,a,Vr.newNoDocument(a,Ft.min()))}else Lt(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,c)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=ac(r).toUint8Array()}catch(l){if(l instanceof E6)return fd("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new pk(a,i,s)}catch(l){return fd(l instanceof Sm?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,a)=>{const o=this.ot(a);if(o){if(s.current&&uv(o.target)){const l=new ft(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Vr.newNoDocument(l,e))}s.Be&&(t.set(a,s.ke()),s.qe())}}));let r=un();this.He.forEach(((s,a)=>{let o=!0;a.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)})),o&&(r=r.add(s))})),this.je.forEach(((s,a)=>a.setReadTime(e)));const i=new Jw(e,t,this.Ye,this.je,r);return this.je=ha(),this.Je=Tx(),this.He=Tx(),this.Ye=new Er(Qt),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new fL,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Jn(Qt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Jn(Qt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||et("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new fL),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Tx(){return new Er(ft.comparator)}function gL(){return new Er(ft.comparator)}const Iee={asc:"ASCENDING",desc:"DESCENDING"},Cee={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Pee={and:"AND",or:"OR"};class Mee{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ub(n,e){return n.useProto3Json||Gw(e)?e:{value:e}}function H0(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function n8(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Nee(n,e){return H0(n,e.toTimestamp())}function Ss(n){return Lt(!!n,49232),Ft.fromTimestamp((function(t){const r=sc(t);return new Xn(r.seconds,r.nanos)})(n))}function yk(n,e){return $b(n,e).canonicalString()}function $b(n,e){const t=(function(i){return new Fn(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function r8(n){const e=Fn.fromString(n);return Lt(d8(e),10190,{key:e.toString()}),e}function dv(n,e){return yk(n.databaseId,e.path)}function Zh(n,e){const t=r8(e);if(t.get(1)!==n.databaseId.projectId)throw new ut(De.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ut(De.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ft(a8(t))}function i8(n,e){return yk(n.databaseId,e)}function s8(n){const e=r8(n);return e.length===4?Fn.emptyPath():a8(e)}function Wb(n){return new Fn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function a8(n){return Lt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function mL(n,e,t){return{name:dv(n,e),fields:t.value.mapValue.fields}}function Lee(n,e,t){const r=Zh(n,e.name),i=Ss(e.updateTime),s=e.createTime?Ss(e.createTime):Ft.min(),a=new as({mapValue:{fields:e.fields}}),o=Vr.newFoundDocument(r,i,s,a);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function Oee(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:kt(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(c,h){return c.useProto3Json?(Lt(h===void 0||typeof h=="string",58123),ri.fromBase64String(h||"")):(Lt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),ri.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&(function(c){const h=c.code===void 0?De.UNKNOWN:Q6(c.code);return new ut(h,c.message||"")})(a);t=new t8(r,i,s,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Zh(n,r.document.name),s=Ss(r.document.updateTime),a=r.document.createTime?Ss(r.document.createTime):Ft.min(),o=new as({mapValue:{fields:r.document.fields}}),l=Vr.newFoundDocument(i,s,a,o),c=r.targetIds||[],h=r.removedTargetIds||[];t=new h_(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Zh(n,r.document),s=r.readTime?Ss(r.readTime):Ft.min(),a=Vr.newNoDocument(i,s),o=r.removedTargetIds||[];t=new h_([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Zh(n,r.document),s=r.removedTargetIds||[];t=new h_([],s,i,null)}else{if(!("filter"in e))return kt(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new Tee(i,s),o=r.targetId;t=new e8(o,a)}}return t}function fv(n,e){let t;if(e instanceof lg)t={update:mL(n,e.key,e.value)};else if(e instanceof Zw)t={delete:dv(n,e.key)};else if(e instanceof mc)t={update:mL(n,e.key,e.data),updateMask:Gee(e.fieldMask)};else{if(!(e instanceof J6))return kt(16599,{Vt:e.type});t={verify:dv(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,a){const o=a.transform;if(o instanceof U0)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof $0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof W0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Bp)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw kt(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:Nee(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:kt(27497)})(n,e.precondition)),t}function Hb(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?os.updateTime(Ss(s.updateTime)):s.exists!==void 0?os.exists(s.exists):os.none()})(e.currentDocument):os.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(a,o){let l=null;if("setToServerValue"in o)Lt(o.setToServerValue==="REQUEST_TIME",16630,{proto:o}),l=new U0;else if("appendMissingElements"in o){const h=o.appendMissingElements.values||[];l=new $0(h)}else if("removeAllFromArray"in o){const h=o.removeAllFromArray.values||[];l=new W0(h)}else"increment"in o?l=new Bp(a,o.increment):kt(16584,{proto:o});const c=Cr.fromServerFormat(o.fieldPath);return new q6(c,l)})(n,i))):[];if(e.update){e.update.name;const i=Zh(n,e.update.name),s=new as({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=(function(l){const c=l.fieldPaths||[];return new Vs(c.map((h=>Cr.fromServerFormat(h))))})(e.updateMask);return new mc(i,s,a,t,r)}return new lg(i,s,t,r)}if(e.delete){const i=Zh(n,e.delete);return new Zw(i,t)}if(e.verify){const i=Zh(n,e.verify);return new J6(i,t)}return kt(1463,{proto:e})}function Dee(n,e){return n&&n.length>0?(Lt(e!==void 0,14353),n.map((t=>(function(i,s){let a=i.updateTime?Ss(i.updateTime):Ss(s);return a.isEqual(Ft.min())&&(a=Ss(s)),new wee(a,i.transformResults||[])})(t,e)))):[]}function o8(n,e){return{documents:[i8(n,e.path)]}}function l8(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=i8(n,i);const s=(function(c){if(c.length!==0)return h8(Yn.create(c,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const a=(function(c){if(c.length!==0)return c.map((h=>(function(m){return{field:Hf(m.field),direction:jee(m.dir)}})(h)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=Ub(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:i}}function c8(n){let e=s8(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Lt(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(g){const m=u8(g);return m instanceof Yn&&hk(m)?m.getFilters():[m]})(t.where));let a=[];t.orderBy&&(a=(function(g){return g.map((m=>(function(v){return new cv(Kf(v.field),(function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(v.direction))})(m)))})(t.orderBy));let o=null;t.limit&&(o=(function(g){let m;return m=typeof g=="object"?g.value:g,Gw(m)?null:m})(t.limit));let l=null;t.startAt&&(l=(function(g){const m=!!g.before,y=g.values||[];return new G0(y,m)})(t.startAt));let c=null;return t.endAt&&(c=(function(g){const m=!g.before,y=g.values||[];return new G0(y,m)})(t.endAt)),lee(e,i,a,s,o,"F",l,c)}function Fee(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return kt(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function u8(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Kf(t.unaryFilter.field);return xn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Kf(t.unaryFilter.field);return xn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Kf(t.unaryFilter.field);return xn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Kf(t.unaryFilter.field);return xn.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return kt(61313);default:return kt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return xn.create(Kf(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return kt(58110);default:return kt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Yn.create(t.compositeFilter.filters.map((r=>u8(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return kt(1026)}})(t.compositeFilter.op))})(n):kt(30097,{filter:n})}function jee(n){return Iee[n]}function Vee(n){return Cee[n]}function Bee(n){return Pee[n]}function Hf(n){return{fieldPath:n.canonicalString()}}function Kf(n){return Cr.fromServerFormat(n.fieldPath)}function h8(n){return n instanceof xn?(function(t){if(t.op==="=="){if(QN(t.value))return{unaryFilter:{field:Hf(t.field),op:"IS_NAN"}};if(JN(t.value))return{unaryFilter:{field:Hf(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(QN(t.value))return{unaryFilter:{field:Hf(t.field),op:"IS_NOT_NAN"}};if(JN(t.value))return{unaryFilter:{field:Hf(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hf(t.field),op:Vee(t.op),value:t.value}}})(n):n instanceof Yn?(function(t){const r=t.getFilters().map((i=>h8(i)));return r.length===1?r[0]:{compositeFilter:{op:Bee(t.op),filters:r}}})(n):kt(54877,{filter:n})}function Gee(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function d8(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Ul{constructor(e,t,r,i,s=Ft.min(),a=Ft.min(),o=ri.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Ul(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ul(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ul(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ul(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class f8{constructor(e){this.yt=e}}function zee(n,e){let t;if(e.document)t=Lee(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ft.fromSegments(e.noDocument.path),i=yd(e.noDocument.readTime);t=Vr.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return kt(56709);{const r=ft.fromSegments(e.unknownDocument.path),i=yd(e.unknownDocument.version);t=Vr.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const s=new Xn(i[0],i[1]);return Ft.fromTimestamp(s)})(e.readTime)),t}function pL(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:gv(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,a){return{name:dv(s,a.key),fields:a.data.value.mapValue.fields,updateTime:H0(s,a.version.toTimestamp()),createTime:H0(s,a.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:pd(e.version)};else{if(!e.isUnknownDocument())return kt(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:pd(e.version)}}return r}function gv(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function pd(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function yd(n){const e=new Xn(n.seconds,n.nanoseconds);return Ft.fromTimestamp(e)}function Nh(n,e){const t=(e.baseMutations||[]).map((s=>Hb(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const o=e.mutations[s+1];a.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>Hb(n.yt,s))),i=Xn.fromMillis(e.localWriteTimeMs);return new fk(e.batchId,i,t,r)}function Tm(n){const e=yd(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?yd(n.lastLimboFreeSnapshotVersion):Ft.min();let r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){const a=s.documents.length;return Lt(a===1,1966,{count:a}),Fa(Kw(s8(s.documents[0])))})(n.query):(function(s){return Fa(c8(s))})(n.query),new Ul(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ri.fromBase64String(n.resumeToken))}function g8(n,e){const t=pd(e.snapshotVersion),r=pd(e.lastLimboFreeSnapshotVersion);let i;i=uv(e.target)?o8(n.yt,e.target):l8(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:md(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function m8(n){const e=c8({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?zb(e,e.limit,"L"):e}function eT(n,e){return new mk(e.largestBatchId,Hb(n.yt,e.overlayMutation))}function yL(n,e){const t=e.path.lastSegment();return[n,cs(e.path.popLast()),t]}function xL(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:pd(r.readTime),documentKey:cs(r.documentKey.path),largestBatchId:r.largestBatchId}}class Uee{getBundleMetadata(e,t){return _L(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:yd(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return _L(e).put((function(i){return{bundleId:i.id,createTime:pd(Ss(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return vL(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:m8(s.bundledQuery),readTime:yd(s.readTime)}})(r)}))}saveNamedQuery(e,t){return vL(e).put((function(i){return{name:i.name,readTime:pd(Ss(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function _L(n){return yi(n,zw)}function vL(n){return yi(n,Uw)}class Qw{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new Qw(e,r)}getOverlay(e,t){return cm(e).get(yL(this.userId,t)).next((r=>r?eT(this.serializer,r):null))}getOverlays(e,t){const r=Qo();return fe.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((s,a)=>{const o=new mk(t,a);i.push(this.St(e,o))})),fe.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((a=>i.add(cs(a.getCollectionPath()))));const s=[];return i.forEach((a=>{const o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(cm(e).Z(Lb,o))})),fe.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Qo(),s=cs(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return cm(e).J(Lb,a).next((o=>{for(const l of o){const c=eT(this.serializer,l);i.set(c.getKey(),c)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const s=Qo();let a;const o=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return cm(e).ee({index:p6,range:o},((l,c,h)=>{const g=eT(this.serializer,c);s.size()<i||g.largestBatchId===a?(s.set(g.getKey(),g),a=g.largestBatchId):h.done()})).next((()=>s))}St(e,t){return cm(e).put((function(i,s,a){const[o,l,c]=yL(s,a.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:fv(i.yt,a.mutation)}})(this.serializer,this.userId,t))}}function cm(n){return yi(n,$w)}class $ee{bt(e){return yi(e,ak)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?ri.fromUint8Array(r):ri.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Lh{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(xr(e.integerValue));else if("doubleValue"in e){const r=xr(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Mp(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=sc(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(ac(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?k6(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Hw(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):kt(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=V0,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(xr(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),ft.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Lh.Kt=new Lh;const Mf=255;function Wee(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function wL(n){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const a=Wee(255&r[s]);if(i+=a,a!==8)break}return i})(n);return Math.ceil(e/8)}class Hee{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=wL(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=wL(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Mf),this.sn(255)}_n(){this.an(Mf),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Mf?(this.sn(Mf),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Mf?(this.an(Mf),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Kee{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class Xee{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class um{constructor(){this.cn=new Hee,this.ln=new Kee(this.cn),this.hn=new Xee(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Oh{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Oh(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:d_(this.En),directionalValue:d_(this.dn),orderedDocumentKey:d_(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Xc(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=EL(n.En,e.En),t!==0?t:(t=EL(n.dn,e.dn),t!==0?t:ft.comparator(n.In,e.In)))}function EL(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function d_(n){return uj()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function SL(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class TL{constructor(e){this.mn=new Jn(((t,r)=>Cr.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Lt(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Pb(e);if(t!==void 0&&!this.wn(t))return!1;const r=Rh(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const o=this.mn.getIterator().getNext();if(!i.has(o.field.canonicalString())){const l=r[s];if(!this.Sn(o,l)||!this.bn(this.fn[a++],l))return!1}++s}for(;s<r.length;++s){const o=r[s];if(a>=this.fn.length||!this.bn(this.fn[a++],o))return!1}return!0}Dn(){if(this.pn)return null;let e=new Jn(Cr.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new i_(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new i_(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new i_(r.field,r.dir==="asc"?0:1)));return new iv(iv.UNKNOWN_ID,this.collectionId,t,Pp.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function p8(n){if(Lt(n instanceof xn||n instanceof Yn,20012),n instanceof xn){if(n instanceof F6){const t=n.value.arrayValue?.values?.map((r=>xn.create(n.field,"==",r)))||[];return Yn.create(t,"or")}return n}const e=n.filters.map((t=>p8(t)));return Yn.create(e,n.op)}function qee(n){if(n.getFilters().length===0)return[];const e=qb(p8(n));return Lt(y8(e),7391),Kb(e)||Xb(e)?[e]:e.getFilters()}function Kb(n){return n instanceof xn}function Xb(n){return n instanceof Yn&&hk(n)}function y8(n){return Kb(n)||Xb(n)||(function(t){if(t instanceof Yn&&jb(t)){for(const r of t.getFilters())if(!Kb(r)&&!Xb(r))return!1;return!0}return!1})(n)}function qb(n){if(Lt(n instanceof xn||n instanceof Yn,34018),n instanceof xn)return n;if(n.filters.length===1)return qb(n.filters[0]);const e=n.filters.map((r=>qb(r)));let t=Yn.create(e,n.op);return t=mv(t),y8(t)?t:(Lt(t instanceof Yn,64498),Lt(z0(t),40251),Lt(t.filters.length>1,57927),t.filters.reduce(((r,i)=>xk(r,i))))}function xk(n,e){let t;return Lt(n instanceof xn||n instanceof Yn,38388),Lt(e instanceof xn||e instanceof Yn,25473),t=n instanceof xn?e instanceof xn?(function(i,s){return Yn.create([i,s],"and")})(n,e):bL(n,e):e instanceof xn?bL(e,n):(function(i,s){if(Lt(i.filters.length>0&&s.filters.length>0,48005),z0(i)&&z0(s))return L6(i,s.getFilters());const a=jb(i)?i:s,o=jb(i)?s:i,l=a.filters.map((c=>xk(c,o)));return Yn.create(l,"or")})(n,e),mv(t)}function bL(n,e){if(z0(e))return L6(e,n.getFilters());{const t=e.filters.map((r=>xk(n,r)));return Yn.create(t,"or")}}function mv(n){if(Lt(n instanceof xn||n instanceof Yn,11850),n instanceof xn)return n;const e=n.getFilters();if(e.length===1)return mv(e[0]);if(M6(n))return n;const t=e.map((i=>mv(i))),r=[];return t.forEach((i=>{i instanceof xn?r.push(i):i instanceof Yn&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Yn.create(r,n.op)}class Yee{constructor(){this.Cn=new _k}addToCollectionParentIndex(e,t){return this.Cn.add(t),fe.resolve()}getCollectionParents(e,t){return fe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return fe.resolve()}deleteFieldIndex(e,t){return fe.resolve()}deleteAllFieldIndexes(e){return fe.resolve()}createTargetIndexes(e,t){return fe.resolve()}getDocumentsMatchingTarget(e,t){return fe.resolve(null)}getIndexType(e,t){return fe.resolve(0)}getFieldIndexes(e,t){return fe.resolve([])}getNextCollectionGroupToUpdate(e){return fe.resolve(null)}getMinOffset(e,t){return fe.resolve(ga.min())}getMinOffsetFromCollectionGroup(e,t){return fe.resolve(ga.min())}updateCollectionGroup(e,t,r){return fe.resolve()}updateIndexEntries(e,t){return fe.resolve()}}class _k{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Jn(Fn.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Jn(Fn.comparator)).toArray()}}const RL="IndexedDbIndexManager",bx=new Uint8Array(0);class Zee{constructor(e,t){this.databaseId=t,this.vn=new _k,this.Fn=new gc((r=>md(r)),((r,i)=>My(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:r,parent:cs(i)};return AL(e).put(s)}return fe.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[i6(t),""],!1,!0);return AL(e).J(i).next((s=>{for(const a of s){if(a.collectionId!==t)break;r.push(Jo(a.parent))}return r}))}addFieldIndex(e,t){const r=hm(e),i=(function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=Lf(e);return s.next((o=>{a.put(xL(o,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const r=hm(e),i=Lf(e),s=Nf(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=hm(e),r=Nf(e),i=Lf(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return fe.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new TL(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const r=Nf(e);let i=!0;const s=new Map;return fe.forEach(this.Mn(t),(a=>this.xn(e,a).next((o=>{i&&(i=!!o),s.set(a,o)})))).next((()=>{if(i){let a=un();const o=[];return fe.forEach(s,((l,c)=>{et(RL,`Using index ${(function(R){return`id=${R.indexId}|cg=${R.collectionGroup}|f=${R.fields.map((N=>`${N.fieldPath}:${N.kind}`)).join(",")}`})(l)} to execute ${md(t)}`);const h=(function(R,N){const D=Pb(N);if(D===void 0)return null;for(const W of hv(R,D.fieldPath))switch(W.op){case"array-contains-any":return W.value.arrayValue.values||[];case"array-contains":return[W.value]}return null})(c,l),g=(function(R,N){const D=new Map;for(const W of Rh(N))for(const I of hv(R,W.fieldPath))switch(I.op){case"==":case"in":D.set(W.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return D.set(W.fieldPath.canonicalString(),I.value),Array.from(D.values())}return null})(c,l),m=(function(R,N){const D=[];let W=!0;for(const I of Rh(N)){const A=I.kind===0?iL(R,I.fieldPath,R.startAt):sL(R,I.fieldPath,R.startAt);D.push(A.value),W&&(W=A.inclusive)}return new G0(D,W)})(c,l),y=(function(R,N){const D=[];let W=!0;for(const I of Rh(N)){const A=I.kind===0?sL(R,I.fieldPath,R.endAt):iL(R,I.fieldPath,R.endAt);D.push(A.value),W&&(W=A.inclusive)}return new G0(D,W)})(c,l),v=this.On(l,c,m),_=this.On(l,c,y),E=this.Nn(l,c,g),T=this.Bn(l.indexId,h,v,m.inclusive,_,y.inclusive,E);return fe.forEach(T,(b=>r.Y(b,t.limit).next((R=>{R.forEach((N=>{const D=ft.fromSegments(N.documentKey);a.has(D)||(a=a.add(D),o.push(D))}))}))))})).next((()=>o))}return fe.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=qee(Yn.create(e.filters,"and")).map((r=>Bb(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,s,a,o){const l=(t!=null?t.length:1)*Math.max(r.length,s.length),c=l/(t!=null?t.length:1),h=[];for(let g=0;g<l;++g){const m=t?this.Ln(t[g/c]):bx,y=this.kn(e,m,r[g%c],i),v=this.qn(e,m,s[g%c],a),_=o.map((E=>this.kn(e,m,E,!0)));h.push(...this.createRange(y,v,_))}return h}kn(e,t,r,i){const s=new Oh(e,ft.empty(),t,r);return i?s:s.An()}qn(e,t,r,i){const s=new Oh(e,ft.empty(),t,r);return i?s.An():s}xn(e,t){const r=new TL(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let a=null;for(const o of s)r.yn(o)&&(!a||o.fields.length>a.fields.length)&&(a=o);return a}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return fe.forEach(i,(s=>this.xn(e,s).next((a=>{a?r!==0&&a.fields.length<(function(l){let c=new Jn(Cr.comparator),h=!1;for(const g of l.filters)for(const m of g.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:c=c.add(m.field));for(const g of l.orderBy)g.field.isKeyField()||(c=c.add(g.field));return c.size+(h?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(a){return a.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new um;for(const i of Rh(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.Pn(i.kind);Lh.Kt.Dt(s,a)}return r.un()}Ln(e){const t=new um;return Lh.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new um;return Lh.Kt.Dt(jp(this.databaseId,t),r.Pn((function(s){const a=Rh(s);return a.length===0?0:a[a.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new um);let s=0;for(const a of Rh(e)){const o=r[s++];for(const l of i)if(this.Un(t,a.fieldPath)&&Vp(o))i=this.Kn(i,a,o);else{const c=l.Pn(a.kind);Lh.Kt.Dt(o,c)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const o of i){const l=new um;l.seed(o.un()),Lh.Kt.Dt(a,l.Pn(t.kind)),s.push(l)}return s}Un(e,t){return!!e.filters.find((r=>r instanceof xn&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=hm(e),i=Lf(e);return(t?r.J(Nb,IDBKeyRange.bound(t,t)):r.J()).next((s=>{const a=[];return fe.forEach(s,(o=>i.get([o.indexId,this.uid]).next((l=>{a.push((function(h,g){const m=g?new Pp(g.sequenceNumber,new ga(yd(g.readTime),new ft(Jo(g.documentKey)),g.largestBatchId)):Pp.empty(),y=h.fields.map((([v,_])=>new i_(Cr.fromServerFormat(v),_)));return new iv(h.indexId,h.collectionGroup,y,m)})(o,l))})))).next((()=>a))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Qt(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=hm(e),s=Lf(e);return this.Gn(e).next((a=>i.J(Nb,IDBKeyRange.bound(t,t)).next((o=>fe.forEach(o,(l=>s.put(xL(l.indexId,this.uid,a,r))))))))}updateIndexEntries(e,t){const r=new Map;return fe.forEach(t,((i,s)=>{const a=r.get(i.collectionGroup);return(a?fe.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next((o=>(r.set(i.collectionGroup,o),fe.forEach(o,(l=>this.zn(e,i,l).next((c=>{const h=this.jn(s,l);return c.isEqual(h)?fe.resolve():this.Jn(e,s,l,c,h)})))))))}))}Hn(e,t,r,i){return Nf(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return Nf(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=Nf(e);let s=new Jn(Xc);return i.ee({index:m6,range:IDBKeyRange.only([r.indexId,this.uid,d_(this.$n(r,t))])},((a,o)=>{s=s.add(new Oh(r.indexId,t,SL(o.arrayValue),SL(o.directionalValue)))})).next((()=>s))}jn(e,t){let r=new Jn(Xc);const i=this.Qn(t,e);if(i==null)return r;const s=Pb(t);if(s!=null){const a=e.data.field(s.fieldPath);if(Vp(a))for(const o of a.arrayValue.values||[])r=r.add(new Oh(t.indexId,e.key,this.Ln(o),i))}else r=r.add(new Oh(t.indexId,e.key,bx,i));return r}Jn(e,t,r,i,s){et(RL,"Updating index entries for document '%s'",t.key);const a=[];return(function(l,c,h,g,m){const y=l.getIterator(),v=c.getIterator();let _=Pf(y),E=Pf(v);for(;_||E;){let T=!1,b=!1;if(_&&E){const R=h(_,E);R<0?b=!0:R>0&&(T=!0)}else _!=null?b=!0:T=!0;T?(g(E),E=Pf(v)):b?(m(_),_=Pf(y)):(_=Pf(y),E=Pf(v))}})(i,s,Xc,(o=>{a.push(this.Hn(e,t,r,o))}),(o=>{a.push(this.Yn(e,t,r,o))})),fe.waitFor(a)}Gn(e){let t=1;return Lf(e).ee({index:g6,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((a,o)=>Xc(a,o))).filter(((a,o,l)=>!o||Xc(a,l[o-1])!==0));const i=[];i.push(e);for(const a of r){const o=Xc(a,e),l=Xc(a,t);if(o===0)i[0]=e.An();else if(o>0&&l<0)i.push(a),i.push(a.An());else if(l>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.Zn(i[a],i[a+1]))return[];const o=i[a].Vn(this.uid,bx,ft.empty()),l=i[a+1].Vn(this.uid,bx,ft.empty());s.push(IDBKeyRange.bound(o,l))}return s}Zn(e,t){return Xc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(kL)}getMinOffset(e,t){return fe.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||kt(44426))))).next(kL)}}function AL(n){return yi(n,Op)}function Nf(n){return yi(n,Gm)}function hm(n){return yi(n,sk)}function Lf(n){return yi(n,Bm)}function kL(n){Lt(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;nk(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new ga(e.readTime,e.documentKey,t)}const IL={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},x8=41943040;class is{static withCacheSize(e){return new is(e,is.DEFAULT_COLLECTION_PERCENTILE,is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function _8(n,e,t){const r=n.store(ao),i=n.store(O0),s=[],a=IDBKeyRange.only(t.batchId);let o=0;const l=r.ee({range:a},((h,g,m)=>(o++,m.delete())));s.push(l.next((()=>{Lt(o===1,47070,{batchId:t.batchId})})));const c=[];for(const h of t.mutations){const g=h6(e,h.key.path,t.batchId);s.push(i.delete(g)),c.push(h.key)}return fe.waitFor(s).next((()=>c))}function pv(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw kt(14731);e=n.noDocument}return JSON.stringify(e).length}is.DEFAULT_COLLECTION_PERCENTILE=10,is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,is.DEFAULT=new is(x8,is.DEFAULT_COLLECTION_PERCENTILE,is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),is.DISABLED=new is(-1,0,0);class eE{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Lt(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new eE(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return qc(e).ee({index:zh,range:r},((i,s,a)=>{t=!1,a.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const s=Xf(e),a=qc(e);return a.add({}).next((o=>{Lt(typeof o=="number",49019);const l=new fk(o,t,r,i),c=(function(y,v,_){const E=_.baseMutations.map((b=>fv(y.yt,b))),T=_.mutations.map((b=>fv(y.yt,b)));return{userId:v,batchId:_.batchId,localWriteTimeMs:_.localWriteTime.toMillis(),baseMutations:E,mutations:T}})(this.serializer,this.userId,l),h=[];let g=new Jn(((m,y)=>Qt(m.canonicalString(),y.canonicalString())));for(const m of i){const y=h6(this.userId,m.key.path,o);g=g.add(m.key.path.popLast()),h.push(a.put(c)),h.push(s.put(y,RQ))}return g.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[o]=l.keys()})),fe.waitFor(h).next((()=>l))}))}lookupMutationBatch(e,t){return qc(e).get(t).next((r=>r?(Lt(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Nh(this.serializer,r)):null))}er(e,t){return this.Xn[t]?fe.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return qc(e).ee({index:zh,range:i},((a,o,l)=>{o.userId===this.userId&&(Lt(o.batchId>=r,47524,{tr:r}),s=Nh(this.serializer,o)),l.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=qh;return qc(e).ee({index:zh,range:t,reverse:!0},((i,s,a)=>{r=s.batchId,a.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,qh],[this.userId,Number.POSITIVE_INFINITY]);return qc(e).J(zh,t).next((r=>r.map((i=>Nh(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=s_(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Xf(e).ee({range:i},((a,o,l)=>{const[c,h,g]=a,m=Jo(h);if(c===this.userId&&t.path.isEqual(m))return qc(e).get(g).next((y=>{if(!y)throw kt(61480,{nr:a,batchId:g});Lt(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:g}),s.push(Nh(this.serializer,y))}));l.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Jn(Qt);const i=[];return t.forEach((s=>{const a=s_(this.userId,s.path),o=IDBKeyRange.lowerBound(a),l=Xf(e).ee({range:o},((c,h,g)=>{const[m,y,v]=c,_=Jo(y);m===this.userId&&s.path.isEqual(_)?r=r.add(v):g.done()}));i.push(l)})),fe.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=s_(this.userId,r),a=IDBKeyRange.lowerBound(s);let o=new Jn(Qt);return Xf(e).ee({range:a},((l,c,h)=>{const[g,m,y]=l,v=Jo(m);g===this.userId&&r.isPrefixOf(v)?v.length===i&&(o=o.add(y)):h.done()})).next((()=>this.rr(e,o)))}rr(e,t){const r=[],i=[];return t.forEach((s=>{i.push(qc(e).get(s).next((a=>{if(a===null)throw kt(35274,{batchId:s});Lt(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:s}),r.push(Nh(this.serializer,a))})))})),fe.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return _8(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),fe.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return fe.resolve();const r=IDBKeyRange.lowerBound((function(a){return[a]})(this.userId)),i=[];return Xf(e).ee({range:r},((s,a,o)=>{if(s[0]===this.userId){const l=Jo(s[1]);i.push(l)}else o.done()})).next((()=>{Lt(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return v8(e,this.userId,t)}_r(e){return w8(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:qh,lastStreamToken:""}))}}function v8(n,e,t){const r=s_(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Xf(n).ee({range:s,X:!0},((o,l,c)=>{const[h,g,m]=o;h===e&&g===i&&(a=!0),c.done()})).next((()=>a))}function qc(n){return yi(n,ao)}function Xf(n){return yi(n,O0)}function w8(n){return yi(n,Np)}class xd{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new xd(0)}static cr(){return new xd(-1)}}class Jee{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new xd(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Ft.fromTimestamp(new Xn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Of(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Lt(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const s=[];return Of(e).ee(((a,o)=>{const l=Tm(o);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))})).next((()=>fe.waitFor(s))).next((()=>i))}forEachTarget(e,t){return Of(e).ee(((r,i)=>{const s=Tm(i);t(s)}))}lr(e){return CL(e).get(ov).next((t=>(Lt(t!==null,2888),t)))}hr(e,t){return CL(e).put(ov,t)}Pr(e,t){return Of(e).put(g8(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=md(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Of(e).ee({range:i,index:f6},((a,o,l)=>{const c=Tm(o);My(t,c.target)&&(s=c,l.done())})).next((()=>s))}addMatchingKeys(e,t,r){const i=[],s=au(e);return t.forEach((a=>{const o=cs(a.path);i.push(s.put({targetId:r,path:o})),i.push(this.referenceDelegate.addReference(e,r,a))})),fe.waitFor(i)}removeMatchingKeys(e,t,r){const i=au(e);return fe.forEach(t,(s=>{const a=cs(s.path);return fe.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){const r=au(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=au(e);let s=un();return i.ee({range:r,X:!0},((a,o,l)=>{const c=Jo(a[1]),h=new ft(c);s=s.add(h)})).next((()=>s))}containsKey(e,t){const r=cs(t.path),i=IDBKeyRange.bound([r],[i6(r)],!1,!0);let s=0;return au(e).ee({index:ik,X:!0,range:i},(([a,o],l,c)=>{a!==0&&(s++,c.done())})).next((()=>s>0))}At(e,t){return Of(e).get(t).next((r=>r?Tm(r):null))}}function Of(n){return yi(n,D0)}function CL(n){return yi(n,Yh)}function au(n){return yi(n,F0)}const PL="LruGarbageCollector",Qee=1048576;function ML([n,e],[t,r]){const i=Qt(n,t);return i===0?Qt(e,r):i}class ete{constructor(e){this.Ir=e,this.buffer=new Jn(ML),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();ML(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class E8{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){et(PL,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Wu(t)?et(PL,"Ignoring IndexedDB error during garbage collection: ",t):await Nd(t)}await this.Vr(3e5)}))}}class tte{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return fe.resolve(Oa.ce);const r=new ete(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(et("LruGarbageCollector","Garbage collection skipped; disabled"),fe.resolve(IL)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(et("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),IL):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,a,o,l,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(et("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,a=Date.now(),this.nthSequenceNumber(e,i)))).next((g=>(r=g,o=Date.now(),this.removeTargets(e,r,t)))).next((g=>(s=g,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((g=>(c=Date.now(),$f()<=yn.DEBUG&&et("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${g} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),fe.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:g}))))}}function S8(n,e){return new tte(n,e)}class nte{constructor(e,t){this.db=e,this.garbageCollector=S8(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return Rx(e,r)}removeReference(e,t,r){return Rx(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Rx(e,t)}br(e,t){return(function(i,s){let a=!1;return w8(i).te((o=>v8(i,o,s).next((l=>(l&&(a=!0),fe.resolve(!l)))))).next((()=>a))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((a,o)=>{if(o<=t){const l=this.br(e,a).next((c=>{if(!c)return s++,r.getEntry(e,a).next((()=>(r.removeEntry(a,Ft.min()),au(e).delete((function(g){return[0,cs(g.path)]})(a)))))}));i.push(l)}})).next((()=>fe.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Rx(e,t)}Sr(e,t){const r=au(e);let i,s=Oa.ce;return r.ee({index:ik},(([a,o],{path:l,sequenceNumber:c})=>{a===0?(s!==Oa.ce&&t(new ft(Jo(i)),s),s=c,i=l):s=Oa.ce})).next((()=>{s!==Oa.ce&&t(new ft(Jo(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Rx(n,e){return au(n).put((function(r,i){return{targetId:0,path:cs(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class T8{constructor(){this.changes=new gc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?fe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class rte{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return vh(e).put(r)}removeEntry(e,t,r){return vh(e).delete((function(s,a){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],gv(a),o[o.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=Vr.newInvalidDocument(t);return vh(e).ee({index:a_,range:IDBKeyRange.only(dm(t))},((i,s)=>{r=this.Cr(t,s)})).next((()=>r))}vr(e,t){let r={size:0,document:Vr.newInvalidDocument(t)};return vh(e).ee({index:a_,range:IDBKeyRange.only(dm(t))},((i,s)=>{r={document:this.Cr(t,s),size:pv(s)}})).next((()=>r))}getEntries(e,t){let r=ha();return this.Fr(e,t,((i,s)=>{const a=this.Cr(i,s);r=r.insert(i,a)})).next((()=>r))}Mr(e,t){let r=ha(),i=new Er(ft.comparator);return this.Fr(e,t,((s,a)=>{const o=this.Cr(s,a);r=r.insert(s,o),i=i.insert(s,pv(a))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return fe.resolve();let i=new Jn(OL);t.forEach((l=>i=i.add(l)));const s=IDBKeyRange.bound(dm(i.first()),dm(i.last())),a=i.getIterator();let o=a.getNext();return vh(e).ee({index:a_,range:s},((l,c,h)=>{const g=ft.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;o&&OL(o,g)<0;)r(o,null),o=a.getNext();o&&o.isEqual(g)&&(r(o,c),o=a.hasNext()?a.getNext():null),o?h.j(dm(o)):h.done()})).next((()=>{for(;o;)r(o,null),o=a.hasNext()?a.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,o=[a.popLast().toArray(),a.lastSegment(),gv(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return vh(e).J(IDBKeyRange.bound(o,l,!0)).next((c=>{s?.incrementDocumentReadCount(c.length);let h=ha();for(const g of c){const m=this.Cr(ft.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);m.isFoundDocument()&&(Ly(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,r,i){let s=ha();const a=LL(t,r),o=LL(t,ga.max());return vh(e).ee({index:d6,range:IDBKeyRange.bound(a,o,!0)},((l,c,h)=>{const g=this.Cr(ft.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(g.key,g),s.size===i&&h.done()})).next((()=>s))}newChangeBuffer(e){return new ite(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return NL(e).get(Mb).next((t=>(Lt(!!t,20021),t)))}Dr(e,t){return NL(e).put(Mb,t)}Cr(e,t){if(t){const r=zee(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Ft.min())))return r}return Vr.newInvalidDocument(e)}}function b8(n){return new rte(n)}class ite extends T8{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new gc((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Jn(((s,a)=>Qt(s.canonicalString(),a.canonicalString())));return this.changes.forEach(((s,a)=>{const o=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,o.readTime)),a.isValidDocument()){const l=pL(this.Nr.serializer,a);i=i.add(s.path.popLast());const c=pv(l);r+=c-o.size,t.push(this.Nr.addEntry(e,s,l))}else if(r-=o.size,this.trackRemovals){const l=pL(this.Nr.serializer,a.convertToNoDocument(Ft.min()));t.push(this.Nr.addEntry(e,s,l))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,r)),fe.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((s,a)=>{this.Br.set(s,{size:a,readTime:r.get(s).readTime})})),r)))}}function NL(n){return yi(n,Lp)}function vh(n){return yi(n,av)}function dm(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function LL(n,e){const t=e.documentKey.path.toArray();return[n,gv(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function OL(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=Qt(t[s],r[s]),i)return i;return i=Qt(t.length,r.length),i||(i=Qt(t[t.length-2],r[r.length-2]),i||Qt(t[t.length-1],r[r.length-1]))}class ste{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class R8{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Wm(r.mutation,i,Vs.empty(),Xn.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,un()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=un()){const i=Qo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let a=Em();return s.forEach(((o,l)=>{a=a.insert(o,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=Qo();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,un())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((a,o)=>{t.set(a,o)}))}))}computeViews(e,t,r,i){let s=ha();const a=$m(),o=(function(){return $m()})();return t.forEach(((l,c)=>{const h=r.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof mc)?s=s.insert(c.key,c):h!==void 0?(a.set(c.key,h.mutation.getFieldMask()),Wm(h.mutation,c,h.mutation.getFieldMask(),Xn.now())):a.set(c.key,Vs.empty())})),this.recalculateAndSaveOverlays(e,s).next((l=>(l.forEach(((c,h)=>a.set(c,h))),t.forEach(((c,h)=>o.set(c,new ste(h,a.get(c)??null)))),o)))}recalculateAndSaveOverlays(e,t){const r=$m();let i=new Er(((a,o)=>a-o)),s=un();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const o of a)o.keys().forEach((l=>{const c=t.get(l);if(c===null)return;let h=r.get(l)||Vs.empty();h=o.applyToLocalView(c,h),r.set(l,h);const g=(i.get(o.batchId)||un()).add(l);i=i.insert(o.batchId,g)}))})).next((()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,h=l.value,g=U6();h.forEach((m=>{if(!s.has(m)){const y=Y6(t.get(m),r.get(m));y!==null&&g.set(m,y),s=s.add(m)}})),a.push(this.documentOverlayCache.saveOverlays(e,c,g))}return fe.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return ft.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):j6(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):fe.resolve(Qo());let o=Cp,l=s;return a.next((c=>fe.forEach(c,((h,g)=>(o<g.largestBatchId&&(o=g.largestBatchId),s.get(h)?fe.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{l=l.insert(h,m)}))))).next((()=>this.populateOverlays(e,c,s))).next((()=>this.computeViews(e,l,c,un()))).next((h=>({batchId:o,changes:z6(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ft(t)).next((r=>{let i=Em();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=Em();return this.indexManager.getCollectionParents(e,s).next((o=>fe.forEach(o,(l=>{const c=(function(g,m){return new Ny(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next((h=>{h.forEach(((g,m)=>{a=a.insert(g,m)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((a=>{s.forEach(((l,c)=>{const h=c.getKey();a.get(h)===null&&(a=a.insert(h,Vr.newInvalidDocument(h)))}));let o=Em();return a.forEach(((l,c)=>{const h=s.get(l);h!==void 0&&Wm(h.mutation,c,Vs.empty(),Xn.now()),Ly(t,c)&&(o=o.insert(l,c))})),o}))}}class ate{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return fe.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Ss(i.createTime)}})(t)),fe.resolve()}getNamedQuery(e,t){return fe.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:m8(i.bundledQuery),readTime:Ss(i.readTime)}})(t)),fe.resolve()}}class ote{constructor(){this.overlays=new Er(ft.comparator),this.qr=new Map}getOverlay(e,t){return fe.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Qo();return fe.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.St(e,t,s)})),fe.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),fe.resolve()}getOverlaysForCollection(e,t,r){const i=Qo(),s=t.length+1,a=new ft(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return fe.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Er(((c,h)=>c-h));const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let h=s.get(c.largestBatchId);h===null&&(h=Qo(),s=s.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const o=Qo(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,h)=>o.set(c,h))),!(o.size()>=i)););return fe.resolve(o)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new mk(t,r));let s=this.qr.get(t);s===void 0&&(s=un(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}class lte{constructor(){this.sessionToken=ri.EMPTY_BYTE_STRING}getSessionToken(e){return fe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,fe.resolve()}}class vk{constructor(){this.Qr=new Jn(Ei.$r),this.Ur=new Jn(Ei.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Ei(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Ei(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ft(new Fn([])),r=new Ei(t,e),i=new Ei(t,e+1),s=[];return this.Ur.forEachInRange([r,i],(a=>{this.Gr(a),s.push(a.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ft(new Fn([])),r=new Ei(t,e),i=new Ei(t,e+1);let s=un();return this.Ur.forEachInRange([r,i],(a=>{s=s.add(a.key)})),s}containsKey(e){const t=new Ei(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ei{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ft.comparator(e.key,t.key)||Qt(e.Yr,t.Yr)}static Kr(e,t){return Qt(e.Yr,t.Yr)||ft.comparator(e.key,t.key)}}class cte{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Jn(Ei.$r)}checkEmpty(e){return fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new fk(s,t,r,i);this.mutationQueue.push(a);for(const o of i)this.Zr=this.Zr.add(new Ei(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return fe.resolve(a)}lookupMutationBatch(e,t){return fe.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return fe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return fe.resolve(this.mutationQueue.length===0?qh:this.tr-1)}getAllMutationBatches(e){return fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ei(t,0),i=new Ei(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(a=>{const o=this.Xr(a.Yr);s.push(o)})),fe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Jn(Qt);return t.forEach((i=>{const s=new Ei(i,0),a=new Ei(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],(o=>{r=r.add(o.Yr)}))})),fe.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;ft.isDocumentKey(s)||(s=s.child(""));const a=new Ei(new ft(s),0);let o=new Jn(Qt);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.Yr)),!0)}),a),fe.resolve(this.ti(o))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Lt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return fe.forEach(t.mutations,(i=>{const s=new Ei(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Ei(t,0),i=this.Zr.firstAfterOrEqual(r);return fe.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,fe.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ute{constructor(e){this.ri=e,this.docs=(function(){return new Er(ft.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return fe.resolve(r?r.document.mutableCopy():Vr.newInvalidDocument(t))}getEntries(e,t){let r=ha();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Vr.newInvalidDocument(i))})),fe.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=ha();const a=t.path,o=new ft(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||nk(o6(h),r)<=0||(i.has(h.key)||Ly(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return fe.resolve(s)}getAllFromCollectionGroup(e,t,r,i){kt(9500)}ii(e,t){return fe.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new hte(this)}getSize(e){return fe.resolve(this.size)}}class hte extends T8{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),fe.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class dte{constructor(e){this.persistence=e,this.si=new gc((t=>md(t)),My),this.lastRemoteSnapshotVersion=Ft.min(),this.highestTargetId=0,this.oi=0,this._i=new vk,this.targetCount=0,this.ai=xd.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),fe.resolve()}getLastRemoteSnapshotVersion(e){return fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return fe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),fe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),fe.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new xd(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,fe.resolve()}updateTargetData(e,t){return this.Pr(t),fe.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,fe.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),fe.waitFor(s).next((()=>i))}getTargetCount(e){return fe.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return fe.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),fe.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((a=>{s.push(i.markPotentiallyOrphaned(e,a))})),fe.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),fe.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return fe.resolve(r)}containsKey(e,t){return fe.resolve(this._i.containsKey(t))}}class wk{constructor(e,t){this.ui={},this.overlays={},this.ci=new Oa(0),this.li=!1,this.li=!0,this.hi=new lte,this.referenceDelegate=e(this),this.Pi=new dte(this),this.indexManager=new Yee,this.remoteDocumentCache=(function(i){return new ute(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new f8(t),this.Ii=new ate(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ote,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new cte(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){et("MemoryPersistence","Starting transaction:",e);const i=new fte(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return fe.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class fte extends c6{constructor(e){super(),this.currentSequenceNumber=e}}class tE{constructor(e){this.persistence=e,this.Ri=new vk,this.Vi=null}static mi(e){return new tE(e)}get fi(){if(this.Vi)return this.Vi;throw kt(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),fe.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),fe.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),fe.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fe.forEach(this.fi,(r=>{const i=ft.fromPath(r);return this.gi(e,i).next((s=>{s||t.removeEntry(i,Ft.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return fe.or([()=>fe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class yv{constructor(e,t){this.persistence=e,this.pi=new gc((r=>cs(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=S8(this,t)}static mi(e,t){return new yv(e,t)}Ei(){}di(e){return fe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return fe.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?fe.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(a=>this.br(e,a,t).next((o=>{o||(r++,s.removeEntry(a,Ft.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),fe.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),fe.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),fe.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),fe.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=l_(e.data.value)),t}br(e,t,r){return fe.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return fe.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class gte{constructor(e){this.serializer=e}k(e,t,r,i){const s=new Bw("createOrUpgrade",t);r<1&&i>=1&&((function(l){l.createObjectStore(Py)})(e),(function(l){l.createObjectStore(Np,{keyPath:bQ}),l.createObjectStore(ao,{keyPath:HN,autoIncrement:!0}).createIndex(zh,KN,{unique:!0}),l.createObjectStore(O0)})(e),DL(e),(function(l){l.createObjectStore(Ah)})(e));let a=fe.resolve();return r<3&&i>=3&&(r!==0&&((function(l){l.deleteObjectStore(F0),l.deleteObjectStore(D0),l.deleteObjectStore(Yh)})(e),DL(e)),a=a.next((()=>(function(l){const c=l.store(Yh),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ft.min().toTimestamp(),targetCount:0};return c.put(ov,h)})(s)))),r<4&&i>=4&&(r!==0&&(a=a.next((()=>(function(l,c){return c.store(ao).J().next((g=>{l.deleteObjectStore(ao),l.createObjectStore(ao,{keyPath:HN,autoIncrement:!0}).createIndex(zh,KN,{unique:!0});const m=c.store(ao),y=g.map((v=>m.put(v)));return fe.waitFor(y)}))})(e,s)))),a=a.next((()=>{(function(l){l.createObjectStore(j0,{keyPath:LQ})})(e)}))),r<5&&i>=5&&(a=a.next((()=>this.yi(s)))),r<6&&i>=6&&(a=a.next((()=>((function(l){l.createObjectStore(Lp)})(e),this.wi(s))))),r<7&&i>=7&&(a=a.next((()=>this.Si(s)))),r<8&&i>=8&&(a=a.next((()=>this.bi(e,s)))),r<9&&i>=9&&(a=a.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(a=a.next((()=>this.Di(s)))),r<11&&i>=11&&(a=a.next((()=>{(function(l){l.createObjectStore(zw,{keyPath:OQ})})(e),(function(l){l.createObjectStore(Uw,{keyPath:DQ})})(e)}))),r<12&&i>=12&&(a=a.next((()=>{(function(l){const c=l.createObjectStore($w,{keyPath:UQ});c.createIndex(Lb,$Q,{unique:!1}),c.createIndex(p6,WQ,{unique:!1})})(e)}))),r<13&&i>=13&&(a=a.next((()=>(function(l){const c=l.createObjectStore(av,{keyPath:AQ});c.createIndex(a_,kQ),c.createIndex(d6,IQ)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Ah)))),r<14&&i>=14&&(a=a.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(a=a.next((()=>(function(l){l.createObjectStore(sk,{keyPath:FQ,autoIncrement:!0}).createIndex(Nb,jQ,{unique:!1}),l.createObjectStore(Bm,{keyPath:VQ}).createIndex(g6,BQ,{unique:!1}),l.createObjectStore(Gm,{keyPath:GQ}).createIndex(m6,zQ,{unique:!1})})(e)))),r<16&&i>=16&&(a=a.next((()=>{t.objectStore(Bm).clear()})).next((()=>{t.objectStore(Gm).clear()}))),r<17&&i>=17&&(a=a.next((()=>{(function(l){l.createObjectStore(ak,{keyPath:HQ})})(e)}))),r<18&&i>=18&&uj()&&(a=a.next((()=>{t.objectStore(Bm).clear()})).next((()=>{t.objectStore(Gm).clear()}))),a}wi(e){let t=0;return e.store(Ah).ee(((r,i)=>{t+=pv(i)})).next((()=>{const r={byteSize:t};return e.store(Lp).put(Mb,r)}))}yi(e){const t=e.store(Np),r=e.store(ao);return t.J().next((i=>fe.forEach(i,(s=>{const a=IDBKeyRange.bound([s.userId,qh],[s.userId,s.lastAcknowledgedBatchId]);return r.J(zh,a).next((o=>fe.forEach(o,(l=>{Lt(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=Nh(this.serializer,l);return _8(e,s.userId,c).next((()=>{}))}))))}))))}Si(e){const t=e.store(F0),r=e.store(Ah);return e.store(Yh).get(ov).next((i=>{const s=[];return r.ee(((a,o)=>{const l=new Fn(a),c=(function(g){return[0,cs(g)]})(l);s.push(t.get(c).next((h=>h?fe.resolve():(g=>t.put({targetId:0,path:cs(g),sequenceNumber:i.highestListenSequenceNumber}))(l))))})).next((()=>fe.waitFor(s)))}))}bi(e,t){e.createObjectStore(Op,{keyPath:NQ});const r=t.store(Op),i=new _k,s=a=>{if(i.add(a)){const o=a.lastSegment(),l=a.popLast();return r.put({collectionId:o,parent:cs(l)})}};return t.store(Ah).ee({X:!0},((a,o)=>{const l=new Fn(a);return s(l.popLast())})).next((()=>t.store(O0).ee({X:!0},(([a,o,l],c)=>{const h=Jo(o);return s(h.popLast())}))))}Di(e){const t=e.store(D0);return t.ee(((r,i)=>{const s=Tm(i),a=g8(this.serializer,s);return t.put(a)}))}Ci(e,t){const r=t.store(Ah),i=[];return r.ee(((s,a)=>{const o=t.store(av),l=(function(g){return g.document?new ft(Fn.fromString(g.document.name).popFirst(5)):g.noDocument?ft.fromSegments(g.noDocument.path):g.unknownDocument?ft.fromSegments(g.unknownDocument.path):kt(36783)})(a).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(o.put(c))})).next((()=>fe.waitFor(i)))}Fi(e,t){const r=t.store(ao),i=b8(this.serializer),s=new wk(tE.mi,this.serializer.yt);return r.J().next((a=>{const o=new Map;return a.forEach((l=>{let c=o.get(l.userId)??un();Nh(this.serializer,l).keys().forEach((h=>c=c.add(h))),o.set(l.userId,c)})),fe.forEach(o,((l,c)=>{const h=new zi(c),g=Qw.wt(this.serializer,h),m=s.getIndexManager(h),y=eE.wt(h,this.serializer,m,s.referenceDelegate);return new R8(i,y,g,m).recalculateAndSaveOverlaysForDocumentKeys(new Ob(t,Oa.ce),l).next()}))}))}}function DL(n){n.createObjectStore(F0,{keyPath:PQ}).createIndex(ik,MQ,{unique:!0}),n.createObjectStore(D0,{keyPath:"targetId"}).createIndex(f6,CQ,{unique:!0}),n.createObjectStore(Yh)}const Yc="IndexedDbPersistence",tT=18e5,nT=5e3,rT="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",mte="main";class Ek{constructor(e,t,r,i,s,a,o,l,c,h,g=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=s,this.window=a,this.document=o,this.xi=c,this.Oi=h,this.Ni=g,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Ek.v())throw new ut(De.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new nte(this,i),this.$i=t+mte,this.serializer=new f8(l),this.Ui=new bu(this.$i,this.Ni,new gte(this.serializer)),this.hi=new $ee,this.Pi=new Jee(this.referenceDelegate,this.serializer),this.remoteDocumentCache=b8(this.serializer),this.Ii=new Uee,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&vs(Yc,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ut(De.FAILED_PRECONDITION,rT);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Oa(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Ax(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Wu(e))return et(Yc,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return et(Yc,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return fm(e).get(Cf).next((t=>fe.resolve(this.es(t))))}ts(e){return Ax(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,tT)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=yi(t,j0);return r.J().next((i=>{const s=this.ss(i,tT),a=i.filter((o=>s.indexOf(o)===-1));return fe.forEach(a,(o=>r.delete(o.clientId))).next((()=>a))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?fe.resolve(!0):fm(e).get(Cf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,nT)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ut(De.FAILED_PRECONDITION,rT);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ax(e).J().next((r=>this.ss(r,nT).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,o=this.networkEnabled===i.networkEnabled;if(s||a&&o)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&et(Yc,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Py,j0],(e=>{const t=new Ob(e,Oa.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Ax(e).J().next((t=>this.ss(t,tT).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return eE.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Zee(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Qw.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){et(Yc,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(l){return l===18?qQ:l===17?v6:l===16?XQ:l===15?ok:l===14?_6:l===13?x6:l===12?KQ:l===11?y6:void kt(60245)})(this.Ni);let a;return this.Ui.runTransaction(e,i,s,(o=>(a=new Ob(o,this.ci?this.ci.next():Oa.ce),t==="readwrite-primary"?this.Hi(a).next((l=>!!l||this.Yi(a))).next((l=>{if(!l)throw vs(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new ut(De.FAILED_PRECONDITION,l6);return r(a)})).next((l=>this.Xi(a).next((()=>l)))):this.Is(a).next((()=>r(a)))))).then((o=>(a.raiseOnCommittedEvent(),o)))}Is(e){return fm(e).get(Cf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,nT)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ut(De.FAILED_PRECONDITION,rT)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return fm(e).put(Cf,t)}static v(){return bu.v()}Zi(e){const t=fm(e);return t.get(Cf).next((r=>this.es(r)?(et(Yc,"Releasing primary lease."),t.delete(Cf)):fe.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(vs(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;cj()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return et(Yc,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return vs(Yc,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){vs("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function fm(n){return yi(n,Py)}function Ax(n){return yi(n,j0)}function pte(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Sk{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=un(),i=un();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Sk(e,t.fromCache,r,i)}}class yte{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class A8{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return cj()?8:u6(mi())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next((a=>{s.result=a})).next((()=>{if(!s.result)return this.ws(e,t,i,r).next((a=>{s.result=a}))})).next((()=>{if(s.result)return;const a=new yte;return this.Ss(e,t,a).next((o=>{if(s.result=o,this.Vs)return this.bs(e,t,a,o.size)}))})).next((()=>s.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?($f()<=yn.DEBUG&&et("QueryEngine","SDK will not create cache indexes for query:",Wf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),fe.resolve()):($f()<=yn.DEBUG&&et("QueryEngine","Query:",Wf(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?($f()<=yn.DEBUG&&et("QueryEngine","The SDK decides to create cache indexes for query:",Wf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fa(t))):fe.resolve())}ys(e,t){if(aL(t))return fe.resolve(null);let r=Fa(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=zb(t,null,"F"),r=Fa(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const a=un(...s);return this.ps.getDocuments(e,a).next((o=>this.indexManager.getMinOffset(e,r).next((l=>{const c=this.Ds(t,o);return this.Cs(t,c,a,l.readTime)?this.ys(e,zb(t,null,"F")):this.vs(e,c,t,l)}))))})))))}ws(e,t,r,i){return aL(t)||i.isEqual(Ft.min())?fe.resolve(null):this.ps.getDocuments(e,r).next((s=>{const a=this.Ds(t,s);return this.Cs(t,a,r,i)?fe.resolve(null):($f()<=yn.DEBUG&&et("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Wf(t)),this.vs(e,a,t,xQ(i,Cp)).next((o=>o)))}))}Ds(e,t){let r=new Jn(B6(e));return t.forEach(((i,s)=>{Ly(e,s)&&(r=r.add(s))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return $f()<=yn.DEBUG&&et("QueryEngine","Using full collection scan to execute query:",Wf(t)),this.ps.getDocumentsMatchingQuery(e,t,ga.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((a=>{s=s.insert(a.key,a)})),s)))}}const Tk="LocalStore",xte=3e8;class _te{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Er(Qt),this.xs=new gc((s=>md(s)),My),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new R8(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function k8(n,e,t,r){return new _te(n,e,t,r)}async function I8(n,e){const t=en(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const a=[],o=[];let l=un();for(const c of i){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of s){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next((c=>({Ls:c,removedBatchIds:a,addedBatchIds:o})))}))}))}function vte(n,e){const t=en(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(o,l,c,h){const g=c.batch,m=g.keys();let y=fe.resolve();return m.forEach((v=>{y=y.next((()=>h.getEntry(l,v))).next((_=>{const E=c.docVersions.get(v);Lt(E!==null,48541),_.version.compareTo(E)<0&&(g.applyToRemoteDocument(_,c),_.isValidDocument()&&(_.setReadTime(c.commitVersion),h.addEntry(_)))}))})),y.next((()=>o.mutationQueue.removeMutationBatch(l,g)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(o){let l=un();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function C8(n){const e=en(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function wte(n,e){const t=en(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const o=[];e.targetChanges.forEach(((h,g)=>{const m=i.get(g);if(!m)return;o.push(t.Pi.removeMatchingKeys(s,h.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(s,h.addedDocuments,g))));let y=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?y=y.withResumeToken(ri.EMPTY_BYTE_STRING,Ft.min()).withLastLimboFreeSnapshotVersion(Ft.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(g,y),(function(_,E,T){return _.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=xte?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,y,h)&&o.push(t.Pi.updateTargetData(s,y))}));let l=ha(),c=un();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))})),o.push(Ete(s,a,e.documentUpdates).next((h=>{l=h.ks,c=h.qs}))),!r.isEqual(Ft.min())){const h=t.Pi.getLastRemoteSnapshotVersion(s).next((g=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));o.push(h)}return fe.waitFor(o).next((()=>a.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,l,c))).next((()=>l))})).then((s=>(t.Ms=i,s)))}function Ete(n,e,t){let r=un(),i=un();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let a=ha();return t.forEach(((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Ft.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):et(Tk,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)})),{ks:a,qs:i}}))}function Ste(n,e){const t=en(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=qh),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Tte(n,e){const t=en(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((s=>s?(i=s,fe.resolve(i)):t.Pi.allocateTargetId(r).next((a=>(i=new Ul(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Yb(n,e,t){const r=en(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Wu(a))throw a;et(Tk,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function FL(n,e,t){const r=en(n);let i=Ft.min(),s=un();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,c,h){const g=en(l),m=g.xs.get(h);return m!==void 0?fe.resolve(g.Ms.get(m)):g.Pi.getTargetData(c,h)})(r,a,Fa(e)).next((o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,o.targetId).next((l=>{s=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:Ft.min(),t?s:un()))).next((o=>(bte(r,uee(e),o),{documents:o,Qs:s})))))}function bte(n,e,t){let r=n.Os.get(e)||Ft.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Os.set(e,r)}class jL{constructor(){this.activeTargetIds=pee()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class P8{constructor(){this.Mo=new jL,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new jL,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Rte{Oo(e){}shutdown(){}}const VL="ConnectivityMonitor";class BL{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){et(VL,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){et(VL,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let kx=null;function Zb(){return kx===null?kx=(function(){return 268435456+Math.round(2147483648*Math.random())})():kx++,"0x"+kx.toString(16)}const iT="RestConnection",Ate={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class kte{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===lv?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const a=Zb(),o=this.zo(e,t.toUriEncodedString());et(iT,`Sending RPC '${e}' ${a}:`,o,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:c}=new URL(o),h=Pd(c);return this.Jo(e,o,l,r,h).then((g=>(et(iT,`Received RPC '${e}' ${a}: `,g),g)),(g=>{throw fd(iT,`RPC '${e}' ${a} failed with error: `,g,"url: ",o,"request:",r),g}))}Ho(e,t,r,i,s,a){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+og})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const r=Ate[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class Ite{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const es="WebChannelConnection";class Cte extends kte{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const a=Zb();return new Promise(((o,l)=>{const c=new Zj;c.setWithCredentials(!0),c.listenOnce(Jj.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case r_.NO_ERROR:const g=c.getResponseJson();et(es,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),o(g);break;case r_.TIMEOUT:et(es,`RPC '${e}' ${a} timed out`),l(new ut(De.DEADLINE_EXCEEDED,"Request time out"));break;case r_.HTTP_ERROR:const m=c.getStatus();if(et(es,`RPC '${e}' ${a} failed with status:`,m,"response text:",c.getResponseText()),m>0){let y=c.getResponseJson();Array.isArray(y)&&(y=y[0]);const v=y?.error;if(v&&v.status&&v.message){const _=(function(T){const b=T.toLowerCase().replace(/_/g,"-");return Object.values(De).indexOf(b)>=0?b:De.UNKNOWN})(v.status);l(new ut(_,v.message))}else l(new ut(De.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ut(De.UNAVAILABLE,"Connection failed."));break;default:kt(9055,{l_:e,streamId:a,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{et(es,`RPC '${e}' ${a} completed.`)}}));const h=JSON.stringify(i);et(es,`RPC '${e}' ${a} sending request:`,i),c.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=Zb(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=t6(),o=e6(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=s.join("");et(es,`Creating RPC '${e}' stream ${i}: ${h}`,l);const g=a.createWebChannel(h,l);this.I_(g);let m=!1,y=!1;const v=new Ite({Yo:E=>{y?et(es,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(m||(et(es,`Opening RPC '${e}' stream ${i} transport.`),g.open(),m=!0),et(es,`RPC '${e}' stream ${i} sending:`,E),g.send(E))},Zo:()=>g.close()}),_=(E,T,b)=>{E.listen(T,(R=>{try{b(R)}catch(N){setTimeout((()=>{throw N}),0)}}))};return _(g,wm.EventType.OPEN,(()=>{y||(et(es,`RPC '${e}' stream ${i} transport opened.`),v.o_())})),_(g,wm.EventType.CLOSE,(()=>{y||(y=!0,et(es,`RPC '${e}' stream ${i} transport closed`),v.a_(),this.E_(g))})),_(g,wm.EventType.ERROR,(E=>{y||(y=!0,fd(es,`RPC '${e}' stream ${i} transport errored. Name:`,E.name,"Message:",E.message),v.a_(new ut(De.UNAVAILABLE,"The operation could not be completed")))})),_(g,wm.EventType.MESSAGE,(E=>{if(!y){const T=E.data[0];Lt(!!T,16349);const b=T,R=b?.error||b[0]?.error;if(R){et(es,`RPC '${e}' stream ${i} received error:`,R);const N=R.status;let D=(function(A){const M=Yr[A];if(M!==void 0)return Q6(M)})(N),W=R.message;D===void 0&&(D=De.INTERNAL,W="Unknown error status: "+N+" with message "+R.message),y=!0,v.a_(new ut(D,W)),g.close()}else et(es,`RPC '${e}' stream ${i} received:`,T),v.u_(T)}})),_(o,Qj.STAT_EVENT,(E=>{E.stat===Ib.PROXY?et(es,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===Ib.NOPROXY&&et(es,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{v.__()}),0),v}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Pte(){return typeof window<"u"?window:null}function f_(){return typeof document<"u"?document:null}function nE(n){return new Mee(n,!0)}class M8{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&et("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const GL="PersistentStream";class N8{constructor(e,t,r,i,s,a,o,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new M8(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===De.RESOURCE_EXHAUSTED?(vs(t.toString()),vs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===De.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new ut(De.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return et(GL,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(et(GL,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Mte extends N8{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=Oee(this.serializer,e),r=(function(s){if(!("targetChange"in s))return Ft.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ft.min():a.readTime?Ss(a.readTime):Ft.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Wb(this.serializer),t.addTarget=(function(s,a){let o;const l=a.target;if(o=uv(l)?{documents:o8(s,l)}:{query:l8(s,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=n8(s,a.resumeToken);const c=Ub(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Ft.min())>0){o.readTime=H0(s,a.snapshotVersion.toTimestamp());const c=Ub(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o})(this.serializer,e);const r=Fee(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Wb(this.serializer),t.removeTarget=e,this.q_(t)}}class Nte extends N8{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Lt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Lt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Lt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=Dee(e.writeResults,e.commitTime),r=Ss(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Wb(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>fv(this.serializer,r)))};this.q_(t)}}class Lte{}class Ote extends Lte{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ut(De.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Go(e,$b(t,r),i,s,a))).catch((s=>{throw s.name==="FirebaseError"?(s.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ut(De.UNKNOWN,s.toString())}))}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,$b(t,r),i,a,o,s))).catch((a=>{throw a.name==="FirebaseError"?(a.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ut(De.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Dte{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(vs(t),this.aa=!1):et("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const _d="RemoteStore";class Fte{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{Ld(this)&&(et(_d,"Restarting streams for network reachability change."),await(async function(l){const c=en(l);c.Ea.add(4),await Dy(c),c.Ra.set("Unknown"),c.Ea.delete(4),await rE(c)})(this))}))})),this.Ra=new Dte(r,i)}}async function rE(n){if(Ld(n))for(const e of n.da)await e(!0)}async function Dy(n){for(const e of n.da)await e(!1)}function L8(n,e){const t=en(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),kk(t)?Ak(t):cg(t).O_()&&Rk(t,e))}function bk(n,e){const t=en(n),r=cg(t);t.Ia.delete(e),r.O_()&&O8(t,e),t.Ia.size===0&&(r.O_()?r.L_():Ld(t)&&t.Ra.set("Unknown"))}function Rk(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ft.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}cg(n).Y_(e)}function O8(n,e){n.Va.Ue(e),cg(n).Z_(e)}function Ak(n){n.Va=new kee({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),cg(n).start(),n.Ra.ua()}function kk(n){return Ld(n)&&!cg(n).x_()&&n.Ia.size>0}function Ld(n){return en(n).Ea.size===0}function D8(n){n.Va=void 0}async function jte(n){n.Ra.set("Online")}async function Vte(n){n.Ia.forEach(((e,t)=>{Rk(n,e)}))}async function Bte(n,e){D8(n),kk(n)?(n.Ra.ha(e),Ak(n)):n.Ra.set("Unknown")}async function Gte(n,e,t){if(n.Ra.set("Online"),e instanceof t8&&e.state===2&&e.cause)try{await(async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ia.delete(o),i.Va.removeTarget(o))})(n,e)}catch(r){et(_d,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await xv(n,r)}else if(e instanceof h_?n.Va.Ze(e):e instanceof e8?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ft.min()))try{const r=await C8(n.localStore);t.compareTo(r)>=0&&await(function(s,a){const o=s.Va.Tt(a);return o.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(c);h&&s.Ia.set(c,h.withResumeToken(l.resumeToken,a))}})),o.targetMismatches.forEach(((l,c)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(ri.EMPTY_BYTE_STRING,h.snapshotVersion)),O8(s,l);const g=new Ul(h.target,l,c,h.sequenceNumber);Rk(s,g)})),s.remoteSyncer.applyRemoteEvent(o)})(n,t)}catch(r){et(_d,"Failed to raise snapshot:",r),await xv(n,r)}}async function xv(n,e,t){if(!Wu(e))throw e;n.Ea.add(1),await Dy(n),n.Ra.set("Offline"),t||(t=()=>C8(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{et(_d,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await rE(n)}))}function F8(n,e){return e().catch((t=>xv(n,t,e)))}async function Fy(n){const e=en(n),t=Lu(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:qh;for(;zte(e);)try{const i=await Ste(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,Ute(e,i)}catch(i){await xv(e,i)}j8(e)&&V8(e)}function zte(n){return Ld(n)&&n.Ta.length<10}function Ute(n,e){n.Ta.push(e);const t=Lu(n);t.O_()&&t.X_&&t.ea(e.mutations)}function j8(n){return Ld(n)&&!Lu(n).x_()&&n.Ta.length>0}function V8(n){Lu(n).start()}async function $te(n){Lu(n).ra()}async function Wte(n){const e=Lu(n);for(const t of n.Ta)e.ea(t.mutations)}async function Hte(n,e,t){const r=n.Ta.shift(),i=gk.from(r,e,t);await F8(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Fy(n)}async function Kte(n,e){e&&Lu(n).X_&&await(async function(r,i){if((function(a){return bee(a)&&a!==De.ABORTED})(i.code)){const s=r.Ta.shift();Lu(r).B_(),await F8(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await Fy(r)}})(n,e),j8(n)&&V8(n)}async function zL(n,e){const t=en(n);t.asyncQueue.verifyOperationInProgress(),et(_d,"RemoteStore received new credentials");const r=Ld(t);t.Ea.add(3),await Dy(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await rE(t)}async function Xte(n,e){const t=en(n);e?(t.Ea.delete(2),await rE(t)):e||(t.Ea.add(2),await Dy(t),t.Ra.set("Unknown"))}function cg(n){return n.ma||(n.ma=(function(t,r,i){const s=en(t);return s.sa(),new Mte(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:jte.bind(null,n),t_:Vte.bind(null,n),r_:Bte.bind(null,n),H_:Gte.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),kk(n)?Ak(n):n.Ra.set("Unknown")):(await n.ma.stop(),D8(n))}))),n.ma}function Lu(n){return n.fa||(n.fa=(function(t,r,i){const s=en(t);return s.sa(),new Nte(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:$te.bind(null,n),r_:Kte.bind(null,n),ta:Wte.bind(null,n),na:Hte.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Fy(n)):(await n.fa.stop(),n.Ta.length>0&&(et(_d,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Ik{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new rl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,o=new Ik(e,t,a,i,s);return o.start(r),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ut(De.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ck(n,e){if(vs("AsyncQueue",`${e}: ${n}`),Wu(n))return new ut(De.UNAVAILABLE,`${e}: ${n}`);throw n}class p0{static emptySet(e){return new p0(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ft.comparator(t.key,r.key):(t,r)=>ft.comparator(t.key,r.key),this.keyedMap=Em(),this.sortedSet=new Er(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof p0)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new p0;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class UL{constructor(){this.ga=new Er(ft.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):kt(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class K0{constructor(e,t,r,i,s,a,o,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach((o=>{a.push({type:0,doc:o})})),new K0(e,t,p0.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xw(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class qte{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Yte{constructor(){this.queries=$L(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=en(t),s=i.queries;i.queries=$L(),s.forEach(((a,o)=>{for(const l of o.Sa)l.onError(r)}))})(this,new ut(De.ABORTED,"Firestore shutting down"))}}function $L(){return new gc((n=>V6(n)),Xw)}async function B8(n,e){const t=en(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new qte,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=Ck(a,`Initialization of query '${Wf(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&Pk(t)}async function G8(n,e){const t=en(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Zte(n,e){const t=en(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.Sa)o.Fa(i)&&(r=!0);a.wa=i}}r&&Pk(t)}function Jte(n,e,t){const r=en(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function Pk(n){n.Ca.forEach((e=>{e.next()}))}var Jb,WL;(WL=Jb||(Jb={})).Ma="default",WL.Cache="cache";class z8{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new K0(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=K0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Jb.Cache}}class U8{constructor(e){this.key=e}}class $8{constructor(e){this.key=e}}class Qte{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=un(),this.mutatedKeys=un(),this.eu=B6(e),this.tu=new p0(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new UL,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,g)=>{const m=i.get(h),y=Ly(this.query,g)?g:null,v=!!m&&this.mutatedKeys.has(m.key),_=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let E=!1;m&&y?m.data.isEqual(y.data)?v!==_&&(r.track({type:3,doc:y}),E=!0):this.su(m,y)||(r.track({type:2,doc:y}),E=!0,(l&&this.eu(y,l)>0||c&&this.eu(y,c)<0)&&(o=!0)):!m&&y?(r.track({type:0,doc:y}),E=!0):m&&!y&&(r.track({type:1,doc:m}),E=!0,(l||c)&&(o=!0)),E&&(y?(a=a.add(y),s=_?s.add(h):s.delete(h)):(a=a.delete(h),s=s.delete(h)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:a,iu:r,Cs:o,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((h,g)=>(function(y,v){const _=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kt(20277,{Rt:E})}};return _(y)-_(v)})(h.type,g.type)||this.eu(h.doc,g.doc))),this.ou(r),i=i??!1;const o=t&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,c=l!==this.Za;return this.Za=l,a.length!==0||c?{snapshot:new K0(this.query,e.tu,s,a,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new UL,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=un(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new $8(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new U8(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=un();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return K0.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Mk="SyncEngine";class ene{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class tne{constructor(e){this.key=e,this.hu=!1}}class nne{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new gc((o=>V6(o)),Xw),this.Iu=new Map,this.Eu=new Set,this.du=new Er(ft.comparator),this.Au=new Map,this.Ru=new vk,this.Vu={},this.mu=new Map,this.fu=xd.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function rne(n,e,t=!0){const r=Y8(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await W8(r,e,t,!0),i}async function ine(n,e){const t=Y8(n);await W8(t,e,!0,!1)}async function W8(n,e,t,r){const i=await Tte(n.localStore,Fa(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t);let o;return r&&(o=await sne(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&L8(n.remoteStore,i),o}async function sne(n,e,t,r,i){n.pu=(g,m,y)=>(async function(_,E,T,b){let R=E.view.ru(T);R.Cs&&(R=await FL(_.localStore,E.query,!1).then((({documents:I})=>E.view.ru(I,R))));const N=b&&b.targetChanges.get(E.targetId),D=b&&b.targetMismatches.get(E.targetId)!=null,W=E.view.applyChanges(R,_.isPrimaryClient,N,D);return KL(_,E.targetId,W.au),W.snapshot})(n,g,m,y);const s=await FL(n.localStore,e,!0),a=new Qte(e,s.Qs),o=a.ru(s.documents),l=Oy.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),c=a.applyChanges(o,n.isPrimaryClient,l);KL(n,t,c.au);const h=new ene(e,t,a);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function ane(n,e,t){const r=en(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((a=>!Xw(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Yb(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&bk(r.remoteStore,i.targetId),Qb(r,i.targetId)})).catch(Nd)):(Qb(r,i.targetId),await Yb(r.localStore,i.targetId,!0))}async function one(n,e){const t=en(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),bk(t.remoteStore,r.targetId))}async function lne(n,e,t){const r=Z8(n);try{const i=await(function(a,o){const l=en(a),c=Xn.now(),h=o.reduce(((y,v)=>y.add(v.key)),un());let g,m;return l.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let v=ha(),_=un();return l.Ns.getEntries(y,h).next((E=>{v=E,v.forEach(((T,b)=>{b.isValidDocument()||(_=_.add(T))}))})).next((()=>l.localDocuments.getOverlayedDocuments(y,v))).next((E=>{g=E;const T=[];for(const b of o){const R=See(b,g.get(b.key).overlayedDocument);R!=null&&T.push(new mc(b.key,R,C6(R.value.mapValue),os.exists(!0)))}return l.mutationQueue.addMutationBatch(y,c,T,o)})).next((E=>{m=E;const T=E.applyToLocalDocumentSet(g,_);return l.documentOverlayCache.saveOverlays(y,E.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:z6(g)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,o,l){let c=a.Vu[a.currentUser.toKey()];c||(c=new Er(Qt)),c=c.insert(o,l),a.Vu[a.currentUser.toKey()]=c})(r,i.batchId,t),await jy(r,i.changes),await Fy(r.remoteStore)}catch(i){const s=Ck(i,"Failed to persist write");t.reject(s)}}async function H8(n,e){const t=en(n);try{const r=await wte(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const a=t.Au.get(s);a&&(Lt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Lt(a.hu,14607):i.removedDocuments.size>0&&(Lt(a.hu,42227),a.hu=!1))})),await jy(t,r,e)}catch(r){await Nd(r)}}function HL(n,e,t){const r=en(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)})),(function(a,o){const l=en(a);l.onlineState=o;let c=!1;l.queries.forEach(((h,g)=>{for(const m of g.Sa)m.va(o)&&(c=!0)})),c&&Pk(l)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function cne(n,e,t){const r=en(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new Er(ft.comparator);a=a.insert(s,Vr.newNoDocument(s,Ft.min()));const o=un().add(s),l=new Jw(Ft.min(),new Map,new Er(Qt),a,o);await H8(r,l),r.du=r.du.remove(s),r.Au.delete(e),Nk(r)}else await Yb(r.localStore,e,!1).then((()=>Qb(r,e,t))).catch(Nd)}async function une(n,e){const t=en(n),r=e.batch.batchId;try{const i=await vte(t.localStore,e);X8(t,r,null),K8(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await jy(t,i)}catch(i){await Nd(i)}}async function hne(n,e,t){const r=en(n);try{const i=await(function(a,o){const l=en(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let h;return l.mutationQueue.lookupMutationBatch(c,o).next((g=>(Lt(g!==null,37113),h=g.keys(),l.mutationQueue.removeMutationBatch(c,g)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,o))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h))).next((()=>l.localDocuments.getDocuments(c,h)))}))})(r.localStore,e);X8(r,e,t),K8(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await jy(r,i)}catch(i){await Nd(i)}}function K8(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function X8(n,e,t){const r=en(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Qb(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||q8(n,r)}))}function q8(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(bk(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Nk(n))}function KL(n,e,t){for(const r of t)r instanceof U8?(n.Ru.addReference(r.key,e),dne(n,r)):r instanceof $8?(et(Mk,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||q8(n,r.key)):kt(19791,{wu:r})}function dne(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(et(Mk,"New document in limbo: "+t),n.Eu.add(r),Nk(n))}function Nk(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ft(Fn.fromString(e)),r=n.fu.next();n.Au.set(r,new tne(t)),n.du=n.du.insert(t,r),L8(n.remoteStore,new Ul(Fa(Kw(t.path)),r,"TargetPurposeLimboResolution",Oa.ce))}}async function jy(n,e,t){const r=en(n),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((o,l)=>{a.push(r.pu(l,e,t).then((c=>{if((c||t)&&r.isPrimaryClient){const h=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=Sk.As(l.targetId,c);s.push(h)}})))})),await Promise.all(a),r.Pu.H_(i),await(async function(l,c){const h=en(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>fe.forEach(c,(m=>fe.forEach(m.Es,(y=>h.persistence.referenceDelegate.addReference(g,m.targetId,y))).next((()=>fe.forEach(m.ds,(y=>h.persistence.referenceDelegate.removeReference(g,m.targetId,y)))))))))}catch(g){if(!Wu(g))throw g;et(Tk,"Failed to update sequence numbers: "+g)}for(const g of c){const m=g.targetId;if(!g.fromCache){const y=h.Ms.get(m),v=y.snapshotVersion,_=y.withLastLimboFreeSnapshotVersion(v);h.Ms=h.Ms.insert(m,_)}}})(r.localStore,s))}async function fne(n,e){const t=en(n);if(!t.currentUser.isEqual(e)){et(Mk,"User change. New user:",e.toKey());const r=await I8(t.localStore,e);t.currentUser=e,(function(s,a){s.mu.forEach((o=>{o.forEach((l=>{l.reject(new ut(De.CANCELLED,a))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await jy(t,r.Ls)}}function gne(n,e){const t=en(n),r=t.Au.get(e);if(r&&r.hu)return un().add(r.key);{let i=un();const s=t.Iu.get(e);if(!s)return i;for(const a of s){const o=t.Tu.get(a);i=i.unionWith(o.view.nu)}return i}}function Y8(n){const e=en(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=H8.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=gne.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cne.bind(null,e),e.Pu.H_=Zte.bind(null,e.eventManager),e.Pu.yu=Jte.bind(null,e.eventManager),e}function Z8(n){const e=en(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=une.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=hne.bind(null,e),e}class Gp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=nE(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return k8(this.persistence,new A8,e.initialUser,this.serializer)}Cu(e){return new wk(tE.mi,this.serializer)}Du(e){return new P8}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Gp.provider={build:()=>new Gp};class mne extends Gp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Lt(this.persistence.referenceDelegate instanceof yv,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new E8(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?is.withCacheSize(this.cacheSizeBytes):is.DEFAULT;return new wk((r=>yv.mi(r,t)),this.serializer)}}class pne extends Gp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Z8(this.xu.syncEngine),await Fy(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return k8(this.persistence,new A8,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new E8(r,e.asyncQueue,t)}Mu(e,t){const r=new EQ(t,this.persistence);return new wQ(e.asyncQueue,r)}Cu(e){const t=pte(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?is.withCacheSize(this.cacheSizeBytes):is.DEFAULT;return new Ek(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Pte(),f_(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new P8}}class _v{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>HL(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=fne.bind(null,this.syncEngine),await Xte(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Yte})()}createDatastore(e){const t=nE(e.databaseInfo.databaseId),r=(function(s){return new Cte(s)})(e.databaseInfo);return(function(s,a,o,l){return new Ote(s,a,o,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,a,o){return new Fte(r,i,s,a,o)})(this.localStore,this.datastore,e.asyncQueue,(t=>HL(this.syncEngine,t,0)),(function(){return BL.v()?new BL:new Rte})())}createSyncEngine(e,t){return(function(i,s,a,o,l,c,h){const g=new nne(i,s,a,o,l,c);return h&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=en(t);et(_d,"RemoteStore shutting down."),r.Ea.add(5),await Dy(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}_v.provider={build:()=>new _v};class J8{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):vs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Ou="FirestoreClient";class yne{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=zi.UNAUTHENTICATED,this.clientId=tk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async a=>{et(Ou,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(et(Ou,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new rl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Ck(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function sT(n,e){n.asyncQueue.verifyOperationInProgress(),et(Ou,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await I8(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function XL(n,e){n.asyncQueue.verifyOperationInProgress();const t=await xne(n);et(Ou,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>zL(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>zL(e.remoteStore,i))),n._onlineComponents=e}async function xne(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){et(Ou,"Using user provided OfflineComponentProvider");try{await sT(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===De.FAILED_PRECONDITION||i.code===De.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;fd("Error using user provided cache. Falling back to memory cache: "+t),await sT(n,new Gp)}}else et(Ou,"Using default OfflineComponentProvider"),await sT(n,new mne(void 0));return n._offlineComponents}async function Q8(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(et(Ou,"Using user provided OnlineComponentProvider"),await XL(n,n._uninitializedComponentsProvider._online)):(et(Ou,"Using default OnlineComponentProvider"),await XL(n,new _v))),n._onlineComponents}function _ne(n){return Q8(n).then((e=>e.syncEngine))}async function e9(n){const e=await Q8(n),t=e.eventManager;return t.onListen=rne.bind(null,e.syncEngine),t.onUnlisten=ane.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=ine.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=one.bind(null,e.syncEngine),t}function vne(n,e,t={}){const r=new rl;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,c){const h=new J8({next:m=>{h.Nu(),a.enqueueAndForget((()=>G8(s,g)));const y=m.docs.has(o);!y&&m.fromCache?c.reject(new ut(De.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&l&&l.source==="server"?c.reject(new ut(De.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),g=new z8(Kw(o.path),h,{includeMetadataChanges:!0,qa:!0});return B8(s,g)})(await e9(n),n.asyncQueue,e,t,r))),r.promise}function wne(n,e,t={}){const r=new rl;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,c){const h=new J8({next:m=>{h.Nu(),a.enqueueAndForget((()=>G8(s,g))),m.fromCache&&l.source==="server"?c.reject(new ut(De.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),g=new z8(o,h,{includeMetadataChanges:!0,qa:!0});return B8(s,g)})(await e9(n),n.asyncQueue,e,t,r))),r.promise}function t9(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const qL=new Map;const n9="firestore.googleapis.com",YL=!0;class ZL{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ut(De.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=n9,this.ssl=YL}else this.host=e.host,this.ssl=e.ssl??YL;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=x8;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Qee)throw new ut(De.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}yQ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=t9(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ut(De.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ut(De.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ut(De.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class iE{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ZL({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ut(De.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ut(De.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ZL(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new oQ;switch(r.type){case"firstParty":return new hQ(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ut(De.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=qL.get(t);r&&(et("ComponentProvider","Removing Datastore"),qL.delete(t),r.terminate())})(this),Promise.resolve()}}function Ene(n,e,t,r={}){n=za(n,iE);const i=Pd(e),s=n._getSettings(),a={...s,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;i&&(BA(`https://${o}`),GA("Firestore",!0)),s.host!==n9&&s.host!==o&&fd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:o,ssl:i,emulatorOptions:r};if(!cd(l,a)&&(n._setSettings(l),r.mockUserToken)){let c,h;if(typeof r.mockUserToken=="string")c=r.mockUserToken,h=zi.MOCK_USER;else{c=oj(r.mockUserToken,n._app?.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new ut(De.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new zi(g)}n._authCredentials=new lQ(new r6(c,h))}}class ug{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ug(this.firestore,e,this._query)}}class Hr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ru(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Hr(this.firestore,e,this._key)}toJSON(){return{type:Hr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Cy(t,Hr._jsonSchema))return new Hr(e,r||null,new ft(Fn.fromString(t.referencePath)))}}Hr._jsonSchemaVersion="firestore/documentReference/1.0",Hr._jsonSchema={type:ei("string",Hr._jsonSchemaVersion),referencePath:ei("string")};class Ru extends ug{constructor(e,t,r){super(e,t,Kw(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Hr(this.firestore,null,new ft(e))}withConverter(e){return new Ru(this.firestore,e,this._path)}}function JL(n,e,...t){if(n=Ci(n),s6("collection","path",e),n instanceof iE){const r=Fn.fromString(e,...t);return GN(r),new Ru(n,null,r)}{if(!(n instanceof Hr||n instanceof Ru))throw new ut(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Fn.fromString(e,...t));return GN(r),new Ru(n.firestore,null,r)}}function y0(n,e,...t){if(n=Ci(n),arguments.length===1&&(e=tk.newId()),s6("doc","path",e),n instanceof iE){const r=Fn.fromString(e,...t);return BN(r),new Hr(n,null,new ft(r))}{if(!(n instanceof Hr||n instanceof Ru))throw new ut(De.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Fn.fromString(e,...t));return BN(r),new Hr(n.firestore,n instanceof Ru?n.converter:null,new ft(r))}}const QL="AsyncQueue";class e3{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new M8(this,"async_queue_retry"),this._c=()=>{const r=f_();r&&et(QL,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=f_();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=f_();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new rl;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Wu(e))throw e;et(QL,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,vs("INTERNAL UNHANDLED ERROR: ",t3(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=Ik.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&kt(47125,{Pc:t3(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function t3(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Ku extends iE{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new e3,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new e3(e),this._firestoreClient=void 0,await e}}}function Sne(n,e){const t=typeof n=="object"?n:$A(),r=typeof n=="string"?n:lv,i=Ow(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=ij("firestore");s&&Ene(i,...s)}return i}function Lk(n){if(n._terminated)throw new ut(De.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||r9(n),n._firestoreClient}function r9(n){const e=n._freezeSettings(),t=(function(i,s,a,o){return new ZQ(i,s,a,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,t9(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new yne(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}function Tne(n,e){fd("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return bne(n,_v.provider,{build:r=>new pne(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function bne(n,e,t){if((n=za(n,Ku))._firestoreClient||n._terminated)throw new ut(De.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ut(De.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},r9(n)}class Pa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Pa(ri.fromBase64String(e))}catch(t){throw new ut(De.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Pa(ri.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Pa._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Cy(e,Pa._jsonSchema))return Pa.fromBase64String(e.bytes)}}Pa._jsonSchemaVersion="firestore/bytes/1.0",Pa._jsonSchema={type:ei("string",Pa._jsonSchemaVersion),bytes:ei("string")};class sE{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ut(De.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Cr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class aE{constructor(e){this._methodName=e}}class il{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ut(De.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ut(De.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Qt(this._lat,e._lat)||Qt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:il._jsonSchemaVersion}}static fromJSON(e){if(Cy(e,il._jsonSchema))return new il(e.latitude,e.longitude)}}il._jsonSchemaVersion="firestore/geoPoint/1.0",il._jsonSchema={type:ei("string",il._jsonSchemaVersion),latitude:ei("number"),longitude:ei("number")};class sl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:sl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Cy(e,sl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new sl(e.vectorValues);throw new ut(De.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}sl._jsonSchemaVersion="firestore/vectorValue/1.0",sl._jsonSchema={type:ei("string",sl._jsonSchemaVersion),vectorValues:ei("object")};const Rne=/^__.*__$/;class Ane{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new mc(e,this.data,this.fieldMask,t,this.fieldTransforms):new lg(e,this.data,t,this.fieldTransforms)}}class i9{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new mc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function s9(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw kt(40011,{Ac:n})}}class Ok{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ok({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return vv(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(s9(this.Ac)&&Rne.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class kne{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||nE(e)}Cc(e,t,r,i=!1){return new Ok({Ac:e,methodName:t,Dc:r,path:Cr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function oE(n){const e=n._freezeSettings(),t=nE(n._databaseId);return new kne(n._databaseId,!!e.ignoreUndefinedProperties,t)}function a9(n,e,t,r,i,s={}){const a=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);Fk("Data must be an object, but it was:",a,r);const o=o9(r,a);let l,c;if(s.merge)l=new Vs(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const h=[];for(const g of s.mergeFields){const m=eR(e,g,t);if(!a.contains(m))throw new ut(De.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);c9(h,m)||h.push(m)}l=new Vs(h),c=a.fieldTransforms.filter((g=>l.covers(g.field)))}else l=null,c=a.fieldTransforms;return new Ane(new as(o),l,c)}class lE extends aE{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof lE}}class Dk extends aE{_toFieldTransform(e){return new q6(e.path,new U0)}isEqual(e){return e instanceof Dk}}function Ine(n,e,t,r){const i=n.Cc(1,e,t);Fk("Data must be an object, but it was:",i,r);const s=[],a=as.empty();Hu(r,((l,c)=>{const h=jk(e,l,t);c=Ci(c);const g=i.yc(h);if(c instanceof lE)s.push(h);else{const m=Vy(c,g);m!=null&&(s.push(h),a.set(h,m))}}));const o=new Vs(s);return new i9(a,o,i.fieldTransforms)}function Cne(n,e,t,r,i,s){const a=n.Cc(1,e,t),o=[eR(e,r,t)],l=[i];if(s.length%2!=0)throw new ut(De.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)o.push(eR(e,s[m])),l.push(s[m+1]);const c=[],h=as.empty();for(let m=o.length-1;m>=0;--m)if(!c9(c,o[m])){const y=o[m];let v=l[m];v=Ci(v);const _=a.yc(y);if(v instanceof lE)c.push(y);else{const E=Vy(v,_);E!=null&&(c.push(y),h.set(y,E))}}const g=new Vs(c);return new i9(h,g,a.fieldTransforms)}function Pne(n,e,t,r=!1){return Vy(t,n.Cc(r?4:3,e))}function Vy(n,e){if(l9(n=Ci(n)))return Fk("Unsupported field value:",e,n),o9(n,e);if(n instanceof aE)return(function(r,i){if(!s9(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let a=0;for(const o of r){let l=Vy(o,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=Ci(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return yee(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Xn.fromDate(r);return{timestampValue:H0(i.serializer,s)}}if(r instanceof Xn){const s=new Xn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:H0(i.serializer,s)}}if(r instanceof il)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Pa)return{bytesValue:n8(i.serializer,r._byteString)};if(r instanceof Hr){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:yk(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof sl)return(function(a,o){return{mapValue:{fields:{[ck]:{stringValue:uk},[V0]:{arrayValue:{values:a.toArray().map((c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return dk(o.serializer,c)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Vw(r)}`)})(n,e)}function o9(n,e){const t={};return w6(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Hu(n,((r,i)=>{const s=Vy(i,e.mc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function l9(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Xn||n instanceof il||n instanceof Pa||n instanceof Hr||n instanceof aE||n instanceof sl)}function Fk(n,e,t){if(!l9(t)||!a6(t)){const r=Vw(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function eR(n,e,t){if((e=Ci(e))instanceof sE)return e._internalPath;if(typeof e=="string")return jk(n,e);throw vv("Field path arguments must be of type string or ",n,!1,void 0,t)}const Mne=new RegExp("[~\\*/\\[\\]]");function jk(n,e,t){if(e.search(Mne)>=0)throw vv(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new sE(...e.split("."))._internalPath}catch{throw vv(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function vv(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new ut(De.INVALID_ARGUMENT,o+n+l)}function c9(n,e){return n.some((t=>t.isEqual(e)))}class u9{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Hr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Nne(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Vk("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Nne extends u9{data(){return super.data()}}function Vk(n,e){return typeof e=="string"?jk(n,e):e instanceof sE?e._internalPath:e._delegate._internalPath}function Lne(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ut(De.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Bk{}class One extends Bk{}function Dne(n,e,...t){let r=[];e instanceof Bk&&r.push(e),r=r.concat(t),(function(s){const a=s.filter((l=>l instanceof Gk)).length,o=s.filter((l=>l instanceof cE)).length;if(a>1||a>0&&o>0)throw new ut(De.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class cE extends One{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new cE(e,t,r)}_apply(e){const t=this._parse(e);return h9(e._query,t),new ug(e.firestore,e.converter,Gb(e._query,t))}_parse(e){const t=oE(e.firestore);return(function(s,a,o,l,c,h,g){let m;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new ut(De.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){r3(g,h);const v=[];for(const _ of g)v.push(n3(l,s,_));m={arrayValue:{values:v}}}else m=n3(l,s,g)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||r3(g,h),m=Pne(o,a,g,h==="in"||h==="not-in");return xn.create(c,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Fne(n,e,t){const r=e,i=Vk("where",n);return cE._create(i,r,t)}class Gk extends Bk{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Gk(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Yn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)h9(a,l),a=Gb(a,l)})(e._query,t),new ug(e.firestore,e.converter,Gb(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function n3(n,e,t){if(typeof(t=Ci(t))=="string"){if(t==="")throw new ut(De.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!j6(e)&&t.indexOf("/")!==-1)throw new ut(De.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Fn.fromString(t));if(!ft.isDocumentKey(r))throw new ut(De.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return jp(n,new ft(r))}if(t instanceof Hr)return jp(n,t._key);throw new ut(De.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vw(t)}.`)}function r3(n,e){if(!Array.isArray(n)||n.length===0)throw new ut(De.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function h9(n,e){const t=(function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ut(De.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ut(De.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class jne{convertValue(e,t="none"){switch(Mu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ac(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw kt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Hu(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){const t=e.fields?.[V0].arrayValue?.values?.map((r=>xr(r.doubleValue)));return new sl(t)}convertGeoPoint(e){return new il(xr(e.latitude),xr(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Ww(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Dp(e));default:return null}}convertTimestamp(e){const t=sc(e);return new Xn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Fn.fromString(e);Lt(d8(r),9688,{name:e});const i=new gd(r.get(1),r.get(3)),s=new ft(r.popFirst(5));return i.isEqual(t)||vs(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function d9(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class bm{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Jh extends u9{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new g_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Vk("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ut(De.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Jh._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Jh._jsonSchemaVersion="firestore/documentSnapshot/1.0",Jh._jsonSchema={type:ei("string",Jh._jsonSchemaVersion),bundleSource:ei("string","DocumentSnapshot"),bundleName:ei("string"),bundle:ei("string")};class g_ extends Jh{data(e={}){return super.data(e)}}class x0{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new bm(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new g_(this._firestore,this._userDataWriter,r.key,r,new bm(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ut(De.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((o=>{const l=new g_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new bm(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((o=>s||o.type!==3)).map((o=>{const l=new g_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new bm(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:Vne(o.type),doc:l,oldIndex:c,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ut(De.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=x0._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=tk.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Vne(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kt(61501,{type:n})}}function Bne(n){n=za(n,Hr);const e=za(n.firestore,Ku);return vne(Lk(e),n._key).then((t=>Wne(e,n,t)))}x0._jsonSchemaVersion="firestore/querySnapshot/1.0",x0._jsonSchema={type:ei("string",x0._jsonSchemaVersion),bundleSource:ei("string","QuerySnapshot"),bundleName:ei("string"),bundle:ei("string")};class f9 extends jne{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pa(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Hr(this.firestore,null,t)}}function Gne(n){n=za(n,ug);const e=za(n.firestore,Ku),t=Lk(e),r=new f9(e);return Lne(n._query),wne(t,n._query).then((i=>new x0(e,r,n,i)))}function i3(n,e,t){n=za(n,Hr);const r=za(n.firestore,Ku),i=d9(n.converter,e,t);return uE(r,[a9(oE(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,os.none())])}function zne(n,e,t,...r){n=za(n,Hr);const i=za(n.firestore,Ku),s=oE(i);let a;return a=typeof(e=Ci(e))=="string"||e instanceof sE?Cne(s,"updateDoc",n._key,e,t,r):Ine(s,"updateDoc",n._key,e),uE(i,[a.toMutation(n._key,os.exists(!0))])}function Une(n){return uE(za(n.firestore,Ku),[new Zw(n._key,os.none())])}function $ne(n,e){const t=za(n.firestore,Ku),r=y0(n),i=d9(n.converter,e);return uE(t,[a9(oE(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,os.exists(!1))]).then((()=>r))}function uE(n,e){return(function(r,i){const s=new rl;return r.asyncQueue.enqueueAndForget((async()=>lne(await _ne(r),i,s))),s.promise})(Lk(n),e)}function Wne(n,e,t){const r=t.docs.get(e._key),i=new f9(n);return new Jh(n,i,e._key,r,new bm(t.hasPendingWrites,t.fromCache),e.converter)}function s3(){return new Dk("serverTimestamp")}(function(e,t=!0){(function(i){og=i})(Md),ud(new Cu("firestore",((r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),o=new Ku(new cQ(r.getProvider("auth-internal")),new dQ(a,r.getProvider("app-check-internal")),(function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ut(De.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gd(c.options.projectId,h)})(a,i),a);return s={useFetchStreams:t,...s},o._setSettings(s),o}),"PUBLIC").setMultipleInstances(!0)),tl(DN,FN,e),tl(DN,FN,"esm2020")})();const g9="firebasestorage.googleapis.com",Hne="storageBucket",Kne=120*1e3,Xne=600*1e3;class xl extends yl{constructor(e,t,r=0){super(aT(e),`Firebase Storage: ${t} (${aT(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,xl.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return aT(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var dl;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(dl||(dl={}));function aT(n){return"storage/"+n}function qne(){const n="An unknown error occurred, please check the error payload for server response.";return new xl(dl.UNKNOWN,n)}function Yne(){return new xl(dl.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Zne(){return new xl(dl.CANCELED,"User canceled the upload/download.")}function Jne(n){return new xl(dl.INVALID_URL,"Invalid URL '"+n+"'.")}function Qne(n){return new xl(dl.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function a3(n){return new xl(dl.INVALID_ARGUMENT,n)}function m9(){return new xl(dl.APP_DELETED,"The Firebase app was deleted.")}function ere(n){return new xl(dl.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class go{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=go.makeFromUrl(e,t)}catch{return new go(e,"")}if(r.path==="")return r;throw Qne(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function c(N){N.path_=decodeURIComponent(N.path)}const h="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",y=new RegExp(`^https?://${g}/${h}/b/${i}/o${m}`,"i"),v={bucket:1,path:3},_=t===g9?"(?:storage.googleapis.com|storage.cloud.google.com)":t,E="([^?#]*)",T=new RegExp(`^https?://${_}/${i}/${E}`,"i"),R=[{regex:o,indices:l,postModify:s},{regex:y,indices:v,postModify:c},{regex:T,indices:{bucket:1,path:2},postModify:c}];for(let N=0;N<R.length;N++){const D=R[N],W=D.regex.exec(e);if(W){const I=W[D.indices.bucket];let A=W[D.indices.path];A||(A=""),r=new go(I,A),D.postModify(r);break}}if(r==null)throw Jne(e);return r}}class tre{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function nre(n,e,t){let r=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let c=!1;function h(...E){c||(c=!0,e.apply(null,E))}function g(E){i=setTimeout(()=>{i=null,n(y,l())},E)}function m(){s&&clearTimeout(s)}function y(E,...T){if(c){m();return}if(E){m(),h.call(null,E,...T);return}if(l()||a){m(),h.call(null,E,...T);return}r<64&&(r*=2);let R;o===1?(o=2,R=0):R=(r+Math.random())*1e3,g(R)}let v=!1;function _(E){v||(v=!0,m(),!c&&(i!==null?(E||(o=2),clearTimeout(i),g(0)):E||(o=1)))}return g(0),s=setTimeout(()=>{a=!0,_(!0)},t),_}function rre(n){n(!1)}function ire(n){return n!==void 0}function o3(n,e,t,r){if(r<e)throw a3(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw a3(`Invalid value for '${n}'. Expected ${t} or less.`)}function sre(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var wv;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(wv||(wv={}));function are(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}class ore{constructor(e,t,r,i,s,a,o,l,c,h,g,m=!0,y=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=g,this.retry=m,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,_)=>{this.resolve_=v,this.reject_=_,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Ix(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===wv.NO_ERROR,l=s.getStatus();if(!o||are(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===wv.ABORT;r(!1,new Ix(!1,null,h));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new Ix(c,s))})},t=(r,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());ire(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=qne();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?m9():Zne();a(l)}else{const l=Yne();a(l)}};this.canceled_?t(!1,new Ix(!1,null,!0)):this.backoffId_=nre(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&rre(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ix{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function lre(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function cre(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function ure(n,e){e&&(n["X-Firebase-GMPID"]=e)}function hre(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function dre(n,e,t,r,i,s,a=!0,o=!1){const l=sre(n.urlParams),c=n.url+l,h=Object.assign({},n.headers);return ure(h,e),lre(h,t),cre(h,s),hre(h,r),new ore(c,n.method,h,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,o)}function fre(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function gre(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class Ev{constructor(e,t){this._service=e,t instanceof go?this._location=t:this._location=go.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Ev(e,t)}get root(){const e=new go(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return gre(this._location.path)}get storage(){return this._service}get parent(){const e=fre(this._location.path);if(e===null)return null;const t=new go(this._location.bucket,e);return new Ev(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw ere(e)}}function l3(n,e){const t=e?.[Hne];return t==null?null:go.makeFromBucketSpec(t,n)}function mre(n,e,t,r={}){n.host=`${e}:${t}`;const i=Pd(e);i&&(BA(`https://${n.host}/b`),GA("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:oj(s,n.app.options.projectId))}class pre{constructor(e,t,r,i,s,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=g9,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Kne,this._maxUploadRetryTime=Xne,this._requests=new Set,i!=null?this._bucket=go.makeFromBucketSpec(i,this._host):this._bucket=l3(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=go.makeFromBucketSpec(this._url,e):this._bucket=l3(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){o3("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){o3("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(ca(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ev(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new tre(m9());{const a=dre(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const c3="@firebase/storage",u3="0.14.0";const p9="storage";function yre(n=$A(),e){n=Ci(n);const r=Ow(n,p9).getImmediate({identifier:e}),i=ij("storage");return i&&xre(r,...i),r}function xre(n,e,t,r={}){mre(n,e,t,r)}function _re(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new pre(t,r,i,e,Md)}function vre(){ud(new Cu(p9,_re,"PUBLIC").setMultipleInstances(!0)),tl(c3,u3,""),tl(c3,u3,"esm2020")}vre();const wre={apiKey:"AIzaSyBcLuKvUr5XqEJTwOf9I0hqJ1o9g3kOZ-g",authDomain:"detectorapp-nl.firebaseapp.com",projectId:"detectorapp-nl",storageBucket:"detectorapp-nl.firebasestorage.app",messagingSenderId:"110954177210",appId:"1:110954177210:web:d77c9ed262ad92bc431883"},zk=gj(wre),Uh=rQ(zk),gu=Sne(zk);yre(zk);Tne(gu).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const Ere={};function Sre(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var s;const a=l=>l===null?null:JSON.parse(l,void 0),o=(s=t.getItem(i))!=null?s:null;return o instanceof Promise?o.then(a):a(o)},setItem:(i,s)=>t.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>t.removeItem(i)}}const zp=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return zp(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return zp(r)(t)}}}},Tre=(n,e)=>(t,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:E=>E,version:0,merge:(E,T)=>({...T,...E}),...e},a=!1;const o=new Set,l=new Set;let c;try{c=s.getStorage()}catch{}if(!c)return n((...E)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...E)},r,i);const h=zp(s.serialize),g=()=>{const E=s.partialize({...r()});let T;const b=h({state:E,version:s.version}).then(R=>c.setItem(s.name,R)).catch(R=>{T=R});if(T)throw T;return b},m=i.setState;i.setState=(E,T)=>{m(E,T),g()};const y=n((...E)=>{t(...E),g()},r,i);let v;const _=()=>{var E;if(!c)return;a=!1,o.forEach(b=>b(r()));const T=((E=s.onRehydrateStorage)==null?void 0:E.call(s,r()))||void 0;return zp(c.getItem.bind(c))(s.name).then(b=>{if(b)return s.deserialize(b)}).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return s.migrate(b.state,b.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return b.state}).then(b=>{var R;return v=s.merge(b,(R=r())!=null?R:y),t(v,!0),g()}).then(()=>{T?.(v,void 0),a=!0,l.forEach(b=>b(v))}).catch(b=>{T?.(void 0,b)})};return i.persist={setOptions:E=>{s={...s,...E},E.getStorage&&(c=E.getStorage())},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>_(),hasHydrated:()=>a,onHydrate:E=>(o.add(E),()=>{o.delete(E)}),onFinishHydration:E=>(l.add(E),()=>{l.delete(E)})},_(),v||y},bre=(n,e)=>(t,r,i)=>{let s={storage:Sre(()=>localStorage),partialize:_=>_,version:0,merge:(_,E)=>({...E,..._}),...e},a=!1;const o=new Set,l=new Set;let c=s.storage;if(!c)return n((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(..._)},r,i);const h=()=>{const _=s.partialize({...r()});return c.setItem(s.name,{state:_,version:s.version})},g=i.setState;i.setState=(_,E)=>{g(_,E),h()};const m=n((..._)=>{t(..._),h()},r,i);i.getInitialState=()=>m;let y;const v=()=>{var _,E;if(!c)return;a=!1,o.forEach(b=>{var R;return b((R=r())!=null?R:m)});const T=((E=s.onRehydrateStorage)==null?void 0:E.call(s,(_=r())!=null?_:m))||void 0;return zp(c.getItem.bind(c))(s.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return[!0,s.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var R;const[N,D]=b;if(y=s.merge(D,(R=r())!=null?R:m),t(y,!0),N)return h()}).then(()=>{T?.(y,void 0),y=r(),a=!0,l.forEach(b=>b(y))}).catch(b=>{T?.(void 0,b)})};return i.persist={setOptions:_=>{s={...s,..._},_.storage&&(c=_.storage)},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>v(),hasHydrated:()=>a,onHydrate:_=>(o.add(_),()=>{o.delete(_)}),onFinishHydration:_=>(l.add(_),()=>{l.delete(_)})},s.skipHydration||v(),y||m},Rre=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((Ere?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Tre(n,e)):bre(n,e),pc=Rre,ur=bs()(pc(n=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,vondstenLocalOnly:!0,showVondstButton:!1,showRouteRecordButton:!1,showLocalVondsten:!0,showCustomPointLayers:!0,fontScale:100,layerPanelFontScale:100,presetPanelFontScale:100,menuFontScale:100,voiceFeedbackEnabled:!1,showStepCounter:!1,showFontSliders:!1,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setVondstenLocalOnly:e=>n({vondstenLocalOnly:e}),setShowVondstButton:e=>n({showVondstButton:e}),setShowRouteRecordButton:e=>n({showRouteRecordButton:e}),setShowLocalVondsten:e=>n({showLocalVondsten:e}),setShowCustomPointLayers:e=>n({showCustomPointLayers:e}),setFontScale:e=>n({fontScale:e}),setLayerPanelFontScale:e=>n({layerPanelFontScale:e}),setPresetPanelFontScale:e=>n({presetPanelFontScale:e}),setMenuFontScale:e=>n({menuFontScale:e}),setVoiceFeedbackEnabled:e=>n({voiceFeedbackEnabled:e}),setShowStepCounter:e=>n({showStepCounter:e}),setShowFontSliders:e=>n({showFontSliders:e})}),{name:"detectorapp-settings",version:2,migrate:(n,e)=>e<2?{...n,showScaleBar:!0}:n})),hE=bs()(sg((n,e)=>({user:null,accessToken:null,loading:!1,error:null,initialized:!1,setUser:t=>{n(r=>{r.user=t,r.loading=!1})},setLoading:t=>{n(r=>{r.loading=t})},setError:t=>{n(r=>{r.error=t})},setAccessToken:t=>{n(r=>{r.accessToken=t})},signInWithGoogle:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new co;await AN(Uh,t)}catch(t){console.error("Google sign-in error:",t),n(r=>{r.error=t.message,r.loading=!1})}},connectGoogleFit:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new co;t.addScope("https://www.googleapis.com/auth/fitness.activity.read");const r=await AN(Uh,t),i=co.credentialFromResult(r);return i?.accessToken?(n(s=>{s.accessToken=i.accessToken||null,s.loading=!1}),console.log(" Google Fit gekoppeld"),!0):(n(s=>{s.loading=!1}),!1)}catch(t){return console.error("Google Fit connect error:",t),n(r=>{r.error=t.message,r.loading=!1}),!1}},logout:async()=>{n(t=>{t.loading=!0});try{await jj(Uh),n(t=>{t.accessToken=null})}catch(t){console.error("Logout error:",t),n(r=>{r.error=t.message,r.loading=!1})}},initAuth:()=>{e().initialized||(n(t=>{t.initialized=!0}),Fj(Uh,t=>{n(r=>{r.user=t,r.loading=!1}),t&&ur.getState().setVondstenLocalOnly(!1)}))}})));bs()(sg((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(r=>{r.loading=!0});try{const r=Dne(JL(gu,"vondsten"),Fne("userId","==",t)),s=(await Gne(r)).docs.map(a=>({id:a.id,...a.data()}));n(a=>{a.vondsten=s,a.loading=!1})}catch(r){n(i=>{i.error=r.message,i.loading=!1})}},addVondst:async t=>{const r=new Date().toISOString(),i={...t,createdAt:r,updatedAt:r},s=await $ne(JL(gu,"vondsten"),i);return n(a=>{a.vondsten.push({...i,id:s.id})}),s.id},updateVondst:async(t,r)=>{const i=y0(gu,"vondsten",t);await zne(i,{...r,updatedAt:new Date().toISOString()}),n(s=>{const a=s.vondsten.findIndex(o=>o.id===t);a!==-1&&(s.vondsten[a]={...s.vondsten[a],...r})})},deleteVondst:async t=>{await Une(y0(gu,"vondsten",t)),n(r=>{r.vondsten=r.vondsten.filter(i=>i.id!==t)})}})));const oT=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AMK Monumenten","Gewaspercelen"],baseLayer:"CartoDB (licht)",isBuiltIn:!1},{id:"steentijd",name:"Steentijd",icon:"Mountain",layers:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","AMK Steentijd","AHN4 Multi-Hillshade NL","Labels Overlay"],baseLayer:"Luchtfoto",isBuiltIn:!1},{id:"romeins-midvroeg",name:"Romeins - Mid vroeg",icon:"Layers",layers:["Romeinse wegen (regio)","Romeinse Forten","Romeinse Forten Lijnen","AMK Romeins","AMK Vroege ME","Gewaspercelen","Kadastrale Grenzen"],isBuiltIn:!1},{id:"midlaat-nieuwetijd",name:"Mid laat - Nieuwe tijd",icon:"Grid",layers:["AMK Late ME","Kastelen","Essen","Rijksmonumenten","Gewaspercelen","Kadastrale Grenzen","Oude Kernen"],isBuiltIn:!1},{id:"woii-militair",name:"WOII & Militair",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten"],isBuiltIn:!1},{id:"analyse",name:"Terrein Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","Archeo Landschappen","AHN4 Multi-Hillshade NL","AHN4 Hoogtekaart Kleur"],isBuiltIn:!1}],h3=["Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],y9=bs()(pc((n,e)=>({presets:[...oT],applyPreset:t=>{const r=e().presets.find(s=>s.id===t);if(!r)return;const i=bi.getState();h3.forEach(s=>i.setLayerVisibility(s,!1)),r.layers.forEach(s=>i.setLayerVisibility(s,!0)),r.baseLayer&&["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(a=>{i.setLayerVisibility(a,a===r.baseLayer)}),console.log(` Preset toegepast: ${r.name}${r.baseLayer?` (${r.baseLayer})`:""}`)},createPreset:(t,r)=>{const i=bi.getState(),s=Object.entries(i.visible).filter(([o,l])=>l&&h3.includes(o)).map(([o])=>o),a={id:`custom-${Date.now()}`,name:t,icon:r,layers:s,isBuiltIn:!1};n(o=>({presets:[...o.presets,a]})),console.log(` Preset aangemaakt: ${t} met ${s.length} lagen`)},updatePreset:(t,r)=>{n(i=>({presets:i.presets.map(s=>s.id===t?{...s,...r}:s)}))},deletePreset:t=>{n(r=>({presets:r.presets.filter(i=>i.id!==t||i.isBuiltIn)}))},resetToDefaults:()=>{n({presets:[...oT]})}}),{name:"detectorapp-presets",version:9,migrate:(n,e)=>e<9?{presets:[...oT]}:n})),d3=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],By=bs()(pc((n,e)=>({layers:[],addLayer:t=>{const r=crypto.randomUUID(),i=e().layers.length,s=d3[i%d3.length];return n(a=>({layers:[...a.layers,{...t,id:r,createdAt:new Date().toISOString(),color:t.color||s,visible:t.visible??!0,opacity:t.opacity??1}]})),r},removeLayer:t=>n(r=>({layers:r.layers.filter(i=>i.id!==t)})),updateLayer:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)})),toggleVisibility:t=>n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)})),setOpacity:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,opacity:r}:s)})),setColor:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,color:r}:s)})),clearAll:()=>n({layers:[]})}),{name:"detectorapp-custom-layers",version:1})),Are=["CartoDB (licht)","OpenStreetMap","Luchtfoto","Labels Overlay","Mijn Vondsten"],Uk=bs()(pc((n,e)=>({tier:"free",unlockedRegions:["nl"],devMode:!0,setTier:t=>n({tier:t}),unlockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.includes(t)?r.unlockedRegions:[...r.unlockedRegions,t]})),lockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.filter(i=>i!==t)})),setDevMode:t=>n({devMode:t}),isRegionUnlocked:t=>{const r=e();return r.devMode||r.tier==="pro"?!0:r.unlockedRegions.includes(t)},isLayerUnlocked:(t,r="free",i=["nl"])=>{const s=e();return s.devMode||Are.includes(t)||r==="free"||s.tier==="pro"?!0:s.tier==="premium"?i.some(a=>s.unlockedRegions.includes(a)):!1},canAccessPremiumFeatures:()=>{const t=e();return t.devMode||t.tier!=="free"}}),{name:"detectorapp-subscription",version:1}));bs()(pc(n=>({parkingLocation:null,showParkingButton:!0,setParkingLocation:e=>n({parkingLocation:e}),clearParkingLocation:()=>n({parkingLocation:null}),setShowParkingButton:e=>n({showParkingButton:e})}),{name:"detectorapp-parking"}));function f3(){return new Date().toISOString().split("T")[0]}bs()(pc((n,e)=>({steps:0,distance:0,startTime:null,isActive:!1,todaySteps:0,todayDate:f3(),stepLength:.75,incrementStep:()=>{const t=e(),r=f3(),i=t.todayDate===r?t.todaySteps+1:1;n({steps:t.steps+1,distance:(t.steps+1)*t.stepLength,todaySteps:i,todayDate:r})},resetSession:()=>{n({steps:0,distance:0,startTime:null})},setActive:t=>{n({isActive:t,startTime:t?Date.now():e().startTime})},setStepLength:t=>{const r=e();n({stepLength:t,distance:r.steps*t})}}),{name:"step-counter-storage",partialize:n=>({todaySteps:n.todaySteps,todayDate:n.todayDate,stepLength:n.stepLength})}));function kre({target:n,viewOptions:e}){const t=X.useRef(null),r=X.useRef(null),i=pi(a=>a.setMap),s=ur(a=>a.showScaleBar);return X.useEffect(()=>{if(!t.current){const a={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},o=new JX({target:n,controls:[],view:new qo({center:kr(a.center),zoom:a.zoom,rotation:a.rotation,minZoom:a.minZoom,maxZoom:a.maxZoom})});t.current=o,i(o),window.__olMap=o}return()=>{t.current&&(t.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,e,i]),X.useEffect(()=>{const a=t.current;a&&(s?r.current||(r.current=new tq({units:"metric",bar:!1,text:!0,minWidth:80}),a.addControl(r.current)):r.current&&(a.removeControl(r.current),r.current=null))},[s]),t.current}const g3=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function Ire(){const n=X.useRef(null),e=X.useRef(!1);kre({target:"map"});const t=pi(g=>g.map),r=bi(g=>g.registerLayer),i=bi(g=>g.setLayerVisibility),s=ur(g=>g.defaultBackground);X.useEffect(()=>{if(!t){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const g=new Sh({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new yX}),m=new Sh({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new zf({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),y=new Sh({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new zf({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),v=new Sh({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new zf({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),_=new Sh({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new zf({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),E=new Sh({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new zf({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});t.addLayer(g),t.addLayer(m),t.addLayer(y),t.addLayer(v),t.addLayer(_),t.addLayer(E),console.log(" Base layers added:",{osm:g.getVisible(),cartodb:m.getVisible(),satellite:y.getVisible()}),r("OpenStreetMap",g),r("CartoDB (licht)",m),r("Luchtfoto",y),r("Labels Overlay",v),r("TMK 1850",_),r("Bonnebladen 1900",E),t.updateSize(),console.log(" Map size:",t.getSize()),console.log(" Map center:",t.getView().getCenter()),console.log(" Map zoom:",t.getView().getZoom()),a()},[t,r]);async function a(){if(!t){console.error(" Cannot load layers: map is null");return}const g=kq();console.log(` Loading ${g.length} immediate-load layers (WMS/Tile)...`);const m=await Promise.allSettled(g.map(async v=>{try{const _=await v.factory();return _?{name:v.name,layer:_}:null}catch(_){return console.warn(` Failed to create ${v.name}:`,_),null}}));let y=0;m.forEach(v=>{if(v.status==="fulfilled"&&v.value){const{name:_,layer:E}=v.value;t.addLayer(E),r(_,E),y++,console.log(`   ${_}`)}}),console.log(` Immediate layers loaded: ${y}/${g.length}`),console.log(` Total layers on map: ${t.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}X.useEffect(()=>{if(!t||e.current)return;const g=setTimeout(()=>{const m=s||"CartoDB (licht)";g3.forEach(y=>{i(y,!1)}),g3.includes(m)?i(m,!0):i("CartoDB (licht)",!0),e.current=!0,console.log(` Default background: ${m}`)},100);return()=>clearTimeout(g)},[t,s,i]);const o=ur(g=>g.gpsAutoStart),l=xs(g=>g.startTracking),c=X.useRef(!1);X.useEffect(()=>{if(!(!t||c.current)&&o){const g=setTimeout(()=>{l(),c.current=!0,console.log(" GPS autostart enabled - tracking started")},500);return()=>clearTimeout(g)}},[t,o,l]);const h={width:"100%",height:"100vh"};return f.jsx("div",{id:"map",ref:n,style:h})}const $k=X.createContext({});function Wk(n){const e=X.useRef(null);return e.current===null&&(e.current=n()),e.current}const dE=X.createContext(null),Hk=X.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class Cre extends X.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Pre({children:n,isPresent:e}){const t=X.useId(),r=X.useRef(null),i=X.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=X.useContext(Hk);return X.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:c}=i.current;if(e||!r.current||!a||!o)return;r.current.dataset.motionPopId=t;const h=document.createElement("style");return s&&(h.nonce=s),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),f.jsx(Cre,{isPresent:e,childRef:r,sizeRef:i,children:X.cloneElement(n,{ref:r})})}const Mre=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a})=>{const o=Wk(Nre),l=X.useId(),c=X.useCallback(g=>{o.set(g,!0);for(const m of o.values())if(!m)return;r&&r()},[o,r]),h=X.useMemo(()=>({id:l,initial:e,isPresent:t,custom:i,onExitComplete:c,register:g=>(o.set(g,!1),()=>o.delete(g))}),s?[Math.random(),c]:[t,c]);return X.useMemo(()=>{o.forEach((g,m)=>o.set(m,!1))},[t]),X.useEffect(()=>{!t&&!o.size&&r&&r()},[t]),a==="popLayout"&&(n=f.jsx(Pre,{isPresent:t,children:n})),f.jsx(dE.Provider,{value:h,children:n})};function Nre(){return new Map}function x9(n=!0){const e=X.useContext(dE);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=X.useId();X.useEffect(()=>{n&&i(s)},[n]);const a=X.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,a]:[!0]}const Cx=n=>n.key||"";function m3(n){const e=[];return X.Children.forEach(n,t=>{X.isValidElement(t)&&e.push(t)}),e}const Kk=typeof window<"u",_9=Kk?X.useLayoutEffect:X.useEffect,Un=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1})=>{const[o,l]=x9(a),c=X.useMemo(()=>m3(n),[n]),h=a&&!o?[]:c.map(Cx),g=X.useRef(!0),m=X.useRef(c),y=Wk(()=>new Map),[v,_]=X.useState(c),[E,T]=X.useState(c);_9(()=>{g.current=!1,m.current=c;for(let N=0;N<E.length;N++){const D=Cx(E[N]);h.includes(D)?y.delete(D):y.get(D)!==!0&&y.set(D,!1)}},[E,h.length,h.join("-")]);const b=[];if(c!==v){let N=[...c];for(let D=0;D<E.length;D++){const W=E[D],I=Cx(W);h.includes(I)||(N.splice(D,0,W),b.push(W))}s==="wait"&&b.length&&(N=b),T(m3(N)),_(c);return}const{forceRender:R}=X.useContext($k);return f.jsx(f.Fragment,{children:E.map(N=>{const D=Cx(N),W=a&&!o?!1:c===E||h.includes(D),I=()=>{if(y.has(D))y.set(D,!0);else return;let A=!0;y.forEach(M=>{M||(A=!1)}),A&&(R?.(),T(m.current),a&&l?.(),r&&r())};return f.jsx(Mre,{isPresent:W,initial:!g.current||t?void 0:!1,custom:W?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:W?void 0:I,children:N},D)})})},da=n=>n;let v9=da;function Xk(n){let e;return()=>(e===void 0&&(e=n()),e)}const X0=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},Zl=n=>n*1e3,Jl=n=>n/1e3,Lre={useManualTiming:!1};function Ore(n){let e=new Set,t=new Set,r=!1,i=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(c){s.has(c)&&(l.schedule(c),n()),c(a)}const l={schedule:(c,h=!1,g=!1)=>{const y=g&&r?e:t;return h&&s.add(c),y.has(c)||y.add(c),c},cancel:c=>{t.delete(c),s.delete(c)},process:c=>{if(a=c,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(o),e.clear(),r=!1,i&&(i=!1,l.process(c))}};return l}const Px=["read","resolveKeyframes","update","preRender","render","postRender"],Dre=40;function w9(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,a=Px.reduce((T,b)=>(T[b]=Ore(s),T),{}),{read:o,resolveKeyframes:l,update:c,preRender:h,render:g,postRender:m}=a,y=()=>{const T=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(T-i.timestamp,Dre),1),i.timestamp=T,i.isProcessing=!0,o.process(i),l.process(i),c.process(i),h.process(i),g.process(i),m.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(y))},v=()=>{t=!0,r=!0,i.isProcessing||n(y)};return{schedule:Px.reduce((T,b)=>{const R=a[b];return T[b]=(N,D=!1,W=!1)=>(t||v(),R.schedule(N,D,W)),T},{}),cancel:T=>{for(let b=0;b<Px.length;b++)a[Px[b]].cancel(T)},state:i,steps:a}}const{schedule:gr,cancel:Du,state:Bi,steps:lT}=w9(typeof requestAnimationFrame<"u"?requestAnimationFrame:da,!0),E9=X.createContext({strict:!1}),p3={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},q0={};for(const n in p3)q0[n]={isEnabled:e=>p3[n].some(t=>!!e[t])};function Fre(n){for(const e in n)q0[e]={...q0[e],...n[e]}}const jre=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Sv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||jre.has(n)}let S9=n=>!Sv(n);function Vre(n){n&&(S9=e=>e.startsWith("on")?!Sv(e):n(e))}try{Vre(require("@emotion/is-prop-valid").default)}catch{}function Bre(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(S9(i)||t===!0&&Sv(i)||!e&&!Sv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function Gre(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const fE=X.createContext({});function Up(n){return typeof n=="string"||Array.isArray(n)}function gE(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const qk=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Yk=["initial",...qk];function mE(n){return gE(n.animate)||Yk.some(e=>Up(n[e]))}function T9(n){return!!(mE(n)||n.variants)}function zre(n,e){if(mE(n)){const{initial:t,animate:r}=n;return{initial:t===!1||Up(t)?t:void 0,animate:Up(r)?r:void 0}}return n.inherit!==!1?e:{}}function Ure(n){const{initial:e,animate:t}=zre(n,X.useContext(fE));return X.useMemo(()=>({initial:e,animate:t}),[y3(e),y3(t)])}function y3(n){return Array.isArray(n)?n.join(" "):n}const $re=Symbol.for("motionComponentSymbol");function e0(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function Wre(n,e,t){return X.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):e0(t)&&(t.current=r))},[e])}const Zk=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Hre="framerAppearId",b9="data-"+Zk(Hre),{schedule:Jk}=w9(queueMicrotask,!1),R9=X.createContext({});function Kre(n,e,t,r,i){var s,a;const{visualElement:o}=X.useContext(fE),l=X.useContext(E9),c=X.useContext(dE),h=X.useContext(Hk).reducedMotion,g=X.useRef(null);r=r||l.renderer,!g.current&&r&&(g.current=r(n,{visualState:e,parent:o,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:h}));const m=g.current,y=X.useContext(R9);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&Xre(g.current,t,i,y);const v=X.useRef(!1);X.useInsertionEffect(()=>{m&&v.current&&m.update(t,c)});const _=t[b9],E=X.useRef(!!_&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,_))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,_)));return _9(()=>{m&&(v.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),Jk.render(m.render),E.current&&m.animationState&&m.animationState.animateChanges())}),X.useEffect(()=>{m&&(!E.current&&m.animationState&&m.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{var T;(T=window.MotionHandoffMarkAsComplete)===null||T===void 0||T.call(window,_)}),E.current=!1))}),m}function Xre(n,e,t,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:A9(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&e0(o),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:c})}function A9(n){if(n)return n.options.allowProjection!==!1?n.projection:A9(n.parent)}function qre({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var s,a;n&&Fre(n);function o(c,h){let g;const m={...X.useContext(Hk),...c,layoutId:Yre(c)},{isStatic:y}=m,v=Ure(c),_=r(c,y);if(!y&&Kk){Zre();const E=Jre(m);g=E.MeasureLayout,v.visualElement=Kre(i,_,m,e,E.ProjectionNode)}return f.jsxs(fE.Provider,{value:v,children:[g&&v.visualElement?f.jsx(g,{visualElement:v.visualElement,...m}):null,t(i,c,Wre(_,v.visualElement,h),_,y,v.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${(a=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&a!==void 0?a:""})`}`;const l=X.forwardRef(o);return l[$re]=i,l}function Yre({layoutId:n}){const e=X.useContext($k).id;return e&&n!==void 0?e+"-"+n:n}function Zre(n,e){X.useContext(E9).strict}function Jre(n){const{drag:e,layout:t}=q0;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const Qre=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Qk(n){return typeof n!="string"||n.includes("-")?!1:!!(Qre.indexOf(n)>-1||/[A-Z]/u.test(n))}function x3(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function eI(n,e,t,r){if(typeof e=="function"){const[i,s]=x3(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=x3(r);e=e(t!==void 0?t:n.custom,i,s)}return e}const tR=n=>Array.isArray(n),eie=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),tie=n=>tR(n)?n[n.length-1]||0:n,ls=n=>!!(n&&n.getVelocity);function m_(n){const e=ls(n)?n.get():n;return eie(e)?e.toValue():e}function nie({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,s){const a={latestValues:rie(r,i,s,n),renderState:e()};return t&&(a.onMount=o=>t({props:r,current:o,...a}),a.onUpdate=o=>t(o)),a}const k9=n=>(e,t)=>{const r=X.useContext(fE),i=X.useContext(dE),s=()=>nie(n,e,r,i);return t?s():Wk(s)};function rie(n,e,t,r){const i={},s=r(n,{});for(const m in s)i[m]=m_(s[m]);let{initial:a,animate:o}=n;const l=mE(n),c=T9(n);e&&c&&!l&&n.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let h=t?t.initial===!1:!1;h=h||a===!1;const g=h?o:a;if(g&&typeof g!="boolean"&&!gE(g)){const m=Array.isArray(g)?g:[g];for(let y=0;y<m.length;y++){const v=eI(n,m[y]);if(v){const{transitionEnd:_,transition:E,...T}=v;for(const b in T){let R=T[b];if(Array.isArray(R)){const N=h?R.length-1:0;R=R[N]}R!==null&&(i[b]=R)}for(const b in _)i[b]=_[b]}}}return i}const hg=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Od=new Set(hg),I9=n=>e=>typeof e=="string"&&e.startsWith(n),C9=I9("--"),iie=I9("var(--"),tI=n=>iie(n)?sie.test(n.split("/*")[0].trim()):!1,sie=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,P9=(n,e)=>e&&typeof n=="number"?e.transform(n):n,oc=(n,e,t)=>t>e?e:t<n?n:t,dg={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},$p={...dg,transform:n=>oc(0,1,n)},Mx={...dg,default:1},Gy=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),eu=Gy("deg"),al=Gy("%"),zt=Gy("px"),aie=Gy("vh"),oie=Gy("vw"),_3={...al,parse:n=>al.parse(n)/100,transform:n=>al.transform(n*100)},lie={borderWidth:zt,borderTopWidth:zt,borderRightWidth:zt,borderBottomWidth:zt,borderLeftWidth:zt,borderRadius:zt,radius:zt,borderTopLeftRadius:zt,borderTopRightRadius:zt,borderBottomRightRadius:zt,borderBottomLeftRadius:zt,width:zt,maxWidth:zt,height:zt,maxHeight:zt,top:zt,right:zt,bottom:zt,left:zt,padding:zt,paddingTop:zt,paddingRight:zt,paddingBottom:zt,paddingLeft:zt,margin:zt,marginTop:zt,marginRight:zt,marginBottom:zt,marginLeft:zt,backgroundPositionX:zt,backgroundPositionY:zt},cie={rotate:eu,rotateX:eu,rotateY:eu,rotateZ:eu,scale:Mx,scaleX:Mx,scaleY:Mx,scaleZ:Mx,skew:eu,skewX:eu,skewY:eu,distance:zt,translateX:zt,translateY:zt,translateZ:zt,x:zt,y:zt,z:zt,perspective:zt,transformPerspective:zt,opacity:$p,originX:_3,originY:_3,originZ:zt},v3={...dg,transform:Math.round},nI={...lie,...cie,zIndex:v3,size:zt,fillOpacity:$p,strokeOpacity:$p,numOctaves:v3},uie={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},hie=hg.length;function die(n,e,t){let r="",i=!0;for(let s=0;s<hie;s++){const a=hg[s],o=n[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||t){const c=P9(o,nI[a]);if(!l){i=!1;const h=uie[a]||a;r+=`${h}(${c}) `}t&&(e[a]=c)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function rI(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let a=!1,o=!1;for(const l in e){const c=e[l];if(Od.has(l)){a=!0;continue}else if(C9(l)){i[l]=c;continue}else{const h=P9(c,nI[l]);l.startsWith("origin")?(o=!0,s[l]=h):r[l]=h}}if(e.transform||(a||t?r.transform=die(e,n.transform,t):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:h=0}=s;r.transformOrigin=`${l} ${c} ${h}`}}const fie={offset:"stroke-dashoffset",array:"stroke-dasharray"},gie={offset:"strokeDashoffset",array:"strokeDasharray"};function mie(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?fie:gie;n[s.offset]=zt.transform(-r);const a=zt.transform(e),o=zt.transform(t);n[s.array]=`${a} ${o}`}function w3(n,e,t){return typeof n=="string"?n:zt.transform(e+t*n)}function pie(n,e,t){const r=w3(e,n.x,n.width),i=w3(t,n.y,n.height);return`${r} ${i}`}function iI(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...c},h,g){if(rI(n,c,g),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:y,dimensions:v}=n;m.transform&&(v&&(y.transform=m.transform),delete m.transform),v&&(i!==void 0||s!==void 0||y.transform)&&(y.transformOrigin=pie(v,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),r!==void 0&&(m.scale=r),a!==void 0&&mie(m,a,o,l,!1)}const sI=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),M9=()=>({...sI(),attrs:{}}),aI=n=>typeof n=="string"&&n.toLowerCase()==="svg";function N9(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const s in t)n.style.setProperty(s,t[s])}const L9=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function O9(n,e,t,r){N9(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(L9.has(i)?i:Zk(i),e.attrs[i])}const Tv={};function yie(n){Object.assign(Tv,n)}function D9(n,{layout:e,layoutId:t}){return Od.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Tv[n]||n==="opacity")}function oI(n,e,t){var r;const{style:i}=n,s={};for(const a in i)(ls(i[a])||e.style&&ls(e.style[a])||D9(a,n)||((r=t?.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function F9(n,e,t){const r=oI(n,e,t);for(const i in n)if(ls(n[i])||ls(e[i])){const s=hg.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}function xie(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const E3=["x","y","width","height","cx","cy","r"],_ie={useVisualState:k9({scrapeMotionValuesFromProps:F9,createRenderState:M9,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let s=!!n.drag;if(!s){for(const o in i)if(Od.has(o)){s=!0;break}}if(!s)return;let a=!e;if(e)for(let o=0;o<E3.length;o++){const l=E3[o];n[l]!==e[l]&&(a=!0)}a&&gr.read(()=>{xie(t,r),gr.render(()=>{iI(r,i,aI(t.tagName),n.transformTemplate),O9(t,r)})})}})},vie={useVisualState:k9({scrapeMotionValuesFromProps:oI,createRenderState:sI})};function j9(n,e,t){for(const r in e)!ls(e[r])&&!D9(r,t)&&(n[r]=e[r])}function wie({transformTemplate:n},e){return X.useMemo(()=>{const t=sI();return rI(t,e,n),Object.assign({},t.vars,t.style)},[e])}function Eie(n,e){const t=n.style||{},r={};return j9(r,t,n),Object.assign(r,wie(n,e)),r}function Sie(n,e){const t={},r=Eie(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function Tie(n,e,t,r){const i=X.useMemo(()=>{const s=M9();return iI(s,e,aI(r),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};j9(s,n.style,n),i.style={...s,...i.style}}return i}function bie(n=!1){return(t,r,i,{latestValues:s},a)=>{const l=(Qk(t)?Tie:Sie)(r,s,a,t),c=Bre(r,typeof t=="string",n),h=t!==X.Fragment?{...c,...l,ref:i}:{},{children:g}=r,m=X.useMemo(()=>ls(g)?g.get():g,[g]);return X.createElement(t,{...h,children:m})}}function Rie(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...Qk(r)?_ie:vie,preloadedFeatures:n,useRender:bie(i),createVisualElement:e,Component:r};return qre(a)}}function V9(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function pE(n,e,t){const r=n.getProps();return eI(r,e,t!==void 0?t:r.custom,n)}const Aie=Xk(()=>window.ScrollTimeline!==void 0);class kie{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(Aie()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Iie extends kie{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function lI(n,e){return n?n[e]||n.default||n:void 0}const nR=2e4;function B9(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<nR;)e+=t,r=n.next(e);return e>=nR?1/0:e}function cI(n){return typeof n=="function"}function S3(n,e){n.timeline=e,n.onfinish=null}const uI=n=>Array.isArray(n)&&typeof n[0]=="number",Cie={linearEasing:void 0};function Pie(n,e){const t=Xk(n);return()=>{var r;return(r=Cie[e])!==null&&r!==void 0?r:t()}}const bv=Pie(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),G9=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=n(X0(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function z9(n){return!!(typeof n=="function"&&bv()||!n||typeof n=="string"&&(n in rR||bv())||uI(n)||Array.isArray(n)&&n.every(z9))}const Rm=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,rR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Rm([0,.65,.55,1]),circOut:Rm([.55,0,1,.45]),backIn:Rm([.31,.01,.66,-.59]),backOut:Rm([.33,1.53,.69,.99])};function U9(n,e){if(n)return typeof n=="function"&&bv()?G9(n,e):uI(n)?Rm(n):Array.isArray(n)?n.map(t=>U9(t,e)||rR.easeOut):rR[n]}const io={x:!1,y:!1};function $9(){return io.x||io.y}function Mie(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function W9(n,e){const t=Mie(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function T3(n){return e=>{e.pointerType==="touch"||$9()||n(e)}}function Nie(n,e,t={}){const[r,i,s]=W9(n,t),a=T3(o=>{const{target:l}=o,c=e(o);if(typeof c!="function"||!l)return;const h=T3(g=>{c(g),l.removeEventListener("pointerleave",h)});l.addEventListener("pointerleave",h,i)});return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const H9=(n,e)=>e?n===e?!0:H9(n,e.parentElement):!1,hI=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,Lie=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Oie(n){return Lie.has(n.tagName)||n.tabIndex!==-1}const Am=new WeakSet;function b3(n){return e=>{e.key==="Enter"&&n(e)}}function cT(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Die=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=b3(()=>{if(Am.has(t))return;cT(t,"down");const i=b3(()=>{cT(t,"up")}),s=()=>cT(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function R3(n){return hI(n)&&!$9()}function Fie(n,e,t={}){const[r,i,s]=W9(n,t),a=o=>{const l=o.currentTarget;if(!R3(o)||Am.has(l))return;Am.add(l);const c=e(o),h=(y,v)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",m),!(!R3(y)||!Am.has(l))&&(Am.delete(l),typeof c=="function"&&c(y,{success:v}))},g=y=>{h(y,t.useGlobalTarget||H9(l,y.target))},m=y=>{h(y,!1)};window.addEventListener("pointerup",g,i),window.addEventListener("pointercancel",m,i)};return r.forEach(o=>{!Oie(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(t.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o.addEventListener("focus",c=>Die(c,i),i)}),s}function jie(n){return n==="x"||n==="y"?io[n]?null:(io[n]=!0,()=>{io[n]=!1}):io.x||io.y?null:(io.x=io.y=!0,()=>{io.x=io.y=!1})}const K9=new Set(["width","height","top","left","right","bottom",...hg]);let p_;function Vie(){p_=void 0}const ol={now:()=>(p_===void 0&&ol.set(Bi.isProcessing||Lre.useManualTiming?Bi.timestamp:performance.now()),p_),set:n=>{p_=n,queueMicrotask(Vie)}};function dI(n,e){n.indexOf(e)===-1&&n.push(e)}function fI(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class gI{constructor(){this.subscriptions=[]}add(e){return dI(this.subscriptions,e),()=>fI(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function X9(n,e){return e?n*(1e3/e):0}const A3=30,Bie=n=>!isNaN(parseFloat(n));class Gie{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=ol.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ol.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Bie(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new gI);const r=this.events[e].add(t);return e==="change"?()=>{r(),gr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ol.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>A3)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,A3);return X9(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Wp(n,e){return new Gie(n,e)}function zie(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Wp(t))}function Uie(n,e){const t=pE(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const a in s){const o=tie(s[a]);zie(n,a,o)}}function $ie(n){return!!(ls(n)&&n.add)}function iR(n,e){const t=n.getValue("willChange");if($ie(t))return t.add(e)}function q9(n){return n.props[b9]}const Y9=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,Wie=1e-7,Hie=12;function Kie(n,e,t,r,i){let s,a,o=0;do a=e+(t-e)/2,s=Y9(a,r,i)-n,s>0?t=a:e=a;while(Math.abs(s)>Wie&&++o<Hie);return a}function zy(n,e,t,r){if(n===e&&t===r)return da;const i=s=>Kie(s,0,1,n,t);return s=>s===0||s===1?s:Y9(i(s),e,r)}const Z9=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,J9=n=>e=>1-n(1-e),Q9=zy(.33,1.53,.69,.99),mI=J9(Q9),e7=Z9(mI),t7=n=>(n*=2)<1?.5*mI(n):.5*(2-Math.pow(2,-10*(n-1))),pI=n=>1-Math.sin(Math.acos(n)),n7=J9(pI),r7=Z9(pI),i7=n=>/^0[^.\s]+$/u.test(n);function Xie(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||i7(n):!0}const Hm=n=>Math.round(n*1e5)/1e5,yI=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function qie(n){return n==null}const Yie=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,xI=(n,e)=>t=>!!(typeof t=="string"&&Yie.test(t)&&t.startsWith(n)||e&&!qie(t)&&Object.prototype.hasOwnProperty.call(t,e)),s7=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(yI);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Zie=n=>oc(0,255,n),uT={...dg,transform:n=>Math.round(Zie(n))},$h={test:xI("rgb","red"),parse:s7("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+uT.transform(n)+", "+uT.transform(e)+", "+uT.transform(t)+", "+Hm($p.transform(r))+")"};function Jie(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const sR={test:xI("#"),parse:Jie,transform:$h.transform},t0={test:xI("hsl","hue"),parse:s7("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+al.transform(Hm(e))+", "+al.transform(Hm(t))+", "+Hm($p.transform(r))+")"},rs={test:n=>$h.test(n)||sR.test(n)||t0.test(n),parse:n=>$h.test(n)?$h.parse(n):t0.test(n)?t0.parse(n):sR.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?$h.transform(n):t0.transform(n)},Qie=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function ese(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(yI))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(Qie))===null||t===void 0?void 0:t.length)||0)>0}const a7="number",o7="color",tse="var",nse="var(",k3="${}",rse=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Hp(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=e.replace(rse,l=>(rs.test(l)?(r.color.push(s),i.push(o7),t.push(rs.parse(l))):l.startsWith(nse)?(r.var.push(s),i.push(tse),t.push(l)):(r.number.push(s),i.push(a7),t.push(parseFloat(l))),++s,k3)).split(k3);return{values:t,split:o,indexes:r,types:i}}function l7(n){return Hp(n).values}function c7(n){const{split:e,types:t}=Hp(n),r=e.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=e[a],i[a]!==void 0){const o=t[a];o===a7?s+=Hm(i[a]):o===o7?s+=rs.transform(i[a]):s+=i[a]}return s}}const ise=n=>typeof n=="number"?0:n;function sse(n){const e=l7(n);return c7(n)(e.map(ise))}const Fu={test:ese,parse:l7,createTransformer:c7,getAnimatableNone:sse},ase=new Set(["brightness","contrast","saturate","opacity"]);function ose(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(yI)||[];if(!r)return n;const i=t.replace(r,"");let s=ase.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const lse=/\b([a-z-]*)\(.*?\)/gu,aR={...Fu,getAnimatableNone:n=>{const e=n.match(lse);return e?e.map(ose).join(" "):n}},cse={...nI,color:rs,backgroundColor:rs,outlineColor:rs,fill:rs,stroke:rs,borderColor:rs,borderTopColor:rs,borderRightColor:rs,borderBottomColor:rs,borderLeftColor:rs,filter:aR,WebkitFilter:aR},_I=n=>cse[n];function u7(n,e){let t=_I(n);return t!==aR&&(t=Fu),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const use=new Set(["auto","none","0"]);function hse(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!use.has(s)&&Hp(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=u7(t,i)}const I3=n=>n===dg||n===zt,C3=(n,e)=>parseFloat(n.split(", ")[e]),P3=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return C3(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?C3(s[1],n):0}},dse=new Set(["x","y","z"]),fse=hg.filter(n=>!dse.has(n));function gse(n){const e=[];return fse.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const Y0={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:P3(4,13),y:P3(5,14)};Y0.translateX=Y0.x;Y0.translateY=Y0.y;const Qh=new Set;let oR=!1,lR=!1;function h7(){if(lR){const n=Array.from(Qh).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=gse(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))===null||o===void 0||o.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}lR=!1,oR=!1,Qh.forEach(n=>n.complete()),Qh.clear()}function d7(){Qh.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(lR=!0)})}function mse(){d7(),h7()}class vI{constructor(e,t,r,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Qh.add(this),oR||(oR=!0,gr.read(d7),gr.resolveKeyframes(h7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const l=r.readValue(t,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Qh.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Qh.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const f7=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),pse=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function yse(n){const e=pse.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function g7(n,e,t=1){const[r,i]=yse(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const a=s.trim();return f7(a)?parseFloat(a):a}return tI(i)?g7(i,e,t+1):i}const m7=n=>e=>e.test(n),xse={test:n=>n==="auto",parse:n=>n},p7=[dg,zt,al,eu,oie,aie,xse],M3=n=>p7.find(m7(n));class y7 extends vI{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),tI(c))){const h=g7(c,t.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!K9.has(r)||e.length!==2)return;const[i,s]=e,a=M3(i),o=M3(s);if(a!==o)if(I3(a)&&I3(o))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)Xie(e[i])&&r.push(i);r.length&&hse(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Y0[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=Y0[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const N3=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Fu.test(n)||n==="0")&&!n.startsWith("url("));function _se(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function vse(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],a=N3(i,e),o=N3(s,e);return!a||!o?!1:_se(n)||(t==="spring"||cI(t))&&r}const wse=n=>n!==null;function yE(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(wse),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const Ese=40;class x7{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ol.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Ese?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&mse(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=ol.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:a,onComplete:o,onUpdate:l,isGenerator:c}=this.options;if(!c&&!vse(e,r,i,s))if(a)this.options.duration=0;else{l&&l(yE(e,this.options,t)),o&&o(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Pr=(n,e,t)=>n+(e-n)*t;function hT(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Sse({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,a=0;if(!e)i=s=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;i=hT(l,o,n+1/3),s=hT(l,o,n),a=hT(l,o,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function Rv(n,e){return t=>t>0?e:n}const dT=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},Tse=[sR,$h,t0],bse=n=>Tse.find(e=>e.test(n));function L3(n){const e=bse(n);if(!e)return!1;let t=e.parse(n);return e===t0&&(t=Sse(t)),t}const O3=(n,e)=>{const t=L3(n),r=L3(e);if(!t||!r)return Rv(n,e);const i={...t};return s=>(i.red=dT(t.red,r.red,s),i.green=dT(t.green,r.green,s),i.blue=dT(t.blue,r.blue,s),i.alpha=Pr(t.alpha,r.alpha,s),$h.transform(i))},Rse=(n,e)=>t=>e(n(t)),Uy=(...n)=>n.reduce(Rse),cR=new Set(["none","hidden"]);function Ase(n,e){return cR.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function kse(n,e){return t=>Pr(n,e,t)}function wI(n){return typeof n=="number"?kse:typeof n=="string"?tI(n)?Rv:rs.test(n)?O3:Pse:Array.isArray(n)?_7:typeof n=="object"?rs.test(n)?O3:Ise:Rv}function _7(n,e){const t=[...n],r=t.length,i=n.map((s,a)=>wI(s)(s,e[a]));return s=>{for(let a=0;a<r;a++)t[a]=i[a](s);return t}}function Ise(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=wI(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function Cse(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],o=n.indexes[a][i[a]],l=(t=n.values[o])!==null&&t!==void 0?t:0;r[s]=l,i[a]++}return r}const Pse=(n,e)=>{const t=Fu.createTransformer(e),r=Hp(n),i=Hp(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?cR.has(n)&&!i.values.length||cR.has(e)&&!r.values.length?Ase(n,e):Uy(_7(Cse(r,i),i.values),t):Rv(n,e)};function v7(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Pr(n,e,t):wI(n)(n,e)}const Mse=5;function w7(n,e,t){const r=Math.max(e-Mse,0);return X9(t-n(r),e-r)}const Dr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},fT=.001;function Nse({duration:n=Dr.duration,bounce:e=Dr.bounce,velocity:t=Dr.velocity,mass:r=Dr.mass}){let i,s,a=1-e;a=oc(Dr.minDamping,Dr.maxDamping,a),n=oc(Dr.minDuration,Dr.maxDuration,Jl(n)),a<1?(i=c=>{const h=c*a,g=h*n,m=h-t,y=uR(c,a),v=Math.exp(-g);return fT-m/y*v},s=c=>{const g=c*a*n,m=g*t+t,y=Math.pow(a,2)*Math.pow(c,2)*n,v=Math.exp(-g),_=uR(Math.pow(c,2),a);return(-i(c)+fT>0?-1:1)*((m-y)*v)/_}):(i=c=>{const h=Math.exp(-c*n),g=(c-t)*n+1;return-fT+h*g},s=c=>{const h=Math.exp(-c*n),g=(t-c)*(n*n);return h*g});const o=5/n,l=Ose(i,s,o);if(n=Zl(n),isNaN(l))return{stiffness:Dr.stiffness,damping:Dr.damping,duration:n};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:n}}}const Lse=12;function Ose(n,e,t){let r=t;for(let i=1;i<Lse;i++)r=r-n(r)/e(r);return r}function uR(n,e){return n*Math.sqrt(1-e*e)}const Dse=["duration","bounce"],Fse=["stiffness","damping","mass"];function D3(n,e){return e.some(t=>n[t]!==void 0)}function jse(n){let e={velocity:Dr.velocity,stiffness:Dr.stiffness,damping:Dr.damping,mass:Dr.mass,isResolvedFromDuration:!1,...n};if(!D3(n,Fse)&&D3(n,Dse))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*oc(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:Dr.mass,stiffness:i,damping:s}}else{const t=Nse(n);e={...e,...t,mass:Dr.mass},e.isResolvedFromDuration=!0}return e}function E7(n=Dr.visualDuration,e=Dr.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:h,duration:g,velocity:m,isResolvedFromDuration:y}=jse({...t,velocity:-Jl(t.velocity||0)}),v=m||0,_=c/(2*Math.sqrt(l*h)),E=a-s,T=Jl(Math.sqrt(l/h)),b=Math.abs(E)<5;r||(r=b?Dr.restSpeed.granular:Dr.restSpeed.default),i||(i=b?Dr.restDelta.granular:Dr.restDelta.default);let R;if(_<1){const D=uR(T,_);R=W=>{const I=Math.exp(-_*T*W);return a-I*((v+_*T*E)/D*Math.sin(D*W)+E*Math.cos(D*W))}}else if(_===1)R=D=>a-Math.exp(-T*D)*(E+(v+T*E)*D);else{const D=T*Math.sqrt(_*_-1);R=W=>{const I=Math.exp(-_*T*W),A=Math.min(D*W,300);return a-I*((v+_*T*E)*Math.sinh(A)+D*E*Math.cosh(A))/D}}const N={calculatedDuration:y&&g||null,next:D=>{const W=R(D);if(y)o.done=D>=g;else{let I=0;_<1&&(I=D===0?Zl(v):w7(R,D,W));const A=Math.abs(I)<=r,M=Math.abs(a-W)<=i;o.done=A&&M}return o.value=o.done?a:W,o},toString:()=>{const D=Math.min(B9(N),nR),W=G9(I=>N.next(D*I).value,D,30);return D+"ms "+W}};return N}function F3({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:h}){const g=n[0],m={done:!1,value:g},y=A=>o!==void 0&&A<o||l!==void 0&&A>l,v=A=>o===void 0?l:l===void 0||Math.abs(o-A)<Math.abs(l-A)?o:l;let _=t*e;const E=g+_,T=a===void 0?E:a(E);T!==E&&(_=T-g);const b=A=>-_*Math.exp(-A/r),R=A=>T+b(A),N=A=>{const M=b(A),O=R(A);m.done=Math.abs(M)<=c,m.value=m.done?T:O};let D,W;const I=A=>{y(m.value)&&(D=A,W=E7({keyframes:[m.value,v(m.value)],velocity:w7(R,A,m.value),damping:i,stiffness:s,restDelta:c,restSpeed:h}))};return I(0),{calculatedDuration:null,next:A=>{let M=!1;return!W&&D===void 0&&(M=!0,N(A),I(A)),D!==void 0&&A>=D?W.next(A-D):(!M&&N(A),m)}}}const Vse=zy(.42,0,1,1),Bse=zy(0,0,.58,1),S7=zy(.42,0,.58,1),Gse=n=>Array.isArray(n)&&typeof n[0]!="number",zse={linear:da,easeIn:Vse,easeInOut:S7,easeOut:Bse,circIn:pI,circInOut:r7,circOut:n7,backIn:mI,backInOut:e7,backOut:Q9,anticipate:t7},j3=n=>{if(uI(n)){v9(n.length===4);const[e,t,r,i]=n;return zy(e,t,r,i)}else if(typeof n=="string")return zse[n];return n};function Use(n,e,t){const r=[],i=t||v7,s=n.length-1;for(let a=0;a<s;a++){let o=i(n[a],n[a+1]);if(e){const l=Array.isArray(e)?e[a]||da:e;o=Uy(l,o)}r.push(o)}return r}function $se(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(v9(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=Use(e,r,i),l=o.length,c=h=>{if(a&&h<n[0])return e[0];let g=0;if(l>1)for(;g<n.length-2&&!(h<n[g+1]);g++);const m=X0(n[g],n[g+1],h);return o[g](m)};return t?h=>c(oc(n[0],n[s-1],h)):c}function Wse(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=X0(0,e,r);n.push(Pr(t,1,i))}}function Hse(n){const e=[0];return Wse(e,n.length-1),e}function Kse(n,e){return n.map(t=>t*e)}function Xse(n,e){return n.map(()=>e||S7).splice(0,n.length-1)}function Av({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=Gse(r)?r.map(j3):j3(r),s={done:!1,value:e[0]},a=Kse(t&&t.length===e.length?t:Hse(e),n),o=$se(a,e,{ease:Array.isArray(i)?i:Xse(e,i)});return{calculatedDuration:n,next:l=>(s.value=o(l),s.done=l>=n,s)}}const qse=n=>{const e=({timestamp:t})=>n(t);return{start:()=>gr.update(e,!0),stop:()=>Du(e),now:()=>Bi.isProcessing?Bi.timestamp:ol.now()}},Yse={decay:F3,inertia:F3,tween:Av,keyframes:Av,spring:E7},Zse=n=>n/100;class EI extends x7{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:t,motionValue:r,element:i,keyframes:s}=this.options,a=i?.KeyframeResolver||vI,o=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new a(s,o,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=this.options,o=cI(t)?t:Yse[t]||Av;let l,c;o!==Av&&typeof e[0]!="number"&&(l=Uy(Zse,v7(e[0],e[1])),e=[0,100]);const h=o({...this.options,keyframes:e});s==="mirror"&&(c=o({...this.options,keyframes:[...e].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=B9(h));const{calculatedDuration:g}=h,m=g+i,y=m*(r+1)-i;return{generator:h,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:g,resolvedDuration:m,totalDuration:y}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:A}=this.options;return{done:!0,value:A[A.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:c,totalDuration:h,resolvedDuration:g}=r;if(this.startTime===null)return s.next(0);const{delay:m,repeat:y,repeatType:v,repeatDelay:_,onUpdate:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const T=this.currentTime-m*(this.speed>=0?1:-1),b=this.speed>=0?T<0:T>h;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let R=this.currentTime,N=s;if(y){const A=Math.min(this.currentTime,h)/g;let M=Math.floor(A),O=A%1;!O&&A>=1&&(O=1),O===1&&M--,M=Math.min(M,y+1),M%2&&(v==="reverse"?(O=1-O,_&&(O-=_/g)):v==="mirror"&&(N=a)),R=oc(0,1,O)*g}const D=b?{done:!1,value:l[0]}:N.next(R);o&&(D.value=o(D.value));let{done:W}=D;!b&&c!==null&&(W=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const I=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&W);return I&&i!==void 0&&(D.value=yE(l,this.options,i)),E&&E(D.value),I&&this.finish(),D}get duration(){const{resolved:e}=this;return e?Jl(e.calculatedDuration):0}get time(){return Jl(this.currentTime)}set time(e){e=Zl(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Jl(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=qse,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Jse=new Set(["opacity","clipPath","filter","transform"]);function Qse(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeInOut",times:l}={}){const c={[e]:t};l&&(c.offset=l);const h=U9(o,i);return Array.isArray(h)&&(c.easing=h),n.animate(c,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}const eae=Xk(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),kv=10,tae=2e4;function nae(n){return cI(n.type)||n.type==="spring"||!z9(n.ease)}function rae(n,e){const t=new EI({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let s=0;for(;!r.done&&s<tae;)r=t.sample(s),i.push(r.value),s+=kv;return{times:void 0,keyframes:i,duration:s-kv,ease:"linear"}}const T7={anticipate:t7,backInOut:e7,circInOut:r7};function iae(n){return n in T7}class V3 extends x7{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new y7(s,(a,o)=>this.onKeyframesResolved(a,o),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:s,type:a,motionValue:o,name:l,startTime:c}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof s=="string"&&bv()&&iae(s)&&(s=T7[s]),nae(this.options)){const{onComplete:g,onUpdate:m,motionValue:y,element:v,..._}=this.options,E=rae(e,_);e=E.keyframes,e.length===1&&(e[1]=e[0]),r=E.duration,i=E.times,s=E.ease,a="keyframes"}const h=Qse(o.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return h.startTime=c??this.calcStartTime(),this.pendingTimeline?(S3(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:g}=this.options;o.set(yE(e,this.options,t)),g&&g(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:a,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Jl(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Jl(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=Zl(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return da;const{animation:r}=t;S3(r,e)}return da}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:s,ease:a,times:o}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:h,onComplete:g,element:m,...y}=this.options,v=new EI({...y,keyframes:r,duration:i,type:s,ease:a,times:o,isGenerator:!0}),_=Zl(this.time);c.setWithVelocity(v.sample(_-kv).value,v.sample(_).value,kv)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:s,damping:a,type:o}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=t.owner.getProps();return eae()&&r&&Jse.has(r)&&!l&&!c&&!i&&s!=="mirror"&&a!==0&&o!=="inertia"}}const sae={type:"spring",stiffness:500,damping:25,restSpeed:10},aae=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),oae={type:"keyframes",duration:.8},lae={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},cae=(n,{keyframes:e})=>e.length>2?oae:Od.has(n)?n.startsWith("scale")?aae(e[1]):sae:lae;function uae({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:c,...h}){return!!Object.keys(h).length}const SI=(n,e,t,r={},i,s)=>a=>{const o=lI(r,n)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Zl(l);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-c,onUpdate:m=>{e.set(m),o.onUpdate&&o.onUpdate(m)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:n,motionValue:e,element:s?void 0:i};uae(o)||(h={...h,...cae(n,h)}),h.duration&&(h.duration=Zl(h.duration)),h.repeatDelay&&(h.repeatDelay=Zl(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let g=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(g=!0)),g&&!s&&e.get()!==void 0){const m=yE(h.keyframes,o);if(m!==void 0)return gr.update(()=>{h.onUpdate(m),h.onComplete()}),new Iie([])}return!s&&V3.supports(h)?new V3(h):new EI(h)};function hae({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function b7(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var s;let{transition:a=n.getDefaultTransition(),transitionEnd:o,...l}=e;r&&(a=r);const c=[],h=i&&n.animationState&&n.animationState.getState()[i];for(const g in l){const m=n.getValue(g,(s=n.latestValues[g])!==null&&s!==void 0?s:null),y=l[g];if(y===void 0||h&&hae(h,g))continue;const v={delay:t,...lI(a||{},g)};let _=!1;if(window.MotionHandoffAnimation){const T=q9(n);if(T){const b=window.MotionHandoffAnimation(T,g,gr);b!==null&&(v.startTime=b,_=!0)}}iR(n,g),m.start(SI(g,m,y,n.shouldReduceMotion&&K9.has(g)?{type:!1}:v,n,_));const E=m.animation;E&&c.push(E)}return o&&Promise.all(c).then(()=>{gr.update(()=>{o&&Uie(n,o)})}),c}function hR(n,e,t={}){var r;const i=pE(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(s=t.transitionOverride);const a=i?()=>Promise.all(b7(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(c=0)=>{const{delayChildren:h=0,staggerChildren:g,staggerDirection:m}=s;return dae(n,e,h+c,g,m,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,h]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>h())}else return Promise.all([a(),o(t.delay)])}function dae(n,e,t=0,r=0,i=1,s){const a=[],o=(n.variantChildren.size-1)*r,l=i===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(n.variantChildren).sort(fae).forEach((c,h)=>{c.notify("AnimationStart",e),a.push(hR(c,e,{...s,delay:t+l(h)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(a)}function fae(n,e){return n.sortNodePosition(e)}function gae(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>hR(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=hR(n,e,t);else{const i=typeof e=="function"?pE(n,e,t.custom):e;r=Promise.all(b7(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const mae=Yk.length;function R7(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?R7(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<mae;t++){const r=Yk[t],i=n.props[r];(Up(i)||i===!1)&&(e[r]=i)}return e}const pae=[...qk].reverse(),yae=qk.length;function xae(n){return e=>Promise.all(e.map(({animation:t,options:r})=>gae(n,t,r)))}function _ae(n){let e=xae(n),t=B3(),r=!0;const i=l=>(c,h)=>{var g;const m=pE(n,h,l==="exit"?(g=n.presenceContext)===null||g===void 0?void 0:g.custom:void 0);if(m){const{transition:y,transitionEnd:v,..._}=m;c={...c,..._,...v}}return c};function s(l){e=l(n)}function a(l){const{props:c}=n,h=R7(n.parent)||{},g=[],m=new Set;let y={},v=1/0;for(let E=0;E<yae;E++){const T=pae[E],b=t[T],R=c[T]!==void 0?c[T]:h[T],N=Up(R),D=T===l?b.isActive:null;D===!1&&(v=E);let W=R===h[T]&&R!==c[T]&&N;if(W&&r&&n.manuallyAnimateOnMount&&(W=!1),b.protectedKeys={...y},!b.isActive&&D===null||!R&&!b.prevProp||gE(R)||typeof R=="boolean")continue;const I=vae(b.prevProp,R);let A=I||T===l&&b.isActive&&!W&&N||E>v&&N,M=!1;const O=Array.isArray(R)?R:[R];let L=O.reduce(i(T),{});D===!1&&(L={});const{prevResolvedValues:z={}}=b,j={...z,...L},Ee=Le=>{A=!0,m.has(Le)&&(M=!0,m.delete(Le)),b.needsAnimating[Le]=!0;const ce=n.getValue(Le);ce&&(ce.liveStyle=!1)};for(const Le in j){const ce=L[Le],Me=z[Le];if(y.hasOwnProperty(Le))continue;let Te=!1;tR(ce)&&tR(Me)?Te=!V9(ce,Me):Te=ce!==Me,Te?ce!=null?Ee(Le):m.add(Le):ce!==void 0&&m.has(Le)?Ee(Le):b.protectedKeys[Le]=!0}b.prevProp=R,b.prevResolvedValues=L,b.isActive&&(y={...y,...L}),r&&n.blockInitialAnimation&&(A=!1),A&&(!(W&&I)||M)&&g.push(...O.map(Le=>({animation:Le,options:{type:T}})))}if(m.size){const E={};m.forEach(T=>{const b=n.getBaseTarget(T),R=n.getValue(T);R&&(R.liveStyle=!0),E[T]=b??null}),g.push({animation:E})}let _=!!g.length;return r&&(c.initial===!1||c.initial===c.animate)&&!n.manuallyAnimateOnMount&&(_=!1),r=!1,_?e(g):Promise.resolve()}function o(l,c){var h;if(t[l].isActive===c)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(m=>{var y;return(y=m.animationState)===null||y===void 0?void 0:y.setActive(l,c)}),t[l].isActive=c;const g=a(l);for(const m in t)t[m].protectedKeys={};return g}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>t,reset:()=>{t=B3(),r=!0}}}function vae(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!V9(e,n):!1}function wh(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function B3(){return{animate:wh(!0),whileInView:wh(),whileHover:wh(),whileTap:wh(),whileDrag:wh(),whileFocus:wh(),exit:wh()}}class Xu{constructor(e){this.isMounted=!1,this.node=e}update(){}}class wae extends Xu{constructor(e){super(e),e.animationState||(e.animationState=_ae(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();gE(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let Eae=0;class Sae extends Xu{constructor(){super(...arguments),this.id=Eae++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Tae={animation:{Feature:wae},exit:{Feature:Sae}};function Kp(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function $y(n){return{point:{x:n.pageX,y:n.pageY}}}const bae=n=>e=>hI(e)&&n(e,$y(e));function Km(n,e,t,r){return Kp(n,e,bae(t),r)}const G3=(n,e)=>Math.abs(n-e);function Rae(n,e){const t=G3(n.x,e.x),r=G3(n.y,e.y);return Math.sqrt(t**2+r**2)}class A7{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=mT(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,y=Rae(g.offset,{x:0,y:0})>=3;if(!m&&!y)return;const{point:v}=g,{timestamp:_}=Bi;this.history.push({...v,timestamp:_});const{onStart:E,onMove:T}=this.handlers;m||(E&&E(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,g)},this.handlePointerMove=(g,m)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=gT(m,this.transformPagePoint),gr.update(this.updatePoint,!0)},this.handlePointerUp=(g,m)=>{this.end();const{onEnd:y,onSessionEnd:v,resumeAnimation:_}=this.handlers;if(this.dragSnapToOrigin&&_&&_(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=mT(g.type==="pointercancel"?this.lastMoveEventInfo:gT(m,this.transformPagePoint),this.history);this.startEvent&&y&&y(g,E),v&&v(g,E)},!hI(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const a=$y(e),o=gT(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=Bi;this.history=[{...l,timestamp:c}];const{onSessionStart:h}=t;h&&h(e,mT(o,this.history)),this.removeListeners=Uy(Km(this.contextWindow,"pointermove",this.handlePointerMove),Km(this.contextWindow,"pointerup",this.handlePointerUp),Km(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Du(this.updatePoint)}}function gT(n,e){return e?{point:e(n.point)}:n}function z3(n,e){return{x:n.x-e.x,y:n.y-e.y}}function mT({point:n},e){return{point:n,delta:z3(n,k7(e)),offset:z3(n,Aae(e)),velocity:kae(e,.1)}}function Aae(n){return n[0]}function k7(n){return n[n.length-1]}function kae(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=k7(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Zl(e)));)t--;if(!r)return{x:0,y:0};const s=Jl(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const I7=1e-4,Iae=1-I7,Cae=1+I7,C7=.01,Pae=0-C7,Mae=0+C7;function ma(n){return n.max-n.min}function Nae(n,e,t){return Math.abs(n-e)<=t}function U3(n,e,t,r=.5){n.origin=r,n.originPoint=Pr(e.min,e.max,n.origin),n.scale=ma(t)/ma(e),n.translate=Pr(t.min,t.max,n.origin)-n.originPoint,(n.scale>=Iae&&n.scale<=Cae||isNaN(n.scale))&&(n.scale=1),(n.translate>=Pae&&n.translate<=Mae||isNaN(n.translate))&&(n.translate=0)}function Xm(n,e,t,r){U3(n.x,e.x,t.x,r?r.originX:void 0),U3(n.y,e.y,t.y,r?r.originY:void 0)}function $3(n,e,t){n.min=t.min+e.min,n.max=n.min+ma(e)}function Lae(n,e,t){$3(n.x,e.x,t.x),$3(n.y,e.y,t.y)}function W3(n,e,t){n.min=e.min-t.min,n.max=n.min+ma(e)}function qm(n,e,t){W3(n.x,e.x,t.x),W3(n.y,e.y,t.y)}function Oae(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Pr(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Pr(t,n,r.max):Math.min(n,t)),n}function H3(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function Dae(n,{top:e,left:t,bottom:r,right:i}){return{x:H3(n.x,t,i),y:H3(n.y,e,r)}}function K3(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function Fae(n,e){return{x:K3(n.x,e.x),y:K3(n.y,e.y)}}function jae(n,e){let t=.5;const r=ma(n),i=ma(e);return i>r?t=X0(e.min,e.max-r,n.min):r>i&&(t=X0(n.min,n.max-i,e.min)),oc(0,1,t)}function Vae(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const dR=.35;function Bae(n=dR){return n===!1?n=0:n===!0&&(n=dR),{x:X3(n,"left","right"),y:X3(n,"top","bottom")}}function X3(n,e,t){return{min:q3(n,e),max:q3(n,t)}}function q3(n,e){return typeof n=="number"?n:n[e]||0}const Y3=()=>({translate:0,scale:1,origin:0,originPoint:0}),n0=()=>({x:Y3(),y:Y3()}),Z3=()=>({min:0,max:0}),$r=()=>({x:Z3(),y:Z3()});function ka(n){return[n("x"),n("y")]}function P7({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function Gae({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function zae(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function pT(n){return n===void 0||n===1}function fR({scale:n,scaleX:e,scaleY:t}){return!pT(n)||!pT(e)||!pT(t)}function kh(n){return fR(n)||M7(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function M7(n){return J3(n.x)||J3(n.y)}function J3(n){return n&&n!=="0%"}function Iv(n,e,t){const r=n-t,i=e*r;return t+i}function Q3(n,e,t,r,i){return i!==void 0&&(n=Iv(n,i,r)),Iv(n,t,r)+e}function gR(n,e=0,t=1,r,i){n.min=Q3(n.min,e,t,r,i),n.max=Q3(n.max,e,t,r,i)}function N7(n,{x:e,y:t}){gR(n.x,e.translate,e.scale,e.originPoint),gR(n.y,t.translate,t.scale,t.originPoint)}const eO=.999999999999,tO=1.0000000000001;function Uae(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,a;for(let o=0;o<i;o++){s=t[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&i0(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,N7(n,a)),r&&kh(s.latestValues)&&i0(n,s.latestValues))}e.x<tO&&e.x>eO&&(e.x=1),e.y<tO&&e.y>eO&&(e.y=1)}function r0(n,e){n.min=n.min+e,n.max=n.max+e}function nO(n,e,t,r,i=.5){const s=Pr(n.min,n.max,i);gR(n,e,t,s,r)}function i0(n,e){nO(n.x,e.x,e.scaleX,e.scale,e.originX),nO(n.y,e.y,e.scaleY,e.scale,e.originY)}function L7(n,e){return P7(zae(n.getBoundingClientRect(),e))}function $ae(n,e,t){const r=L7(n,t),{scroll:i}=e;return i&&(r0(r.x,i.offset.x),r0(r.y,i.offset.y)),r}const O7=({current:n})=>n?n.ownerDocument.defaultView:null,Wae=new WeakMap;class Hae{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=$r(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor($y(h).point)},s=(h,g)=>{const{drag:m,dragPropagation:y,onDragStart:v}=this.getProps();if(m&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=jie(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ka(E=>{let T=this.getAxisMotionValue(E).get()||0;if(al.test(T)){const{projection:b}=this.visualElement;if(b&&b.layout){const R=b.layout.layoutBox[E];R&&(T=ma(R)*(parseFloat(T)/100))}}this.originPoint[E]=T}),v&&gr.postRender(()=>v(h,g)),iR(this.visualElement,"transform");const{animationState:_}=this.visualElement;_&&_.setActive("whileDrag",!0)},a=(h,g)=>{const{dragPropagation:m,dragDirectionLock:y,onDirectionLock:v,onDrag:_}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:E}=g;if(y&&this.currentDirection===null){this.currentDirection=Kae(E),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",g.point,E),this.updateAxis("y",g.point,E),this.visualElement.render(),_&&_(h,g)},o=(h,g)=>this.stop(h,g),l=()=>ka(h=>{var g;return this.getAnimationState(h)==="paused"&&((g=this.getAxisMotionValue(h).animation)===null||g===void 0?void 0:g.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new A7(e,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:O7(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&gr.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Nx(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=Oae(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&e0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=Dae(i.layoutBox,t):this.constraints=!1,this.elastic=Bae(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&ka(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=Vae(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!e0(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=$ae(r,i.root,this.visualElement.getTransformPagePoint());let a=Fae(i.layout.layoutBox,s);if(t){const o=t(Gae(a));this.hasMutatedConstraints=!!o,o&&(a=P7(o))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=ka(h=>{if(!Nx(h,t,this.currentDirection))return;let g=l&&l[h]||{};a&&(g={min:0,max:0});const m=i?200:1e6,y=i?40:1e7,v={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...s,...g};return this.startAxisValueAnimation(h,v)});return Promise.all(c).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return iR(this.visualElement,e),r.start(SI(e,r,0,t,this.visualElement,!1))}stopAnimation(){ka(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ka(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){ka(t=>{const{drag:r}=this.getProps();if(!Nx(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[t];s.set(e[t]-Pr(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!e0(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};ka(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=jae({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),ka(a=>{if(!Nx(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(Pr(l,c,i[a]))})}addListeners(){if(!this.visualElement.current)return;Wae.set(this.visualElement,this);const e=this.visualElement.current,t=Km(e,"pointerdown",l=>{const{drag:c,dragListener:h=!0}=this.getProps();c&&h&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();e0(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),gr.read(r);const a=Kp(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(ka(h=>{const g=this.getAxisMotionValue(h);g&&(this.originPoint[h]+=l[h].translate,g.set(g.get()+l[h].translate))}),this.visualElement.render())}));return()=>{a(),t(),s(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=dR,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function Nx(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function Kae(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class Xae extends Xu{constructor(e){super(e),this.removeGroupControls=da,this.removeListeners=da,this.controls=new Hae(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||da}unmount(){this.removeGroupControls(),this.removeListeners()}}const rO=n=>(e,t)=>{n&&gr.postRender(()=>n(e,t))};class qae extends Xu{constructor(){super(...arguments),this.removePointerDownListener=da}onPointerDown(e){this.session=new A7(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:O7(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:rO(e),onStart:rO(t),onMove:r,onEnd:(s,a)=>{delete this.session,i&&gr.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=Km(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const y_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function iO(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const gm={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(zt.test(n))n=parseFloat(n);else return n;const t=iO(n,e.target.x),r=iO(n,e.target.y);return`${t}% ${r}%`}},Yae={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=Fu.parse(n);if(i.length>5)return r;const s=Fu.createTransformer(n),a=typeof i[0]!="number"?1:0,o=t.x.scale*e.x,l=t.y.scale*e.y;i[0+a]/=o,i[1+a]/=l;const c=Pr(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=c),typeof i[3+a]=="number"&&(i[3+a]/=c),s(i)}};class Zae extends X.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;yie(Jae),s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),y_.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,a=r.projection;return a&&(a.isPresent=s,i||e.layoutDependency!==t||t===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||gr.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Jk.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function D7(n){const[e,t]=x9(),r=X.useContext($k);return f.jsx(Zae,{...n,layoutGroup:r,switchLayoutGroup:X.useContext(R9),isPresent:e,safeToRemove:t})}const Jae={borderRadius:{...gm,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:gm,borderTopRightRadius:gm,borderBottomLeftRadius:gm,borderBottomRightRadius:gm,boxShadow:Yae};function Qae(n,e,t){const r=ls(n)?n:Wp(n);return r.start(SI("",r,e,t)),r.animation}function eoe(n){return n instanceof SVGElement&&n.tagName!=="svg"}const toe=(n,e)=>n.depth-e.depth;class noe{constructor(){this.children=[],this.isDirty=!1}add(e){dI(this.children,e),this.isDirty=!0}remove(e){fI(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(toe),this.isDirty=!1,this.children.forEach(e)}}function roe(n,e){const t=ol.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(Du(r),n(s-e))};return gr.read(r,!0),()=>Du(r)}const F7=["TopLeft","TopRight","BottomLeft","BottomRight"],ioe=F7.length,sO=n=>typeof n=="string"?parseFloat(n):n,aO=n=>typeof n=="number"||zt.test(n);function soe(n,e,t,r,i,s){i?(n.opacity=Pr(0,t.opacity!==void 0?t.opacity:1,aoe(r)),n.opacityExit=Pr(e.opacity!==void 0?e.opacity:1,0,ooe(r))):s&&(n.opacity=Pr(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let a=0;a<ioe;a++){const o=`border${F7[a]}Radius`;let l=oO(e,o),c=oO(t,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||aO(l)===aO(c)?(n[o]=Math.max(Pr(sO(l),sO(c),r),0),(al.test(c)||al.test(l))&&(n[o]+="%")):n[o]=c}(e.rotate||t.rotate)&&(n.rotate=Pr(e.rotate||0,t.rotate||0,r))}function oO(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const aoe=j7(0,.5,n7),ooe=j7(.5,.95,da);function j7(n,e,t){return r=>r<n?0:r>e?1:t(X0(n,e,r))}function lO(n,e){n.min=e.min,n.max=e.max}function Ra(n,e){lO(n.x,e.x),lO(n.y,e.y)}function cO(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function uO(n,e,t,r,i){return n-=e,n=Iv(n,1/t,r),i!==void 0&&(n=Iv(n,1/i,r)),n}function loe(n,e=0,t=1,r=.5,i,s=n,a=n){if(al.test(e)&&(e=parseFloat(e),e=Pr(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=Pr(s.min,s.max,r);n===s&&(o-=e),n.min=uO(n.min,e,t,o,i),n.max=uO(n.max,e,t,o,i)}function hO(n,e,[t,r,i],s,a){loe(n,e[t],e[r],e[i],e.scale,s,a)}const coe=["x","scaleX","originX"],uoe=["y","scaleY","originY"];function dO(n,e,t,r){hO(n.x,e,coe,t?t.x:void 0,r?r.x:void 0),hO(n.y,e,uoe,t?t.y:void 0,r?r.y:void 0)}function fO(n){return n.translate===0&&n.scale===1}function V7(n){return fO(n.x)&&fO(n.y)}function gO(n,e){return n.min===e.min&&n.max===e.max}function hoe(n,e){return gO(n.x,e.x)&&gO(n.y,e.y)}function mO(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function B7(n,e){return mO(n.x,e.x)&&mO(n.y,e.y)}function pO(n){return ma(n.x)/ma(n.y)}function yO(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class doe{constructor(){this.members=[]}add(e){dI(this.members,e),e.scheduleRender()}remove(e){if(fI(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function foe(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,a=t?.z||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:c,rotate:h,rotateX:g,rotateY:m,skewX:y,skewY:v}=t;c&&(r=`perspective(${c}px) ${r}`),h&&(r+=`rotate(${h}deg) `),g&&(r+=`rotateX(${g}deg) `),m&&(r+=`rotateY(${m}deg) `),y&&(r+=`skewX(${y}deg) `),v&&(r+=`skewY(${v}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const Ih={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},km=typeof window<"u"&&window.MotionDebug!==void 0,yT=["","X","Y","Z"],goe={visibility:"hidden"},xO=1e3;let moe=0;function xT(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function G7(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=q9(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",gr,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&G7(r)}function z7({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=e?.()){this.id=moe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,km&&(Ih.totalNodes=Ih.resolvedTargetDeltas=Ih.recalculatedProjection=0),this.nodes.forEach(xoe),this.nodes.forEach(Soe),this.nodes.forEach(Toe),this.nodes.forEach(_oe),km&&window.MotionDebug.record(Ih)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new noe)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new gI),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=eoe(a),this.instance=a;const{layoutId:l,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),n){let g;const m=()=>this.root.updateBlockedByResize=!1;n(a,()=>{this.root.updateBlockedByResize=!0,g&&g(),g=roe(m,250),y_.hasAnimatedSinceResize&&(y_.hasAnimatedSinceResize=!1,this.nodes.forEach(vO))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||c)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:m,hasRelativeTargetChanged:y,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||h.getDefaultTransition()||Ioe,{onLayoutAnimationStart:E,onLayoutAnimationComplete:T}=h.getProps(),b=!this.targetLayout||!B7(this.targetLayout,v)||y,R=!m&&y;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||R||m&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(g,R);const N={...lI(_,"layout"),onPlay:E,onComplete:T};(h.shouldReduceMotion||this.options.layoutRoot)&&(N.delay=0,N.type=!1),this.startAnimation(N)}else m||vO(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Du(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(boe),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&G7(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const g=this.path[h];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(_O);return}this.isUpdating||this.nodes.forEach(woe),this.isUpdating=!1,this.nodes.forEach(Eoe),this.nodes.forEach(poe),this.nodes.forEach(yoe),this.clearAllSnapshots();const o=ol.now();Bi.delta=oc(0,1e3/60,o-Bi.timestamp),Bi.timestamp=o,Bi.isProcessing=!0,lT.update.process(Bi),lT.preRender.process(Bi),lT.render.process(Bi),Bi.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Jk.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(voe),this.sharedNodes.forEach(Roe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,gr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){gr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=$r(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!V7(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,h=c!==this.prevTransformTemplateValue;a&&(o||kh(this.latestValues)||h)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),Coe(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return $r();const l=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(Poe))){const{scroll:h}=this.root;h&&(r0(l.x,h.offset.x),r0(l.y,h.offset.y))}return l}removeElementScroll(a){var o;const l=$r();if(Ra(l,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let c=0;c<this.path.length;c++){const h=this.path[c],{scroll:g,options:m}=h;h!==this.root&&g&&m.layoutScroll&&(g.wasRoot&&Ra(l,a),r0(l.x,g.offset.x),r0(l.y,g.offset.y))}return l}applyTransform(a,o=!1){const l=$r();Ra(l,a);for(let c=0;c<this.path.length;c++){const h=this.path[c];!o&&h.options.layoutScroll&&h.scroll&&h!==h.root&&i0(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),kh(h.latestValues)&&i0(l,h.latestValues)}return kh(this.latestValues)&&i0(l,this.latestValues),l}removeTransform(a){const o=$r();Ra(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!kh(c.latestValues))continue;fR(c.latestValues)&&c.updateSnapshot();const h=$r(),g=c.measurePageBox();Ra(h,g),dO(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,h)}return kh(this.latestValues)&&dO(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Bi.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:m}=this.options;if(!(!this.layout||!(g||m))){if(this.resolvedRelativeTargetAt=Bi.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$r(),this.relativeTargetOrigin=$r(),qm(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),Ra(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=$r(),this.targetWithTransforms=$r()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Lae(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ra(this.target,this.layout.layoutBox),N7(this.target,this.targetDelta)):Ra(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$r(),this.relativeTargetOrigin=$r(),qm(this.relativeTargetOrigin,this.target,y.target),Ra(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}km&&Ih.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||fR(this.parent.latestValues)||M7(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Bi.timestamp&&(c=!1),c)return;const{layout:h,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||g))return;Ra(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,y=this.treeScale.y;Uae(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=$r());const{target:v}=o;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(cO(this.prevProjectionDelta.x,this.projectionDelta.x),cO(this.prevProjectionDelta.y,this.projectionDelta.y)),Xm(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==y||!yO(this.projectionDelta.x,this.prevProjectionDelta.x)||!yO(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),km&&Ih.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=n0(),this.projectionDelta=n0(),this.projectionDeltaWithTransform=n0()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},h={...this.latestValues},g=n0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const m=$r(),y=l?l.source:void 0,v=this.layout?this.layout.source:void 0,_=y!==v,E=this.getStack(),T=!E||E.members.length<=1,b=!!(_&&!T&&this.options.crossfade===!0&&!this.path.some(koe));this.animationProgress=0;let R;this.mixTargetDelta=N=>{const D=N/1e3;wO(g.x,a.x,D),wO(g.y,a.y,D),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(qm(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Aoe(this.relativeTarget,this.relativeTargetOrigin,m,D),R&&hoe(this.relativeTarget,R)&&(this.isProjectionDirty=!1),R||(R=$r()),Ra(R,this.relativeTarget)),_&&(this.animationValues=h,soe(h,c,this.latestValues,D,b,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Du(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=gr.update(()=>{y_.hasAnimatedSinceResize=!0,this.currentAnimation=Qae(0,xO,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(xO),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:h}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&U7(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||$r();const g=ma(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+g;const m=ma(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+m}Ra(o,l),i0(o,h),Xm(this.projectionDeltaWithTransform,this.layoutCorrected,o,h)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new doe),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&xT("z",a,c,this.animationValues);for(let h=0;h<yT.length;h++)xT(`rotate${yT[h]}`,a,c,this.animationValues),xT(`skew${yT[h]}`,a,c,this.animationValues);a.render();for(const h in c)a.setStaticValue(h,c[h]),this.animationValues&&(this.animationValues[h]=c[h]);a.scheduleRender()}getProjectionStyles(a){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return goe;const c={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=m_(a?.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none",c;const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){const _={};return this.options.layoutId&&(_.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,_.pointerEvents=m_(a?.pointerEvents)||""),this.hasProjected&&!kh(this.latestValues)&&(_.transform=h?h({},""):"none",this.hasProjected=!1),_}const m=g.animationValues||g.latestValues;this.applyTransformsToTarget(),c.transform=foe(this.projectionDeltaWithTransform,this.treeScale,m),h&&(c.transform=h(m,c.transform));const{x:y,y:v}=this.projectionDelta;c.transformOrigin=`${y.origin*100}% ${v.origin*100}% 0`,g.animationValues?c.opacity=g===this?(l=(o=m.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:c.opacity=g===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const _ in Tv){if(m[_]===void 0)continue;const{correct:E,applyTo:T}=Tv[_],b=c.transform==="none"?m[_]:E(m[_],g);if(T){const R=T.length;for(let N=0;N<R;N++)c[T[N]]=b}else c[_]=b}return this.options.layoutId&&(c.pointerEvents=g===this?m_(a?.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(_O),this.root.sharedNodes.clear()}}}function poe(n){n.updateLayout()}function yoe(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,a=t.source!==n.layout.source;s==="size"?ka(g=>{const m=a?t.measuredBox[g]:t.layoutBox[g],y=ma(m);m.min=r[g].min,m.max=m.min+y}):U7(s,t.layoutBox,r)&&ka(g=>{const m=a?t.measuredBox[g]:t.layoutBox[g],y=ma(r[g]);m.max=m.min+y,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[g].max=n.relativeTarget[g].min+y)});const o=n0();Xm(o,r,t.layoutBox);const l=n0();a?Xm(l,n.applyTransform(i,!0),t.measuredBox):Xm(l,r,t.layoutBox);const c=!V7(o);let h=!1;if(!n.resumeFrom){const g=n.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:m,layout:y}=g;if(m&&y){const v=$r();qm(v,t.layoutBox,m.layoutBox);const _=$r();qm(_,r,y.layoutBox),B7(v,_)||(h=!0),g.options.layoutRoot&&(n.relativeTarget=_,n.relativeTargetOrigin=v,n.relativeParent=g)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeTargetChanged:h})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function xoe(n){km&&Ih.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function _oe(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function voe(n){n.clearSnapshot()}function _O(n){n.clearMeasurements()}function woe(n){n.isLayoutDirty=!1}function Eoe(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function vO(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function Soe(n){n.resolveTargetDelta()}function Toe(n){n.calcProjection()}function boe(n){n.resetSkewAndRotation()}function Roe(n){n.removeLeadSnapshot()}function wO(n,e,t){n.translate=Pr(e.translate,0,t),n.scale=Pr(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function EO(n,e,t,r){n.min=Pr(e.min,t.min,r),n.max=Pr(e.max,t.max,r)}function Aoe(n,e,t,r){EO(n.x,e.x,t.x,r),EO(n.y,e.y,t.y,r)}function koe(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const Ioe={duration:.45,ease:[.4,0,.1,1]},SO=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),TO=SO("applewebkit/")&&!SO("chrome/")?Math.round:da;function bO(n){n.min=TO(n.min),n.max=TO(n.max)}function Coe(n){bO(n.x),bO(n.y)}function U7(n,e,t){return n==="position"||n==="preserve-aspect"&&!Nae(pO(e),pO(t),.2)}function Poe(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const Moe=z7({attachResizeListener:(n,e)=>Kp(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),_T={current:void 0},$7=z7({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!_T.current){const n=new Moe({});n.mount(window),n.setOptions({layoutScroll:!0}),_T.current=n}return _T.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),Noe={pan:{Feature:qae},drag:{Feature:Xae,ProjectionNode:$7,MeasureLayout:D7}};function RO(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&gr.postRender(()=>s(e,$y(e)))}class Loe extends Xu{mount(){const{current:e}=this.node;e&&(this.unmount=Nie(e,t=>(RO(this.node,t,"Start"),r=>RO(this.node,r,"End"))))}unmount(){}}class Ooe extends Xu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Uy(Kp(this.node.current,"focus",()=>this.onFocus()),Kp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function AO(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&gr.postRender(()=>s(e,$y(e)))}class Doe extends Xu{mount(){const{current:e}=this.node;e&&(this.unmount=Fie(e,t=>(AO(this.node,t,"Start"),(r,{success:i})=>AO(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const mR=new WeakMap,vT=new WeakMap,Foe=n=>{const e=mR.get(n.target);e&&e(n)},joe=n=>{n.forEach(Foe)};function Voe({root:n,...e}){const t=n||document;vT.has(t)||vT.set(t,{});const r=vT.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(joe,{root:n,...e})),r[i]}function Boe(n,e,t){const r=Voe(e);return mR.set(n,t),r.observe(n),()=>{mR.delete(n),r.unobserve(n)}}const Goe={some:0,all:1};class zoe extends Xu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:Goe[i]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:h,onViewportLeave:g}=this.node.getProps(),m=c?h:g;m&&m(l)};return Boe(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(Uoe(e,t))&&this.startObserver()}unmount(){}}function Uoe({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const $oe={inView:{Feature:zoe},tap:{Feature:Doe},focus:{Feature:Ooe},hover:{Feature:Loe}},Woe={layout:{ProjectionNode:$7,MeasureLayout:D7}},pR={current:null},W7={current:!1};function Hoe(){if(W7.current=!0,!!Kk)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>pR.current=n.matches;n.addListener(e),e()}else pR.current=!1}const Koe=[...p7,rs,Fu],Xoe=n=>Koe.find(m7(n)),kO=new WeakMap;function qoe(n,e,t){for(const r in e){const i=e[r],s=t[r];if(ls(i))n.addValue(r,i);else if(ls(s))n.addValue(r,Wp(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,Wp(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const IO=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Yoe{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=vI,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=ol.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,gr.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:h}=a;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=mE(t),this.isVariantNode=T9(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:g,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const y in m){const v=m[y];l[y]!==void 0&&ls(v)&&v.set(l[y],!1)}}mount(e){this.current=e,kO.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),W7.current||Hoe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:pR.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){kO.delete(this.current),this.projection&&this.projection.unmount(),Du(this.notifyUpdate),Du(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Od.has(e),i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&gr.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in q0){const t=q0[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):$r()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<IO.length;r++){const i=IO[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=e[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=qoe(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=Wp(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(f7(i)||i7(i))?i=parseFloat(i):!Xoe(i)&&Fu.test(t)&&(i=u7(e,t)),this.setBaseTarget(e,ls(i)?i.get():i)),ls(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const a=eI(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);a&&(i=a[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!ls(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new gI),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class H7 extends Yoe{constructor(){super(...arguments),this.KeyframeResolver=y7}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ls(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function Zoe(n){return window.getComputedStyle(n)}class Joe extends H7{constructor(){super(...arguments),this.type="html",this.renderInstance=N9}readValueFromInstance(e,t){if(Od.has(t)){const r=_I(t);return r&&r.default||0}else{const r=Zoe(e),i=(C9(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return L7(e,t)}build(e,t,r){rI(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return oI(e,t,r)}}class Qoe extends H7{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=$r}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Od.has(t)){const r=_I(t);return r&&r.default||0}return t=L9.has(t)?t:Zk(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return F9(e,t,r)}build(e,t,r){iI(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){O9(e,t,r,i)}mount(e){this.isSVGTag=aI(e.tagName),super.mount(e)}}const ele=(n,e)=>Qk(n)?new Qoe(e):new Joe(e,{allowProjection:n!==X.Fragment}),tle=Rie({...Tae,...$oe,...Noe,...Woe},ele),bt=Gre(tle);const nle=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),rle=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),CO=n=>{const e=rle(n);return e.charAt(0).toUpperCase()+e.slice(1)},K7=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),ile=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var sle={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const ale=X.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},l)=>X.createElement("svg",{ref:l,...sle,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:K7("lucide",i),...!s&&!ile(o)&&{"aria-hidden":"true"},...o},[...a.map(([c,h])=>X.createElement(c,h)),...Array.isArray(s)?s:[s]]));const at=(n,e)=>{const t=X.forwardRef(({className:r,...i},s)=>X.createElement(ale,{ref:s,iconNode:e,className:K7(`lucide-${nle(CO(n))}`,`lucide-${n}`,r),...i}));return t.displayName=CO(n),t};const ole=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],lle=at("archive-restore",ole);const cle=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],X7=at("archive",cle);const ule=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],hle=at("ban",ule);const dle=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],fle=at("book-open",dle);const gle=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],q7=at("bug",gle);const mle=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],TI=at("calendar",mle);const ple=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],xE=at("camera",ple);const yle=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Y7=at("chart-column",yle);const xle=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],lc=at("check",xle);const _le=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],_E=at("chevron-down",_le);const vle=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],wle=at("chevron-left",vle);const Ele=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Wy=at("chevron-right",Ele);const Sle=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Z7=at("chevron-up",Sle);const Tle=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],J7=at("circle-alert",Tle);const ble=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Rle=at("circle-check-big",ble);const Ale=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Cv=at("clock",Ale);const kle=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],Ile=at("cloud-off",kle);const Cle=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],yR=at("cloud",Cle);const Ple=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Mle=at("code",Ple);const Nle=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Lle=at("compass",Nle);const Ole=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],Pv=at("crosshair",Ole);const Dle=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Mv=at("download",Dle);const Fle=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Au=at("external-link",Fle);const jle=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Nv=at("eye-off",jle);const Vle=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Lv=at("eye",Vle);const Ble=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],bI=at("file-text",Ble);const Gle=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],zle=at("flame",Gle);const Ule=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],$le=at("folder-open",Ule);const Wle=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Hle=at("folder-plus",Wle);const Kle=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Xle=at("folder",Kle);const qle=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],Yle=at("gauge",qle);const Zle=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],Jle=at("gem",Zle);const Qle=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],ece=at("globe",Qle);const tce=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],Q7=at("grid-3x3",tce);const nce=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],rce=at("image-plus",nce);const ice=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],RI=at("info",ice);const sce=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],_o=at("layers",sce);const ace=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],eV=at("list",ace);const oce=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],AI=at("loader-circle",oce);const lce=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],cce=at("locate-fixed",lce);const uce=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],xR=at("lock",uce);const hce=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],kI=at("log-out",hce);const dce=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Ua=at("map-pin",dce);const fce=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],II=at("map",fce);const gce=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],mce=at("menu",gce);const pce=[["path",{d:"M5 12h14",key:"1ays0h"}]],tV=at("minus",pce);const yce=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],Z0=at("mountain",yce);const xce=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],_ce=at("mouse-pointer",xce);const vce=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],CI=at("navigation",vce);const wce=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Ece=at("pause",wce);const Sce=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],PO=at("pen-line",Sce);const Tce=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],bce=at("pen",Tce);const Rce=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],J0=at("pencil",Rce);const Ace=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],nV=at("person-standing",Ace);const kce=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Ice=at("play",kce);const Cce=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],$a=at("plus",Cce);const Pce=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Mce=at("rotate-ccw",Pce);const Nce=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Lce=at("rotate-cw",Nce);const Oce=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],Ov=at("route",Oce);const Dce=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],Xp=at("ruler",Dce);const Fce=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],rV=at("save",Fce);const jce=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],Vce=at("scale",jce);const Bce=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],_R=at("search",Bce);const Gce=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],vR=at("settings",Gce);const zce=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Uce=at("settings-2",zce);const $ce=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Wce=at("share-2",$ce);const Hce=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Kce=at("shield",Hce);const Xce=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],qce=at("sliders-horizontal",Xce);const Yce=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],Zce=at("sliders-vertical",Yce);const Jce=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Qce=at("smartphone",Jce);const eue=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],tue=at("square",eue);const nue=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],rue=at("tag",nue);const iue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],sue=at("target",iue);const aue=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],oue=at("timer",aue);const lue=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],yc=at("trash-2",lue);const cue=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],uue=at("tree-palm",cue);const hue=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],due=at("trending-down",hue);const fue=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],gue=at("trending-up",fue);const mue=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],iV=at("type",mue);const pue=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Hy=at("upload",pue);const yue=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],PI=at("user",yue);const xue=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],_ue=at("volume-2",xue);const vue=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],wue=at("waves",vue);const Eue=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ii=at("x",Eue);function Sue(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:r,setWatchId:i,resetFirstFix:s}=xs(),a=X.useCallback(l=>{r(l)},[r]),o=X.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return X.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(a,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return i(l),()=>{navigator.geolocation.clearWatch(l)}},[n,a,o,i,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function Tue(){const{tracking:n,toggle:e}=Sue();return f.jsx(bt.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:f.jsx(cce,{size:22,strokeWidth:2})})}const bue="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#4285F4" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function Rue(){const n=pi(y=>y.map),e=xs(y=>y.position),t=xs(y=>y.accuracy),r=xs(y=>y.tracking),i=xs(y=>y.smoothHeading),s=ur(y=>y.showAccuracyCircle),a=xs(y=>y.firstFix),o=xs(y=>y.resetFirstFix),l=xs(y=>y.config.centerOnUser),c=X.useRef(null),h=X.useRef(null),g=X.useRef(null),m=X.useMemo(()=>y=>new mn({image:new xy({src:bue,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return X.useEffect(()=>{if(!n||!r&&!e)return;const y=kr([5.1214,52.0907]);return c.current=new _r({geometry:new gi(y)}),c.current.setStyle(m(0)),h.current=new _r({geometry:new gi(y)}),g.current=new $u({source:new dc({features:[h.current,c.current]}),zIndex:1e3}),n.addLayer(g.current),()=>{g.current&&n&&n.removeLayer(g.current)}},[n,r,e,m]),X.useEffect(()=>{if(!n||!e||!c.current||!h.current)return;const y=kr([e.lng,e.lat]);if(c.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const v=n.getView().getResolution()||1,_=Math.min(t/v,80);h.current.setStyle(new mn({image:new Us({radius:_,fill:new tr({color:"rgba(66, 133, 244, 0.12)"})})}))}else h.current.setStyle(new mn({}));if(a&&r){n.getView().setCenter(y),n.getView().setZoom(17),o();return}r&&l&&!a&&n.getView().animate({center:y,duration:150})},[n,r,e,t,a,o,l,s]),X.useEffect(()=>{if(!c.current)return;const y=i!==null?i*Math.PI/180:0;c.current.setStyle(m(y))},[i,m]),null}function Aue(){const n=wr(t=>t.themesPanelOpen),e=wr(t=>t.toggleThemesPanel);return f.jsx(bt.button,{className:`
        fixed bottom-[60px] right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:f.jsx(II,{size:22,strokeWidth:2})})}function kue(){return f.jsx(Aue,{})}const Lx=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],nu=["Mineraal","Fossiel","Erfgoed","Monument","Overig"],oo="default-vondsten",sV={id:oo,name:"Mijn vondsten",color:"#f97316",categories:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()},Iue=n=>n.some(t=>t.id===oo)?n:[{...sV,createdAt:new Date().toISOString()},...n],us=bs()(pc((n,e)=>({layers:[{...sV}],colorIndex:0,addLayer:(t,r=nu)=>{const i=crypto.randomUUID(),s=Lx[e().colorIndex%Lx.length];return n(a=>({layers:[...a.layers,{id:i,name:t,color:s,categories:[...r],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:a.colorIndex+1})),i},removeLayer:t=>{n(r=>({layers:r.layers.filter(i=>i.id!==t)}))},updateLayer:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)}))},toggleVisibility:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)}))},toggleArchived:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,archived:!i.archived,visible:i.archived?i.visible:!1}:i)}))},addPoint:(t,r)=>{const i={...r,status:r.status||"todo",id:crypto.randomUUID(),createdAt:new Date().toISOString()};n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:[...a.points,i]}:a)}))},removePoint:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,points:s.points.filter(a=>a.id!==r)}:s)}))},updatePoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,...i}:o)}:a)}))},setPointStatus:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,status:i}:o)}:a)}))},addCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t&&!s.categories.includes(r)?{...s,categories:[...s.categories,r]}:s)}))},removeCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,categories:s.categories.filter(a=>a!==r)}:s)}))},addPhotoToPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:[...o.photos||[],i]}:o)}:a)}))},removePhotoFromPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:(o.photos||[]).filter(l=>l.id!==i)}:o)}:a)}))},updatePhotoInPoint:(t,r,i,s)=>{n(a=>({layers:a.layers.map(o=>o.id===t?{...o,points:o.points.map(l=>l.id===r?{...l,photos:(l.photos||[]).map(c=>c.id===i?{...c,...s}:c)}:l)}:o)}))},exportLayerAsGeoJSON:t=>{const r=e().layers.find(l=>l.id===t);if(!r)return;const i={type:"FeatureCollection",properties:{name:r.name,color:r.color,categories:r.categories,createdAt:r.createdAt,exportedAt:new Date().toISOString()},features:r.points.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:l.coordinates},properties:{id:l.id,name:l.name,category:l.category,notes:l.notes,url:l.url,status:l.status,sourceLayer:l.sourceLayer,sourceId:l.sourceId,photos:l.photos,createdAt:l.createdAt}}))},s=new Blob([JSON.stringify(i,null,2)],{type:"application/geo+json"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`${r.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},importLayerFromGeoJSON:t=>{try{const r=JSON.parse(t);if(r.type!=="FeatureCollection")return{success:!1,error:"Ongeldig GeoJSON formaat"};const i=r.properties||{},s=i.name||`Gemporteerd ${new Date().toLocaleDateString("nl-NL")}`,a=i.categories||nu,o=i.color||Lx[e().colorIndex%Lx.length],l=(r.features||[]).filter(h=>h.geometry?.type==="Point").map(h=>({id:h.properties?.id||crypto.randomUUID(),name:h.properties?.name||"Naamloos",category:h.properties?.category||"Overig",notes:h.properties?.notes||"",url:h.properties?.url,status:h.properties?.status||"todo",sourceLayer:h.properties?.sourceLayer,sourceId:h.properties?.sourceId,photos:h.properties?.photos,coordinates:h.geometry.coordinates,createdAt:h.properties?.createdAt||new Date().toISOString()})),c=crypto.randomUUID();return n(h=>({layers:[...h.layers,{id:c,name:s,color:o,categories:a,points:l,visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:h.colorIndex+1})),{success:!0,layerId:c}}catch{return{success:!1,error:"Fout bij parsen van GeoJSON"}}},getLayer:t=>e().layers.find(r=>r.id===t),getActiveLayerCount:()=>e().layers.filter(t=>!t.archived).length,getArchivedLayerCount:()=>e().layers.filter(t=>t.archived).length,clearAll:()=>{n(t=>({layers:t.layers.map(r=>r.id===oo?{...r,points:[]}:r).filter(r=>r.id===oo),colorIndex:0}))}}),{name:"detectorapp-custom-point-layers",version:3,migrate:(n,e)=>{const t=n;return e<2?{...t,layers:Iue(t.layers||[])}:e<3?{...t,layers:(t.layers||[]).map(r=>r.id===oo?{...r,name:"Mijn vondsten"}:r)}:t}}));function Di({title:n,children:e,defaultExpanded:t=!0,layerNames:r}){const[i,s]=X.useState(t),a=bi(E=>E.visible),o=bi(E=>E.setLayerVisibility),l=Uk(E=>E.isLayerUnlocked),c=E=>{const T=Nw[E],b=T?.tier??"free",R=T?.regions??["nl"];return l(E,b,R)},h=r?.filter(E=>c(E))||[],g=h.filter(E=>a[E]).length,m=h.length,y=m>0&&g===m,v=g>0&&g<m,_=E=>{if(E.stopPropagation(),!r||h.length===0)return;const T=!y;h.forEach(b=>{o(b,T)})};return f.jsxs("div",{className:"mb-0.5",children:[f.jsxs("div",{className:"flex items-center gap-1 py-1 px-1 hover:bg-blue-50 transition-colors",children:[f.jsxs("button",{onClick:E=>{E.stopPropagation(),s(!i)},className:"flex-1 flex items-center gap-1 bg-transparent border-0 outline-none text-left",style:{fontSize:"inherit"},children:[f.jsx(bt.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:f.jsx(Wy,{size:14})}),i?f.jsx($le,{size:16,className:"text-blue-500"}):f.jsx(Xle,{size:16,className:"text-blue-500"}),f.jsx("span",{className:"text-gray-700 font-medium",style:{fontSize:"1em"},children:n}),g>0&&f.jsx("span",{className:"ml-1 px-1.5 py-0.5 font-medium bg-blue-100 text-blue-600 rounded-full",style:{fontSize:"0.7em"},children:g})]}),r&&r.length>0&&f.jsx("button",{onClick:_,className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:y?"#3b82f6":v?"#93c5fd":"white",border:y?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:(y||v)&&f.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:f.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),f.jsx(Un,{initial:!1,children:i&&f.jsx(bt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function dt({name:n,type:e,hasOverlay:t}){const r=bi(R=>R.visible[n]),i=bi(R=>R.visible["Labels Overlay"]),s=bi(R=>R.loadingState[n]),a=bi(R=>R.toggleLayer),o=bi(R=>R.setLayerVisibility),l=Uk(R=>R.isLayerUnlocked),c=s==="loading",h=s==="error",g=Nw[n],m=g?.tier??"free",y=g?.regions??["nl"],_=!l(n,m,y),E=R=>{R.stopPropagation(),!(c||_)&&(e==="overlay"?a(n):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(D=>{o(D,D===n)}))},T=R=>{R.stopPropagation(),o("Labels Overlay",!i)},b=r??!1;return f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("button",{onClick:E,disabled:c||_,className:`flex-1 flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${_?"opacity-50 cursor-not-allowed bg-gray-50":c?"opacity-70 cursor-wait bg-transparent":b?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,style:{fontSize:"inherit"},title:_?"Premium laag - upgrade om te ontgrendelen":void 0,children:[f.jsxs("span",{className:`flex items-center gap-1 ${h?"text-red-500":_?"text-gray-400":"text-gray-600"}`,children:[n,h&&f.jsx(J7,{size:12,className:"text-red-500"}),_&&f.jsx(xR,{size:12,className:"text-amber-500"})]}),f.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:_?"#e5e7eb":c?"#93c5fd":b?"#3b82f6":"white",border:_?"2px solid #d1d5db":c?"2px solid #93c5fd":b?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:_?f.jsx(xR,{size:10,strokeWidth:3,className:"text-gray-400"}):c?f.jsx(AI,{size:10,strokeWidth:3,className:"animate-spin"}):b?f.jsx(lc,{size:12,strokeWidth:3}):null})]}),t&&b&&f.jsx("button",{onClick:T,className:`p-1 rounded transition-colors border-0 outline-none ${i?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:i?"Labels verbergen":"Labels tonen",children:f.jsx(rue,{size:12})})]})}const Cue=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899","#6b7280"];function aV({layer:n,compact:e=!1}){const{toggleVisibility:t,removeLayer:r,updateLayer:i,setColor:s}=By(),[a,o]=X.useState(!1),[l,c]=X.useState(!1),[h,g]=X.useState(n.name),[m,y]=X.useState(!1),v=X.useRef(null),_=X.useRef(null),E=n.features.features.length,T=[...new Set(n.features.features.map(I=>I.geometry?.type).filter(Boolean))];X.useEffect(()=>{l&&v.current&&(v.current.focus(),v.current.select())},[l]),X.useEffect(()=>{const I=A=>{_.current&&!_.current.contains(A.target)&&y(!1)};if(m)return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[m]);const b=()=>{a?r(n.id):(o(!0),setTimeout(()=>o(!1),3e3))},R=()=>{const I=h.trim();I&&I!==n.name&&i(n.id,{name:I}),c(!1)},N=()=>{g(n.name),c(!1)},D=I=>{I.key==="Enter"?R():I.key==="Escape"&&N()},W=I=>{s(n.id,I),y(!1)};return e?f.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 hover:bg-blue-50 transition-colors rounded",children:[f.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.color}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&f.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:f.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),f.jsx("span",{className:"text-gray-700 truncate flex-1 cursor-pointer",style:{fontSize:"0.9em"},onClick:()=>t(n.id),children:n.name}),f.jsx("span",{className:"text-[10px] text-gray-400 flex-shrink-0",children:E})]}):f.jsxs("div",{className:"flex items-center justify-between py-1.5 group",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[f.jsxs("div",{className:"relative",ref:_,children:[f.jsx("button",{onClick:()=>y(!m),className:"w-5 h-5 rounded border-2 border-white shadow-sm flex-shrink-0 hover:scale-110 transition-transform",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),m&&f.jsx("div",{className:"absolute top-6 left-0 z-50 bg-white rounded-lg shadow-lg border p-2 grid grid-cols-3 gap-1",children:Cue.map(I=>f.jsx("button",{onClick:()=>W(I),className:`w-6 h-6 rounded border-2 transition-transform hover:scale-110 ${I===n.color?"border-gray-800 scale-110":"border-white"}`,style:{backgroundColor:I},title:I},I))})]}),f.jsx("div",{className:"flex-1 min-w-0",children:l?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("input",{ref:v,type:"text",value:h,onChange:I=>g(I.target.value),onKeyDown:D,className:"flex-1 text-sm px-1 py-0.5 border rounded min-w-0"}),f.jsx("button",{onClick:R,className:"p-0.5 text-green-600 hover:bg-green-50 rounded",title:"Opslaan",children:f.jsx(lc,{size:14})}),f.jsx("button",{onClick:N,className:"p-0.5 text-gray-400 hover:bg-gray-100 rounded",title:"Annuleren",children:f.jsx(ii,{size:14})})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-sm text-gray-700 truncate",children:n.name}),f.jsx("button",{onClick:()=>c(!0),className:"p-0.5 text-gray-400 hover:text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Naam wijzigen",children:f.jsx(J0,{size:12})})]}),f.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[f.jsxs("span",{children:[E," ",E===1?"feature":"features"]}),T.length>0&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"mx-0.5",children:""}),f.jsx("span",{children:T.join(", ")})]})]})]})})]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.visible?n.color:"#9ca3af"}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&f.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:f.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),f.jsx("button",{onClick:b,className:`p-1 rounded transition-colors border-0 outline-none ${a?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50"}`,title:a?"Klik nogmaals om te verwijderen":"Verwijderen",children:f.jsx(yc,{size:14})})]})]})}const Pue=[{name:"Rapa Nui - Moai Productie",url:"https://arcg.is/qu59O1",desc:"Paaseiland steengroeve in 3D"},{name:"Digital Giza - Piramides",url:"http://giza.fas.harvard.edu/giza3d/",desc:"Harvard 3D reconstructie"},{name:"Stonehenge 360",url:"https://www.english-heritage.org.uk/visit/places/stonehenge/history-and-stories/stonehenge360/",desc:"English Heritage virtuele tour"},{name:"Pompeii 3D Explorer",url:"https://www.cyark.org/projects/pompeii/3D-Explorer",desc:"CyArk LiDAR scans"},{name:"Virtual Angkor Wat",url:"https://www.virtualangkor.com/",desc:"3D reconstructie 1300 n.Chr."},{name:"Petra Virtuele Tour",url:"https://www.zamaniproject.org/site-jordan-petra.html",desc:"Zamani Project 3D"}],Mue=[{name:"CyArk (200+ sites)",url:"https://www.cyark.org/projects/",desc:"Wereldwijd erfgoed archief"},{name:"Google Open Heritage",url:"https://artsandculture.google.com/project/openheritage",desc:"26+ UNESCO sites in 3D"}];function Nue(){const{themesPanelOpen:n,toggleThemesPanel:e,toggleSettingsPanel:t}=wr(),{layers:r,toggleVisibility:i}=us(),s=By(y=>y.layers),a=X.useRef(null),o=ur(y=>y.layerPanelFontScale),l=ur(y=>y.setLayerPanelFontScale),c=ur(y=>y.showFontSliders),h=13*o/100,[g,m]=X.useState(!1);return X.useEffect(()=>{if(!n)return;const y=_=>{a.current&&!a.current.contains(_.target)&&e()},v=setTimeout(()=>{document.addEventListener("click",y)},100);return()=>{clearTimeout(v),document.removeEventListener("click",y)}},[n,e]),f.jsx(Un,{children:n&&f.jsxs(bt.div,{ref:a,className:"fixed top-2.5 right-2 z-[1101] bg-white rounded-lg shadow-lg overflow-hidden w-[300px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[f.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-500",style:{fontSize:`${h}px`},children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(_o,{size:14,className:"text-white"}),f.jsx("span",{className:"font-medium text-white",children:"Kaartlagen"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[c&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:o,onInput:y=>{l(parseInt(y.target.value))},onChange:y=>l(parseInt(y.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o}%`}),f.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),f.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-blue-400/50 hover:bg-blue-400 transition-colors ml-1",children:f.jsx(ii,{size:16,className:"text-white",strokeWidth:2.5})})]})]}),f.jsxs("div",{className:"p-2 overflow-y-auto flex-1",style:{fontSize:`${h}px`},children:[r.filter(y=>!y.archived).length>0&&f.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[f.jsx("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:f.jsx("span",{className:"text-orange-600 font-medium",style:{fontSize:"0.9em"},children:"Mijn lagen"})}),r.filter(y=>!y.archived).map(y=>f.jsxs("button",{onClick:v=>{v.stopPropagation(),i(y.id)},className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${y.visible?"bg-orange-50 hover:bg-orange-100":"bg-transparent hover:bg-orange-50"}`,style:{fontSize:"inherit"},children:[f.jsxs("span",{className:"flex items-center gap-2 text-gray-600",children:[y.name,f.jsxs("span",{className:"text-xs text-gray-400",children:["(",y.points.length,")"]})]}),f.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:y.visible?"#f97316":"white",border:y.visible?"2px solid #f97316":"2px solid #fb923c",color:"white"},children:y.visible&&f.jsx(lc,{size:12,strokeWidth:3})})]},y.id))]}),s.length>0&&f.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[f.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:[f.jsx(Hy,{size:12,className:"text-cyan-600"}),f.jsx("span",{className:"text-cyan-600 font-medium",style:{fontSize:"0.9em"},children:"Gemporteerde lagen"})]}),s.map(y=>f.jsx(aV,{layer:y,compact:!0},y.id)),f.jsx("button",{onClick:()=>{e(),t()},className:"w-full text-left py-1 pl-3 text-xs text-cyan-500 hover:text-cyan-700 hover:bg-cyan-50 transition-colors",children:"+ Laag importeren..."})]}),f.jsxs("div",{className:"mb-2",children:[f.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1",children:f.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Basislaag"})}),f.jsxs("div",{className:"space-y-0",children:[f.jsx(dt,{name:"CartoDB (licht)",type:"base"}),f.jsx(dt,{name:"OpenStreetMap",type:"base"}),f.jsx(dt,{name:"Luchtfoto",type:"base",hasOverlay:!0}),f.jsx(dt,{name:"TMK 1850",type:"base",hasOverlay:!0}),f.jsx(dt,{name:"Bonnebladen 1900",type:"base",hasOverlay:!0})]})]}),f.jsxs("div",{className:"mb-2",children:[f.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1 border-t border-gray-100 pt-2",children:f.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Thema's"})}),f.jsxs(Di,{title:"Steentijd & Prehistorie",defaultExpanded:!1,layerNames:["Hunebedden","Grafheuvels","Terpen"],children:[f.jsx(dt,{name:"Hunebedden",type:"overlay"}),f.jsx(dt,{name:"Grafheuvels",type:"overlay"}),f.jsx(dt,{name:"Terpen",type:"overlay"})]}),f.jsxs(Di,{title:"Paleokaarten",defaultExpanded:!1,layerNames:["Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[f.jsx(dt,{name:"Paleokaart 9000 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),f.jsx(dt,{name:"Paleokaart 800 n.Chr.",type:"overlay"})]}),f.jsxs(Di,{title:"Archeologische lagen",defaultExpanded:!1,layerNames:["FAMKE Steentijd","FAMKE IJzertijd","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Archeo Onderzoeken","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[f.jsx(dt,{name:"FAMKE Steentijd",type:"overlay"}),f.jsx(dt,{name:"FAMKE IJzertijd",type:"overlay"}),f.jsx(dt,{name:"AMK Monumenten",type:"overlay"}),f.jsxs(Di,{title:"AMK per periode",defaultExpanded:!1,layerNames:["AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig"],children:[f.jsx(dt,{name:"AMK Romeins",type:"overlay"}),f.jsx(dt,{name:"AMK Steentijd",type:"overlay"}),f.jsx(dt,{name:"AMK Vroege ME",type:"overlay"}),f.jsx(dt,{name:"AMK Late ME",type:"overlay"}),f.jsx(dt,{name:"AMK Overig",type:"overlay"})]}),f.jsx(dt,{name:"Archeo Onderzoeken",type:"overlay"}),f.jsxs(Di,{title:"Romeinse tijd",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[f.jsx(dt,{name:"Romeinse wegen (regio)",type:"overlay"}),f.jsx(dt,{name:"Romeinse wegen (Wereld)",type:"overlay"}),f.jsx(dt,{name:"Romeinse Forten",type:"overlay"}),f.jsx(dt,{name:"Romeinse Forten Lijnen",type:"overlay"})]})]}),f.jsxs(Di,{title:"Archeologische verwachtingen",defaultExpanded:!1,layerNames:["IKAW","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[f.jsx(dt,{name:"IKAW",type:"overlay"}),f.jsx(dt,{name:"UIKAV Punten",type:"overlay"}),f.jsx(dt,{name:"UIKAV Vlakken",type:"overlay"}),f.jsx(dt,{name:"UIKAV Expert",type:"overlay"}),f.jsx(dt,{name:"UIKAV Buffer",type:"overlay"}),f.jsx(dt,{name:"UIKAV Indeling",type:"overlay"})]}),f.jsxs(Di,{title:"Erfgoed & Monumenten",defaultExpanded:!1,layerNames:["Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Kastelen","Runes"],children:[f.jsx(dt,{name:"Rijksmonumenten",type:"overlay"}),f.jsx(dt,{name:"Werelderfgoed",type:"overlay"}),f.jsx(dt,{name:"Religieus Erfgoed",type:"overlay"}),f.jsx(dt,{name:"Kastelen",type:"overlay"}),f.jsx(dt,{name:"Runes",type:"overlay"})]}),f.jsxs(Di,{title:"WOII & Militair",defaultExpanded:!1,layerNames:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten","Inundatiegebieden"],children:[f.jsx(dt,{name:"WWII Bunkers",type:"overlay"}),f.jsx(dt,{name:"Slagvelden",type:"overlay"}),f.jsx(dt,{name:"Militaire Vliegvelden",type:"overlay"}),f.jsx(dt,{name:"Verdedigingslinies",type:"overlay"}),f.jsx(dt,{name:"Militaire Objecten",type:"overlay"}),f.jsx(dt,{name:"Inundatiegebieden",type:"overlay"})]}),f.jsxs(Di,{title:"Hillshade & LiDAR",defaultExpanded:!1,layerNames:["AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m"],children:[f.jsx(dt,{name:"AHN4 Hoogtekaart Kleur",type:"overlay"}),f.jsx(dt,{name:"AHN4 Hillshade NL",type:"overlay"}),f.jsx(dt,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),f.jsx(dt,{name:"AHN 0.5m",type:"overlay"})]}),f.jsxs(Di,{title:"Terrein & Bodem",defaultExpanded:!1,layerNames:["Veengebieden","Geomorfologie","Bodemkaart","Essen"],children:[f.jsx(dt,{name:"Veengebieden",type:"overlay"}),f.jsx(dt,{name:"Geomorfologie",type:"overlay"}),f.jsx(dt,{name:"Bodemkaart",type:"overlay"}),f.jsx(dt,{name:"Essen",type:"overlay"})]}),f.jsxs(Di,{title:"Percelen",defaultExpanded:!1,layerNames:["Gewaspercelen","Kadastrale Grenzen"],children:[f.jsx(dt,{name:"Gewaspercelen",type:"overlay"}),f.jsx(dt,{name:"Kadastrale Grenzen",type:"overlay"})]}),f.jsxs(Di,{title:"Provinciale Thema's",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],children:[f.jsxs(Di,{title:"Zuid-Holland",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen"],children:[f.jsx(dt,{name:"Scheepswrakken",type:"overlay"}),f.jsx(dt,{name:"Woonheuvels ZH",type:"overlay"}),f.jsx(dt,{name:"Windmolens",type:"overlay"}),f.jsx(dt,{name:"Erfgoedlijnen",type:"overlay"}),f.jsx(dt,{name:"Oude Kernen",type:"overlay"})]}),f.jsxs(Di,{title:"Gelderland",defaultExpanded:!1,layerNames:["Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken"],children:[f.jsx(dt,{name:"Relictenkaart Punten",type:"overlay"}),f.jsx(dt,{name:"Relictenkaart Lijnen",type:"overlay"}),f.jsx(dt,{name:"Relictenkaart Vlakken",type:"overlay"})]}),f.jsx(Di,{title:"Zeeland",defaultExpanded:!1,layerNames:["Verdronken Dorpen"],children:f.jsx(dt,{name:"Verdronken Dorpen",type:"overlay"})})]}),f.jsxs(Di,{title:"Fossielen, Mineralen & Goud",defaultExpanded:!1,layerNames:["Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk"],children:[f.jsx(dt,{name:"Fossiel Hotspots",type:"overlay"}),f.jsx(dt,{name:"Mineralen Hotspots",type:"overlay"}),f.jsx(dt,{name:"Goudrivieren",type:"overlay"}),f.jsx(dt,{name:"Fossielen Nederland",type:"overlay"}),f.jsx(dt,{name:"Fossielen Belgi",type:"overlay"}),f.jsx(dt,{name:"Fossielen Duitsland",type:"overlay"}),f.jsx(dt,{name:"Fossielen Frankrijk",type:"overlay"})]}),f.jsxs(Di,{title:"Recreatie",defaultExpanded:!1,layerNames:["Wandelroutes","Ruiterpaden","Laarzenpaden","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels"],children:[f.jsx(dt,{name:"Wandelroutes",type:"overlay"}),f.jsx(dt,{name:"Ruiterpaden",type:"overlay"}),f.jsx(dt,{name:"Laarzenpaden",type:"overlay"}),f.jsx(dt,{name:"Parken",type:"overlay"}),f.jsx(dt,{name:"Speeltuinen",type:"overlay"}),f.jsx(dt,{name:"Musea",type:"overlay"}),f.jsx(dt,{name:"Strandjes",type:"overlay"}),f.jsx(dt,{name:"Kringloopwinkels",type:"overlay"})]}),f.jsxs("div",{className:"mb-2",children:[f.jsxs("button",{onClick:y=>{y.stopPropagation(),m(!g)},className:"w-full flex items-center gap-1 py-1 px-1 hover:bg-purple-50 rounded transition-colors border-0 outline-none bg-transparent",children:[g?f.jsx(_E,{size:14,className:"text-purple-500"}):f.jsx(Wy,{size:14,className:"text-purple-500"}),f.jsx(ece,{size:12,className:"text-purple-500"}),f.jsx("span",{className:"text-purple-600 font-medium",style:{fontSize:"0.95em"},children:"Speciale Projecten"}),f.jsx(Au,{size:10,className:"text-purple-400 ml-auto"})]}),g&&f.jsxs("div",{className:"mt-1",onClick:y=>y.stopPropagation(),children:[Pue.map(y=>f.jsxs("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",onClick:v=>v.stopPropagation(),className:"w-full flex items-center justify-between py-1.5 pl-6 pr-2 hover:bg-purple-50 rounded transition-colors text-left",style:{fontSize:"inherit"},children:[f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"text-gray-700",children:y.name}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:y.desc})]}),f.jsx(Au,{size:12,className:"text-purple-400 flex-shrink-0 ml-2"})]},y.name)),f.jsx("div",{className:"border-t border-gray-200 my-1.5 mx-2"}),Mue.map(y=>f.jsxs("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",onClick:v=>v.stopPropagation(),className:"w-full flex items-center justify-between py-1.5 pl-6 pr-2 hover:bg-purple-50 rounded transition-colors text-left",style:{fontSize:"inherit"},children:[f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"text-gray-700 font-medium",children:y.name}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:y.desc})]}),f.jsx(Au,{size:12,className:"text-purple-400 flex-shrink-0 ml-2"})]},y.name))]})]})]})]})]})})}function Lue(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var vd=1,wd=2,_0=3,Oue=4,wR=5,MO=6378137,Due=6356752314e-3,NO=.0066943799901413165,Ym=484813681109536e-20,We=Math.PI/2,Fue=.16666666666666666,jue=.04722222222222222,Vue=.022156084656084655,lt=1e-10,Or=.017453292519943295,Bs=57.29577951308232,Gn=Math.PI/4,qp=Math.PI*2,Wr=3.14159265359,Xs={};Xs.greenwich=0;Xs.lisbon=-9.131906111111;Xs.paris=2.337229166667;Xs.bogota=-74.080916666667;Xs.madrid=-3.687938888889;Xs.rome=12.452333333333;Xs.bern=7.439583333333;Xs.jakarta=106.807719444444;Xs.ferro=-17.666666666667;Xs.brussels=4.367975;Xs.stockholm=18.058277777778;Xs.athens=23.7163375;Xs.oslo=10.722916666667;const Bue={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var LO=/[\s_\-\/\(\)]/g;function ju(n,e){if(n[e])return n[e];for(var t=Object.keys(n),r=e.toLowerCase().replace(LO,""),i=-1,s,a;++i<t.length;)if(s=t[i],a=s.toLowerCase().replace(LO,""),a===r)return n[s]}function ER(n){var e={},t=n.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,l){var c=l.split("=");return c.push(!0),o[c[0].toLowerCase()]=c[1],o},{}),r,i,s,a={proj:"projName",datum:"datumCode",rf:function(o){e.rf=parseFloat(o)},lat_0:function(o){e.lat0=o*Or},lat_1:function(o){e.lat1=o*Or},lat_2:function(o){e.lat2=o*Or},lat_ts:function(o){e.lat_ts=o*Or},lon_0:function(o){e.long0=o*Or},lon_1:function(o){e.long1=o*Or},lon_2:function(o){e.long2=o*Or},alpha:function(o){e.alpha=parseFloat(o)*Or},gamma:function(o){e.rectified_grid_angle=parseFloat(o)*Or},lonc:function(o){e.longc=o*Or},x_0:function(o){e.x0=parseFloat(o)},y_0:function(o){e.y0=parseFloat(o)},k_0:function(o){e.k0=parseFloat(o)},k:function(o){e.k0=parseFloat(o)},a:function(o){e.a=parseFloat(o)},b:function(o){e.b=parseFloat(o)},r:function(o){e.a=e.b=parseFloat(o)},r_a:function(){e.R_A=!0},zone:function(o){e.zone=parseInt(o,10)},south:function(){e.utmSouth=!0},towgs84:function(o){e.datum_params=o.split(",").map(function(l){return parseFloat(l)})},to_meter:function(o){e.to_meter=parseFloat(o)},units:function(o){e.units=o;var l=ju(Bue,o);l&&(e.to_meter=l.to_meter)},from_greenwich:function(o){e.from_greenwich=o*Or},pm:function(o){var l=ju(Xs,o);e.from_greenwich=(l||parseFloat(o))*Or},nadgrids:function(o){o==="@null"?e.datumCode="none":e.nadgrids=o},axis:function(o){var l="ewnsud";o.length===3&&l.indexOf(o.substr(0,1))!==-1&&l.indexOf(o.substr(1,1))!==-1&&l.indexOf(o.substr(2,1))!==-1&&(e.axis=o)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in t)i=t[r],r in a?(s=a[r],typeof s=="function"?s(i):e[s]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class oV{static getId(e){const t=e.find(r=>Array.isArray(r)&&r[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const r=e[1],i=parseFloat(e[2])||null,s=e.find(o=>Array.isArray(o)&&o[0]==="ID"),a=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:r,conversion_factor:i,id:a}}static convertAxis(e){const t=e[1]||"Unknown";let r;const i=t.match(/^\((.)\)$/);if(i){const c=i[1].toUpperCase();if(c==="E")r="east";else if(c==="N")r="north";else if(c==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${c}`)}else r=e[2]?e[2].toLowerCase():"unknown";const s=e.find(c=>Array.isArray(c)&&c[0]==="ORDER"),a=s?parseInt(s[1],10):null,o=e.find(c=>Array.isArray(c)&&(c[0]==="LENGTHUNIT"||c[0]==="ANGLEUNIT"||c[0]==="SCALEUNIT")),l=this.convertUnit(o);return{name:t,direction:r,unit:l,order:a}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,r)=>(t.order||0)-(r.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")):null,t.conversion=e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")):null;const r=e.find(m=>Array.isArray(m)&&m[0]==="CS");r&&(t.coordinate_system={type:r[1],axis:this.extractAxes(e)});const i=e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT");if(i){const m=this.convertUnit(i);t.coordinate_system.unit=m}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(m=>Array.isArray(m)&&(m[0]==="DATUM"||m[0]==="ENSEMBLE"));if(s){const m=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=m:t.datum=m;const y=e.find(v=>Array.isArray(v)&&v[0]==="PRIMEM");y&&y[1]!=="Greenwich"&&(m.prime_meridian={name:y[1],longitude:parseFloat(y[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(m=>Array.isArray(m)&&m[0]==="MEMBER").map(m=>({type:"DatumEnsembleMember",name:m[1],id:this.getId(m)}));const a=e.find(m=>Array.isArray(m)&&m[0]==="ENSEMBLEACCURACY");a&&(t.accuracy=parseFloat(a[1]));const o=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID");o&&(t.ellipsoid=this.convert(o)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT")&&this.convert(e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&m[0]==="PARAMETER").map(m=>this.convert(m));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(m=>Array.isArray(m)&&(m[0]==="LENGTHUNIT"||m[0]==="ANGLEUNIT"||m[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const l=e.find(m=>Array.isArray(m)&&m[0]==="SOURCECRS");if(l){const m=l.find(y=>Array.isArray(y));t.source_crs=m?this.convert(m):null}const c=e.find(m=>Array.isArray(m)&&m[0]==="TARGETCRS");if(c){const m=c.find(y=>Array.isArray(y));t.target_crs=m?this.convert(m):null}const h=e.find(m=>Array.isArray(m)&&m[0]==="ABRIDGEDTRANSFORMATION");h?t.transformation=this.convert(h):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&(m[0]==="PARAMETER"||m[0]==="PARAMETERFILE")).map(m=>{if(m[0]==="PARAMETER")return this.convert(m);if(m[0]==="PARAMETERFILE")return{name:m[1],value:m[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const m=t.parameters[6];m.name==="Scale difference"&&(m.value=Math.round((m.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const g=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(m=>{m.unit||(m.unit=g)}),g.conversion_factor&&g.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:g});break;default:t.keyword=e[0];break}return t}}class Gue extends oV{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class zue extends oV{static convert(e,t={}){super.convert(e,t);const r=e.find(s=>Array.isArray(s)&&s[0]==="CS");r&&(t.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const i=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(i){const s=i.find(l=>Array.isArray(l)&&l[0]==="SCOPE"),a=i.find(l=>Array.isArray(l)&&l[0]==="AREA"),o=i.find(l=>Array.isArray(l)&&l[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),a&&(t.usage.area=a[1]),o&&(t.usage.bbox=o.slice(1))}return t}}function Uue(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function $ue(n){return(Uue(n)==="2019"?zue:Gue).convert(n)}function Wue(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var Yp=1,lV=2,cV=3,Dv=4,uV=5,MI=-1,Hue=/\s/,Kue=/[A-Za-z]/,Xue=/[A-Za-z84_]/,vE=/[,\]]/,hV=/[\d\.E\-\+]/;function xc(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Yp}xc.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==Dv)for(;Hue.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case Yp:return this.neutral(n);case lV:return this.keyword(n);case Dv:return this.quoted(n);case uV:return this.afterquote(n);case cV:return this.number(n);case MI:return}};xc.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=Dv;return}if(vE.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};xc.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Yp;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Yp,this.currentObject=this.stack.pop(),this.currentObject||(this.state=MI);return}};xc.prototype.number=function(n){if(hV.test(n)){this.word+=n;return}if(vE.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};xc.prototype.quoted=function(n){if(n==='"'){this.state=uV;return}this.word+=n};xc.prototype.keyword=function(n){if(Xue.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=Yp;return}if(vE.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};xc.prototype.neutral=function(n){if(Kue.test(n)){this.word=n,this.state=lV;return}if(n==='"'){this.word="",this.state=Dv;return}if(hV.test(n)){this.word=n,this.state=cV;return}if(vE.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};xc.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===MI)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function que(n){var e=new xc(n);return e.output()}function wT(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var r=e?{}:n,i=t.reduce(function(s,a){return s0(a,s),s},r);e&&(n[e]=i)}function s0(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},s0(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var r;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&s0(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&s0(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],wT(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],wT(e,t,n),e[t].type=t;return;default:for(r=-1;++r<n.length;)if(!Array.isArray(n[r]))return s0(n,e[t]);return wT(e,t,n)}}var Yue=.017453292519943295;function so(n){return n*Yue}function dV(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=so(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=so(n.lat0>0?90:-90),delete n.lat1)}function OO(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function DO(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function FO(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=DO(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-DO(n.ellipsoid.semi_minor_axis))))}function Fv(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(Fv(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const r=n[t];if(r!==null)switch(t){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,FO(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,FO(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(i=>{const s=i.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",r.unit){const{units:i,to_meter:s}=OO(r.unit);e.units=i,e.to_meter=s}else if(r.axis[0]&&r.axis[0].unit){const{units:i,to_meter:s}=OO(r.axis[0].unit);e.units=i,e.to_meter=s}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(i=>{const s=i.name.toLowerCase().replace(/\s+/g,"_"),a=i.value;i.unit&&i.unit.conversion_factor?e[s]=a*i.unit.conversion_factor:i.unit==="degree"?e[s]=a*Math.PI/180:e[s]=a});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":Fv(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),dV(e),e)}var Zue=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Jue(n,e){var t=e[0],r=e[1];!(t in n)&&r in n&&(n[t]=n[r],e.length===3&&(n[t]=e[2](n[t])))}function fV(n){for(var e=Object.keys(n),t=0,r=e.length;t<r;++t){var i=e[t];Zue.indexOf(i)!==-1&&Que(n[i]),typeof n[i]=="object"&&fV(n[i])}}function Que(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",r=0,i=n.AXIS.length;r<i;++r){var s=[n.AXIS[r][0].toLowerCase(),n.AXIS[r][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var a=n.GEOGCS;n.type==="GEOGCS"&&(a=n),a&&(a.DATUM?n.datumCode=a.DATUM.name.toLowerCase():n.datumCode=a.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(n.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=a.DATUM.SPHEROID.a,n.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(n.datum_params=a.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=so(n.rectified_grid_angle));function o(h){var g=n.to_meter||1;return h*g}var l=function(h){return Jue(n,h)},c=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",so],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",so],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",so],["lat0","latitude_of_origin",so],["lat0","standard_parallel_1",so],["lat1","standard_parallel_1",so],["lat2","standard_parallel_2",so],["azimuth","Azimuth"],["alpha","azimuth",so],["srsCode","name"]];c.forEach(l),dV(n)}function jv(n){if(typeof n=="object")return Fv(n);const e=Wue(n);var t=que(n);if(e==="WKT2"){const s=$ue(t);return Fv(s)}var r=t[0],i={};return s0(t,i),fV(i),i[r]}function Vi(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?Vi[n]=ER(arguments[1]):Vi[n]=jv(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?Vi[n]=jv(arguments[1]):(Vi[n]=t,t||delete Vi[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(r){return Array.isArray(r)?Vi.apply(e,r):Vi(r)});if(typeof n=="string"){if(n in Vi)return Vi[n]}else"EPSG"in n?Vi["EPSG:"+n.EPSG]=n:"ESRI"in n?Vi["ESRI:"+n.ESRI]=n:"IAU2000"in n?Vi["IAU2000:"+n.IAU2000]=n:console.log(n);return}}Lue(Vi);function ehe(n){return typeof n=="string"}function the(n){return n in Vi}function nhe(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var rhe=["3857","900913","3785","102113"];function ihe(n){var e=ju(n,"authority");if(e){var t=ju(e,"epsg");return t&&rhe.indexOf(t)>-1}}function she(n){var e=ju(n,"extension");if(e)return ju(e,"proj4")}function ahe(n){return n[0]==="+"}function ohe(n){if(ehe(n)){if(the(n))return Vi[n];if(nhe(n)){var e=jv(n);if(ihe(e))return Vi["EPSG:3857"];var t=she(e);return t?ER(t):e}if(ahe(n))return ER(n)}else return"projName"in n?n:jv(n)}function jO(n,e){n=n||{};var t,r;if(!e)return n;for(r in e)t=e[r],t!==void 0&&(n[r]=t);return n}function fl(n,e,t){var r=n*e;return t/Math.sqrt(1-r*r)}function Ky(n){return n<0?-1:1}function mt(n,e){return e||Math.abs(n)<=Wr?n:n-Ky(n)*qp}function vo(n,e,t){var r=n*t,i=.5*n;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(We-e))/r}function Zp(n,e){for(var t=.5*n,r,i,s=We-2*Math.atan(e),a=0;a<=15;a++)if(r=n*Math.sin(s),i=We-2*Math.atan(e*Math.pow((1-r)/(1+r),t))-s,s+=i,Math.abs(i)<=1e-10)return s;return-9999}function lhe(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=fl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function che(n){var e=n.x,t=n.y;if(t*Bs>90&&t*Bs<-90&&e*Bs>180&&e*Bs<-180)return null;var r,i;if(Math.abs(Math.abs(t)-We)<=lt)return null;if(this.sphere)r=this.x0+this.a*this.k0*mt(e-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(Gn+.5*t));else{var s=Math.sin(t),a=vo(this.e,t,s);r=this.x0+this.a*this.k0*mt(e-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(a)}return n.x=r,n.y=i,n}function uhe(n){var e=n.x-this.x0,t=n.y-this.y0,r,i;if(this.sphere)i=We-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(i=Zp(this.e,s),i===-9999)return null}return r=mt(this.long0+e/(this.a*this.k0),this.over),n.x=r,n.y=i,n}var hhe=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const dhe={init:lhe,forward:che,inverse:uhe,names:hhe};function fhe(){}function VO(n){return n}var gV=["longlat","identity"];const ghe={init:fhe,forward:VO,inverse:VO,names:gV};var mhe=[dhe,ghe],Ch={},a0=[];function mV(n,e){var t=a0.length;return n.names?(a0[t]=n,n.names.forEach(function(r){Ch[r.toLowerCase()]=t}),this):(console.log(e),!0)}function pV(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function phe(n){if(!n)return!1;var e=n.toLowerCase();if(typeof Ch[e]<"u"&&a0[Ch[e]]||(e=pV(e),e in Ch&&a0[Ch[e]]))return a0[Ch[e]]}function yhe(){mhe.forEach(mV)}const xhe={start:yhe,add:mV,get:phe};var yV={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const _he=yV.WGS84;function vhe(n,e,t,r){var i=n*n,s=e*e,a=(i-s)/i,o=0;r?(n*=1-a*(Fue+a*(jue+a*Vue)),i=n*n,a=0):o=Math.sqrt(a);var l=(i-s)/s;return{es:a,e:o,ep2:l}}function whe(n,e,t,r,i){if(!n){var s=ju(yV,r);s||(s=_he),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<lt)&&(i=!0,e=n),{a:n,b:e,rf:t,sphere:i}}var x_={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var Ehe in x_){var ET=x_[Ehe];ET.datumName&&(x_[ET.datumName]=ET)}function She(n,e,t,r,i,s,a){var o={};return n===void 0||n==="none"?o.datum_type=wR:o.datum_type=Oue,e&&(o.datum_params=e.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=vd),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=wd,o.datum_params[3]*=Ym,o.datum_params[4]*=Ym,o.datum_params[5]*=Ym,o.datum_params[6]=o.datum_params[6]/1e6+1)),a&&(o.datum_type=_0,o.grids=a),o.a=t,o.b=r,o.es=i,o.ep2=s,o}var NI={};function The(n,e,t){return e instanceof ArrayBuffer?bhe(n,e,t):{ready:Rhe(n,e)}}function bhe(n,e,t){var r=!0;t!==void 0&&t.includeErrorFields===!1&&(r=!1);var i=new DataView(e),s=Ihe(i),a=Che(i,s),o=Phe(i,a,s,r),l={header:a,subgrids:o};return NI[n]=l,l}async function Rhe(n,e){for(var t=[],r=await e.getImageCount(),i=r-1;i>=0;i--){var s=await e.getImage(i),a=await s.readRasters(),o=a,l=[s.getWidth(),s.getHeight()],c=s.getBoundingBox().map(BO),h=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(BO),g=c[0]+(l[0]-1)*h[0],m=c[3]-(l[1]-1)*h[1],y=o[0],v=o[1],_=[];for(let b=l[1]-1;b>=0;b--)for(let R=l[0]-1;R>=0;R--){var E=b*l[0]+R;_.push([-mu(v[E]),mu(y[E])])}t.push({del:h,lim:l,ll:[-g,m],cvs:_})}var T={header:{nSubgrids:r},subgrids:t};return NI[n]=T,T}function Ahe(n){if(n===void 0)return null;var e=n.split(",");return e.map(khe)}function khe(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:NI[n]||null,isNull:!1}}function BO(n){return n*Math.PI/180}function mu(n){return n/3600*Math.PI/180}function Ihe(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function Che(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:SR(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function SR(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function Phe(n,e,t,r){for(var i=176,s=[],a=0;a<e.nSubgrids;a++){var o=Nhe(n,i,t),l=Lhe(n,i,o,t,r),c=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),h=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);s.push({ll:[mu(o.lowerLongitude),mu(o.lowerLatitude)],del:[mu(o.longitudeInterval),mu(o.latitudeInterval)],lim:[c,h],count:o.gridNodeCount,cvs:Mhe(l)});var g=16;r===!1&&(g=8),i+=176+o.gridNodeCount*g}return s}function Mhe(n){return n.map(function(e){return[mu(e.longitudeShift),mu(e.latitudeShift)]})}function Nhe(n,e,t){return{name:SR(n,e+8,e+16).trim(),parent:SR(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function Lhe(n,e,t,r,i){var s=e+176,a=16;i===!1&&(a=8);for(var o=[],l=0;l<t.gridNodeCount;l++){var c={latitudeShift:n.getFloat32(s+l*a,r),longitudeShift:n.getFloat32(s+l*a+4,r)};i!==!1&&(c.latitudeAccuracy=n.getFloat32(s+l*a+8,r),c.longitudeAccuracy=n.getFloat32(s+l*a+12,r)),o.push(c)}return o}function ja(n,e){if(!(this instanceof ja))return new ja(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(c){if(c)throw c};var t=ohe(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var r=ja.projections.get(t.projName);if(!r){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var i=ju(x_,t.datumCode);i&&(t.datum_params=t.datum_params||(i.towgs84?i.towgs84.split(","):null),t.ellps=i.ellipse,t.datumName=i.datumName?i.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=whe(t.a,t.b,t.rf,t.ellps,t.sphere),a=vhe(s.a,s.b,s.rf,t.R_A),o=Ahe(t.nadgrids),l=t.datum||She(t.datumCode,t.datum_params,s.a,s.b,a.es,a.ep2,o);jO(this,t),jO(this,r),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=l,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}ja.projections=xhe;ja.projections.start();function Ohe(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===vd?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===wd?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function xV(n,e,t){var r=n.x,i=n.y,s=n.z?n.z:0,a,o,l,c;if(i<-We&&i>-1.001*We)i=-We;else if(i>We&&i<1.001*We)i=We;else{if(i<-We)return{x:-1/0,y:-1/0,z:n.z};if(i>We)return{x:1/0,y:1/0,z:n.z}}return r>Math.PI&&(r-=2*Math.PI),o=Math.sin(i),c=Math.cos(i),l=o*o,a=t/Math.sqrt(1-e*l),{x:(a+s)*c*Math.cos(r),y:(a+s)*c*Math.sin(r),z:(a*(1-e)+s)*o}}function _V(n,e,t,r){var i=1e-12,s=i*i,a=30,o,l,c,h,g,m,y,v,_,E,T,b,R,N=n.x,D=n.y,W=n.z?n.z:0,I,A,M;if(o=Math.sqrt(N*N+D*D),l=Math.sqrt(N*N+D*D+W*W),o/t<i){if(I=0,l/t<i)return A=We,M=-r,{x:n.x,y:n.y,z:n.z}}else I=Math.atan2(D,N);c=W/l,h=o/l,g=1/Math.sqrt(1-e*(2-e)*h*h),v=h*(1-e)*g,_=c*g,R=0;do R++,y=t/Math.sqrt(1-e*_*_),M=o*v+W*_-y*(1-e*_*_),m=e*y/(y+M),g=1/Math.sqrt(1-m*(2-m)*h*h),E=h*(1-m)*g,T=c*g,b=T*v-E*_,v=E,_=T;while(b*b>s&&R<a);return A=Math.atan(T/Math.abs(E)),{x:I,y:A,z:M}}function Dhe(n,e,t){if(e===vd)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===wd){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6];return{x:c*(n.x-l*n.y+o*n.z)+r,y:c*(l*n.x+n.y-a*n.z)+i,z:c*(-o*n.x+a*n.y+n.z)+s}}}function Fhe(n,e,t){if(e===vd)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===wd){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=(n.x-r)/c,g=(n.y-i)/c,m=(n.z-s)/c;return{x:h+l*g-o*m,y:-l*h+g+a*m,z:o*h-a*g+m}}}function Ox(n){return n===vd||n===wd}function jhe(n,e,t){if(Ohe(n,e)||n.datum_type===wR||e.datum_type===wR)return t;var r=n.a,i=n.es;if(n.datum_type===_0){var s=GO(n,!1,t);if(s!==0)return;r=MO,i=NO}var a=e.a,o=e.b,l=e.es;if(e.datum_type===_0&&(a=MO,o=Due,l=NO),i===l&&r===a&&!Ox(n.datum_type)&&!Ox(e.datum_type))return t;if(t=xV(t,i,r),Ox(n.datum_type)&&(t=Dhe(t,n.datum_type,n.datum_params)),Ox(e.datum_type)&&(t=Fhe(t,e.datum_type,e.datum_params)),t=_V(t,l,a,o),e.datum_type===_0){var c=GO(e,!0,t);if(c!==0)return}return t}function GO(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-t.x,y:t.y},i={x:Number.NaN,y:Number.NaN},s=[];e:for(var a=0;a<n.grids.length;a++){var o=n.grids[a];if(s.push(o.name),o.isNull){i=r;break}if(o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}for(var l=o.grid.subgrids,c=0,h=l.length;c<h;c++){var g=l[c],m=(Math.abs(g.del[1])+Math.abs(g.del[0]))/1e4,y=g.ll[0]-m,v=g.ll[1]-m,_=g.ll[0]+(g.lim[0]-1)*g.del[0]+m,E=g.ll[1]+(g.lim[1]-1)*g.del[1]+m;if(!(v>r.y||y>r.x||E<r.y||_<r.x)&&(i=Vhe(r,e,g),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*Bs+" "+r.y*Bs+" tried: '"+s+"'"),-1):(t.x=-i.x,t.y=i.y,0)}function Vhe(n,e,t){var r={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return r;var i={x:n.x,y:n.y};i.x-=t.ll[0],i.y-=t.ll[1],i.x=mt(i.x-Math.PI)+Math.PI;var s=zO(i,t);if(e){if(isNaN(s.x))return r;s.x=i.x-s.x,s.y=i.y-s.y;var a=9,o=1e-12,l,c;do{if(c=zO(s,t),isNaN(c.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:i.x-(c.x+s.x),y:i.y-(c.y+s.y)},s.x+=l.x,s.y+=l.y}while(a--&&Math.abs(l.x)>o&&Math.abs(l.y)>o);if(a<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=mt(s.x+t.ll[0]),r.y=s.y+t.ll[1]}else isNaN(s.x)||(r.x=n.x+s.x,r.y=n.y+s.y);return r}function zO(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},r={x:Math.floor(t.x),y:Math.floor(t.y)},i={x:t.x-1*r.x,y:t.y-1*r.y},s={x:Number.NaN,y:Number.NaN},a;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return s;a=r.y*e.lim[0]+r.x;var o={x:e.cvs[a][0],y:e.cvs[a][1]};a++;var l={x:e.cvs[a][0],y:e.cvs[a][1]};a+=e.lim[0];var c={x:e.cvs[a][0],y:e.cvs[a][1]};a--;var h={x:e.cvs[a][0],y:e.cvs[a][1]},g=i.x*i.y,m=i.x*(1-i.y),y=(1-i.x)*(1-i.y),v=(1-i.x)*i.y;return s.x=y*o.x+m*l.x+v*h.x+g*c.x,s.y=y*o.y+m*l.y+v*h.y+g*c.y,s}function UO(n,e,t){var r=t.x,i=t.y,s=t.z||0,a,o,l,c={};for(l=0;l<3;l++)if(!(e&&l===2&&t.z===void 0))switch(l===0?(a=r,"ew".indexOf(n.axis[l])!==-1?o="x":o="y"):l===1?(a=i,"ns".indexOf(n.axis[l])!==-1?o="y":o="x"):(a=s,o="z"),n.axis[l]){case"e":c[o]=a;break;case"w":c[o]=-a;break;case"n":c[o]=a;break;case"s":c[o]=-a;break;case"u":t[o]!==void 0&&(c.z=a);break;case"d":t[o]!==void 0&&(c.z=-a);break;default:return null}return c}function vV(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function Bhe(n){$O(n.x),$O(n.y)}function $O(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function Ghe(n,e){return(n.datum.datum_type===vd||n.datum.datum_type===wd||n.datum.datum_type===_0)&&e.datumCode!=="WGS84"||(e.datum.datum_type===vd||e.datum.datum_type===wd||e.datum.datum_type===_0)&&n.datumCode!=="WGS84"}function Vv(n,e,t,r){var i;Array.isArray(t)?t=vV(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if(Bhe(t),n.datum&&e.datum&&Ghe(n,e)&&(i=new ja("WGS84"),t=Vv(n,i,t,r),n=i),r&&n.axis!=="enu"&&(t=UO(n,!1,t)),n.projName==="longlat")t={x:t.x*Or,y:t.y*Or,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=jhe(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Bs,y:t.y*Bs,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),r&&e.axis!=="enu"?UO(e,!0,t):(t&&!s&&delete t.z,t)}var WO=ja("WGS84");function ST(n,e,t,r){var i,s,a;return Array.isArray(t)?(i=Vv(n,e,t,r)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(t.slice(3)):[i.x,i.y,t[2]].concat(t.slice(3)):[i.x,i.y].concat(t.slice(2)):[i.x,i.y]):(s=Vv(n,e,t,r),a=Object.keys(t),a.length===2||a.forEach(function(o){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;s[o]=t[o]}),s)}function Dx(n){return n instanceof ja?n:typeof n=="object"&&"oProj"in n?n.oProj:ja(n)}function zhe(n,e,t){var r,i,s=!1,a;return typeof e>"u"?(i=Dx(n),r=WO,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,i=Dx(n),r=WO,s=!0),r||(r=Dx(n)),i||(i=Dx(e)),t?ST(r,i,t):(a={forward:function(o,l){return ST(r,i,o,l)},inverse:function(o,l){return ST(i,r,o,l)}},s&&(a.oProj=i),a)}var HO=6,wV="AJSAJS",EV="AFAFAF",o0=65,Ms=73,Ia=79,Im=86,Cm=90;const Uhe={forward:SV,inverse:$he,toPoint:TV};function SV(n,e){return e=e||5,Khe(Whe({lat:n[1],lon:n[0]}),e)}function $he(n){var e=LI(RV(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function TV(n){var e=LI(RV(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function TT(n){return n*(Math.PI/180)}function KO(n){return 180*(n/Math.PI)}function Whe(n){var e=n.lat,t=n.lon,r=6378137,i=.00669438,s=.9996,a,o,l,c,h,g,m,y=TT(e),v=TT(t),_,E;E=Math.floor((t+180)/6)+1,t===180&&(E=60),e>=56&&e<64&&t>=3&&t<12&&(E=32),e>=72&&e<84&&(t>=0&&t<9?E=31:t>=9&&t<21?E=33:t>=21&&t<33?E=35:t>=33&&t<42&&(E=37)),a=(E-1)*6-180+3,_=TT(a),o=i/(1-i),l=r/Math.sqrt(1-i*Math.sin(y)*Math.sin(y)),c=Math.tan(y)*Math.tan(y),h=o*Math.cos(y)*Math.cos(y),g=Math.cos(y)*(v-_),m=r*((1-i/4-3*i*i/64-5*i*i*i/256)*y-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*y)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*y)-35*i*i*i/3072*Math.sin(6*y));var T=s*l*(g+(1-c+h)*g*g*g/6+(5-18*c+c*c+72*h-58*o)*g*g*g*g*g/120)+5e5,b=s*(m+l*Math.tan(y)*(g*g/2+(5-c+9*h+4*h*h)*g*g*g*g/24+(61-58*c+c*c+600*h-330*o)*g*g*g*g*g*g/720));return e<0&&(b+=1e7),{northing:Math.round(b),easting:Math.round(T),zoneNumber:E,zoneLetter:Hhe(e)}}function LI(n){var e=n.northing,t=n.easting,r=n.zoneLetter,i=n.zoneNumber;if(i<0||i>60)return null;var s=.9996,a=6378137,o=.00669438,l,c=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),h,g,m,y,v,_,E,T,b,R=t-5e5,N=e;r<"N"&&(N-=1e7),E=(i-1)*6-180+3,l=o/(1-o),_=N/s,T=_/(a*(1-o/4-3*o*o/64-5*o*o*o/256)),b=T+(3*c/2-27*c*c*c/32)*Math.sin(2*T)+(21*c*c/16-55*c*c*c*c/32)*Math.sin(4*T)+151*c*c*c/96*Math.sin(6*T),h=a/Math.sqrt(1-o*Math.sin(b)*Math.sin(b)),g=Math.tan(b)*Math.tan(b),m=l*Math.cos(b)*Math.cos(b),y=a*(1-o)/Math.pow(1-o*Math.sin(b)*Math.sin(b),1.5),v=R/(h*s);var D=b-h*Math.tan(b)/y*(v*v/2-(5+3*g+10*m-4*m*m-9*l)*v*v*v*v/24+(61+90*g+298*m+45*g*g-252*l-3*m*m)*v*v*v*v*v*v/720);D=KO(D);var W=(v-(1+2*g+m)*v*v*v/6+(5-2*m+28*g-3*m*m+8*l+24*g*g)*v*v*v*v*v/120)/Math.cos(b);W=E+KO(W);var I;if(n.accuracy){var A=LI({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});I={top:A.lat,right:A.lon,bottom:D,left:W}}else I={lat:D,lon:W};return I}function Hhe(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function Khe(n,e){var t="00000"+n.easting,r="00000"+n.northing;return n.zoneNumber+n.zoneLetter+Xhe(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+r.substr(r.length-5,e)}function Xhe(n,e,t){var r=bV(t),i=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return qhe(i,s,r)}function bV(n){var e=n%HO;return e===0&&(e=HO),e}function qhe(n,e,t){var r=t-1,i=wV.charCodeAt(r),s=EV.charCodeAt(r),a=i+n-1,o=s+e,l=!1;a>Cm&&(a=a-Cm+o0-1,l=!0),(a===Ms||i<Ms&&a>Ms||(a>Ms||i<Ms)&&l)&&a++,(a===Ia||i<Ia&&a>Ia||(a>Ia||i<Ia)&&l)&&(a++,a===Ms&&a++),a>Cm&&(a=a-Cm+o0-1),o>Im?(o=o-Im+o0-1,l=!0):l=!1,(o===Ms||s<Ms&&o>Ms||(o>Ms||s<Ms)&&l)&&o++,(o===Ia||s<Ia&&o>Ia||(o>Ia||s<Ia)&&l)&&(o++,o===Ms&&o++),o>Im&&(o=o-Im+o0-1);var c=String.fromCharCode(a)+String.fromCharCode(o);return c}function RV(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,r="",i,s=0;!/[A-Z]/.test(i=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;r+=i,s++}var a=parseInt(r,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var o=n.charAt(s++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+n;t=n.substring(s,s+=2);for(var l=bV(a),c=Yhe(t.charAt(0),l),h=Zhe(t.charAt(1),l);h<Jhe(o);)h+=2e6;var g=e-s;if(g%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var m=g/2,y=0,v=0,_,E,T,b,R;return m>0&&(_=1e5/Math.pow(10,m),E=n.substring(s,s+m),y=parseFloat(E)*_,T=n.substring(s+m),v=parseFloat(T)*_),b=y+c,R=v+h,{easting:b,northing:R,zoneLetter:o,zoneNumber:a,accuracy:_}}function Yhe(n,e){for(var t=wV.charCodeAt(e-1),r=1e5,i=!1;t!==n.charCodeAt(0);){if(t++,t===Ms&&t++,t===Ia&&t++,t>Cm){if(i)throw"Bad character: "+n;t=o0,i=!0}r+=1e5}return r}function Zhe(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=EV.charCodeAt(e-1),r=0,i=!1;t!==n.charCodeAt(0);){if(t++,t===Ms&&t++,t===Ia&&t++,t>Im){if(i)throw"Bad character: "+n;t=o0,i=!0}r+=1e5}return r}function Jhe(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function Q0(n,e,t){if(!(this instanceof Q0))return new Q0(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var r=n.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Q0.fromMGRS=function(n){return new Q0(TV(n))};Q0.prototype.toMGRS=function(n){return SV([this.x,this.y],n)};var Qhe=1,ede=.25,XO=.046875,qO=.01953125,YO=.01068115234375,tde=.75,nde=.46875,rde=.013020833333333334,ide=.007120768229166667,sde=.3645833333333333,ade=.005696614583333333,ode=.3076171875;function OI(n){var e=[];e[0]=Qhe-n*(ede+n*(XO+n*(qO+n*YO))),e[1]=n*(tde-n*(XO+n*(qO+n*YO)));var t=n*n;return e[2]=t*(nde-n*(rde+n*ide)),t*=n,e[3]=t*(sde-n*ade),e[4]=t*n*ode,e}function fg(n,e,t,r){return t*=e,e*=e,r[0]*n-t*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var lde=20;function DI(n,e,t){for(var r=1/(1-e),i=n,s=lde;s;--s){var a=Math.sin(i),o=1-e*a*a;if(o=(fg(i,a,Math.cos(i),t)-n)*(o*Math.sqrt(o))*r,i-=o,Math.abs(o)<lt)return i}return i}function cde(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=OI(this.es),this.ml0=fg(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function ude(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i,s,a,o=Math.sin(t),l=Math.cos(t);if(this.es){var h=l*r,g=Math.pow(h,2),m=this.ep2*Math.pow(l,2),y=Math.pow(m,2),v=Math.abs(l)>lt?Math.tan(t):0,_=Math.pow(v,2),E=Math.pow(_,2);i=1-this.es*Math.pow(o,2),h=h/Math.sqrt(i);var T=fg(t,o,l,this.en);s=this.a*(this.k0*h*(1+g/6*(1-_+m+g/20*(5-18*_+E+14*m-58*_*m+g/42*(61+179*E-E*_-479*_)))))+this.x0,a=this.a*(this.k0*(T-this.ml0+o*r*h/2*(1+g/12*(5-_+9*m+4*y+g/30*(61+E-58*_+270*m-330*_*m+g/56*(1385+543*E-E*_-3111*_))))))+this.y0}else{var c=l*Math.sin(r);if(Math.abs(Math.abs(c)-1)<lt)return 93;if(s=.5*this.a*this.k0*Math.log((1+c)/(1-c))+this.x0,a=l*Math.cos(r)/Math.sqrt(1-Math.pow(c,2)),c=Math.abs(a),c>=1){if(c-1>lt)return 93;a=0}else a=Math.acos(a);t<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return n.x=s,n.y=a,n}function hde(n){var e,t,r,i,s=(n.x-this.x0)*(1/this.a),a=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,t=DI(e,this.es,this.en),Math.abs(t)<We){var g=Math.sin(t),m=Math.cos(t),y=Math.abs(m)>lt?Math.tan(t):0,v=this.ep2*Math.pow(m,2),_=Math.pow(v,2),E=Math.pow(y,2),T=Math.pow(E,2);e=1-this.es*Math.pow(g,2);var b=s*Math.sqrt(e)/this.k0,R=Math.pow(b,2);e=e*y,r=t-e*R/(1-this.es)*.5*(1-R/12*(5+3*E-9*v*E+v-4*_-R/30*(61+90*E-252*v*E+45*T+46*v-R/56*(1385+3633*E+4095*T+1574*T*E)))),i=mt(this.long0+b*(1-R/6*(1+2*E+v-R/20*(5+28*E+24*T+8*v*E+6*v-R/42*(61+662*E+1320*T+720*T*E))))/m,this.over)}else r=We*Ky(a),i=0;else{var o=Math.exp(s/this.k0),l=.5*(o-1/o),c=this.lat0+a/this.k0,h=Math.cos(c);e=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(l,2))),r=Math.asin(e),a<0&&(r=-r),l===0&&h===0?i=0:i=mt(Math.atan2(l,h)+this.long0,this.over)}return n.x=i,n.y=r,n}var dde=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const __={init:cde,forward:ude,inverse:hde,names:dde};function AV(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function js(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),r=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(r,2))}function fde(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function gde(n){var e=Math.abs(n);return e=fde(e*(1+e/(js(1,e)+1))),n<0?-e:e}function FI(n,e){for(var t=2*Math.cos(2*e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return e+a*Math.sin(2*e)}function mde(n,e){for(var t=2*Math.cos(e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return Math.sin(e)*a}function pde(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function kV(n,e,t){for(var r=Math.sin(e),i=Math.cos(e),s=AV(t),a=pde(t),o=2*i*a,l=-2*r*s,c=n.length-1,h=n[c],g=0,m=0,y=0,v,_;--c>=0;)v=m,_=g,m=h,g=y,h=-v+o*m-l*g+n[c],y=-_+l*m+o*g;return o=r*a,l=i*s,[o*h-l*y,o*y+l*h]}function yde(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(__.init.apply(this),this.forward=__.forward,this.inverse=__.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var r=FI(this.cbg,this.lat0);this.Zb=-this.Qn*(r+mde(this.gtu,2*r))}function xde(n){var e=mt(n.x-this.long0,this.over),t=n.y;t=FI(this.cbg,t);var r=Math.sin(t),i=Math.cos(t),s=Math.sin(e),a=Math.cos(e);t=Math.atan2(r,a*i),e=Math.atan2(s*i,js(r,i*a)),e=gde(Math.tan(e));var o=kV(this.gtu,2*t,2*e);t=t+o[0],e=e+o[1];var l,c;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,c=this.a*(this.Qn*t+this.Zb)+this.y0):(l=1/0,c=1/0),n.x=l,n.y=c,n}function _de(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var s=kV(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(AV(e));var a=Math.sin(t),o=Math.cos(t),l=Math.sin(e),c=Math.cos(e);t=Math.atan2(a*c,js(l,c*o)),e=Math.atan2(l,c*o),r=mt(e+this.long0,this.over),i=FI(this.cgb,t)}else r=1/0,i=1/0;return n.x=r,n.y=i,n}var vde=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const v_={init:yde,forward:xde,inverse:_de,names:vde};function wde(n,e){if(n===void 0){if(n=Math.floor((mt(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var Ede="etmerc";function Sde(){var n=wde(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*Or,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,v_.init.apply(this),this.forward=v_.forward,this.inverse=v_.inverse}var Tde=["Universal Transverse Mercator System","utm"];const bde={init:Sde,names:Tde,dependsOn:Ede};function jI(n,e){return Math.pow((1-n)/(1+n),e)}var Rde=20;function Ade(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Gn)/(Math.pow(Math.tan(.5*this.lat0+Gn),this.C)*jI(this.e*n,this.ratexp))}function kde(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+Gn),this.C)*jI(this.e*Math.sin(t),this.ratexp))-We,n.x=this.C*e,n}function Ide(n){for(var e=1e-14,t=n.x/this.C,r=n.y,i=Math.pow(Math.tan(.5*r+Gn)/this.K,1/this.C),s=Rde;s>0&&(r=2*Math.atan(i*jI(this.e*Math.sin(n.y),-.5*this.e))-We,!(Math.abs(r-n.y)<e));--s)n.y=r;return s?(n.x=t,n.y=r,n):null}const VI={init:Ade,forward:kde,inverse:Ide};function Cde(){VI.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function Pde(n){var e,t,r,i;return n.x=mt(n.x-this.long0,this.over),VI.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*r),n.x=i*t*Math.sin(n.x),n.y=i*(this.cosc0*e-this.sinc0*t*r),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function Mde(n){var e,t,r,i,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=js(n.x,n.y)){var a=2*Math.atan2(s,this.R2);e=Math.sin(a),t=Math.cos(a),i=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),r=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else i=this.phic0,r=0;return n.x=r,n.y=i,VI.inverse.apply(this,[n]),n.x=mt(n.x+this.long0,this.over),n}var Nde=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const Lde={init:Cde,forward:Pde,inverse:Mde,names:Nde};function BI(n,e,t){return e*=t,Math.tan(.5*(We+n))*Math.pow((1-e)/(1+e),.5*t)}function Ode(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=lt&&(this.k0=.5*(1+Ky(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=lt&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=lt&&Math.abs(Math.cos(this.lat_ts))>lt&&(this.k0=.5*this.cons*fl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/vo(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=fl(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(BI(this.lat0,this.sinlat0,this.e))-We,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Dde(n){var e=n.x,t=n.y,r=Math.sin(t),i=Math.cos(t),s,a,o,l,c,h,g=mt(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=lt&&Math.abs(t+this.lat0)<=lt?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(g)),n.x=this.a*s*i*Math.sin(g)+this.x0,n.y=this.a*s*(this.coslat0*r-this.sinlat0*i*Math.cos(g))+this.y0,n):(a=2*Math.atan(BI(t,r,this.e))-We,l=Math.cos(a),o=Math.sin(a),Math.abs(this.coslat0)<=lt?(c=vo(this.e,t*this.con,this.con*r),h=2*this.a*this.k0*c/this.cons,n.x=this.x0+h*Math.sin(e-this.long0),n.y=this.y0-this.con*h*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<lt?(s=2*this.a*this.k0/(1+l*Math.cos(g)),n.y=s*o):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*l*Math.cos(g))),n.y=s*(this.cosX0*o-this.sinX0*l*Math.cos(g))+this.y0),n.x=s*l*Math.sin(g)+this.x0,n))}function Fde(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var o=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,t=this.lat0,a<=lt?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(o)*this.sinlat0+n.y*Math.sin(o)*this.coslat0/a),Math.abs(this.coslat0)<lt?this.lat0>0?e=mt(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=mt(this.long0+Math.atan2(n.x,n.y),this.over):e=mt(this.long0+Math.atan2(n.x*Math.sin(o),a*this.coslat0*Math.cos(o)-n.y*this.sinlat0*Math.sin(o)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=lt){if(a<=lt)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,r=a*this.cons/(2*this.a*this.k0),t=this.con*Zp(this.e,r),e=this.con*mt(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else i=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=lt?s=this.X0:(s=Math.asin(Math.cos(i)*this.sinX0+n.y*Math.sin(i)*this.cosX0/a),e=mt(this.long0+Math.atan2(n.x*Math.sin(i),a*this.cosX0*Math.cos(i)-n.y*this.sinX0*Math.sin(i)),this.over)),t=-1*Zp(this.e,Math.tan(.5*(We+s)));return n.x=e,n.y=t,n}var jde=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const Vde={init:Ode,forward:Dde,inverse:Fde,names:jde,ssfn_:BI};function Bde(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,r=this.rf,i=1/r,s=2*i-Math.pow(i,2),a=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+n/2)),c=Math.log((1+a*e)/(1-a*e));this.K=o-this.alpha*l+this.alpha*a/2*c}function Gde(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),r=-this.alpha*(e+t)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),a=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),o=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,n.x=this.R*a+this.x0,n}function zde(n){for(var e=n.x-this.x0,t=n.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),a=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),o=this.lambda0+a/this.alpha,l=0,c=s,h=-1e3,g=0;Math.abs(c-h)>1e-7;){if(++g>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),h=c,c=2*Math.atan(Math.exp(l))-Math.PI/2}return n.x=o,n.y=c,n}var Ude=["somerc"];const $de={init:Bde,forward:Gde,inverse:zde,names:Ude};var qf=1e-7;function Wde(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf(pV(t))!==-1}function Hde(){var n,e,t,r,i,s,a,o,l,c,h=0,g,m=0,y=0,v=0,_=0,E=0,T=0;this.no_off=Wde(this),this.no_rot="no_rot"in this;var b=!1;"alpha"in this&&(b=!0);var R=!1;if("rectified_grid_angle"in this&&(R=!0),b&&(T=this.alpha),R&&(h=this.rectified_grid_angle),b||R)m=this.longc;else if(y=this.long1,_=this.lat1,v=this.long2,E=this.lat2,Math.abs(_-E)<=qf||(n=Math.abs(_))<=qf||Math.abs(n-We)<=qf||Math.abs(Math.abs(this.lat0)-We)<=qf||Math.abs(Math.abs(E)-We)<=qf)throw new Error;var N=1-this.es;e=Math.sqrt(N),Math.abs(this.lat0)>lt?(o=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*o*o,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/N),this.A=this.B*this.k0*e/n,r=this.B*e/(t*Math.sqrt(n)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(vo(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),b||R?(b?(g=Math.asin(Math.sin(T)/r),R||(h=T)):(g=h,T=Math.asin(r*Math.sin(g))),this.lam0=m-Math.asin(.5*(i-1/i)*Math.tan(g))/this.B):(s=Math.pow(vo(this.e,_,Math.sin(_)),this.B),a=Math.pow(vo(this.e,E,Math.sin(E)),this.B),i=this.E/s,l=(a-s)/(a+s),c=this.E*this.E,c=(c-a*s)/(c+a*s),n=y-v,n<-Math.PI?v-=qp:n>Math.PI&&(v+=qp),this.lam0=mt(.5*(y+v)-Math.atan(c*Math.tan(.5*this.B*(y-v))/l)/this.B,this.over),g=Math.atan(2*Math.sin(this.B*mt(y-this.lam0,this.over))/(i-1/i)),h=T=Math.asin(r*Math.sin(g))),this.singam=Math.sin(g),this.cosgam=Math.cos(g),this.sinrot=Math.sin(h),this.cosrot=Math.cos(h),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(T))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*g,this.v_pole_n=this.ArB*Math.log(Math.tan(Gn-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(Gn+i))}function Kde(n){var e={},t,r,i,s,a,o,l,c;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-We)>lt){if(a=this.E/Math.pow(vo(this.e,n.y,Math.sin(n.y)),this.B),o=1/a,t=.5*(a-o),r=.5*(a+o),s=Math.sin(this.B*n.x),i=(t*this.singam-s*this.cosgam)/r,Math.abs(Math.abs(i)-1)<lt)throw new Error;c=.5*this.ArB*Math.log((1-i)/(1+i)),o=Math.cos(this.B*n.x),Math.abs(o)<qf?l=this.A*n.x:l=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,o)}else c=n.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*n.y;return this.no_rot?(e.x=l,e.y=c):(l-=this.u_0,e.x=c*this.cosrot+l*this.sinrot,e.y=l*this.cosrot-c*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Xde(n){var e,t,r,i,s,a,o,l={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*t),i=.5*(r-1/r),s=.5*(r+1/r),a=Math.sin(this.BrA*e),o=(a*this.cosgam+i*this.singam)/s,Math.abs(Math.abs(o)-1)<lt)l.x=0,l.y=o<0?-We:We;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=Zp(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(i*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l}var qde=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Yde={init:Hde,forward:Kde,inverse:Xde,names:qde};function Zde(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<lt)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),r=fl(this.e,e,t),i=vo(this.e,this.lat1,e),s=Math.sin(this.lat2),a=Math.cos(this.lat2),o=fl(this.e,s,a),l=vo(this.e,this.lat2,s),c=Math.abs(Math.abs(this.lat0)-We)<lt?0:vo(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>lt?this.ns=Math.log(r/o)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Jde(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=lt&&(t=Ky(t)*(We-2*lt));var r=Math.abs(Math.abs(t)-We),i,s;if(r>lt)i=vo(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(i,this.ns);else{if(r=t*this.ns,r<=0)return null;s=0}var a=this.ns*mt(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(a))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(a))+this.y0,n}function Qde(n){var e,t,r,i,s,a=(n.x-this.x0)/this.k0,o=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+o*o),t=1):(e=-Math.sqrt(a*a+o*o),t=-1);var l=0;if(e!==0&&(l=Math.atan2(t*a,t*o)),e!==0||this.ns>0){if(t=1/this.ns,r=Math.pow(e/(this.a*this.f0),t),i=Zp(this.e,r),i===-9999)return null}else i=-We;return s=mt(l/this.ns+this.long0,this.over),n.x=s,n.y=i,n}var efe=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const tfe={init:Zde,forward:Jde,inverse:Qde,names:efe};function nfe(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function rfe(n){var e,t,r,i,s,a,o,l=n.x,c=n.y,h=mt(l-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),r=-h*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(r)),s=Math.asin(Math.cos(t)*Math.sin(r)/Math.cos(i)),a=this.n*s,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),n.y=o*Math.cos(a)/1,n.x=o*Math.sin(a)/1,this.czech||(n.y*=-1,n.x*=-1),n}function ife(n){var e,t,r,i,s,a,o,l,c=n.x;n.x=n.y,n.y=c,this.czech||(n.y*=-1,n.x*=-1),a=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),i=s/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),t=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),n.x=this.long0-t/this.alfa,o=e,l=0;var h=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-n.y)<1e-10&&(l=1),o=n.y,h+=1;while(l===0&&h<15);return h>=15?null:n}var sfe=["Krovak","krovak"];const afe={init:nfe,forward:rfe,inverse:ife,names:sfe};function Es(n,e,t,r,i){return n*i-e*Math.sin(2*i)+t*Math.sin(4*i)-r*Math.sin(6*i)}function Xy(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function qy(n){return .375*n*(1+.25*n*(1+.46875*n))}function Yy(n){return .05859375*n*n*(1+.75*n)}function Zy(n){return n*n*n*(35/3072)}function GI(n,e,t){var r=e*t;return n/Math.sqrt(1-r*r)}function qu(n){return Math.abs(n)<We?n:n-Ky(n)*Math.PI}function Bv(n,e,t,r,i){var s,a;s=n/e;for(var o=0;o<15;o++)if(a=(n-(e*s-t*Math.sin(2*s)+r*Math.sin(4*s)-i*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*r*Math.cos(4*s)-6*i*Math.cos(6*s)),s+=a,Math.abs(a)<=1e-10)return s;return NaN}function ofe(){this.sphere||(this.e0=Xy(this.es),this.e1=qy(this.es),this.e2=Yy(this.es),this.e3=Zy(this.es),this.ml0=this.a*Es(this.e0,this.e1,this.e2,this.e3,this.lat0))}function lfe(n){var e,t,r=n.x,i=n.y;if(r=mt(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),t=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var s=Math.sin(i),a=Math.cos(i),o=GI(this.a,this.e,s),l=Math.tan(i)*Math.tan(i),c=r*Math.cos(i),h=c*c,g=this.es*a*a/(1-this.es),m=this.a*Es(this.e0,this.e1,this.e2,this.e3,i);e=o*c*(1-h*l*(1/6-(8-l+8*g)*h/120)),t=m-this.ml0+o*s/a*h*(.5+(5-l+6*g)*h/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function cfe(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i;if(this.sphere){var s=t+this.lat0;r=Math.asin(Math.sin(s)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(s))}else{var a=this.ml0/this.a+t,o=Bv(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-We)<=lt)return n.x=this.long0,n.y=We,t<0&&(n.y*=-1),n;var l=GI(this.a,this.e,Math.sin(o)),c=l*l*l/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(o),2),g=e*this.a/l,m=g*g;r=o-l*Math.tan(o)/c*g*g*(.5-(1+3*h)*g*g/24),i=g*(1-m*(h/3+(1+3*h)*h*m/15))/Math.cos(o)}return n.x=mt(i+this.long0,this.over),n.y=qu(r),n}var ufe=["Cassini","Cassini_Soldner","cass"];const hfe={init:ofe,forward:lfe,inverse:cfe,names:ufe};function ku(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var TR=1,bR=2,RR=3,w_=4;function dfe(){var n=Math.abs(this.lat0);if(Math.abs(n-We)<lt?this.mode=this.lat0<0?TR:bR:Math.abs(n)<lt?this.mode=RR:this.mode=w_,this.es>0){var e;switch(this.qp=ku(this.e,1),this.mmf=.5/(1-this.es),this.apa=wfe(this.es),this.mode){case bR:this.dd=1;break;case TR:this.dd=1;break;case RR:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case w_:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=ku(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===w_&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function ffe(n){var e,t,r,i,s,a,o,l,c,h,g=n.x,m=n.y;if(g=mt(g-this.long0,this.over),this.sphere){if(s=Math.sin(m),h=Math.cos(m),r=Math.cos(g),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+h*r:1+this.sinph0*s+this.cosph0*h*r,t<=lt)return null;t=Math.sqrt(2/t),e=t*h*Math.sin(g),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*h*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(m+this.lat0)<lt)return null;t=Gn-m*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(g),t*=r}}else{switch(o=0,l=0,c=0,r=Math.cos(g),i=Math.sin(g),s=Math.sin(m),a=ku(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=a/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:c=1+this.sinb1*o+this.cosb1*l*r;break;case this.EQUIT:c=1+l*r;break;case this.N_POLE:c=We+m,a=this.qp-a;break;case this.S_POLE:c=m-We,a=this.qp+a;break}if(Math.abs(c)<lt)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),this.mode===this.OBLIQ?t=this.ymf*c*(this.cosb1*o-this.sinb1*l*r):t=(c=Math.sqrt(2/(1+l*r)))*o*this.ymf,e=this.xmf*c*l*i;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(c=Math.sqrt(a))*i,t=r*(this.mode===this.S_POLE?c:-c)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function gfe(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i,s,a,o,l,c;if(this.sphere){var h=0,g,m=0;if(g=Math.sqrt(e*e+t*t),i=g*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=Math.sin(i),h=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(g)<=lt?0:Math.asin(t*m/g),e*=m,t=h*g;break;case this.OBLIQ:i=Math.abs(g)<=lt?this.lat0:Math.asin(h*this.sinph0+t*m*this.cosph0/g),e*=m*this.cosph0,t=(h-Math.sin(i)*this.sinph0)*g;break;case this.N_POLE:t=-t,i=We-i;break;case this.S_POLE:i-=We;break}r=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,l=Math.sqrt(e*e+t*t),l<lt)return n.x=this.long0,n.y=this.lat0,n;a=2*Math.asin(.5*l/this.rq),s=Math.cos(a),e*=a=Math.sin(a),this.mode===this.OBLIQ?(c=s*this.sinb1+t*a*this.cosb1/l,o=this.qp*c,t=l*this.cosb1*s-t*this.sinb1*a):(c=t*a/l,o=this.qp*c,t=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),o=e*e+t*t,!o)return n.x=this.long0,n.y=this.lat0,n;c=1-o/this.qp,this.mode===this.S_POLE&&(c=-c)}r=Math.atan2(e,t),i=Efe(Math.asin(c),this.apa)}return n.x=mt(this.long0+r,this.over),n.y=i,n}var mfe=.3333333333333333,pfe=.17222222222222222,yfe=.10257936507936508,xfe=.06388888888888888,_fe=.0664021164021164,vfe=.016415012942191543;function wfe(n){var e,t=[];return t[0]=n*mfe,e=n*n,t[0]+=e*pfe,t[1]=e*xfe,e*=n,t[0]+=e*yfe,t[1]+=e*_fe,t[2]=e*vfe,t}function Efe(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var Sfe=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Tfe={init:dfe,forward:ffe,inverse:gfe,names:Sfe,S_POLE:TR,N_POLE:bR,EQUIT:RR,OBLIQ:w_};function Vu(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function bfe(){Math.abs(this.lat1+this.lat2)<lt||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=fl(this.e3,this.sin_po,this.cos_po),this.qs1=ku(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=fl(this.e3,this.sin_po,this.cos_po),this.qs2=ku(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=ku(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>lt?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function Rfe(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var r=ku(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,s=this.ns0*mt(e-this.long0,this.over),a=i*Math.sin(s)+this.x0,o=this.rh-i*Math.cos(s)+this.y0;return n.x=a,n.y=o,n}function Afe(n){var e,t,r,i,s,a;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),r=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*n.x,r*n.y)),r=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-r*r)/(2*this.ns0)):(t=(this.c-r*r)/this.ns0,a=this.phi1z(this.e3,t)),s=mt(i/this.ns0+this.long0,this.over),n.x=s,n.y=a,n}function kfe(n,e){var t,r,i,s,a,o=Vu(.5*e);if(n<lt)return o;for(var l=n*n,c=1;c<=25;c++)if(t=Math.sin(o),r=Math.cos(o),i=n*t,s=1-i*i,a=.5*s*s/r*(e/(1-l)-t/s+.5/n*Math.log((1-i)/(1+i))),o=o+a,Math.abs(a)<=1e-7)return o;return null}var Ife=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const Cfe={init:bfe,forward:Rfe,inverse:Afe,names:Ife,phi1z:kfe};function Pfe(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Mfe(n){var e,t,r,i,s,a,o,l,c=n.x,h=n.y;return r=mt(c-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,a>0||Math.abs(a)<=lt?(o=this.x0+this.a*s*t*Math.sin(r)/a,l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)/a):(o=this.x0+this.infinity_dist*t*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function Nfe(n){var e,t,r,i,s,a;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(i=Math.atan2(e,this.rc),t=Math.sin(i),r=Math.cos(i),a=Vu(r*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*r-n.y*this.sin_p14*t),s=mt(this.long0+s,this.over)):(a=this.phic0,s=0),n.x=s,n.y=a,n}var Lfe=["gnom"];const Ofe={init:Pfe,forward:Mfe,inverse:Nfe,names:Lfe};function Dfe(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*We:We;for(var r=Math.asin(.5*e),i,s,a,o,l=0;l<30;l++)if(s=Math.sin(r),a=Math.cos(r),o=n*s,i=Math.pow(1-o*o,2)/(2*a)*(e/(1-n*n)-s/(1-o*o)+.5/n*Math.log((1-o)/(1+o))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function Ffe(){this.sphere||(this.k0=fl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function jfe(n){var e=n.x,t=n.y,r,i,s=mt(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var a=ku(this.e,Math.sin(t));r=this.x0+this.a*this.k0*s,i=this.y0+this.a*a*.5/this.k0}return n.x=r,n.y=i,n}function Vfe(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=mt(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=Dfe(this.e,2*n.y*this.k0/this.a),e=mt(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var Bfe=["cea"];const Gfe={init:Ffe,forward:jfe,inverse:Vfe,names:Bfe};function zfe(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Ufe(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=qu(t-this.lat0);return n.x=this.x0+this.a*r*this.rc,n.y=this.y0+this.a*i,n}function $fe(n){var e=n.x,t=n.y;return n.x=mt(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=qu(this.lat0+(t-this.y0)/this.a),n}var Wfe=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const Hfe={init:zfe,forward:Ufe,inverse:$fe,names:Wfe};var ZO=20;function Kfe(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Xy(this.es),this.e1=qy(this.es),this.e2=Yy(this.es),this.e3=Zy(this.es),this.ml0=this.a*Es(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Xfe(n){var e=n.x,t=n.y,r,i,s,a=mt(e-this.long0,this.over);if(s=a*Math.sin(t),this.sphere)Math.abs(t)<=lt?(r=this.a*a,i=-1*this.a*this.lat0):(r=this.a*Math.sin(s)/Math.tan(t),i=this.a*(qu(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=lt)r=this.a*a,i=-1*this.ml0;else{var o=GI(this.a,this.e,Math.sin(t))/Math.tan(t);r=o*Math.sin(s),i=this.a*Es(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+o*(1-Math.cos(s))}return n.x=r+this.x0,n.y=i+this.y0,n}function qfe(n){var e,t,r,i,s,a,o,l,c;if(r=n.x-this.x0,i=n.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=lt)e=mt(r/this.a+this.long0,this.over),t=0;else{a=this.lat0+i/this.a,o=r*r/this.a/this.a+a*a,l=a;var h;for(s=ZO;s;--s)if(h=Math.tan(l),c=-1*(a*(l*h+1)-l-.5*(l*l+o)*h)/((l-a)/h-1),l+=c,Math.abs(c)<=lt){t=l;break}e=mt(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(t),this.over)}else if(Math.abs(i+this.ml0)<=lt)t=0,e=mt(this.long0+r/this.a,this.over);else{a=(this.ml0+i)/this.a,o=r*r/this.a/this.a+a*a,l=a;var g,m,y,v,_;for(s=ZO;s;--s)if(_=this.e*Math.sin(l),g=Math.sqrt(1-_*_)*Math.tan(l),m=this.a*Es(this.e0,this.e1,this.e2,this.e3,l),y=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),v=m/this.a,c=(a*(g*v+1)-v-.5*g*(v*v+o))/(this.es*Math.sin(2*l)*(v*v+o-2*a*v)/(4*g)+(a-v)*(g*y-2/Math.sin(2*l))-y),l-=c,Math.abs(c)<=lt){t=l;break}g=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=mt(this.long0+Math.asin(r*g/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var Yfe=["Polyconic","American_Polyconic","poly"];const Zfe={init:Kfe,forward:Xfe,inverse:qfe,names:Yfe};function Jfe(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Qfe(n){var e,t=n.x,r=n.y,i=r-this.lat0,s=t-this.long0,a=i/Ym*1e-5,o=s,l=1,c=0;for(e=1;e<=10;e++)l=l*a,c=c+this.A[e]*l;var h=c,g=o,m=1,y=0,v,_,E=0,T=0;for(e=1;e<=6;e++)v=m*h-y*g,_=y*h+m*g,m=v,y=_,E=E+this.B_re[e]*m-this.B_im[e]*y,T=T+this.B_im[e]*m+this.B_re[e]*y;return n.x=T*this.a+this.x0,n.y=E*this.a+this.y0,n}function e0e(n){var e,t=n.x,r=n.y,i=t-this.x0,s=r-this.y0,a=s/this.a,o=i/this.a,l=1,c=0,h,g,m=0,y=0;for(e=1;e<=6;e++)h=l*a-c*o,g=c*a+l*o,l=h,c=g,m=m+this.C_re[e]*l-this.C_im[e]*c,y=y+this.C_im[e]*l+this.C_re[e]*c;for(var v=0;v<this.iterations;v++){var _=m,E=y,T,b,R=a,N=o;for(e=2;e<=6;e++)T=_*m-E*y,b=E*m+_*y,_=T,E=b,R=R+(e-1)*(this.B_re[e]*_-this.B_im[e]*E),N=N+(e-1)*(this.B_im[e]*_+this.B_re[e]*E);_=1,E=0;var D=this.B_re[1],W=this.B_im[1];for(e=2;e<=6;e++)T=_*m-E*y,b=E*m+_*y,_=T,E=b,D=D+e*(this.B_re[e]*_-this.B_im[e]*E),W=W+e*(this.B_im[e]*_+this.B_re[e]*E);var I=D*D+W*W;m=(R*D+N*W)/I,y=(N*D-R*W)/I}var A=m,M=y,O=1,L=0;for(e=1;e<=9;e++)O=O*A,L=L+this.D[e]*O;var z=this.lat0+L*Ym*1e5,j=this.long0+M;return n.x=j,n.y=z,n}var t0e=["New_Zealand_Map_Grid","nzmg"];const n0e={init:Jfe,forward:Qfe,inverse:e0e,names:t0e};function r0e(){}function i0e(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=this.x0+this.a*r,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=i,n.y=s,n}function s0e(n){n.x-=this.x0,n.y-=this.y0;var e=mt(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var a0e=["Miller_Cylindrical","mill"];const o0e={init:r0e,forward:i0e,inverse:s0e,names:a0e};var l0e=20;function c0e(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=OI(this.es)}function u0e(n){var e,t,r=n.x,i=n.y;if(r=mt(r-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var s=this.n*Math.sin(i),a=l0e;a;--a){var o=(this.m*i+Math.sin(i)-s)/(this.m+Math.cos(i));if(i-=o,Math.abs(o)<lt)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),t=this.a*this.C_y*i}else{var l=Math.sin(i),c=Math.cos(i);t=this.a*fg(i,l,c,this.en),e=this.a*r*c/Math.sqrt(1-this.es*l*l)}return n.x=e,n.y=t,n}function h0e(n){var e,t,r,i;return n.x-=this.x0,r=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=Vu((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=Vu(Math.sin(e)/this.n)),r=mt(r+this.long0,this.over),e=qu(e)):(e=DI(n.y/this.a,this.es,this.en),i=Math.abs(e),i<We?(i=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=mt(t,this.over)):i-lt<We&&(r=this.long0)),n.x=r,n.y=e,n}var d0e=["Sinusoidal","sinu"];const f0e={init:c0e,forward:u0e,inverse:h0e,names:d0e};function g0e(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function m0e(n){for(var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=t,s=Math.PI*Math.sin(t);;){var a=-(i+Math.sin(i)-s)/(1+Math.cos(i));if(i+=a,Math.abs(a)<lt)break}i/=2,Math.PI/2-Math.abs(t)<lt&&(r=0);var o=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return n.x=o,n.y=l,n}function p0e(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var r=mt(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var i=Math.asin(t);return n.x=r,n.y=i,n}var y0e=["Mollweide","moll"];const x0e={init:g0e,forward:m0e,inverse:p0e,names:y0e};function _0e(){Math.abs(this.lat1+this.lat2)<lt||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Xy(this.es),this.e1=qy(this.es),this.e2=Yy(this.es),this.e3=Zy(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=fl(this.e,this.sin_phi,this.cos_phi),this.ml1=Es(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<lt?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=fl(this.e,this.sin_phi,this.cos_phi),this.ml2=Es(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Es(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function v0e(n){var e=n.x,t=n.y,r;if(this.sphere)r=this.a*(this.g-t);else{var i=Es(this.e0,this.e1,this.e2,this.e3,t);r=this.a*(this.g-i)}var s=this.ns*mt(e-this.long0,this.over),a=this.x0+r*Math.sin(s),o=this.y0+this.rh-r*Math.cos(s);return n.x=a,n.y=o,n}function w0e(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,r,i;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return i=mt(this.long0+s/this.ns,this.over),r=qu(this.g-t/this.a),n.x=i,n.y=r,n;var a=this.g-t/this.a;return r=Bv(a,this.e0,this.e1,this.e2,this.e3),i=mt(this.long0+s/this.ns,this.over),n.x=i,n.y=r,n}var E0e=["Equidistant_Conic","eqdc"];const S0e={init:_0e,forward:v0e,inverse:w0e,names:E0e};function T0e(){this.R=this.a}function b0e(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i,s;Math.abs(t)<=lt&&(i=this.x0+this.R*r,s=this.y0);var a=Vu(2*Math.abs(t/Math.PI));(Math.abs(r)<=lt||Math.abs(Math.abs(t)-We)<=lt)&&(i=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*a):s=this.y0+Math.PI*this.R*-Math.tan(.5*a));var o=.5*Math.abs(Math.PI/r-r/Math.PI),l=o*o,c=Math.sin(a),h=Math.cos(a),g=h/(c+h-1),m=g*g,y=g*(2/c-1),v=y*y,_=Math.PI*this.R*(o*(g-v)+Math.sqrt(l*(g-v)*(g-v)-(v+l)*(m-v)))/(v+l);r<0&&(_=-_),i=this.x0+_;var E=l+g;return _=Math.PI*this.R*(y*E-o*Math.sqrt((v+l)*(l+1)-E*E))/(v+l),t>=0?s=this.y0+_:s=this.y0-_,n.x=i,n.y=s,n}function R0e(n){var e,t,r,i,s,a,o,l,c,h,g,m,y;return n.x-=this.x0,n.y-=this.y0,g=Math.PI*this.R,r=n.x/g,i=n.y/g,s=r*r+i*i,a=-Math.abs(i)*(1+s),o=a-2*i*i+r*r,l=-2*a+1+2*i*i+s*s,y=i*i/l+(2*o*o*o/l/l/l-9*a*o/l/l)/27,c=(a-o*o/3/l)/l,h=2*Math.sqrt(-c/3),g=3*y/c/h,Math.abs(g)>1&&(g>=0?g=1:g=-1),m=Math.acos(g)/3,n.y>=0?t=(-h*Math.cos(m+Math.PI/3)-o/3/l)*Math.PI:t=-(-h*Math.cos(m+Math.PI/3)-o/3/l)*Math.PI,Math.abs(r)<lt?e=this.long0:e=mt(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(r*r-i*i)+s*s))/2/r,this.over),n.x=e,n.y=t,n}var A0e=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const k0e={init:T0e,forward:b0e,inverse:R0e,names:A0e};function I0e(n,e,t,r,i,s){const a=r-e,o=Math.atan((1-s)*Math.tan(n)),l=Math.atan((1-s)*Math.tan(t)),c=Math.sin(o),h=Math.cos(o),g=Math.sin(l),m=Math.cos(l);let y=a,v,_=100,E,T,b,R,N,D,W,I,A,M,O,L,z,j;do{if(E=Math.sin(y),T=Math.cos(y),b=Math.sqrt(m*E*(m*E)+(h*g-c*m*T)*(h*g-c*m*T)),b===0)return{azi1:0,s12:0};R=c*g+h*m*T,N=Math.atan2(b,R),D=h*m*E/b,W=1-D*D,I=W!==0?R-2*c*g/W:0,A=s/16*W*(4+s*(4-3*W)),v=y,y=a+(1-A)*s*D*(N+A*b*(I+A*R*(-1+2*I*I)))}while(Math.abs(y-v)>1e-12&&--_>0);return _===0?{azi1:NaN,s12:NaN}:(M=W*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),O=1+M/16384*(4096+M*(-768+M*(320-175*M))),L=M/1024*(256+M*(-128+M*(74-47*M))),z=L*b*(I+L/4*(R*(-1+2*I*I)-L/6*I*(-3+4*b*b)*(-3+4*I*I))),j=i*(1-s)*O*(N-z),{azi1:Math.atan2(m*E,h*g-c*m*T),s12:j})}function C0e(n,e,t,r,i,s){const a=Math.atan((1-s)*Math.tan(n)),o=Math.sin(a),l=Math.cos(a),c=Math.sin(t),h=Math.cos(t),g=Math.atan2(o,l*h),m=l*c,y=1-m*m,v=y*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),_=1+v/16384*(4096+v*(-768+v*(320-175*v))),E=v/1024*(256+v*(-128+v*(74-47*v)));let T=r/(i*(1-s)*_),b,R=100,N,D,W,I;do N=Math.cos(2*g+T),D=Math.sin(T),W=Math.cos(T),I=E*D*(N+E/4*(W*(-1+2*N*N)-E/6*N*(-3+4*D*D)*(-3+4*N*N))),b=T,T=r/(i*(1-s)*_)+I;while(Math.abs(T-b)>1e-12&&--R>0);if(R===0)return{lat2:NaN,lon2:NaN};const A=o*D-l*W*h,M=Math.atan2(o*W+l*D*h,(1-s)*Math.sqrt(m*m+A*A)),O=Math.atan2(D*c,l*W-o*D*h),L=s/16*y*(4+s*(4-3*y)),z=O-(1-L)*s*m*(T+L*D*(N+L*W*(-1+2*N*N))),j=e+z;return{lat2:M,lon2:j}}function P0e(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function M0e(n){var e=n.x,t=n.y,r=Math.sin(n.y),i=Math.cos(n.y),s=mt(e-this.long0,this.over),a,o,l,c,h,g,m,y,v,_,E;return this.sphere?Math.abs(this.sin_p12-1)<=lt?(n.x=this.x0+this.a*(We-t)*Math.sin(s),n.y=this.y0-this.a*(We-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=lt?(n.x=this.x0+this.a*(We+t)*Math.sin(s),n.y=this.y0+this.a*(We+t)*Math.cos(s),n):(v=this.sin_p12*r+this.cos_p12*i*Math.cos(s),m=Math.acos(v),y=m?m/Math.sin(m):1,n.x=this.x0+this.a*y*i*Math.sin(s),n.y=this.y0+this.a*y*(this.cos_p12*r-this.sin_p12*i*Math.cos(s)),n):(a=Xy(this.es),o=qy(this.es),l=Yy(this.es),c=Zy(this.es),Math.abs(this.sin_p12-1)<=lt?(h=this.a*Es(a,o,l,c,We),g=this.a*Es(a,o,l,c,t),n.x=this.x0+(h-g)*Math.sin(s),n.y=this.y0-(h-g)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=lt?(h=this.a*Es(a,o,l,c,We),g=this.a*Es(a,o,l,c,t),n.x=this.x0+(h+g)*Math.sin(s),n.y=this.y0+(h+g)*Math.cos(s),n):Math.abs(e)<lt&&Math.abs(t-this.lat0)<lt?(n.x=n.y=0,n):(_=I0e(this.lat0,this.long0,t,e,this.a,this.f),E=_.azi1,n.x=_.s12*Math.sin(E),n.y=_.s12*Math.cos(E),n))}function N0e(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a,o,l,c,h,g,m,y,v,_,E;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*We*this.a?void 0:(t=e/this.a,r=Math.sin(t),i=Math.cos(t),s=this.long0,Math.abs(e)<=lt?a=this.lat0:(a=Vu(i*this.sin_p12+n.y*r*this.cos_p12/e),o=Math.abs(this.lat0)-We,Math.abs(o)<=lt?this.lat0>=0?s=mt(this.long0+Math.atan2(n.x,-n.y),this.over):s=mt(this.long0-Math.atan2(-n.x,n.y),this.over):s=mt(this.long0+Math.atan2(n.x*r,e*this.cos_p12*i-n.y*this.sin_p12*r),this.over)),n.x=s,n.y=a,n)):(l=Xy(this.es),c=qy(this.es),h=Yy(this.es),g=Zy(this.es),Math.abs(this.sin_p12-1)<=lt?(m=this.a*Es(l,c,h,g,We),e=Math.sqrt(n.x*n.x+n.y*n.y),y=m-e,a=Bv(y/this.a,l,c,h,g),s=mt(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=a,n):Math.abs(this.sin_p12+1)<=lt?(m=this.a*Es(l,c,h,g,We),e=Math.sqrt(n.x*n.x+n.y*n.y),y=e-m,a=Bv(y/this.a,l,c,h,g),s=mt(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=a,n):(v=Math.atan2(n.x,n.y),_=Math.sqrt(n.x*n.x+n.y*n.y),E=C0e(this.lat0,this.long0,v,_,this.a,this.f),n.x=E.lon2,n.y=E.lat2,n))}var L0e=["Azimuthal_Equidistant","aeqd"];const O0e={init:P0e,forward:M0e,inverse:N0e,names:L0e};function D0e(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function F0e(n){var e,t,r,i,s,a,o,l,c=n.x,h=n.y;return r=mt(c-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,(a>0||Math.abs(a)<=lt)&&(o=this.a*s*t*Math.sin(r),l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function j0e(n){var e,t,r,i,s,a,o;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=Vu(e/this.a),r=Math.sin(t),i=Math.cos(t),a=this.long0,Math.abs(e)<=lt?(o=this.lat0,n.x=a,n.y=o,n):(o=Vu(i*this.sin_p14+n.y*r*this.cos_p14/e),s=Math.abs(this.lat0)-We,Math.abs(s)<=lt?(this.lat0>=0?a=mt(this.long0+Math.atan2(n.x,-n.y),this.over):a=mt(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=a,n.y=o,n):(a=mt(this.long0+Math.atan2(n.x*r,e*this.cos_p14*i-n.y*this.sin_p14*r),this.over),n.x=a,n.y=o,n))}var V0e=["ortho"];const B0e={init:D0e,forward:F0e,inverse:j0e,names:V0e};var Ir={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},zn={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function G0e(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=We-Gn/2?this.face=Ir.TOP:this.lat0<=-(We-Gn/2)?this.face=Ir.BOTTOM:Math.abs(this.long0)<=Gn?this.face=Ir.FRONT:Math.abs(this.long0)<=We+Gn?this.face=this.long0>0?Ir.RIGHT:Ir.LEFT:this.face=Ir.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function z0e(n){var e={x:0,y:0},t,r,i,s,a,o,l={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,r=n.x,this.face===Ir.TOP)s=We-t,r>=Gn&&r<=We+Gn?(l.value=zn.AREA_0,i=r-We):r>We+Gn||r<=-(We+Gn)?(l.value=zn.AREA_1,i=r>0?r-Wr:r+Wr):r>-(We+Gn)&&r<=-Gn?(l.value=zn.AREA_2,i=r+We):(l.value=zn.AREA_3,i=r);else if(this.face===Ir.BOTTOM)s=We+t,r>=Gn&&r<=We+Gn?(l.value=zn.AREA_0,i=-r+We):r<Gn&&r>=-Gn?(l.value=zn.AREA_1,i=-r):r<-Gn&&r>=-(We+Gn)?(l.value=zn.AREA_2,i=-r-We):(l.value=zn.AREA_3,i=r>0?-r+Wr:-r-Wr);else{var c,h,g,m,y,v,_;this.face===Ir.RIGHT?r=v0(r,+We):this.face===Ir.BACK?r=v0(r,+Wr):this.face===Ir.LEFT&&(r=v0(r,-We)),m=Math.sin(t),y=Math.cos(t),v=Math.sin(r),_=Math.cos(r),c=y*_,h=y*v,g=m,this.face===Ir.FRONT?(s=Math.acos(c),i=Fx(s,g,h,l)):this.face===Ir.RIGHT?(s=Math.acos(h),i=Fx(s,g,-c,l)):this.face===Ir.BACK?(s=Math.acos(-c),i=Fx(s,g,-h,l)):this.face===Ir.LEFT?(s=Math.acos(-h),i=Fx(s,g,c,l)):(s=i=0,l.value=zn.AREA_0)}return o=Math.atan(12/Wr*(i+Math.acos(Math.sin(i)*Math.cos(Gn))-We)),a=Math.sqrt((1-Math.cos(s))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===zn.AREA_1?o+=We:l.value===zn.AREA_2?o+=Wr:l.value===zn.AREA_3&&(o+=1.5*Wr),e.x=a*Math.cos(o),e.y=a*Math.sin(o),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function U0e(n){var e={lam:0,phi:0},t,r,i,s,a,o,l,c,h,g={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,r=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?g.value=zn.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(g.value=zn.AREA_1,t-=We):n.x<0&&-n.x>=Math.abs(n.y)?(g.value=zn.AREA_2,t=t<0?t+Wr:t-Wr):(g.value=zn.AREA_3,t+=We),h=Wr/12*Math.tan(t),a=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),o=Math.atan(a),i=Math.cos(t),s=Math.tan(r),l=1-i*i*s*s*(1-Math.cos(Math.atan(1/Math.cos(o)))),l<-1?l=-1:l>1&&(l=1),this.face===Ir.TOP)c=Math.acos(l),e.phi=We-c,g.value===zn.AREA_0?e.lam=o+We:g.value===zn.AREA_1?e.lam=o<0?o+Wr:o-Wr:g.value===zn.AREA_2?e.lam=o-We:e.lam=o;else if(this.face===Ir.BOTTOM)c=Math.acos(l),e.phi=c-We,g.value===zn.AREA_0?e.lam=-o+We:g.value===zn.AREA_1?e.lam=-o:g.value===zn.AREA_2?e.lam=-o-We:e.lam=o<0?-o-Wr:-o+Wr;else{var m,y,v;m=l,h=m*m,h>=1?v=0:v=Math.sqrt(1-h)*Math.sin(o),h+=v*v,h>=1?y=0:y=Math.sqrt(1-h),g.value===zn.AREA_1?(h=y,y=-v,v=h):g.value===zn.AREA_2?(y=-y,v=-v):g.value===zn.AREA_3&&(h=y,y=v,v=-h),this.face===Ir.RIGHT?(h=m,m=-y,y=h):this.face===Ir.BACK?(m=-m,y=-y):this.face===Ir.LEFT&&(h=m,m=y,y=-h),e.phi=Math.acos(-v)-We,e.lam=Math.atan2(y,m),this.face===Ir.RIGHT?e.lam=v0(e.lam,-We):this.face===Ir.BACK?e.lam=v0(e.lam,-Wr):this.face===Ir.LEFT&&(e.lam=v0(e.lam,+We))}if(this.es!==0){var _,E,T;_=e.phi<0?1:0,E=Math.tan(e.phi),T=this.b/Math.sqrt(E*E+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-T*T)/(this.one_minus_f*T)),_&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function Fx(n,e,t,r){var i;return n<lt?(r.value=zn.AREA_0,i=0):(i=Math.atan2(e,t),Math.abs(i)<=Gn?r.value=zn.AREA_0:i>Gn&&i<=We+Gn?(r.value=zn.AREA_1,i-=We):i>We+Gn||i<=-(We+Gn)?(r.value=zn.AREA_2,i=i>=0?i-Wr:i+Wr):(r.value=zn.AREA_3,i+=We)),i}function v0(n,e){var t=n+e;return t<-Wr?t+=qp:t>+Wr&&(t-=qp),t}var $0e=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const W0e={init:G0e,forward:z0e,inverse:U0e,names:$0e};var AR=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Pm=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],IV=.8487,CV=1.3523,PV=Bs/5,H0e=1/PV,l0=18,Gv=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},K0e=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function X0e(n,e,t,r){for(var i=e;r;--r){var s=n(i);if(i-=s,Math.abs(s)<t)break}return i}function q0e(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Y0e(n){var e=mt(n.x-this.long0,this.over),t=Math.abs(n.y),r=Math.floor(t*PV);r<0?r=0:r>=l0&&(r=l0-1),t=Bs*(t-H0e*r);var i={x:Gv(AR[r],t)*e,y:Gv(Pm[r],t)};return n.y<0&&(i.y=-i.y),i.x=i.x*this.a*IV+this.x0,i.y=i.y*this.a*CV+this.y0,i}function Z0e(n){var e={x:(n.x-this.x0)/(this.a*IV),y:Math.abs(n.y-this.y0)/(this.a*CV)};if(e.y>=1)e.x/=AR[l0][0],e.y=n.y<0?-We:We;else{var t=Math.floor(e.y*l0);for(t<0?t=0:t>=l0&&(t=l0-1);;)if(Pm[t][0]>e.y)--t;else if(Pm[t+1][0]<=e.y)++t;else break;var r=Pm[t],i=5*(e.y-r[0])/(Pm[t+1][0]-r[0]);i=X0e(function(s){return(Gv(r,s)-e.y)/K0e(r,s)},i,lt,100),e.x/=Gv(AR[t],i),e.y=(5*t+i)*Or,n.y<0&&(e.y=-e.y)}return e.x=mt(e.x+this.long0,this.over),e}var J0e=["Robinson","robin"];const Q0e={init:q0e,forward:Y0e,inverse:Z0e,names:J0e};function ege(){this.name="geocent"}function tge(n){var e=xV(n,this.es,this.a);return e}function nge(n){var e=_V(n,this.es,this.a,this.b);return e}var rge=["Geocentric","geocentric","geocent","Geocent"];const ige={init:ege,forward:tge,inverse:nge,names:rge};var ss={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},mm={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function sge(){if(Object.keys(mm).forEach((function(t){if(typeof this[t]>"u")this[t]=mm[t].def;else{if(mm[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);mm[t].num&&(this[t]=parseFloat(this[t]))}mm[t].degrees&&(this[t]=this[t]*Or)}).bind(this)),Math.abs(Math.abs(this.lat0)-We)<lt?this.mode=this.lat0<0?ss.S_POLE:ss.N_POLE:Math.abs(this.lat0)<lt?this.mode=ss.EQUIT:(this.mode=ss.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function age(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i,s;switch(this.mode){case ss.OBLIQ:s=this.sinph0*e+this.cosph0*t*r;break;case ss.EQUIT:s=t*r;break;case ss.S_POLE:s=-e;break;case ss.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),i=s*t*Math.sin(n.x),this.mode){case ss.OBLIQ:s*=this.cosph0*e-this.sinph0*t*r;break;case ss.EQUIT:s*=e;break;case ss.N_POLE:s*=-(t*r);break;case ss.S_POLE:s*=t*r;break}var a,o;return a=s*this.cg+i*this.sg,o=1/(a*this.sw*this.h1+this.cw),i=(i*this.cg-s*this.sg)*this.cw*o,s=a*o,n.x=i*this.a,n.y=s*this.a,n}function oge(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,r,i;i=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*i,r=this.pn1*n.y*this.cw*i,n.x=t*this.cg+r*this.sg,n.y=r*this.cg-t*this.sg;var s=js(n.x,n.y);if(Math.abs(s)<lt)e.x=0,e.y=n.y;else{var a,o;switch(o=1-s*s*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/s+s/this.pn1),a=Math.sqrt(1-o*o),this.mode){case ss.OBLIQ:e.y=Math.asin(a*this.sinph0+n.y*o*this.cosph0/s),n.y=(a-this.sinph0*Math.sin(e.y))*s,n.x*=o*this.cosph0;break;case ss.EQUIT:e.y=Math.asin(n.y*o/s),n.y=a*s,n.x*=o;break;case ss.N_POLE:e.y=Math.asin(a),n.y=-n.y;break;case ss.S_POLE:e.y=-Math.asin(a);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var lge=["Tilted_Perspective","tpers"];const cge={init:sge,forward:age,inverse:oge,names:lge};function uge(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function hge(n){var e=n.x,t=n.y,r,i,s,a;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var o=this.radius_p/js(this.radius_p*Math.cos(t),Math.sin(t));if(i=o*Math.cos(e)*Math.cos(t),s=o*Math.sin(e)*Math.cos(t),a=o*Math.sin(t),(this.radius_g-i)*i-s*s-a*a*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/js(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/js(s,r)))}else this.shape==="sphere"&&(r=Math.cos(t),i=Math.cos(e)*r,s=Math.sin(e)*r,a=Math.sin(t),r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/js(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/js(s,r))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function dge(n){var e=-1,t=0,r=0,i,s,a,o;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*js(1,r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*js(1,t));var l=r/this.radius_p;if(i=t*t+l*l+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+r*r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),i=t*t+r*r+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var fge=["Geostationary Satellite View","Geostationary_Satellite","geos"];const gge={init:uge,forward:hge,inverse:dge,names:fge};var Zm=1.340264,Jm=-.081106,Qm=893e-6,ep=.003796,zv=Math.sqrt(3)/2;function mge(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function pge(n){var e=mt(n.x-this.long0,this.over),t=n.y,r=Math.asin(zv*Math.sin(t)),i=r*r,s=i*i*i;return n.x=e*Math.cos(r)/(zv*(Zm+3*Jm*i+s*(7*Qm+9*ep*i))),n.y=r*(Zm+Jm*i+s*(Qm+ep*i)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function yge(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,r=n.y,i,s,a,o,l,c;for(c=0;c<t&&(i=r*r,s=i*i*i,a=r*(Zm+Jm*i+s*(Qm+ep*i))-n.y,o=Zm+3*Jm*i+s*(7*Qm+9*ep*i),r-=l=a/o,!(Math.abs(l)<e));++c);return i=r*r,s=i*i*i,n.x=zv*n.x*(Zm+3*Jm*i+s*(7*Qm+9*ep*i))/Math.cos(r),n.y=Math.asin(Math.sin(r)/zv),n.x=mt(n.x+this.long0,this.over),n}var xge=["eqearth","Equal Earth","Equal_Earth"];const _ge={init:mge,forward:pge,inverse:yge,names:xge};var Jp=1e-10;function vge(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<Jp)throw new Error;this.es?(this.en=OI(this.es),this.m1=fg(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=Ege,this.forward=wge):(Math.abs(this.phi1)+Jp>=We?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Tge,this.forward=Sge)}function wge(n){var e=mt(n.x-(this.long0||0),this.over),t=n.y,r,i,s;return r=this.am1+this.m1-fg(t,i=Math.sin(t),s=Math.cos(t),this.en),i=s*e/(r*Math.sqrt(1-this.es*i*i)),n.x=r*Math.sin(i),n.y=this.am1-r*Math.cos(i),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Ege(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r,i;if(t=js(n.x,n.y=this.am1-n.y),i=DI(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(i))<We)e=Math.sin(i),r=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-We)<=Jp)r=0;else throw new Error;return n.x=mt(r+(this.long0||0),this.over),n.y=qu(i),n}function Sge(n){var e=mt(n.x-(this.long0||0),this.over),t=n.y,r,i;return i=this.cphi1+this.phi1-t,Math.abs(i)>Jp?(n.x=i*Math.sin(r=e*Math.cos(t)/i),n.y=this.cphi1-i*Math.cos(r)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Tge(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r=js(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-r,Math.abs(t)>We)throw new Error;return Math.abs(Math.abs(t)-We)<=Jp?e=0:e=r*Math.atan2(n.x,n.y)/Math.cos(t),n.x=mt(e+(this.long0||0),this.over),n.y=qu(t),n}var bge=["bonne","Bonne (Werner lat_1=90)"];const Rge={init:vge,names:bge},JO={OBLIQUE:{forward:Pge,inverse:Nge},TRANSVERSE:{forward:Mge,inverse:Lge}},Uv={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function Age(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=gV.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=ja(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const r=Object.keys(Uv),i=o=>{if(typeof this[o]>"u")return;const l=parseFloat(this[o])*Or;if(isNaN(l))throw new Error("Invalid value for "+o+": "+this[o]);return l};for(let o=0;o<r.length;o++){const l=r[o],c=Uv[l],h=Object.entries(c);if(h.some(([m])=>typeof this[m]<"u")){t=c;for(let m=0;m<h.length;m++){const[y,v]=h[m],_=i(y);if(typeof _>"u")throw new Error("Missing parameter: "+y+".");this[v]=_}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:a}=Cge(this,t);this.lamp=s,Math.abs(a)>lt?(this.cphip=Math.cos(a),this.sphip=Math.sin(a),this.projectionType=JO.OBLIQUE):this.projectionType=JO.TRANSVERSE}function kge(n){return this.projectionType.forward(this,n)}function Ige(n){return this.projectionType.inverse(this,n)}function Cge(n,e){let t,r;if(e===Uv.ROTATE){let i=n.oLongC,s=n.oLatC,a=n.oAlpha;if(Math.abs(Math.abs(s)-We)<=lt)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");r=i+Math.atan2(-1*Math.cos(a),-1*Math.sin(a)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(a))}else if(e===Uv.NEW_POLE)r=n.oLongP,t=n.oLatP;else{let i=n.oLong1,s=n.oLat1,a=n.oLong2,o=n.oLat2,l=Math.abs(s);if(Math.abs(s)>We-lt)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(o)>We-lt)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-o)<lt)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(l<lt)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(s)*Math.sin(o)*Math.cos(i)-Math.sin(s)*Math.cos(o)*Math.cos(a),Math.sin(s)*Math.cos(o)*Math.sin(a)-Math.cos(s)*Math.sin(o)*Math.sin(i)),t=Math.atan(-1*Math.cos(r-i)/Math.tan(s))}return{lamp:r,phip:t}}function Pge(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(t),s=Math.sin(r),a=Math.cos(r);e.x=mt(Math.atan2(a*Math.sin(t),n.sphip*a*i+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*a*i);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=Bs,o.y*=Bs),o}function Mge(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(r),s=Math.cos(t);e.x=mt(Math.atan2(i*Math.sin(t),Math.sin(r))+n.lamp),e.y=Math.asin(-1*i*s);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=Bs,a.y*=Bs),a}function Nge(n,e){n.isIdentity&&(e.x*=Or,e.y*=Or);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){r-=n.lamp;const s=Math.cos(r),a=Math.sin(i),o=Math.cos(i);e.x=Math.atan2(o*Math.sin(r),n.sphip*o*s-n.cphip*a),e.y=Math.asin(n.sphip*a+n.cphip*o*s)}return e.x=mt(e.x+n.long0),e}function Lge(n,e){n.isIdentity&&(e.x*=Or,e.y*=Or);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){const s=Math.cos(i);r-=n.lamp,e.x=Math.atan2(s*Math.sin(r),-1*Math.sin(i)),e.y=Math.asin(s*Math.cos(r))}return e.x=mt(e.x+n.long0),e}var Oge=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const Dge={init:Age,forward:kge,inverse:Ige,names:Oge};function Fge(n){n.Proj.projections.add(__),n.Proj.projections.add(v_),n.Proj.projections.add(bde),n.Proj.projections.add(Lde),n.Proj.projections.add(Vde),n.Proj.projections.add($de),n.Proj.projections.add(Yde),n.Proj.projections.add(tfe),n.Proj.projections.add(afe),n.Proj.projections.add(hfe),n.Proj.projections.add(Tfe),n.Proj.projections.add(Cfe),n.Proj.projections.add(Ofe),n.Proj.projections.add(Gfe),n.Proj.projections.add(Hfe),n.Proj.projections.add(Zfe),n.Proj.projections.add(n0e),n.Proj.projections.add(o0e),n.Proj.projections.add(f0e),n.Proj.projections.add(x0e),n.Proj.projections.add(S0e),n.Proj.projections.add(k0e),n.Proj.projections.add(O0e),n.Proj.projections.add(B0e),n.Proj.projections.add(W0e),n.Proj.projections.add(Q0e),n.Proj.projections.add(ige),n.Proj.projections.add(cge),n.Proj.projections.add(gge),n.Proj.projections.add(_ge),n.Proj.projections.add(Rge),n.Proj.projections.add(Dge)}const Sn=Object.assign(zhe,{defaultDatum:"WGS84",Proj:ja,WGS84:new ja("WGS84"),Point:Q0,toPoint:vV,defs:Vi,nadgrid:The,transform:Vv,mgrs:Uhe,version:"__VERSION__"});Fge(Sn);class MV{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=_r,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let r=t.dataProjection?nr(t.dataProjection):this.readProjection(e);t.extent&&r&&r.getUnits()==="tile-pixels"&&(r=nr(r),r.setWorldExtent(t.extent)),t={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return $t()}readFeature(e,t){return $t()}readFeatures(e,t){return $t()}readGeometry(e,t){return $t()}readProjection(e){return $t()}writeFeature(e,t){return $t()}writeFeatures(e,t){return $t()}writeGeometry(e,t){return $t()}}function To(n,e,t){const r=t?nr(t.featureProjection):null,i=t?nr(t.dataProjection):null;let s=n;if(r&&i&&!Xh(r,i)){e&&(s=n.clone());const a=e?r:i,o=e?i:r;a.getUnits()==="tile-pixels"?s.transform(a,o):s.applyTransform(gp(a,o))}if(e&&t&&t.decimals!==void 0){const a=Math.pow(10,t.decimals),o=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*a)/a;return l};s===n&&(s=n.clone()),s.applyTransform(o)}return s}const jge={Point:gi,LineString:Ti,Polygon:Ga,MultiPoint:Id,MultiLineString:nc,MultiPolygon:ad};function Vge(n,e,t){return Array.isArray(e[0])?(ZD(n,0,e,t)||(n=n.slice(),ib(n,0,e,t)),n):(cA(n,0,e,t)||(n=n.slice(),D_(n,0,e,t)),n)}function NV(n,e){const t=n.geometry;if(!t)return[];if(Array.isArray(t))return t.map(s=>NV({...n,geometry:s})).flat();const r=t.type==="MultiPolygon"?"Polygon":t.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const i=t.layout.length;return To(new Ds(r,r==="Polygon"?Vge(t.flatCoordinates,t.ends,i):t.flatCoordinates,t.ends?.flat(),i,n.properties||{},n.id).enableSimplifyTransformed(),!1,e)}function zI(n,e){if(!n)return null;if(Array.isArray(n)){const r=n.map(i=>zI(i,e));return new po(r)}const t=jge[n.type];return To(new t(n.flatCoordinates,n.layout||"XY",n.ends),!1,e)}class Bge extends MV{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(jx(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(jx(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return $t()}readFeaturesFromObject(e,t){return $t()}readGeometry(e,t){return this.readGeometryFromObject(jx(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return $t()}readProjection(e){return this.readProjectionFromObject(jx(e))}readProjectionFromObject(e){return $t()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return $t()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return $t()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return $t()}}function jx(n){if(typeof n=="string"){const e=JSON.parse(n);return e||null}return n!==null?n:null}class UI extends Bge{constructor(e){e=e||{},super(),this.dataProjection=nr(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=nr(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const i=$I(r.geometry);if(this.featureClass===Ds)return NV({geometry:i,id:r.id,properties:r.properties},t);const s=new _r;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(zI(i,t)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,t){const r=e;let i=null;if(r.type==="FeatureCollection"){const s=e;i=[];const a=s.features;for(let o=0,l=a.length;o<l;++o){const c=this.readFeatureFromObject(a[o],t);c&&i.push(c)}}else i=[this.readFeatureFromObject(e,t)];return i.flat()}readGeometryFromObject(e,t){return Gge(e,t)}readProjectionFromObject(e){const t=e.crs;let r;if(t)if(t.type=="name")r=nr(t.properties.name);else if(t.type==="EPSG")r=nr("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,t){t=this.adaptOptions(t);const r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;const s=e.getProperties(),a=e.getGeometry();return a&&(r.geometry=kR(a,t),delete s[e.getGeometryName()]),td(s)||(r.properties=s),r}writeFeaturesObject(e,t){t=this.adaptOptions(t);const r=[];for(let i=0,s=e.length;i<s;++i)r.push(this.writeFeatureObject(e[i],t));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,t){return kR(e,this.adaptOptions(t))}}function $I(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=Uge(n);break}case"LineString":{t=$ge(n);break}case"Polygon":{t=Xge(n);break}case"MultiPoint":{t=Hge(n);break}case"MultiLineString":{t=Wge(n);break}case"MultiPolygon":{t=Kge(n);break}case"GeometryCollection":{t=zge(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return t}function Gge(n,e){const t=$I(n);return zI(t,e)}function zge(n,e){return n.geometries.map(function(r){return $I(r)})}function Uge(n){const e=n.coordinates;return{type:"Point",flatCoordinates:e,layout:kd(e.length)}}function $ge(n){const e=n.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:kd(e[0]?.length||2)}}function Wge(n){const e=n.coordinates,t=e[0]?.[0]?.length||2,r=[],i=my(r,0,e,t);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:kd(t)}}function Hge(n){const e=n.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:kd(e[0]?.length||2)}}function Kge(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.[0].length||2,i=AD(t,0,e,r);return{type:"MultiPolygon",flatCoordinates:t,ends:i,layout:kd(r)}}function Xge(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.length,i=my(t,0,e,r);return{type:"Polygon",flatCoordinates:t,ends:i,layout:kd(r)}}function kR(n,e){n=To(n,!0,e);const t=n.getType();let r;switch(t){case"Point":{r=eme(n);break}case"LineString":{r=Yge(n);break}case"Polygon":{r=tme(n,e);break}case"MultiPoint":{r=Jge(n);break}case"MultiLineString":{r=Zge(n);break}case"MultiPolygon":{r=Qge(n,e);break}case"GeometryCollection":{r=qge(n,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return r}function qge(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(r){return kR(r,e)})}}function Yge(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function Zge(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function Jge(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function Qge(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function eme(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function tme(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}const $v="http://www.w3.org/2001/XMLSchema-instance";function Dd(n,e){return gg().createElementNS(n,e)}function bo(n,e){return LV(n,e,[]).join("")}function LV(n,e,t){if(n.nodeType==Node.CDATA_SECTION_NODE||n.nodeType==Node.TEXT_NODE)t.push(n.nodeValue);else{let r;for(r=n.firstChild;r;r=r.nextSibling)LV(r,e,t)}return t}function $l(n){return"documentElement"in n}function Wl(n){return new DOMParser().parseFromString(n,"application/xml")}function QO(n,e){return(function(t,r){const i=n.call(e??this,t,r);if(i!==void 0){const s=r[r.length-1];Bn(s,i)}})}function uo(n,e){return(function(t,r){const i=n.call(e??this,t,r);i!==void 0&&r[r.length-1].push(i)})}function WI(n,e){return(function(t,r){const i=n.call(this,t,r);i!==void 0&&(r[r.length-1]=i)})}function ze(n,e,t){return(function(r,i){const s=n.call(this,r,i);if(s!==void 0){const a=i[i.length-1],o=e!==void 0?e:r.localName;a[o]=s}})}function tt(n,e){return(function(t,r,i){n.call(this,t,r,i),i[i.length-1].node.appendChild(t)})}function OV(n,e){let t,r;return function(i,s,a){if(t===void 0){t={};const o={};o[i.localName]=n,t[i.namespaceURI]=o,r=Ro(i.localName)}DV(t,r,s,a)}}function Ro(n,e){return(function(t,r,i){const a=r[r.length-1].node;let o=n;o===void 0&&(o=i);const l=a.namespaceURI;return Dd(l,o)})}const hs=Ro();function Ws(n,e){const t=e.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=n[e[i]];return r}function gt(n,e,t){t=t!==void 0?t:{};let r,i;for(r=0,i=n.length;r<i;++r)t[n[r]]=e;return t}function Yu(n,e,t,r){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const s=n[i.namespaceURI];if(s!==void 0){const a=s[i.localName];a!==void 0&&a.call(r,i,t)}}}function _n(n,e,t,r,i){return r.push(n),Yu(e,t,r,i),r.pop()}function DV(n,e,t,r,i,s){const a=(i!==void 0?i:t).length;let o,l;for(let c=0;c<a;++c)o=t[c],o!==void 0&&(l=e.call(s,o,r,i!==void 0?i[c]:void 0),l!==void 0&&n[l.namespaceURI][l.localName].call(s,l,o,r))}function or(n,e,t,r,i,s,a){return i.push(n),DV(e,t,r,i,s,a),i.pop()}let bT;function nme(){return bT===void 0&&typeof XMLSerializer<"u"&&(bT=new XMLSerializer),bT}let RT;function gg(){return RT===void 0&&typeof document<"u"&&(RT=document.implementation.createDocument("","",null)),RT}class FV extends MV{constructor(){super(),this.xmlSerializer_=nme()}getType(){return"xml"}readFeature(e,t){if(!e)return null;if(typeof e=="string"){const r=Wl(e);return this.readFeatureFromDocument(r,t)}return $l(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t)}readFeatureFromDocument(e,t){const r=this.readFeaturesFromDocument(e,t);return r.length>0?r[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(!e)return[];if(typeof e=="string"){const r=Wl(e);return this.readFeaturesFromDocument(r,t)}return $l(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t)}readFeaturesFromDocument(e,t){const r=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&Bn(r,this.readFeaturesFromNode(i,t));return r}readFeaturesFromNode(e,t){return $t()}readGeometry(e,t){if(!e)return null;if(typeof e=="string"){const r=Wl(e);return this.readGeometryFromDocument(r,t)}return $l(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t)}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const t=Wl(e);return this.readProjectionFromDocument(t)}return $l(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){const r=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,t){return null}writeFeatures(e,t){const r=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){const r=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,t){return null}}function Bu(n){const e=bo(n,!1);return rme(e)}function rme(n){const e=/^\s*(true|1)|(false|0)\s*$/.exec(n);if(e)return e[1]!==void 0||!1}function wE(n){const e=bo(n,!1),t=Date.parse(e);return isNaN(t)?void 0:t/1e3}function Pn(n){const e=bo(n,!1);return ime(e)}function ime(n){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(n);if(e)return parseFloat(e[1])}function Qp(n){const e=bo(n,!1);return sme(e)}function sme(n){const e=/^\s*(\d+)\s*$/.exec(n);if(e)return parseInt(e[1],10)}function ln(n){return bo(n,!1).trim()}function eg(n,e){Dn(n,e?"1":"0")}function ame(n,e){n.appendChild(gg().createCDATASection(e))}function ome(n,e){const t=new Date(e*1e3),r=t.getUTCFullYear()+"-"+nm(t.getUTCMonth()+1,2)+"-"+nm(t.getUTCDate(),2)+"T"+nm(t.getUTCHours(),2)+":"+nm(t.getUTCMinutes(),2)+":"+nm(t.getUTCSeconds(),2)+"Z";n.appendChild(gg().createTextNode(r))}function Ns(n,e){const t=e.toPrecision();n.appendChild(gg().createTextNode(t))}function Wv(n,e){const t=e.toString();n.appendChild(gg().createTextNode(t))}const lme=/^\s/,cme=/\s$/,ume=/(\n|\t|\r|<|&| {2})/;function Dn(n,e){typeof e=="string"&&(lme.test(e)||cme.test(e)||ume.test(e))?e.split("]]>").forEach((t,r,i)=>{r<i.length-1&&(t+="]]"),r>0&&(t=">"+t),ame(n,t)}):n.appendChild(gg().createTextNode(e))}const fr=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],hme="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",dme={rte:jV,trk:VV,wpt:BV},fme=gt(fr,{rte:uo(jV),trk:uo(VV),wpt:uo(BV)}),gme=gt(fr,{text:ze(ln,"linkText"),type:ze(ln,"linkType")}),mme=gt(fr,{name:ze(ln),email:zme,link:Jy}),pme=gt(fr,{name:ze(ln),desc:ze(ln),author:ze(Vme),copyright:ze(Bme),link:Jy,time:ze(wE),keywords:ze(ln),bounds:Gme,extensions:EE}),yme=gt(fr,{year:ze(Qp),license:ze(ln)}),xme=gt(fr,{rte:tt(Hme),trk:tt(Kme),wpt:tt(qme)});class _me extends FV{constructor(e){super(),e=e||{},this.dataProjection=nr("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let t=0,r=e.length;t<r;++t){const i=e[t];if(this.readExtensions_){const s=i.get("extensionsNode_")||null;this.readExtensions_(i,s)}i.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(Wl(e)):$l(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE){const r=this.readMetadataFromNode(t);if(r)return r}return null}readMetadataFromNode(e){if(!fr.includes(e.namespaceURI))return null;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(fr.includes(t.namespaceURI)&&t.localName==="metadata")return _n({},pme,t,[]);return null}readFeatureFromNode(e,t){if(!fr.includes(e.namespaceURI))return null;const r=dme[e.localName];if(!r)return null;const i=r(e,[this.getReadOptions(e,t)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,t){if(!fr.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const r=_n([],fme,e,[this.getReadOptions(e,t)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=Dd("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",$v),r.setAttributeNS($v,"xsi:schemaLocation",hme),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),or({node:r},xme,jme,e,[t]),r}}const vme=gt(fr,{name:ze(ln),cmt:ze(ln),desc:ze(ln),src:ze(ln),link:Jy,number:ze(Qp),extensions:EE,type:ze(ln),rtept:Ume}),wme=gt(fr,{ele:ze(Pn),time:ze(wE)}),Eme=gt(fr,{name:ze(ln),cmt:ze(ln),desc:ze(ln),src:ze(ln),link:Jy,number:ze(Qp),type:ze(ln),extensions:EE,trkseg:Wme}),Sme=gt(fr,{trkpt:$me}),Tme=gt(fr,{ele:ze(Pn),time:ze(wE)}),bme=gt(fr,{ele:ze(Pn),time:ze(wE),magvar:ze(Pn),geoidheight:ze(Pn),name:ze(ln),cmt:ze(ln),desc:ze(ln),src:ze(ln),link:Jy,sym:ze(ln),type:ze(ln),fix:ze(ln),sat:ze(Qp),hdop:ze(Pn),vdop:ze(Pn),pdop:ze(Pn),ageofdgpsdata:ze(Pn),dgpsid:ze(Qp),extensions:EE}),Rme=["text","type"],Ame=gt(fr,{text:tt(Dn),type:tt(Dn)}),kme=gt(fr,["name","cmt","desc","src","link","number","type","rtept"]),Ime=gt(fr,{name:tt(Dn),cmt:tt(Dn),desc:tt(Dn),src:tt(Dn),link:tt(XI),number:tt(Wv),type:tt(Dn),rtept:OV(tt(qI))}),Cme=gt(fr,["ele","time"]),Pme=gt(fr,["name","cmt","desc","src","link","number","type","trkseg"]),Mme=gt(fr,{name:tt(Dn),cmt:tt(Dn),desc:tt(Dn),src:tt(Dn),link:tt(XI),number:tt(Wv),type:tt(Dn),trkseg:OV(tt(Xme))}),Nme=Ro("trkpt"),Lme=gt(fr,{trkpt:tt(qI)}),Ome=gt(fr,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),Dme=gt(fr,{ele:tt(Ns),time:tt(ome),magvar:tt(Ns),geoidheight:tt(Ns),name:tt(Dn),cmt:tt(Dn),desc:tt(Dn),src:tt(Dn),link:tt(XI),sym:tt(Dn),type:tt(Dn),fix:tt(Dn),sat:tt(Wv),hdop:tt(Ns),vdop:tt(Ns),pdop:tt(Ns),ageofdgpsdata:tt(Ns),dgpsid:tt(Wv)}),Fme={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function jme(n,e,t){const r=n.getGeometry();if(r){const i=Fme[r.getType()];if(i){const s=e[e.length-1].node;return Dd(s.namespaceURI,i)}}}function HI(n,e,t,r){return n.push(parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))),"ele"in r?(n.push(r.ele),delete r.ele,e.hasZ=!0):n.push(0),"time"in r?(n.push(r.time),delete r.time,e.hasM=!0):n.push(0),n}function KI(n,e,t){let r="XY",i=2;if(n.hasZ&&n.hasM?(r="XYZM",i=4):n.hasZ?(r="XYZ",i=3):n.hasM&&(r="XYM",i=3),i!==4){for(let s=0,a=e.length/4;s<a;s++)e[s*i]=e[s*4],e[s*i+1]=e[s*4+1],n.hasZ&&(e[s*i+2]=e[s*4+2]),n.hasM&&(e[s*i+2]=e[s*4+3]);if(e.length=e.length/4*i,t)for(let s=0,a=t.length;s<a;s++)t[s]=t[s]/4*i}return r}function Vme(n,e){const t=_n({},mme,n,e);if(t)return t}function Bme(n,e){const t=_n({},yme,n,e);if(t){const r=n.getAttribute("author");return r!==null&&(t.author=r),t}}function Gme(n,e){const t=e[e.length-1],r=n.getAttribute("minlat"),i=n.getAttribute("minlon"),s=n.getAttribute("maxlat"),a=n.getAttribute("maxlon");i!==null&&r!==null&&a!==null&&s!==null&&(t.bounds=[[parseFloat(i),parseFloat(r)],[parseFloat(a),parseFloat(s)]])}function zme(n,e){const t=e[e.length-1],r=n.getAttribute("id"),i=n.getAttribute("domain");r!==null&&i!==null&&(t.email=`${r}@${i}`)}function Jy(n,e){const t=e[e.length-1],r=n.getAttribute("href");r!==null&&(t.link=r),Yu(gme,n,e)}function EE(n,e){const t=e[e.length-1];t.extensionsNode_=n}function Ume(n,e){const t=_n({},wme,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;HI(i,s,n,t)}}function $me(n,e){const t=_n({},Tme,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;HI(i,s,n,t)}}function Wme(n,e){const t=e[e.length-1];Yu(Sme,n,e);const r=t.flatCoordinates;t.ends.push(r.length)}function jV(n,e){const t=e[0],r=_n({flatCoordinates:[],layoutOptions:{}},vme,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.layoutOptions;delete r.layoutOptions;const a=KI(s,i),o=new Ti(i,a);To(o,!1,t);const l=new _r(o);return l.setProperties(r,!0),l}function VV(n,e){const t=e[0],r=_n({flatCoordinates:[],ends:[],layoutOptions:{}},Eme,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.ends;delete r.ends;const a=r.layoutOptions;delete r.layoutOptions;const o=KI(a,i,s),l=new nc(i,o,s);To(l,!1,t);const c=new _r(l);return c.setProperties(r,!0),c}function BV(n,e){const t=e[0],r=_n({},bme,n,e);if(!r)return;const i={},s=HI([],i,n,r),a=KI(i,s),o=new gi(s,a);To(o,!1,t);const l=new _r(o);return l.setProperties(r,!0),l}function XI(n,e,t){n.setAttribute("href",e);const i=t[t.length-1].properties,s=[i.linkText,i.linkType];or({node:n},Ame,hs,s,t,Rme)}function qI(n,e,t){const r=t[t.length-1],s=r.node.namespaceURI,a=r.properties;switch(n.setAttributeNS(null,"lat",String(e[1])),n.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case"XYZM":e[3]!==0&&(a.time=e[3]);case"XYZ":e[2]!==0&&(a.ele=e[2]);break;case"XYM":e[2]!==0&&(a.time=e[2]);break}const l=n.nodeName=="rtept"?Cme[s]:Ome[s],c=Ws(a,l);or({node:n,properties:a},Dme,hs,c,t,l)}function Hme(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="LineString"){const h=To(a,!0,r);s.geometryLayout=h.getLayout(),i.rtept=h.getCoordinates()}const o=t[t.length-1].node,l=kme[o.namespaceURI],c=Ws(i,l);or(s,Ime,hs,c,t,l)}function Kme(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="MultiLineString"){const h=To(a,!0,r);i.trkseg=h.getLineStrings()}const o=t[t.length-1].node,l=Pme[o.namespaceURI],c=Ws(i,l);or(s,Mme,hs,c,t,l)}function Xme(n,e,t){const r={node:n};r.geometryLayout=e.getLayout(),r.properties={},or(r,Lme,Nme,e.getCoordinates(),t)}function qme(n,e,t){const r=t[0],i=t[t.length-1];i.properties=e.getProperties();const s=e.getGeometry();if(s.getType()=="Point"){const a=To(s,!0,r);i.geometryLayout=a.getLayout(),qI(n,a.getCoordinates(),t)}}const _c=["http://www.google.com/kml/ext/2.2"],Pt=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],Yme="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",e5={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},Zme=gt(Pt,{ExtendedData:tB,Region:nB,MultiGeometry:ze(JV,"geometry"),LineString:ze(YV,"geometry"),LinearRing:ze(ZV,"geometry"),Point:ze(QV,"geometry"),Polygon:ze(eB,"geometry"),Style:ze(JI),StyleMap:Lpe,address:ze(ln),description:ze(ln),name:ze(ln),open:ze(Bu),phoneNumber:ze(ln),styleUrl:ze(WV),visibility:ze(Bu)},gt(_c,{MultiTrack:ze(wpe,"geometry"),Track:ze(qV,"geometry")})),Jme=gt(Pt,{ExtendedData:tB,Region:nB,Link:Hpe,address:ze(ln),description:ze(ln),name:ze(ln),open:ze(Bu),phoneNumber:ze(ln),visibility:ze(Bu)}),Qme=gt(Pt,{href:ze($V)}),epe=gt(Pt,{Altitude:ze(Pn),Longitude:ze(Pn),Latitude:ze(Pn),Tilt:ze(Pn),AltitudeMode:ze(ln),Heading:ze(Pn),Roll:ze(Pn)}),GV=gt(Pt,{LatLonAltBox:Vpe,Lod:Gpe}),tpe=gt(Pt,["Document","Placemark"]),npe=gt(Pt,{Document:tt(eye),Placemark:tt(sB)});let w0,E_=null,IR,tp,np,rp,Hv,CR=null,YI,PR=null,MR,Wh=null,t5=null,NR=null;function Kv(n){return 32/Math.min(n[0],n[1])}function rpe(){w0=[255,255,255,1],E_=new tr({color:w0}),IR=[20,2],tp="pixels",np="pixels",rp=[64,64],Hv="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",CR=new xy({anchor:IR,anchorOrigin:"bottom-left",anchorXUnits:tp,anchorYUnits:np,crossOrigin:"anonymous",rotation:0,scale:Kv(rp),size:rp,src:Hv}),YI="NO_IMAGE",PR=new qn({color:w0,width:1}),MR=new qn({color:[51,51,51,1],width:2}),Wh=new yo({font:"bold 16px Helvetica",fill:E_,stroke:MR,scale:.8}),t5=new mn({fill:E_,image:CR,text:Wh,stroke:PR,zIndex:0}),NR=[t5]}let Vx;function ipe(n){return n}class spe extends FV{constructor(e){super(),e=e||{},NR||rpe(),this.dataProjection=nr("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:NR,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:ipe,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,t){const r=gt(Pt,{Document:QO(this.readDocumentOrFolder_,this),Folder:QO(this.readDocumentOrFolder_,this),Placemark:uo(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=_n([],r,e,t,this);if(i)return i}readPlacemark_(e,t){const r=_n({geometry:null},Zme,e,t,this);if(!r)return;const i=new _r,s=e.getAttribute("id");s!==null&&i.setId(s);const a=t[0],o=r.geometry;if(o&&To(o,!1,a),i.setGeometry(o),delete r.geometry,this.extractStyles_){const l=r.Style,c=r.styleUrl,h=ope(l,c,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(h)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,t){const r=e.getAttribute("id");if(r!==null){const i=JI.call(this,e,t);if(i){let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}}}readSharedStyleMap_(e,t){const r=e.getAttribute("id");if(r===null)return;const i=KV.call(this,e,t);if(!i)return;let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}readFeatureFromNode(e,t){if(!Pt.includes(e.namespaceURI))return null;const r=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return r||null}readFeaturesFromNode(e,t){if(!Pt.includes(e.namespaceURI))return[];let r;const i=e.localName;if(i=="Document"||i=="Folder")return r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]),r||[];if(i=="Placemark"){const s=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return s?[s]:[]}if(i=="kml"){r=[];for(let s=e.firstElementChild;s;s=s.nextElementSibling){const a=this.readFeaturesFromNode(s,t);a&&Bn(r,a)}return r}return[]}readName(e){if(e){if(typeof e=="string"){const t=Wl(e);return this.readNameFromDocument(t)}return $l(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){const r=this.readNameFromNode(t);if(r)return r}}readNameFromNode(e){for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(Pt.includes(t.namespaceURI)&&t.localName=="name")return ln(t);for(let t=e.firstElementChild;t;t=t.nextElementSibling){const r=t.localName;if(Pt.includes(t.namespaceURI)&&(r=="Document"||r=="Folder"||r=="Placemark"||r=="kml")){const i=this.readNameFromNode(t);if(i)return i}}}readNetworkLinks(e){const t=[];if(typeof e=="string"){const r=Wl(e);Bn(t,this.readNetworkLinksFromDocument(r))}else $l(e)?Bn(t,this.readNetworkLinksFromDocument(e)):Bn(t,this.readNetworkLinksFromNode(e));return t}readNetworkLinksFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Bn(t,this.readNetworkLinksFromNode(r));return t}readNetworkLinksFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Pt.includes(r.namespaceURI)&&r.localName=="NetworkLink"){const i=_n({},Jme,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Pt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Bn(t,this.readNetworkLinksFromNode(r))}return t}readRegion(e){const t=[];if(typeof e=="string"){const r=Wl(e);Bn(t,this.readRegionFromDocument(r))}else $l(e)?Bn(t,this.readRegionFromDocument(e)):Bn(t,this.readRegionFromNode(e));return t}readRegionFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Bn(t,this.readRegionFromNode(r));return t}readRegionFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Pt.includes(r.namespaceURI)&&r.localName=="Region"){const i=_n({},GV,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Pt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Bn(t,this.readRegionFromNode(r))}return t}readCamera(e){const t=[];if(typeof e=="string"){const r=Wl(e);Bn(t,this.readCameraFromDocument(r))}else $l(e)?Bn(t,this.readCameraFromDocument(e)):Bn(t,this.readCameraFromNode(e));return t}readCameraFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&Bn(t,this.readCameraFromNode(r));return t}readCameraFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Pt.includes(r.namespaceURI)&&r.localName==="Camera"){const i=_n({},epe,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Pt.includes(r.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&Bn(t,this.readCameraFromNode(r))}return t}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=Dd(Pt[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",_c[0]),r.setAttributeNS(i,"xmlns:xsi",$v),r.setAttributeNS($v,"xsi:schemaLocation",Yme);const s={node:r},a={};e.length>1?a.Document=e:e.length==1&&(a.Placemark=e[0]);const o=tpe[r.namespaceURI],l=Ws(a,o);return or(s,npe,hs,l,[t],o,this),r}}function ape(n,e){const t=[0,0];let r="start";const i=n.getImage();if(i){const o=i.getSize();if(o&&o.length==2){const l=i.getScaleArray(),c=i.getAnchor();t[0]=l[0]*(o[0]-c[0]),t[1]=l[1]*(o[1]/2-c[1]),r="left"}}let s=n.getText();return s?(s=s.clone(),s.setFont(s.getFont()||Wh.getFont()),s.setScale(s.getScale()||Wh.getScale()),s.setFill(s.getFill()||Wh.getFill()),s.setStroke(s.getStroke()||MR)):s=Wh.clone(),s.setText(e),s.setOffsetX(t[0]),s.setOffsetY(t[1]),s.setTextAlign(r),new mn({image:i,text:s})}function ope(n,e,t,r,i){return(function(s,a){let o=i,l="",c=[];if(o){const g=s.getGeometry();if(g)if(g instanceof po)c=g.getGeometriesArrayRecursive().filter(function(m){const y=m.getType();return y==="Point"||y==="MultiPoint"}),o=c.length>0;else{const m=g.getType();o=m==="Point"||m==="MultiPoint"}}o&&(l=s.get("name"),o=o&&!!l,o&&/&[^&]+;/.test(l)&&(Vx||(Vx=document.createElement("textarea")),Vx.innerHTML=l,l=Vx.value));let h=t;if(n?h=n:e&&(h=zV(e,t,r)),o){const g=ape(h[0],l);if(c.length>0){g.setGeometry(new po(c));const m=new mn({geometry:h[0].getGeometry(),image:null,fill:h[0].getFill(),stroke:h[0].getStroke(),text:null});return[g,m].concat(h.slice(1))}return g}return h})}function zV(n,e,t){return Array.isArray(n)?n:typeof n=="string"?zV(t[n],e,t):e}function SE(n){const e=bo(n,!1),t=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(t){const r=t[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function UV(n){let e=bo(n,!1);const t=[];e=e.replace(/\s*,\s*/g,",");const r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=r.exec(e);){const s=parseFloat(i[1]),a=parseFloat(i[2]),o=i[3]?parseFloat(i[3]):0;t.push(s,a,o),e=e.substr(i[0].length)}if(e==="")return t}function $V(n){const e=bo(n,!1).trim();let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function WV(n){const e=bo(n,!1).trim().replace(/^(?!.*#)/,"#");let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function lpe(n){const e=n.getAttribute("xunits"),t=n.getAttribute("yunits");let r;return e!=="insetPixels"?t!=="insetPixels"?r="bottom-left":r="top-left":t!=="insetPixels"?r="bottom-right":r="top-right",{x:parseFloat(n.getAttribute("x")),xunits:e5[e],y:parseFloat(n.getAttribute("y")),yunits:e5[t],origin:r}}function HV(n){return Pn(n)}const cpe=gt(Pt,{Pair:Npe});function KV(n,e){return _n(void 0,cpe,n,e,this)}const upe=gt(Pt,{Icon:ze(Tpe),color:ze(SE),heading:ze(Pn),hotSpot:ze(lpe),scale:ze(HV)});function hpe(n,e){const t=_n({},upe,n,e);if(!t)return;const r=e[e.length-1],i="Icon"in t?t.Icon:{},s=!("Icon"in t)||Object.keys(i).length>0;let a;const o=i.href;o?a=o:s&&(a=Hv);let l,c,h,g="bottom-left";const m=t.hotSpot;m?(l=[m.x,m.y],c=m.xunits,h=m.yunits,g=m.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(a)&&(a.includes("pushpin")?(l=IR,c=tp,h=np):a.includes("arrow-reverse")?(l=[54,42],c=tp,h=np):a.includes("paddle")&&(l=[32,1],c=tp,h=np));let y;const v=i.x,_=i.y;v!==void 0&&_!==void 0&&(y=[v,_]);let E;const T=i.w,b=i.h;T!==void 0&&b!==void 0&&(E=[T,b]);let R;const N=t.heading;N!==void 0&&(R=Xl(N));const D=t.scale,W=t.color;if(s){a==Hv&&(E=rp);const I=new xy({anchor:l,anchorOrigin:g,anchorXUnits:c,anchorYUnits:h,crossOrigin:this.crossOrigin_,offset:y,offsetOrigin:"bottom-left",rotation:R,scale:D,size:E,src:this.iconUrlFunction_(a),color:W}),A=I.getScaleArray()[0],M=I.getSize();if(M===null){const O=I.getImageState();if(O===Tt.IDLE||O===Tt.LOADING){const L=function(){const z=I.getImageState();if(!(z===Tt.IDLE||z===Tt.LOADING)){const j=I.getSize();if(j&&j.length==2){const Ee=Kv(j);I.setScale(A*Ee)}I.unlistenImageChange(L)}};I.listenImageChange(L),O===Tt.IDLE&&I.load()}}else if(M.length==2){const O=Kv(M);I.setScale(A*O)}r.imageStyle=I}else r.imageStyle=YI}const dpe=gt(Pt,{color:ze(SE),scale:ze(HV)});function fpe(n,e){const t=_n({},dpe,n,e);if(!t)return;const r=e[e.length-1],i=new yo({fill:new tr({color:"color"in t?t.color:w0}),scale:t.scale});r.textStyle=i}const gpe=gt(Pt,{color:ze(SE),width:ze(Pn)});function mpe(n,e){const t=_n({},gpe,n,e);if(!t)return;const r=e[e.length-1],i=new qn({color:"color"in t?t.color:w0,width:"width"in t?t.width:1});r.strokeStyle=i}const ppe=gt(Pt,{color:ze(SE),fill:ze(Bu),outline:ze(Bu)});function ype(n,e){const t=_n({},ppe,n,e);if(!t)return;const r=e[e.length-1],i=new tr({color:"color"in t?t.color:w0});r.fillStyle=i;const s=t.fill;s!==void 0&&(r.fill=s);const a=t.outline;a!==void 0&&(r.outline=a)}const xpe=gt(Pt,{coordinates:WI(UV)});function XV(n,e){return _n(null,xpe,n,e)}function _pe(n,e){const r=e[e.length-1].coordinates,i=bo(n,!1),a=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(a){const o=parseFloat(a[1]),l=parseFloat(a[2]),c=parseFloat(a[3]);r.push([o,l,c])}else r.push([])}const vpe=gt(_c,{Track:uo(qV)});function wpe(n,e){const t=_n([],vpe,n,e);if(t)return new nc(t)}const Epe=gt(Pt,{when:Kpe},gt(_c,{coord:_pe}));function qV(n,e){const t=_n({coordinates:[],whens:[]},Epe,n,e);if(!t)return;const r=[],i=t.coordinates,s=t.whens;for(let a=0,o=Math.min(i.length,s.length);a<o;++a)i[a].length==3&&r.push(i[a][0],i[a][1],i[a][2],s[a]);return new Ti(r,"XYZM")}const Spe=gt(Pt,{href:ze($V)},gt(_c,{x:ze(Pn),y:ze(Pn),w:ze(Pn),h:ze(Pn)}));function Tpe(n,e){const t=_n({},Spe,n,e);return t||null}const bpe=gt(Pt,{coordinates:WI(UV)});function ZI(n,e){return _n(null,bpe,n,e)}const TE=gt(Pt,{extrude:ze(Bu),tessellate:ze(Bu),altitudeMode:ze(ln)});function YV(n,e){const t=_n({},TE,n,e),r=ZI(n,e);if(r){const i=new Ti(r,"XYZ");return i.setProperties(t,!0),i}}function ZV(n,e){const t=_n({},TE,n,e),r=ZI(n,e);if(r){const i=new Ga(r,"XYZ",[r.length]);return i.setProperties(t,!0),i}}const Rpe=gt(Pt,{LineString:uo(YV),LinearRing:uo(ZV),MultiGeometry:uo(JV),Point:uo(QV),Polygon:uo(eB)});function JV(n,e){const t=_n([],Rpe,n,e);if(!t)return null;if(t.length===0)return new po(t);let r,i=!0;const s=t[0].getType();let a;for(let o=1,l=t.length;o<l;++o)if(a=t[o],a.getType()!=s){i=!1;break}if(i){let o,l;if(s=="Point"){const c=t[0];o=c.getLayout(),l=c.getFlatCoordinates();for(let h=1,g=t.length;h<g;++h)a=t[h],Bn(l,a.getFlatCoordinates());r=new Id(l,o),AT(r,t)}else if(s=="LineString")r=new nc(t),AT(r,t);else if(s=="Polygon")r=new ad(t),AT(r,t);else if(s=="GeometryCollection"||s.startsWith("Multi"))r=new po(t);else throw new Error("Unknown geometry type found")}else r=new po(t);return r}function QV(n,e){const t=_n({},TE,n,e),r=ZI(n,e);if(r){const i=new gi(r,"XYZ");return i.setProperties(t,!0),i}}const Ape=gt(Pt,{innerBoundaryIs:Upe,outerBoundaryIs:Wpe});function eB(n,e){const t=_n({},TE,n,e),r=_n([null],Ape,n,e);if(r&&r[0]){const i=r[0],s=[i.length];for(let o=1,l=r.length;o<l;++o)Bn(i,r[o]),s.push(i.length);const a=new Ga(i,"XYZ",s);return a.setProperties(t,!0),a}}const kpe=gt(Pt,{IconStyle:hpe,LabelStyle:fpe,LineStyle:mpe,PolyStyle:ype});function JI(n,e){const t=_n({},kpe,n,e,this);if(!t)return null;let r="fillStyle"in t?t.fillStyle:E_;const i=t.fill;i!==void 0&&!i&&(r=null);let s;"imageStyle"in t?t.imageStyle!=YI&&(s=t.imageStyle):s=CR;const a="textStyle"in t?t.textStyle:Wh,o="strokeStyle"in t?t.strokeStyle:PR,l=t.outline;return l!==void 0&&!l?[new mn({geometry:function(c){const h=c.getGeometry(),g=h.getType();if(g==="GeometryCollection"){const m=h;return new po(m.getGeometriesArrayRecursive().filter(function(y){const v=y.getType();return v!=="Polygon"&&v!=="MultiPolygon"}))}if(g!=="Polygon"&&g!=="MultiPolygon")return h},fill:r,image:s,stroke:o,text:a,zIndex:void 0}),new mn({geometry:function(c){const h=c.getGeometry(),g=h.getType();if(g==="GeometryCollection"){const m=h;return new po(m.getGeometriesArrayRecursive().filter(function(y){const v=y.getType();return v==="Polygon"||v==="MultiPolygon"}))}if(g==="Polygon"||g==="MultiPolygon")return h},fill:r,stroke:null,zIndex:void 0})]:[new mn({fill:r,image:s,stroke:o,text:a,zIndex:void 0})]}function AT(n,e){const t=e.length,r=new Array(e.length),i=new Array(e.length),s=new Array(e.length);let a,o,l;a=!1,o=!1,l=!1;for(let c=0;c<t;++c){const h=e[c];r[c]=h.get("extrude"),i[c]=h.get("tessellate"),s[c]=h.get("altitudeMode"),a=a||r[c]!==void 0,o=o||i[c]!==void 0,l=l||s[c]}a&&n.set("extrude",r),o&&n.set("tessellate",i),l&&n.set("altitudeMode",s)}const Ipe=gt(Pt,{displayName:ze(ln),value:ze(ln)});function Cpe(n,e){const t=n.getAttribute("name");Yu(Ipe,n,e);const r=e[e.length-1];t&&r.displayName?r[t]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:t!==null?r[t]=r.value:r.displayName!==null&&(r[r.displayName]=r.value),delete r.value}const Ppe=gt(Pt,{Data:Cpe,SchemaData:Dpe});function tB(n,e){Yu(Ppe,n,e)}function nB(n,e){Yu(GV,n,e)}const Mpe=gt(Pt,{Style:ze(JI),key:ze(ln),styleUrl:ze(WV)});function Npe(n,e){const t=_n({},Mpe,n,e,this);if(!t)return;const r=t.key;if(r&&r=="normal"){const i=t.styleUrl;i&&(e[e.length-1]=i);const s=t.Style;s&&(e[e.length-1]=s)}}function Lpe(n,e){const t=KV.call(this,n,e);if(!t)return;const r=e[e.length-1];if(Array.isArray(t))r.Style=t;else if(typeof t=="string")r.styleUrl=t;else throw new Error("`styleMapValue` has an unknown type")}const Ope=gt(Pt,{SimpleData:Fpe});function Dpe(n,e){Yu(Ope,n,e)}function Fpe(n,e){const t=n.getAttribute("name");if(t!==null){const r=ln(n),i=e[e.length-1];i[t]=r}}const jpe=gt(Pt,{altitudeMode:ze(ln),minAltitude:ze(Pn),maxAltitude:ze(Pn),north:ze(Pn),south:ze(Pn),east:ze(Pn),west:ze(Pn)});function Vpe(n,e){const t=_n({},jpe,n,e);if(!t)return;const r=e[e.length-1],i=[parseFloat(t.west),parseFloat(t.south),parseFloat(t.east),parseFloat(t.north)];r.extent=i,r.altitudeMode=t.altitudeMode,r.minAltitude=parseFloat(t.minAltitude),r.maxAltitude=parseFloat(t.maxAltitude)}const Bpe=gt(Pt,{minLodPixels:ze(Pn),maxLodPixels:ze(Pn),minFadeExtent:ze(Pn),maxFadeExtent:ze(Pn)});function Gpe(n,e){const t=_n({},Bpe,n,e);if(!t)return;const r=e[e.length-1];r.minLodPixels=parseFloat(t.minLodPixels),r.maxLodPixels=parseFloat(t.maxLodPixels),r.minFadeExtent=parseFloat(t.minFadeExtent),r.maxFadeExtent=parseFloat(t.maxFadeExtent)}const zpe=gt(Pt,{LinearRing:uo(XV)});function Upe(n,e){const t=_n([],zpe,n,e);t.length>0&&e[e.length-1].push(...t)}const $pe=gt(Pt,{LinearRing:WI(XV)});function Wpe(n,e){const t=_n(void 0,$pe,n,e);if(t){const r=e[e.length-1];r[0]=t}}function Hpe(n,e){Yu(Qme,n,e)}function Kpe(n,e){const r=e[e.length-1].whens,i=bo(n,!1),s=Date.parse(i);r.push(isNaN(s)?0:s)}function bE(n,e){const t=Ba(e),i=[(t.length==4?t[3]:1)*255,t[2],t[1],t[0]];for(let s=0;s<4;++s){const a=Math.floor(i[s]).toString(16);i[s]=a.length==1?"0"+a:a}Dn(n,i.join(""))}function Xpe(n,e,t){const r=t[t.length-1],i=r.layout,s=r.stride;let a;if(i=="XY"||i=="XYM")a=2;else if(i=="XYZ"||i=="XYZM")a=3;else throw new Error("Invalid geometry layout");const o=e.length;let l="";if(o>0){l+=e[0];for(let c=1;c<a;++c)l+=","+e[c];for(let c=s;c<o;c+=s){l+=" "+e[c];for(let h=1;h<a;++h)l+=","+e[c+h]}}Dn(n,l)}const S_=gt(Pt,{Data:tt(qpe),value:tt(Zpe),displayName:tt(Ype)});function qpe(n,e,t){n.setAttribute("name",e.name);const r={node:n},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&or(r,S_,hs,[i.displayName],t,["displayName"]),i!==null&&i.value&&or(r,S_,hs,[i.value],t,["value"])):or(r,S_,hs,[i],t,["value"])}function Ype(n,e){Dn(n,e)}function Zpe(n,e){Dn(n,e)}const Jpe=gt(Pt,{Placemark:tt(sB)}),Qpe=function(n,e,t){const r=e[e.length-1].node;return Dd(r.namespaceURI,"Placemark")};function eye(n,e,t){or({node:n},Jpe,Qpe,e,t,void 0,this)}const tye=Ro("Data");function nye(n,e,t){const r={node:n},i=e.names,s=e.values,a=i.length;for(let o=0;o<a;o++)or(r,S_,tye,[{name:i[o],value:s[o]}],t)}const n5=gt(Pt,["href"],gt(_c,["x","y","w","h"])),r5=gt(Pt,{href:tt(Dn)},gt(_c,{x:tt(Ns),y:tt(Ns),w:tt(Ns),h:tt(Ns)})),rye=function(n,e,t){return Dd(_c[0],"gx:"+t)};function iye(n,e,t){const r={node:n},i=t[t.length-1].node;let s=n5[i.namespaceURI],a=Ws(e,s);or(r,r5,hs,a,t,s),s=n5[_c[0]],a=Ws(e,s),or(r,r5,rye,a,t,s)}const sye=gt(Pt,["scale","heading","Icon","color","hotSpot"]),aye=gt(Pt,{Icon:tt(iye),color:tt(bE),heading:tt(Ns),hotSpot:tt(Nye),scale:tt(oB)});function oye(n,e,t){const r={node:n},i={},s=e.getSrc(),a=e.getSize(),o=e.getImageSize(),l={href:s};if(a){l.w=a[0],l.h=a[1];const E=e.getAnchor(),T=e.getOrigin();if(T&&o&&T[0]!==0&&T[1]!==a[1]&&(l.x=T[0],l.y=o[1]-(T[1]+a[1])),E&&(E[0]!==a[0]/2||E[1]!==a[1]/2)){const b={x:E[0],xunits:"pixels",y:a[1]-E[1],yunits:"pixels"};i.hotSpot=b}}i.Icon=l;let c=e.getScaleArray()[0],h=a;if(h===null&&(h=rp),h.length==2){const E=Kv(h);c=c/E}c!==1&&(i.scale=c);const g=e.getRotation();g!==0&&(i.heading=g);const m=e.getColor();m&&(i.color=m);const y=t[t.length-1].node,v=sye[y.namespaceURI],_=Ws(i,v);or(r,aye,hs,_,t,v)}const lye=gt(Pt,["color","scale"]),cye=gt(Pt,{color:tt(bE),scale:tt(oB)});function uye(n,e,t){const r={node:n},i={},s=e.getFill();s&&(i.color=s.getColor());const a=e.getScale();a&&a!==1&&(i.scale=a);const o=t[t.length-1].node,l=lye[o.namespaceURI],c=Ws(i,l);or(r,cye,hs,c,t,l)}const hye=gt(Pt,["color","width"]),dye=gt(Pt,{color:tt(bE),width:tt(Ns)});function fye(n,e,t){const r={node:n},i={color:e.getColor(),width:Number(e.getWidth())||1},s=t[t.length-1].node,a=hye[s.namespaceURI],o=Ws(i,a);or(r,dye,hs,o,t,a)}const gye={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},rB=function(n,e,t){if(n){const r=e[e.length-1].node;return Dd(r.namespaceURI,gye[n.getType()])}},mye=Ro("Point"),pye=Ro("LineString"),yye=Ro("LinearRing"),xye=Ro("Polygon"),_ye=gt(Pt,{LineString:tt(E0),Point:tt(E0),Polygon:tt(aB),GeometryCollection:tt(iB)});function iB(n,e,t){const r={node:n},i=e.getType();let s=[],a;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(o){const l=o.getType();if(l==="MultiPoint")s=s.concat(o.getPoints());else if(l==="MultiLineString")s=s.concat(o.getLineStrings());else if(l==="MultiPolygon")s=s.concat(o.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")s.push(o);else throw new Error("Unknown geometry type")}),a=rB;else if(i==="MultiPoint")s=e.getPoints(),a=mye;else if(i==="MultiLineString")s=e.getLineStrings(),a=pye;else if(i==="MultiPolygon")s=e.getPolygons(),a=xye;else throw new Error("Unknown geometry type");or(r,_ye,a,s,t)}const vye=gt(Pt,{LinearRing:tt(E0)});function i5(n,e,t){or({node:n},vye,yye,[e],t)}const kT=gt(Pt,{ExtendedData:tt(nye),MultiGeometry:tt(iB),LineString:tt(E0),LinearRing:tt(E0),Point:tt(E0),Polygon:tt(aB),Style:tt(Mye),address:tt(Dn),description:tt(Dn),name:tt(Dn),open:tt(eg),phoneNumber:tt(Dn),styleUrl:tt(Dn),visibility:tt(eg)}),wye=gt(Pt,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),Eye=Ro("ExtendedData");function sB(n,e,t){const r={node:n};e.getId()&&n.setAttribute("id",e.getId());const i=e.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[e.getGeometryName()]=1;const a=Object.keys(i||{}).sort().filter(function(y){return!s[y]}),o=e.getStyleFunction();if(o){const y=o(e,0);if(y){const v=Array.isArray(y)?y:[y];let _=v;if(e.getGeometry()&&(_=v.filter(function(E){const T=E.getGeometryFunction()(e);if(T){const b=T.getType();return b==="GeometryCollection"?T.getGeometriesArrayRecursive().filter(function(R){const N=R.getType();return N==="Point"||N==="MultiPoint"}).length:b==="Point"||b==="MultiPoint"}})),this.writeStyles_){let E=v,T=v;e.getGeometry()&&(E=v.filter(function(b){const R=b.getGeometryFunction()(e);if(R){const N=R.getType();return N==="GeometryCollection"?R.getGeometriesArrayRecursive().filter(function(D){const W=D.getType();return W==="LineString"||W==="MultiLineString"}).length:N==="LineString"||N==="MultiLineString"}}),T=v.filter(function(b){const R=b.getGeometryFunction()(e);if(R){const N=R.getType();return N==="GeometryCollection"?R.getGeometriesArrayRecursive().filter(function(D){const W=D.getType();return W==="Polygon"||W==="MultiPolygon"}).length:N==="Polygon"||N==="MultiPolygon"}})),i.Style={pointStyles:_,lineStyles:E,polyStyles:T}}if(_.length&&i.name===void 0){const E=_[0].getText();E&&(i.name=E.getText())}}}const l=t[t.length-1].node,c=wye[l.namespaceURI],h=Ws(i,c);if(or(r,kT,hs,h,t,c),a.length>0){const y=Ws(i,a);or(r,kT,Eye,[{names:a,values:y}],t)}const g=t[0];let m=e.getGeometry();m&&(m=To(m,!0,g)),or(r,kT,rB,[m],t)}const Sye=gt(Pt,["extrude","tessellate","altitudeMode","coordinates"]),Tye=gt(Pt,{extrude:tt(eg),tessellate:tt(eg),altitudeMode:tt(Dn),coordinates:tt(Xpe)});function E0(n,e,t){const r=e.getFlatCoordinates(),i={node:n};i.layout=e.getLayout(),i.stride=e.getStride();const s=e.getProperties();s.coordinates=r;const a=t[t.length-1].node,o=Sye[a.namespaceURI],l=Ws(s,o);or(i,Tye,hs,l,t,o)}const bye=gt(Pt,["color","fill","outline"]),s5=gt(Pt,{outerBoundaryIs:tt(i5),innerBoundaryIs:tt(i5)}),Rye=Ro("innerBoundaryIs"),Aye=Ro("outerBoundaryIs");function aB(n,e,t){const r=e.getLinearRings(),i=r.shift(),s={node:n};or(s,s5,Rye,r,t),or(s,s5,Aye,[i],t)}const kye=gt(Pt,{color:tt(bE),fill:tt(eg),outline:tt(eg)});function Iye(n,e,t){const r={node:n},i=e.getFill(),s=e.getStroke(),a={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:s?void 0:!1},o=t[t.length-1].node,l=bye[o.namespaceURI],c=Ws(a,l);or(r,kye,hs,c,t,l)}function oB(n,e){Ns(n,Math.round(e*1e6)/1e6)}const Cye=gt(Pt,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),Pye=gt(Pt,{IconStyle:tt(oye),LabelStyle:tt(uye),LineStyle:tt(fye),PolyStyle:tt(Iye)});function Mye(n,e,t){const r={node:n},i={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(i.LabelStyle=l);const c=e.pointStyles[0].getImage();c&&typeof c.getSrc=="function"&&(i.IconStyle=c)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(i.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!i.LineStyle&&(i.LineStyle=l),i.PolyStyle=e.polyStyles[0]}const s=t[t.length-1].node,a=Cye[s.namespaceURI],o=Ws(i,a);or(r,Pye,hs,o,t,a)}function Nye(n,e){n.setAttribute("x",String(e.x)),n.setAttribute("y",String(e.y)),n.setAttribute("xunits",e.xunits),n.setAttribute("yunits",e.yunits)}function lB(n){const e=Object.keys(n.defs),t=e.length;let r,i;for(r=0;r<t;++r){const s=e[r];if(!qx(s)){const a=n.defs(s);let o=a.units;!o&&a.projName==="longlat"&&(o="degrees"),C_(new mw({code:s,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:o}))}}for(r=0;r<t;++r){const s=e[r],a=qx(s);for(i=0;i<t;++i){const o=e[i],l=qx(o);if(!Yx(s,o))if(n.defs[s]===n.defs[o])qT([a,l]);else{const c=n(s,o);QU(a,l,Z4(a,l,c.forward),Z4(l,a,c.inverse))}}}}console.log(" parcelHighlight.ts v3.1 loaded - fixed pixelRatio for Android");Sn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");lB(Sn);let Hh=null,ip=null,Yf=null;function LR(n){Hh&&(n.removeLayer(Hh),Hh=null),ip&&(n.removeLayer(ip),ip=null),Yf=null}async function Lye(n,e){try{const t=En(e);console.log(` Click (3857): ${e[0].toFixed(0)}, ${e[1].toFixed(0)}`),console.log(` LonLat (WGS84): ${t[0].toFixed(5)}, ${t[1].toFixed(5)}`);const r=Sn("EPSG:4326","EPSG:28992",t);if(console.log(` RD (28992): ${r?r[0].toFixed(0)+", "+r[1].toFixed(0):"FAILED"}`),!r||r[0]<7e3||r[0]>3e5||r[1]<289e3||r[1]>629e3)return console.error(" Coordinate outside Netherlands or transformation failed:",r),!1;LR(n);const i=1,s=`${r[0]-i},${r[1]-i},${r[0]+i},${r[1]+i}`,a=Date.now(),o=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&BBOX=${s},EPSG:28992&_=${a}`;console.log(" WFS URL:",o);const l=new AbortController,c=setTimeout(()=>l.abort(),1e4),h=await fetch(o,{signal:l.signal});if(clearTimeout(c),!h.ok)return console.error("WFS request failed:",h.status),!1;const g=await h.json();if(console.log(" WFS RESPONSE:",JSON.stringify(g).substring(0,500)),!g.features||g.features.length===0)return console.log("No parcel found at location"),!1;const m=g.features[0];console.log(" PARCEL ID:",m.id||m.properties?.id||"geen ID"),console.log(" PARCEL BBOX:",JSON.stringify(m.bbox||"geen bbox"));const v=new UI().readFeature(m,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),_=v.getGeometry();if(!_)return console.log("No geometry in parcel feature"),!1;const E=m.properties||{};console.log(` Parcel: ${E.category||"unknown"} - ${E.gewasnaam||E.gewas||"geen gewas"}`),console.log(` Geometry type: ${_.getType()}, extent: ${_.getExtent().map(M=>M.toFixed(0)).join(", ")}`);const T=_.getExtent(),b=T[2]-T[0],R=T[3]-T[1],N=Math.max(b,R)*.05,D=[T[0]-N,T[1]-N,T[2]+N,T[3]+N],W=Math.max(b,R)*.3,I=[T[0]-W,T[1]-W,T[2]+W,T[3]+W];Yf=_,Hh=new BK({source:new fX({url:"https://ahn.arcgisonline.nl/arcgis/rest/services/Hoogtebestand/AHN4_DTM_50cm/ImageServer",params:{renderingRule:JSON.stringify({rasterFunction:"AHN - Color Ramp D"})},crossOrigin:"anonymous"}),extent:D,zIndex:998}),Hh.on("prerender",M=>{if(!Yf)return;const O=M.context;if(!O)return;const L=M.frameState;if(!L)return;O.save(),O.beginPath(),(Yf.getType()==="Polygon"?Yf.getCoordinates()[0]:Yf.getCoordinates()[0][0]).forEach((j,Ee)=>{const Ce=n.getPixelFromCoordinate(j);if(!Ce)return;const Ge=L.pixelRatio,Le=Ce[0]*Ge,ce=Ce[1]*Ge;Ee===0?O.moveTo(Le,ce):O.lineTo(Le,ce)}),O.closePath(),O.clip()}),Hh.on("postrender",M=>{const O=M.context;O&&O.restore()}),n.addLayer(Hh);const A=new dc({features:[v]});return ip=new $u({source:A,style:new mn({fill:new tr({color:"rgba(0, 0, 0, 0)"}),stroke:new qn({color:"#dc2626",width:3})}),zIndex:999}),n.addLayer(ip),console.log(" Parcel height map displayed"),!0}catch(t){return console.error("Failed to show parcel height map:",t),!1}}var Xv={};Xv.version="0.18.5";var cB=1252,Oye=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],uB=function(n){Oye.indexOf(n)!=-1&&(cB=n)};function Dye(){uB(1252)}var ey=function(n){uB(n)};function Fye(){ey(1200),Dye()}var Bx=function(e){return String.fromCharCode(e)},a5=function(e){return String.fromCharCode(e)},qv,pu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ty(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0,c=0;c<n.length;)t=n.charCodeAt(c++),s=t>>2,r=n.charCodeAt(c++),a=(t&3)<<4|r>>4,i=n.charCodeAt(c++),o=(r&15)<<2|i>>6,l=i&63,isNaN(r)?o=l=64:isNaN(i)&&(l=64),e+=pu.charAt(s)+pu.charAt(a)+pu.charAt(o)+pu.charAt(l);return e}function cc(n){var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<n.length;)s=pu.indexOf(n.charAt(c++)),a=pu.indexOf(n.charAt(c++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=pu.indexOf(n.charAt(c++)),r=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(r)),l=pu.indexOf(n.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var On=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),vc=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Ed(n){return On?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function o5(n){return On?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var ho=function(e){return On?vc(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function RE(n){if(typeof ArrayBuffer>"u")return ho(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),r=0;r!=n.length;++r)t[r]=n.charCodeAt(r)&255;return e}function Qy(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function jye(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var $i=On?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:vc(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0,t=0;e<n.length;t+=i,++e)if(i=n[e].length,n[e]instanceof Uint8Array)r.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";r.set(new Uint8Array(n[e]),t)}return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Vye(n){for(var e=[],t=0,r=n.length+250,i=Ed(n.length+255),s=0;s<n.length;++s){var a=n.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=n.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>r&&(e.push(i.slice(0,t)),t=0,i=Ed(65535),r=65530)}return e.push(i.slice(0,t)),$i(e)}var sp=/\u0000/g,Gx=/[\u0001-\u0006]/g;function S0(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function mo(n,e){var t=""+n;return t.length>=e?t:jr("0",e-t.length)+t}function QI(n,e){var t=""+n;return t.length>=e?t:jr(" ",e-t.length)+t}function Yv(n,e){var t=""+n;return t.length>=e?t:t+jr(" ",e-t.length)}function Bye(n,e){var t=""+Math.round(n);return t.length>=e?t:jr("0",e-t.length)+t}function Gye(n,e){var t=""+n;return t.length>=e?t:jr("0",e-t.length)+t}var l5=Math.pow(2,32);function Df(n,e){if(n>l5||n<-l5)return Bye(n,e);var t=Math.round(n);return Gye(t,e)}function Zv(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var c5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],IT=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function zye(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var Br={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},u5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Uye={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Jv(n,e,t){for(var r=n<0?-1:1,i=n*r,s=0,a=1,o=0,l=1,c=0,h=0,g=Math.floor(i);c<e&&(g=Math.floor(i),o=g*a+s,h=g*c+l,!(i-g<5e-8));)i=1/(i-g),s=a,a=o,l=c,c=h;if(h>e&&(c>e?(h=l,o=s):(h=c,o=a)),!t)return[0,r*o,h];var m=Math.floor(r*o/h);return[m,r*o-m*h,h]}function zx(n,e,t){if(n>2958465||n<0)return null;var r=n|0,i=Math.floor(86400*(n-r)),s=0,a=[],o={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++r,++o.D)),r===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),t&&(s=Yye(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var hB=new Date(1899,11,31,0,0,0),$ye=hB.getTime(),Wye=new Date(1900,2,1,0,0,0);function dB(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=Wye&&(t+=1440*60*1e3),(t-($ye+(n.getTimezoneOffset()-hB.getTimezoneOffset())*6e4))/(1440*60*1e3)}function eC(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Hye(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Kye(n){var e=n<0?12:11,t=eC(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function Xye(n){var e=eC(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function qye(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=Kye(n):e===10?t=n.toFixed(10).substr(0,12):t=Xye(n),eC(Hye(t.toUpperCase()))}function OR(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):qye(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return Gu(14,dB(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function Yye(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function Zye(n,e,t,r){var i="",s=0,a=0,o=t.y,l,c=0;switch(n){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,c=e.length;break;case 3:return IT[t.m-1][1];case 5:return IT[t.m-1][0];default:return IT[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,c=e.length;break;case 3:return c5[t.q][0];default:return c5[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?mo(t.S,e.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=mo(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var h=c>0?mo(l,c):"";return h}function yu(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var fB=/%/g;function Jye(n,e,t){var r=e.replace(fB,""),i=e.length-r.length;return Ql(n,r,t*Math.pow(10,2*i))+jr("%",i)}function Qye(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Ql(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function gB(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+gB(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var mB=/# (\?+)( ?)\/( ?)(\d+)/;function e1e(n,e,t){var r=parseInt(n[4],10),i=Math.round(e*r),s=Math.floor(i/r),a=i-s*r,o=r;return t+(s===0?"":""+s)+" "+(a===0?jr(" ",n[1].length+1+n[4].length):QI(a,n[1].length)+n[2]+"/"+n[3]+mo(o,n[4].length))}function t1e(n,e,t){return t+(e===0?"":""+e)+jr(" ",n[1].length+2+n[4].length)}var pB=/^#*0*\.([0#]+)/,yB=/\).*[0#]/,xB=/\(###\) ###\\?-####/;function ps(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function h5(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function d5(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function n1e(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function r1e(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Aa(n,e,t){if(n.charCodeAt(0)===40&&!e.match(yB)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Aa("n",r,t):"("+Aa("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Qye(n,e,t);if(e.indexOf("%")!==-1)return Jye(n,e,t);if(e.indexOf("E")!==-1)return gB(e,t);if(e.charCodeAt(0)===36)return"$"+Aa(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+Df(l,e.length);if(e.match(/^[#?]+$/))return i=Df(t,0),i==="0"&&(i=""),i.length>e.length?i:ps(e.substr(0,e.length-i.length))+i;if(s=e.match(mB))return e1e(s,l,c);if(e.match(/^#+0+$/))return c+Df(l,e.length-e.indexOf("0"));if(s=e.match(pB))return i=h5(t,s[1].length).replace(/^([^\.]+)$/,"$1."+ps(s[1])).replace(/\.$/,"."+ps(s[1])).replace(/\.(\d*)$/,function(v,_){return"."+_+jr("0",ps(s[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+h5(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+yu(Df(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Aa(n,e,-t):yu(""+(Math.floor(t)+n1e(t,s[1].length)))+"."+mo(d5(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Aa(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=S0(Aa(n,e.replace(/[\\-]/g,""),t)),a=0,S0(S0(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(xB))return i=Aa(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Jv(l,Math.pow(10,a)-1,!1),i=""+c,h=Ql("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Yv(o[2],a),h.length<s[4].length&&(h=ps(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Jv(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?QI(o[1],a)+s[2]+"/"+s[3]+Yv(o[2],a):jr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Df(t,0),e.length<=i.length?i:ps(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var g=e.indexOf(".")-a,m=e.length-i.length-g;return ps(e.substr(0,g)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=d5(t,s[1].length),t<0?"-"+Aa(n,e,-t):yu(r1e(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?mo(0,3-v.length):"")+v})+"."+mo(a,s[1].length);switch(e){case"###,##0.00":return Aa(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=yu(Df(l,0));return y!=="0"?c+y:"";case"###,###.00":return Aa(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Aa(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function i1e(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Ql(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function s1e(n,e,t){var r=e.replace(fB,""),i=e.length-r.length;return Ql(n,r,t*Math.pow(10,2*i))+jr("%",i)}function _B(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+_B(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function $o(n,e,t){if(n.charCodeAt(0)===40&&!e.match(yB)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?$o("n",r,t):"("+$o("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return i1e(n,e,t);if(e.indexOf("%")!==-1)return s1e(n,e,t);if(e.indexOf("E")!==-1)return _B(e,t);if(e.charCodeAt(0)===36)return"$"+$o(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+mo(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:ps(e.substr(0,e.length-i.length))+i;if(s=e.match(mB))return t1e(s,l,c);if(e.match(/^#+0+$/))return c+mo(l,e.length-e.indexOf("0"));if(s=e.match(pB))return i=(""+t).replace(/^([^\.]+)$/,"$1."+ps(s[1])).replace(/\.$/,"."+ps(s[1])),i=i.replace(/\.(\d*)$/,function(v,_){return"."+_+jr("0",ps(s[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+yu(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+$o(n,e,-t):yu(""+t)+"."+jr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return $o(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=S0($o(n,e.replace(/[\\-]/g,""),t)),a=0,S0(S0(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(xB))return i=$o(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Jv(l,Math.pow(10,a)-1,!1),i=""+c,h=Ql("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Yv(o[2],a),h.length<s[4].length&&(h=ps(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Jv(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?QI(o[1],a)+s[2]+"/"+s[3]+Yv(o[2],a):jr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:ps(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var g=e.indexOf(".")-a,m=e.length-i.length-g;return ps(e.substr(0,g)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+$o(n,e,-t):yu(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?mo(0,3-v.length):"")+v})+"."+mo(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=yu(""+l);return y!=="0"?c+y:"";default:if(e.match(/\.[0#?]*$/))return $o(n,e.slice(0,e.lastIndexOf(".")),t)+ps(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ql(n,e,t){return(t|0)===t?$o(n,e,t):Aa(n,e,t)}function a1e(n){for(var e=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(i,r-i),i=r+1}if(e[e.length]=n.substr(i),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var vB=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function wB(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":Zv(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match(vB))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function o1e(n,e,t,r){for(var i=[],s="",a=0,o="",l="t",c,h,g,m="H";a<n.length;)switch(o=n.charAt(a)){case"G":if(!Zv(n,a))throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(g=n.charCodeAt(++a))!==34&&a<n.length;)s+=String.fromCharCode(g);i[i.length]={t:"t",v:s},++a;break;case"\\":var y=n.charAt(++a),v=y==="("||y===")"?y:"t";i[i.length]={t:v,v:y},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(n.charAt(a+1)==="1"||n.charAt(a+1)==="2"){if(c==null&&(c=zx(e,t,n.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:n.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=zx(e,t),c==null))return"";for(s=o;++a<n.length&&n.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var _={t:o,v:o};if(c==null&&(c=zx(e,t)),n.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(_.v=c.H>=12?"P":"A"),_.t="T",m="h",a+=3):n.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(_.v=c.H>=12?"PM":"AM"),_.t="T",a+=5,m="h"):n.substr(a,5).toUpperCase()==="/"?(c!=null&&(_.v=c.H>=12?"":""),_.t="T",a+=5,m="h"):(_.t="t",++a),c==null&&_.t==="T")return"";i[i.length]=_,l=o;break;case"[":for(s=o;n.charAt(a++)!=="]"&&a<n.length;)s+=n.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(vB)){if(c==null&&(c=zx(e,t),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",wB(n)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<n.length&&(o=n.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<n.length&&"0#?.,E+-%".indexOf(o=n.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;n.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(n.charAt(a)==" "||n.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:r===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<n.length&&"0123456789".indexOf(n.charAt(++a))>-1;)s+=n.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"t",v:o},++a;break}var E=0,T=0,b;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=m,l="h",E<1&&(E=1);break;case"s":(b=i[a].v.match(/\.0+$/))&&(T=Math.max(T,b[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var R="",N;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=Zye(i[a].t.charCodeAt(0),i[a].v,c,T),i[a].t="t";break;case"n":case"?":for(N=a+1;i[N]!=null&&((o=i[N].t)==="?"||o==="D"||(o===" "||o==="t")&&i[N+1]!=null&&(i[N+1].t==="?"||i[N+1].t==="t"&&i[N+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[N].v==="/"||i[N].v===" "&&i[N+1]!=null&&i[N+1].t=="?"));)i[a].v+=i[N].v,i[N]={v:"",t:";"},++N;R+=i[a].v,a=N-1;break;case"G":i[a].t="t",i[a].v=OR(e,t);break}var D="",W,I;if(R.length>0){R.charCodeAt(0)==40?(W=e<0&&R.charCodeAt(0)===45?-e:e,I=Ql("n",R,W)):(W=e<0&&r>1?-e:e,I=Ql("n",R,W),W<0&&i[0]&&i[0].t=="t"&&(I=I.substr(1),i[0].v="-"+i[0].v)),N=I.length-1;var A=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){A=a;break}var M=i.length;if(A===i.length&&I.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(N>=i[a].v.length-1?(N-=i[a].v.length,i[a].v=I.substr(N+1,i[a].v.length)):N<0?i[a].v="":(i[a].v=I.substr(0,N+1),N=-1),i[a].t="t",M=a);N>=0&&M<i.length&&(i[M].v=I.substr(0,N+1)+i[M].v)}else if(A!==i.length&&I.indexOf("E")===-1){for(N=I.indexOf(".")-1,a=A;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===A?i[a].v.indexOf(".")-1:i[a].v.length-1,D=i[a].v.substr(h+1);h>=0;--h)N>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(D=I.charAt(N--)+D);i[a].v=D,i[a].t="t",M=a}for(N>=0&&M<i.length&&(i[M].v=I.substr(0,N+1)+i[M].v),N=I.indexOf(".")+1,a=A;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==A)){for(h=i[a].v.indexOf(".")>-1&&a===A?i[a].v.indexOf(".")+1:0,D=i[a].v.substr(0,h);h<i[a].v.length;++h)N<I.length&&(D+=I.charAt(N++));i[a].v=D,i[a].t="t",M=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(W=r>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Ql(i[a].t,i[a].v,W),i[a].t="t");var O="";for(a=0;a!==i.length;++a)i[a]!=null&&(O+=i[a].v);return O}var f5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function g5(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function l1e(n,e){var t=a1e(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(f5),o=t[1].match(f5);return g5(e,a)?[r,t[0]]:g5(e,o)?[r,t[1]]:[r,t[a!=null&&o!=null?2:1]]}return[r,s]}function Gu(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:Br)[n],r==null&&(r=t.table&&t.table[u5[n]]||Br[u5[n]]),r==null&&(r=Uye[n]||"General");break}if(Zv(r,0))return OR(e,t);e instanceof Date&&(e=dB(e,t.date1904));var i=l1e(r,e);if(Zv(i[1]))return OR(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return o1e(i[1],e,t,i[0])}function EB(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Br[t]==null){e<0&&(e=t);continue}if(Br[t]==n){e=t;break}}e<0&&(e=391)}return Br[e]=n,e}function AE(n){for(var e=0;e!=392;++e)n[e]!==void 0&&EB(n[e],e)}function kE(){Br=zye()}var SB=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function c1e(n){var e=typeof n=="number"?Br[n]:n;return e=e.replace(SB,"(\\d+)"),new RegExp("^"+e+"$")}function u1e(n,e,t){var r=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(SB)||[]).forEach(function(g,m){var y=parseInt(t[m+1],10);switch(g.toLowerCase().charAt(0)){case"y":r=y;break;case"d":s=y;break;case"h":a=y;break;case"s":l=y;break;case"m":a>=0?o=y:i=y;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:r==-1&&i==-1&&s==-1?h:c+"T"+h}var h1e=(function(){var n={};n.version="1.2.0";function e(){for(var I=0,A=new Array(256),M=0;M!=256;++M)I=M,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,A[M]=I;return typeof Int32Array<"u"?new Int32Array(A):A}var t=e();function r(I){var A=0,M=0,O=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)L[O]=I[O];for(O=0;O!=256;++O)for(M=I[O],A=256+O;A<4096;A+=256)M=L[A]=M>>>8^I[M&255];var z=[];for(O=1;O!=16;++O)z[O-1]=typeof Int32Array<"u"?L.subarray(O*256,O*256+256):L.slice(O*256,O*256+256);return z}var i=r(t),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],h=i[5],g=i[6],m=i[7],y=i[8],v=i[9],_=i[10],E=i[11],T=i[12],b=i[13],R=i[14];function N(I,A){for(var M=A^-1,O=0,L=I.length;O<L;)M=M>>>8^t[(M^I.charCodeAt(O++))&255];return~M}function D(I,A){for(var M=A^-1,O=I.length-15,L=0;L<O;)M=R[I[L++]^M&255]^b[I[L++]^M>>8&255]^T[I[L++]^M>>16&255]^E[I[L++]^M>>>24]^_[I[L++]]^v[I[L++]]^y[I[L++]]^m[I[L++]]^g[I[L++]]^h[I[L++]]^c[I[L++]]^l[I[L++]]^o[I[L++]]^a[I[L++]]^s[I[L++]]^t[I[L++]];for(O+=15;L<O;)M=M>>>8^t[(M^I[L++])&255];return~M}function W(I,A){for(var M=A^-1,O=0,L=I.length,z=0,j=0;O<L;)z=I.charCodeAt(O++),z<128?M=M>>>8^t[(M^z)&255]:z<2048?(M=M>>>8^t[(M^(192|z>>6&31))&255],M=M>>>8^t[(M^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,j=I.charCodeAt(O++)&1023,M=M>>>8^t[(M^(240|z>>8&7))&255],M=M>>>8^t[(M^(128|z>>2&63))&255],M=M>>>8^t[(M^(128|j>>6&15|(z&3)<<4))&255],M=M>>>8^t[(M^(128|j&63))&255]):(M=M>>>8^t[(M^(224|z>>12&15))&255],M=M>>>8^t[(M^(128|z>>6&63))&255],M=M>>>8^t[(M^(128|z&63))&255]);return~M}return n.table=t,n.bstr=N,n.buf=D,n.str=W,n})(),er=(function(){var e={};e.version="1.2.1";function t(B,Y){for(var K=B.split("/"),q=Y.split("/"),J=0,Q=0,ve=Math.min(K.length,q.length);J<ve;++J){if(Q=K[J].length-q[J].length)return Q;if(K[J]!=q[J])return K[J]<q[J]?-1:1}return K.length-q.length}function r(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:r(B.slice(0,-1));var Y=B.lastIndexOf("/");return Y===-1?B:B.slice(0,Y+1)}function i(B){if(B.charAt(B.length-1)=="/")return i(B.slice(0,-1));var Y=B.lastIndexOf("/");return Y===-1?B:B.slice(Y+1)}function s(B,Y){typeof Y=="string"&&(Y=new Date(Y));var K=Y.getHours();K=K<<6|Y.getMinutes(),K=K<<5|Y.getSeconds()>>>1,B.write_shift(2,K);var q=Y.getFullYear()-1980;q=q<<4|Y.getMonth()+1,q=q<<5|Y.getDate(),B.write_shift(2,q)}function a(B){var Y=B.read_shift(2)&65535,K=B.read_shift(2)&65535,q=new Date,J=K&31;K>>>=5;var Q=K&15;K>>>=4,q.setMilliseconds(0),q.setFullYear(K+1980),q.setMonth(Q-1),q.setDate(J);var ve=Y&31;Y>>>=5;var Oe=Y&63;return Y>>>=6,q.setHours(Y),q.setMinutes(Oe),q.setSeconds(ve<<1),q}function o(B){sa(B,0);for(var Y={},K=0;B.l<=B.length-4;){var q=B.read_shift(2),J=B.read_shift(2),Q=B.l+J,ve={};switch(q){case 21589:K=B.read_shift(1),K&1&&(ve.mtime=B.read_shift(4)),J>5&&(K&2&&(ve.atime=B.read_shift(4)),K&4&&(ve.ctime=B.read_shift(4))),ve.mtime&&(ve.mt=new Date(ve.mtime*1e3));break}B.l=Q,Y[q]=ve}return Y}var l;function c(){return l||(l={})}function h(B,Y){if(B[0]==80&&B[1]==75)return Ot(B,Y);if((B[0]|32)==109&&(B[1]|32)==105)return Ve(B,Y);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var K=3,q=512,J=0,Q=0,ve=0,Oe=0,_e=0,Se=[],be=B.slice(0,512);sa(be,0);var Xe=g(be);switch(K=Xe[0],K){case 3:q=512;break;case 4:q=4096;break;case 0:if(Xe[1]==0)return Ot(B,Y);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}q!==512&&(be=B.slice(0,q),sa(be,28));var rt=B.slice(0,q);m(be,K);var pt=be.read_shift(4,"i");if(K===3&&pt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pt);be.l+=4,ve=be.read_shift(4,"i"),be.l+=4,be.chk("00100000","Mini Stream Cutoff Size: "),Oe=be.read_shift(4,"i"),J=be.read_shift(4,"i"),_e=be.read_shift(4,"i"),Q=be.read_shift(4,"i");for(var qe=-1,Ye=0;Ye<109&&(qe=be.read_shift(4,"i"),!(qe<0));++Ye)Se[Ye]=qe;var Ht=y(B,q);E(_e,Q,Ht,q,Se);var Vn=b(Ht,ve,Se,q);Vn[ve].name="!Directory",J>0&&Oe!==j&&(Vn[Oe].name="!MiniFAT"),Vn[Se[0]].name="!FAT",Vn.fat_addrs=Se,Vn.ssz=q;var $n={},pr=[],Ha=[],ya=[];R(ve,Vn,Ht,pr,J,$n,Ha,Oe),v(Ha,ya,pr),pr.shift();var qs={FileIndex:Ha,FullPaths:ya};return Y&&Y.raw&&(qs.raw={header:rt,sectors:Ht}),qs}function g(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(Ee,"Header Signature: "),B.l+=16;var Y=B.read_shift(2,"u");return[B.read_shift(2,"u"),Y]}function m(B,Y){var K=9;switch(B.l+=2,K=B.read_shift(2)){case 9:if(Y!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(Y!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function y(B,Y){for(var K=Math.ceil(B.length/Y)-1,q=[],J=1;J<K;++J)q[J-1]=B.slice(J*Y,(J+1)*Y);return q[K-1]=B.slice(K*Y),q}function v(B,Y,K){for(var q=0,J=0,Q=0,ve=0,Oe=0,_e=K.length,Se=[],be=[];q<_e;++q)Se[q]=be[q]=q,Y[q]=K[q];for(;Oe<be.length;++Oe)q=be[Oe],J=B[q].L,Q=B[q].R,ve=B[q].C,Se[q]===q&&(J!==-1&&Se[J]!==J&&(Se[q]=Se[J]),Q!==-1&&Se[Q]!==Q&&(Se[q]=Se[Q])),ve!==-1&&(Se[ve]=q),J!==-1&&q!=Se[q]&&(Se[J]=Se[q],be.lastIndexOf(J)<Oe&&be.push(J)),Q!==-1&&q!=Se[q]&&(Se[Q]=Se[q],be.lastIndexOf(Q)<Oe&&be.push(Q));for(q=1;q<_e;++q)Se[q]===q&&(Q!==-1&&Se[Q]!==Q?Se[q]=Se[Q]:J!==-1&&Se[J]!==J&&(Se[q]=Se[J]));for(q=1;q<_e;++q)if(B[q].type!==0){if(Oe=q,Oe!=Se[Oe])do Oe=Se[Oe],Y[q]=Y[Oe]+"/"+Y[q];while(Oe!==0&&Se[Oe]!==-1&&Oe!=Se[Oe]);Se[q]=-1}for(Y[0]+="/",q=1;q<_e;++q)B[q].type!==2&&(Y[q]+="/")}function _(B,Y,K){for(var q=B.start,J=B.size,Q=[],ve=q;K&&J>0&&ve>=0;)Q.push(Y.slice(ve*z,ve*z+z)),J-=z,ve=Dh(K,ve*4);return Q.length===0?Ne(0):$i(Q).slice(0,B.size)}function E(B,Y,K,q,J){var Q=j;if(B===j){if(Y!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var ve=K[B],Oe=(q>>>2)-1;if(!ve)return;for(var _e=0;_e<Oe&&(Q=Dh(ve,_e*4))!==j;++_e)J.push(Q);E(Dh(ve,q-4),Y-1,K,q,J)}}function T(B,Y,K,q,J){var Q=[],ve=[];J||(J=[]);var Oe=q-1,_e=0,Se=0;for(_e=Y;_e>=0;){J[_e]=!0,Q[Q.length]=_e,ve.push(B[_e]);var be=K[Math.floor(_e*4/q)];if(Se=_e*4&Oe,q<4+Se)throw new Error("FAT boundary crossed: "+_e+" 4 "+q);if(!B[be])break;_e=Dh(B[be],Se)}return{nodes:Q,data:E5([ve])}}function b(B,Y,K,q){var J=B.length,Q=[],ve=[],Oe=[],_e=[],Se=q-1,be=0,Xe=0,rt=0,pt=0;for(be=0;be<J;++be)if(Oe=[],rt=be+Y,rt>=J&&(rt-=J),!ve[rt]){_e=[];var qe=[];for(Xe=rt;Xe>=0;){qe[Xe]=!0,ve[Xe]=!0,Oe[Oe.length]=Xe,_e.push(B[Xe]);var Ye=K[Math.floor(Xe*4/q)];if(pt=Xe*4&Se,q<4+pt)throw new Error("FAT boundary crossed: "+Xe+" 4 "+q);if(!B[Ye]||(Xe=Dh(B[Ye],pt),qe[Xe]))break}Q[rt]={nodes:Oe,data:E5([_e])}}return Q}function R(B,Y,K,q,J,Q,ve,Oe){for(var _e=0,Se=q.length?2:0,be=Y[B].data,Xe=0,rt=0,pt;Xe<be.length;Xe+=128){var qe=be.slice(Xe,Xe+128);sa(qe,64),rt=qe.read_shift(2),pt=sC(qe,0,rt-Se),q.push(pt);var Ye={name:pt,type:qe.read_shift(1),color:qe.read_shift(1),L:qe.read_shift(4,"i"),R:qe.read_shift(4,"i"),C:qe.read_shift(4,"i"),clsid:qe.read_shift(16),state:qe.read_shift(4,"i"),start:0,size:0},Ht=qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2);Ht!==0&&(Ye.ct=N(qe,qe.l-8));var Vn=qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2);Vn!==0&&(Ye.mt=N(qe,qe.l-8)),Ye.start=qe.read_shift(4,"i"),Ye.size=qe.read_shift(4,"i"),Ye.size<0&&Ye.start<0&&(Ye.size=Ye.type=0,Ye.start=j,Ye.name=""),Ye.type===5?(_e=Ye.start,J>0&&_e!==j&&(Y[_e].name="!StreamData")):Ye.size>=4096?(Ye.storage="fat",Y[Ye.start]===void 0&&(Y[Ye.start]=T(K,Ye.start,Y.fat_addrs,Y.ssz)),Y[Ye.start].name=Ye.name,Ye.content=Y[Ye.start].data.slice(0,Ye.size)):(Ye.storage="minifat",Ye.size<0?Ye.size=0:_e!==j&&Ye.start!==j&&Y[_e]&&(Ye.content=_(Ye,Y[_e].data,(Y[Oe]||{}).data))),Ye.content&&sa(Ye.content,0),Q[pt]=Ye,ve.push(Ye)}}function N(B,Y){return new Date((la(B,Y+4)/1e7*Math.pow(2,32)+la(B,Y)/1e7-11644473600)*1e3)}function D(B,Y){return c(),h(l.readFileSync(B),Y)}function W(B,Y){var K=Y&&Y.type;switch(K||On&&Buffer.isBuffer(B)&&(K="buffer"),K||"base64"){case"file":return D(B,Y);case"base64":return h(ho(cc(B)),Y);case"binary":return h(ho(B),Y)}return h(B,Y)}function I(B,Y){var K=Y||{},q=K.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=q+"/",B.FileIndex[0]={name:q,type:5}),K.CLSID&&(B.FileIndex[0].clsid=K.CLSID),A(B)}function A(B){var Y="Sh33tJ5";if(!er.find(B,"/"+Y)){var K=Ne(4);K[0]=55,K[1]=K[3]=50,K[2]=54,B.FileIndex.push({name:Y,type:2,content:K,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+Y),M(B)}}function M(B,Y){I(B);for(var K=!1,q=!1,J=B.FullPaths.length-1;J>=0;--J){var Q=B.FileIndex[J];switch(Q.type){case 0:q?K=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:q=!0,isNaN(Q.R*Q.L*Q.C)&&(K=!0),Q.R>-1&&Q.L>-1&&Q.R==Q.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!Y)){var ve=new Date(1987,1,19),Oe=0,_e=Object.create?Object.create(null):{},Se=[];for(J=0;J<B.FullPaths.length;++J)_e[B.FullPaths[J]]=!0,B.FileIndex[J].type!==0&&Se.push([B.FullPaths[J],B.FileIndex[J]]);for(J=0;J<Se.length;++J){var be=r(Se[J][0]);q=_e[be],q||(Se.push([be,{name:i(be).replace("/",""),type:1,clsid:Ge,ct:ve,mt:ve,content:null}]),_e[be]=!0)}for(Se.sort(function(pt,qe){return t(pt[0],qe[0])}),B.FullPaths=[],B.FileIndex=[],J=0;J<Se.length;++J)B.FullPaths[J]=Se[J][0],B.FileIndex[J]=Se[J][1];for(J=0;J<Se.length;++J){var Xe=B.FileIndex[J],rt=B.FullPaths[J];if(Xe.name=i(rt).replace("/",""),Xe.L=Xe.R=Xe.C=-(Xe.color=1),Xe.size=Xe.content?Xe.content.length:0,Xe.start=0,Xe.clsid=Xe.clsid||Ge,J===0)Xe.C=Se.length>1?1:-1,Xe.size=0,Xe.type=5;else if(rt.slice(-1)=="/"){for(Oe=J+1;Oe<Se.length&&r(B.FullPaths[Oe])!=rt;++Oe);for(Xe.C=Oe>=Se.length?-1:Oe,Oe=J+1;Oe<Se.length&&r(B.FullPaths[Oe])!=r(rt);++Oe);Xe.R=Oe>=Se.length?-1:Oe,Xe.type=1}else r(B.FullPaths[J+1]||"")==r(rt)&&(Xe.R=J+1),Xe.type=2}}}function O(B,Y){var K=Y||{};if(K.fileType=="mad")return He(B,K);switch(M(B),K.fileType){case"zip":return ct(B,K)}var q=(function(pt){for(var qe=0,Ye=0,Ht=0;Ht<pt.FileIndex.length;++Ht){var Vn=pt.FileIndex[Ht];if(Vn.content){var $n=Vn.content.length;$n>0&&($n<4096?qe+=$n+63>>6:Ye+=$n+511>>9)}}for(var pr=pt.FullPaths.length+3>>2,Ha=qe+7>>3,ya=qe+127>>7,qs=Ha+Ye+pr+ya,Gr=qs+127>>7,wc=Gr<=109?0:Math.ceil((Gr-109)/127);qs+Gr+wc+127>>7>Gr;)wc=++Gr<=109?0:Math.ceil((Gr-109)/127);var br=[1,wc,Gr,ya,pr,Ye,qe,0];return pt.FileIndex[0].size=qe<<6,br[7]=(pt.FileIndex[0].start=br[0]+br[1]+br[2]+br[3]+br[4]+br[5])+(br[6]+7>>3),br})(B),J=Ne(q[7]<<9),Q=0,ve=0;{for(Q=0;Q<8;++Q)J.write_shift(1,Ce[Q]);for(Q=0;Q<8;++Q)J.write_shift(2,0);for(J.write_shift(2,62),J.write_shift(2,3),J.write_shift(2,65534),J.write_shift(2,9),J.write_shift(2,6),Q=0;Q<3;++Q)J.write_shift(2,0);for(J.write_shift(4,0),J.write_shift(4,q[2]),J.write_shift(4,q[0]+q[1]+q[2]+q[3]-1),J.write_shift(4,0),J.write_shift(4,4096),J.write_shift(4,q[3]?q[0]+q[1]+q[2]-1:j),J.write_shift(4,q[3]),J.write_shift(-4,q[1]?q[0]-1:j),J.write_shift(4,q[1]),Q=0;Q<109;++Q)J.write_shift(-4,Q<q[2]?q[1]+Q:-1)}if(q[1])for(ve=0;ve<q[1];++ve){for(;Q<236+ve*127;++Q)J.write_shift(-4,Q<q[2]?q[1]+Q:-1);J.write_shift(-4,ve===q[1]-1?j:ve+1)}var Oe=function(pt){for(ve+=pt;Q<ve-1;++Q)J.write_shift(-4,Q+1);pt&&(++Q,J.write_shift(-4,j))};for(ve=Q=0,ve+=q[1];Q<ve;++Q)J.write_shift(-4,Le.DIFSECT);for(ve+=q[2];Q<ve;++Q)J.write_shift(-4,Le.FATSECT);Oe(q[3]),Oe(q[4]);for(var _e=0,Se=0,be=B.FileIndex[0];_e<B.FileIndex.length;++_e)be=B.FileIndex[_e],be.content&&(Se=be.content.length,!(Se<4096)&&(be.start=ve,Oe(Se+511>>9)));for(Oe(q[6]+7>>3);J.l&511;)J.write_shift(-4,Le.ENDOFCHAIN);for(ve=Q=0,_e=0;_e<B.FileIndex.length;++_e)be=B.FileIndex[_e],be.content&&(Se=be.content.length,!(!Se||Se>=4096)&&(be.start=ve,Oe(Se+63>>6)));for(;J.l&511;)J.write_shift(-4,Le.ENDOFCHAIN);for(Q=0;Q<q[4]<<2;++Q){var Xe=B.FullPaths[Q];if(!Xe||Xe.length===0){for(_e=0;_e<17;++_e)J.write_shift(4,0);for(_e=0;_e<3;++_e)J.write_shift(4,-1);for(_e=0;_e<12;++_e)J.write_shift(4,0);continue}be=B.FileIndex[Q],Q===0&&(be.start=be.size?be.start-1:j);var rt=Q===0&&K.root||be.name;if(Se=2*(rt.length+1),J.write_shift(64,rt,"utf16le"),J.write_shift(2,Se),J.write_shift(1,be.type),J.write_shift(1,be.color),J.write_shift(-4,be.L),J.write_shift(-4,be.R),J.write_shift(-4,be.C),be.clsid)J.write_shift(16,be.clsid,"hex");else for(_e=0;_e<4;++_e)J.write_shift(4,0);J.write_shift(4,be.state||0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,be.start),J.write_shift(4,be.size),J.write_shift(4,0)}for(Q=1;Q<B.FileIndex.length;++Q)if(be=B.FileIndex[Q],be.size>=4096)if(J.l=be.start+1<<9,On&&Buffer.isBuffer(be.content))be.content.copy(J,J.l,0,be.size),J.l+=be.size+511&-512;else{for(_e=0;_e<be.size;++_e)J.write_shift(1,be.content[_e]);for(;_e&511;++_e)J.write_shift(1,0)}for(Q=1;Q<B.FileIndex.length;++Q)if(be=B.FileIndex[Q],be.size>0&&be.size<4096)if(On&&Buffer.isBuffer(be.content))be.content.copy(J,J.l,0,be.size),J.l+=be.size+63&-64;else{for(_e=0;_e<be.size;++_e)J.write_shift(1,be.content[_e]);for(;_e&63;++_e)J.write_shift(1,0)}if(On)J.l=J.length;else for(;J.l<J.length;)J.write_shift(1,0);return J}function L(B,Y){var K=B.FullPaths.map(function(_e){return _e.toUpperCase()}),q=K.map(function(_e){var Se=_e.split("/");return Se[Se.length-(_e.slice(-1)=="/"?2:1)]}),J=!1;Y.charCodeAt(0)===47?(J=!0,Y=K[0].slice(0,-1)+Y):J=Y.indexOf("/")!==-1;var Q=Y.toUpperCase(),ve=J===!0?K.indexOf(Q):q.indexOf(Q);if(ve!==-1)return B.FileIndex[ve];var Oe=!Q.match(Gx);for(Q=Q.replace(sp,""),Oe&&(Q=Q.replace(Gx,"!")),ve=0;ve<K.length;++ve)if((Oe?K[ve].replace(Gx,"!"):K[ve]).replace(sp,"")==Q||(Oe?q[ve].replace(Gx,"!"):q[ve]).replace(sp,"")==Q)return B.FileIndex[ve];return null}var z=64,j=-2,Ee="d0cf11e0a1b11ae1",Ce=[208,207,17,224,161,177,26,225],Ge="00000000000000000000000000000000",Le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:j,FREESECT:-1,HEADER_SIGNATURE:Ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ge,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ce(B,Y,K){c();var q=O(B,K);l.writeFileSync(Y,q)}function Me(B){for(var Y=new Array(B.length),K=0;K<B.length;++K)Y[K]=String.fromCharCode(B[K]);return Y.join("")}function Te(B,Y){var K=O(B,Y);switch(Y&&Y.type||"buffer"){case"file":return c(),l.writeFileSync(Y.filename,K),K;case"binary":return typeof K=="string"?K:Me(K);case"base64":return ty(typeof K=="string"?K:Me(K));case"buffer":if(On)return Buffer.isBuffer(K)?K:vc(K);case"array":return typeof K=="string"?ho(K):K}return K}var ie;function V(B){try{var Y=B.InflateRaw,K=new Y;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)ie=B;else throw new Error("zlib does not expose bytesRead")}catch(q){console.error("cannot use native zlib: "+(q.message||q))}}function Z(B,Y){if(!ie)return ye(B,Y);var K=ie.InflateRaw,q=new K,J=q._processChunk(B.slice(B.l),q._finishFlushFlag);return B.l+=q.bytesRead,J}function te(B){return ie?ie.deflateRawSync(B):sn(B)}var se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Fe(B){var Y=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(Y>>16|Y>>8|Y)&255}for(var de=typeof Uint8Array<"u",Pe=de?new Uint8Array(256):[],Be=0;Be<256;++Be)Pe[Be]=Fe(Be);function It(B,Y){var K=Pe[B&255];return Y<=8?K>>>8-Y:(K=K<<8|Pe[B>>8&255],Y<=16?K>>>16-Y:(K=K<<8|Pe[B>>16&255],K>>>24-Y))}function Wt(B,Y){var K=Y&7,q=Y>>>3;return(B[q]|(K<=6?0:B[q+1]<<8))>>>K&3}function Dt(B,Y){var K=Y&7,q=Y>>>3;return(B[q]|(K<=5?0:B[q+1]<<8))>>>K&7}function Zt(B,Y){var K=Y&7,q=Y>>>3;return(B[q]|(K<=4?0:B[q+1]<<8))>>>K&15}function rn(B,Y){var K=Y&7,q=Y>>>3;return(B[q]|(K<=3?0:B[q+1]<<8))>>>K&31}function ht(B,Y){var K=Y&7,q=Y>>>3;return(B[q]|(K<=1?0:B[q+1]<<8))>>>K&127}function rr(B,Y,K){var q=Y&7,J=Y>>>3,Q=(1<<K)-1,ve=B[J]>>>q;return K<8-q||(ve|=B[J+1]<<8-q,K<16-q)||(ve|=B[J+2]<<16-q,K<24-q)||(ve|=B[J+3]<<24-q),ve&Q}function hn(B,Y,K){var q=Y&7,J=Y>>>3;return q<=5?B[J]|=(K&7)<<q:(B[J]|=K<<q&255,B[J+1]=(K&7)>>8-q),Y+3}function cn(B,Y,K){var q=Y&7,J=Y>>>3;return K=(K&1)<<q,B[J]|=K,Y+1}function ir(B,Y,K){var q=Y&7,J=Y>>>3;return K<<=q,B[J]|=K&255,K>>>=8,B[J+1]=K,Y+8}function Pi(B,Y,K){var q=Y&7,J=Y>>>3;return K<<=q,B[J]|=K&255,K>>>=8,B[J+1]=K&255,B[J+2]=K>>>8,Y+16}function jn(B,Y){var K=B.length,q=2*K>Y?2*K:Y+5,J=0;if(K>=Y)return B;if(On){var Q=o5(q);if(B.copy)B.copy(Q);else for(;J<B.length;++J)Q[J]=B[J];return Q}else if(de){var ve=new Uint8Array(q);if(ve.set)ve.set(B);else for(;J<K;++J)ve[J]=B[J];return ve}return B.length=q,B}function Sr(B){for(var Y=new Array(B),K=0;K<B;++K)Y[K]=0;return Y}function ai(B,Y,K){var q=1,J=0,Q=0,ve=0,Oe=0,_e=B.length,Se=de?new Uint16Array(32):Sr(32);for(Q=0;Q<32;++Q)Se[Q]=0;for(Q=_e;Q<K;++Q)B[Q]=0;_e=B.length;var be=de?new Uint16Array(_e):Sr(_e);for(Q=0;Q<_e;++Q)Se[J=B[Q]]++,q<J&&(q=J),be[Q]=0;for(Se[0]=0,Q=1;Q<=q;++Q)Se[Q+16]=Oe=Oe+Se[Q-1]<<1;for(Q=0;Q<_e;++Q)Oe=B[Q],Oe!=0&&(be[Q]=Se[Oe+16]++);var Xe=0;for(Q=0;Q<_e;++Q)if(Xe=B[Q],Xe!=0)for(Oe=It(be[Q],q)>>q-Xe,ve=(1<<q+4-Xe)-1;ve>=0;--ve)Y[Oe|ve<<Xe]=Xe&15|Q<<4;return q}var _t=de?new Uint16Array(512):Sr(512),pn=de?new Uint16Array(32):Sr(32);if(!de){for(var bn=0;bn<512;++bn)_t[bn]=0;for(bn=0;bn<32;++bn)pn[bn]=0}(function(){for(var B=[],Y=0;Y<32;Y++)B.push(5);ai(B,pn,32);var K=[];for(Y=0;Y<=143;Y++)K.push(8);for(;Y<=255;Y++)K.push(9);for(;Y<=279;Y++)K.push(7);for(;Y<=287;Y++)K.push(8);ai(K,_t,288)})();var Et=(function(){for(var Y=de?new Uint8Array(32768):[],K=0,q=0;K<Ae.length-1;++K)for(;q<Ae[K+1];++q)Y[q]=K;for(;q<32768;++q)Y[q]=29;var J=de?new Uint8Array(259):[];for(K=0,q=0;K<he.length-1;++K)for(;q<he[K+1];++q)J[q]=K;function Q(Oe,_e){for(var Se=0;Se<Oe.length;){var be=Math.min(65535,Oe.length-Se),Xe=Se+be==Oe.length;for(_e.write_shift(1,+Xe),_e.write_shift(2,be),_e.write_shift(2,~be&65535);be-- >0;)_e[_e.l++]=Oe[Se++]}return _e.l}function ve(Oe,_e){for(var Se=0,be=0,Xe=de?new Uint16Array(32768):[];be<Oe.length;){var rt=Math.min(65535,Oe.length-be);if(rt<10){for(Se=hn(_e,Se,+(be+rt==Oe.length)),Se&7&&(Se+=8-(Se&7)),_e.l=Se/8|0,_e.write_shift(2,rt),_e.write_shift(2,~rt&65535);rt-- >0;)_e[_e.l++]=Oe[be++];Se=_e.l*8;continue}Se=hn(_e,Se,+(be+rt==Oe.length)+2);for(var pt=0;rt-- >0;){var qe=Oe[be];pt=(pt<<5^qe)&32767;var Ye=-1,Ht=0;if((Ye=Xe[pt])&&(Ye|=be&-32768,Ye>be&&(Ye-=32768),Ye<be))for(;Oe[Ye+Ht]==Oe[be+Ht]&&Ht<250;)++Ht;if(Ht>2){qe=J[Ht],qe<=22?Se=ir(_e,Se,Pe[qe+1]>>1)-1:(ir(_e,Se,3),Se+=5,ir(_e,Se,Pe[qe-23]>>5),Se+=3);var Vn=qe<8?0:qe-4>>2;Vn>0&&(Pi(_e,Se,Ht-he[qe]),Se+=Vn),qe=Y[be-Ye],Se=ir(_e,Se,Pe[qe]>>3),Se-=3;var $n=qe<4?0:qe-2>>1;$n>0&&(Pi(_e,Se,be-Ye-Ae[qe]),Se+=$n);for(var pr=0;pr<Ht;++pr)Xe[pt]=be&32767,pt=(pt<<5^Oe[be])&32767,++be;rt-=Ht-1}else qe<=143?qe=qe+48:Se=cn(_e,Se,1),Se=ir(_e,Se,Pe[qe]),Xe[pt]=be&32767,++be}Se=ir(_e,Se,0)-1}return _e.l=(Se+7)/8|0,_e.l}return function(_e,Se){return _e.length<8?Q(_e,Se):ve(_e,Se)}})();function sn(B){var Y=Ne(50+Math.floor(B.length*1.1)),K=Et(B,Y);return Y.slice(0,K)}var Nt=de?new Uint16Array(32768):Sr(32768),Xi=de?new Uint16Array(32768):Sr(32768),Mr=de?new Uint16Array(128):Sr(128),oi=1,tn=1;function Tr(B,Y){var K=rn(B,Y)+257;Y+=5;var q=rn(B,Y)+1;Y+=5;var J=Zt(B,Y)+4;Y+=4;for(var Q=0,ve=de?new Uint8Array(19):Sr(19),Oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_e=1,Se=de?new Uint8Array(8):Sr(8),be=de?new Uint8Array(8):Sr(8),Xe=ve.length,rt=0;rt<J;++rt)ve[se[rt]]=Q=Dt(B,Y),_e<Q&&(_e=Q),Se[Q]++,Y+=3;var pt=0;for(Se[0]=0,rt=1;rt<=_e;++rt)be[rt]=pt=pt+Se[rt-1]<<1;for(rt=0;rt<Xe;++rt)(pt=ve[rt])!=0&&(Oe[rt]=be[pt]++);var qe=0;for(rt=0;rt<Xe;++rt)if(qe=ve[rt],qe!=0){pt=Pe[Oe[rt]]>>8-qe;for(var Ye=(1<<7-qe)-1;Ye>=0;--Ye)Mr[pt|Ye<<qe]=qe&7|rt<<3}var Ht=[];for(_e=1;Ht.length<K+q;)switch(pt=Mr[ht(B,Y)],Y+=pt&7,pt>>>=3){case 16:for(Q=3+Wt(B,Y),Y+=2,pt=Ht[Ht.length-1];Q-- >0;)Ht.push(pt);break;case 17:for(Q=3+Dt(B,Y),Y+=3;Q-- >0;)Ht.push(0);break;case 18:for(Q=11+ht(B,Y),Y+=7;Q-- >0;)Ht.push(0);break;default:Ht.push(pt),_e<pt&&(_e=pt);break}var Vn=Ht.slice(0,K),$n=Ht.slice(K);for(rt=K;rt<286;++rt)Vn[rt]=0;for(rt=q;rt<30;++rt)$n[rt]=0;return oi=ai(Vn,Nt,286),tn=ai($n,Xi,30),Y}function je(B,Y){if(B[0]==3&&!(B[1]&3))return[Ed(Y),2];for(var K=0,q=0,J=o5(Y||1<<18),Q=0,ve=J.length>>>0,Oe=0,_e=0;(q&1)==0;){if(q=Dt(B,K),K+=3,q>>>1)q>>1==1?(Oe=9,_e=5):(K=Tr(B,K),Oe=oi,_e=tn);else{K&7&&(K+=8-(K&7));var Se=B[K>>>3]|B[(K>>>3)+1]<<8;if(K+=32,Se>0)for(!Y&&ve<Q+Se&&(J=jn(J,Q+Se),ve=J.length);Se-- >0;)J[Q++]=B[K>>>3],K+=8;continue}for(;;){!Y&&ve<Q+32767&&(J=jn(J,Q+32767),ve=J.length);var be=rr(B,K,Oe),Xe=q>>>1==1?_t[be]:Nt[be];if(K+=Xe&15,Xe>>>=4,(Xe>>>8&255)===0)J[Q++]=Xe;else{if(Xe==256)break;Xe-=257;var rt=Xe<8?0:Xe-4>>2;rt>5&&(rt=0);var pt=Q+he[Xe];rt>0&&(pt+=rr(B,K,rt),K+=rt),be=rr(B,K,_e),Xe=q>>>1==1?pn[be]:Xi[be],K+=Xe&15,Xe>>>=4;var qe=Xe<4?0:Xe-2>>1,Ye=Ae[Xe];for(qe>0&&(Ye+=rr(B,K,qe),K+=qe),!Y&&ve<pt&&(J=jn(J,pt+100),ve=J.length);Q<pt;)J[Q]=J[Q-Ye],++Q}}}return Y?[J,K+7>>>3]:[J.slice(0,Q),K+7>>>3]}function ye(B,Y){var K=B.slice(B.l||0),q=je(K,Y);return B.l+=q[1],q[0]}function xe(B,Y){if(B)typeof console<"u"&&console.error(Y);else throw new Error(Y)}function Ot(B,Y){var K=B;sa(K,0);var q=[],J=[],Q={FileIndex:q,FullPaths:J};I(Q,{root:Y.root});for(var ve=K.length-4;(K[ve]!=80||K[ve+1]!=75||K[ve+2]!=5||K[ve+3]!=6)&&ve>=0;)--ve;K.l=ve+4,K.l+=4;var Oe=K.read_shift(2);K.l+=6;var _e=K.read_shift(4);for(K.l=_e,ve=0;ve<Oe;++ve){K.l+=20;var Se=K.read_shift(4),be=K.read_shift(4),Xe=K.read_shift(2),rt=K.read_shift(2),pt=K.read_shift(2);K.l+=8;var qe=K.read_shift(4),Ye=o(K.slice(K.l+Xe,K.l+Xe+rt));K.l+=Xe+rt+pt;var Ht=K.l;K.l=qe+4,P(K,Se,be,Q,Ye),K.l=Ht}return Q}function P(B,Y,K,q,J){B.l+=2;var Q=B.read_shift(2),ve=B.read_shift(2),Oe=a(B);if(Q&8257)throw new Error("Unsupported ZIP encryption");for(var _e=B.read_shift(4),Se=B.read_shift(4),be=B.read_shift(4),Xe=B.read_shift(2),rt=B.read_shift(2),pt="",qe=0;qe<Xe;++qe)pt+=String.fromCharCode(B[B.l++]);if(rt){var Ye=o(B.slice(B.l,B.l+rt));(Ye[21589]||{}).mt&&(Oe=Ye[21589].mt),((J||{})[21589]||{}).mt&&(Oe=J[21589].mt)}B.l+=rt;var Ht=B.slice(B.l,B.l+Se);switch(ve){case 8:Ht=Z(B,be);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ve)}var Vn=!1;Q&8&&(_e=B.read_shift(4),_e==134695760&&(_e=B.read_shift(4),Vn=!0),Se=B.read_shift(4),be=B.read_shift(4)),Se!=Y&&xe(Vn,"Bad compressed size: "+Y+" != "+Se),be!=K&&xe(Vn,"Bad uncompressed size: "+K+" != "+be),Qe(q,pt,Ht,{unsafe:!0,mt:Oe})}function ct(B,Y){var K=Y||{},q=[],J=[],Q=Ne(1),ve=K.compression?8:0,Oe=0,_e=0,Se=0,be=0,Xe=0,rt=B.FullPaths[0],pt=rt,qe=B.FileIndex[0],Ye=[],Ht=0;for(_e=1;_e<B.FullPaths.length;++_e)if(pt=B.FullPaths[_e].slice(rt.length),qe=B.FileIndex[_e],!(!qe.size||!qe.content||pt=="Sh33tJ5")){var Vn=be,$n=Ne(pt.length);for(Se=0;Se<pt.length;++Se)$n.write_shift(1,pt.charCodeAt(Se)&127);$n=$n.slice(0,$n.l),Ye[Xe]=h1e.buf(qe.content,0);var pr=qe.content;ve==8&&(pr=te(pr)),Q=Ne(30),Q.write_shift(4,67324752),Q.write_shift(2,20),Q.write_shift(2,Oe),Q.write_shift(2,ve),qe.mt?s(Q,qe.mt):Q.write_shift(4,0),Q.write_shift(-4,Ye[Xe]),Q.write_shift(4,pr.length),Q.write_shift(4,qe.content.length),Q.write_shift(2,$n.length),Q.write_shift(2,0),be+=Q.length,q.push(Q),be+=$n.length,q.push($n),be+=pr.length,q.push(pr),Q=Ne(46),Q.write_shift(4,33639248),Q.write_shift(2,0),Q.write_shift(2,20),Q.write_shift(2,Oe),Q.write_shift(2,ve),Q.write_shift(4,0),Q.write_shift(-4,Ye[Xe]),Q.write_shift(4,pr.length),Q.write_shift(4,qe.content.length),Q.write_shift(2,$n.length),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(4,0),Q.write_shift(4,Vn),Ht+=Q.l,J.push(Q),Ht+=$n.length,J.push($n),++Xe}return Q=Ne(22),Q.write_shift(4,101010256),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,Xe),Q.write_shift(2,Xe),Q.write_shift(4,Ht),Q.write_shift(4,be),Q.write_shift(2,0),$i([$i(q),$i(J),Q])}var U={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function re(B,Y){if(B.ctype)return B.ctype;var K=B.name||"",q=K.match(/\.([^\.]+)$/);return q&&U[q[1]]||Y&&(q=(K=Y).match(/[\.\\]([^\.\\])+$/),q&&U[q[1]])?U[q[1]]:"application/octet-stream"}function ee(B){for(var Y=ty(B),K=[],q=0;q<Y.length;q+=76)K.push(Y.slice(q,q+76));return K.join(`\r
`)+`\r
`}function ne(B){var Y=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Se){var be=Se.charCodeAt(0).toString(16).toUpperCase();return"="+(be.length==1?"0"+be:be)});Y=Y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Y.charAt(0)==`
`&&(Y="=0D"+Y.slice(1)),Y=Y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],q=Y.split(`\r
`),J=0;J<q.length;++J){var Q=q[J];if(Q.length==0){K.push("");continue}for(var ve=0;ve<Q.length;){var Oe=76,_e=Q.slice(ve,ve+Oe);_e.charAt(Oe-1)=="="?Oe--:_e.charAt(Oe-2)=="="?Oe-=2:_e.charAt(Oe-3)=="="&&(Oe-=3),_e=Q.slice(ve,ve+Oe),ve+=Oe,ve<Q.length&&(_e+="="),K.push(_e)}}return K.join(`\r
`)}function ue(B){for(var Y=[],K=0;K<B.length;++K){for(var q=B[K];K<=B.length&&q.charAt(q.length-1)=="=";)q=q.slice(0,q.length-1)+B[++K];Y.push(q)}for(var J=0;J<Y.length;++J)Y[J]=Y[J].replace(/[=][0-9A-Fa-f]{2}/g,function(Q){return String.fromCharCode(parseInt(Q.slice(1),16))});return ho(Y.join(`\r
`))}function Ie(B,Y,K){for(var q="",J="",Q="",ve,Oe=0;Oe<10;++Oe){var _e=Y[Oe];if(!_e||_e.match(/^\s*$/))break;var Se=_e.match(/^(.*?):\s*([^\s].*)$/);if(Se)switch(Se[1].toLowerCase()){case"content-location":q=Se[2].trim();break;case"content-type":Q=Se[2].trim();break;case"content-transfer-encoding":J=Se[2].trim();break}}switch(++Oe,J.toLowerCase()){case"base64":ve=ho(cc(Y.slice(Oe).join("")));break;case"quoted-printable":ve=ue(Y.slice(Oe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+J)}var be=Qe(B,q.slice(K.length),ve,{unsafe:!0});Q&&(be.ctype=Q)}function Ve(B,Y){if(Me(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=Y&&Y.root||"",q=(On&&Buffer.isBuffer(B)?B.toString("binary"):Me(B)).split(`\r
`),J=0,Q="";for(J=0;J<q.length;++J)if(Q=q[J],!!/^Content-Location:/i.test(Q)&&(Q=Q.slice(Q.indexOf("file")),K||(K=Q.slice(0,Q.lastIndexOf("/")+1)),Q.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),Q.slice(0,K.length)!=K););var ve=(q[1]||"").match(/boundary="(.*?)"/);if(!ve)throw new Error("MAD cannot find boundary");var Oe="--"+(ve[1]||""),_e=[],Se=[],be={FileIndex:_e,FullPaths:Se};I(be);var Xe,rt=0;for(J=0;J<q.length;++J){var pt=q[J];pt!==Oe&&pt!==Oe+"--"||(rt++&&Ie(be,q.slice(Xe,J),K),Xe=J)}return be}function He(B,Y){var K=Y||{},q=K.boundary||"SheetJS";q="------="+q;for(var J=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+q.slice(2)+'"',"","",""],Q=B.FullPaths[0],ve=Q,Oe=B.FileIndex[0],_e=1;_e<B.FullPaths.length;++_e)if(ve=B.FullPaths[_e].slice(Q.length),Oe=B.FileIndex[_e],!(!Oe.size||!Oe.content||ve=="Sh33tJ5")){ve=ve.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ht){return"_x"+Ht.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ht){return"_u"+Ht.charCodeAt(0).toString(16)+"_"});for(var Se=Oe.content,be=On&&Buffer.isBuffer(Se)?Se.toString("binary"):Me(Se),Xe=0,rt=Math.min(1024,be.length),pt=0,qe=0;qe<=rt;++qe)(pt=be.charCodeAt(qe))>=32&&pt<128&&++Xe;var Ye=Xe>=rt*4/5;J.push(q),J.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+ve),J.push("Content-Transfer-Encoding: "+(Ye?"quoted-printable":"base64")),J.push("Content-Type: "+re(Oe,ve)),J.push(""),J.push(Ye?ne(be):ee(be))}return J.push(q+`--\r
`),J.join(`\r
`)}function Je(B){var Y={};return I(Y,B),Y}function Qe(B,Y,K,q){var J=q&&q.unsafe;J||I(B);var Q=!J&&er.find(B,Y);if(!Q){var ve=B.FullPaths[0];Y.slice(0,ve.length)==ve?ve=Y:(ve.slice(-1)!="/"&&(ve+="/"),ve=(ve+Y).replace("//","/")),Q={name:i(Y),type:2},B.FileIndex.push(Q),B.FullPaths.push(ve),J||er.utils.cfb_gc(B)}return Q.content=K,Q.size=K?K.length:0,q&&(q.CLSID&&(Q.clsid=q.CLSID),q.mt&&(Q.mt=q.mt),q.ct&&(Q.ct=q.ct)),Q}function yt(B,Y){I(B);var K=er.find(B,Y);if(K){for(var q=0;q<B.FileIndex.length;++q)if(B.FileIndex[q]==K)return B.FileIndex.splice(q,1),B.FullPaths.splice(q,1),!0}return!1}function St(B,Y,K){I(B);var q=er.find(B,Y);if(q){for(var J=0;J<B.FileIndex.length;++J)if(B.FileIndex[J]==q)return B.FileIndex[J].name=i(K),B.FullPaths[J]=K,!0}return!1}function Rn(B){M(B,!0)}return e.find=L,e.read=W,e.parse=h,e.write=Te,e.writeFile=ce,e.utils={cfb_new:Je,cfb_add:Qe,cfb_del:yt,cfb_mov:St,cfb_gc:Rn,ReadShift:op,CheckField:GB,prep_blob:sa,bconcat:$i,use_zlib:V,_deflateRaw:sn,_inflateRaw:ye,consts:Le},e})();function d1e(n){return typeof n=="string"?RE(n):Array.isArray(n)?jye(n):n}function e1(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=RE(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var r=t=="utf8"?ry(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([d1e(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=n,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(n);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Qy(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+n)}function Ki(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function m5(n,e){for(var t=[],r=Ki(n),i=0;i!==r.length;++i)t[n[r[i]][e]]==null&&(t[n[r[i]][e]]=r[i]);return t}function tC(n){for(var e=[],t=Ki(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}function IE(n){for(var e=[],t=Ki(n),r=0;r!==t.length;++r)e[n[t[r]]]=parseInt(t[r],10);return e}function f1e(n){for(var e=[],t=Ki(n),r=0;r!==t.length;++r)e[n[t[r]]]==null&&(e[n[t[r]]]=[]),e[n[t[r]]].push(t[r]);return e}var Qv=new Date(1899,11,30,0,0,0);function Hs(n,e){var t=n.getTime(),r=Qv.getTime()+(n.getTimezoneOffset()-Qv.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var TB=new Date,g1e=Qv.getTime()+(TB.getTimezoneOffset()-Qv.getTimezoneOffset())*6e4,p5=TB.getTimezoneOffset();function bB(n){var e=new Date;return e.setTime(n*24*60*60*1e3+g1e),e.getTimezoneOffset()!==p5&&e.setTime(e.getTime()+(e.getTimezoneOffset()-p5)*6e4),e}var y5=new Date("2017-02-19T19:06:09.000Z"),RB=isNaN(y5.getFullYear())?new Date("2/19/17"):y5,m1e=RB.getFullYear()==2017;function Ts(n,e){var t=new Date(n);if(m1e)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(RB.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function CE(n,e){if(On&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function Ks(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Ks(n[t]));return e}function jr(n,e){for(var t="";t.length<e;)t+=n;return t}function ec(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(r)))?e/t:e}var p1e=["january","february","march","april","may","june","july","august","september","october","november","december"];function ny(n){var e=new Date(n),t=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=n.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&p1e.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||s>1)&&r!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function on(n,e,t){if(n.FullPaths){if(typeof t=="string"){var r;return On?r=vc(t):r=Vye(t),er.utils.cfb_add(n,e,r)}er.utils.cfb_add(n,e,t)}else n.file(e,t)}function nC(){return er.utils.cfb_new()}var si=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,y1e={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rC=tC(y1e),iC=/[&<>'"]/g,x1e=/[\u0000-\u0008\u000b-\u001f]/g;function Zn(n){var e=n+"";return e.replace(iC,function(t){return rC[t]}).replace(x1e,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function x5(n){return Zn(n).replace(/ /g,"_x0020_")}var AB=/[\u0000-\u001f]/g;function _1e(n){var e=n+"";return e.replace(iC,function(t){return rC[t]}).replace(/\n/g,"<br/>").replace(AB,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function v1e(n){var e=n+"";return e.replace(iC,function(t){return rC[t]}).replace(AB,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function w1e(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function E1e(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function CT(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(i=n.charCodeAt(t++),r>191&&r<224){a=(r&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}a=n.charCodeAt(t++),o=((r&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function _5(n){var e=Ed(2*n.length),t,r,i=1,s=0,a=0,o;for(r=0;r<n.length;r+=i)i=1,(o=n.charCodeAt(r))<128?t=o:o<224?(t=(o&31)*64+(n.charCodeAt(r+1)&63),i=2):o<240?(t=(o&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,t=(o&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function v5(n){return vc(n,"binary").toString("utf8")}var Ux="foo bar baz",ap=On&&(v5(Ux)==CT(Ux)&&v5||_5(Ux)==CT(Ux)&&_5)||CT,ry=On?function(n){return vc(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},S1e=(function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}})(),kB=/(^\s|\s$|\n)/;function Wi(n,e){return"<"+n+(e.match(kB)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function iy(n){return Ki(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function it(n,e,t){return"<"+n+(t!=null?iy(t):"")+(e!=null?(e.match(kB)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function DR(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function T1e(n,e){switch(typeof n){case"string":var t=it("vt:lpwstr",Zn(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return it((n|0)==n?"vt:i4":"vt:r8",Zn(String(n)));case"boolean":return it("vt:bool",n?"true":"false")}if(n instanceof Date)return it("vt:filetime",DR(n));throw new Error("Unable to serialize "+n)}var Ri={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},mg=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],oa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function b1e(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),i=n[e+6]&15,s=5;s>=0;--s)i=i*256+n[e+s];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function R1e(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=r?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)n[t+o]=s&255;n[t+6]=(i&15)<<4|s&15,n[t+7]=i>>4|r}var w5=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,s=n[0][r].length;i<s;i+=t)e.push.apply(e,n[0][r].slice(i,i+t));return e},E5=On?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:vc(e)})):w5(n)}:w5,S5=function(n,e,t){for(var r=[],i=e;i<t;i+=2)r.push(String.fromCharCode(Mm(n,i)));return r.join("").replace(sp,"")},sC=On?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(sp,""):S5(n,e,t)}:S5,T5=function(n,e,t){for(var r=[],i=e;i<e+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},IB=On?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):T5(n,e,t)}:T5,b5=function(n,e,t){for(var r=[],i=e;i<t;i++)r.push(String.fromCharCode(Zf(n,i)));return r.join("")},t1=On?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):b5(e,t,r)}:b5,CB=function(n,e){var t=la(n,e);return t>0?t1(n,e+4,e+4+t-1):""},PB=CB,MB=function(n,e){var t=la(n,e);return t>0?t1(n,e+4,e+4+t-1):""},NB=MB,LB=function(n,e){var t=2*la(n,e);return t>0?t1(n,e+4,e+4+t-1):""},OB=LB,DB=function(e,t){var r=la(e,t);return r>0?sC(e,t+4,t+4+r):""},FB=DB,jB=function(n,e){var t=la(n,e);return t>0?t1(n,e+4,e+4+t):""},VB=jB,BB=function(n,e){return b1e(n,e)},ew=BB,aC=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};On&&(PB=function(e,t){if(!Buffer.isBuffer(e))return CB(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},NB=function(e,t){if(!Buffer.isBuffer(e))return MB(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},OB=function(e,t){if(!Buffer.isBuffer(e))return LB(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},FB=function(e,t){if(!Buffer.isBuffer(e))return DB(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},VB=function(e,t){if(!Buffer.isBuffer(e))return jB(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},ew=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):BB(e,t)},aC=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Zf=function(n,e){return n[e]},Mm=function(n,e){return n[e+1]*256+n[e]},A1e=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},la=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},Dh=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},k1e=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function op(n,e){var t="",r,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,On&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(l=0;l<n;++l)t+=String.fromCharCode(Mm(this,c)),c+=2;n*=2;break;case"utf8":t=t1(this,this.l,this.l+n);break;case"utf16le":n*=2,t=sC(this,this.l,this.l+n);break;case"wstr":return op.call(this,n,"dbcs");case"lpstr-ansi":t=PB(this,this.l),n=4+la(this,this.l);break;case"lpstr-cp":t=NB(this,this.l),n=4+la(this,this.l);break;case"lpwstr":t=OB(this,this.l),n=4+2*la(this,this.l);break;case"lpp4":n=4+la(this,this.l),t=FB(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+la(this,this.l),t=VB(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(a=Zf(this,this.l+n++))!==0;)s.push(Bx(a));t=s.join("");break;case"_wstr":for(n=0,t="";(a=Mm(this,this.l+n))!==0;)s.push(Bx(a)),n+=2;n+=2,t=s.join("");break;case"dbcs-cont":for(t="",c=this.l,l=0;l<n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Zf(this,c),this.l=c+1,o=op.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Bx(Mm(this,c))),c+=2}t=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",c=this.l,l=0;l!=n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Zf(this,c),this.l=c+1,o=op.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Bx(Zf(this,c))),c+=1}t=s.join("");break;default:switch(n){case 1:return r=Zf(this,this.l),this.l++,r;case 2:return r=(e==="i"?A1e:Mm)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(n>0?Dh:k1e)(this,this.l),this.l+=4,r):(i=la(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return n==8?i=ew(this,this.l):i=ew([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=IB(this,this.l,n);break}}return this.l+=n,t}var I1e=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},C1e=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},P1e=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function M1e(n,e,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)P1e(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(t==="hex"){for(;i<n;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(e.length,n);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,I1e(this,e,this.l);break;case 8:if(r=8,t==="f"){R1e(this,e,this.l);break}case 16:break;case-4:r=4,C1e(this,e,this.l);break}return this.l+=r,this}function GB(n,e){var t=IB(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function sa(n,e){n.l=e,n.read_shift=op,n.chk=GB,n.write_shift=M1e}function gl(n,e){n.l+=e}function Ne(n){var e=Ed(n);return sa(e,0),e}function Gs(){var n=[],e=On?256:2048,t=function(c){var h=Ne(c);return sa(h,0),h},r=t(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},s=function(c){return r&&c<r.length-r.l?r:(i(),r=t(Math.max(c+1,e)))},a=function(){return i(),$i(n)},o=function(c){i(),r=c,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:o,end:a,_bufs:n}}function Ue(n,e,t,r){var i=+e,s;if(!isNaN(i)){r||(r=b2e[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var a=n.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&aC(t)&&n.push(t)}}function lp(n,e,t){var r=Ks(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function R5(n,e,t){var r=Ks(n);return r.s=lp(r.s,e.s,t),r.e=lp(r.e,e.s,t),r}function cp(n,e){if(n.cRel&&n.c<0)for(n=Ks(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=Ks(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=Qn(n);return!n.cRel&&n.cRel!=null&&(t=O1e(t)),!n.rRel&&n.rRel!=null&&(t=N1e(t)),t}function PT(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+ds(n.s.c)+":"+(n.e.cRel?"":"$")+ds(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Hi(n.s.r)+":"+(n.e.rRel?"":"$")+Hi(n.e.r):cp(n.s,e.biff)+":"+cp(n.e,e.biff)}function oC(n){return parseInt(L1e(n),10)-1}function Hi(n){return""+(n+1)}function N1e(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function L1e(n){return n.replace(/\$(\d+)$/,"$1")}function lC(n){for(var e=D1e(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function ds(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function O1e(n){return n.replace(/^([A-Z])/,"$$$1")}function D1e(n){return n.replace(/^\$([A-Z])/,"$1")}function F1e(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ki(n){for(var e=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function Qn(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function pa(n){var e=n.indexOf(":");return e==-1?{s:ki(n),e:ki(n)}:{s:ki(n.slice(0,e)),e:ki(n.slice(e+1))}}function ni(n,e){return typeof e>"u"||typeof e=="number"?ni(n.s,n.e):(typeof n!="string"&&(n=Qn(n)),typeof e!="string"&&(e=Qn(e)),n==e?n:n+":"+e)}function mr(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,s=n.length;for(t=0;r<s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.s.c=--t,t=0;r<s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(e.s.r=--t,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.e.c=--t,t=0;r!=s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return e.e.r=--t,e}function A5(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=Gu(n.z,t?Hs(e):e)}catch{}try{return n.w=Gu((n.XF||{}).numFmtId||(t?14:0),t?Hs(e):e)}catch{return""+e}}function uc(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?n1[n.v]||n.v:e==null?A5(n,n.v):A5(n,e))}function Fd(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function zB(n,e,t){var r=t||{},i=n?Array.isArray(n):r.dense,s=n||(i?[]:{}),a=0,o=0;if(s&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?ki(r.origin):r.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=mr(s["!ref"]);c.s.c=h.s.c,c.s.r=h.s.r,c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),a==-1&&(c.e.r=a=h.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[g].length;++m)if(!(typeof e[g][m]>"u")){var y={v:e[g][m]},v=a+g,_=o+m;if(c.s.r>v&&(c.s.r=v),c.s.c>_&&(c.s.c=_),c.e.r<v&&(c.e.r=v),c.e.c<_&&(c.e.c=_),e[g][m]&&typeof e[g][m]=="object"&&!Array.isArray(e[g][m])&&!(e[g][m]instanceof Date))y=e[g][m];else if(Array.isArray(y.v)&&(y.f=e[g][m][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(r.nullError)y.t="e",y.v=0;else if(r.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=r.dateNF||Br[14],r.cellDates?(y.t="d",y.w=Gu(y.z,Hs(y.v))):(y.t="n",y.v=Hs(y.v),y.w=Gu(y.z,y.v))):y.t="s";if(i)s[v]||(s[v]=[]),s[v][_]&&s[v][_].z&&(y.z=s[v][_].z),s[v][_]=y;else{var E=Qn({c:_,r:v});s[E]&&s[E].z&&(y.z=s[E].z),s[E]=y}}}return c.s.c<1e7&&(s["!ref"]=ni(c)),s}function pg(n,e){return zB(null,n,e)}function j1e(n){return n.read_shift(4,"i")}function wo(n,e){return e||(e=Ne(4)),e.write_shift(4,n),e}function fs(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function Ii(n,e){var t=!1;return e==null&&(t=!0,e=Ne(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function V1e(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function B1e(n,e){return e||(e=Ne(4)),e.write_shift(2,0),e.write_shift(2,0),e}function cC(n,e){var t=n.l,r=n.read_shift(1),i=fs(n),s=[],a={t:i,h:i};if((r&1)!==0){for(var o=n.read_shift(4),l=0;l!=o;++l)s.push(V1e(n));a.r=s}else a.r=[{ich:0,ifnt:0}];return n.l=t+e,a}function G1e(n,e){var t=!1;return e==null&&(t=!0,e=Ne(15+4*n.t.length)),e.write_shift(1,0),Ii(n.t,e),t?e.slice(0,e.l):e}var z1e=cC;function U1e(n,e){var t=!1;return e==null&&(t=!0,e=Ne(23+4*n.t.length)),e.write_shift(1,1),Ii(n.t,e),e.write_shift(4,1),B1e({},e),t?e.slice(0,e.l):e}function Wa(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function jd(n,e){return e==null&&(e=Ne(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function Vd(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function Bd(n,e){return e==null&&(e=Ne(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var $1e=fs,UB=Ii;function uC(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function tw(n,e){var t=!1;return e==null&&(t=!0,e=Ne(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var W1e=fs,FR=uC,hC=tw;function $B(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var i=r===0?ew([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Dh(e,0)>>2;return t?i/100:i}function WB(n,e){e==null&&(e=Ne(4));var t=0,r=0,i=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?i:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function HB(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function H1e(n,e){return e||(e=Ne(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var Gd=HB,yg=H1e;function xg(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Sd(n,e){return(e||Ne(8)).write_shift(8,n,"f")}function K1e(n){var e={},t=n.read_shift(1),r=t>>>1,i=n.read_shift(1),s=n.read_shift(2,"i"),a=n.read_shift(1),o=n.read_shift(1),l=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var c=nxe[i];c&&(e.rgb=j5(c));break;case 2:e.rgb=j5([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function nw(n,e){if(e||(e=Ne(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function X1e(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function q1e(n,e){e||(e=Ne(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var KB=2,ra=3,$x=11,rw=19,Wx=64,Y1e=65,Z1e=71,J1e=4108,Q1e=4126,Gi=80,k5={1:{n:"CodePage",t:KB},2:{n:"Category",t:Gi},3:{n:"PresentationFormat",t:Gi},4:{n:"ByteCount",t:ra},5:{n:"LineCount",t:ra},6:{n:"ParagraphCount",t:ra},7:{n:"SlideCount",t:ra},8:{n:"NoteCount",t:ra},9:{n:"HiddenCount",t:ra},10:{n:"MultimediaClipCount",t:ra},11:{n:"ScaleCrop",t:$x},12:{n:"HeadingPairs",t:J1e},13:{n:"TitlesOfParts",t:Q1e},14:{n:"Manager",t:Gi},15:{n:"Company",t:Gi},16:{n:"LinksUpToDate",t:$x},17:{n:"CharacterCount",t:ra},19:{n:"SharedDoc",t:$x},22:{n:"HyperlinksChanged",t:$x},23:{n:"AppVersion",t:ra,p:"version"},24:{n:"DigSig",t:Y1e},26:{n:"ContentType",t:Gi},27:{n:"ContentStatus",t:Gi},28:{n:"Language",t:Gi},29:{n:"Version",t:Gi},255:{},2147483648:{n:"Locale",t:rw},2147483651:{n:"Behavior",t:rw},1919054434:{}},I5={1:{n:"CodePage",t:KB},2:{n:"Title",t:Gi},3:{n:"Subject",t:Gi},4:{n:"Author",t:Gi},5:{n:"Keywords",t:Gi},6:{n:"Comments",t:Gi},7:{n:"Template",t:Gi},8:{n:"LastAuthor",t:Gi},9:{n:"RevNumber",t:Gi},10:{n:"EditTime",t:Wx},11:{n:"LastPrinted",t:Wx},12:{n:"CreatedDate",t:Wx},13:{n:"ModifiedDate",t:Wx},14:{n:"PageCount",t:ra},15:{n:"WordCount",t:ra},16:{n:"CharCount",t:ra},17:{n:"Thumbnail",t:Z1e},18:{n:"Application",t:Gi},19:{n:"DocSecurity",t:ra},255:{},2147483648:{n:"Locale",t:rw},2147483651:{n:"Behavior",t:rw},1919054434:{}};function exe(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var txe=exe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),nxe=Ks(txe),n1={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},rxe={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Hx={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function XB(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function qB(n,e){var t=f1e(rxe),r=[],i;r[r.length]=si,r[r.length]=it("Types",null,{xmlns:Ri.CT,"xmlns:xsd":Ri.xsd,"xmlns:xsi":Ri.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return it("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){n[l]&&n[l].length>0&&(i=n[l][0],r[r.length]=it("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Hx[l][e.bookType]||Hx[l].xlsx}))},a=function(l){(n[l]||[]).forEach(function(c){r[r.length]=it("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Hx[l][e.bookType]||Hx[l].xlsx})})},o=function(l){(n[l]||[]).forEach(function(c){r[r.length]=it("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:t[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var Cn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function YB(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function T0(n){var e=[si,it("Relationships",null,{xmlns:Ri.RELS})];return Ki(n["!id"]).forEach(function(t){e[e.length]=it("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Kn(n,e,t,r,i,s){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=t,[Cn.HLINK,Cn.XPATH,Cn.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,e}function ixe(n){var e=[si];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function C5(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function sxe(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function axe(n){var e=[si];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(C5(n[t][0],n[t][1])),e.push(sxe("",n[t][0]));return e.push(C5("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function ZB(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Xv.version+"</meta:generator></office:meta></office:document-meta>"}var ed=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function MT(n,e,t,r,i){i[n]!=null||e==null||e===""||(i[n]=e,e=Zn(e),r[r.length]=t?it(n,e,t):Wi(n,e))}function JB(n,e){var t=e||{},r=[si,it("cp:coreProperties",null,{"xmlns:cp":Ri.CORE_PROPS,"xmlns:dc":Ri.dc,"xmlns:dcterms":Ri.dcterms,"xmlns:dcmitype":Ri.dcmitype,"xmlns:xsi":Ri.xsi})],i={};if(!n&&!t.Props)return r.join("");n&&(n.CreatedDate!=null&&MT("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:DR(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&MT("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:DR(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=ed.length;++s){var a=ed[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:n?n[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&MT(a[0],o,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var b0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],QB=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function eG(n){var e=[],t=it;return n||(n={}),n.Application="SheetJS",e[e.length]=si,e[e.length]=it("Properties",null,{xmlns:Ri.EXT_PROPS,"xmlns:vt":Ri.vt}),b0.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Zn(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(r[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+Zn(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function tG(n){var e=[si,it("Properties",null,{xmlns:Ri.CUST_PROPS,"xmlns:vt":Ri.vt})];if(!n)return e.join("");var t=1;return Ki(n).forEach(function(i){++t,e[e.length]=it("property",T1e(n[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Zn(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var P5={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function oxe(n,e){var t=[];return Ki(P5).map(function(r){for(var i=0;i<ed.length;++i)if(ed[i][1]==r)return ed[i];for(i=0;i<b0.length;++i)if(b0[i][1]==r)return b0[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(Wi(P5[r[1]]||r[1],i))}}),it("DocumentProperties",t.join(""),{xmlns:oa.o})}function lxe(n,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&Ki(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var a=0;a<ed.length;++a)if(s==ed[a][1])return;for(a=0;a<b0.length;++a)if(s==b0[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=n[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(it(x5(s),o,{"dt:dt":l}))}}),e&&Ki(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(it(x5(s),a,{"dt:dt":o}))}}),"<"+r+' xmlns="'+oa.o+'">'+i.join("")+"</"+r+">"}function cxe(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),i=(t-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var a=Ne(8);return a.write_shift(4,r),a.write_shift(4,i),a}function M5(n,e){var t=Ne(4),r=Ne(4);switch(t.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,e);break;case 5:r=Ne(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=cxe(e);break;case 31:case 80:for(r=Ne(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return $i([t,r])}var nG=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function uxe(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function N5(n,e,t){var r=Ne(8),i=[],s=[],a=8,o=0,l=Ne(8),c=Ne(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=Ne(8),c.write_shift(4,0),i.unshift(c);var h=[Ne(4)];for(h[0].write_shift(4,n.length),o=0;o<n.length;++o){var g=n[o][0];for(l=Ne(8+2*(g.length+1)+(g.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,g.length+1),l.write_shift(0,g,"dbcs");l.l!=l.length;)l.write_shift(1,0);h.push(l)}l=$i(h),s.unshift(l),a+=8+l.length}for(o=0;o<n.length;++o)if(!(e&&!e[n[o][0]])&&!(nG.indexOf(n[o][0])>-1||QB.indexOf(n[o][0])>-1)&&n[o][1]!=null){var m=n[o][1],y=0;if(e){y=+e[n[o][0]];var v=t[y];if(v.p=="version"&&typeof m=="string"){var _=m.split(".");m=(+_[0]<<16)+(+_[1]||0)}l=M5(v.t,m)}else{var E=uxe(m);E==-1&&(E=31,m=String(m)),l=M5(E,m)}s.push(l),c=Ne(8),c.write_shift(4,e?y:2+o),i.push(c),a+=8+l.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return r.write_shift(4,a),r.write_shift(4,s.length),$i([r].concat(i).concat(s))}function L5(n,e,t,r,i,s){var a=Ne(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,er.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=N5(n,t,r);if(o.push(l),i){var c=N5(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return $i(o)}function hxe(n,e){e||(e=Ne(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function dxe(n,e){return n.read_shift(e)===1}function ys(n,e){return e||(e=Ne(2)),e.write_shift(2,+!!n),e}function rG(n){return n.read_shift(2,"u")}function Ca(n,e){return e||(e=Ne(2)),e.write_shift(2,n),e}function iG(n,e,t){return t||(t=Ne(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function sG(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=n.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var a=r?n.read_shift(r,i):"";return a}function fxe(n){var e=n.t||"",t=Ne(3);t.write_shift(2,e.length),t.write_shift(1,1);var r=Ne(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[t,r];return $i(i)}function gxe(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function mxe(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):gxe(n,r,t)}function pxe(n,e,t){if(t.biff>5)return mxe(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function aG(n,e,t){return t||(t=Ne(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function O5(n,e){e||(e=Ne(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function yxe(n){var e=Ne(512),t=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)r=r.slice(1),O5(r,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&O5(i>-1?r.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),t=0;t<r.length-3*l;++t)e.write_shift(1,r.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function Td(n,e,t,r){return r||(r=Ne(6)),r.write_shift(2,n),r.write_shift(2,e),r.write_shift(2,t||0),r}function xxe(n,e,t){var r=t.biff>8?4:2,i=n.read_shift(r),s=n.read_shift(r,"i"),a=n.read_shift(r,"i");return[i,s,a]}function _xe(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:t}}}function oG(n,e){return e||(e=Ne(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function dC(n,e,t){var r=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ne(i);return s.write_shift(2,r),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function vxe(n,e){var t=!e||e.biff==8,r=Ne(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function wxe(n,e){var t=!e||e.biff>=8?2:1,r=Ne(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function Exe(n,e){var t=Ne(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=fxe(n[i]);var s=$i([t].concat(r));return s.parts=[t.length].concat(r.map(function(a){return a.length})),s}function Sxe(){var n=Ne(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function Txe(n){var e=Ne(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function bxe(n,e){var t=n.name||"Arial",r=e&&e.biff==5,i=r?15+t.length:16+2*t.length,s=Ne(i);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),s}function Rxe(n,e,t,r){var i=Ne(10);return Td(n,e,r,i),i.write_shift(4,t),i}function Axe(n,e,t,r,i){var s=!i||i.biff==8,a=Ne(8+ +s+(1+s)*t.length);return Td(n,e,r,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function kxe(n,e,t,r){var i=t&&t.biff==5;r||(r=Ne(i?3+e.length:5+2*e.length)),r.write_shift(2,n),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function Ixe(n,e){var t=e.biff==8||!e.biff?4:2,r=Ne(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function D5(n,e,t,r){var i=t&&t.biff==5;r||(r=Ne(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,e<<4));var s=0;return n.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function Cxe(n){var e=Ne(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Pxe(n,e,t,r,i,s){var a=Ne(8);return Td(n,e,r,a),iG(t,s,a),a}function Mxe(n,e,t,r){var i=Ne(14);return Td(n,e,r,i),Sd(t,i),i}function Nxe(n,e,t){if(t.biff<8)return Lxe(n,e,t);for(var r=[],i=n.l+e,s=n.read_shift(t.biff>8?4:2);s--!==0;)r.push(xxe(n,t.biff>8?12:6,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function Lxe(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=sG(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function Oxe(n){var e=Ne(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)oG(n[t],e);return e}function Dxe(n){var e=Ne(24),t=ki(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return $i([e,yxe(n[1])])}function Fxe(n){var e=n[1].Tooltip,t=Ne(10+2*(e.length+1));t.write_shift(2,2048);var r=ki(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function jxe(n){return n||(n=Ne(4)),n.write_shift(2,1),n.write_shift(2,1),n}function Vxe(n,e,t){if(!t.cellStyles)return gl(n,e);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),s=n.read_shift(r),a=n.read_shift(r),o=n.read_shift(r),l=n.read_shift(2);r==2&&(n.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}function Bxe(n,e){var t=Ne(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),r=n.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function Gxe(n){for(var e=Ne(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function zxe(n,e,t){var r=Ne(15);return i1(r,n,e),r.write_shift(8,t,"f"),r}function Uxe(n,e,t){var r=Ne(9);return i1(r,n,e),r.write_shift(2,t),r}var $xe=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=tC({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var c=[],h=Ed(1);switch(l.type){case"base64":h=ho(cc(o));break;case"binary":h=ho(o);break;case"buffer":case"array":h=o;break}sa(h,0);var g=h.read_shift(1),m=!!(g&136),y=!1,v=!1;switch(g){case 2:break;case 3:break;case 48:y=!0,m=!0;break;case 49:y=!0,m=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var _=0,E=521;g==2&&(_=h.read_shift(2)),h.l+=3,g!=2&&(_=h.read_shift(4)),_>1048576&&(_=1e6),g!=2&&(E=h.read_shift(2));var T=h.read_shift(2),b=l.codepage||1252;g!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(b=n[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var R=[],N={},D=Math.min(h.length,g==2?521:E-10-(y?264:0)),W=v?32:11;h.l<D&&h[h.l]!=13;)switch(N={},N.name=qv.utils.decode(b,h.slice(h.l,h.l+W)).replace(/[\u0000\r\n].*$/g,""),h.l+=W,N.type=String.fromCharCode(h.read_shift(1)),g!=2&&!v&&(N.offset=h.read_shift(4)),N.len=h.read_shift(1),g==2&&(N.offset=h.read_shift(2)),N.dec=h.read_shift(1),N.name.length&&R.push(N),g!=2&&(h.l+=v?13:14),N.type){case"B":(!y||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(h[h.l]!==13&&(h.l=E-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=E;var I=0,A=0;for(c[0]=[],A=0;A!=R.length;++A)c[0][A]=R[A].name;for(;_-- >0;){if(h[h.l]===42){h.l+=T;continue}for(++h.l,c[++I]=[],A=0,A=0;A!=R.length;++A){var M=h.slice(h.l,h.l+R[A].len);h.l+=R[A].len,sa(M,0);var O=qv.utils.decode(b,M);switch(R[A].type){case"C":O.trim().length&&(c[I][A]=O.replace(/\s+$/,""));break;case"D":O.length===8?c[I][A]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):c[I][A]=O;break;case"F":c[I][A]=parseFloat(O.trim());break;case"+":case"I":c[I][A]=v?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":c[I][A]=!0;break;case"N":case"F":c[I][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));c[I][A]="##MEMO##"+(v?parseInt(O.trim(),10):M.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(c[I][A]=+O||0);break;case"@":c[I][A]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":c[I][A]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":c[I][A]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[I][A]=-M.read_shift(-8,"f");break;case"B":if(y&&R[A].len==8){c[I][A]=M.read_shift(8,"f");break}case"G":case"P":M.l+=R[A].len;break;case"0":if(R[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+R[A].type)}}}if(g!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=R,c}function r(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var h=pg(t(o,c),c);return h["!cols"]=c.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete c.DBF,h}function i(o,l){try{return Fd(r(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&ey(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var h=Gs(),g=lw(o,{header:1,raw:!0,cellDates:!0}),m=g[0],y=g.slice(1),v=o["!cols"]||[],_=0,E=0,T=0,b=1;for(_=0;_<m.length;++_){if(((v[_]||{}).DBF||{}).name){m[_]=v[_].DBF.name,++T;continue}if(m[_]!=null){if(++T,typeof m[_]=="number"&&(m[_]=m[_].toString(10)),typeof m[_]!="string")throw new Error("DBF Invalid column name "+m[_]+" |"+typeof m[_]+"|");if(m.indexOf(m[_])!==_){for(E=0;E<1024;++E)if(m.indexOf(m[_]+"_"+E)==-1){m[_]+="_"+E;break}}}}var R=mr(o["!ref"]),N=[],D=[],W=[];for(_=0;_<=R.e.c-R.s.c;++_){var I="",A="",M=0,O=[];for(E=0;E<y.length;++E)y[E][_]!=null&&O.push(y[E][_]);if(O.length==0||m[_]==null){N[_]="?";continue}for(E=0;E<O.length;++E){switch(typeof O[E]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=O[E]instanceof Date?"D":"C";break;default:A="C"}M=Math.max(M,String(O[E]).length),I=I&&I!=A?"C":A}M>250&&(M=250),A=((v[_]||{}).DBF||{}).type,A=="C"&&v[_].DBF.len>M&&(M=v[_].DBF.len),I=="B"&&A=="N"&&(I="N",W[_]=v[_].DBF.dec,M=v[_].DBF.len),D[_]=I=="C"||A=="N"?M:s[I]||0,b+=D[_],N[_]=I}var L=h.next(32);for(L.write_shift(4,318902576),L.write_shift(4,y.length),L.write_shift(2,296+32*T),L.write_shift(2,b),_=0;_<4;++_)L.write_shift(4,0);for(L.write_shift(4,0|(+e[cB]||3)<<8),_=0,E=0;_<m.length;++_)if(m[_]!=null){var z=h.next(32),j=(m[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);z.write_shift(1,j,"sbcs"),z.write_shift(1,N[_]=="?"?"C":N[_],"sbcs"),z.write_shift(4,E),z.write_shift(1,D[_]||s[N[_]]||0),z.write_shift(1,W[_]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),E+=D[_]||s[N[_]]||0}var Ee=h.next(264);for(Ee.write_shift(4,13),_=0;_<65;++_)Ee.write_shift(4,0);for(_=0;_<y.length;++_){var Ce=h.next(b);for(Ce.write_shift(1,0),E=0;E<m.length;++E)if(m[E]!=null)switch(N[E]){case"L":Ce.write_shift(1,y[_][E]==null?63:y[_][E]?84:70);break;case"B":Ce.write_shift(8,y[_][E]||0,"f");break;case"N":var Ge="0";for(typeof y[_][E]=="number"&&(Ge=y[_][E].toFixed(W[E]||0)),T=0;T<D[E]-Ge.length;++T)Ce.write_shift(1,32);Ce.write_shift(1,Ge,"sbcs");break;case"D":y[_][E]?(Ce.write_shift(4,("0000"+y[_][E].getFullYear()).slice(-4),"sbcs"),Ce.write_shift(2,("00"+(y[_][E].getMonth()+1)).slice(-2),"sbcs"),Ce.write_shift(2,("00"+y[_][E].getDate()).slice(-2),"sbcs")):Ce.write_shift(8,"00000000","sbcs");break;case"C":var Le=String(y[_][E]!=null?y[_][E]:"").slice(0,D[E]);for(Ce.write_shift(1,Le,"sbcs"),T=0;T<D[E]-Le.length;++T)Ce.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:r,from_sheet:a}})(),Wxe=(function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ki(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(m,y){var v=n[y];return typeof v=="number"?a5(v):v},r=function(m,y,v){var _=y.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return _==59?m:a5(_)};n["|"]=254;function i(m,y){switch(y.type){case"base64":return s(cc(m),y);case"binary":return s(m,y);case"buffer":return s(On&&Buffer.isBuffer(m)?m.toString("binary"):Qy(m),y);case"array":return s(CE(m),y)}throw new Error("Unrecognized type "+y.type)}function s(m,y){var v=m.split(/[\n\r]+/),_=-1,E=-1,T=0,b=0,R=[],N=[],D=null,W={},I=[],A=[],M=[],O=0,L;for(+y.codepage>=0&&ey(+y.codepage);T!==v.length;++T){O=0;var z=v[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),j=z.replace(/;;/g,"\0").split(";").map(function(se){return se.replace(/\u0000/g,";")}),Ee=j[0],Ce;if(z.length>0)switch(Ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":j[1].charAt(0)=="P"&&N.push(z.slice(3).replace(/;;/g,";"));break;case"C":var Ge=!1,Le=!1,ce=!1,Me=!1,Te=-1,ie=-1;for(b=1;b<j.length;++b)switch(j[b].charAt(0)){case"A":break;case"X":E=parseInt(j[b].slice(1))-1,Le=!0;break;case"Y":for(_=parseInt(j[b].slice(1))-1,Le||(E=0),L=R.length;L<=_;++L)R[L]=[];break;case"K":Ce=j[b].slice(1),Ce.charAt(0)==='"'?Ce=Ce.slice(1,Ce.length-1):Ce==="TRUE"?Ce=!0:Ce==="FALSE"?Ce=!1:isNaN(ec(Ce))?isNaN(ny(Ce).getDate())||(Ce=Ts(Ce)):(Ce=ec(Ce),D!==null&&wB(D)&&(Ce=bB(Ce))),Ge=!0;break;case"E":Me=!0;var V=U_e(j[b].slice(1),{r:_,c:E});R[_][E]=[R[_][E],V];break;case"S":ce=!0,R[_][E]=[R[_][E],"S5S"];break;case"G":break;case"R":Te=parseInt(j[b].slice(1))-1;break;case"C":ie=parseInt(j[b].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}if(Ge&&(R[_][E]&&R[_][E].length==2?R[_][E][0]=Ce:R[_][E]=Ce,D=null),ce){if(Me)throw new Error("SYLK shared formula cannot have own formula");var Z=Te>-1&&R[Te][ie];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");R[_][E][1]=$_e(Z[1],{r:_-Te,c:E-ie})}break;case"F":var te=0;for(b=1;b<j.length;++b)switch(j[b].charAt(0)){case"X":E=parseInt(j[b].slice(1))-1,++te;break;case"Y":for(_=parseInt(j[b].slice(1))-1,L=R.length;L<=_;++L)R[L]=[];break;case"M":O=parseInt(j[b].slice(1))/20;break;case"F":break;case"G":break;case"P":D=N[parseInt(j[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=j[b].slice(1).split(" "),L=parseInt(M[0],10);L<=parseInt(M[1],10);++L)O=parseInt(M[2],10),A[L-1]=O===0?{hidden:!0}:{wch:O},fC(A[L-1]);break;case"C":E=parseInt(j[b].slice(1))-1,A[E]||(A[E]={});break;case"R":_=parseInt(j[b].slice(1))-1,I[_]||(I[_]={}),O>0?(I[_].hpt=O,I[_].hpx=dG(O)):O===0&&(I[_].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}te<1&&(D=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}}return I.length>0&&(W["!rows"]=I),A.length>0&&(W["!cols"]=A),y&&y.sheetRows&&(R=R.slice(0,y.sheetRows)),[R,W]}function a(m,y){var v=i(m,y),_=v[0],E=v[1],T=pg(_,y);return Ki(E).forEach(function(b){T[b]=E[b]}),T}function o(m,y){return Fd(a(m,y),y)}function l(m,y,v,_){var E="C;Y"+(v+1)+";X"+(_+1)+";K";switch(m.t){case"n":E+=m.v||0,m.f&&!m.F&&(E+=";E"+mC(m.f,{r:v,c:_}));break;case"b":E+=m.v?"TRUE":"FALSE";break;case"e":E+=m.w||m.v;break;case"d":E+='"'+(m.w||m.v)+'"';break;case"s":E+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function c(m,y){y.forEach(function(v,_){var E="F;W"+(_+1)+" "+(_+1)+" ";v.hidden?E+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=iw(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=sw(v.wpx)),typeof v.wch=="number"&&(E+=Math.round(v.wch))),E.charAt(E.length-1)!=" "&&m.push(E)})}function h(m,y){y.forEach(function(v,_){var E="F;";v.hidden?E+="M0;":v.hpt?E+="M"+20*v.hpt+";":v.hpx&&(E+="M"+20*aw(v.hpx)+";"),E.length>2&&m.push(E+"R"+(_+1))})}function g(m,y){var v=["ID;PWXL;N;E"],_=[],E=mr(m["!ref"]),T,b=Array.isArray(m),R=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),m["!cols"]&&c(v,m["!cols"]),m["!rows"]&&h(v,m["!rows"]),v.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var N=E.s.r;N<=E.e.r;++N)for(var D=E.s.c;D<=E.e.c;++D){var W=Qn({r:N,c:D});T=b?(m[N]||[])[D]:m[W],!(!T||T.v==null&&(!T.f||T.F))&&_.push(l(T,m,N,D))}return v.join(R)+R+_.join(R)+R+"E"+R}return{to_workbook:o,to_sheet:a,from_sheet:g}})(),Hxe=(function(){function n(s,a){switch(a.type){case"base64":return e(cc(s),a);case"binary":return e(s,a);case"buffer":return e(On&&Buffer.isBuffer(s)?s.toString("binary"):Qy(s),a);case"array":return e(CE(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,h=0,g=[];h!==o.length;++h){if(o[h].trim()==="BOT"){g[++l]=[],c=0;continue}if(!(l<0)){var m=o[h].trim().split(","),y=m[0],v=m[1];++h;for(var _=o[h]||"";(_.match(/["]/g)||[]).length&1&&h<o.length-1;)_+=`
`+o[++h];switch(_=_.trim(),+y){case-1:if(_==="BOT"){g[++l]=[],c=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?g[l][c]=!0:_==="FALSE"?g[l][c]=!1:isNaN(ec(v))?isNaN(ny(v).getDate())?g[l][c]=v:g[l][c]=Ts(v):g[l][c]=ec(v),++c;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),g[l][c++]=_!==""?_:null;break}if(_==="EOD")break}}return a&&a.sheetRows&&(g=g.slice(0,a.sheetRows)),g}function t(s,a){return pg(n(s,a),a)}function r(s,a){return Fd(t(s,a),a)}var i=(function(){var s=function(l,c,h,g,m){l.push(c),l.push(h+","+g),l.push('"'+m.replace(/"/g,'""')+'"')},a=function(l,c,h,g){l.push(c+","+h),l.push(c==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(l){var c=[],h=mr(l["!ref"]),g,m=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,h.e.r-h.s.r+1,""),s(c,"TUPLES",0,h.e.c-h.s.c+1,""),s(c,"DATA",0,0,"");for(var y=h.s.r;y<=h.e.r;++y){a(c,-1,0,"BOT");for(var v=h.s.c;v<=h.e.c;++v){var _=Qn({r:y,c:v});if(g=m?(l[y]||[])[v]:l[_],!g){a(c,1,0,"");continue}switch(g.t){case"n":var E=g.w;!E&&g.v!=null&&(E=g.v),E==null?g.f&&!g.F?a(c,1,0,"="+g.f):a(c,1,0,""):a(c,0,E,"V");break;case"b":a(c,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Gu(g.z||Br[14],Hs(Ts(g.v)))),a(c,0,g.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var T=`\r
`,b=c.join(T);return b}})();return{to_workbook:r,to_sheet:t,from_sheet:i}})(),lG=(function(){function n(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,m){for(var y=g.split(`
`),v=-1,_=-1,E=0,T=[];E!==y.length;++E){var b=y[E].trim().split(":");if(b[0]==="cell"){var R=ki(b[1]);if(T.length<=R.r)for(v=T.length;v<=R.r;++v)T[v]||(T[v]=[]);switch(v=R.r,_=R.c,b[2]){case"t":T[v][_]=n(b[3]);break;case"v":T[v][_]=+b[3];break;case"vtf":var N=b[b.length-1];case"vtc":switch(b[3]){case"nl":T[v][_]=!!+b[4];break;default:T[v][_]=+b[4];break}b[2]=="vtf"&&(T[v][_]=[T[v][_],N])}}}return m&&m.sheetRows&&(T=T.slice(0,m.sheetRows)),T}function r(g,m){return pg(t(g,m),m)}function i(g,m){return Fd(r(g,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(g){if(!g||!g["!ref"])return"";for(var m=[],y=[],v,_="",E=pa(g["!ref"]),T=Array.isArray(g),b=E.s.r;b<=E.e.r;++b)for(var R=E.s.c;R<=E.e.c;++R)if(_=Qn({r:b,c:R}),v=T?(g[b]||[])[R]:g[_],!(!v||v.v==null||v.t==="z")){switch(y=["cell",_,"t"],v.t){case"s":case"str":y.push(e(v.v));break;case"n":v.f?(y[2]="vtf",y[3]="n",y[4]=v.v,y[5]=e(v.f)):(y[2]="v",y[3]=v.v);break;case"b":y[2]="vt"+(v.f?"f":"c"),y[3]="nl",y[4]=v.v?"1":"0",y[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var N=Hs(Ts(v.v));y[2]="vtc",y[3]="nd",y[4]=""+N,y[5]=v.w||Gu(v.z||Br[14],N);break;case"e":continue}m.push(y.join(":"))}return m.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(g){return[s,a,o,a,c(g),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:h}})(),Kxe=(function(){function n(h,g,m,y,v){v.raw?g[m][y]=h:h===""||(h==="TRUE"?g[m][y]=!0:h==="FALSE"?g[m][y]=!1:isNaN(ec(h))?isNaN(ny(h).getDate())?g[m][y]=h:g[m][y]=Ts(h):g[m][y]=ec(h))}function e(h,g){var m=g||{},y=[];if(!h||h.length===0)return y;for(var v=h.split(/[\r\n]/),_=v.length-1;_>=0&&v[_].length===0;)--_;for(var E=10,T=0,b=0;b<=_;++b)T=v[b].indexOf(" "),T==-1?T=v[b].length:T++,E=Math.max(E,T);for(b=0;b<=_;++b){y[b]=[];var R=0;for(n(v[b].slice(0,E).trim(),y,b,R,m),R=1;R<=(v[b].length-E)/10+1;++R)n(v[b].slice(E+(R-1)*10,E+R*10).trim(),y,b,R,m)}return m.sheetRows&&(y=y.slice(0,m.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(h){for(var g={},m=!1,y=0,v=0;y<h.length;++y)(v=h.charCodeAt(y))==34?m=!m:!m&&v in t&&(g[v]=(g[v]||0)+1);v=[];for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&v.push([g[y],y]);if(!v.length){g=r;for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&v.push([g[y],y])}return v.sort(function(_,E){return _[0]-E[0]||r[_[1]]-r[E[1]]}),t[v.pop()[1]]||44}function s(h,g){var m=g||{},y="",v=m.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(y=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(y=h.charAt(4),h=h.slice(6)):y=i(h.slice(0,1024)):m&&m.FS?y=m.FS:y=i(h.slice(0,1024));var E=0,T=0,b=0,R=0,N=0,D=y.charCodeAt(0),W=!1,I=0,A=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var M=m.dateNF!=null?c1e(m.dateNF):null;function O(){var L=h.slice(R,N),z={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)z.t="z";else if(m.raw)z.t="s",z.v=L;else if(L.trim().length===0)z.t="s",z.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(z.t="s",z.v=L.slice(2,-1).replace(/""/g,'"')):W_e(L)?(z.t="n",z.f=L.slice(1)):(z.t="s",z.v=L);else if(L=="TRUE")z.t="b",z.v=!0;else if(L=="FALSE")z.t="b",z.v=!1;else if(!isNaN(b=ec(L)))z.t="n",m.cellText!==!1&&(z.w=L),z.v=b;else if(!isNaN(ny(L).getDate())||M&&L.match(M)){z.z=m.dateNF||Br[14];var j=0;M&&L.match(M)&&(L=u1e(L,m.dateNF,L.match(M)||[]),j=1),m.cellDates?(z.t="d",z.v=Ts(L,j)):(z.t="n",z.v=Hs(Ts(L,j))),m.cellText!==!1&&(z.w=Gu(z.z,z.v instanceof Date?Hs(z.v):z.v)),m.cellNF||delete z.z}else z.t="s",z.v=L;if(z.t=="z"||(m.dense?(v[E]||(v[E]=[]),v[E][T]=z):v[Qn({c:T,r:E})]=z),R=N+1,A=h.charCodeAt(R),_.e.c<T&&(_.e.c=T),_.e.r<E&&(_.e.r=E),I==D)++T;else if(T=0,++E,m.sheetRows&&m.sheetRows<=E)return!0}e:for(;N<h.length;++N)switch(I=h.charCodeAt(N)){case 34:A===34&&(W=!W);break;case D:case 10:case 13:if(!W&&O())break e;break}return N-R>0&&O(),v["!ref"]=ni(_),v}function a(h,g){return!(g&&g.PRN)||g.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,g):pg(e(h,g),g)}function o(h,g){var m="",y=g.type=="string"?[0,0,0,0]:sSe(h,g);switch(g.type){case"base64":m=cc(h);break;case"binary":m=h;break;case"buffer":g.codepage==65001?m=h.toString("utf8"):g.codepage&&typeof qv<"u"||(m=On&&Buffer.isBuffer(h)?h.toString("binary"):Qy(h));break;case"array":m=CE(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+g.type)}return y[0]==239&&y[1]==187&&y[2]==191?m=ap(m.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?m=ap(m):g.type=="binary"&&typeof qv<"u",m.slice(0,19)=="socialcalc:version:"?lG.to_sheet(g.type=="string"?m:ap(m),g):a(m,g)}function l(h,g){return Fd(o(h,g),g)}function c(h){for(var g=[],m=mr(h["!ref"]),y,v=Array.isArray(h),_=m.s.r;_<=m.e.r;++_){for(var E=[],T=m.s.c;T<=m.e.c;++T){var b=Qn({r:_,c:T});if(y=v?(h[_]||[])[T]:h[b],!y||y.v==null){E.push("          ");continue}for(var R=(y.w||(uc(y),y.w)||"").slice(0,10);R.length<10;)R+=" ";E.push(R+(T===0?" ":""))}g.push(E.join(""))}return g.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}})(),F5=(function(){function n(V,Z,te){if(V){sa(V,V.l||0);for(var se=te.Enum||Te;V.l<V.length;){var he=V.read_shift(2),Ae=se[he]||se[65535],Fe=V.read_shift(2),de=V.l+Fe,Pe=Ae.f&&Ae.f(V,Fe,te);if(V.l=de,Z(Pe,Ae,he))return}}}function e(V,Z){switch(Z.type){case"base64":return t(ho(cc(V)),Z);case"binary":return t(ho(V),Z);case"buffer":case"array":return t(V,Z)}throw"Unsupported type "+Z.type}function t(V,Z){if(!V)return V;var te=Z||{},se=te.dense?[]:{},he="Sheet1",Ae="",Fe=0,de={},Pe=[],Be=[],It={s:{r:0,c:0},e:{r:0,c:0}},Wt=te.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)te.Enum=Te,n(V,function(ht,rr,hn){switch(hn){case 0:te.vers=ht,ht>=4096&&(te.qpro=!0);break;case 6:It=ht;break;case 204:ht&&(Ae=ht);break;case 222:Ae=ht;break;case 15:case 51:te.qpro||(ht[1].v=ht[1].v.slice(1));case 13:case 14:case 16:hn==14&&(ht[2]&112)==112&&(ht[2]&15)>1&&(ht[2]&15)<15&&(ht[1].z=te.dateNF||Br[14],te.cellDates&&(ht[1].t="d",ht[1].v=bB(ht[1].v))),te.qpro&&ht[3]>Fe&&(se["!ref"]=ni(It),de[he]=se,Pe.push(he),se=te.dense?[]:{},It={s:{r:0,c:0},e:{r:0,c:0}},Fe=ht[3],he=Ae||"Sheet"+(Fe+1),Ae="");var cn=te.dense?(se[ht[0].r]||[])[ht[0].c]:se[Qn(ht[0])];if(cn){cn.t=ht[1].t,cn.v=ht[1].v,ht[1].z!=null&&(cn.z=ht[1].z),ht[1].f!=null&&(cn.f=ht[1].f);break}te.dense?(se[ht[0].r]||(se[ht[0].r]=[]),se[ht[0].r][ht[0].c]=ht[1]):se[Qn(ht[0])]=ht[1];break}},te);else if(V[2]==26||V[2]==14)te.Enum=ie,V[2]==14&&(te.qpro=!0,V.l=0),n(V,function(ht,rr,hn){switch(hn){case 204:he=ht;break;case 22:ht[1].v=ht[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ht[3]>Fe&&(se["!ref"]=ni(It),de[he]=se,Pe.push(he),se=te.dense?[]:{},It={s:{r:0,c:0},e:{r:0,c:0}},Fe=ht[3],he="Sheet"+(Fe+1)),Wt>0&&ht[0].r>=Wt)break;te.dense?(se[ht[0].r]||(se[ht[0].r]=[]),se[ht[0].r][ht[0].c]=ht[1]):se[Qn(ht[0])]=ht[1],It.e.c<ht[0].c&&(It.e.c=ht[0].c),It.e.r<ht[0].r&&(It.e.r=ht[0].r);break;case 27:ht[14e3]&&(Be[ht[14e3][0]]=ht[14e3][1]);break;case 1537:Be[ht[0]]=ht[1],ht[0]==Fe&&(he=ht[1]);break}},te);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(se["!ref"]=ni(It),de[Ae||he]=se,Pe.push(Ae||he),!Be.length)return{SheetNames:Pe,Sheets:de};for(var Dt={},Zt=[],rn=0;rn<Be.length;++rn)de[Pe[rn]]?(Zt.push(Be[rn]||Pe[rn]),Dt[Be[rn]]=de[Be[rn]]||de[Pe[rn]]):(Zt.push(Be[rn]),Dt[Be[rn]]={"!ref":"A1"});return{SheetNames:Zt,Sheets:Dt}}function r(V,Z){var te=Z||{};if(+te.codepage>=0&&ey(+te.codepage),te.type=="string")throw new Error("Cannot write WK1 to JS string");var se=Gs(),he=mr(V["!ref"]),Ae=Array.isArray(V),Fe=[];st(se,0,s(1030)),st(se,6,l(he));for(var de=Math.min(he.e.r,8191),Pe=he.s.r;Pe<=de;++Pe)for(var Be=Hi(Pe),It=he.s.c;It<=he.e.c;++It){Pe===he.s.r&&(Fe[It]=ds(It));var Wt=Fe[It]+Be,Dt=Ae?(V[Pe]||[])[It]:V[Wt];if(!(!Dt||Dt.t=="z"))if(Dt.t=="n")(Dt.v|0)==Dt.v&&Dt.v>=-32768&&Dt.v<=32767?st(se,13,y(Pe,It,Dt.v)):st(se,14,_(Pe,It,Dt.v));else{var Zt=uc(Dt);st(se,15,g(Pe,It,Zt.slice(0,239)))}}return st(se,1),se.end()}function i(V,Z){var te=Z||{};if(+te.codepage>=0&&ey(+te.codepage),te.type=="string")throw new Error("Cannot write WK3 to JS string");var se=Gs();st(se,0,a(V));for(var he=0,Ae=0;he<V.SheetNames.length;++he)(V.Sheets[V.SheetNames[he]]||{})["!ref"]&&st(se,27,Me(V.SheetNames[he],Ae++));var Fe=0;for(he=0;he<V.SheetNames.length;++he){var de=V.Sheets[V.SheetNames[he]];if(!(!de||!de["!ref"])){for(var Pe=mr(de["!ref"]),Be=Array.isArray(de),It=[],Wt=Math.min(Pe.e.r,8191),Dt=Pe.s.r;Dt<=Wt;++Dt)for(var Zt=Hi(Dt),rn=Pe.s.c;rn<=Pe.e.c;++rn){Dt===Pe.s.r&&(It[rn]=ds(rn));var ht=It[rn]+Zt,rr=Be?(de[Dt]||[])[rn]:de[ht];if(!(!rr||rr.t=="z"))if(rr.t=="n")st(se,23,O(Dt,rn,Fe,rr.v));else{var hn=uc(rr);st(se,22,I(Dt,rn,Fe,hn.slice(0,239)))}}++Fe}}return st(se,1),se.end()}function s(V){var Z=Ne(2);return Z.write_shift(2,V),Z}function a(V){var Z=Ne(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var te=0,se=0,he=0,Ae=0;Ae<V.SheetNames.length;++Ae){var Fe=V.SheetNames[Ae],de=V.Sheets[Fe];if(!(!de||!de["!ref"])){++he;var Pe=pa(de["!ref"]);te<Pe.e.r&&(te=Pe.e.r),se<Pe.e.c&&(se=Pe.e.c)}}return te>8191&&(te=8191),Z.write_shift(2,te),Z.write_shift(1,he),Z.write_shift(1,se),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}function o(V,Z,te){var se={s:{c:0,r:0},e:{c:0,r:0}};return Z==8&&te.qpro?(se.s.c=V.read_shift(1),V.l++,se.s.r=V.read_shift(2),se.e.c=V.read_shift(1),V.l++,se.e.r=V.read_shift(2),se):(se.s.c=V.read_shift(2),se.s.r=V.read_shift(2),Z==12&&te.qpro&&(V.l+=2),se.e.c=V.read_shift(2),se.e.r=V.read_shift(2),Z==12&&te.qpro&&(V.l+=2),se.s.c==65535&&(se.s.c=se.e.c=se.s.r=se.e.r=0),se)}function l(V){var Z=Ne(8);return Z.write_shift(2,V.s.c),Z.write_shift(2,V.s.r),Z.write_shift(2,V.e.c),Z.write_shift(2,V.e.r),Z}function c(V,Z,te){var se=[{c:0,r:0},{t:"n",v:0},0,0];return te.qpro&&te.vers!=20768?(se[0].c=V.read_shift(1),se[3]=V.read_shift(1),se[0].r=V.read_shift(2),V.l+=2):(se[2]=V.read_shift(1),se[0].c=V.read_shift(2),se[0].r=V.read_shift(2)),se}function h(V,Z,te){var se=V.l+Z,he=c(V,Z,te);if(he[1].t="s",te.vers==20768){V.l++;var Ae=V.read_shift(1);return he[1].v=V.read_shift(Ae,"utf8"),he}return te.qpro&&V.l++,he[1].v=V.read_shift(se-V.l,"cstr"),he}function g(V,Z,te){var se=Ne(7+te.length);se.write_shift(1,255),se.write_shift(2,Z),se.write_shift(2,V),se.write_shift(1,39);for(var he=0;he<se.length;++he){var Ae=te.charCodeAt(he);se.write_shift(1,Ae>=128?95:Ae)}return se.write_shift(1,0),se}function m(V,Z,te){var se=c(V,Z,te);return se[1].v=V.read_shift(2,"i"),se}function y(V,Z,te){var se=Ne(7);return se.write_shift(1,255),se.write_shift(2,Z),se.write_shift(2,V),se.write_shift(2,te,"i"),se}function v(V,Z,te){var se=c(V,Z,te);return se[1].v=V.read_shift(8,"f"),se}function _(V,Z,te){var se=Ne(13);return se.write_shift(1,255),se.write_shift(2,Z),se.write_shift(2,V),se.write_shift(8,te,"f"),se}function E(V,Z,te){var se=V.l+Z,he=c(V,Z,te);if(he[1].v=V.read_shift(8,"f"),te.qpro)V.l=se;else{var Ae=V.read_shift(2);N(V.slice(V.l,V.l+Ae),he),V.l+=Ae}return he}function T(V,Z,te){var se=Z&32768;return Z&=-32769,Z=(se?V:0)+(Z>=8192?Z-16384:Z),(se?"":"$")+(te?ds(Z):Hi(Z))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},R=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(V,Z){sa(V,0);for(var te=[],se=0,he="",Ae="",Fe="",de="";V.l<V.length;){var Pe=V[V.l++];switch(Pe){case 0:te.push(V.read_shift(8,"f"));break;case 1:Ae=T(Z[0].c,V.read_shift(2),!0),he=T(Z[0].r,V.read_shift(2),!1),te.push(Ae+he);break;case 2:{var Be=T(Z[0].c,V.read_shift(2),!0),It=T(Z[0].r,V.read_shift(2),!1);Ae=T(Z[0].c,V.read_shift(2),!0),he=T(Z[0].r,V.read_shift(2),!1),te.push(Be+It+":"+Ae+he)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:te.push("("+te.pop()+")");break;case 5:te.push(V.read_shift(2));break;case 6:{for(var Wt="";Pe=V[V.l++];)Wt+=String.fromCharCode(Pe);te.push('"'+Wt.replace(/"/g,'""')+'"')}break;case 8:te.push("-"+te.pop());break;case 23:te.push("+"+te.pop());break;case 22:te.push("NOT("+te.pop()+")");break;case 20:case 21:de=te.pop(),Fe=te.pop(),te.push(["AND","OR"][Pe-20]+"("+Fe+","+de+")");break;default:if(Pe<32&&R[Pe])de=te.pop(),Fe=te.pop(),te.push(Fe+R[Pe]+de);else if(b[Pe]){if(se=b[Pe][1],se==69&&(se=V[V.l++]),se>te.length){console.error("WK1 bad formula parse 0x"+Pe.toString(16)+":|"+te.join("|")+"|");return}var Dt=te.slice(-se);te.length-=se,te.push(b[Pe][0]+"("+Dt.join(",")+")")}else return Pe<=7?console.error("WK1 invalid opcode "+Pe.toString(16)):Pe<=24?console.error("WK1 unsupported op "+Pe.toString(16)):Pe<=30?console.error("WK1 invalid opcode "+Pe.toString(16)):Pe<=115?console.error("WK1 unsupported function opcode "+Pe.toString(16)):console.error("WK1 unrecognized opcode "+Pe.toString(16))}}te.length==1?Z[1].f=""+te[0]:console.error("WK1 bad formula parse |"+te.join("|")+"|")}function D(V){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=V.read_shift(2),Z[3]=V[V.l++],Z[0].c=V[V.l++],Z}function W(V,Z){var te=D(V);return te[1].t="s",te[1].v=V.read_shift(Z-4,"cstr"),te}function I(V,Z,te,se){var he=Ne(6+se.length);he.write_shift(2,V),he.write_shift(1,te),he.write_shift(1,Z),he.write_shift(1,39);for(var Ae=0;Ae<se.length;++Ae){var Fe=se.charCodeAt(Ae);he.write_shift(1,Fe>=128?95:Fe)}return he.write_shift(1,0),he}function A(V,Z){var te=D(V);te[1].v=V.read_shift(2);var se=te[1].v>>1;if(te[1].v&1)switch(se&7){case 0:se=(se>>3)*5e3;break;case 1:se=(se>>3)*500;break;case 2:se=(se>>3)/20;break;case 3:se=(se>>3)/200;break;case 4:se=(se>>3)/2e3;break;case 5:se=(se>>3)/2e4;break;case 6:se=(se>>3)/16;break;case 7:se=(se>>3)/64;break}return te[1].v=se,te}function M(V,Z){var te=D(V),se=V.read_shift(4),he=V.read_shift(4),Ae=V.read_shift(2);if(Ae==65535)return se===0&&he===3221225472?(te[1].t="e",te[1].v=15):se===0&&he===3489660928?(te[1].t="e",te[1].v=42):te[1].v=0,te;var Fe=Ae&32768;return Ae=(Ae&32767)-16446,te[1].v=(1-Fe*2)*(he*Math.pow(2,Ae+32)+se*Math.pow(2,Ae)),te}function O(V,Z,te,se){var he=Ne(14);if(he.write_shift(2,V),he.write_shift(1,te),he.write_shift(1,Z),se==0)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var Ae=0,Fe=0,de=0,Pe=0;return se<0&&(Ae=1,se=-se),Fe=Math.log2(se)|0,se/=Math.pow(2,Fe-31),Pe=se>>>0,(Pe&2147483648)==0&&(se/=2,++Fe,Pe=se>>>0),se-=Pe,Pe|=2147483648,Pe>>>=0,se*=Math.pow(2,32),de=se>>>0,he.write_shift(4,de),he.write_shift(4,Pe),Fe+=16383+(Ae?32768:0),he.write_shift(2,Fe),he}function L(V,Z){var te=M(V);return V.l+=Z-14,te}function z(V,Z){var te=D(V),se=V.read_shift(4);return te[1].v=se>>6,te}function j(V,Z){var te=D(V),se=V.read_shift(8,"f");return te[1].v=se,te}function Ee(V,Z){var te=j(V);return V.l+=Z-10,te}function Ce(V,Z){return V[V.l+Z-1]==0?V.read_shift(Z,"cstr"):""}function Ge(V,Z){var te=V[V.l++];te>Z-1&&(te=Z-1);for(var se="";se.length<te;)se+=String.fromCharCode(V[V.l++]);return se}function Le(V,Z,te){if(!(!te.qpro||Z<21)){var se=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var he=V.read_shift(Z-21,"cstr");return[se,he]}}function ce(V,Z){for(var te={},se=V.l+Z;V.l<se;){var he=V.read_shift(2);if(he==14e3){for(te[he]=[0,""],te[he][0]=V.read_shift(2);V[V.l];)te[he][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return te}function Me(V,Z){var te=Ne(5+V.length);te.write_shift(2,14e3),te.write_shift(2,Z);for(var se=0;se<V.length;++se){var he=V.charCodeAt(se);te[te.l++]=he>127?95:he}return te[te.l++]=0,te}var Te={0:{n:"BOF",f:rG},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ce},222:{n:"SHEETNAMELP",f:Ge},65535:{n:""}},ie={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ce},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:z},38:{n:"??"},39:{n:"NUMBER27",f:j},40:{n:"FORMULA28",f:Ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}})(),Xxe=/^\s|\s$|[\t\n\r]/;function cG(n,e){if(!e.bookSST)return"";var t=[si];t[t.length]=it("sst",null,{xmlns:mg[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(Xxe)&&(s+=' xml:space="preserve"'),s+=">"+Zn(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function qxe(n){return[n.read_shift(4),n.read_shift(4)]}function Yxe(n,e){return e||(e=Ne(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var Zxe=G1e;function Jxe(n){var e=Gs();Ue(e,159,Yxe(n));for(var t=0;t<n.length;++t)Ue(e,19,Zxe(n[t]));return Ue(e,160),e.end()}function Qxe(n){for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function uG(n){var e=0,t,r=Qxe(n),i=r.length+1,s,a,o,l,c;for(t=Ed(i),t[0]=r.length,s=1;s!=i;++s)t[s]=r[s-1];for(s=i-1;s>=0;--s)a=t[s],o=(e&16384)===0?0:1,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var e_e=(function(){function n(i,s){switch(s.type){case"base64":return e(cc(i),s);case"binary":return e(i,s);case"buffer":return e(On&&Buffer.isBuffer(i)?i.toString("binary"):Qy(i),s);case"array":return e(CE(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,g){Array.isArray(o)&&(o[g]=[]);for(var m=/\\\w+\b/g,y=0,v,_=-1;v=m.exec(h);){switch(v[0]){case"\\cell":var E=h.slice(y,m.lastIndex-v[0].length);if(E[0]==" "&&(E=E.slice(1)),++_,E.length){var T={v:E,t:"s"};Array.isArray(o)?o[g][_]=T:o[Qn({r:g,c:_})]=T}break}y=m.lastIndex}_>c.e.c&&(c.e.c=_)}),o["!ref"]=ni(c),o}function t(i,s){return Fd(n(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],a=mr(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var g=Qn({r:c,c:h});o=l?(i[c]||[])[h]:i[g],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(uc(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:r}})();function j5(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var t_e=6,tc=t_e;function iw(n){return Math.floor((n+Math.round(128/tc)/256)*tc)}function sw(n){return Math.floor((n-5)/tc*100+.5)/100}function jR(n){return Math.round((n*tc+5)/tc*256)/256}function fC(n){n.width?(n.wpx=iw(n.width),n.wch=sw(n.wpx),n.MDW=tc):n.wpx?(n.wch=sw(n.wpx),n.width=jR(n.wch),n.MDW=tc):typeof n.wch=="number"&&(n.width=jR(n.wch),n.wpx=iw(n.width),n.MDW=tc),n.customWidth&&delete n.customWidth}var n_e=96,hG=n_e;function aw(n){return n*96/hG}function dG(n){return n*hG/96}function r_e(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&(e[e.length]=it("numFmt",null,{numFmtId:r,formatCode:Zn(n[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=it("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function i_e(n){var e=[];return e[e.length]=it("cellXfs",null),n.forEach(function(t){e[e.length]=it("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=it("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function fG(n,e){var t=[si,it("styleSheet",null,{xmlns:mg[0],"xmlns:vt":Ri.vt})],r;return n.SSF&&(r=r_e(n.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=i_e(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function s_e(n,e){var t=n.read_shift(2),r=fs(n);return[t,r]}function a_e(n,e,t){t||(t=Ne(6+4*e.length)),t.write_shift(2,n),Ii(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function o_e(n,e,t){var r={};r.sz=n.read_shift(2)/20;var i=X1e(n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=n.read_shift(1);a!=0&&(r.underline=a);var o=n.read_shift(1);o>0&&(r.family=o);var l=n.read_shift(1);switch(l>0&&(r.charset=l),n.l++,r.color=K1e(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=fs(n),r}function l_e(n,e){e||(e=Ne(153)),e.write_shift(2,n.sz*20),q1e(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),nw(n.color,e);var r=0;return r=2,e.write_shift(1,r),Ii(n.name,e),e.length>e.l?e.slice(0,e.l):e}var c_e=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],NT,u_e=gl;function V5(n,e){e||(e=Ne(84)),NT||(NT=tC(c_e));var t=NT[n.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(nw({auto:1},e),nw({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function h_e(n,e){var t=n.l+e,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}function gG(n,e,t){t||(t=Ne(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function pm(n,e){return e||(e=Ne(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var d_e=gl;function f_e(n,e){return e||(e=Ne(51)),e.write_shift(1,0),pm(null,e),pm(null,e),pm(null,e),pm(null,e),pm(null,e),e.length>e.l?e.slice(0,e.l):e}function g_e(n,e){return e||(e=Ne(52)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),tw(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function m_e(n,e,t){var r=Ne(2052);return r.write_shift(4,n),tw(e,r),tw(t,r),r.length>r.l?r.slice(0,r.l):r}function p_e(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++t}),t!=0&&(Ue(n,615,wo(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&Ue(n,44,a_e(i,e[i]))}),Ue(n,616))}}function y_e(n){var e=1;Ue(n,611,wo(e)),Ue(n,43,l_e({sz:12,color:{theme:1},name:"Calibri",family:2})),Ue(n,612)}function x_e(n){var e=2;Ue(n,603,wo(e)),Ue(n,45,V5({patternType:"none"})),Ue(n,45,V5({patternType:"gray125"})),Ue(n,604)}function __e(n){var e=1;Ue(n,613,wo(e)),Ue(n,46,f_e()),Ue(n,614)}function v_e(n){var e=1;Ue(n,626,wo(e)),Ue(n,47,gG({numFmtId:0},65535)),Ue(n,627)}function w_e(n,e){Ue(n,617,wo(e.length)),e.forEach(function(t){Ue(n,47,gG(t,0))}),Ue(n,618)}function E_e(n){var e=1;Ue(n,619,wo(e)),Ue(n,48,g_e({xfId:0,name:"Normal"})),Ue(n,620)}function S_e(n){var e=0;Ue(n,505,wo(e)),Ue(n,506)}function T_e(n){var e=0;Ue(n,508,m_e(e,"TableStyleMedium9","PivotStyleMedium4")),Ue(n,509)}function b_e(n,e){var t=Gs();return Ue(t,278),p_e(t,n.SSF),y_e(t),x_e(t),__e(t),v_e(t),w_e(t,e.cellXfs),E_e(t),S_e(t),T_e(t),Ue(t,279),t.end()}function mG(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[si];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function R_e(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:fs(n)}}function A_e(n){var e=Ne(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),Ii(n.name,e),e.slice(0,e.l)}function k_e(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function I_e(n){var e=Ne(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function C_e(n,e){var t=Ne(8+2*e.length);return t.write_shift(4,n),Ii(e,t),t.slice(0,t.l)}function P_e(n){return n.l+=4,n.read_shift(4)!=0}function M_e(n,e){var t=Ne(8);return t.write_shift(4,n),t.write_shift(4,1),t}function N_e(){var n=Gs();return Ue(n,332),Ue(n,334,wo(1)),Ue(n,335,A_e({name:"XLDAPR",version:12e4,flags:3496657072})),Ue(n,336),Ue(n,339,C_e(1,"XLDAPR")),Ue(n,52),Ue(n,35,wo(514)),Ue(n,4096,wo(0)),Ue(n,4097,Ca(1)),Ue(n,36),Ue(n,53),Ue(n,340),Ue(n,337,M_e(1)),Ue(n,51,I_e([[1,0]])),Ue(n,338),Ue(n,333),n.end()}function pG(){var n=[si];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function L_e(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=Qn(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var c0=1024;function yG(n,e){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[it("xml",null,{"xmlns:v":oa.v,"xmlns:o":oa.o,"xmlns:x":oa.x,"xmlns:mv":oa.mv}).replace(/\/>/,">"),it("o:shapelayout",it("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),it("v:shapetype",[it("v:stroke",null,{joinstyle:"miter"}),it("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];c0<n*1e3;)c0+=1e3;return e.forEach(function(s){var a=ki(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?it("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=it("v:fill",l,o),h={on:"t",obscured:"t"};++c0,i=i.concat(["<v:shape"+iy({id:"_x0000_s"+c0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,it("v:shadow",null,h),it("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Wi("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Wi("x:AutoFill","False"),Wi("x:Row",String(a.r)),Wi("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function xG(n){var e=[si,it("comments",null,{xmlns:mg[0]})],t=[];return e.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var s=Zn(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=t.indexOf(Zn(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Wi("t",Zn(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Wi("t",Zn(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function O_e(n,e,t){var r=[si,it("ThreadedComments",null,{xmlns:Ri.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),r.push(it("threadedComment",Wi("text",a.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function D_e(n){var e=[si,it("personList",null,{xmlns:Ri.TCMNT,"xmlns:x":mg[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){e.push(it("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function F_e(n){var e={};e.iauthor=n.read_shift(4);var t=Gd(n);return e.rfx=t.s,e.ref=Qn(t.s),n.l+=16,e}function j_e(n,e){return e==null&&(e=Ne(36)),e.write_shift(4,n[1].iauthor),yg(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var V_e=fs;function B_e(n){return Ii(n.slice(0,54))}function G_e(n){var e=Gs(),t=[];return Ue(e,628),Ue(e,630),n.forEach(function(r){r[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),Ue(e,632,B_e(i.a)))})}),Ue(e,631),Ue(e,633),n.forEach(function(r){r[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:ki(r[0]),e:ki(r[0])};Ue(e,635,j_e([s,i])),i.t&&i.t.length>0&&Ue(e,637,U1e(i)),Ue(e,636),delete i.iauthor})}),Ue(e,634),Ue(e,629),e.end()}function z_e(n,e){e.FullPaths.forEach(function(t,r){if(r!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&er.utils.cfb_add(n,i,e.FileIndex[r].content)}})}var _G=["xlsb","xlsm","xlam","biff8","xla"],U_e=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,l?c+=e.r:--c,i+(o?"":"$")+ds(h)+(l?"":"$")+Hi(c)}return function(i,s){return e=s,i.replace(n,t)}})(),gC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,mC=(function(){return function(e,t){return e.replace(gC,function(r,i,s,a,o,l){var c=lC(a)-(s?0:t.c),h=oC(l)-(o?0:t.r),g=h==0?"":o?h+1:"["+h+"]",m=c==0?"":s?c+1:"["+c+"]";return i+"R"+g+"C"+m})}})();function $_e(n,e){return n.replace(gC,function(t,r,i,s,a,o){return r+(i=="$"?i+s:ds(lC(s)+e.c))+(a=="$"?a+o:Hi(oC(o)+e.r))})}function W_e(n){return n.length!=1}function qr(n){n.l+=1}function zu(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function vG(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return wG(n);t.biff==12&&(r=4)}var i=n.read_shift(r),s=n.read_shift(r),a=zu(n),o=zu(n);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function wG(n){var e=zu(n),t=zu(n),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function H_e(n,e,t){if(t.biff<8)return wG(n);var r=n.read_shift(t.biff==12?4:2),i=n.read_shift(t.biff==12?4:2),s=zu(n),a=zu(n);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function EG(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return K_e(n);var r=n.read_shift(t&&t.biff==12?4:2),i=zu(n);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function K_e(n){var e=zu(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function X_e(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function q_e(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return Y_e(n);var i=n.read_shift(r>=12?4:2),s=n.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function Y_e(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:r}}function Z_e(n,e,t){var r=(n[n.l++]&96)>>5,i=vG(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function J_e(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var a=vG(n,s,t);return[r,i,a]}function Q_e(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function eve(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,i]}function tve(n,e,t){var r=(n[n.l++]&96)>>5,i=H_e(n,e-1,t);return[r,i]}function nve(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function B5(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function rve(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(n.read_shift(t&&t.biff==2?1:2));return i}function ive(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function sve(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function ave(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function ove(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function SG(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function lve(n){return n.read_shift(2),SG(n)}function cve(n){return n.read_shift(2),SG(n)}function uve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=EG(n,0,t);return[r,i]}function hve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=q_e(n,0,t);return[r,i]}function dve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var s=EG(n,0,t);return[r,i,s]}function fve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[fwe[i],RG[i],r]}function gve(n,e,t){var r=n[n.l++],i=n.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:mve(n);return[i,(s[0]===0?RG:dwe)[s[1]]]}function mve(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function pve(n,e,t){n.l+=t&&t.biff==2?3:4}function yve(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function xve(n){return n.l++,n1[n.read_shift(1)]}function _ve(n){return n.l++,n.read_shift(2)}function vve(n){return n.l++,n.read_shift(1)!==0}function wve(n){return n.l++,xg(n)}function Eve(n,e,t){return n.l++,sG(n,e-1,t)}function Sve(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=dxe(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=n1[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=xg(n);break;case 2:t[1]=pxe(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Tve(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((t.biff==12?Gd:_xe)(n));return i}function bve(n,e,t){var r=0,i=0;t.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=Sve(n,t.biff);return a}function Rve(n,e,t){var r=n.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=n.read_shift(i);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function Ave(n,e,t){if(t.biff==5)return kve(n);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),s=n.read_shift(4);return[r,i,s]}function kve(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function Ive(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function Cve(n,e,t){var r=n.read_shift(1)>>>5&3,i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function Pve(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function Mve(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,i]}var Nve=gl,Lve=gl,Ove=gl;function r1(n,e,t){return n.l+=2,[X_e(n)]}function pC(n){return n.l+=6,[]}var Dve=r1,Fve=pC,jve=pC,Vve=r1;function TG(n){return n.l+=2,[rG(n),n.read_shift(2)&1]}var Bve=r1,Gve=TG,zve=pC,Uve=r1,$ve=r1,Wve=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Hve(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),s=n.read_shift(2),a=Wve[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:r,c:i,C:s}}function Kve(n){return n.l+=2,[n.read_shift(4)]}function Xve(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function qve(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function Yve(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function Zve(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function Jve(n){return n.l+=4,[0,0]}var G5={1:{n:"PtgExp",f:yve},2:{n:"PtgTbl",f:Ove},3:{n:"PtgAdd",f:qr},4:{n:"PtgSub",f:qr},5:{n:"PtgMul",f:qr},6:{n:"PtgDiv",f:qr},7:{n:"PtgPower",f:qr},8:{n:"PtgConcat",f:qr},9:{n:"PtgLt",f:qr},10:{n:"PtgLe",f:qr},11:{n:"PtgEq",f:qr},12:{n:"PtgGe",f:qr},13:{n:"PtgGt",f:qr},14:{n:"PtgNe",f:qr},15:{n:"PtgIsect",f:qr},16:{n:"PtgUnion",f:qr},17:{n:"PtgRange",f:qr},18:{n:"PtgUplus",f:qr},19:{n:"PtgUminus",f:qr},20:{n:"PtgPercent",f:qr},21:{n:"PtgParen",f:qr},22:{n:"PtgMissArg",f:qr},23:{n:"PtgStr",f:Eve},26:{n:"PtgSheet",f:Xve},27:{n:"PtgEndSheet",f:qve},28:{n:"PtgErr",f:xve},29:{n:"PtgBool",f:vve},30:{n:"PtgInt",f:_ve},31:{n:"PtgNum",f:wve},32:{n:"PtgArray",f:nve},33:{n:"PtgFunc",f:fve},34:{n:"PtgFuncVar",f:gve},35:{n:"PtgName",f:Rve},36:{n:"PtgRef",f:uve},37:{n:"PtgArea",f:Z_e},38:{n:"PtgMemArea",f:Ive},39:{n:"PtgMemErr",f:Nve},40:{n:"PtgMemNoMem",f:Lve},41:{n:"PtgMemFunc",f:Cve},42:{n:"PtgRefErr",f:Pve},43:{n:"PtgAreaErr",f:Q_e},44:{n:"PtgRefN",f:hve},45:{n:"PtgAreaN",f:tve},46:{n:"PtgMemAreaN",f:Yve},47:{n:"PtgMemNoMemN",f:Zve},57:{n:"PtgNameX",f:Ave},58:{n:"PtgRef3d",f:dve},59:{n:"PtgArea3d",f:J_e},60:{n:"PtgRefErr3d",f:Mve},61:{n:"PtgAreaErr3d",f:eve},255:{}},Qve={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},ewe={1:{n:"PtgElfLel",f:TG},2:{n:"PtgElfRw",f:Uve},3:{n:"PtgElfCol",f:Dve},6:{n:"PtgElfRwV",f:$ve},7:{n:"PtgElfColV",f:Vve},10:{n:"PtgElfRadical",f:Bve},11:{n:"PtgElfRadicalS",f:zve},13:{n:"PtgElfColS",f:Fve},15:{n:"PtgElfColSV",f:jve},16:{n:"PtgElfRadicalLel",f:Gve},25:{n:"PtgList",f:Hve},29:{n:"PtgSxName",f:Kve},255:{}},twe={0:{n:"PtgAttrNoop",f:Jve},1:{n:"PtgAttrSemi",f:ove},2:{n:"PtgAttrIf",f:sve},4:{n:"PtgAttrChoose",f:rve},8:{n:"PtgAttrGoto",f:ive},16:{n:"PtgAttrSum",f:pve},32:{n:"PtgAttrBaxcel",f:B5},33:{n:"PtgAttrBaxcel",f:B5},64:{n:"PtgAttrSpace",f:lve},65:{n:"PtgAttrSpaceSemi",f:cve},128:{n:"PtgAttrIfError",f:ave},255:{}};function nwe(n,e,t,r){if(r.biff<8)return gl(n,e);for(var i=n.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=bve(n,0,r),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=Tve(n,t[a][1],r),s.push(t[a][2]);break;case"PtgExp":r&&r.biff==12&&(t[a][1][1]=n.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-n.l,e!==0&&s.push(gl(n,e)),s}function rwe(n,e,t){for(var r=n.l+e,i,s,a=[];r!=n.l;)e=r-n.l,s=n[n.l],i=G5[s]||G5[Qve[s]],(s===24||s===25)&&(i=(s===24?ewe:twe)[n[n.l+1]]),!i||!i.f?gl(n,e):a.push([i.n,i.f(n,e,t)]);return a}function iwe(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],i=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var swe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function awe(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function bG(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function z5(n,e,t){var r=bG(n,e,t);return r=="#REF"?r:awe(r,t)}function tg(n,e,t,r,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,h,g=0,m=0,y,v="";if(!n[0]||!n[0][0])return"";for(var _=-1,E="",T=0,b=n[0].length;T<b;++T){var R=n[0][T];switch(R[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),_>=0){switch(n[0][_][1][0]){case 0:E=jr(" ",n[0][_][1][1]);break;case 1:E=jr("\r",n[0][_][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}c=c+E,_=-1}o.push(c+swe[R[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=lp(R[1][1],a,i),o.push(cp(h,s));break;case"PtgRefN":h=t?lp(R[1][1],t,i):R[1][1],o.push(cp(h,s));break;case"PtgRef3d":g=R[1][1],h=lp(R[1][2],a,i),v=z5(r,g,i),o.push(v+"!"+cp(h,s));break;case"PtgFunc":case"PtgFuncVar":var N=R[1][0],D=R[1][1];N||(N=0),N&=127;var W=N==0?[]:o.slice(-N);o.length-=N,D==="User"&&(D=W.shift()),o.push(D+"("+W.join(",")+")");break;case"PtgBool":o.push(R[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(R[1]);break;case"PtgNum":o.push(String(R[1]));break;case"PtgStr":o.push('"'+R[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(R[1]);break;case"PtgAreaN":y=R5(R[1][1],t?{s:t}:a,i),o.push(PT(y,i));break;case"PtgArea":y=R5(R[1][1],a,i),o.push(PT(y,i));break;case"PtgArea3d":g=R[1][1],y=R[1][2],v=z5(r,g,i),o.push(v+"!"+PT(y,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=R[1][2];var I=(r.names||[])[m-1]||(r[0]||[])[m],A=I?I.Name:"SH33TJSNAME"+String(m);A&&A.slice(0,6)=="_xlfn."&&!i.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var M=R[1][1];m=R[1][2];var O;if(i.biff<=5)M<0&&(M=-M),r[M]&&(O=r[M][m]);else{var L="";if(((r[M]||[])[0]||[])[0]==14849||(((r[M]||[])[0]||[])[0]==1025?r[M][m]&&r[M][m].itab>0&&(L=r.SheetNames[r[M][m].itab-1]+"!"):L=r.SheetNames[m-1]+"!"),r[M]&&r[M][m])L+=r[M][m].Name;else if(r[0]&&r[0][m])L+=r[0][m].Name;else{var z=(bG(r,M,i)||"").split(";;");z[m-1]?L=z[m-1]:L+="SH33TJSERRX"}o.push(L);break}O||(O={Name:"SH33TJSERRY"}),o.push(O.Name);break;case"PtgParen":var j="(",Ee=")";if(_>=0){switch(E="",n[0][_][1][0]){case 2:j=jr(" ",n[0][_][1][1])+j;break;case 3:j=jr("\r",n[0][_][1][1])+j;break;case 4:Ee=jr(" ",n[0][_][1][1])+Ee;break;case 5:Ee=jr("\r",n[0][_][1][1])+Ee;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}_=-1}o.push(j+o.pop()+Ee);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:R[1][1],r:R[1][0]};var Ce={c:t.c,r:t.r};if(r.sharedf[Qn(h)]){var Ge=r.sharedf[Qn(h)];o.push(tg(Ge,a,Ce,r,i))}else{var Le=!1;for(l=0;l!=r.arrayf.length;++l)if(c=r.arrayf[l],!(h.c<c[0].s.c||h.c>c[0].e.c)&&!(h.r<c[0].s.r||h.r>c[0].e.r)){o.push(tg(c[1],a,Ce,r,i)),Le=!0;break}Le||o.push(R[1])}break;case"PtgArray":o.push("{"+iwe(R[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+R[1].idx+"[#"+R[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(R));default:throw new Error("Unrecognized Formula Token: "+String(R))}var ce=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&ce.indexOf(n[0][T][0])==-1){R=n[0][_];var Me=!0;switch(R[1][0]){case 4:Me=!1;case 0:E=jr(" ",R[1][1]);break;case 5:Me=!1;case 1:E=jr("\r",R[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+R[1][0])}o.push((Me?E:"")+o.pop()+(Me?"":E)),_=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function owe(n){if(n==null){var e=Ne(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return Sd(n);return Sd(0)}function lwe(n,e,t,r,i){var s=Td(e,t,i),a=owe(n.v),o=Ne(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=Ne(n.bf.length),h=0;h<n.bf.length;++h)c[h]=n.bf[h];var g=$i([s,a,o,c]);return g}function PE(n,e,t){var r=n.read_shift(4),i=rwe(n,r,t),s=n.read_shift(4),a=s>0?nwe(n,s,i,t):null;return[i,a]}var cwe=PE,ME=PE,uwe=PE,hwe=PE,dwe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},RG={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},fwe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function gwe(n){var e="of:="+n.replace(gC,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function mwe(n){return n.replace(/\./,"!")}var up=typeof Map<"u";function yC(n,e,t){var r=0,i=n.length;if(t){if(up?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=up?t.get(e):t[e];r<s.length;++r)if(n[s[r]].t===e)return n.Count++,s[r]}}else for(;r<i;++r)if(n[r].t===e)return n.Count++,r;return n[i]={t:e},n.Count++,n.Unique++,t&&(up?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function NE(n,e){var t={min:n+1,max:n+1},r=-1;return e.MDW&&(tc=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=sw(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=jR(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function AG(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function Zu(n,e,t){var r=t.revssf[e.z!=null?e.z:"General"],i=60,s=n.length;if(r==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){EB(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=r=i;break}}for(i=0;i!=s;++i)if(n[i].numFmtId===r)return i;return n[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function pwe(n,e,t){if(n&&n["!ref"]){var r=mr(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function ywe(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+ni(n[t])+'"/>';return e+"</mergeCells>"}function xwe(n,e,t,r,i){var s=!1,a={},o=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=ry(Zn(l))}if(n&&n["!outline"]){var c={summaryBelow:1,summaryRight:1};n["!outline"].above&&(c.summaryBelow=0),n["!outline"].left&&(c.summaryRight=0),o=(o||"")+it("outlinePr",null,c)}!s&&!o||(i[i.length]=it("sheetPr",o,a))}var _we=["objects","scenarios","selectLockedCells","selectUnlockedCells"],vwe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function wwe(n){var e={sheet:1};return _we.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),vwe.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=uG(n.password).toString(16).toUpperCase()),it("sheetProtection",null,e)}function Ewe(n){return AG(n),it("pageMargins",null,n)}function Swe(n,e){for(var t=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(t[t.length]=it("col",null,NE(i,r)));return t[t.length]="</cols>",t.join("")}function Twe(n,e,t,r){var i=typeof n.ref=="string"?n.ref:ni(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=pa(i);a.s.r==a.e.r&&(a.e.r=pa(e["!ref"]).e.r,i=ni(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+t.SheetNames[r]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),it("autoFilter",null,{ref:i})}function bwe(n,e,t,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),it("sheetViews",it("sheetView",null,i),{})}function Rwe(n,e,t,r){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var i="",s=n.t,a=n.v;if(n.t!=="z")switch(n.t){case"b":i=n.v?"1":"0";break;case"n":i=""+n.v;break;case"e":i=n1[n.v];break;case"d":r&&r.cellDates?i=Ts(n.v,-1).toISOString():(n=Ks(n),n.t="n",i=""+(n.v=Hs(Ts(n.v)))),typeof n.z>"u"&&(n.z=Br[14]);break;default:i=n.v;break}var o=Wi("v",Zn(i)),l={r:e},c=Zu(r.cellXfs,n,r);switch(c!==0&&(l.s=c),n.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=Wi("v",""+yC(r.Strings,n.v,r.revStrings)),l.t="s";break}l.t="str";break}if(n.t!=s&&(n.t=s,n.v=a),typeof n.f=="string"&&n.f){var h=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;o=it("f",Zn(n.f),h)+(n.v!=null?o:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(l.cm=1),it("c",o,l)}function Awe(n,e,t,r){var i=[],s=[],a=mr(n["!ref"]),o="",l,c="",h=[],g=0,m=0,y=n["!rows"],v=Array.isArray(n),_={r:c},E,T=-1;for(m=a.s.c;m<=a.e.c;++m)h[m]=ds(m);for(g=a.s.r;g<=a.e.r;++g){for(s=[],c=Hi(g),m=a.s.c;m<=a.e.c;++m){l=h[m]+c;var b=v?(n[g]||[])[m]:n[l];b!==void 0&&(o=Rwe(b,l,n,e))!=null&&s.push(o)}(s.length>0||y&&y[g])&&(_={r:c},y&&y[g]&&(E=y[g],E.hidden&&(_.hidden=1),T=-1,E.hpx?T=aw(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(_.ht=T,_.customHeight=1),E.level&&(_.outlineLevel=E.level)),i[i.length]=it("row",s.join(""),_))}if(y)for(;g<y.length;++g)y&&y[g]&&(_={r:g+1},E=y[g],E.hidden&&(_.hidden=1),T=-1,E.hpx?T=aw(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(_.ht=T,_.customHeight=1),E.level&&(_.outlineLevel=E.level),i[i.length]=it("row","",_));return i.join("")}function kG(n,e,t,r){var i=[si,it("worksheet",null,{xmlns:mg[0],"xmlns:r":Ri.r})],s=t.SheetNames[n],a=0,o="",l=t.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",h=mr(c);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),c=ni(h)}r||(r={}),l["!comments"]=[];var g=[];xwe(l,t,n,e,i),i[i.length]=it("dimension",null,{ref:c}),i[i.length]=bwe(l,e,n,t),e.sheetFormat&&(i[i.length]=it("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=Swe(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=Awe(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=wwe(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=Twe(l["!autofilter"],l,t,n)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=ywe(l["!merges"]));var m=-1,y,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(_){_[1].Target&&(y={ref:_[0]},_[1].Target.charAt(0)!="#"&&(v=Kn(r,-1,Zn(_[1].Target).replace(/#.*$/,""),Cn.HLINK),y["r:id"]="rId"+v),(m=_[1].Target.indexOf("#"))>-1&&(y.location=Zn(_[1].Target.slice(m+1))),_[1].Tooltip&&(y.tooltip=Zn(_[1].Tooltip)),i[i.length]=it("hyperlink",null,y))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=Ewe(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Wi("ignoredErrors",it("ignoredError",null,{numberStoredAsText:1,sqref:c}))),g.length>0&&(v=Kn(r,-1,"../drawings/drawing"+(n+1)+".xml",Cn.DRAW),i[i.length]=it("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=g),l["!comments"].length>0&&(v=Kn(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Cn.VML),i[i.length]=it("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function kwe(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function Iwe(n,e,t){var r=Ne(145),i=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var s=320;i.hpx?s=aw(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:n,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var g=-1,m=-1,y=h<<10;y<h+1<<10;++y){c.c=y;var v=Array.isArray(t)?(t[c.r]||[])[c.c]:t[Qn(c)];v&&(g<0&&(g=y),m=y)}g<0||(++o,r.write_shift(4,g),r.write_shift(4,m))}var _=r.l;return r.l=l,r.write_shift(4,o),r.l=_,r.length>r.l?r.slice(0,r.l):r}function Cwe(n,e,t,r){var i=Iwe(r,t,e);(i.length>17||(e["!rows"]||[])[r])&&Ue(n,0,i)}var Pwe=Gd,Mwe=yg;function Nwe(){}function Lwe(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=$1e(n),t}function Owe(n,e,t){t==null&&(t=Ne(84+4*n.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var i=1;i<3;++i)t.write_shift(1,0);return nw({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),UB(n,t),t.slice(0,t.l)}function Dwe(n){var e=Wa(n);return[e]}function Fwe(n,e,t){return t==null&&(t=Ne(8)),jd(e,t)}function jwe(n){var e=Vd(n);return[e]}function Vwe(n,e,t){return t==null&&(t=Ne(4)),Bd(e,t)}function Bwe(n){var e=Wa(n),t=n.read_shift(1);return[e,t,"b"]}function Gwe(n,e,t){return t==null&&(t=Ne(9)),jd(e,t),t.write_shift(1,n.v?1:0),t}function zwe(n){var e=Vd(n),t=n.read_shift(1);return[e,t,"b"]}function Uwe(n,e,t){return t==null&&(t=Ne(5)),Bd(e,t),t.write_shift(1,n.v?1:0),t}function $we(n){var e=Wa(n),t=n.read_shift(1);return[e,t,"e"]}function Wwe(n,e,t){return t==null&&(t=Ne(9)),jd(e,t),t.write_shift(1,n.v),t}function Hwe(n){var e=Vd(n),t=n.read_shift(1);return[e,t,"e"]}function Kwe(n,e,t){return t==null&&(t=Ne(8)),Bd(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function Xwe(n){var e=Wa(n),t=n.read_shift(4);return[e,t,"s"]}function qwe(n,e,t){return t==null&&(t=Ne(12)),jd(e,t),t.write_shift(4,e.v),t}function Ywe(n){var e=Vd(n),t=n.read_shift(4);return[e,t,"s"]}function Zwe(n,e,t){return t==null&&(t=Ne(8)),Bd(e,t),t.write_shift(4,e.v),t}function Jwe(n){var e=Wa(n),t=xg(n);return[e,t,"n"]}function Qwe(n,e,t){return t==null&&(t=Ne(16)),jd(e,t),Sd(n.v,t),t}function eEe(n){var e=Vd(n),t=xg(n);return[e,t,"n"]}function tEe(n,e,t){return t==null&&(t=Ne(12)),Bd(e,t),Sd(n.v,t),t}function nEe(n){var e=Wa(n),t=$B(n);return[e,t,"n"]}function rEe(n,e,t){return t==null&&(t=Ne(12)),jd(e,t),WB(n.v,t),t}function iEe(n){var e=Vd(n),t=$B(n);return[e,t,"n"]}function sEe(n,e,t){return t==null&&(t=Ne(8)),Bd(e,t),WB(n.v,t),t}function aEe(n){var e=Wa(n),t=cC(n);return[e,t,"is"]}function oEe(n){var e=Wa(n),t=fs(n);return[e,t,"str"]}function lEe(n,e,t){return t==null&&(t=Ne(12+4*n.v.length)),jd(e,t),Ii(n.v,t),t.length>t.l?t.slice(0,t.l):t}function cEe(n){var e=Vd(n),t=fs(n);return[e,t,"str"]}function uEe(n,e,t){return t==null&&(t=Ne(8+4*n.v.length)),Bd(e,t),Ii(n.v,t),t.length>t.l?t.slice(0,t.l):t}function hEe(n,e,t){var r=n.l+e,i=Wa(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"b"];if(t.cellFormula){n.l+=2;var o=ME(n,r-n.l,t);a[3]=tg(o,null,i,t.supbooks,t)}else n.l=r;return a}function dEe(n,e,t){var r=n.l+e,i=Wa(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"e"];if(t.cellFormula){n.l+=2;var o=ME(n,r-n.l,t);a[3]=tg(o,null,i,t.supbooks,t)}else n.l=r;return a}function fEe(n,e,t){var r=n.l+e,i=Wa(n);i.r=t["!row"];var s=xg(n),a=[i,s,"n"];if(t.cellFormula){n.l+=2;var o=ME(n,r-n.l,t);a[3]=tg(o,null,i,t.supbooks,t)}else n.l=r;return a}function gEe(n,e,t){var r=n.l+e,i=Wa(n);i.r=t["!row"];var s=fs(n),a=[i,s,"str"];if(t.cellFormula){n.l+=2;var o=ME(n,r-n.l,t);a[3]=tg(o,null,i,t.supbooks,t)}else n.l=r;return a}var mEe=Gd,pEe=yg;function yEe(n,e){return e==null&&(e=Ne(4)),e.write_shift(4,n),e}function xEe(n,e){var t=n.l+e,r=Gd(n),i=uC(n),s=fs(n),a=fs(n),o=fs(n);n.l=t;var l={rfx:r,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function _Ee(n,e){var t=Ne(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));yg({s:ki(n[0]),e:ki(n[0])},t),hC("rId"+e,t);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return Ii(i||"",t),Ii(n[1].Tooltip||"",t),Ii("",t),t.slice(0,t.l)}function vEe(){}function wEe(n,e,t){var r=n.l+e,i=HB(n),s=n.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=cwe(n,r-n.l,t);a[1]=o}else n.l=r;return a}function EEe(n,e,t){var r=n.l+e,i=Gd(n),s=[i];if(t.cellFormula){var a=hwe(n,r-n.l,t);s[1]=a,n.l=r}else n.l=r;return s}function SEe(n,e,t){t==null&&(t=Ne(18));var r=NE(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var IG=["left","right","top","bottom","header","footer"];function TEe(n){var e={};return IG.forEach(function(t){e[t]=xg(n)}),e}function bEe(n,e){return e==null&&(e=Ne(48)),AG(n),IG.forEach(function(t){Sd(n[t],e)}),e}function REe(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function AEe(n,e,t){t==null&&(t=Ne(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function kEe(n){var e=Ne(24);return e.write_shift(4,4),e.write_shift(4,1),yg(n,e),e}function IEe(n,e){return e==null&&(e=Ne(66)),e.write_shift(2,n.password?uG(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function CEe(){}function PEe(){}function MEe(n,e,t,r,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Ks(e),e.z=e.z||Br[14],e.v=Hs(Ts(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:r};switch(l.s=Zu(i.cellXfs,e,i),e.l&&s["!links"].push([Qn(l),e.l]),e.c&&s["!comments"].push([Qn(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=yC(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Ue(n,18,Zwe(e,l)):Ue(n,7,qwe(e,l))):(l.t="str",a?Ue(n,17,uEe(e,l)):Ue(n,6,lEe(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Ue(n,13,sEe(e,l)):Ue(n,2,rEe(e,l)):a?Ue(n,16,tEe(e,l)):Ue(n,5,Qwe(e,l)),!0;case"b":return l.t="b",a?Ue(n,15,Uwe(e,l)):Ue(n,4,Gwe(e,l)),!0;case"e":return l.t="e",a?Ue(n,14,Kwe(e,l)):Ue(n,3,Wwe(e,l)),!0}return a?Ue(n,12,Vwe(e,l)):Ue(n,1,Fwe(e,l)),!0}function NEe(n,e,t,r){var i=mr(e["!ref"]||"A1"),s,a="",o=[];Ue(n,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=c;++h){a=Hi(h),Cwe(n,e,i,h);var g=!1;if(h<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){h===i.s.r&&(o[m]=ds(m)),s=o[m]+a;var y=l?(e[h]||[])[m]:e[s];if(!y){g=!1;continue}g=MEe(n,y,h,m,r,e,g)}}Ue(n,146)}function LEe(n,e){!e||!e["!merges"]||(Ue(n,177,yEe(e["!merges"].length)),e["!merges"].forEach(function(t){Ue(n,176,pEe(t))}),Ue(n,178))}function OEe(n,e){!e||!e["!cols"]||(Ue(n,390),e["!cols"].forEach(function(t,r){t&&Ue(n,60,SEe(r,t))}),Ue(n,391))}function DEe(n,e){!e||!e["!ref"]||(Ue(n,648),Ue(n,649,kEe(mr(e["!ref"]))),Ue(n,650))}function FEe(n,e,t){e["!links"].forEach(function(r){if(r[1].Target){var i=Kn(t,-1,r[1].Target.replace(/#.*$/,""),Cn.HLINK);Ue(n,494,_Ee(r,i))}}),delete e["!links"]}function jEe(n,e,t,r){if(e["!comments"].length>0){var i=Kn(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Cn.VML);Ue(n,551,hC("rId"+i)),e["!legacy"]=i}}function VEe(n,e,t,r){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:ni(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=pa(s);o.s.r==o.e.r&&(o.e.r=pa(e["!ref"]).e.r,s=ni(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+t.SheetNames[r]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+s}),Ue(n,161,yg(mr(s))),Ue(n,162)}}function BEe(n,e,t){Ue(n,133),Ue(n,137,AEe(e,t)),Ue(n,138),Ue(n,134)}function GEe(n,e){e["!protect"]&&Ue(n,535,IEe(e["!protect"]))}function zEe(n,e,t,r){var i=Gs(),s=t.SheetNames[n],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[n].CodeName||o)}catch{}var l=mr(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Ue(i,129),(t.vbaraw||a["!outline"])&&Ue(i,147,Owe(o,a["!outline"])),Ue(i,148,Mwe(l)),BEe(i,a,t.Workbook),OEe(i,a),NEe(i,a,n,e),GEe(i,a),VEe(i,a,t,n),LEe(i,a),FEe(i,a,r),a["!margins"]&&Ue(i,476,bEe(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&DEe(i,a),jEe(i,a,n,r),Ue(i,130),i.end()}function UEe(n,e){n.l+=10;var t=fs(n);return{name:t}}var $Ee=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function WEe(n){return!n.Workbook||!n.Workbook.WBProps?"false":E1e(n.Workbook.WBProps.date1904)?"true":"false"}var HEe="][*?/\\".split("");function CG(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return HEe.forEach(function(r){if(n.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function KEe(n,e,t){n.forEach(function(r,i){CG(r);for(var s=0;s<i;++s)if(r==n[s])throw new Error("Duplicate Sheet Name: "+r);if(t){var a=e&&e[i]&&e[i].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function XEe(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];KEe(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)pwe(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function PG(n){var e=[si];e[e.length]=it("workbook",null,{xmlns:mg[0],"xmlns:r":Ri.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&($Ee.forEach(function(o){n.Workbook.WBProps[o[0]]!=null&&n.Workbook.WBProps[o[0]]!=o[1]&&(r[o[0]]=n.Workbook.WBProps[o[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=it("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==n.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var a={name:Zn(n.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=it("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=it("definedName",Zn(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function qEe(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=FR(n),t.name=fs(n),t}function YEe(n,e){return e||(e=Ne(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),hC(n.strRelID,e),Ii(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function ZEe(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=e>8?fs(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function JEe(n,e){e||(e=Ne(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),UB(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function QEe(n,e,t){var r=n.l+e;n.l+=4,n.l+=1;var i=n.read_shift(4),s=W1e(n),a=uwe(n,0,t),o=uC(n);n.l=r;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function e2e(n,e){Ue(n,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Ue(n,156,YEe(i))}Ue(n,144)}function t2e(n,e){e||(e=Ne(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return Ii("SheetJS",e),Ii(Xv.version,e),Ii(Xv.version,e),Ii("7262",e),e.length>e.l?e.slice(0,e.l):e}function n2e(n,e){e||(e=Ne(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function r2e(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,i=-1,s=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&i==-1?i=r:t[r].Hidden==1&&s==-1&&(s=r);s>i||(Ue(n,135),Ue(n,158,n2e(i)),Ue(n,136))}}function i2e(n,e){var t=Gs();return Ue(t,131),Ue(t,128,t2e()),Ue(t,153,JEe(n.Workbook&&n.Workbook.WBProps||null)),r2e(t,n),e2e(t,n),Ue(t,132),t.end()}function s2e(n,e,t){return(e.slice(-4)===".bin"?i2e:PG)(n)}function a2e(n,e,t,r,i){return(e.slice(-4)===".bin"?zEe:kG)(n,t,r,i)}function o2e(n,e,t){return(e.slice(-4)===".bin"?b_e:fG)(n,t)}function l2e(n,e,t){return(e.slice(-4)===".bin"?Jxe:cG)(n,t)}function c2e(n,e,t){return(e.slice(-4)===".bin"?G_e:xG)(n)}function u2e(n){return(n.slice(-4)===".bin"?N_e:pG)()}function h2e(n,e){var t=[];return n.Props&&t.push(oxe(n.Props,e)),n.Custprops&&t.push(lxe(n.Props,n.Custprops)),t.join("")}function d2e(){return""}function f2e(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var s=[];s.push(it("NumberFormat",null,{"ss:Format":Zn(Br[r.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push(it("Style",s.join(""),a))}),it("Styles",t.join(""))}function MG(n){return it("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+mC(n.Ref,{r:0,c:0})})}function g2e(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(MG(i)))}return it("Names",t.join(""))}function m2e(n,e,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(MG(o)))}return s.join("")}function p2e(n,e,t,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(it("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(it("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(it("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)i.push(it("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push(Wi("ProtectContents","True")),n["!protect"].objects&&i.push(Wi("ProtectObjects","True")),n["!protect"].scenarios&&i.push(Wi("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push(Wi("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push(Wi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){n["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":it("WorksheetOptions",i.join(""),{xmlns:oa.x})}function y2e(n){return n.map(function(e){var t=w1e(e.t||""),r=it("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return it("Comment",r,{"ss:Author":e.a})}).join("")}function x2e(n,e,t,r,i,s,a){if(!n||n.v==null&&n.f==null)return"";var o={};if(n.f&&(o["ss:Formula"]="="+Zn(mC(n.f,a))),n.F&&n.F.slice(0,e.length)==e){var l=ki(n.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(n.l&&n.l.Target&&(o["ss:HRef"]=Zn(n.l.Target),n.l.Tooltip&&(o["x:HRefScreenTip"]=Zn(n.l.Tooltip))),t["!merges"])for(var c=t["!merges"],h=0;h!=c.length;++h)c[h].s.c!=a.c||c[h].s.r!=a.r||(c[h].e.c>c[h].s.c&&(o["ss:MergeAcross"]=c[h].e.c-c[h].s.c),c[h].e.r>c[h].s.r&&(o["ss:MergeDown"]=c[h].e.r-c[h].s.r));var g="",m="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":g="Number",m=String(n.v);break;case"b":g="Boolean",m=n.v?"1":"0";break;case"e":g="Error",m=n1[n.v];break;case"d":g="DateTime",m=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Br[14]);break;case"s":g="String",m=v1e(n.v||"");break}var y=Zu(r.cellXfs,n,r);o["ss:StyleID"]="s"+(21+y),o["ss:Index"]=a.c+1;var v=n.v!=null?m:"",_=n.t=="z"?"":'<Data ss:Type="'+g+'">'+v+"</Data>";return(n.c||[]).length>0&&(_+=y2e(n.c)),it("Cell",_,o)}function _2e(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=dG(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function v2e(n,e,t,r){if(!n["!ref"])return"";var i=mr(n["!ref"]),s=n["!merges"]||[],a=0,o=[];n["!cols"]&&n["!cols"].forEach(function(E,T){fC(E);var b=!!E.width,R=NE(T,E),N={"ss:Index":T+1};b&&(N["ss:Width"]=iw(R.width)),E.hidden&&(N["ss:Hidden"]="1"),o.push(it("Column",null,N))});for(var l=Array.isArray(n),c=i.s.r;c<=i.e.r;++c){for(var h=[_2e(c,(n["!rows"]||[])[c])],g=i.s.c;g<=i.e.c;++g){var m=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>g)&&!(s[a].s.r>c)&&!(s[a].e.c<g)&&!(s[a].e.r<c)){(s[a].s.c!=g||s[a].s.r!=c)&&(m=!0);break}if(!m){var y={r:c,c:g},v=Qn(y),_=l?(n[c]||[])[g]:n[v];h.push(x2e(_,v,n,e,t,r,y))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function w2e(n,e,t){var r=[],i=t.SheetNames[n],s=t.Sheets[i],a=s?m2e(s,e,n,t):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=s?v2e(s,e,n,t):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(p2e(s,e,n,t)),r.join("")}function E2e(n,e){e||(e={}),n.SSF||(n.SSF=Ks(Br)),n.SSF&&(kE(),AE(n.SSF),e.revssf=IE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],Zu(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(h2e(n,e)),t.push(d2e()),t.push(""),t.push("");for(var r=0;r<n.SheetNames.length;++r)t.push(it("Worksheet",w2e(r,e,n),{"ss:Name":Zn(n.SheetNames[r])}));return t[2]=f2e(n,e),t[3]=g2e(n),si+it("Workbook",t.join(""),{xmlns:oa.ss,"xmlns:o":oa.o,"xmlns:x":oa.x,"xmlns:ss":oa.ss,"xmlns:dt":oa.dt,"xmlns:html":oa.html})}var LT={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function S2e(n,e){var t=[],r=[],i=[],s=0,a,o=m5(k5,"n"),l=m5(I5,"n");if(n.Props)for(a=Ki(n.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Props[a[s]]]);if(n.Custprops)for(a=Ki(n.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)nG.indexOf(i[s][0])>-1||QB.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);r.length&&er.utils.cfb_add(e,"/SummaryInformation",L5(r,LT.SI,l,I5)),(t.length||c.length)&&er.utils.cfb_add(e,"/DocumentSummaryInformation",L5(t,LT.DSI,o,k5,c.length?c:null,LT.UDI))}function T2e(n,e){var t=e||{},r=er.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return er.utils.cfb_add(r,i,NG(n,t)),t.biff==8&&(n.Props||n.Custprops)&&S2e(n,r),t.biff==8&&n.vbaraw&&z_e(r,er.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var b2e={0:{f:kwe},1:{f:Dwe},2:{f:nEe},3:{f:$we},4:{f:Bwe},5:{f:Jwe},6:{f:oEe},7:{f:Xwe},8:{f:gEe},9:{f:fEe},10:{f:hEe},11:{f:dEe},12:{f:jwe},13:{f:iEe},14:{f:Hwe},15:{f:zwe},16:{f:eEe},17:{f:cEe},18:{f:Ywe},19:{f:cC},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:QEe},40:{},42:{},43:{f:o_e},44:{f:s_e},45:{f:u_e},46:{f:d_e},47:{f:h_e},48:{},49:{f:j1e},50:{},51:{f:k_e},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Vxe},62:{f:aEe},63:{f:L_e},64:{f:CEe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:gl,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:REe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Lwe},148:{f:Pwe,p:16},151:{f:vEe},152:{},153:{f:ZEe},154:{},155:{},156:{f:qEe},157:{},158:{},159:{T:1,f:qxe},160:{T:-1},161:{T:1,f:Gd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:mEe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:R_e},336:{T:-1},337:{f:P_e,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:FR},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Nxe},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:wEe},427:{f:EEe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:TEe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Nwe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:xEe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:FR},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:V_e},633:{T:1},634:{T:-1},635:{T:1,f:F_e},636:{T:-1},637:{f:z1e},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:UEe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:PEe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function st(n,e,t,r){var i=e;if(!isNaN(i)){var s=r||(t||[]).length||0,a=n.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&aC(t)&&n.push(t)}}function R2e(n,e,t,r){var i=(t||[]).length||0;if(i<=8224)return st(n,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var h=n.next(4);for(h.write_shift(2,s),h.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c;l<i;){for(h=n.next(4),h.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;h.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c}}}function i1(n,e,t){return n||(n=Ne(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function A2e(n,e,t,r){var i=Ne(9);return i1(i,n,e),iG(t,r||"b",i),i}function k2e(n,e,t){var r=Ne(8+2*t.length);return i1(r,n,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function I2e(n,e,t,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Hs(Ts(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?st(n,2,Uxe(t,r,i)):st(n,3,zxe(t,r,i));return;case"b":case"e":st(n,5,A2e(t,r,e.v,e.t));return;case"s":case"str":st(n,4,k2e(t,r,(e.v||"").slice(0,255)));return}st(n,1,i1(null,t,r))}function C2e(n,e,t,r){var i=Array.isArray(e),s=mr(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=ni(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Hi(c);for(var h=s.s.c;h<=s.e.c;++h){c===s.s.r&&(l[h]=ds(h)),a=l[h]+o;var g=i?(e[c]||[])[h]:e[a];g&&I2e(n,g,c,h)}}}function P2e(n,e){for(var t=e||{},r=Gs(),i=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return st(r,t.biff==4?1033:t.biff==3?521:9,dC(n,16,t)),C2e(r,n.Sheets[n.SheetNames[i]],i,t),st(r,10),r.end()}function M2e(n,e,t){st(n,49,bxe({sz:12,name:"Arial"},t))}function N2e(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&st(n,1054,kxe(i,e[i],t))})}function L2e(n,e){var t=Ne(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),st(n,2151,t),t=Ne(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),oG(mr(e["!ref"]||"A1"),t),t.write_shift(4,4),st(n,2152,t)}function O2e(n,e){for(var t=0;t<16;++t)st(n,224,D5({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){st(n,224,D5(r,0,e))})}function D2e(n,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];st(n,440,Dxe(r)),r[1].Tooltip&&st(n,2048,Fxe(r))}delete e["!links"]}function F2e(n,e){if(e){var t=0;e.forEach(function(r,i){++t<=256&&r&&st(n,125,Bxe(NE(i,r),i))})}}function j2e(n,e,t,r,i){var s=16+Zu(i.cellXfs,e,i);if(e.v==null&&!e.bf){st(n,513,Td(t,r,s));return}if(e.bf)st(n,6,lwe(e,t,r,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Hs(Ts(e.v)):e.v;st(n,515,Mxe(t,r,a,s));break;case"b":case"e":st(n,517,Pxe(t,r,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=yC(i.Strings,e.v,i.revStrings);st(n,253,Rxe(t,r,o,s))}else st(n,516,Axe(t,r,(e.v||"").slice(0,255),s,i));break;default:st(n,513,Td(t,r,s))}}function V2e(n,e,t){var r=Gs(),i=t.SheetNames[n],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[n]||{},l=Array.isArray(s),c=e.biff==8,h,g="",m=[],y=mr(s["!ref"]||"A1"),v=c?65536:16384;if(y.e.c>255||y.e.r>=v){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,v-1)}st(r,2057,dC(t,16,e)),st(r,13,Ca(1)),st(r,12,Ca(100)),st(r,15,ys(!0)),st(r,17,ys(!1)),st(r,16,Sd(.001)),st(r,95,ys(!0)),st(r,42,ys(!1)),st(r,43,ys(!1)),st(r,130,Ca(1)),st(r,128,Cxe()),st(r,131,ys(!1)),st(r,132,ys(!1)),c&&F2e(r,s["!cols"]),st(r,512,Ixe(y,e)),c&&(s["!links"]=[]);for(var _=y.s.r;_<=y.e.r;++_){g=Hi(_);for(var E=y.s.c;E<=y.e.c;++E){_===y.s.r&&(m[E]=ds(E)),h=m[E]+g;var T=l?(s[_]||[])[E]:s[h];T&&(j2e(r,T,_,E,e),c&&T.l&&s["!links"].push([h,T.l]))}}var b=o.CodeName||o.name||i;return c&&st(r,574,Txe((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&st(r,229,Oxe(s["!merges"])),c&&D2e(r,s),st(r,442,aG(b)),c&&L2e(r,s),st(r,10),r.end()}function B2e(n,e,t){var r=Gs(),i=(n||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,l=t.biff==5;if(st(r,2057,dC(n,5,t)),t.bookType=="xla"&&st(r,135),st(r,225,o?Ca(1200):null),st(r,193,hxe(2)),l&&st(r,191),l&&st(r,192),st(r,226),st(r,92,vxe("SheetJS",t)),st(r,66,Ca(o?1200:1252)),o&&st(r,353,Ca(0)),o&&st(r,448),st(r,317,Gxe(n.SheetNames.length)),o&&n.vbaraw&&st(r,211),o&&n.vbaraw){var c=a.CodeName||"ThisWorkbook";st(r,442,aG(c))}st(r,156,Ca(17)),st(r,25,ys(!1)),st(r,18,ys(!1)),st(r,19,Ca(0)),o&&st(r,431,ys(!1)),o&&st(r,444,Ca(0)),st(r,61,Sxe()),st(r,64,ys(!1)),st(r,141,Ca(0)),st(r,34,ys(WEe(n)=="true")),st(r,14,ys(!0)),o&&st(r,439,ys(!1)),st(r,218,Ca(0)),M2e(r,n,t),N2e(r,n.SSF,t),O2e(r,t),o&&st(r,352,ys(!1));var h=r.end(),g=Gs();o&&st(g,140,jxe()),o&&t.Strings&&R2e(g,252,Exe(t.Strings)),st(g,10);var m=g.end(),y=Gs(),v=0,_=0;for(_=0;_<n.SheetNames.length;++_)v+=(o?12:11)+(o?2:1)*n.SheetNames[_].length;var E=h.length+v+m.length;for(_=0;_<n.SheetNames.length;++_){var T=s[_]||{};st(y,133,wxe({pos:E,hs:T.Hidden||0,dt:0,name:n.SheetNames[_]},t)),E+=e[_].length}var b=y.end();if(v!=b.length)throw new Error("BS8 "+v+" != "+b.length);var R=[];return h.length&&R.push(h),b.length&&R.push(b),m.length&&R.push(m),$i(R)}function G2e(n,e){var t=e||{},r=[];n&&!n.SSF&&(n.SSF=Ks(Br)),n&&n.SSF&&(kE(),AE(n.SSF),t.revssf=IE(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,xC(t),t.cellXfs=[],Zu(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=V2e(i,t,n);return r.unshift(B2e(n,r,t)),$i(r)}function NG(n,e){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];if(!(!r||!r["!ref"])){var i=pa(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return G2e(n,e);case 4:case 3:case 2:return P2e(n,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function z2e(n,e,t,r){for(var i=n["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>t||i[c].s.c>a)&&!(i[c].e.r<t||i[c].e.c<a)){if(i[c].s.r<t||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var h=Qn({r:t,c:a}),g=r.dense?(n[t]||[])[a]:n[h],m=g&&g.v!=null&&(g.h||_1e(g.w||(uc(g),g.w)||""))||"",y={};o>1&&(y.rowspan=o),l>1&&(y.colspan=l),r.editable?m='<span contenteditable="true">'+m+"</span>":g&&(y["data-t"]=g&&g.t||"z",g.v!=null&&(y["data-v"]=g.v),g.z!=null&&(y["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+g.l.Target+'">'+m+"</a>")),y.id=(r.id||"sjs")+"-"+h,s.push(it("td",m,y))}}var v="<tr>";return v+s.join("")+"</tr>"}var U2e='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$2e="</body></html>";function W2e(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function LG(n,e){var t=e||{},r=t.header!=null?t.header:U2e,i=t.footer!=null?t.footer:$2e,s=[r],a=pa(n["!ref"]);t.dense=Array.isArray(n),s.push(W2e(n,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(z2e(n,a,o,t));return s.push("</table>"+i),s.join("")}function OG(n,e,t){var r=t||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var a=typeof r.origin=="string"?ki(r.origin):r.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(n["!ref"]){var h=pa(n["!ref"]);c.s.r=Math.min(c.s.r,h.s.r),c.s.c=Math.min(c.s.c,h.s.c),c.e.r=Math.max(c.e.r,h.e.r),c.e.c=Math.max(c.e.c,h.e.c),i==-1&&(c.e.r=i=h.e.r+1)}var g=[],m=0,y=n["!rows"]||(n["!rows"]=[]),v=0,_=0,E=0,T=0,b=0,R=0;for(n["!cols"]||(n["!cols"]=[]);v<o.length&&_<l;++v){var N=o[v];if(U5(N)){if(r.display)continue;y[_]={hidden:!0}}var D=N.children;for(E=T=0;E<D.length;++E){var W=D[E];if(!(r.display&&U5(W))){var I=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):S1e(W.innerHTML),A=W.getAttribute("data-z")||W.getAttribute("z");for(m=0;m<g.length;++m){var M=g[m];M.s.c==T+s&&M.s.r<_+i&&_+i<=M.e.r&&(T=M.e.c+1-s,m=-1)}R=+W.getAttribute("colspan")||1,((b=+W.getAttribute("rowspan")||1)>1||R>1)&&g.push({s:{r:_+i,c:T+s},e:{r:_+i+(b||1)-1,c:T+s+(R||1)-1}});var O={t:"s",v:I},L=W.getAttribute("data-t")||W.getAttribute("t")||"";I!=null&&(I.length==0?O.t=L||"z":r.raw||I.trim().length==0||L=="s"||(I==="TRUE"?O={t:"b",v:!0}:I==="FALSE"?O={t:"b",v:!1}:isNaN(ec(I))?isNaN(ny(I).getDate())||(O={t:"d",v:Ts(I)},r.cellDates||(O={t:"n",v:Hs(O.v)}),O.z=r.dateNF||Br[14]):O={t:"n",v:ec(I)})),O.z===void 0&&A!=null&&(O.z=A);var z="",j=W.getElementsByTagName("A");if(j&&j.length)for(var Ee=0;Ee<j.length&&!(j[Ee].hasAttribute("href")&&(z=j[Ee].getAttribute("href"),z.charAt(0)!="#"));++Ee);z&&z.charAt(0)!="#"&&(O.l={Target:z}),r.dense?(n[_+i]||(n[_+i]=[]),n[_+i][T+s]=O):n[Qn({c:T+s,r:_+i})]=O,c.e.c<T+s&&(c.e.c=T+s),T+=R}}++_}return g.length&&(n["!merges"]=(n["!merges"]||[]).concat(g)),c.e.r=Math.max(c.e.r,_-1+i),n["!ref"]=ni(c),_>=l&&(n["!fullref"]=ni((c.e.r=o.length-v+_-1+i,c))),n}function DG(n,e){var t=e||{},r=t.dense?[]:{};return OG(r,n,e)}function H2e(n,e){return Fd(DG(n,e),e)}function U5(n){var e="",t=K2e(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function K2e(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var X2e=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+iy({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return si+e}})(),$5=(function(){var n=function(s){return Zn(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Zn(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,h=0,g=pa(s["!ref"]||"A1"),m=s["!merges"]||[],y=0,v=Array.isArray(s);if(s["!cols"])for(h=0;h<=g.e.c;++h)l.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var _="",E=s["!rows"]||[];for(c=0;c<g.s.r;++c)_=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+_+`></table:table-row>
`);for(;c<=g.e.r;++c){for(_=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+_+`>
`),h=0;h<g.s.c;++h)l.push(e);for(;h<=g.e.c;++h){var T=!1,b={},R="";for(y=0;y!=m.length;++y)if(!(m[y].s.c>h)&&!(m[y].s.r>c)&&!(m[y].e.c<h)&&!(m[y].e.r<c)){(m[y].s.c!=h||m[y].s.r!=c)&&(T=!0),b["table:number-columns-spanned"]=m[y].e.c-m[y].s.c+1,b["table:number-rows-spanned"]=m[y].e.r-m[y].s.r+1;break}if(T){l.push(t);continue}var N=Qn({r:c,c:h}),D=v?(s[c]||[])[h]:s[N];if(D&&D.f&&(b["table:formula"]=Zn(gwe(D.f)),D.F&&D.F.slice(0,N.length)==N)){var W=pa(D.F);b["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,b["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!D){l.push(e);continue}switch(D.t){case"b":R=D.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=D.v?"true":"false";break;case"n":R=D.w||String(D.v||0),b["office:value-type"]="float",b["office:value"]=D.v||0;break;case"s":case"str":R=D.v==null?"":D.v,b["office:value-type"]="string";break;case"d":R=D.w||Ts(D.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Ts(D.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(e);continue}var I=n(R);if(D.l&&D.l.Target){var A=D.l.Target;A=A.charAt(0)=="#"?"#"+mwe(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),I=it("text:a",I,{"xlink:href":A.replace(/&/g,"&amp;")})}l.push("          "+it("table:table-cell",it("text:p",I,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var h=0;h<c["!cols"].length;++h)if(c["!cols"][h]){var g=c["!cols"][h];if(g.width==null&&g.wpx==null&&g.wch==null)continue;fC(g),g.ods=o;var m=c["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var h=0;h<c["!rows"].length;++h)if(c["!rows"][h]){c["!rows"][h].ods=l;var g=c["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[si],c=iy({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=iy({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+h+`>
`),l.push(ZB().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var g=0;g!=a.SheetNames.length;++g)l.push(r(a.Sheets[a.SheetNames[g]],a,g));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function FG(n,e){if(e.bookType=="fods")return $5(n,e);var t=nC(),r="",i=[],s=[];return r="mimetype",on(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",on(t,r,$5(n,e)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",on(t,r,X2e(n,e)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",on(t,r,si+ZB()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",on(t,r,axe(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",on(t,r,ixe(i)),t}function ow(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function q2e(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):ho(ry(n))}function Y2e(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var r=0;r<e.length;++r)if(n[t+r]!=e[r])continue e;return!0}return!1}function Uu(n){var e=n.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(i,r),r+=i.length}),t}function Z2e(n,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,r-6176);n[e+15]|=r>>7,n[e+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)n[e+s]=i&255;n[e+15]|=t>=0?0:128}function sy(n,e){var t=e?e[0]:0,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),r}function Hn(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function R0(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function ui(n){for(var e=[],t=[0];t[0]<n.length;){var r=t[0],i=sy(n,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=t[0];n[t[0]++]>=128;);o=n.slice(l,t[0])}break;case 5:a=4,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=sy(n,t),o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function Fi(n){var e=[];return n.forEach(function(t,r){t.forEach(function(i){i.data&&(e.push(Hn(r*8+i.type)),i.type==2&&e.push(Hn(i.data.length)),e.push(i.data))})}),Uu(e)}function to(n){for(var e,t=[],r=[0];r[0]<n.length;){var i=sy(n,r),s=ui(n.slice(r[0],r[0]+i));r[0]+=i;var a={id:R0(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=ui(o.data),c=R0(l[3][0].data);a.messages.push({meta:l,data:n.slice(r[0],r[0]+c)}),r[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=R0(s[3][0].data)>>>0>0),t.push(a)}return t}function Ff(n){var e=[];return n.forEach(function(t){var r=[];r[1]=[{data:Hn(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:Hn(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Hn(a.data.length)}],r[2].push({data:Fi(a.meta),type:2})});var s=Fi(r);e.push(Hn(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Uu(e)}function J2e(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=sy(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(c=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Uu(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var h=Uu(i);if(h.length!=r)throw new Error("Unexpected length: ".concat(h.length," != ").concat(r));return h}function no(n){for(var e=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(J2e(r,n.slice(t,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return Uu(e)}function jf(n){for(var e=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=Hn(r),a=s.length;e.push(s),r<=60?(a++,e.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(n.slice(t,t+r)),a+=r,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=r}return Uu(e)}function OT(n,e){var t=new Uint8Array(32),r=ow(t),i=12,s=0;switch(t[0]=5,n.t){case"n":t[1]=2,Z2e(t,i,n.v),s|=1,i+=16;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,s,!0),t.slice(0,i)}function DT(n,e){var t=new Uint8Array(32),r=ow(t),i=12,s=0;switch(t[0]=3,n.t){case"n":t[2]=2,r.setFloat64(i,n.v,!0),s|=32,i+=8;break;case"b":t[2]=6,r.setFloat64(i,n.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,s,!0),t.slice(0,i)}function Zc(n){var e=ui(n);return sy(e[1][0].data)}function Q2e(n,e,t){var r,i,s,a;if(!((r=n[6])!=null&&r[0])||!((i=n[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=n[8])==null?void 0:s[0])==null?void 0:a.data)&&R0(n[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=ow(n[7][0].data),h=0,g=[],m=ow(n[4][0].data),y=0,v=[],_=0;_<e.length;++_){if(e[_]==null){c.setUint16(_*2,65535,!0),m.setUint16(_*2,65535);continue}c.setUint16(_*2,h,!0),m.setUint16(_*2,y,!0);var E,T;switch(typeof e[_]){case"string":E=OT({t:"s",v:e[_]},t),T=DT({t:"s",v:e[_]},t);break;case"number":E=OT({t:"n",v:e[_]},t),T=DT({t:"n",v:e[_]},t);break;case"boolean":E=OT({t:"b",v:e[_]},t),T=DT({t:"b",v:e[_]},t);break;default:throw new Error("Unsupported value "+e[_])}g.push(E),h+=E.length,v.push(T),y+=T.length,++l}for(n[2][0].data=Hn(l);_<n[7][0].data.length/2;++_)c.setUint16(_*2,65535,!0),m.setUint16(_*2,65535,!0);return n[6][0].data=Uu(g),n[3][0].data=Uu(v),l}function eSe(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=pa(t["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ni(r)));var s=lw(t,{range:r,header:1}),a=["~Sh33tJ5~"];s.forEach(function(Z){return Z.forEach(function(te){typeof te=="string"&&a.push(te)})});var o={},l=[],c=er.read(e.numbers,{type:"base64"});c.FileIndex.map(function(Z,te){return[Z,c.FullPaths[te]]}).forEach(function(Z){var te=Z[0],se=Z[1];if(te.type==2&&te.name.match(/\.iwa/)){var he=te.content,Ae=no(he),Fe=to(Ae);Fe.forEach(function(de){l.push(de.id),o[de.id]={deps:[],location:se,type:R0(de.messages[0].meta[1][0].data)}})}}),l.sort(function(Z,te){return Z-te});var h=l.filter(function(Z){return Z>1}).map(function(Z){return[Z,Hn(Z)]});c.FileIndex.map(function(Z,te){return[Z,c.FullPaths[te]]}).forEach(function(Z){var te=Z[0];if(Z[1],!!te.name.match(/\.iwa/)){var se=to(no(te.content));se.forEach(function(he){he.messages.forEach(function(Ae){h.forEach(function(Fe){he.messages.some(function(de){return R0(de.meta[1][0].data)!=11006&&Y2e(de.data,Fe[1])})&&o[Fe[0]].deps.push(he.id)})})})}});for(var g=er.find(c,o[1].location),m=to(no(g.content)),y,v=0;v<m.length;++v){var _=m[v];_.id==1&&(y=_)}var E=Zc(ui(y.messages[0].data)[1][0].data);for(g=er.find(c,o[E].location),m=to(no(g.content)),v=0;v<m.length;++v)_=m[v],_.id==E&&(y=_);for(E=Zc(ui(y.messages[0].data)[2][0].data),g=er.find(c,o[E].location),m=to(no(g.content)),v=0;v<m.length;++v)_=m[v],_.id==E&&(y=_);for(E=Zc(ui(y.messages[0].data)[2][0].data),g=er.find(c,o[E].location),m=to(no(g.content)),v=0;v<m.length;++v)_=m[v],_.id==E&&(y=_);var T=ui(y.messages[0].data);{T[6][0].data=Hn(r.e.r+1),T[7][0].data=Hn(r.e.c+1);var b=Zc(T[46][0].data),R=er.find(c,o[b].location),N=to(no(R.content));{for(var D=0;D<N.length&&N[D].id!=b;++D);if(N[D].id!=b)throw"Bad ColumnRowUIDMapArchive";var W=ui(N[D].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var I=0;I<=r.e.c;++I){var A=[];A[1]=A[2]=[{type:0,data:Hn(I+420690)}],W[1].push({type:2,data:Fi(A)}),W[2].push({type:0,data:Hn(I)}),W[3].push({type:0,data:Hn(I)})}W[4]=[],W[5]=[],W[6]=[];for(var M=0;M<=r.e.r;++M)A=[],A[1]=A[2]=[{type:0,data:Hn(M+726270)}],W[4].push({type:2,data:Fi(A)}),W[5].push({type:0,data:Hn(M)}),W[6].push({type:0,data:Hn(M)});N[D].messages[0].data=Fi(W)}R.content=jf(Ff(N)),R.size=R.content.length,delete T[46];var O=ui(T[4][0].data);{O[7][0].data=Hn(r.e.r+1);var L=ui(O[1][0].data),z=Zc(L[2][0].data);R=er.find(c,o[z].location),N=to(no(R.content));{if(N[0].id!=z)throw"Bad HeaderStorageBucket";var j=ui(N[0].messages[0].data);for(M=0;M<s.length;++M){var Ee=ui(j[2][0].data);Ee[1][0].data=Hn(M),Ee[4][0].data=Hn(s[M].length),j[2][M]={type:j[2][0].type,data:Fi(Ee)}}N[0].messages[0].data=Fi(j)}R.content=jf(Ff(N)),R.size=R.content.length;var Ce=Zc(O[2][0].data);R=er.find(c,o[Ce].location),N=to(no(R.content));{if(N[0].id!=Ce)throw"Bad HeaderStorageBucket";for(j=ui(N[0].messages[0].data),I=0;I<=r.e.c;++I)Ee=ui(j[2][0].data),Ee[1][0].data=Hn(I),Ee[4][0].data=Hn(r.e.r+1),j[2][I]={type:j[2][0].type,data:Fi(Ee)};N[0].messages[0].data=Fi(j)}R.content=jf(Ff(N)),R.size=R.content.length;var Ge=Zc(O[4][0].data);(function(){for(var Z=er.find(c,o[Ge].location),te=to(no(Z.content)),se,he=0;he<te.length;++he){var Ae=te[he];Ae.id==Ge&&(se=Ae)}var Fe=ui(se.messages[0].data);{Fe[3]=[];var de=[];a.forEach(function(It,Wt){de[1]=[{type:0,data:Hn(Wt)}],de[2]=[{type:0,data:Hn(1)}],de[3]=[{type:2,data:q2e(It)}],Fe[3].push({type:2,data:Fi(de)})})}se.messages[0].data=Fi(Fe);var Pe=Ff(te),Be=jf(Pe);Z.content=Be,Z.size=Z.content.length})();var Le=ui(O[3][0].data);{var ce=Le[1][0];delete Le[2];var Me=ui(ce.data);{var Te=Zc(Me[2][0].data);(function(){for(var Z=er.find(c,o[Te].location),te=to(no(Z.content)),se,he=0;he<te.length;++he){var Ae=te[he];Ae.id==Te&&(se=Ae)}var Fe=ui(se.messages[0].data);{delete Fe[6],delete Le[7];var de=new Uint8Array(Fe[5][0].data);Fe[5]=[];for(var Pe=0,Be=0;Be<=r.e.r;++Be){var It=ui(de);Pe+=Q2e(It,s[Be],a),It[1][0].data=Hn(Be),Fe[5].push({data:Fi(It),type:2})}Fe[1]=[{type:0,data:Hn(r.e.c+1)}],Fe[2]=[{type:0,data:Hn(r.e.r+1)}],Fe[3]=[{type:0,data:Hn(Pe)}],Fe[4]=[{type:0,data:Hn(r.e.r+1)}]}se.messages[0].data=Fi(Fe);var Wt=Ff(te),Dt=jf(Wt);Z.content=Dt,Z.size=Z.content.length})()}ce.data=Fi(Me)}O[3][0].data=Fi(Le)}T[4][0].data=Fi(O)}y.messages[0].data=Fi(T);var ie=Ff(m),V=jf(ie);return g.content=V,g.size=g.content.length,c}function tSe(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function xC(n){tSe([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function nSe(n,e){return e.bookType=="ods"?FG(n,e):e.bookType=="numbers"?eSe(n,e):e.bookType=="xlsb"?rSe(n,e):iSe(n,e)}function rSe(n,e){c0=1024,n&&!n.SSF&&(n.SSF=Ks(Br)),n&&n.SSF&&(kE(),AE(n.SSF),e.revssf=IE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,up?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",r=_G.indexOf(e.bookType)>-1,i=XB();xC(e=e||{});var s=nC(),a="",o=0;if(e.cellXfs=[],Zu(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",on(s,a,JB(n.Props,e)),i.coreprops.push(a),Kn(e.rels,2,a,Cn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}for(n.Props.Worksheets=n.Props.SheetNames.length,on(s,a,eG(n.Props)),i.extprops.push(a),Kn(e.rels,3,a,Cn.EXT_PROPS),n.Custprops!==n.Props&&Ki(n.Custprops||{}).length>0&&(a="docProps/custom.xml",on(s,a,tG(n.Custprops)),i.custprops.push(a),Kn(e.rels,4,a,Cn.CUST_PROPS)),o=1;o<=n.SheetNames.length;++o){var h={"!id":{}},g=n.Sheets[n.SheetNames[o-1]],m=(g||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,on(s,a,a2e(o-1,a,e,n,h)),i.sheets.push(a),Kn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Cn.WS[0])}if(g){var y=g["!comments"],v=!1,_="";y&&y.length>0&&(_="xl/comments"+o+"."+t,on(s,_,c2e(y,_)),i.comments.push(_),Kn(h,-1,"../comments"+o+"."+t,Cn.CMNT),v=!0),g["!legacy"]&&v&&on(s,"xl/drawings/vmlDrawing"+o+".vml",yG(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}h["!id"].rId1&&on(s,YB(a),T0(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,on(s,a,l2e(e.Strings,a,e)),i.strs.push(a),Kn(e.wbrels,-1,"sharedStrings."+t,Cn.SST)),a="xl/workbook."+t,on(s,a,s2e(n,a)),i.workbooks.push(a),Kn(e.rels,1,a,Cn.WB),a="xl/theme/theme1.xml",on(s,a,mG(n.Themes,e)),i.themes.push(a),Kn(e.wbrels,-1,"theme/theme1.xml",Cn.THEME),a="xl/styles."+t,on(s,a,o2e(n,a,e)),i.styles.push(a),Kn(e.wbrels,-1,"styles."+t,Cn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",on(s,a,n.vbaraw),i.vba.push(a),Kn(e.wbrels,-1,"vbaProject.bin",Cn.VBA)),a="xl/metadata."+t,on(s,a,u2e(a)),i.metadata.push(a),Kn(e.wbrels,-1,"metadata."+t,Cn.XLMETA),on(s,"[Content_Types].xml",qB(i,e)),on(s,"_rels/.rels",T0(e.rels)),on(s,"xl/_rels/workbook."+t+".rels",T0(e.wbrels)),delete e.revssf,delete e.ssf,s}function iSe(n,e){c0=1024,n&&!n.SSF&&(n.SSF=Ks(Br)),n&&n.SSF&&(kE(),AE(n.SSF),e.revssf=IE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,up?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=_G.indexOf(e.bookType)>-1,i=XB();xC(e=e||{});var s=nC(),a="",o=0;if(e.cellXfs=[],Zu(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",on(s,a,JB(n.Props,e)),i.coreprops.push(a),Kn(e.rels,2,a,Cn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}n.Props.Worksheets=n.Props.SheetNames.length,on(s,a,eG(n.Props)),i.extprops.push(a),Kn(e.rels,3,a,Cn.EXT_PROPS),n.Custprops!==n.Props&&Ki(n.Custprops||{}).length>0&&(a="docProps/custom.xml",on(s,a,tG(n.Custprops)),i.custprops.push(a),Kn(e.rels,4,a,Cn.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=n.SheetNames.length;++o){var g={"!id":{}},m=n.Sheets[n.SheetNames[o-1]],y=(m||{})["!type"]||"sheet";switch(y){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,on(s,a,kG(o-1,e,n,g)),i.sheets.push(a),Kn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Cn.WS[0])}if(m){var v=m["!comments"],_=!1,E="";if(v&&v.length>0){var T=!1;v.forEach(function(b){b[1].forEach(function(R){R.T==!0&&(T=!0)})}),T&&(E="xl/threadedComments/threadedComment"+o+"."+t,on(s,E,O_e(v,h,e)),i.threadedcomments.push(E),Kn(g,-1,"../threadedComments/threadedComment"+o+"."+t,Cn.TCMNT)),E="xl/comments"+o+"."+t,on(s,E,xG(v)),i.comments.push(E),Kn(g,-1,"../comments"+o+"."+t,Cn.CMNT),_=!0}m["!legacy"]&&_&&on(s,"xl/drawings/vmlDrawing"+o+".vml",yG(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}g["!id"].rId1&&on(s,YB(a),T0(g))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,on(s,a,cG(e.Strings,e)),i.strs.push(a),Kn(e.wbrels,-1,"sharedStrings."+t,Cn.SST)),a="xl/workbook."+t,on(s,a,PG(n)),i.workbooks.push(a),Kn(e.rels,1,a,Cn.WB),a="xl/theme/theme1.xml",on(s,a,mG(n.Themes,e)),i.themes.push(a),Kn(e.wbrels,-1,"theme/theme1.xml",Cn.THEME),a="xl/styles."+t,on(s,a,fG(n,e)),i.styles.push(a),Kn(e.wbrels,-1,"styles."+t,Cn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",on(s,a,n.vbaraw),i.vba.push(a),Kn(e.wbrels,-1,"vbaProject.bin",Cn.VBA)),a="xl/metadata."+t,on(s,a,pG()),i.metadata.push(a),Kn(e.wbrels,-1,"metadata."+t,Cn.XLMETA),h.length>1&&(a="xl/persons/person.xml",on(s,a,D_e(h)),i.people.push(a),Kn(e.wbrels,-1,"persons/person.xml",Cn.PEOPLE)),on(s,"[Content_Types].xml",qB(i,e)),on(s,"_rels/.rels",T0(e.rels)),on(s,"xl/_rels/workbook."+t+".rels",T0(e.wbrels)),delete e.revssf,delete e.ssf,s}function sSe(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=cc(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function jG(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return e1(e.file,er.write(n,{type:On?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return er.write(n,e)}function aSe(n,e){var t=Ks(e||{}),r=nSe(n,t);return oSe(r,t)}function oSe(n,e){var t={},r=On?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=n.FullPaths?er.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(RE(i))}return e.password&&typeof encrypt_agile<"u"?jG(encrypt_agile(i,e.password),e):e.type==="file"?e1(e.file,i):e.type=="string"?ap(i):i}function lSe(n,e){var t=e||{},r=T2e(n,t);return jG(r,t)}function Wo(n,e,t){t||(t="");var r=t+n;switch(e.type){case"base64":return ty(ry(r));case"binary":return ry(r);case"string":return n;case"file":return e1(e.file,r,"utf8");case"buffer":return On?vc(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Wo(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function cSe(n,e){switch(e.type){case"base64":return ty(n);case"binary":return n;case"string":return n;case"file":return e1(e.file,n,"binary");case"buffer":return On?vc(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Kx(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return e.type=="base64"?ty(t):e.type=="string"?ap(t):t;case"file":return e1(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function VG(n,e){Fye(),XEe(n);var t=Ks(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=VG(n,t);return t.type="array",RE(r)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=n.SheetNames.indexOf(t.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Wo(E2e(n,t),t);case"slk":case"sylk":return Wo(Wxe.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"htm":case"html":return Wo(LG(n.Sheets[n.SheetNames[i]],t),t);case"txt":return cSe(BG(n.Sheets[n.SheetNames[i]],t),t);case"csv":return Wo(_C(n.Sheets[n.SheetNames[i]],t),t,"\uFEFF");case"dif":return Wo(Hxe.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"dbf":return Kx($xe.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"prn":return Wo(Kxe.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"rtf":return Wo(e_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"eth":return Wo(lG.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"fods":return Wo(FG(n,t),t);case"wk1":return Kx(F5.sheet_to_wk1(n.Sheets[n.SheetNames[i]],t),t);case"wk3":return Kx(F5.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Kx(NG(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),lSe(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return aSe(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function uSe(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function hSe(n,e,t){var r={};return r.type="file",r.file=e,uSe(r),VG(n,r)}function dSe(n,e,t,r,i,s,a,o){var l=Hi(t),c=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),g=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:t,enumerable:!1})}catch{m.__rowNum__=t}else m.__rowNum__=t;if(!a||n[t])for(var y=e.s.c;y<=e.e.c;++y){var v=a?n[t][y]:n[r[y]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;s[y]!=null&&(m[s[y]]=c);continue}var _=v.v;switch(v.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[y]!=null){if(_==null)if(v.t=="e"&&_===null)m[s[y]]=null;else if(c!==void 0)m[s[y]]=c;else if(h&&_===null)m[s[y]]=null;else continue;else m[s[y]]=h&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?_:uc(v,_,o);_!=null&&(g=!1)}}return{row:m,isempty:g}}function lw(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},h=c.range!=null?c.range:n["!ref"];switch(c.header===1?r=1:c.header==="A"?r=2:Array.isArray(c.header)?r=3:c.header==null&&(r=0),typeof h){case"string":l=mr(h);break;case"number":l=mr(n["!ref"]),l.s.r=h;break;default:l=h}r>0&&(i=0);var g=Hi(l.s.r),m=[],y=[],v=0,_=0,E=Array.isArray(n),T=l.s.r,b=0,R={};E&&!n[T]&&(n[T]=[]);var N=c.skipHidden&&n["!cols"]||[],D=c.skipHidden&&n["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(N[b]||{}).hidden)switch(m[b]=ds(b),t=E?n[T][b]:n[m[b]+g],r){case 1:s[b]=b-l.s.c;break;case 2:s[b]=m[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=uc(t,null,c),_=R[a]||0,!_)R[a]=1;else{do o=a+"_"+_++;while(R[o]);R[a]=_,R[o]=1}s[b]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(D[T]||{}).hidden){var W=dSe(n,l,T,m,r,s,E,c);(W.isempty===!1||(r===1?c.blankrows!==!1:c.blankrows))&&(y[v++]=W.row)}return y.length=v,y}var W5=/"/g;function fSe(n,e,t,r,i,s,a,o){for(var l=!0,c=[],h="",g=Hi(t),m=e.s.c;m<=e.e.c;++m)if(r[m]){var y=o.dense?(n[t]||[])[m]:n[r[m]+g];if(y==null)h="";else if(y.v!=null){l=!1,h=""+(o.rawNumbers&&y.t=="n"?y.v:uc(y,null,o));for(var v=0,_=0;v!==h.length;++v)if((_=h.charCodeAt(v))===i||_===s||_===34||o.forceQuotes){h='"'+h.replace(W5,'""')+'"';break}h=="ID"&&(h='"ID"')}else y.f!=null&&!y.F?(l=!1,h="="+y.f,h.indexOf(",")>=0&&(h='"'+h.replace(W5,'""')+'"')):h="";c.push(h)}return o.blankrows===!1&&l?null:c.join(a)}function _C(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";var i=mr(n["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),h="",g=[];r.dense=Array.isArray(n);for(var m=r.skipHidden&&n["!cols"]||[],y=r.skipHidden&&n["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(m[v]||{}).hidden||(g[v]=ds(v));for(var _=0,E=i.s.r;E<=i.e.r;++E)(y[E]||{}).hidden||(h=fSe(n,i,E,g,a,l,s,r),h!=null&&(r.strip&&(h=h.replace(c,"")),(h||r.blankrows!==!1)&&t.push((_++?o:"")+h)));return delete r.dense,t.join("")}function BG(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=_C(n,e);return t}function gSe(n){var e="",t,r="";if(n==null||n["!ref"]==null)return[];var i=mr(n["!ref"]),s="",a=[],o,l=[],c=Array.isArray(n);for(o=i.s.c;o<=i.e.c;++o)a[o]=ds(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=Hi(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=c?(n[h]||[])[o]:n[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}l[l.length]=e+"="+r}return l}function GG(n,e,t){var r=t||{},i=+!r.skipHeader,s=n||{},a=0,o=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?ki(r.origin):r.origin;a=l.r,o=l.c}var c,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var g=mr(s["!ref"]);h.e.c=Math.max(h.e.c,g.e.c),h.e.r=Math.max(h.e.r,g.e.r),a==-1&&(a=g.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var m=r.header||[],y=0;e.forEach(function(_,E){Ki(_).forEach(function(T){(y=m.indexOf(T))==-1&&(m[y=m.length]=T);var b=_[T],R="z",N="",D=Qn({c:o+y,r:a+E+i});c=ay(s,D),b&&typeof b=="object"&&!(b instanceof Date)?s[D]=b:(typeof b=="number"?R="n":typeof b=="boolean"?R="b":typeof b=="string"?R="s":b instanceof Date?(R="d",r.cellDates||(R="n",b=Hs(b)),N=r.dateNF||Br[14]):b===null&&r.nullError&&(R="e",b=0),c?(c.t=R,c.v=b,delete c.w,delete c.R,N&&(c.z=N)):s[D]=c={t:R,v:b},N&&(c.z=N))})}),h.e.c=Math.max(h.e.c,o+m.length-1);var v=Hi(a);if(i)for(y=0;y<m.length;++y)s[ds(y+o)+v]={t:"s",v:m[y]};return s["!ref"]=ni(h),s}function mSe(n,e){return GG(null,n,e)}function ay(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var r=ki(e);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?ay(n,Qn(e)):ay(n,Qn({r:e,c:t||0}))}function pSe(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function ySe(){return{SheetNames:[],Sheets:{}}}function xSe(n,e,t,r){var i=1;if(!t)for(;i<=65535&&n.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&n.SheetNames.indexOf(t=a+i)!=-1;++i);}if(CG(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function _Se(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=pSe(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function vSe(n,e){return n.z=e,n}function zG(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function wSe(n,e,t){return zG(n,"#"+e,t)}function ESe(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function SSe(n,e,t,r){for(var i=typeof e!="string"?e:mr(e),s=typeof e=="string"?e:ni(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=ay(n,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=t,r&&(l.D=!0))}return n}var FT={encode_col:ds,encode_row:Hi,encode_cell:Qn,encode_range:ni,decode_col:lC,decode_row:oC,split_cell:F1e,decode_cell:ki,decode_range:pa,format_cell:uc,sheet_add_aoa:zB,sheet_add_json:GG,sheet_add_dom:OG,aoa_to_sheet:pg,json_to_sheet:mSe,table_to_sheet:DG,table_to_book:H2e,sheet_to_csv:_C,sheet_to_txt:BG,sheet_to_json:lw,sheet_to_html:LG,sheet_to_formulae:gSe,sheet_to_row_object_array:lw,sheet_get_cell:ay,book_new:ySe,book_append_sheet:xSe,book_set_sheet_visibility:_Se,cell_set_number_format:vSe,cell_set_hyperlink:zG,cell_set_internal_link:wSe,cell_add_comment:ESe,sheet_set_array_formula:SSe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const ll=bs()(pc((n,e)=>({vondsten:[],addVondst:t=>n(r=>({vondsten:[...r.vondsten,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeVondst:t=>n(r=>({vondsten:r.vondsten.filter(i=>i.id!==t)})),updateVondst:(t,r)=>n(i=>({vondsten:i.vondsten.map(s=>s.id===t?{...s,...r}:s)})),clearAll:()=>n({vondsten:[]}),exportAsGeoJSON:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r={type:"FeatureCollection",features:t.map(o=>({type:"Feature",geometry:{type:"Point",coordinates:[o.location.lng,o.location.lat]},properties:{id:o.id,objectType:o.objectType,material:o.material,period:o.period,depth:o.depth,notes:o.notes,timestamp:o.timestamp,photoUrl:o.photoUrl,condition:o.condition,weight:o.weight,length:o.length}}))},i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),a=document.createElement("a");a.href=s,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)},exportAsCSV:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=`ID,Latitude,Longitude,Datum,Type,Materiaal,Periode,Diepte (cm),Conditie,Gewicht (g),Lengte (mm),Notities,Foto URL
`,i=t.map(c=>{const h=new Date(c.timestamp).toLocaleDateString("nl-NL"),g=c.notes?`"${c.notes.replace(/"/g,'""')}"`:"";return`${c.id},${c.location.lat},${c.location.lng},${h},${c.objectType},${c.material},${c.period},${c.depth||""},${c.condition||""},${c.weight||""},${c.length||""},${g},${c.photoUrl||""}`}).join(`
`),s=r+i,a=new Blob([s],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(a),l=document.createElement("a");l.href=o,l.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)},exportAsExcel:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(o=>({ID:o.id,Latitude:o.location.lat,Longitude:o.location.lng,Datum:new Date(o.timestamp).toLocaleDateString("nl-NL"),Type:o.objectType,Materiaal:o.material,Periode:o.period,"Diepte (cm)":o.depth||"",Conditie:o.condition||"","Gewicht (g)":o.weight||"","Lengte (mm)":o.length||"",Notities:o.notes||"","Foto URL":o.photoUrl||""})),i=FT.json_to_sheet(r),s=FT.book_new();FT.book_append_sheet(s,i,"Vondsten");const a=[{wch:36},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:40},{wch:50}];i["!cols"]=a,hSe(s,`mijn-vondsten-${new Date().toISOString().split("T")[0]}.xlsx`)},exportAsGPX:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(l=>{const c=new Date(l.timestamp).toISOString();return`  <wpt lat="${l.location.lat}" lon="${l.location.lng}">
    <name>${l.objectType} - ${l.material}</name>
    <desc>${l.period}${l.depth?`, ${l.depth}cm diep`:""}${l.condition&&l.condition!=="Onbekend"?`, ${l.condition}`:""}${l.weight?`, ${l.weight}g`:""}${l.length?`, ${l.length}mm`:""}${l.notes?`. ${l.notes}`:""}</desc>
    <time>${c}</time>
    <sym>Pin</sym>
  </wpt>`}).join(`
`),i=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL" xmlns="http://www.topografix.com/GPX/1/1">
  <metadata>
    <name>Mijn Vondsten</name>
    <desc>Geexporteerd uit DetectorApp NL</desc>
    <time>${new Date().toISOString()}</time>
  </metadata>
${r}
</gpx>`,s=new Blob([i],{type:"application/gpx+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.gpx`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},exportAsKML:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const i=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>Mijn Vondsten</name>
    <description>Geexporteerd uit DetectorApp NL</description>
${t.map(l=>{const c=new Date(l.timestamp).toLocaleDateString("nl-NL"),h=`<![CDATA[
            <b>Type:</b> ${l.objectType}<br/>
            <b>Materiaal:</b> ${l.material}<br/>
            <b>Periode:</b> ${l.period}<br/>
            ${l.depth?`<b>Diepte:</b> ${l.depth} cm<br/>`:""}
            ${l.condition&&l.condition!=="Onbekend"?`<b>Conditie:</b> ${l.condition}<br/>`:""}
            ${l.weight?`<b>Gewicht:</b> ${l.weight} gram<br/>`:""}
            ${l.length?`<b>Lengte:</b> ${l.length} mm<br/>`:""}
            <b>Datum:</b> ${c}<br/>
            ${l.notes?`<b>Notities:</b> ${l.notes}<br/>`:""}
            ${l.photoUrl?`<a href="${l.photoUrl}">Bekijk foto</a>`:""}
          ]]>`;return`    <Placemark>
      <name>${l.objectType} - ${l.material}</name>
      <description>${h}</description>
      <Point>
        <coordinates>${l.location.lng},${l.location.lat},0</coordinates>
      </Point>
    </Placemark>`}).join(`
`)}
  </Document>
</kml>`,s=new Blob([i],{type:"application/vnd.google-earth.kml+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.kml`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}}),{name:"detectorapp-local-vondsten"})),TSe={Fectio:{naam:"Fectio",latinNaam:"Fectio",type:"castellum",periode:"ca. 4 - 270 n.Chr.",beschrijving:"Groot Romeins castellum bij Bunnik/Vechten, aan de splitsing van Rijn en Vecht. Een van de belangrijkste legerbases in Nederland met ruimte voor 500 soldaten. Het fort had barakken, badhuis, hospitaal en pakhuizen. Buiten de muren woonden handelaren en soldatenfamilies in een vicus. Hier is een compleet Romeins schip gevonden (De Meern 1). Strategisch gelegen voor transport over de rivieren. Veel vondsten door natte bodem: leer, hout, textiel naast munten en militaria. Te bezoeken: Archeologisch Park Castellum Hoge Woerd met reconstructie en museum.",watWasHier:"Groot castellum met ruimte voor 500 soldaten, barakken, badhuis, hospitaal en pakhuizen. Buiten het fort een burgerdorp.",watTeZien:"Archeologisch Park Castellum Hoge Woerd toont de contouren. Museum met veel vondsten waaronder een Romeins schip.",verwachteVondsten:"Munten, fibulae, aardewerk, wapens, paardentuig, militaire uitrusting. Door natte bodem ook leer, hout en textiel.",betekenis:"Een van de belangrijkste forten aan de Limes. Knooppunt voor troepen- en goederentransport.",bronnen:["https://www.hogewoerd.nl","https://www.livius.org/articles/place/fectio-vechten/"]},Traiectum:{naam:"Traiectum",latinNaam:"Traiectum",type:"castellum",periode:"ca. 42 - 275 n.Chr.",beschrijving:'Romeins castellum onder het huidige Domplein in Utrecht. De naam betekent "doorwaadbare plaats" - hier splitsten Rijn en Vecht. Het fort (124x152m in laatste fase) bood plaats aan ca. 500 soldaten. Vijf bouwfases: eerst hout, na 200 n.Chr. steen met tufsteen uit de Eifel. Cohors II Hispanorum peditata (Spaanse infanterie) was hier uniek gelegerd 88-275 n.Chr. - hun dakpanstempels zijn nergens anders aan de Limes gevonden! Het fort werd verwoest tijdens de Bataafse Opstand (69 n.Chr.). DOMunder onder het Domplein toont de opgegraven resten. UNESCO Werelderfgoed sinds 2021.',watWasHier:"Castellum (500 soldaten) bij riviersplitsing. Cohors II Hispanorum gelegerd.",watTeZien:"DOMunder onder het Domplein: opgravingen te bezoeken. Principia en poorten blootgelegd.",verwachteVondsten:"Dakpannen met stempels, munten, aardewerk, tufsteen bouwmateriaal, militaria.",betekenis:"UNESCO Werelderfgoed. Oorsprong van de stad Utrecht.",bronnen:["https://www.livius.org/articles/place/traiectum-utrecht/","https://www.utrechtaltijd.nl/verhalen/castellum-traiectum-een-romeinse-legerbasis-in-het-hart-van-de-domstad/","https://www.romeinen.nl/locatie-overzicht/3447271878/domunder-castellum-traiectum"]},Laurum:{naam:"Laurum",latinNaam:"Laurum",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in het huidige Woerden aan de Oude Rijn. Garnizoen van ca. 500 soldaten in houten barakken. Bijzonder vanwege de natte veenbodem: organisch materiaal bleef bewaard zoals houten schrijfplankjes met Latijnse teksten, leren schoenen en een Romeinse boot. Het fort werd meerdere keren herbouwd na overstromingen. De contouren zijn in het stratenpatroon herkenbaar. Buiten de muren lag een vicus (burgerdorp). Vondsten in Stadsmuseum Woerden, waaronder unieke houten voorwerpen die elders zijn vergaan.",watWasHier:"Castellum voor 500 soldaten met houten barakken, badhuis en pakhuizen. Vicus buiten de muren.",watTeZien:"Stadsmuseum Woerden met bijzondere vondsten. Fort-contouren in stratenpatroon herkenbaar.",verwachteVondsten:"Militaria, aardewerk, munten, schrijfplankjes. Door natte veengrond ook hout, leer en schoenen.",betekenis:"Toont Romeins bouwen in moeilijk veengebied. Unieke organische vondsten.",bronnen:["https://www.castellumwoerden.nl"]},"Castellum Praetorium Agrippinae":{naam:"Praetorium Agrippinae",latinNaam:"Praetorium Agrippinae",type:"castellum",periode:"ca. 40 - 275 n.Chr.",beschrijving:"Een van de best opgegraven Romeinse locaties van Nederland. Het castellum werd gesticht in de winter van 39/40 n.Chr. door keizer Caligula, vernoemd naar zijn moeder Vipsania Agrippina. Een opgegraven wijnvat bevatte wijn van de persoonlijke wijngaarden van de keizer! Er zijn 7 bouwfasen gevonden, 6 van hout en de laatste van steen - uniek compleet inzicht in Romeinse bouwtechnieken. Cohors III Gallorum equitata was hier gelegerd. Bij opgravingen (1941-1953) zijn door het grondwater veel organische vondsten bewaard: voedselresten, leer, touw. De vicus buiten het fort strekte zich 1 km uit met 700+ graven. Op het Castellumplein zijn de contouren in brons gemarkeerd.",watWasHier:"Castellum met 7 bouwfasen. Vicus (1 km) met 700+ graven. Detachement Cohors III Gallorum.",watTeZien:"Castellumplein met bronzen markeringen. Torenmuseum Valkenburg. Gereconstrueerde poort.",verwachteVondsten:"Militaria, organisch materiaal (voedsel, leer, touw), aardewerk, munten, inscripties.",betekenis:"Best gedocumenteerde Romeinse fort van Nederland. UNESCO Werelderfgoed.",bronnen:["https://www.livius.org/articles/place/praetorium-agrippinae-valkenburg-zh/","https://www.geschiedenisvanzuidholland.nl/zien-en-doen/locaties/praetorium-agrippinae-in-valkenburg/","https://oudvalkenburgzh.nl/torenmuseum-5/"]},"Castra Hunnerberg":{naam:"Castra Hunnerberg",latinNaam:"Castra",type:"legerkamp",periode:"ca. 16 v.Chr. - 104 n.Chr.",beschrijving:'Enorm Romeins legerkamp op de Hunnerberg bij Nijmegen - 42 hectare (80 voetbalvelden), ruimte voor 12.000 man. De enige plek in Nederland waar echte legioenen (geen hulptroepen) verbleven! Na de Bataafse Opstand (69 n.Chr.) vestigde Legio X Gemina Pia Fidelis zich hier - opgericht door Julius Caesar en het bekendste legioen van Nederland. De afkorting LXG is talloze keren gevonden op dakpannen en tegels. Bij opgravingen zijn ruim 1000 fragmenten militaire uitrusting en paardentuig gevonden. In 104 n.Chr. vertrok het legioen naar de Balkan - een ramp voor de economie. UNESCO Werelderfgoed sinds 2021, omschreven als "bakermat van de Nederduitse Limes".',watWasHier:"Legerkamp voor 12.000 man. Legio X Gemina (71-104 n.Chr.), opgericht door Julius Caesar.",watTeZien:"Museum Het Valkhof. Museum Kam in de Hunnerberg. Grafvelden in Nijmegen-Oost.",verwachteVondsten:"Legioenstempels LXG, militaria, paardentuig, dakpannen, munten, grafstenen.",betekenis:"UNESCO Werelderfgoed. Bakermat van de Limes. Enige legioenskamp in Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-hunnerberg/","https://www.welkominnijmegen.nl/pages/geschiedenis/de-romeinen-in-nijmegen/de-legerkampen.php","https://mijngelderland.nl/inhoud/specials/archeokroniek/romeinse-militaire-uitrusting-en-paardentuig-van-de-hunerberg-te-nijmegen"]},"Castellum Kops Plateau":{naam:"Kops Plateau",latinNaam:"Oppidum Batavorum",type:"castellum",periode:"ca. 10 v.Chr. - 70 n.Chr.",beschrijving:"Vroege Romeinse basis op het Kops Plateau in Nijmegen, later de civiele hoofdstad van de Bataven: Oppidum Batavorum. Hier woonden Romeinen en Bataven samen - het eerste contactpunt tussen beide culturen. Verwoest tijdens de Bataafse Opstand van 69-70 n.Chr. onder leiding van Julius Civilis. Gemengde vondsten: Romeinse militaria n Keltisch-Bataafse voorwerpen. Vroege importaardewerk en munten van Augustus. Nu natuurgebied. Museum Het Valkhof toont de unieke vondsten van deze ontmoeting van culturen.",watWasHier:"Eerst Romeins kamp, later Bataafse hoofdstad. Romeinen en Bataven woonden samen.",watTeZien:"Kops Plateau is natuurgebied. Museum Het Valkhof toont de vondsten.",verwachteVondsten:"Vroege militaria, Keltisch-Bataafse voorwerpen, importaardewerk, munten van Augustus.",betekenis:"Eerste contactpunt Romeinen-Bataven. Begin van romanisering Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-kops-plateau/"]},"Nijmegen, Valkhof":{naam:"Valkhof Nijmegen",latinNaam:"Valkhof",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:"Laat-Romeinse versterking op het Valkhof in Nijmegen, aan de Waaloever. Gebouwd toen het Rijk onder druk stond van Germaanse invallen. Strategische positie boven de rivier. Continuteit: Karel de Grote bouwde hier later zijn palts (koninklijke residentie). De Sint-Nicolaaskapel bevat mogelijk Karolingische elementen op Romeinse fundamenten. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Museum Het Valkhof toont de overgang van Romeinse tijd naar vroege middeleeuwen.",watWasHier:"Laat-Romeinse versterking boven de Waal. Later Karolingische palts.",watTeZien:"Valkhofpark met Sint-Nicolaaskapel. Museum Het Valkhof.",verwachteVondsten:"Laat-Romeinse munten, gordels, riemtongen, militaire gespen, 3e-4e eeuws aardewerk.",betekenis:"Toont overgang Romeinse tijd naar middeleeuwen. Nijmegen bleef machtscentrum.",bronnen:["https://www.museumhetvalkhof.nl"]},"Castellum Op de Hoge Woerd":{naam:"Hoge Woerd",latinNaam:"Castellum",type:"castellum",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeins castellum in Leidsche Rijn (Utrecht), nu een voorbeeldig archeologisch park. Middelgroot fort met houten gebouwen en een burgerdorp (vicus) buiten de muren. Hier is een compleet Romeins schip gevonden: De Meern 1, een 25 meter lange vrachtboot. Door de natte kleigrond bleef veel organisch materiaal bewaard. Het park toont de reconstructie van het fort - je kunt over de originele fundamenten lopen. Modern museum met interactieve presentatie. Ideale plek om te zien hoe een Romeins fort eruitzag.",watWasHier:"Middelgroot castellum met houten gebouwen. Vicus buiten de muren. Compleet schip gevonden.",watTeZien:"Archeologisch Park Hoge Woerd: reconstructie fort, museum, originele fundamenten.",verwachteVondsten:"Militaria, scheepsonderdelen, aardewerk, munten. Door natte grond ook organisch materiaal.",betekenis:"Best gepresenteerde Romeinse fort in Nederland. Ideaal om fort-layout te begrijpen.",bronnen:["https://www.hogewoerd.nl"]},Lugdunum:{naam:"Lugdunum",latinNaam:"Lugdunum",type:"vlootbasis",periode:"ca. 40 - 270 n.Chr.",beschrijving:`Romeinse vlootbasis en versterkte graanopslagplaats bij de monding van de Rijn, het westelijkste punt van de gehele Limes. Hier stond mogelijk een enorme vuurtoren (ca. 60m hoog) naar model van de Pharos van Ostia - vissers noemden deze "Kalla's toren" (Caligula). Door de vele dakpannen van de Romeinse vloot wordt aangenomen dat dit een vlootbasis was. Het fort is door kustafslag in zee verdwenen. Bij stormen in 1520, 1552 en 1562 waren de runes van de "Brittenburg" zichtbaar op het strand; de laatst gedateerde vondst was 270 n.Chr. Het Rijksmuseum van Oudheden in Leiden toont vondsten. De beroemde kaart van Ortelius toont hoe het eruit zag.`,watWasHier:"Vlootbasis met vuurtoren bij Rijnmonding. Graanopslag voor Britannia.",watTeZien:"Fort verdwenen in zee. RMO Leiden toont vondsten en kaart van Ortelius.",verwachteVondsten:"Na stormen: munten, aardewerk, militaria. Fort zelf onbereikbaar in Noordzee.",betekenis:"Westelijk eindpunt van de Limes. Verbinding met Britannia.",bronnen:["https://www.livius.org/articles/place/lugdunum-katwijk/","https://nl.wikipedia.org/wiki/Lugdunum_(Katwijk)"]},"Vlootbasis Naaldwijk":{naam:"Vlootbasis Naaldwijk",type:"vlootbasis",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Vermoedelijke basis van de Classis Germanica (Germaanse vloot) bij Naaldwijk in het Westland. De Romeinse vloot patrouilleerde langs de Noordzeekust en vervoerde troepen en goederen naar Britannia. Haven met dokken voor oorlogsschepen en transportboten. Mariniers (classiarii) waren hier gestationeerd. Het gebied is nu landbouwgrond, maar bij opgravingen zijn haven-structuren en scheepsgerelateerde vondsten gedaan. Ankers, scheepsonderdelen en specifieke mariniers-uitrusting. Toont het belang van zeemacht voor de Romeinse grensverdediging.",watWasHier:"Haven voor oorlogsschepen. Mariniers gestationeerd. Patrouilles langs Noordzeekust.",watTeZien:"Gebied is landbouwgrond. Vondsten in lokale musea.",verwachteVondsten:"Scheepsonderdelen, ankers, mariniers-uitrusting, importaardewerk.",betekenis:"Toont belang Romeinse vloot voor kustverdediging.",bronnen:[]},"Minifort Ockenburg":{naam:"Minifort Ockenburg",type:"minifort",periode:"ca. 150 - 180 n.Chr.",beschrijving:"Klein Romeins kustfort bij Ockenburg in Den Haag, op een oude strandwal. Bewaakte de kust tegen piraten en Germaanse invallen over zee. Ruimte voor slechts 20-30 soldaten - een wachtpost eerder dan een echt fort. Korte gebruiksperiode van ca. 30 jaar. Toont dat de Romeinen niet alleen de rivieren maar ook de Noordzeekust verdedigden. Het terrein is beschermd rijksmonument maar niet publiek toegankelijk. Vondsten in het Haags Historisch Museum: militaria, aardewerk en munten uit de 2e eeuw.",watWasHier:"Kleine kustwachtpost voor 20-30 soldaten op strandwal.",watTeZien:"Terrein beschermd maar niet toegankelijk. Haags Historisch Museum.",verwachteVondsten:"Kleine hoeveelheden militaria, aardewerk, munten 2e eeuw.",betekenis:"Toont Romeinse kustverdediging naast rivierforten.",bronnen:[]},"Castellum Ceuclum":{naam:"Ceuclum",latinNaam:"Ceuclum",type:"castellum",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Romeins castellum bij Cuijk aan de Maas, waar de belangrijke weg naar het noorden de rivier kruiste. Het fort bewaakte een brug of veerpont. Garnizoen van hulptroepen. De naam Cuijk is afgeleid van Ceuclum. Bij de brug werden ritueel munten geofferd. Het fort lag op een strategisch punt waar de Maasroute de landweg kruiste. Vondsten wijzen op handel en militaire activiteit. Het Maasmuseum in Cuijk toont lokale Romeinse vondsten. Onder het centrum zijn bij bouwwerkzaamheden regelmatig resten gevonden.",watWasHier:"Castellum bij Maasbrug. Belangrijke rivierovergang en kruispunt.",watTeZien:"Maasmuseum Cuijk. Resten gevonden onder centrum.",verwachteVondsten:"Munten (geofferd bij brug), fibulae, aardewerk, bruggerelateerde vondsten.",betekenis:"Belangrijke schakel in wegennet langs de Maas.",bronnen:["https://www.livius.org/articles/place/ceuclum-cuijk/"]},"Castellum Meinerswijk":{naam:"Meinerswijk",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in de uiterwaarden bij Arnhem-Meinerswijk aan de Rijn. Het fort bewaakt een strategisch punt waar de rivier goed te overzien was. Meerdere bouwfasen door overstromingen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan: militaria, aardewerk, munten en scheepsresten. Het gebied is nu natuurgebied Meinerswijk met wisselende waterstanden. Na hoog water kunnen vondsten aan de oppervlakte komen. Museum Arnhem toont Romeinse vondsten uit de regio.",watWasHier:"Castellum in uiterwaarden. Meerdere bouwfasen door overstromingen.",watTeZien:"Natuurgebied Meinerswijk. Museum Arnhem.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},Levefanum:{naam:"Levefanum",latinNaam:"Levefanum",type:"versterking",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeinse versterking bij Wijk bij Duurstede, waar de Rijn splitste in de Lek en Kromme Rijn. Strategisch cruciaal punt voor controle over het scheepvaartverkeer. Waarschijnlijk ook een haven voor overslag van goederen. Op dezelfde plek ontstond later de Karolingische handelsstad Dorestad, een van de belangrijkste havens van vroegmiddeleeuws Europa. De continuteit toont het blijvende belang van deze locatie. Dorestad Museum vertelt het verhaal van Romeinse tijd tot Vikingaanvallen. Vondsten: munten, handelsaardewerk, militaria.",watWasHier:"Versterking bij riviersplitsing. Haven en overslagpunt. Later Dorestad.",watTeZien:"Dorestad Museum. Terrein bebouwd.",verwachteVondsten:"Munten, handelsaardewerk, militaria, scheepsgerelateerde vondsten.",betekenis:"Strategisch controlepunt waterwegen. Later belangrijke handelsstad Dorestad.",bronnen:[]},"Nigrum Pullum":{naam:"Nigrum Pullum",latinNaam:"Nigrum Pullum (Zwarte Poel)",type:"minifort",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Zwammerdam aan de Oude Rijn. Garnizoen van 100-150 soldaten met pakhuizen en haven voor riviertransport. Wereldberoemd door de vondst van 6 Romeinse schepen (1971-1974) in perfecte staat - bewaard door de natte veengrond. De Zwammerdamschepen zijn de best bewaarde Romeinse rivierschepen ter wereld en tonen uniek inzicht in Romeins transport en scheepsbouw. Vondsten: schepen, leren schoeisel, houten voorwerpen, aardewerk, munten, militaria. Te zien in Rijksmuseum van Oudheden, Leiden.",watWasHier:"Klein fort met pakhuizen en haven. Bij opgravingen werden 6 Romeinse schepen gevonden.",watTeZien:"De schepen zijn in het Rijksmuseum van Oudheden in Leiden. Het terrein zelf is niet te bezoeken.",verwachteVondsten:"Scheepsonderdelen, leren schoeisel, houten voorwerpen, aardewerk, munten, en door de natte veengrond organisch materiaal.",betekenis:"Wereldberoemd om de goed bewaarde Romeinse schepen. Toont transport over de Rijn.",bronnen:["https://www.rmo.nl/collectie/themas/zwammerdam"]},"Stenen wachttoren Vleuterweide":{naam:"Wachttoren Vleuterweide",type:"wachttoren",periode:"ca. 150 - 250 n.Chr.",beschrijving:"Bijzondere stenen wachttoren in Vleuterweide bij Utrecht - de meeste Romeinse wachttorens waren van hout. De stenen constructie wijst op permanentie en belang. Onderdeel van het signaleringssysteem langs de Limes: bij gevaar werden vuren aangestoken om forten te waarschuwen. De toren bood uitzicht over de omgeving en de rivier. Mogelijk woonden hier ook families van de soldaten. De fundamenten zijn gemarkeerd in de moderne woonwijk. Vondsten: bouwmateriaal (dakpannen, stenen), aardewerk, persoonlijke bezittingen. Centraal Museum Utrecht.",watWasHier:"Stenen wachttoren (ongebruikelijk). Signaalpost voor waarschuwingssysteem.",watTeZien:"Fundamenten gemarkeerd in wijk. Centraal Museum Utrecht.",verwachteVondsten:"Dakpannen met legioenstempels, aardewerk, persoonlijke bezittingen.",betekenis:"Een van weinige bekende stenen wachttorens. Toont variatie in bouwwijzen.",bronnen:[]},"Wachttoren Bunnik":{naam:"Wachttoren Bunnik",type:"wachttoren",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Houten wachttoren bij Bunnik aan de Rijn, onderdeel van het signaleringssysteem langs de Limes. Elke paar kilometer stond een toren met uitzicht over de rivier. Bij nadering van vijanden werden vuren of rooksignalen gegeven, zodat binnen minuten alle forten gewaarschuwd waren. De torens waren meestal van hout op een aarden verhoging. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend doordat het gebied nu bebouwd is. Vondsten zijn schaars: wat aardewerk en militaria.",watWasHier:"Houten uitkijktoren voor signalering. Kleine bezetting van 4-8 soldaten.",watTeZien:"Exacte locatie onbekend. Gebied bebouwd.",verwachteVondsten:"Kleine hoeveelheden militaria en aardewerk.",betekenis:"Onderdeel signaleringssysteem langs Limes.",bronnen:[]},"Castellum Maastricht":{naam:"Castellum Maastricht",latinNaam:"Mosae Trajectum",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:'Laat-Romeinse versterking in het centrum van Maastricht bij de brug over de Maas. Mosae Trajectum betekent "Maasoversteek". Gebouwd in een periode dat het Rijk onder druk stond van Germaanse invallen. Het fort bewaakte de strategische rivierovergang. Continuteit van bewoning: Maastricht bleef bewoond tot op heden. Onder het Vrijthof en omgeving zijn Romeinse resten gevonden. Typische laat-Romeinse vondsten: gordels, riembeslag, munten 3e-4e eeuw, zwaar versterkte muren. Centre Ceramique vertelt de geschiedenis.',watWasHier:"Laat-Romeinse versterking bij Maasbrug. Verdediging tegen Germaanse invallen.",watTeZien:"Onder Vrijthof zijn resten. Centre Ceramique.",verwachteVondsten:"Laat-Romeinse munten, militaire gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont continuteit - Maastricht ononderbroken bewoond sinds Romeinse tijd.",bronnen:["https://www.centreceramique.nl"]},Roompot:{naam:"Roompot Fort",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de Roompot in Zeeland dat de toegang tot de Oosterschelde bewaakte. Het fort beschermde schepen tegen piraterij en controleerde de vaarroute. Door zeespiegelstijging en kustafslag is het fort in de golven verdwenen. De exacte locatie ligt nu onder water. Soms spoelen na stormen vondsten aan op de stranden van Noord-Beveland en Walcheren: munten, aardewerk, metalen voorwerpen. Toont dat de Romeinen de gehele Zeeuwse delta controleerden, niet alleen de grote rivieren.",watWasHier:"Kustfort dat zeeroute bewaakte. Bescherming tegen piraterij.",watTeZien:"Fort verdwenen in zee. Soms vondsten op strand na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen voorwerpen op Zeeuwse stranden.",betekenis:"Toont Romeinse controle over Zeeuwse wateren.",bronnen:[]},"Castellum Carvium":{naam:"Carvium",latinNaam:"Carvium",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Herwen-Aerdt (bij Lobith) waar Rijn en Waal samenkwamen - een strategisch knooppunt van eerste orde. Het fort controleerde het rivierverkeer op beide grote stromen. Garnizoen van hulptroepen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan. Het gebied is nu natuurgebied de Gelderse Poort met dynamische rivierlandschap. Na hoog water kunnen vondsten aan oppervlakte komen. Museum Het Valkhof in Nijmegen toont vondsten uit de regio. Scheepsresten gevonden.",watWasHier:"Fort bij samenvloeiing Rijn en Waal. Controleerde twee grote rivieren.",watTeZien:"Natuurgebied Gelderse Poort. Museum Het Valkhof Nijmegen.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Controleerde strategisch knooppunt waterwegen.",bronnen:[]},Matilo:{naam:"Matilo",latinNaam:"Matilo",type:"castellum",periode:"ca. 70 - 260 n.Chr.",beschrijving:'Romeins castellum bij Leiden-Roomburg, gebouwd na de Bataafse Opstand (69-70 n.Chr.) op een strategische plek aan de monding van het Kanaal van Corbulo. Het gigantische fort (80x120m) bood plaats aan ca. 500 soldaten en is een van de best bewaarde castella in Nederland. De archeologische resten liggen grotendeels intact onder Archeologisch Park Matilo. In het park staan 6 replica-wachttorens en een aarden wal die de omtrek van het fort visualiseert. Het fort werd tussen 240-260 n.Chr. opgeheven. De locatie Roomburg ("Romeinse burcht") verwijst naar de oorsprong. UNESCO Werelderfgoed sinds 2021.',watWasHier:"Groot castellum (500 soldaten) bij monding Kanaal van Corbulo. Vicus buiten de muren.",watTeZien:"Archeologisch Park Matilo met 6 wachttoren-replica's en aarden wal. Rijksmuseum van Oudheden.",verwachteVondsten:"Militaria, grafgiften, crematie-urnen, aardewerk, munten, fibulae.",betekenis:"UNESCO Werelderfgoed. Een van de best bewaarde castella van Nederland.",bronnen:["https://parkmatilo.nl/het-verhaal-van-matilo/","https://www.limeswerelderfgoed.nl/locaties/2016475046/archeologisch-park-matilo","https://www.romeinen.nl/locatie-overzicht/2016475046/archeologisch-park-matilo"]},Corbulo:{naam:"Forum Hadriani",latinNaam:"Forum Hadriani (Municipium Aelium Cananefatium)",type:"versterking",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Forum Hadriani bij Voorburg was de noordelijkste Romeinse stad van het Europese continent en de enige stad met stadsrechten in Nederland. Gesticht rond 70 n.Chr. aan het Kanaal van Corbulo (34 km, verbinding Rijn-Maas). Keizer Hadrianus verleende in 121 n.Chr. marktrechten en gaf de stad zijn naam. Rond 150 n.Chr. kreeg het stadsrechten (Municipium). De stad had ca. 1000 inwoners, een stadsmuur met dubbele gracht, stenen gebouwen en tempels. Park Arentsburgh markeert de locatie. UNESCO Werelderfgoed sinds 2021. De eerste wetenschappelijke opgravingen (1827-1833) waren door Caspar Reuvens, de eerste hoogleraar archeologie ter wereld.",watWasHier:"Enige Romeinse stad met stadsrechten in Nederland. Ca. 1000 inwoners.",watTeZien:"Park Arentsburgh in Voorburg. Kanaal traceerbaar als de Vliet.",verwachteVondsten:"Stedelijke vondsten: bouwmateriaal, aardewerk, munten, inscripties, religieuze voorwerpen.",betekenis:"UNESCO Werelderfgoed. Noordelijkste Romeinse stad van Europa.",bronnen:["https://www.awlv.nl/forum-hadriani/de-stad-forum-hadriani/","https://www.romeinen.nl/weten/nederland-in-de-romeinse-tijd/zuid-holland/regio-voorburg","https://kennis.cultureelerfgoed.nl/index.php/Monumenten/508083"]},"Berg - Tomveld":{naam:"Berg-Tomveld",type:"villa",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse villa bij Berg in Zuid-Limburg, mogelijk tijdelijk militair gebruikt. Dit type gebouwen diende als landbouwbedrijf met luxe woondeel voor de eigenaar. De regio Zuid-Limburg was dicht bebouwd met villa's die graan en vee leverden aan het Romeinse leger. Vondsten wijzen op welvaart: mozaekvloeren, beschilderd pleisterwerk, hypocaustum (vloerverwarming). De locatie Tomveld verwijst mogelijk naar Romeinse grafheuvels (tumuli) in de buurt. Thermenmuseum Heerlen toont de villa-cultuur.",watWasHier:"Villa rustica met mogelijk militair gebruik. Landbouw voor legervoorraden.",watTeZien:"Locatie in agrarisch gebied. Thermenmuseum Heerlen.",verwachteVondsten:"Bouwmateriaal, dakpannen, aardewerk, munten, sieraden.",betekenis:"Toont Romeinse landbouweconomie in Zuid-Limburg.",bronnen:[]},"Berg - Trappenberg":{naam:"Berg-Trappenberg",type:"legerkamp",periode:"1e eeuw v.Chr. - 1e eeuw n.Chr.",beschrijving:"Vroeg-Romeins legerkamp bij Berg in Zuid-Limburg dat later werd omgebouwd tot villa of boerderij. Toont de transitie van militaire bezetting naar civiele bewoning. Het kamp dateert uit de veroveringsperiode toen Rome dit gebied inlijfde. Na pacificatie was een fort niet meer nodig en werd het terrein civiel benut. Vondsten: vroege Romeinse militaria naast later agrarisch materiaal. Zuid-Limburg was een grenszone voordat de Limes naar de Rijn verplaatste.",watWasHier:"Eerst legerkamp, later villa/boerderij. Overgang militair naar civiel.",watTeZien:"Locatie in landbouwgebied.",verwachteVondsten:"Vroege militaria, later agrarisch aardewerk, bouwmateriaal.",betekenis:"Toont Romeinse verovering en pacificatie van Zuid-Limburg.",bronnen:[]},"Castellum Blariacum":{naam:"Blariacum",latinNaam:"Blariacum",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van het Romeinse castellum Blariacum bij Blerick (nu deel van Venlo). De naam leeft voort in de plaatsnaam. Het fort zou de Maasovergang hebben bewaakt op de route tussen Xanten en Maastricht. De exacte locatie is nooit definitief vastgesteld ondanks vele opgravingspogingen. Vondsten in de omgeving wijzen wel op Romeinse militaire aanwezigheid: militaria, munten, aardewerk. Het Limburgs Museum in Venlo toont de Romeinse geschiedenis van de regio.",watWasHier:"Vermoedelijk castellum bij Maasovergang. Exacte locatie onzeker.",watTeZien:"Locatie niet vastgesteld. Limburgs Museum Venlo.",verwachteVondsten:"Militaria, munten, aardewerk als aanwijzingen voor fortlocatie.",betekenis:"Plaatsnaam Blerick afgeleid van Blariacum. Schakel in Maasroute.",bronnen:[]},"Fortificatie Bodegraven":{naam:"Wachtpost Bodegraven",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Waarschijnlijke Romeinse wachtpost bij Bodegraven aan de Oude Rijn. Onderdeel van het signaleringssysteem tussen de grotere forten zoals Nigrum Pullum en Laurum. De wachttorens stonden om de paar kilometer en konden met vuur- of rooksignalen waarschuwingen doorgeven. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend. Bij graafwerkzaamheden in Bodegraven zijn wel Romeinse scherven gevonden die op aanwezigheid wijzen.",watWasHier:"Kleine wachtpost voor signalering. 4-8 soldaten.",watTeZien:"Exacte locatie onbekend.",verwachteVondsten:"Aardewerk, kleine hoeveelheden militaria.",betekenis:"Onderdeel communicatiesysteem langs de Limes.",bronnen:[]},Caestert:{naam:"Caestert",type:"versterking",periode:"1e eeuw v.Chr.",beschrijving:"Mogelijk de locatie waar de Eburonen onder leiding van Ambiorix in 54 v.Chr. een Romeins legioen vernietigden - de zwaarste Romeinse nederlaag in de Lage Landen. Het plateau van Caestert bij Kanne (Belgisch Limburg) had een oppidum (versterkte nederzetting). Julius Caesar beschrijft de slag in zijn Gallische Oorlogen. De locatie is omstreden, maar Caestert is een sterke kandidaat. Symbolisch belangrijke plek voor de Belgische geschiedenis. De site is nu natuurgebied met grotten.",watWasHier:"Mogelijk slagveld Ambiorix-opstand 54 v.Chr. Oppidum (versterking).",watTeZien:"Plateau Caestert, natuurgebied met grotten.",verwachteVondsten:"Keltische en vroeg-Romeinse voorwerpen, mogelijk slagveldvondsten.",betekenis:"Mogelijke locatie grootste Romeinse nederlaag in de regio.",bronnen:[]},"Castellum Driel?":{naam:"Castellum Driel",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:'Mogelijke locatie van een Romeins castellum bij Driel in de Betuwe. Het bestaan en de exacte locatie zijn onzeker, vandaar het vraagteken. De Betuwe (Insula Batavorum - "Eiland der Bataven") was kerngebied van de Bataven, bondgenoten van Rome. Zij leverden beroemde hulptroepen aan het Romeinse leger. Een fort hier zou logisch zijn om het gebied te controleren. Vondsten in de omgeving wijzen op Romeinse aanwezigheid. Museum Het Valkhof Nijmegen toont de Bataafse cultuur.',watWasHier:"Mogelijk castellum in Bataafs kerngebied. Bestaan onzeker.",watTeZien:"Geen zichtbare resten. Museum Het Valkhof.",verwachteVondsten:"Romeinse en Bataafse voorwerpen indien locatie juist.",betekenis:"Zou Romeinse controle over Bataafs gebied tonen.",bronnen:[]},"Castellum Duiven - Loowaard":{naam:"Duiven-Loowaard",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Duiven/Loowaard aan de Rijn, in de uiterwaarden tussen Arnhem en Zevenaar. Het fort bewaakte de rivierroute en de overgang naar het Bataafse gebied. De dynamische rivier heeft veel resten weggespoeld of diep begraven. Bij lage waterstanden en na erosie komen soms vondsten aan oppervlakte: munten, militaria, aardewerk. Het gebied is nu natuurgebied met grazende grote grazers. Museum Arnhem en Het Valkhof Nijmegen tonen vondsten uit de regio.",watWasHier:"Castellum aan de Rijn in uiterwaarden. Bewaakte rivierovergang.",watTeZien:"Natuurgebied. Na erosie mogelijk vondsten aan oppervlakte.",verwachteVondsten:"Militaria, munten, aardewerk na erosie of bij laag water.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},"Castellum Grinnes":{naam:"Grinnes",latinNaam:"Grinnes",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Rossum in de gemeente Maasdriel - waarschijnlijk het antieke Grinnes vermeld op de Peutingerkaart. Het fort lag aan de Waal en controleerde de rivierroute. Bij opgravingen zijn resten van het fort gevonden. De omgeving is rijk aan Romeinse vondsten: militaria, munten, aardewerk, bouwmateriaal. Het Museum voor de Bommelerwaard in Ammerzoden toont lokale vondsten. De naam Grinnes leeft niet voort in moderne plaatsnamen.",watWasHier:"Castellum aan de Waal. Vermeld op Peutingerkaart.",watTeZien:"Locatie opgegraven. Museum Bommelerwaard.",verwachteVondsten:"Militaria, munten, aardewerk, bouwmateriaal.",betekenis:"Verbinding antieke bronnen met archeologische locatie.",bronnen:[]},"Wachttoren Heumen":{naam:"Wachttoren Heumen",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren bij Heumen ten zuiden van Nijmegen. Onderdeel van het signaleringssysteem langs de Maas en verbindingswegen. De torens stonden op strategische punten met goed uitzicht. Bij nadering van vijanden werden signalen gegeven naar de grotere forten. Kleine bezetting van 4-8 soldaten die in de toren woonden. De exacte locatie is archeologisch vastgesteld. Vondsten: militaria, aardewerk, persoonlijke bezittingen.",watWasHier:"Signaleertoren met klein garnizoen. Uitzichtpunt.",watTeZien:"Locatie bekend maar geen zichtbare resten.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Onderdeel communicatienetwerk Romeins leger.",bronnen:[]},"Castellum Huissen?":{naam:"Castellum Huissen",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Huissen aan de Rijn. Het bestaan is niet zeker vastgesteld, vandaar het vraagteken. Huissen ligt op een logische plek tussen de bekende forten bij Arnhem en Zevenaar. Vondsten in de omgeving wijzen op Romeinse activiteit. De moderne bebouwing maakt onderzoek lastig. Als er een fort was, bewaakte het de rivierroute en mogelijk een oversteekplaats.",watWasHier:"Mogelijk castellum aan de Rijn. Bestaan onzeker.",watTeZien:"Geen resten zichtbaar. Gebied bebouwd.",verwachteVondsten:"Romeinse vondsten die fortaanwezigheid zouden bevestigen.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Castellum Kessel-Lith":{naam:"Kessel-Lith",type:"castellum",periode:"3e - 4e eeuw n.Chr.",beschrijving:"Laat-Romeins castellum uit de 3e-4e eeuw bij Kessel-Lith aan de Maas. Gebouwd in een periode van Germaanse invallen toen de oude Limes niet meer te handhaven was. Dit type forten was compacter en zwaarder versterkt dan de vroege castella. De locatie bij een rivierovergang bleef strategisch. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Het fort toont de veranderde militaire strategie van het late Romeinse Rijk.",watWasHier:"Laat-Romeins fort, compacter en zwaarder versterkt.",watTeZien:"Locatie bekend, weinig zichtbaar.",verwachteVondsten:"Laat-Romeinse munten, gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont Romeinse aanpassing aan nieuwe dreigingen.",bronnen:[]},Carvo:{naam:"Carvo",latinNaam:"Carvo",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke Romeinse versterking nabij Kesteren in de Betuwe. De naam komt voor op de Peutingerkaart. Kesteren lag in het hart van het Bataafse stamgebied. De Bataven waren belangrijke bondgenoten van Rome en leverden beroemde cavalerie-eenheden. Een versterking hier zou zowel bescherming als controle bieden. De exacte locatie is niet vastgesteld. Vondsten in de regio tonen intensief Romeins-Bataafs contact: import-aardewerk, wapens, paardentuig.",watWasHier:"Vermoedelijke versterking in Bataafs kerngebied.",watTeZien:"Locatie onbekend.",verwachteVondsten:"Gemengd Romeins-Bataafse voorwerpen, paardentuig.",betekenis:"Zou Romeinse aanwezigheid in Bataafs gebied tonen.",bronnen:[]},Mannaricium:{naam:"Mannaricium",latinNaam:"Mannaricium",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Vermoedelijke locatie van het Romeinse castellum Mannaricium bij Maurik aan de Rijn. De naam komt voor op de Peutingerkaart. Het fort zou de rivierroute hebben bewaakt tussen Levefanum (Wijk bij Duurstede) en forten stroomopwaarts. De moderne plaats Maurik zou afgeleid kunnen zijn van Mannaricium. Bij bouwwerkzaamheden zijn Romeinse vondsten gedaan die op een fort wijzen. De exacte contouren zijn niet bekend.",watWasHier:"Vermoedelijk castellum aan de Rijn. Vermeld op Peutingerkaart.",watTeZien:"Geen zichtbare resten. Gebied bebouwd.",verwachteVondsten:"Militaria, aardewerk, munten bij bouwwerkzaamheden.",betekenis:"Mogelijke herkomst plaatsnaam Maurik.",bronnen:[]},Oostvoorne:{naam:"Castellum Oostvoorne",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de monding van de Waal en Maas, nu verdwenen in zee door kustafslag. Het fort bewaakte de zeeroute en beschermde tegen piraterij. De kust lag in de Romeinse tijd kilometers verder westwaarts. Door zeespiegelstijging en erosie is het fort in de golven verdwenen. Na stormen spoelen soms vondsten aan op de stranden van Voorne-Putten: munten, aardewerk, metalen voorwerpen. De Brittenburg bij Katwijk was een soortgelijk lot beschoren.",watWasHier:"Kustfort bij riviermonding. Bewaking zeeroute.",watTeZien:"Fort verdwenen in zee. Soms strandvondsten na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen op strand.",betekenis:"Toont voormalige kustlijn en Romeinse kustverdediging.",bronnen:[]},"Castellum Randwijk":{naam:"Castellum Randwijk",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Randwijk aan de Rijn in de Betuwe. Het bestaan en de exacte locatie zijn onzeker. De rivier heeft veel oude resten weggespoeld. Randwijk ligt tussen bekende fortlocaties wat een fort hier logisch zou maken. In de uiterwaarden zijn bij erosie Romeinse vondsten gedaan. Het dynamische rivierlandschap maakt onderzoek lastig maar kan ook vondsten blootleggen na hoog water.",watWasHier:"Mogelijk castellum. Bestaan en locatie onzeker.",watTeZien:"Geen zichtbare resten. Uiterwaarden.",verwachteVondsten:"Mogelijk vondsten na erosie of hoog water.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Versterking Scheveningseweg":{naam:"Minifort Scheveningseweg",type:"minifort",periode:"2e eeuw n.Chr.",beschrijving:"Vermoede locatie van een klein Romeins kustfort bij de Scheveningseweg in Den Haag, vergelijkbaar met het nabije Minifort Ockenburg. Dit type miniforten bewaakte de kust tegen piraten en Germaanse raids over zee. Ruimte voor 20-30 soldaten. De exacte locatie is niet vastgesteld maar vondsten in de omgeving suggereren Romeinse militaire aanwezigheid. Het zou aantonen dat de gehele Noordzeekust werd bewaakt, niet alleen de riviermonding.",watWasHier:"Vermoedelijk klein kustfort zoals Ockenburg. 20-30 soldaten.",watTeZien:"Locatie niet vastgesteld.",verwachteVondsten:"Militaria, aardewerk 2e eeuw indien locatie gevonden.",betekenis:"Zou Romeinse kustverdediging Den Haag bevestigen.",bronnen:[]},"Tongeren - Sacramentstraat":{naam:"Atuatuca Tungrorum",latinNaam:"Atuatuca Tungrorum / Municipium Tungrorum",type:"legerkamp",periode:"ca. 10 v.Chr. - 400 n.Chr.",beschrijving:"Oudste stad van Belgi, gesticht ca. 10 v.Chr. Hoofdstad van de Civitas Tungrorum - met 150 hectare de grootste civitas van Noordwest-Europa! Strategisch gelegen op de weg Boulogne-Bavay-Keulen. Onder keizer Trajanus (2e eeuw) ommuurd met meer dan 4,5 km muren en tot 3 grachten - waarvan nog 1,5 km staat! Een 1e-eeuwse buste van Julius Caesar is een topstuk. Het Gallo-Romeins Museum (Europees Museum van het Jaar 2011) toont een schat aan vondsten: beelden, steles, sieraden, architectuurelementen. Ook de Romeinse muren, het tempelcomplex, het aquaduct van Beukenberg en tumuli zijn te bezoeken.",watWasHier:"Civitas-hoofdstad Tungri (150 ha). 4,5 km stadsmuur. Politiek en religieus centrum.",watTeZien:"Gallo-Romeins Museum. Romeinse muren (1,5 km). Tempelcomplex. Aquaduct Beukenberg. Tumuli.",verwachteVondsten:"Stadsaardewerk, bouwmateriaal, munten, inscripties, religieuze objecten.",betekenis:"Oudste stad van Belgi. Grootste civitas van Noordwest-Europa.",bronnen:["https://www.galloromeinsmuseum.be","https://www.canonvanvlaanderen.be/en/events/tongeren-a-roman-town/"]},"Valkenburg-Marktveld, mini-castellum":{naam:"Marktveld Valkenburg",type:"minifort",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Klein Romeins castellum met wachttoren bij het Marktveld in Valkenburg (Zuid-Holland), nabij het grotere Praetorium Agrippinae. Dit type miniforten vulde de ruimtes tussen de grote castella op. Wachttoren voor signalering en kleine bezetting voor patrouilles. De combinatie van toren en klein fort was effectief voor grensbewaking. Bij opgravingen zijn de contouren vastgesteld. Vondsten in Archeologisch Steunpunt Valkenburg.",watWasHier:"Klein fort met wachttoren. Aanvulling op Praetorium Agrippinae.",watTeZien:"Archeologisch Steunpunt Valkenburg.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Toont gelaagdheid Romeinse grensverdediging.",bronnen:[]},"Wachttoren a":{naam:"Wachttoren Utrecht-West",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Een van meerdere Romeinse wachttorens in de omgeving van Utrecht, onderdeel van het signaleringssysteem langs de Limes. De torens stonden om de 1-2 kilometer met zicht op elkaar. Bij nadering van vijanden werden vuur- of rooksignalen gegeven. Binnen minuten kon de hele grens gewaarschuwd zijn. Kleine houten constructie op aarden verhoging met bezetting van 4-8 soldaten. Vondsten zijn schaars door de kleine schaal.",watWasHier:"Houten signaleertoren. 4-8 soldaten.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Kleine hoeveelheden aardewerk en militaria.",betekenis:"Onderdeel vroegwaarschuwingssysteem.",bronnen:[]},"Wachttoren b":{naam:"Wachttoren Utrecht-Oost",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren ten oosten van Utrecht, onderdeel van de keten signaleertorens langs de Rijn. Elke toren had zichtlijn naar de volgende. Dit systeem maakte snelle communicatie mogelijk in een tijd zonder telegraaf of telefoon. De soldaten woonden in of bij de toren en hielden permanent wacht. Bij gevaar werden brandende fakkels of rookpotten gebruikt. De locatie is archeologisch vastgesteld maar niet zichtbaar.",watWasHier:"Signaleertoren in torenketen. Permanente wacht.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, militaria, persoonlijke bezittingen.",betekenis:"Onderdeel communicatienetwerk Limes.",bronnen:[]},"Wachttoren c":{naam:"Wachttoren Hoge Woerd",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren nabij Castellum Op de Hoge Woerd, onderdeel van het signaleringssysteem. Torens bij forten dienden als vooruitgeschoven posten en waarschuwingsplaatsen. De combinatie van fort met omringende torens was de standaard Romeinse grensverdediging. Het Archeologisch Park Hoge Woerd geeft een goed beeld van hoe dit systeem functioneerde. De toren zelf is niet gereconstrueerd maar de context is te begrijpen.",watWasHier:"Signaleertoren bij castellum. Vooruitgeschoven post.",watTeZien:"Archeologisch Park Hoge Woerd toont context.",verwachteVondsten:"Aardewerk, militaria.",betekenis:"Toont samenhang fort en torens.",bronnen:[]},"Zwammerdam-Rijksstraatweg":{naam:"Zwammerdam-Rijksstraatweg",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke militaire nederzetting aan de Rijksstraatweg in Zwammerdam, naast het bekende Nigrum Pullum fort. Mogelijk een vicus (burgerdorp) of aparte militaire faciliteit. Bij Zwammerdam werden de beroemde Romeinse schepen gevonden. De hele zone langs de Oude Rijn was dicht bezet met militaire en civiele structuren. Vondsten wijzen op intensieve Romeinse activiteit: aardewerk, munten, militaria en door de natte veenbodem ook organisch materiaal.",watWasHier:"Mogelijk vicus of militaire faciliteit nabij Nigrum Pullum.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, munten, militaria, organisch materiaal.",betekenis:"Toont dichtheid Romeinse bewoning langs Oude Rijn.",bronnen:[]},"Kastell Aachen":{naam:"Aquae Granni",latinNaam:"Aquae Granni",type:"versterking",periode:"1e - 4e eeuw n.Chr.",beschrijving:'Romeinse kuuroord bij de hete bronnen (tot 75C!) gewijd aan Apollo en de Keltische geneesheer Grannos - "aan de wateren van Grannos". In de 1e eeuw uitgebouwd tot kurort voor de legioenen van Neder-Germani. Onder keizer Trajanus bouwden legioenen uit Xanten een aquaduct en thermen onder de huidige Dom. De Mnsterthermen hadden de indeling van een valetudinarium (Romeins hospitaal). Karel de Grote bouwde hier zijn Pfalz (793-813) en maakte Aken tot keizerlijke residentie - bewust als "vernieuwer van het Romeinse Rijk". De Dom (UNESCO 1978, eerste in Duitsland!) staat op Romeinse fundamenten. Karel stierf hier in 814.',watWasHier:"Kurort voor legioenen. Thermen. Later keizerlijke Pfalz van Karel de Grote.",watTeZien:"Dom (UNESCO). Centre Charlemagne. Thermen onder de stad.",verwachteVondsten:"Badhuisresten, inscripties, munten, Romeins en Karolingisch bouwmateriaal.",betekenis:"Ononderbroken bewoning van Romeinse tijd tot Karel de Grote. Eerste UNESCO-site Duitsland.",bronnen:["https://centre-charlemagne.eu/zeitreise/?lang=en","http://www.aquaegranni.de/","https://de.wikipedia.org/wiki/Aquae_Granni"]},Hazerswoude:{naam:"Hazerswoude-Rijndijk",type:"wachttoren",periode:"2e - 3e eeuw n.Chr.",beschrijving:"Bevestigde Romeinse wachtpost langs de Limesweg bij Hazerswoude-Rijndijk. Bij opgravingen in 2021-2023 door Vestigia BV en het Rijksmuseum van Oudheden zijn spectaculaire vondsten gedaan: resten van de houten Limesweg (eiken palen uit 124-125 n.Chr.), een Romeinse dam, en aanwijzingen voor een kleine wachtpost. Bijzondere vondsten: de eerste Romeinse mijlpaal in Nederland (2023), een muntschat met 22 zilveren munten (na 166 n.Chr.), aardewerk, mantelspelden, leren schoenzolen en ca. 40.000-50.000 objecten. De locatie ligt precies tussen Albaniana (Alphen) en Matilo (Leiden).",watWasHier:"Wachtpost langs de Limesweg. Houten wegdek uit 124-125 n.Chr.",watTeZien:"Opgravingen afgerond. Vondsten naar Rijksmuseum van Oudheden.",verwachteVondsten:"Militaria, munten, aardewerk. Gebied grotendeels onderzocht.",betekenis:"Eerste Romeinse mijlpaal in Nederland. Bevestigt trac Limesweg.",bronnen:["https://www.rmo.nl/onderzoek/opgravingsprojecten/hazerswoude/","https://www.vestigia.nl/opgraving-hazerswoude-in-samenwerking-met-het-rijksmuseum-van-oudheden-en-de-gemeente-alphen-aan-den-rijn/","https://romeinsalphen.nl/themas/romeinse-weg-hazerswoude-rijndijk"]},Albaniana:{naam:"Albaniana",latinNaam:"Albaniana",type:"castellum",periode:"41 - 275 n.Chr.",beschrijving:"Groot Romeins castellum bij Alphen aan den Rijn, een van de belangrijkste forten aan de Nederlandse Limes. Het fort werd gesticht in 41-42 n.Chr., kort na de dood van keizer Caligula. De locatie is nauwkeurig bekend: bij het Rijnplein en Theater Castellum aan de Castellumstraat. Het fort (80x120m) was beschermd door een omgrachte aarden wal. Bij opgravingen tussen 1950 en 2002 zijn uitgebreide resten gevonden. Door de natte bodem zijn veel houten structuren bewaard gebleven. Een bronzen maquette van het castellum staat op het Rijnplein.",watWasHier:"Castellum met vicus. Locatie bekend: Rijnplein/Castellumstraat.",watTeZien:"Bronzen maquette Rijnplein. Theater Castellum op fortlocatie. Archeon.",verwachteVondsten:"Munten, militaria, aardewerk, dakpannen, fibulae. Veel bij bouwwerkzaamheden.",betekenis:"Een van de hoofdforten aan de Limes. UNESCO Werelderfgoed.",bronnen:["https://www.hierisalphen.nl/home/ontdekken/romeinse-limes","https://www.romeinen.nl/weten/nederland-in-de-romeinse-tijd/zuid-holland/alphen-aan-den-rijn","https://archeologiehuiszuidholland.nl/zien-en-doen/het-archeologiehuis/fort-aan-de-rijn"]}},bSe={naam:"Romeins fort",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse militaire versterking langs de Limes, de noordgrens van het Romeinse Rijk. Forten lagen om de 10-15 km langs de Rijn. Garnizoen van hulptroepen (auxilia) die de grens bewaakten tegen Germaanse invallen. Standaard rechthoekige plattegrond met houten of stenen muur, gracht, poorten en binnengebouwen (barakken, commandopost, graanopslagplaats, werkplaatsen). Buiten de muren vaak een vicus (burgerdorp) met handelaren en soldatenfamilies. Vondsten: munten, fibulae (mantelspelden), aardewerk, wapens, gereedschap. Onderdeel van UNESCO Werelderfgoed sinds 2021."},RSe={castellum:"Castellum (legerplaats)",wachttoren:"Wachttoren (signaalpost)",vlootbasis:"Vlootbasis (haven)",legerkamp:"Legerkamp (castra)",minifort:"Minifort (wachtpost)",versterking:"Versterking",villa:"Villa (militair gebruikt)"};Sn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");function ASe(n){if(!n)return n;const e={Mo:"ma",Tu:"di",We:"wo",Th:"do",Fr:"vr",Sa:"za",Su:"zo",Mon:"ma",Tue:"di",Wed:"wo",Thu:"do",Fri:"vr",Sat:"za",Sun:"zo",PH:"feestdagen",SH:"schoolvakantie"};let t=n;return Object.entries(e).forEach(([r,i])=>{t=t.replace(new RegExp(`\\b${r}\\b`,"gi"),i)}),t=t.replace(/\boff\b/gi,"gesloten").replace(/\bclosed\b/gi,"gesloten").replace(/\bopen\b/gi,"open"),t}async function kSe(n){try{const e=En(n),t=Sn("EPSG:4326","EPSG:28992",e);if(t[0]<7e3||t[0]>3e5||t[1]<289e3||t[1]>629e3)return null;const r=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${t[0]-r},${t[1]-r},${t[0]+r},${t[1]+r}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,o=await(await fetch(s)).json();if(o.features&&o.features.length>0){const l=o.features[0].properties,c=l?.value_list??l?.GRAY_INDEX??l?.value??l?.gray_index;if(c!=null){const h=typeof c=="number"?c:parseFloat(c);if(!isNaN(h))return h}}}catch(e){console.warn("AHN height query failed:",e)}return null}const ISe={ABG:"Alphen-Chaam",ACM:"Alkmaar",ALF:"Alfen",ALK:"Alkemade",AML:"Ameland",AMR:"Amerongen",AMS:"Amsterdam",ANL:"Anloo",APD:"Apeldoorn",ARN:"Arnhem",ASN:"Assen",AVW:"Avenhorn",BDA:"Breda",BLK:"Blokker",BRN:"Barneveld",DEL:"Delft",DHG:"Den Haag",DRD:"Dordrecht",EHV:"Eindhoven",EMN:"Emmen",EPE:"Epe",GNP:"Gennep",GRN:"Groningen",GRV:"Grave",GTB:"Giethoorn",HDK:"Harderwijk",HLM:"Haarlem",HLN:"Heiloo",HRL:"Harlingen",HTN:"Houten",LDN:"Leiden",LWR:"Leeuwarden",MST:"Maastricht",NKK:"Nijkerk",NMG:"Nijmegen",OTM:"Ootmarsum",RTD:"Rotterdam",SND:"Sneek",TBG:"Tilburg",UTR:"Utrecht",VLO:"Venlo",WGN:"Wageningen",ZWL:"Zwolle",ZTP:"Zutphen",444:"Houten",811:"Gouda",310:"Utrecht",344:"Amsterdam",363:"Rotterdam",518:"Den Haag",758:"Eindhoven",772:"Tilburg",855:"Breda",85:"Arnhem",268:"Nijmegen",14:"Groningen",80:"Leeuwarden",995:"Maastricht",106:"Enschede",153:"Zwolle",34:"Almere"},CSe={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function H5(n,e){const t=[],r=n.toLowerCase(),i=(e||"").toLowerCase();return r.includes("kalkhoudend")||i.endsWith("a")?t.push("Kalkhoudend = goede metaalconservering"):(r.includes("kalkarm")||r.includes("kalkloos"))&&t.push("Kalkarm = meer corrosie op metalen"),r.includes("poldervaag")?t.push("Poldervaaggrond = jonge rivierklei, ingepolderd gebied"):r.includes("enkeerdgrond")||r.includes("enk")?t.push("Enkeerdgrond = oude akkers met plaggenbemesting - archeologisch interessant!"):r.includes("podzol")?t.push("Podzolgrond = uitgeloogde zandgrond, vaak zuur"):(r.includes("veengrond")||r.includes("veen"))&&t.push("Veengrond = zuur, slechte metaalconservering (tenzij waterverzadigd)"),r.includes("zware klei")?t.push("Zware klei = moeilijk graven, goede conservering"):r.includes("lichte klei")||r.includes("zavel")?t.push("Zavel/lichte klei = redelijk te graven"):r.includes("zand")&&!r.includes("zavel")&&t.push("Zandgrond = makkelijk graven"),r.includes("rivierklei")||i.startsWith("r")?t.push("Rivierafzetting"):(r.includes("zeeklei")||i.startsWith("m"))&&t.push("Zeekleiafzetting"),t}function PSe(){const n=pi(_t=>_t.map),e=ll(_t=>_t.removeVondst),t=ll(_t=>_t.updateVondst),r=ll(_t=>_t.vondsten),{layers:i,addPoint:s,addLayer:a}=us(),[o,l]=X.useState([]),[c,h]=X.useState(0),[g,m]=X.useState(!1),[y,v]=X.useState(null),[_,E]=X.useState(!1),[T,b]=X.useState(!1),[R,N]=X.useState(null),[D,W]=X.useState(null),[I,A]=X.useState(null),[M,O]=X.useState(null),[L,z]=X.useState(!1),[j,Ee]=X.useState(null),[Ce,Ge]=X.useState(null),[Le,ce]=X.useState(null),[Me,Te]=X.useState(!1),[ie,V]=X.useState(""),[Z,te]=X.useState([]),se=Z[c]||null,[he,Ae]=X.useState(()=>{const _t=localStorage.getItem("popupTextScale");return _t?parseInt(_t):100}),[Fe,de]=X.useState("half"),Pe=_t=>{Ae(_t),localStorage.setItem("popupTextScale",_t.toString())},Be=o[c]||"",It=o.length>1,Wt=_t=>{const pn=_t.match(/<strong[^>]*>(.*?)<\/strong>/);if(pn){const bn=pn[1].replace(/<[^>]+>/g,""),Et=_t.replace(pn[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:bn,contentWithoutTitle:Et}}return{title:"",contentWithoutTitle:_t}},Dt=_t=>_t.replace(/class="([^"]*)"/g,(bn,Et)=>{if(Et.includes("text-xs")){const sn=Et.replace(/\btext-xs\b/g,"").trim();return sn?`style="font-size:0.857em" class="${sn}"`:'style="font-size:0.857em"'}if(Et.includes("text-sm")){const sn=Et.replace(/\btext-sm\b/g,"").trim();return sn?`class="${sn}"`:""}return bn}).replace(/class=""/g,""),{title:Zt,contentWithoutTitle:rn}=Wt(Be),ht=Dt(rn),rr=Be.includes("Landbouwperceel"),hn=Be.includes("data-vondst-id="),cn=()=>{h(_t=>(_t-1+o.length)%o.length)},ir=()=>{h(_t=>(_t+1)%o.length)},Pi=async()=>{if(console.log(" HOOGTEKAART KNOP GEKLIKT"),console.log(" parcelCoordinate uit state:",y),!n||!y||T){console.log(" STOP - map:",!!n,"coord:",y,"loading:",T);return}console.log(` DOORGEVEN AAN showParcelHeightMap: [${y[0]}, ${y[1]}]`),b(!0);try{await Lye(n,y)&&E(!0)}catch(_t){console.error("Failed to load height map:",_t)}finally{b(!1)}},jn=()=>{n&&(LR(n),E(!1))};X.useEffect(()=>{if(!n)return;const _t=Et=>{let sn='<strong class="text-purple-800">AMK Monument</strong>';if(Et.toponiem&&(sn+=`<br/><span class="text-sm font-semibold">${Et.toponiem}</span>`),Et.kwaliteitswaarde&&(sn+=`<br/><span class="text-sm text-purple-700">${Et.kwaliteitswaarde}</span>`),Et.omschrijving&&(sn+=`<br/><span class="text-xs text-gray-600 mt-1 block">${Et.omschrijving}</span>`),Et.txt_label){const Nt=Et.txt_label.split(", ").slice(0,3).join(", ");sn+=`<br/><span class="text-xs text-gray-500 italic">${Nt}${Et.txt_label.split(", ").length>3?"...":""}</span>`}return sn},pn=async(Et,sn)=>{const Nt=[],Xi=n.getLayers().getArray().filter(Mr=>Mr instanceof Sh&&Mr.getVisible()?Mr.getSource()instanceof wX:!1);for(const Mr of Xi){const oi=Mr.getSource();if(!oi)continue;const tn=Mr.get("title")||"";if(tn.startsWith("Paleokaart"))continue;if(tn==="Archeo Landschappen"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=100,P=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties,ee=re.landschapsnaam||re.naam||"Archeologisch Landschap",ne=re.omschrijving||"";let ue=`<strong class="text-green-800">${ee}</strong>`;ne&&(ue+=`<br/><span class="text-sm text-gray-600">${ne}</span>`),ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ue+='<div class="text-sm text-gray-700 mt-1">Een archeologisch landschap is een gebied waar het landschap nog sporen draagt van menselijke activiteit uit het verleden. Denk aan oude akkers, nederzettingen of verdedigingswerken.</div>',ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ue+='<div class="text-sm text-gray-700 mt-1">Aardewerk, munten, gereedschap en andere voorwerpen van vroegere bewoners. De kans op vondsten hangt af van het type landschap.</div>',ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',ue+='<div class="text-sm text-gray-700 mt-1"><a href="https://www.cultureelerfgoed.nl/onderwerpen/bronnen-en-kaarten/overzicht/landschappenkaart" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Landschappenkaart</a></div>',ue+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Landschapstypen_van_Nederland" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Landschapstypen</a></div>',Nt.push(ue)}}catch(je){console.warn("Archeo Landschappen WMS query failed:",je)}continue}if(tn==="Essen"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=100,P=`https://services.rce.geovoorziening.nl/landschapsatlas/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=essen&QUERY_LAYERS=essen&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties;let ee='<strong class="text-amber-800">Es (historisch akkercomplex)</strong>';(re.naam||re.Naam||re.NAME)&&(ee+=`<br/><span class="text-sm font-semibold text-amber-700">${re.naam||re.Naam||re.NAME}</span>`),(re.type||re.Type||re.TYPE)&&(ee+=`<br/><span class="text-xs text-gray-600">${re.type||re.Type||re.TYPE}</span>`),(re.omschrijving||re.Omschrijving)&&(ee+=`<br/><span class="text-xs text-gray-500">${re.omschrijving||re.Omschrijving}</span>`),ee+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is een es?</span></div>',ee+='<div class="text-sm text-gray-700 mt-1">Een es is een oud akkercomplex op hogere zandgronden. Eeuwenlang werden hier gewassen verbouwd. De bodem werd bemest met plaggen en mest, waardoor de grond donker en vruchtbaar werd.</div>',ee+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ee+='<div class="text-sm text-gray-700 mt-1">Munten, gespen, knopen, aardewerk en soms bijzondere voorwerpen die door bemesting op het land terechtkwamen. Essen behoren tot de beste vindplaatsen voor metaaldetectie.</div>',ee+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Conservering</span></div>',ee+='<div class="text-sm text-gray-700 mt-1 italic">De zure zandgrond tast metaal aan. IJzer en koper zijn vaak slecht bewaard. Zilver en brons houden zich beter.</div>',ee+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',ee+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Es_(geografie)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Es (geografie)</a></div>',Nt.push(ee)}}catch(je){console.warn("Essen WMS query failed:",je)}continue}if(tn==="FAMKE Steentijd"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=`https://geoportaal.fryslan.nl/arcgis/rest/services/Themas/cultuurhistorie/MapServer/2/query?geometry=${ye[0]},${ye[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=BESCHR,BESCHRTOELICHTING,BESCHRLINK&returnGeometry=false&f=json`,P=await(await fetch(xe)).json();if(P.features&&P.features.length>0){const ct=P.features[0].attributes;let U='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';U+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart</span>';const re=ct.BESCHR||"";re&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Advies</span></div>',U+=`<div class="text-sm text-amber-700 mt-1 font-medium">${re}</div>`);const ee=ct.BESCHRTOELICHTING||"";ee&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Toelichting</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${ee}</div>`);const ne=ct.BESCHRLINK||"";ne&&(U+=`<div class="mt-3"><a href="${ne}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:underline">Meer informatie</a></div>`),U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',U+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de steentijd en bronstijd te verwachten zijn.</div>',Nt.push(U)}}catch(je){console.warn("FAMKE Steentijd query failed:",je)}continue}if(tn==="FAMKE IJzertijd"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=`https://geoportaal.fryslan.nl/arcgis/rest/services/Themas/cultuurhistorie/MapServer/1/query?geometry=${ye[0]},${ye[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=BESCHR,BESCHRTOELICHTING,BESCHRLINK&returnGeometry=false&f=json`,P=await(await fetch(xe)).json();if(P.features&&P.features.length>0){const ct=P.features[0].attributes;let U='<strong class="text-orange-800">FAMKE IJzertijd-Middeleeuwen</strong>';U+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart</span>';const re=ct.BESCHR||"";re&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Advies</span></div>',U+=`<div class="text-sm text-orange-700 mt-1 font-medium">${re}</div>`);const ee=ct.BESCHRTOELICHTING||"";ee&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Toelichting</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${ee}</div>`);const ne=ct.BESCHRLINK||"";ne&&(U+=`<div class="mt-3"><a href="${ne}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:underline">Meer informatie</a></div>`),U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',U+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de ijzertijd tot en met de middeleeuwen te verwachten zijn.</div>',Nt.push(U)}}catch(je){console.warn("FAMKE IJzertijd query failed:",je)}continue}if(tn==="Archeo Onderzoeken"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=100,P=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}&FEATURE_COUNT=20`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0)for(const re of U.features){const ee=re.properties,ne=ee.type_onderzoek||"",ue=ee.projectnaam||ee.project_naam||ee.naam||"",Ie=ue&&ue!=="-"&&ue.trim()!==""&&!/^\d+$/.test(ue.trim())?ue:"",Ve=ee.gemeente||"",He=ee.uitvoerder||"",Je=ee.onderzoeksmeldingnummer||"",Qe=ee.adres||ee.straat||"";let yt="Archeologisch Onderzoek";Ie?yt=Ie:Ve&&Qe?yt=`${Ve} - ${Qe}`:Ve&&(yt=`Onderzoek ${Ve}`);let St=`<strong class="text-blue-800">${yt}</strong>`;if(ne&&(St+=`<br/><span class="text-sm font-semibold text-blue-700">${ne}</span>`),Ve&&!yt.includes(Ve)&&(St+=`<br/><span class="text-sm text-gray-700">${Ve}</span>`),Qe&&!yt.includes(Qe)&&(St+=`<br/><span class="text-sm text-gray-600">${Qe}</span>`),Je&&(St+=`<br/><span class="text-xs text-gray-500 font-mono">OM: ${Je}</span>`),He&&(St+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${He}</span>`),ee.startdatum||ee.einddatum){const Y=[ee.startdatum,ee.einddatum].filter(Boolean).join(" - ");St+=`<br/><span class="text-xs text-gray-600">Periode: ${Y}</span>`}const Rn=[];ee.periode_paleolithicum&&Rn.push("Paleolithicum"),ee.periode_mesolithicum&&Rn.push("Mesolithicum"),ee.periode_neolithicum&&Rn.push("Neolithicum"),ee.periode_bronstijd&&Rn.push("Bronstijd"),ee.periode_ijzertijd&&Rn.push("IJzertijd"),ee.periode_romeins&&Rn.push("Romeins"),ee.periode_middeleeuwen&&Rn.push("Middeleeuwen"),ee.periode_nieuwe_tijd&&Rn.push("Nieuwe tijd"),Rn.length>0&&(St+=`<br/><span class="text-sm text-purple-700">Datering: ${Rn.join(", ")}</span>`),St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',ne.toLowerCase().includes("opgraving")?St+='<div class="text-sm text-gray-700 mt-1">Hier is een archeologische opgraving gedaan. Professionele archeologen hebben vondsten en sporen gedocumenteerd en geborgen.</div>':ne.toLowerCase().includes("bureauonderzoek")?St+='<div class="text-sm text-gray-700 mt-1">Een bureauonderzoek naar de archeologische verwachting op basis van historische bronnen en kaarten.</div>':ne.toLowerCase().includes("booronderzoek")?St+='<div class="text-sm text-gray-700 mt-1">Met boringen is onderzocht wat er in de grond zit. Vaak de eerste stap om te bepalen of er verder onderzoek nodig is.</div>':ne.toLowerCase().includes("proefsleuven")?St+='<div class="text-sm text-gray-700 mt-1">Proefsleuven zijn gegraven om te kijken of er archeologische sporen in de grond zitten.</div>':ne.toLowerCase().includes("begeleiding")?St+='<div class="text-sm text-gray-700 mt-1">Archeologische begeleiding bij graafwerk. Een archeoloog was aanwezig om te controleren of er vondsten naar boven kwamen.</div>':ne.toLowerCase().includes("inventariserend")||ne.toLowerCase().includes("karterend")?St+='<div class="text-sm text-gray-700 mt-1">Verkennend onderzoek om te bepalen of er archeologische resten in de grond kunnen zitten.</div>':St+='<div class="text-sm text-gray-700 mt-1">Op deze locatie is archeologisch onderzoek uitgevoerd. De resultaten zijn opgeslagen in het landelijke archief.</div>',St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Interessant voor detectie?</span></div>',St+='<div class="text-sm text-gray-700 mt-1 italic">Onderzoekslocaties kunnen interessant zijn: archeologen vinden vaak niet alles. Maar check altijd eerst of je daar mag zoeken.</div>',St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Rapport opzoeken</span></div>';let B="";if(Ie?B=Ie:He&&Ve?B=`${He} ${Ve}`:Ve&&(B=Ve),B){const Y=B.length>35?B.substring(0,35)+"...":B;St+=`<div class="text-sm text-gray-700 mt-1"><a href="https://archaeology.datastations.nl/dataverse/root?q=${encodeURIComponent(B)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek "${Y}" in DANS</a></div>`,St+=`<div class="text-sm text-gray-700 mt-1"><a href="https://scholar.google.nl/scholar?q=${encodeURIComponent(B+" archeologisch rapport")}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek in Google Scholar</a></div>`}Je&&(St+=`<div class="text-sm text-gray-700 mt-1"><a href="https://archis.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek OM ${Je} in ARCHIS</a> <span class="text-xs text-gray-400">(account nodig)</span></div>`),Nt.push(St)}}catch(je){console.warn("Archeo Onderzoeken WMS query failed:",je)}continue}if(tn==="IKAW"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=500,P=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties,ee=Math.round(re.PALETTE_INDEX||re.palette_index||0),ne=CSe[ee]||`Trefkans onbekend (${ee})`;let ue='<strong class="text-orange-800">IKAW Verwachtingskaart</strong>';ue+='<br/><span class="text-sm text-gray-500">Kaart met kansen op archeologische vondsten</span>',ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',ue+=`<div class="text-sm text-orange-700 mt-1">${ne}</div>`;const Ve={1:{tekst:"De kans op archeologische vondsten is hier zeer klein. De grond is waarschijnlijk verstoord of te jong.",vondsten:"Niet veel te verwachten, maar verrassingen zijn altijd mogelijk.",kleur:"text-gray-600"},2:{tekst:"De kans op vondsten is laag, maar niet uitgesloten. Soms worden hier toch interessante objecten gevonden.",vondsten:"Af en toe losse vondsten uit verschillende periodes.",kleur:"text-yellow-600"},3:{tekst:"Dit is een interessant gebied met een redelijke kans op vondsten. Hier woonden of werkten mensen in het verleden.",vondsten:"Aardewerk, munten, metalen voorwerpen uit verschillende tijdperken.",kleur:"text-amber-600"},4:{tekst:"Dit is een zeer kansrijk gebied! Hier zijn waarschijnlijk resten van oude bewoning of activiteit. Let op: bij graafwerk kan een vergunning nodig zijn.",vondsten:"Grote kans op interessante vondsten: aardewerk, munten, sieraden, gereedschap.",kleur:"text-orange-600"},5:{tekst:"Dit is een waterbodem. Vondsten zijn hier moeilijker te bereiken maar kunnen goed bewaard zijn gebleven.",vondsten:"Scheepswrakken, verloren lading, gedumpte voorwerpen.",kleur:"text-blue-600"},6:{tekst:"Waterbodem met archeologische potentie. Hier kunnen interessante vondsten liggen die door het water goed bewaard zijn.",vondsten:"Scheepsresten, ankers, aardewerk, metalen voorwerpen.",kleur:"text-blue-600"},7:{tekst:"Waterbodem met hoge archeologische waarde. Hier zijn bekende vindplaatsen of scheepswrakken.",vondsten:"Belangrijke maritieme vondsten, beschermd gebied.",kleur:"text-blue-700"}}[ee];Ve&&(ue+=`<div class="text-sm ${Ve.kleur} mt-1">${Ve.tekst}</div>`,ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ue+=`<div class="text-sm text-gray-700 mt-1">${Ve.vondsten}</div>`),ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de IKAW?</span></div>',ue+='<div class="text-sm text-gray-700 mt-1">De IKAW (Indicatieve Kaart Archeologische Waarden) toont de kans op archeologische vondsten in heel Nederland. De kaart is gemaakt door de Rijksdienst voor het Cultureel Erfgoed.</div>',Nt.push(ue)}}catch(je){console.warn("IKAW WMS query failed:",je)}continue}if(tn==="Inundatiegebieden"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=100,P=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties;let ee='<strong class="text-blue-800">Inundatiegebied</strong>';(re["linie-naam"]||re.linie_naam)&&(ee+=`<br/><span class="text-sm font-semibold text-blue-700">${re["linie-naam"]||re.linie_naam}</span>`),re.naam&&(ee+=`<br/><span class="text-sm text-gray-700">${re.naam}</span>`),re.periode&&(ee+=`<br/><span class="text-xs text-gray-500">${re.periode}</span>`),re.lin_period&&(ee+=`<br/><span class="text-xs text-gray-400">${re.lin_period}</span>`),Nt.push(ee)}}catch(je){console.warn("Inundatiegebieden WMS query failed:",je)}continue}if(tn==="Militaire Objecten"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=50,P=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties,ee=re.obj_soort||"",ne=re.obj_naam||"",ue=re.lin_period||"",Ie=re["linie-naam"]||re.linie_naam||"";let Ve=ee||"Militair Object",He="Dit is een historisch militair object uit de Nederlandse verdedigingsgeschiedenis.",Je="";const Qe=ee.toLowerCase();Qe.includes("fort")?(He="Een fort is een versterkte verdedigingspost, vaak met dikke muren en geschutsopstellingen. Forten maakten deel uit van grotere verdedigingslinies.",Je="Rond forten worden soms kogels, knopen van uniformen, muntjes of andere militaire voorwerpen gevonden."):Qe.includes("schans")?(He="Een schans is een kleinere versterking, vaak gemaakt van aarde en palissaden. Schansen werden gebruikt om strategische punten te verdedigen.",Je="Bij schansen kun je musketkogels, knopen en soms munten uit de 17e-18e eeuw tegenkomen."):Qe.includes("batterij")||Qe.includes("battery")?(He="Een batterij is een geschutsopstelling, vaak op een strategische plek om vijanden onder vuur te nemen.",Je="Bij batterijen worden soms kanonkogels of onderdelen van geschut gevonden."):Qe.includes("bunker")||Qe.includes("kazemat")?(He="Een bunker of kazemat is een versterkte betonnen schuilplaats. Veel werden gebouwd rond 1940 als onderdeel van verdedigingslinies.",Je="Bij bunkers worden soms militaire voorwerpen uit WOII gevonden, zoals knopen, gespen of munitieresten."):Qe.includes("sluis")||Qe.includes("inlaatwerk")?(He="Militaire sluizen en inlaatwerken werden gebruikt om land onder water te zetten (inunderen). Dit was een belangrijke verdedigingstactiek.",Je="Bij historische sluizen worden soms voorwerpen gevonden van soldaten die deze bewaakten."):Qe.includes("toren")||Qe.includes("wachttoren")?(He="Wachttorens werden gebruikt om de omgeving in de gaten te houden en vijandelijke bewegingen te signaleren.",Je="Bij torens worden soms persoonlijke voorwerpen van soldaten gevonden."):Qe.includes("kazerne")&&(He="Een kazerne is een gebouw waar soldaten gelegerd waren. Hier woonden, aten en oefenden de troepen.",Je="Rond kazernes worden regelmatig knopen, gespen en andere persoonlijke voorwerpen gevonden.");let yt=`<strong class="text-stone-800">${Ve}</strong>`;ne&&(yt+=`<br/><span class="text-sm font-semibold text-stone-700">${ne}</span>`),Ie&&(yt+=`<br/><span class="text-sm text-blue-600">${Ie}</span>`),ue&&(yt+=`<br/><span class="text-xs text-gray-500">${ue}</span>`),yt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',yt+=`<div class="text-sm text-gray-700 mt-1">${He}</div>`,Je&&(yt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',yt+=`<div class="text-sm text-gray-700 mt-1">${Je}</div>`),yt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',yt+='<div class="text-sm text-gray-700 mt-1">',yt+='<a href="https://erfgoedenlocatie.nl/linies-en-stellingen" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Linies en Stellingen</a>',yt+="</div>",Nt.push(yt)}}catch(je){console.warn("Militaire Objecten WMS query failed:",je)}continue}if(tn==="Verdedigingslinies"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=100,P=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties;let ee='<strong class="text-amber-800">Verdedigingslinie</strong>';const ne={"Hollandse Waterlinie":"Verdedigingsstelsel (1815-1940) dat gebruik maakte van inundaties om Holland te beschermen. UNESCO Werelderfgoed.","Nieuwe Hollandse Waterlinie":"Uitgebreide versie (1815-1940) met forten en inundatiegebieden van Muiden tot Gorinchem.","Stelling van Amsterdam":"Ringverdediging rond Amsterdam (1880-1920) met 42 forten. UNESCO Werelderfgoed.",Grebbelinie:"Verdedigingslinie langs de Grebbe (17e-20e eeuw). Zware gevechten in mei 1940.",IJssellinie:"Koude Oorlog verdediging (1950-1968) langs de IJssel tegen Sovjet-invasie.",Atlantikwall:"Duitse kustverdediging WOII (1942-1945) van Noorwegen tot Spanje.","Peel-Raamstelling":"Verdedigingslinie in Brabant/Limburg. Gevechten mei 1940.","Maas-Waalstelling":"Linie tussen Maas en Waal, onderdeel landsverdediging.",Zuiderwaterlinie:"Waterlinie in West-Brabant en Zeeland (17e-19e eeuw).","Staats-Spaanse Linies":"Vestingwerken uit de 80-jarige oorlog (1568-1648)."},ue=re.naam||re.lin_naam||"";if(ue){ee+=`<br/><span class="text-sm font-semibold text-amber-700">${ue}</span>`;const Ie=Object.entries(ne).find(([Ve])=>ue.toLowerCase().includes(Ve.toLowerCase())||Ve.toLowerCase().includes(ue.toLowerCase()));Ie&&(ee+=`<br/><span class="text-sm text-gray-700">${Ie[1]}</span>`)}re.lin_period&&(ee+=`<br/><span class="text-xs text-purple-600">${re.lin_period}</span>`),re.status&&(ee+=`<br/><span class="text-xs text-gray-400">${re.status}</span>`),Nt.push(ee)}}catch(je){console.warn("Verdedigingslinies WMS query failed:",je)}continue}if(tn==="Rijksmonumenten"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=50,P=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties;let ee='<strong class="text-red-800">Rijksmonument</strong>';(re.cbsNaam||re.cbs_naam)&&(ee+=`<br/><span class="text-sm font-semibold">${re.cbsNaam||re.cbs_naam}</span>`),re.hoofdcategorie&&(ee+=`<br/><span class="text-sm text-red-700">${re.hoofdcategorie}</span>`),re.subcategorie&&(ee+=`<br/><span class="text-xs text-gray-600">${re.subcategorie}</span>`),re.rijksmonumentnummer&&(ee+=`<br/><span class="text-xs text-gray-500">Nr: ${re.rijksmonumentnummer}</span>`),(re.bouwjaar||re.oorspronkelijkebouwjaar)&&(ee+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${re.bouwjaar||re.oorspronkelijkebouwjaar}</span>`),ee+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',re.rijksmonumentnummer&&(ee+=`<div class="text-sm text-gray-700 mt-1"><a href="https://monumentenregister.cultureelerfgoed.nl/monumenten/${re.rijksmonumentnummer}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk in Monumentenregister</a></div>`),ee+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Rijksmonument" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Rijksmonument</a></div>',Nt.push(ee)}}catch(je){console.warn("Rijksmonumenten WMS query failed:",je)}continue}if(tn==="Werelderfgoed"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=500,P=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties;let ee='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(re.siteName||re.naam)&&(ee+=`<br/><span class="text-sm font-semibold text-cyan-700">${re.siteName||re.naam}</span>`),re.siteDesignation&&(ee+=`<br/><span class="text-xs text-gray-600">${re.siteDesignation}</span>`),Nt.push(ee)}}catch(je){console.warn("Werelderfgoed WMS query failed:",je)}continue}if(tn==="Terpen"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=`https://geoportaal.fryslan.nl/arcgis/rest/services/ProvinciaalGeoRegister/PGR2/MapServer/66/query?geometry=${ye[0]},${ye[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=SOORT,SHAPE_Area&returnGeometry=false&f=json`,P=await(await fetch(xe)).json();if(P.features&&P.features.length>0){const ct=P.features[0].attributes,U=ct.SOORT||"Terp",re=ct.SHAPE_Area?Math.round(ct.SHAPE_Area):null;let ee="",ne="",ue=!1;try{const yt=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-100},${ye[1]-100},${ye[0]+100},${ye[1]+100}`}`,Rn=await(await fetch(yt)).json();if(Rn.features&&Rn.features.length>0){const B=Rn.features[0].properties;ee=B.siteName||B.naam||"",ne=B.inspireId||B.monumentnummer||"",ue=!0}}catch{}let Ie="";ee?(Ie=`<strong class="text-orange-800">${ee}</strong>`,Ie+=`<br/><span class="text-sm text-orange-600 font-medium">${U}</span>`):Ie=`<strong class="text-orange-800">${U}</strong>`,Ie+='<br/><span class="text-sm text-gray-600">Friese terp (woonheuvel)</span>';const He={terp:{uitleg:"Een kunstmatige woonheuvel waar mensen woonden om droge voeten te houden.",periode:"IJzertijd tot Middeleeuwen"},"afgegraven terp":{uitleg:"Deze terp is deels of geheel afgegraven voor de vruchtbare grond (terpaarde).",periode:"Oorspronkelijk IJzertijd-Middeleeuwen"},terprestant:{uitleg:"Hier lag ooit een terp, waarvan nu alleen nog resten over zijn.",periode:"IJzertijd tot Middeleeuwen"},"deels afgegraven terp":{uitleg:"Een deel van deze terp is afgegraven, een deel is nog intact.",periode:"IJzertijd tot Middeleeuwen"},"verhoogd kerkhof":{uitleg:"Een verhoogd kerkhof, vaak op een oude terplocatie gebouwd.",periode:"Middeleeuwen"},kerkterp:{uitleg:"Een terp met daarop een kerk, vaak het centrum van een terpdorp.",periode:"IJzertijd tot heden"}}[U.toLowerCase()]||{uitleg:"Een kunstmatige woonheuvel uit de tijd dat dit gebied vaak overstroomde.",periode:"IJzertijd tot Middeleeuwen"};if(Ie+=`<div class="mt-2 text-sm text-gray-700">${He.uitleg}</div>`,Ie+=`<br/><span class="text-sm text-gray-600">Periode: ${He.periode}</span>`,re&&re>100){const Je=(re/1e4).toFixed(1);Ie+=`<br/><span class="text-sm text-gray-500">Oppervlak: ${Je} hectare</span>`}if(ue&&(Ie+='<div class="mt-2 p-2 bg-orange-100 rounded text-xs text-orange-800">',Ie+="<strong> Rijksmonument</strong> - Deze terp is wettelijk beschermd. Detecteren is niet toegestaan zonder vergunning.",ne&&(Ie+=`<br/>Monumentnummer: ${ne}`),Ie+="</div>"),Ie+='<div class="mt-2 p-2 bg-amber-50 rounded text-xs text-amber-800">',Ie+="<strong>Detectietip:</strong> ",U.toLowerCase().includes("afgegraven")?Ie+="Afgegraven terpen zijn interessant! Bij het afgraven kwam materiaal aan de oppervlakte. Zoek op akkers rond de oude terplocatie.":Ie+="Terpen zijn rijk aan vondsten: aardewerk, munten, fibulae, botten, gereedschap. De grond is vaak donker en vruchtbaar door eeuwenlange bewoning.",Ie+="</div>",Ie+='<div class="mt-3 space-y-1">',Ie+='<a href="https://www.terpenonderzoek.nl/" target="_blank" class="block text-blue-600 hover:underline text-sm">Terpenonderzoek.nl - Wetenschappelijk onderzoek</a>',Ie+='<a href="https://www.friesmuseum.nl/collectie/archeologie/" target="_blank" class="block text-blue-600 hover:underline text-sm">Fries Museum - Terpvondsten</a>',Ie+='<a href="https://nl.wikipedia.org/wiki/Terp" target="_blank" class="block text-blue-600 hover:underline text-sm">Wikipedia - Terpen</a>',ee){const Je=encodeURIComponent(ee+" terp friesland");Ie+=`<a href="https://www.google.com/search?q=${Je}" target="_blank" class="block text-blue-600 hover:underline text-sm">Zoek meer over ${ee}</a>`}Ie+="</div>",Nt.push(Ie)}}catch(je){console.warn("Terpen query failed:",je)}continue}if(tn==="Religieus Erfgoed"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=50,P=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties,ee=re.naam||re.NAAM||re.name||re.NAME||"Onbekend",ne=re.denominatie||re.DENOMINATIE||re.religie||"",ue=re.type||re.TYPE||re.functie||"",Ie=re.bouwjaar||re.BOUWJAAR||re.jaar||"",Ve=re.gemeente||re.GEMEENTE||re.plaats||"";let He=`<strong class="text-purple-800">${ee}</strong>`;const Je=ue.toLowerCase();let Qe="Een religieus gebouw of heilige plek.",yt="Munten van kerkgangers, knopen, gespen, religieuze voorwerpen";Je.includes("kerk")||Je.includes("church")?(Qe="Een kerk was het hart van de gemeenschap. Hier kwamen mensen samen voor diensten, maar ook voor belangrijke gebeurtenissen.",yt="Munten uit de collecte, knopen, gespen, pelgrimsinsignes, loden zegels"):Je.includes("kapel")||Je.includes("chapel")?(Qe="Een kapel is een klein gebedshuis, vaak bij een landgoed, langs een weg, of op een bijzondere plek.",yt="Devotionalia, munten, kruisjes, rozenkransen"):Je.includes("synagoge")?(Qe="Een synagoge is een Joods gebedshuis. Veel synagogen in Nederland zijn verwoest of herbestemd na de Tweede Wereldoorlog.",yt="Munten, knopen, kleine religieuze voorwerpen"):Je.includes("klooster")||Je.includes("monastery")?(Qe="Een klooster was een woon- en werkplek voor monniken of nonnen. Veel kloosters hadden eigen werkplaatsen en landerijen.",yt="Religieuze voorwerpen, zegels, gereedschap, aardewerk, middeleeuwse munten"):Je.includes("toren")||Je.includes("tower")?(Qe="Een kerktoren of klokkentoren. Soms is alleen de toren nog over van een verdwenen kerk.",yt="Munten, knopen, bouwmateriaal"):(Je.includes("begraafplaats")||Je.includes("cemetery"))&&(Qe="Een historische begraafplaats. Detecteren op begraafplaatsen is niet toegestaan zonder toestemming.",yt="Detecteren hier niet toegestaan"),ne&&(He+=`<br/><span class="text-sm text-purple-600">${ne}</span>`),ue&&(He+=`<br/><span class="text-sm text-gray-600">${ue}</span>`),Ie&&(He+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${Ie}</span>`),Ve&&(He+=`<br/><span class="text-xs text-gray-400">${Ve}</span>`),He+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',He+=`<div class="text-sm text-gray-700 mt-1">${Qe}</div>`,He+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',He+=`<div class="text-sm text-gray-700 mt-1">${yt}</div>`,He+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',Je.includes("begraafplaats")?He+='<div class="text-sm text-red-600 mt-1">Detecteren op begraafplaatsen is niet toegestaan. Respecteer de rust van de overledenen.</div>':He+='<div class="text-sm text-gray-700 mt-1">Veel kerken en religieuze gebouwen zijn beschermd monument. Vraag altijd toestemming voordat je gaat detecteren op het terrein.</div>',Nt.push(He)}}catch(je){console.warn("Religieus Erfgoed WMS query failed:",je)}continue}if(tn==="Gewaspercelen"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=50,Ot=`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`,P=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${Ot}`,ct=`https://service.pdok.nl/bzk/bro-bodemkaart/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=soilarea&QUERY_LAYERS=soilarea&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${Ot}`,[U,re]=await Promise.all([fetch(P),fetch(ct).catch(()=>null)]),ee=await U.json();if(ee.features&&ee.features.length>0){const ne=ee.features[0].properties;let ue='<strong class="text-green-800">Landbouwperceel</strong>';if((ne.gewas||ne.gewasnaam)&&(ue+=`<br/><span class="text-sm font-semibold text-green-700">${ne.gewas||ne.gewasnaam}</span>`),(ne.categorie||ne.category)&&(ue+=`<br/><span class="text-xs text-gray-600">${ne.categorie||ne.category}</span>`),ne.oppervlakte&&(ue+=`<br/><span class="text-xs text-gray-500">${ne.oppervlakte} ha</span>`),re)try{const Ie=await re.json();if(Ie.features&&Ie.features.length>0){const Ve=Ie.features[0].properties,He=Ve.first_soilname||Ve.soilname||Ve.bodemtype,Je=Ve.first_soilcode||Ve.soilcode||Ve.maparea_soilcode;if(He){ue+=`<br/><span class="text-xs text-amber-700 font-medium">Grondsoort: ${He}</span>`;const Qe=H5(He,Je);Qe.length>0&&(ue+=`<br/><span class="text-xs text-gray-500 italic">${Qe.join("  ")}</span>`)}}}catch{}Nt.push(ue)}}catch(je){console.warn("BRP Gewaspercelen WMS query failed:",je)}continue}if(tn==="Kadastrale Grenzen"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=20,P=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties,ee=re.kadastraleGemeenteWaarde||re.kadastrale_gemeente_waarde||re.kadastraleGemeente||ISe[String(re.kadastraleGemeenteCode)]||re.kadastraleGemeenteCode,ne=re.sectie||re.Sectie||"",ue=re.perceelnummer||re.perceelNummer||re.Perceelnummer||"",Ie=re.kadastraleGrootteWaarde||re.kadastrale_grootte_waarde||re.kadastraleGrootte||re.oppervlakte,Ve=re.AKRKadastraleGemeenteCodeWaarde||re.akrKadastraleGemeenteCodeWaarde||"",He=[ee,ne,ue].filter(Boolean).join(" "),Je=Ve&&ne&&ue?`${Ve}-${ne}-${ue}`:"";let Qe='<strong class="text-indigo-800">Kadastraal Perceel</strong>';if(He&&(Qe+=`<br/><span class="text-sm text-indigo-700">${He}</span>`),Je&&(Qe+=`<br/><span class="text-sm font-bold text-gray-800 font-mono">${Je}</span>`),Ie){const yt=typeof Ie=="number"?Ie:parseFloat(Ie);isNaN(yt)||(Qe+=`<br/><span class="text-xs text-gray-600">${yt.toLocaleString("nl-NL")} m</span>`)}Qe+='<br/><br/><span class="text-xs text-gray-600">Eigenaar opzoeken? Kopieer bovenstaande code, ga naar </span><a href="https://www.kadaster.nl/winkel" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">kadaster.nl/winkel</a><span class="text-xs text-gray-600"> en klik "Zoek op aanduiding"</span><span class="text-xs text-gray-400"> (betaalde dienst)</span>',Nt.push(Qe)}}catch(je){console.warn("Kadastrale Grenzen WMS query failed:",je)}continue}if(tn==="Scheepswrakken"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=100,P=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties;let ne=`<strong class="text-cyan-800">${re.naam||re.NAAM||"Scheepswrak"}</strong>`;ne+='<br/><span class="text-sm text-gray-800">Historisch scheepswrak in Zuid-Holland</span>',ne+='<div class="mt-2 text-sm text-gray-700">',ne+="Op deze plek ligt een oud scheepswrak. Dit is een schip dat lang geleden is gezonken. ",ne+="In de bodem kunnen nog resten van het schip en de lading liggen.",ne+="</div>",(re.type||re.TYPE)&&(ne+=`<br/><span class="text-sm text-cyan-700">Type: ${re.type||re.TYPE}</span>`),(re.datering||re.DATERING)&&(ne+=`<br/><span class="text-sm text-gray-600">Periode: ${re.datering||re.DATERING}</span>`),(re.bron||re.BRON)&&(ne+=`<br/><span class="text-xs text-gray-500">Bron: ${re.bron||re.BRON}</span>`),ne+='<div class="mt-2 p-2 bg-cyan-50 rounded text-xs text-cyan-800">',ne+="<strong>Detectietip:</strong> Bij scheepswrakken kun je bijzondere vondsten doen zoals scheepsonderdelen, munten, gereedschap en lading. Let op: vaak is een vergunning nodig.",ne+="</div>",ne+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Nt.push(ne)}}catch(je){console.warn("Scheepswrakken WMS query failed:",je)}continue}if(tn==="Woonheuvels ZH"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=100,P=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties;let ne=`<strong class="text-orange-800">${re.naam||re.NAAM||"Woonheuvel"}</strong>`;ne+='<br/><span class="text-sm text-gray-800">Historische woonheuvel (terp)</span>',ne+='<div class="mt-2 text-sm text-gray-700">',ne+="Een woonheuvel is een door mensen opgeworpen heuvel. Mensen woonden hierop om droge voeten te houden bij hoog water. ",ne+="Deze heuvels werden steeds hoger gemaakt. Je vindt ze vooral in laaggelegen gebieden.",ne+="</div>",(re.type||re.TYPE)&&(ne+=`<br/><span class="text-sm text-orange-700">Type: ${re.type||re.TYPE}</span>`),ne+='<div class="mt-2 p-2 bg-orange-50 rounded text-xs text-orange-800">',ne+="<strong>Detectietip:</strong> Woonheuvels zijn rijk aan vondsten! Denk aan aardewerk, munten, sieraden en huisraad uit de middeleeuwen. De grond bevat vaak veel materiaal.",ne+="</div>",ne+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Nt.push(ne)}}catch(je){console.warn("Woonheuvels WMS query failed:",je)}continue}if(tn==="Romeinse Forten"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=200,P=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties;let ne=`<strong class="text-red-800">${re.naam||re.NAAM||"Romeins Fort"}</strong>`;ne+='<br/><span class="text-sm text-gray-800">Romeins militair fort (castellum)</span>',ne+='<div class="mt-2 text-sm text-gray-700">',ne+="Dit was een Romeins legerfort. De Romeinen bouwden deze forten langs de Rijn, de grens van hun rijk. ",ne+="Soldaten woonden hier en bewaakten de grens. Deze forten zijn ongeveer 2000 jaar oud.",ne+="</div>",(re.type||re.TYPE)&&(ne+=`<br/><span class="text-sm text-red-700">Type: ${re.type||re.TYPE}</span>`),(re.periode||re.PERIODE)&&(ne+=`<br/><span class="text-sm text-gray-600">Periode: ${re.periode||re.PERIODE}</span>`),ne+='<div class="mt-2 p-2 bg-red-50 rounded text-xs text-red-800">',ne+="<strong>Detectietip:</strong> Romeinse forten zijn toplocaties! Je kunt hier Romeinse munten, fibulae (mantelspelden), militaire uitrusting en aardewerk vinden. Vaak beschermd, check de regels!",ne+="</div>",ne+='<div class="mt-2"><a href="https://www.limesworld.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over de Romeinse Limes</a></div>',Nt.push(ne)}}catch(je){console.warn("Romeinse Forten WMS query failed:",je)}continue}if(tn==="Windmolens"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=50,P=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties;let ne=`<strong class="text-amber-800">${re.naam||re.NAAM||"Windmolen"}</strong>`;if(ne+='<br/><span class="text-sm text-gray-800">Historische windmolen</span>',ne+='<div class="mt-2 text-sm text-gray-700">',ne+="Windmolens gebruikten de kracht van de wind. Ze maalden graan tot meel of pompten water weg uit polders. ",ne+="Nederland heeft veel molens omdat we laaggelegen land droog moesten houden.",ne+="</div>",re.type||re.TYPE||re.functie||re.FUNCTIE){const ue=re.functie||re.FUNCTIE||re.type||re.TYPE;ne+=`<br/><span class="text-sm text-amber-700">Functie: ${ue}</span>`}(re.bouwjaar||re.BOUWJAAR)&&(ne+=`<br/><span class="text-sm text-gray-600">Bouwjaar: ${re.bouwjaar||re.BOUWJAAR}</span>`),ne+='<div class="mt-2 p-2 bg-amber-50 rounded text-xs text-amber-800">',ne+="<strong>Detectietip:</strong> Bij molens vind je vaak voorwerpen van de molenaar en bezoekers: munten, knopen, gereedschap. Ook de grond rond verdwenen molens kan interessant zijn.",ne+="</div>",ne+='<div class="mt-2"><a href="https://www.molendatabase.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over Nederlandse molens</a></div>',Nt.push(ne)}}catch(je){console.warn("Windmolens WMS query failed:",je)}continue}if(tn==="Erfgoedlijnen"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=200,P=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties;let ne=`<strong class="text-purple-800">${re.naam||re.NAAM||re.erfgoedlijn||"Erfgoedlijn"}</strong>`;ne+='<br/><span class="text-sm text-gray-800">Historische lijn in het landschap</span>',ne+='<div class="mt-2 text-sm text-gray-700">',ne+="Een erfgoedlijn is een route of lijn met veel geschiedenis. Dit kunnen oude dijken, wegen, kanalen of verdedigingslinies zijn. ",ne+="Langs deze lijnen vind je vaak bijzondere plekken.",ne+="</div>",(re.type||re.TYPE)&&(ne+=`<br/><span class="text-sm text-purple-700">Type: ${re.type||re.TYPE}</span>`),(re.omschrijving||re.OMSCHRIJVING)&&(ne+=`<br/><span class="text-sm text-gray-600">${re.omschrijving||re.OMSCHRIJVING}</span>`),ne+='<div class="mt-2 p-2 bg-purple-50 rounded text-xs text-purple-800">',ne+="<strong>Detectietip:</strong> Erfgoedlijnen volgen oude routes waar mensen langskwamen. Denk aan munten, knopen, gespen en andere verloren voorwerpen. Dijken en wegen zijn vaak interessant.",ne+="</div>",ne+='<div class="mt-2"><a href="https://www.erfgoedlijnen.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over Erfgoedlijnen</a></div>',Nt.push(ne)}}catch(je){console.warn("Erfgoedlijnen WMS query failed:",je)}continue}if(tn==="Oude Kernen"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=200,P=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties;let ne=`<strong class="text-stone-800">${re.naam||re.NAAM||"Historische Kern"}</strong>`;ne+='<br/><span class="text-sm text-gray-800">Oude dorps- of stadskern</span>',ne+='<div class="mt-2 text-sm text-gray-700">',ne+="Dit is het oude centrum van een dorp of stad. Hier woonden en werkten mensen al honderden jaren geleden. ",ne+="De grond bevat vaak veel sporen van het verleden.",ne+="</div>",(re.type||re.TYPE)&&(ne+=`<br/><span class="text-sm text-stone-700">Type: ${re.type||re.TYPE}</span>`),(re.periode||re.PERIODE)&&(ne+=`<br/><span class="text-sm text-gray-600">Periode: ${re.periode||re.PERIODE}</span>`),ne+='<div class="mt-2 p-2 bg-stone-100 rounded text-xs text-stone-800">',ne+="<strong>Detectietip:</strong> Oude kernen zijn rijk aan vondsten! Munten, knopen, sieraden, gereedschap en huisraad. Let op: detecteren is vaak niet toegestaan in beschermde kernen.",ne+="</div>",ne+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Nt.push(ne)}}catch(je){console.warn("Oude Kernen WMS query failed:",je)}continue}if(tn==="Relictenkaart Punten"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=50,P=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties,ee={KV:{naam:"Kasteel of Vesting",uitleg:"Een versterkt gebouw uit de middeleeuwen. Vaak zijn er nog resten in de grond."},K:{naam:"Kapel",uitleg:"Een klein kerkgebouw. Rond kapellen worden vaak religieuze voorwerpen gevonden."},KE:{naam:"Kerkhof",uitleg:"Historische begraafplaats. Respecteer deze plek en vraag altijd toestemming."},B:{naam:"Buitenhuis",uitleg:"Een landhuis van welgestelde families. Vaak met tuinen en bijgebouwen."},OB:{naam:"Oud Bebouwingsrelict",uitleg:"Resten van oude bebouwing. Hier stonden ooit huizen of boerderijen."},OV:{naam:"Oude Verkaveling",uitleg:"Historisch patroon van akkers en weilanden uit vroeger tijden."},NR:{naam:"Nijverheidsrelict",uitleg:"Plek waar vroeger ambacht of industrie was, zoals smederijen of molens."},GH:{naam:"Grafheuvel",uitleg:"Prehistorische begraafplaats. Beschermd monument - niet detecteren!"},BP:{naam:"Begraafplaats",uitleg:"Historische begraafplaats. Respecteer deze plek."},HH:{naam:"Havezate",uitleg:"Adellijk huis met landerijen. Interessant voor middeleeuwse vondsten."},RM:{naam:"Rosmolen",uitleg:"Molen aangedreven door paarden. Zeldzaam cultuurhistorisch object."},WM:{naam:"Windmolen",uitleg:"Historische windmolen. Vaak zijn funderingen nog zichtbaar."},PM:{naam:"Poldermolen",uitleg:"Molen voor waterbeheer. Belangrijk voor de waterhuishouding."},EK:{naam:"Eendenkooi",uitleg:"Plek om wilde eenden te vangen. Bijzonder cultuurlandschap."},SH:{naam:"Scholtenhoeve",uitleg:"Boerderij van een welgestelde boer. Vaak eeuwenoud."},SL:{naam:"Slot",uitleg:"Versterkt kasteel of adellijke woning."},MO:{naam:"Motte",uitleg:"Vroegmiddeleeuwse kasteelberg. Zeer interessant voor detectie."},BR:{naam:"Borg",uitleg:"Versterkte adellijke woning, typisch voor het noorden."}},ne=re.type?.replace(/[0-9]/g,"")||"",ue=ee[ne]||{naam:re.type||"Cultuurhistorisch object",uitleg:"Een historisch relict in het Gelderse landschap."};let Ie=`<strong class="text-emerald-800">${ue.naam}</strong>`;Ie+='<br/><span class="text-sm text-gray-800">Gelders cultuurhistorisch relict</span>',re.streek&&(Ie+=`<br/><span class="text-sm text-gray-600">Streek: ${re.streek}</span>`),Ie+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',Ie+=`<div class="text-sm text-gray-700 mt-1">${ue.uitleg}</div>`,Ie+='<div class="mt-3"><a href="https://www.gelderland.nl/erfgoed" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Meer over Gelders erfgoed</a></div>',Nt.push(Ie)}}catch(je){console.warn("Relictenkaart Punten WMS query failed:",je)}continue}if(tn==="Relictenkaart Lijnen"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=50,P=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties,ne={1:{naam:"Sprengenbeek",uitleg:"Kunstmatig aangelegde beek voor waterkracht. Vaak bij papiermolens."},2:{naam:"Oude waterloop",uitleg:"Historische beek of rivier. Langs waterlopen vind je vaak oude bewoningssporen."},3:{naam:"Doorgaande weg",uitleg:"Eeuwenoude handelsroute. Langs deze wegen gingen reizigers en handelaren."},4:{naam:"Hessenweg",uitleg:"Historische handelsweg naar Duitsland. Gebruikt door marskramers en kooplieden."},5:{naam:"Oude weg",uitleg:"Historische route door het landschap. Vaak al eeuwen in gebruik."},6:{naam:"Historische grens",uitleg:"Oude eigendoms- of gebiedsgrens. Soms gemarkeerd met grenspalen."},7:{naam:"Trekpad",uitleg:"Pad langs een kanaal waar paarden schepen trokken."},8:{naam:"Jaagpad",uitleg:"Pad langs water voor scheepvaart met paardentractie."}}[re.klasse]||{naam:"Historisch lijnrelict",uitleg:"Een lijnvormig historisch element in het landschap."};let ue=`<strong class="text-teal-800">${ne.naam}</strong>`;ue+='<br/><span class="text-sm text-gray-800">Gelders lijnrelict</span>',ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',ue+=`<div class="text-sm text-gray-700 mt-1">${ne.uitleg}</div>`,ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip</span></div>',ue+='<div class="text-sm text-gray-700 mt-1">Langs oude wegen en waterlopen worden vaak vondsten gedaan. Mensen verloren er munten en voorwerpen.</div>',Nt.push(ue)}}catch(je){console.warn("Relictenkaart Lijnen WMS query failed:",je)}continue}if(tn==="Relictenkaart Vlakken"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=100,P=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties,ne={1:{naam:"Oud agrarisch land",uitleg:"Gebied dat al voor 1850 als landbouwgrond werd gebruikt. Rijk aan geschiedenis."},2:{naam:"Jonge heideontginning",uitleg:"Heide die tussen 1850 en 1950 is ontgonnen voor landbouw."},3:{naam:"Open essencomplex",uitleg:"Historische akkers op hoge grond. Vaak eeuwenoud en rijk aan vondsten."},4:{naam:"Kampenlandschap",uitleg:"Landschap met kleine akkers omringd door houtwallen. Typisch voor Oost-Nederland."},5:{naam:"Heiderelict",uitleg:"Restant van het vroegere uitgestrekte heidelandschap. Vaak prehistorische vondsten."},6:{naam:"Oud bosrelict",uitleg:"Bos dat al in 1850 bestond. Oude bossen bevatten vaak cultuurhistorische resten."},7:{naam:"Stuifzandrelict",uitleg:"Overblijfsel van actief stuifzand. Vaak bij grafheuvels en prehistorische sites."},8:{naam:"Oud bouwland",uitleg:"Historische akkergrond. Boeren hebben hier eeuwenlang gewerkt."},9:{naam:"Historisch grasland",uitleg:"Oud weiland of hooiland. Vaak bij boerderijen en dorpen."},10:{naam:"Beekdal",uitleg:"Laagte langs een beek. Mensen woonden graag bij water."}}[re.klasse]||{naam:"Historisch landschap",uitleg:"Een waardevol cultuurlandschap in Gelderland."};let ue=`<strong class="text-lime-800">${ne.naam}</strong>`;if(ue+='<br/><span class="text-sm text-gray-800">Gelders landschapsrelict</span>',re.st_area_shape_){const Ie=(re.st_area_shape_/1e4).toFixed(1);ue+=`<br/><span class="text-sm text-gray-600">${Ie} hectare</span>`}ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',ue+=`<div class="text-sm text-gray-700 mt-1">${ne.uitleg}</div>`,Nt.push(ue)}}catch(je){console.warn("Relictenkaart Vlakken WMS query failed:",je)}continue}if(tn==="Verdronken Dorpen"){try{const je=En(Et),ye=Sn("EPSG:4326","EPSG:28992",je),xe=200,P=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ye[0]-xe},${ye[1]-xe},${ye[0]+xe},${ye[1]+xe}`}`,U=await(await fetch(P)).json();if(U.features&&U.features.length>0){const re=U.features[0].properties;let ne=`<strong class="text-blue-800">${re.naam||re.NAAM||"Verdronken dorp"}</strong>`;ne+='<br/><span class="text-sm text-gray-800">Verdronken dorp in Zeeland</span>',ne+='<div class="mt-2 text-sm text-gray-700">',ne+="Dit dorp is lang geleden door de zee verzwolgen. Bij stormvloeden brak de zeedijk door en liep het land onder water. ",ne+="De mensen vluchtten, maar hun huizen en bezittingen bleven achter. In de bodem liggen nog resten van dit dorp.",ne+="</div>",(re.verdronken||re.VERDRONKEN||re.jaar||re.JAAR)&&(ne+=`<br/><span class="text-sm text-blue-700">Verdronken in: ${re.verdronken||re.VERDRONKEN||re.jaar||re.JAAR}</span>`),(re.gemeente||re.GEMEENTE)&&(ne+=`<br/><span class="text-sm text-gray-600">Gemeente: ${re.gemeente||re.GEMEENTE}</span>`),(re.bron||re.BRON)&&(ne+=`<br/><span class="text-xs text-gray-500">Bron: ${re.bron||re.BRON}</span>`),ne+='<div class="mt-2 p-2 bg-blue-50 rounded text-xs text-blue-800">',ne+="<strong>Detectietip:</strong> Verdronken dorpen bevatten veel vondsten! Aardewerk, munten, sieraden, gereedschap en huisraad. Bij laag water komen soms stukken vrij. Let op getijden en veiligheid!",ne+="</div>",ne+='<div class="mt-2"><a href="https://www.verdronkengeschiedenis.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over verdronken dorpen</a></div>',Nt.push(ne)}}catch(je){console.warn("Verdronken Dorpen WMS query failed:",je)}continue}const Tr=oi.getFeatureInfoUrl(Et,sn,"EPSG:3857",{INFO_FORMAT:"application/json"});if(Tr)try{const ye=await(await fetch(Tr)).json();if(ye.features&&ye.features.length>0){const xe=ye.features[0].properties;if(tn==="AHN 0.5m"){let U='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const re=xe.value_list??xe.GRAY_INDEX??xe.value??xe.gray_index??xe.dtm_05m??xe.DTM_05M??xe.hoogte??xe.HOOGTE??xe.elevation??xe.ELEVATION;if(re!=null&&!isNaN(Number(re))){const ee=typeof re=="number"?re.toFixed(2):Number(re).toFixed(2);U+=`<br/><span class="text-sm text-blue-700">Hoogte: ${ee} m NAP</span>`,Nt.push(U)}else{let ee=!1;const ne=["geometry","id","fid","gml_id","bbox"];for(const[ue,Ie]of Object.entries(xe))!ne.includes(ue.toLowerCase())&&Ie!==null&&Ie!==""&&(U+=`<br/><span class="text-xs text-gray-600">${ue}: ${Ie}</span>`,ee=!0);ee&&Nt.push(U)}continue}if(tn==="Geomorfologie"){let U='<strong class="text-green-800">Geomorfologie</strong>',re=!1;const ee=xe.landform_subgroup_description,ne=xe.relief_klasse,ue=xe.relief_subklasse,Ie=xe.genese_description,Ve=xe.active_process;if(ee&&(U+=`<br/><span class="text-sm text-green-700">${ee}</span>`,re=!0),ne){const He=ue&&ue!==ne?`${ne} (${ue})`:ne;U+=`<br/><span class="text-xs text-gray-600">Relief: ${He}</span>`,re=!0}if(Ie&&(U+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${Ie}</span>`,re=!0),Ve&&Ve!=="onbekend"&&(U+=`<br/><span class="text-xs text-gray-500">Actief proces: ${Ve}</span>`,re=!0),!re){const He=["geometry","id","fid","gml_id","bbox","fuuid","geom","collection_id"];for(const[Je,Qe]of Object.entries(xe))!He.includes(Je.toLowerCase())&&Qe!==null&&Qe!==""&&!Je.includes("validfrom")&&!Je.includes("validto")&&(U+=`<br/><span class="text-xs text-gray-600">${Je}: ${Qe}</span>`)}U+='<br/><a href="https://legendageomorfologie.wur.nl/" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">Meer over geomorfologie</a>',Nt.push(U);continue}let Ot=`<strong>${tn}</strong>`;const P=xe.first_soilname||xe.soilname,ct=xe.soilcode||xe.first_soilcode;if(P&&(Ot+=`<br/><span class="text-sm text-amber-700">${P}</span>`,tn==="Bodemkaart")){const U=H5(P,ct);U.length>0&&(Ot+=`<br/><span class="text-xs text-gray-500 italic">${U.join("  ")}</span>`)}if(xe.soilslope&&xe.soilslope!=="Niet opgenomen"&&(Ot+=`<br/><span class="text-xs text-gray-500">Helling: ${xe.soilslope}</span>`),!P){const U=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[re,ee]of Object.entries(xe))!U.includes(re)&&ee&&ee!=="Niet opgenomen"&&(Ot+=`<br/><span class="text-xs text-gray-600">${re}: ${ee}</span>`)}Nt.push(Ot)}}catch(je){console.warn("WMS GetFeatureInfo failed:",je)}}return Nt},bn=async Et=>{const sn=[],Nt=[],Xi=ye=>{if(!ye)return;const xe=ye.getType(),P=ye.clone().transform("EPSG:3857","EPSG:4326").getCoordinates();return{type:xe,coordinates:P}},Mr=kSe(Et.coordinate),oi=[];n.forEachFeatureAtPixel(Et.pixel,ye=>{oi.push(ye)});for(const ye of oi){const xe=ye.getProperties(),{geometry:Ot,...P}=xe;if(P.vondst){const ee=P.vondst,ne=`<strong>${ee.objectType}</strong>
            <div data-vondst-id="${ee.id}"></div>
            <br/><span class="text-sm text-gray-600"><strong>Materiaal:</strong> ${ee.material}</span>
            <br/><span class="text-sm text-gray-600"><strong>Periode:</strong> ${ee.period}</span>
            ${ee.depth?`<br/><span class="text-sm text-gray-600"><strong>Diepte:</strong> ${ee.depth} cm</span>`:""}
            ${ee.condition&&ee.condition!=="Onbekend"?`<br/><span class="text-sm text-gray-600"><strong>Conditie:</strong> ${ee.condition}</span>`:""}
            ${ee.weight?`<br/><span class="text-sm text-gray-600"><strong>Gewicht:</strong> ${ee.weight} gram</span>`:""}
            ${ee.notes?`<br/><span class="text-sm text-gray-600"><strong>Notities:</strong> ${ee.notes}</span>`:""}
            ${ee.photoUrl?`<br/><a href="${ee.photoUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm"> Bekijk foto</a>`:""}
            <br/><span class="text-xs text-gray-400">${new Date(ee.timestamp).toLocaleDateString("nl-NL")}</span>`;sn.push(ne),Nt.push(null),N(ee.id);continue}if(P.layerType==="customPoint"&&P.customPoint){const ee=P.customPoint,ne=P.customLayerName||"Mijn Laag",ue=P.customLayerColor||"#f97316";let Ie="";if(ee.popupContent?(Ie=`<div class="flex items-center gap-2 mb-2 pb-2 border-b border-gray-100">
              <span class="w-3 h-3 rounded-full flex-shrink-0" style="background-color: ${ue}"></span>
              <span class="text-xs font-medium" style="color: ${ue}">${ne}</span>
            </div>`,Ie+=ee.popupContent):(Ie=`<strong>${ee.name}</strong>`,Ie+=`<br/><span class="text-xs text-gray-500">${ne}</span>`,ee.category&&ee.category!=="Overig"&&(Ie+=`<br/><span class="text-sm text-gray-600"><strong>Categorie:</strong> ${ee.category}</span>`)),ee.photos&&ee.photos.length>0){Ie+='<div class="flex flex-wrap gap-1 my-2">';for(const Ve of ee.photos.slice(0,3)){const He=Ve.thumbnailUrl||Ve.thumbnailBase64;He&&(Ie+=`<img src="${He}" alt="Foto" class="w-16 h-16 object-cover rounded border border-gray-200" />`)}ee.photos.length>3&&(Ie+=`<span class="text-xs text-gray-400 self-end">+${ee.photos.length-3} meer</span>`),Ie+="</div>"}ee.notes&&!ee.popupContent&&(Ie+=`<br/><span class="text-sm text-gray-600 mt-1">${ee.notes}</span>`),ee.url&&(Ie+=`<br/><a href="${ee.url}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm">Meer info</a>`),Ie+=`<br/><span class="text-xs text-gray-400">${new Date(ee.createdAt).toLocaleDateString("nl-NL")}</span>`,sn.push(Ie),Nt.push(null);continue}if(P.layerType==="importedLayer"){const ee=P.layerName||"Gemporteerde laag",ne=P.layerColor||"#8b5cf6",ue=["layerType","layerId","layerName","layerColor","featureIndex","geometry"],Ie=P.name||P.Name||P.naam||P.title||P.NAAM||P.NAME||P.label||P.description||"Feature";let Ve=`<strong style="color: ${ne}">${Ie}</strong>`;Ve+=`<br/><span class="text-xs text-gray-500">${ee}</span>`;const He=Object.entries(P).filter(([Je])=>!ue.includes(Je)&&Je!=="name"&&Je!=="Name");if(He.length>0){Ve+='<div class="mt-2 space-y-1">';for(const[Je,Qe]of He)if(Qe!=null&&Qe!==""){const yt=Je.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,Rn=>Rn.toUpperCase());let St=String(Qe);St.length>200&&(St=St.substring(0,200)+"..."),St.startsWith("http://")||St.startsWith("https://")?Ve+=`<div class="text-sm"><span class="text-gray-500">${yt}:</span> <a href="${St}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Link</a></div>`:Ve+=`<div class="text-sm"><span class="text-gray-500">${yt}:</span> <span class="text-gray-700">${St}</span></div>`}Ve+="</div>"}sn.push(Ve),Nt.push({geometry:Xi(Ot),properties:P,popupHtml:Ve});continue}if(P.kwaliteitswaarde&&P.kwaliteitswaarde.includes("archeologische waarde")){const ee=_t(P);sn.push(ee),Nt.push({geometry:Xi(Ot),properties:P,popupHtml:ee});continue}if(P.layerType==="romeinsFort"||P.layerType==="romeinsFortLijn"){const ee=P.Name||P.name||"";P.description;const ne=TSe[ee]||null,ue=ne||bSe;let Ie=`<strong class="text-red-800">${ne?ue.naam:ee||"Romeins Fort"}</strong>`;if(Ie+=`<br/><span class="text-sm text-red-700">${RSe[ue.type]||ue.type}</span>`,Ie+=`<br/><span class="text-sm text-gray-500">${ue.periode}</span>`,P.layerType==="romeinsFortLijn"&&(Ie+='<br/><span class="text-sm text-red-600"> Gereconstrueerde fortomtrek</span>'),Ie+=`<br/><span class="text-xs text-gray-600 mt-1 block">${ue.beschrijving}</span>`,ne?.bronnen&&ne.bronnen.length>0){const Ve=ne.bronnen[0].replace(/^https?:\/\//,"").split("/")[0];Ie+=`<br/><a href="${ne.bronnen[0]}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-xs">${Ve}</a>`}sn.push(Ie),Nt.push({geometry:Xi(Ot),properties:P,popupHtml:Ie});continue}let ct=P.name||P.Name||P.naam||P.title||P.NAAM||P.NAME||P.label||P.route_name||P.road_name;ct||(P.leisure==="playground"?ct="Speeltuin":P.leisure==="park"?ct="Park":P.leisure==="swimming_area"||P.sport==="swimming"?ct="Zwemplek":P.tourism==="museum"?ct="Museum":P.amenity==="cafe"||P.amenity==="restaurant"?ct=P.amenity==="cafe"?"Caf":"Restaurant":P.historic==="castle"?ct="Kasteel":ct="Info"),(P.bunker_type||P.name&&(P.name.toLowerCase().includes("bunker")||P.name.toLowerCase().includes("kazemat")||P.name.toLowerCase().includes("schuilplaats")))&&(ct="Bunker"),P.historic==="battlefield"&&(ct="Historisch slagveld");let U=`<strong>${ct}</strong>`;if(P.category&&(U+=`<br/><span class="text-sm text-gray-600">Categorie: ${P.category}</span>`),P.from_to&&P.from_to!==ct&&(U+=`<br/><span class="text-sm text-gray-600">${P.from_to}</span>`),P.route&&P.route!==ct&&(U+=`<br/><span class="text-sm text-gray-600">${P.route}</span>`),P.TOPONIEM&&(U+=`<br/><span class="text-sm font-semibold text-gray-800">${P.TOPONIEM}</span>`,P.PLAATS&&(U+=`<br/><span class="text-xs text-gray-500">${P.PLAATS}</span>`)),(P.AARD_VINDP||P.Aard_vindp)&&(U+=`<br/><span class="text-sm text-gray-700">Aard: ${P.AARD_VINDP||P.Aard_vindp}</span>`),P.BEGIN_PER&&P.EIND_PER&&(U+=`<br/><span class="text-sm text-purple-700">Periode: ${P.BEGIN_PER} - ${P.EIND_PER}</span>`),(P.AARD_OPM||P.Aard_opmer)&&(U+=`<br/><span class="text-xs text-gray-600 italic">${P.AARD_OPM||P.Aard_opmer}</span>`),P.Gemeente&&(U+=`<br/><span class="text-sm text-gray-600">Gemeente: ${P.Gemeente}</span>`),P.Bron&&(U+=`<br/><span class="text-xs text-gray-500">Bron: ${P.Bron}</span>`),P.Bron_besch&&(U+=`<br/><span class="text-xs text-gray-500">${P.Bron_besch}</span>`),P.Dat_st_z&&P.Dat_ei_z&&(U+=`<br/><span class="text-sm text-purple-700">Datering: ${P.Dat_st_z} - ${P.Dat_ei_z}</span>`),P.Begin&&P.Einde&&(U+=`<br/><span class="text-sm text-purple-700">Periode: ${P.Begin} - ${P.Einde}</span>`),P.Uiterwaard&&(U+=`<br/><span class="text-sm font-semibold">${P.Uiterwaard}</span>`),P.rivier&&(U+=`<br/><span class="text-sm text-blue-600">Rivier: ${P.rivier}</span>`),P.Beschrijvi&&(U+=`<br/><span class="text-sm text-gray-700">${P.Beschrijvi}</span>`),P.leisure==="park"){U=`<strong class="text-green-800">${P.name||"Park"}</strong>`,U+='<br/><span class="text-sm text-gray-800">Park</span>',P.description&&(U+=`<div class="mt-2 text-sm text-gray-700">${P.description}</div>`),P.area&&(U+=`<br/><span class="text-sm text-gray-600">Oppervlakte: ${P.area}</span>`);const ne=[];if(P.dog==="yes"&&ne.push("Honden toegestaan"),P.lit==="yes"&&ne.push("Verlicht"),P.bench==="yes"&&ne.push("Bankjes"),ne.length>0&&(U+=`<br/><span class="text-sm text-gray-600">${ne.join("  ")}</span>`),P.operator&&(U+=`<br/><span class="text-xs text-gray-500">Beheer: ${P.operator}</span>`),U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip voor detectie</span></div>',U+='<div class="text-sm text-gray-700">Parken zijn populair bij detectoristen. Mensen verliezen hier munten en sieraden. Vraag eerst toestemming aan de gemeente of beheerder.</div>',P.website){const ue=P.website.replace(/^https?:\/\//,"").split("/")[0];U+=`<div class="mt-2"><a href="${P.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">${ue}</a></div>`}}else P.leisure==="playground"&&(U=`<strong class="text-orange-800">${P.name||"Speeltuin"}</strong>`,U+='<br/><span class="text-sm text-gray-800">Speeltuin</span>',P.description&&(U+=`<div class="mt-2 text-sm text-gray-700">${P.description}</div>`));if(P.tourism==="museum"||P.museum){U=`<strong class="text-purple-800">${P.name||"Museum"}</strong>`,U+='<br/><span class="text-sm text-gray-800">Museum</span>';const ne=P.museum||P["museum:type"]||"";if(ne&&ne!=="yes"){const Ie={art:"Kunstmuseum",history:"Geschiedenismuseum",archaeology:"Archeologisch museum",science:"Wetenschapsmuseum",technology:"Techniekmuseum",nature:"Natuurmuseum",open_air:"Openluchtmuseum",local:"Streekmuseum",military:"Militair museum",railway:"Spoorwegmuseum",maritime:"Maritiem museum",children:"Kindermuseum"}[ne.toLowerCase()]||ne;U+=`<br/><span class="text-sm text-gray-700">${Ie}</span>`}if(P.description&&(U+=`<div class="mt-2 text-sm text-gray-700">${P.description}</div>`),P.opening_hours&&(U+='<div class="mt-2"><span class="text-sm font-semibold text-gray-800">Openingstijden:</span></div>',U+=`<div class="text-sm text-gray-700">${P.opening_hours}</div>`),P.fee){const ue=P.fee==="yes"?"Toegangsprijs":P.fee==="no"?"Gratis toegang":P.fee;U+=`<br/><span class="text-sm text-gray-600">${ue}</span>`}if(P["addr:street"]||P["addr:housenumber"]){const ue=[P["addr:street"],P["addr:housenumber"]].filter(Boolean).join(" ");ue&&(U+=`<br/><span class="text-xs text-gray-500">${ue}</span>`)}if(P["addr:city"]&&(U+=`<br/><span class="text-xs text-gray-500">${P["addr:postcode"]||""} ${P["addr:city"]}</span>`),P.website||P.url){const ue=P.website||P.url,Ie=ue.replace(/^https?:\/\//,"").split("/")[0];U+=`<div class="mt-2"><a href="${ue}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Bezoek ${Ie}</a></div>`}if(P.wikipedia){const ue=P.wikipedia.split(":")[0]||"nl",Ie=P.wikipedia.split(":")[1]||P.wikipedia;U+=`<div class="text-sm"><a href="https://${ue}.wikipedia.org/wiki/${encodeURIComponent(Ie)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(P.leisure==="swimming_area"||P.sport==="swimming"||P.natural==="beach"){U=`<strong class="text-cyan-800">${P.name||"Zwemplek"}</strong>`;const ne=P.natural==="beach"?"Strand":P.leisure==="swimming_area"?"Zwemplek":"Zwemwater";U+=`<br/><span class="text-sm text-gray-800">${ne}</span>`,P.water&&(U+=`<br/><span class="text-sm text-gray-700">${{lake:"Meer",river:"Rivier",pond:"Vijver",reservoir:"Reservoir",canal:"Kanaal"}[P.water]||P.water}</span>`),P.supervised==="yes"&&(U+='<br/><span class="text-sm text-green-700">Met toezicht</span>'),P.changing_rooms==="yes"&&(U+='<br/><span class="text-sm text-gray-600">Kleedruimte aanwezig</span>'),P.description&&(U+=`<div class="mt-2 text-sm text-gray-700">${P.description}</div>`),U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip voor detectie</span></div>',U+='<div class="text-sm text-gray-700">Zwemplekken kunnen interessant zijn voor detectie. Mensen verliezen hier sieraden en munten. Let op: niet overal is detecteren toegestaan.</div>'}if(P.osm_id&&P.address!==void 0&&(U+='<br/><span class="text-sm text-lime-700">Kringloopwinkel</span>',P.address&&(U+=`<br/><span class="text-xs text-gray-500">${P.address}</span>`),P.phone&&(U+=`<br/><span class="text-xs text-gray-600">${P.phone}</span>`)),P.site_type==="tumulus"){const ee=ye.getGeometry()?.getCoordinates();let ne="",ue="";if(ee){const Ie=En(ee),Ve=Ie[0],He=Ie[1];Ve>5.5&&Ve<6.3&&He>52&&He<52.5?(ne="Veluwe",ue="De Veluwe heeft de grootste concentratie grafheuvels van Nederland. Veel heuvels liggen in grafvelden met tientallen heuvels bij elkaar."):Ve>6.2&&Ve<7.1&&He>52.6&&He<53.3?(ne="Drenthe",ue="Drenthe is beroemd om zijn prehistorische monumenten. Naast hunebedden liggen hier honderden grafheuvels uit de Bronstijd."):Ve>4.5&&Ve<6&&He>51.3&&He<51.9?(ne="Noord-Brabant",ue="Op de Brabantse zandgronden liggen veel grafheuvels, vaak in kleine groepjes op hogere gronden."):Ve>5.5&&Ve<6.3&&He>50.7&&He<51.6?(ne="Limburg",ue="De Limburgse heuvels en plateaus herbergen grafheuvels uit verschillende periodes, van Bronstijd tot Romeinse tijd."):Ve>5&&Ve<5.6&&He>52&&He<52.4&&(ne="Utrechtse Heuvelrug",ue="De stuwwallen van de Utrechtse Heuvelrug en het Gooi waren al in de prehistorie bewoond. Grafheuvels markeren de laatste rustplaats van de vroege bewoners.")}U+='<br/><span class="text-sm text-amber-700">Grafheuvel uit de Bronstijd of IJzertijd</span>',ne&&(U+=`<br/><span class="text-sm text-gray-500">${ne}</span>`),U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',U+='<div class="text-sm text-gray-700 mt-1">Een grafheuvel is een kunstmatige heuvel over een of meerdere graven. De meeste Nederlandse grafheuvels zijn 3000 tot 4000 jaar oud, uit de Bronstijd (2000-800 v.Chr.) of vroege IJzertijd.</div>',ue&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over deze regio</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${ue}</div>`),U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe herken je een grafheuvel?</span></div>',U+='<div class="text-sm text-gray-700 mt-1">Grafheuvels zijn vaak ronde, lage heuvels van 10-30 meter doorsnee en 1-3 meter hoog. Ze liggen meestal op zandgronden, vaak in groepjes (grafvelden). Let op de kenmerkende ronde vorm in het landschap.</div>',P.wikidata?(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',U+=`<div class="text-sm text-gray-700 mt-1"><a href="https://www.wikidata.org/wiki/${P.wikidata}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk op Wikidata</a></div>`):(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',U+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Grafheuvel" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Lees meer over grafheuvels op Wikipedia</a></div>')}if(P.historic==="castle"||P.castle_type){const ee={manor:{label:"Landhuis",uitleg:"Een landhuis of havezate was het woonhuis van een adellijke familie. Vaak met een landgoed eromheen.",vondsten:"Sieraden, gespen, munten, aardewerk van rijke bewoners"},stately:{label:"Statig huis",uitleg:"Een groot en deftig woonhuis, vaak van welgestelde families. Soms met kasteelachtige kenmerken.",vondsten:"Huishoudelijke voorwerpen, munten, knopen, aardewerk"},fortress:{label:"Fort/Vesting",uitleg:"Een versterkte militaire bouwwerk, gebouwd om een gebied te verdedigen.",vondsten:"Militaire voorwerpen, kogels, gespen, uniformonderdelen"},defensive:{label:"Verdedigingskasteel",uitleg:"Een kasteel gebouwd voor verdediging, met dikke muren, een gracht en torens.",vondsten:"Wapens, harnasonderdelen, pijlpunten, middeleeuwse munten"},palace:{label:"Paleis",uitleg:"Een groot en luxueus gebouw voor koningen, prinsen of zeer rijke families.",vondsten:"Luxe voorwerpen, sieraden, zegels, zeldzame munten"},castrum:{label:"Romeins fort",uitleg:"Een Romeins legerkamp of fort. Deze zijn bijna 2000 jaar oud!",vondsten:"Romeinse munten, fibulae, militaria, aardewerk"},citadel:{label:"Citadel",uitleg:"Een sterk versterkte kern binnen een stad, als laatste verdedigingslinie.",vondsten:"Militaire voorwerpen uit verschillende periodes"}},ne=P.castle_type?ee[P.castle_type]:null,ue=ne?.label||"Kasteel";if(U+=`<br/><span class="text-sm text-purple-700">${ue}</span>`,P.start_date&&(U+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${P.start_date}</span>`),P.heritage&&(U+='<br/><span class="text-sm text-amber-700">Rijksmonument</span>'),U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ne?U+=`<div class="text-sm text-gray-700 mt-1">${ne.uitleg}</div>`:U+='<div class="text-sm text-gray-700 mt-1">Een historisch kasteel of adellijk huis. Kastelen waren vaak het middelpunt van macht en rijkdom in een gebied.</div>',U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ne?U+=`<div class="text-sm text-gray-700 mt-1">${ne.vondsten}</div>`:U+='<div class="text-sm text-gray-700 mt-1">Munten, sieraden, gespen, aardewerk en andere voorwerpen van de vroegere bewoners.</div>',P.wikipedia||P.website){if(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',P.wikipedia){const Ie=P.wikipedia.startsWith("http")?P.wikipedia:`https://nl.wikipedia.org/wiki/${P.wikipedia.replace(/^nl:/,"")}`;U+=`<div class="text-sm text-gray-700 mt-1"><a href="${Ie}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}P.website&&(U+=`<div class="text-sm text-gray-700 mt-1"><a href="${P.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Website bezoeken</a></div>`)}}if(P.historic==="ruins"){const ee=P.ruins_type||"";let ne="Rune",ue="Een rune is wat overblijft van een oud gebouw. Het kan een kerk, kasteel, molen of ander bouwwerk zijn geweest.",Ie="Baksteenfragmenten, aardewerk, metalen voorwerpen van vroegere bewoners of gebruikers";if(ee.toLowerCase().includes("church")||ee.toLowerCase().includes("kerk")?(ne="Kerkrune",ue="De overblijfselen van een oude kerk. Vaak nog te herkennen aan de fundering of een paar muren.",Ie="Religieuze voorwerpen, munten van kerkgangers, knopen, gespen"):ee.toLowerCase().includes("castle")||ee.toLowerCase().includes("kasteel")?(ne="Kasteelrune",ue="De resten van een middeleeuws kasteel. Soms is alleen de gracht of fundering nog zichtbaar.",Ie="Middeleeuwse munten, sieraden, harnasonderdelen, pijlpunten"):ee.toLowerCase().includes("mill")||ee.toLowerCase().includes("molen")?(ne="Molenrune",ue="Wat rest van een oude molen. Vaak nog te zien aan de stenen fundering of de molenberg.",Ie="Gereedschap, munten, huishoudelijke voorwerpen"):ee.toLowerCase().includes("fort")&&(ne="Fortrune",ue="De overblijfselen van een militair fort of verdedigingswerk.",Ie="Militaire voorwerpen, kogels, gespen, uniformonderdelen"),U+=`<br/><span class="text-sm text-amber-700">${ne}</span>`,U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${ue}</div>`,U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${Ie}</div>`,P.description&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Beschrijving</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${P.description}</div>`),P.wikipedia){const Ve=P.wikipedia.startsWith("http")?P.wikipedia:`https://${P.wikipedia.split(":")[0]||"nl"}.wikipedia.org/wiki/${P.wikipedia.replace(/^[a-z]{2}:/,"")}`;U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${Ve}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(P.bunker_type||P.name&&(P.name.toLowerCase().includes("bunker")||P.name.toLowerCase().includes("kazemat")||P.name.toLowerCase().includes("schuilplaats"))){const ee={munitions:"Munitiebunker",personnel_shelter:"Personeelsschuilplaats",personell_shelter:"Personeelsschuilplaats",command:"Commandobunker",gun_emplacement:"Geschutsbunker",mg_nest:"Mitrailleursnest",technical:"Technische bunker",storage:"Opslagbunker",tobruk:"Tobruk",kazemat:"Kazemat",Flak:"Luchtafweerstelling",hardened_aircraft_shelter:"Vliegtuigshelter",shelter:"Schuilkelder",observation:"Observatiebunker",anti_aircraft:"Luchtafweerstelling"},ne=P.name||"",ue=P.bunker_type?ee[P.bunker_type]||P.bunker_type:"";ne&&ne!=="Bunker"&&(U+=`<br/><span class="text-sm font-semibold text-gray-700">${ne}</span>`),ue&&ue!==ne&&(U+=`<br/><span class="text-xs text-gray-500">${ue}</span>`);const Ie=ye.getGeometry()?.getCoordinates();let Ve="",He="",Je="";if(Ie){const Qe=En(Ie),yt=Qe[0],St=Qe[1],Rn=yt<4.8||yt<5.2&&St>51.8&&St<53.5,B=yt>4.2&&yt<4.4&&St>52&&St<52.15,Y=yt>4.5&&yt<4.7&&St>52.4&&St<52.5,K=yt>4&&yt<4.2&&St>51.95&&St<52.05,q=yt<4.2&&St<51.6,J=yt>5.2&&yt<5.8&&St>51.9&&St<52.3;B?(Ve="Deze bunker maakt deel uit van de Atlantikwall bij Scheveningen. De Duitsers bouwden hier tijdens WOII zo'n 80 bunkers in de duinen. De muren zijn soms 3 meter dik beton. Voor deze bunkers moesten 138.000 mensen uit Den Haag en Scheveningen hun huis verlaten.",He="https://nl.wikipedia.org/wiki/Atlantikwall_Museum_Scheveningen",Je="Atlantikwall Museum Scheveningen"):Y?(Ve="Deze bunker hoort bij Festung IJmuiden, een van de zwaarst verdedigde punten van de Atlantikwall. De Duitsers bouwden hier bunkers om de haventoegang te beschermen. Er zijn nu rondleidingen door het Bunkermuseum.",He="https://www.bunkermuseum.nl/",Je="Bunkermuseum IJmuiden"):K?(Ve="Deze bunker maakt deel uit van de Atlantikwall bij Hoek van Holland. Dit was een strategisch punt voor de Duitsers vanwege de Nieuwe Waterweg. Veel bunkers zijn nog te bezoeken.",He="https://www.atlantikwallhoekvanholland.nl/",Je="Atlantikwall Hoek van Holland"):q?(Ve="Deze bunker hoort bij de Atlantikwall in Zeeland. De Duitsers verdedigden hier de Westerschelde en de kust. Bij Zoutelande en Westkapelle zijn veel bunkers bewaard gebleven.",He="https://www.bunkermuseumzoutelande.nl/",Je="Bunkermuseum Zoutelande"):Rn?(Ve="Deze bunker maakt deel uit van de Atlantikwall: de Duitse verdedigingslinie langs de hele kust van Europa. In Nederland bouwden de Duitsers duizenden bunkers tussen 1942 en 1944.",He="https://nl.wikipedia.org/wiki/Atlantikwall",Je="Atlantikwall (Wikipedia)"):J?(Ve="Deze bunker hoort mogelijk bij de Grebbelinie of de Nieuwe Hollandse Waterlinie. Dit waren Nederlandse verdedigingslinies die de Duitsers na 1940 versterkten met bunkers.",He="https://nl.wikipedia.org/wiki/Grebbelinie",Je="Grebbelinie (Wikipedia)"):(Ve="Een bunker uit de Tweede Wereldoorlog. De meeste bunkers in Nederland zijn gebouwd tussen 1940 en 1944, als onderdeel van de Duitse verdediging of langs bestaande Nederlandse linies.",He="https://nl.wikipedia.org/wiki/Atlantikwall",Je="WOII bunkers (Wikipedia)")}else Ve="Een bunker uit de Tweede Wereldoorlog.",He="https://nl.wikipedia.org/wiki/Atlantikwall",Je="WOII bunkers (Wikipedia)";U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${Ve}</div>`,U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je vinden?</span></div>',U+='<div class="text-sm text-gray-700 mt-1">Bij bunkers worden soms voorwerpen gevonden zoals patronen, uniformknopen, gespen en persoonlijke spullen van soldaten.</div>',U+='<div class="mt-2 text-xs text-gray-500 italic">Let op: betreed nooit een bunker zonder toestemming. Raak munitieresten niet aan.</div>',U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',U+='<div class="text-sm text-gray-700 mt-1">',U+=`<a href="${He}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${Je}</a>`,P.website?U+=`<br/><a href="${P.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>`:U+='<br/><a href="https://www.tracesofwar.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>',U+="</div>"}if(P.historic==="battlefield"){const ee=P.name||"Onbekend slagveld",ue={"Slag om Arnhem":{periode:"September 1944",samenvatting:"De Slag om Arnhem was onderdeel van Operatie Market Garden. Geallieerde parachutisten probeerden de brug over de Rijn te veroveren. Na negen dagen hevige gevechten moesten ze zich terugtrekken. Van de 10.000 Britse soldaten werden er 1.500 gedood en 6.500 krijgsgevangen gemaakt.",watZieJe:"Er zijn veel monumenten en infoborden. Het Airborne Museum in Oosterbeek vertelt het hele verhaal. Elk jaar in september is er een herdenking.",uitkomst:"De geallieerden verloren de slag. Nederland bleef nog tot mei 1945 bezet.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Arnhem"},"Slag om de Sloedam":{periode:"1-2 november 1944",samenvatting:"Canadese soldaten vielen de Sloedam aan om Walcheren te bevrijden. De dam was smal en de Duitsers verdedigden fel. Veel soldaten sneuvelden bij deze bloedige aanval.",watZieJe:"Bij de dam staat een monument voor de gevallen Canadezen. Er zijn infoborden die de slag uitleggen.",uitkomst:"De Canadezen wonnen na zware verliezen. Dit opende de weg naar de bevrijding van Walcheren.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_de_Sloedam"},"Slag bij Heiligerlee (1568)":{periode:"23 mei 1568",samenvatting:"De eerste veldslag van de Tachtigjarige Oorlog. Lodewijk van Nassau versloeg het Spaanse leger. Zijn broer Adolf sneuvelde tijdens de strijd.",watZieJe:"In Heiligerlee staat het Slag bij Heiligerlee monument. Het klooster waar Adolf van Nassau begraven ligt is nog te bezoeken.",uitkomst:"De opstandelingen wonnen, maar dit was pas het begin van 80 jaar oorlog.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_bij_Heiligerlee_(1568)"},Overloon:{periode:"Oktober 1944",samenvatting:"Bij Overloon vochten Britten en Amerikanen tegen de Duitsers. Het was een van de zwaarste tankgevechten op Nederlandse bodem. Het dorp werd volledig verwoest.",watZieJe:"Het Oorlogsmuseum Overloon staat op het voormalige slagveld. Je kunt tanks, vliegtuigen en andere voertuigen zien.",uitkomst:"De geallieerden wonnen na wekenlange gevechten.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Overloon"},"Slagveld Lanakerveld":{periode:"1568",samenvatting:"Onderdeel van de Nederlandse opstand tegen Spanje. Hier vonden gevechten plaats tijdens de beginjaren van de Tachtigjarige Oorlog.",watZieJe:"Het gebied is nu grotendeels landbouwgrond. Lokaal zijn er soms infoborden.",uitkomst:"Onderdeel van de lange strijd tegen de Spaanse overheersing.",wikiUrl:"https://nl.wikipedia.org/wiki/Tachtigjarige_Oorlog"},Blessebrugschans:{periode:"Diverse periodes",samenvatting:"Een historische schans die meerdere keren werd gebruikt in militaire conflicten.",watZieJe:"De resten van de schans zijn nog zichtbaar in het landschap.",uitkomst:"De schans speelde een rol in verschillende conflicten.",wikiUrl:"https://nl.wikipedia.org/wiki/Schans_(vestingwerk)"}}[ee];if(ee!=="Onbekend slagveld"&&ee!=="Historisch slagveld"&&(U+=`<br/><span class="text-sm font-semibold text-red-700">${ee}</span>`),ue)U+=`<br/><span class="text-xs text-gray-500">${ue.periode}</span>`,U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${ue.samenvatting}</div>`,U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe liep het af?</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${ue.uitkomst}</div>`,U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je zien?</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${ue.watZieJe}</div>`,U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',U+='<div class="text-sm text-gray-700 mt-1">',U+=`<a href="${ue.wikiUrl}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a>`,ee.includes("Arnhem")&&(U+='<br/><a href="https://www.airbornemuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Airborne Museum Oosterbeek</a>'),ee.includes("Overloon")&&(U+='<br/><a href="https://www.oorlogsmuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Oorlogsmuseum Overloon</a>'),U+="</div>";else if(P.date&&(U+=`<br/><span class="text-xs text-gray-500">${P.date}</span>`),P.description?(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${P.description}</div>`):(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',U+='<div class="text-sm text-gray-700 mt-1">Op deze plek vonden historische gevechten plaats. Zoek lokaal naar infoborden of monumenten.</div>'),P.wikipedia){const Ie=P.wikipedia.startsWith("http")?P.wikipedia:`https://nl.wikipedia.org/wiki/${P.wikipedia.replace("nl:","")}`;U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',U+=`<div class="text-sm text-gray-700 mt-1"><a href="${Ie}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(P.bron==="Paleobiology Database"){const ee=Ve=>{const He={Mollusca:"weekdieren zoals schelpen en slakken",Brachiopoda:"armpotigen, schelp-achtige dieren",Echinodermata:"stekelhuidigen zoals zee-egels en zeesterren",Chordata:"gewervelde dieren",Arthropoda:"geleedpotigen zoals kreeften en trilobieten",Cnidaria:"neteldieren zoals koralen en kwallen",Bryozoa:"mosdiertjes",Foraminifera:"eencellige schelpdieren",Plantae:"planten",Crinoidea:"zeelelies",Gastropoda:"slakken",Bivalvia:"tweekleppigen zoals mossels en oesters",Cephalopoda:"koppotigen zoals inktvissen en ammonieten",Trilobita:"trilobieten, uitgestorven kreeftachtigen",Mammalia:"zoogdieren",Reptilia:"reptielen",Pisces:"vissen",Amphibia:"amfibien"};for(const[Je,Qe]of Object.entries(He))if(Ve.toLowerCase().includes(Je.toLowerCase()))return Qe;return""},ne=Ve=>{const He={Cambrium:"541-485 miljoen jaar geleden",Ordovicium:"485-444 miljoen jaar geleden",Siluur:"444-419 miljoen jaar geleden",Devoon:"419-359 miljoen jaar geleden",Carboon:"359-299 miljoen jaar geleden",Perm:"299-252 miljoen jaar geleden",Trias:"252-201 miljoen jaar geleden",Jura:"201-145 miljoen jaar geleden",Krijt:"145-66 miljoen jaar geleden",Paleogeen:"66-23 miljoen jaar geleden",Neogeen:"23-2,6 miljoen jaar geleden",Kwartair:"2,6 miljoen jaar - nu",Pleistoceen:"2,6 miljoen - 11.700 jaar geleden",Holoceen:"11.700 jaar geleden - nu"};for(const[Je,Qe]of Object.entries(He))if(Ve.toLowerCase().includes(Je.toLowerCase()))return Qe;return""},ue=Ve=>{const He={limestone:"kalksteen",sandstone:"zandsteen",shale:"schalie",clay:"klei",sand:"zand",gravel:"grind",marl:"mergel",chalk:"krijt",mudstone:"moddersteen",siltstone:"siltsteen"};let Je=Ve;for(const[Qe,yt]of Object.entries(He))Je=Je.replace(new RegExp(Qe,"gi"),yt);return Je},Ie=Ve=>{const He={marine:"zee",coastal:"kust",terrestrial:"land",fluvial:"rivier",lacustrine:"meer",reef:"rif",deltaic:"delta",shallow:"ondiep water",deep:"diep water"};let Je=Ve;for(const[Qe,yt]of Object.entries(He))Je=Je.replace(new RegExp(Qe,"gi"),yt);return Je};if(P.vindplaats&&(U+=`<br/><span class="text-xs text-gray-600">${P.vindplaats}</span>`),U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',P.taxonomie&&P.taxonomie!=="Onbekend"){const Ve=ee(P.taxonomie);Ve?(U+=`<div class="text-sm text-gray-700 mt-1">${Ve}</div>`,U+=`<div class="text-xs text-gray-500 italic">(${P.taxonomie})</div>`):U+=`<div class="text-sm text-gray-700 mt-1">${P.taxonomie}</div>`}if(P.aantal_fossielen){const Ve=parseInt(P.aantal_fossielen),He=Ve>100?"Veel fossielen gevonden op deze locatie.":Ve>10?"Meerdere fossielen gevonden op deze locatie.":`${P.aantal_fossielen} fossiel${Ve>1?"en":""} gevonden op deze locatie.`;U+=`<div class="text-sm text-gray-600 mt-1">${He}</div>`}if(P.periode&&P.periode!=="Onbekend"){U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wanneer leefden deze dieren?</span></div>';const Ve=ne(P.periode);U+=`<div class="text-sm text-gray-700 mt-1">${P.periode}</div>`,Ve&&(U+=`<div class="text-sm text-gray-600">${Ve}</div>`),P.ouderdom&&P.ouderdom!=="Onbekend"&&(U+=`<div class="text-sm text-gray-600">Ouderdom: ${P.ouderdom}</div>`)}(P.gesteente||P.formatie||P.milieu)&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">In wat voor gesteente?</span></div>',P.gesteente&&(U+=`<div class="text-sm text-gray-700 mt-1">${ue(P.gesteente)}</div>`),P.formatie&&(U+=`<div class="text-sm text-gray-600">Formatie: ${P.formatie}</div>`,P.lid&&(U+=`<div class="text-sm text-gray-600 ml-3">Lid: ${P.lid}</div>`)),P.milieu&&(U+=`<div class="text-sm text-gray-600">Leefomgeving: ${Ie(P.milieu)}</div>`))}if(P.layerType==="fossielHotspot"){const ee=[];if(P.type&&ee.push(P.type),P.region&&ee.push(P.region),P.country){const ne={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};ee.push(ne[P.country]||P.country)}if(ee.length>0&&(U+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),(P.finds||P.period)&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',P.finds&&(U+=`<div class="text-sm text-gray-700 mt-1">${P.finds}</div>`),P.period&&(U+=`<div class="text-sm text-gray-600 mt-1">Periode: ${P.period}</div>`),P.geology&&(U+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${P.geology}</div>`)),P.access||P.tips){if(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',P.access){const ue=P.access.toLowerCase().includes("verboden")||P.access.toLowerCase().includes("niet toegankelijk")?"text-red-600":"text-gray-700";U+=`<div class="text-sm ${ue} mt-1">${P.access}</div>`}P.tips&&(U+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${P.tips}</div>`)}}if(P.layerType==="mineralenHotspot"){const ee=[];if(P.region&&ee.push(P.region),P.country){const ne={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};ee.push(ne[P.country]||P.country)}if(ee.length>0&&(U+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),P.minerals&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${P.minerals}</div>`,P.geology&&(U+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${P.geology}</div>`)),P.access||P.tips){if(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',P.access){const ue=P.access.toLowerCase().includes("verboden")||P.access.toLowerCase().includes("niet toegankelijk")||P.access.toLowerCase().includes("gesloten")?"text-red-600":"text-gray-700";U+=`<div class="text-sm ${ue} mt-1">${P.access}</div>`}P.tips&&(U+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${P.tips}</div>`)}}if(P.layerType==="goudrivier"){const ee=[];if(P.river&&ee.push(P.river),P.region&&ee.push(P.region),P.country){const ne={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};ee.push(ne[P.country]||P.country)}if(ee.length>0&&(U+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),(P.goldType||P.origin)&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',P.goldType&&(U+=`<div class="text-sm text-gray-700 mt-1">${P.goldType}</div>`),P.origin&&(U+=`<div class="text-sm text-gray-600 mt-1">Herkomst: ${P.origin}</div>`)),P.legal||P.tips){if(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Mag ik hier zoeken?</span></div>',P.legal){const ue=P.legal.includes("VERBODEN")?"text-red-600 font-semibold":"text-gray-700";U+=`<div class="text-sm ${ue} mt-1">${P.legal}</div>`}P.tips&&(U+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${P.tips}</div>`)}}if(P.layerType==="wandelroute"){const ee=[];if(P.region&&ee.push(P.region),P.country){const ne={NL:"Nederland",BE:"Belgi"};ee.push(ne[P.country]||P.country)}if(ee.length>0&&(U+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),P.distance||P.duration){const ne=P.distance?`${P.distance} km`:"",ue=P.duration?`${P.duration}`:"",Ie=[ne,ue].filter(Boolean).join("  ");Ie&&(U+=`<br/><span class="text-sm text-green-700 font-medium">${Ie}</span>`)}(P.description||P.highlights)&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat ga je zien?</span></div>',P.description&&(U+=`<div class="text-sm text-gray-700 mt-1">${P.description}</div>`),P.highlights&&(U+=`<div class="text-sm text-gray-600 mt-1">Hoogtepunten: ${P.highlights}</div>`)),P.startAddress&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waar begin ik?</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${P.startAddress}</div>`),P.url&&(U+=`<div class="mt-3"><a href="${P.url}" target="_blank" class="text-sm text-blue-600 hover:underline">Bekijk route en download GPX</a></div>`)}if(P.layerType==="hunebed"){P.period&&(U+=`<br/><span class="text-sm text-purple-700">Periode: ${P.period}</span>`),U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',P.description&&(U+=`<div class="text-sm text-gray-700 mt-1">${P.description}</div>`);const ee=[];if(P.stones){const ne=P.stones.toLowerCase(),ue=ne.match(/(\d+)\s*dekst[^\s,]*/i),Ie=ne.match(/(\d+)\s*draagst[^\s,]*/i),Ve=ne.match(/(\d+)\s*sluitst[^\s,]*/i),He=ne.match(/(\d+)\s*poortst[^\s,]*/i),Je=ne.match(/(\d+)\s*gangdekst[^\s,]*/i),Qe=ne.match(/(\d+)\s*gangzijst[^\s,]*/i);ue&&ee.push(`${ue[1]} deksteen${parseInt(ue[1])>1?"en":""} (de grote steen${parseInt(ue[1])>1?"en":""} bovenop)`),Ie&&ee.push(`${Ie[1]} draagstenen (de stenen die de dekstenen dragen)`),Ve&&ee.push(`${Ve[1]} sluitsteen${parseInt(Ve[1])>1?"en":""} (afsluiting aan de korte zijden)`),He&&ee.push(`${He[1]} poortsteen${parseInt(He[1])>1?"en":""} (bij de ingang)`),Je&&ee.push(`${Je[1]} gangdeksteen${parseInt(Je[1])>1?"en":""} (boven de toegangsgang)`),Qe&&ee.push(`${Qe[1]} gangzijstenen (langs de toegangsgang)`)}if(P.length&&ee.push(`Een grafkamer van ${P.length} lang`),P.width&&ee.push(`${P.width}`),ee.length>0&&(U+='<div class="text-sm text-gray-700 mt-1">Het hunebed heeft:</div>',U+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',ee.forEach(ne=>{U+=`<li>${ne}</li>`}),U+="</ul>"),P.notable){const ne=P.notable.toLowerCase();let ue="Wat is hier bijzonder?";ne.includes("grootste")?ue="Waarom is dit het grootste hunebed?":ne.includes("klein")||ne.includes("kindhunebed")?ue="Waarom is dit hunebed zo klein?":ne.includes("cluster")||ne.includes("naast elkaar")?ue="Waarom liggen hier meerdere hunebedden?":(ne.includes("enige")||ne.includes("westelijk")||ne.includes("noordelijk"))&&(ue="Wat maakt deze locatie bijzonder?"),U+=`<div class="mt-3"><span class="text-sm font-semibold text-gray-800">${ue}</span></div>`,U+=`<div class="text-sm text-gray-700 mt-1">${P.notable}</div>`}U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de Trechterbeker cultuur?</span></div>',U+='<div class="text-sm text-gray-700 mt-1">De Trechterbeker cultuur is de naam voor de mensen die 5.000 jaar geleden in Nederland woonden. Ze maakten potten met een trechter-vorm. Daarom heten ze zo. Deze mensen bouwden de hunebedden als graven voor hun doden.</div>',P.finds&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${P.finds}</div>`),P.museum&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Museum in de buurt</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">${P.museum}</div>`),U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',P.access?U+=`<div class="text-sm text-gray-700 mt-1">${P.access}</div>`:U+='<div class="text-sm text-gray-700 mt-1">Je kunt dit hunebed gratis bezoeken.</div>',P.wikipedia&&(U+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',U+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${P.wikipedia}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`)}if((P.inventarisnummer||P.locatie_naam)&&(P.locatie_naam&&(U+=`<br/><span class="text-sm font-semibold">${P.locatie_naam}</span>`),P.inventarisnummer&&(U+=`<br/><span class="text-xs text-gray-500">CAI: ${P.inventarisnummer}</span>`),P.datering_tekst&&(U+=`<br/><span class="text-sm text-purple-700">${P.datering_tekst}</span>`)),(P.veensoort||P.dikte)&&(P.veensoort&&(U+=`<br/><span class="text-sm text-amber-700">${P.veensoort}</span>`),P.dikte&&(U+=`<br/><span class="text-xs text-gray-600">Dikte: ${P.dikte}</span>`)),P.nature&&P.debut){U+=`<br/><span class="text-sm text-purple-700">${P.nature}</span>`;const ee=P.debut===P.fin?P.debut:`${P.debut} - ${P.fin}`;ee&&(U+=`<br/><span class="text-sm text-gray-700">Periode: ${ee}</span>`),P.structure&&(U+=`<br/><span class="text-xs text-gray-600">${P.structure}</span>`),P.commune&&(U+=`<br/><span class="text-xs text-gray-500">${P.commune}</span>`),P.decouvert&&(U+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${P.decouvert}</span>`),P.numero&&(U+=`<br/><span class="text-xs text-gray-400">${P.numero}</span>`)}if((P.NATURE_OPE||P.CODE_OPERA)&&(P.TITRE&&(U+=`<br/><span class="text-sm font-semibold">${P.TITRE}</span>`),P.NATURE_OPE&&(U+=`<br/><span class="text-sm text-amber-700">${P.NATURE_OPE}</span>`),P.AUTEUR&&(U+=`<br/><span class="text-xs text-gray-600">Auteur: ${P.AUTEUR}</span>`),P.DATE&&(U+=`<br/><span class="text-xs text-gray-500">Datum: ${P.DATE}</span>`),P.COMMUNE&&(U+=`<br/><span class="text-xs text-gray-500">${P.COMMUNE}</span>`)),P.type_protection&&(P.n_site||P.t_site)){const ee=P.type_protection==="Classe"?"text-red-700":"text-amber-700";U+=`<br/><span class="text-sm ${ee}">${P.type_protection}</span>`,P.n_site&&(U+=`<br/><span class="text-sm font-semibold">${P.n_site}</span>`),P.t_site&&(U+=`<br/><span class="text-xs text-gray-600">${P.t_site}</span>`),P.c_site&&(U+=`<br/><span class="text-xs text-gray-500">Code: ${P.c_site}</span>`),P.d_creation&&(U+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${P.d_creation}</span>`)}if(P.type_protection&&P.cod_diren){const ee=P.type_protection==="Classe"?"text-red-700":"text-amber-700";if(U+=`<br/><span class="text-sm ${ee}">${P.type_protection}</span>`,P.proced&&(U+=`<br/><span class="text-xs text-gray-600">${P.proced}</span>`),P.d_proced&&(U+=`<br/><span class="text-xs text-gray-500">Date: ${P.d_proced}</span>`),P.comment){const ne=String(P.comment).slice(0,150);U+=`<br/><span class="text-xs text-gray-600 italic">${ne}${String(P.comment).length>150?"...":""}</span>`}}if(P.type_protection&&P.nomsite){const ee=P.type_protection==="Classe"?"text-red-700":"text-amber-700";if(U+=`<br/><span class="text-sm ${ee}">${P.type_protection}</span>`,P.caractere&&(U+=`<br/><span class="text-xs text-gray-600">${P.caractere}</span>`),P.datedecis&&(U+=`<br/><span class="text-xs text-gray-500">Date: ${P.datedecis}</span>`),P.descriptio){const ne=String(P.descriptio).slice(0,150);U+=`<br/><span class="text-xs text-gray-600 italic">${ne}${String(P.descriptio).length>150?"...":""}</span>`}}if(P.secteur&&P.style){if(U+=`<br/><span class="text-sm text-gray-700">${P.secteur}</span>`,P["sous-secteur"]&&(U+=`<br/><span class="text-xs text-gray-600">${P["sous-secteur"]}</span>`),P.description){const ee=String(P.description).slice(0,150);U+=`<br/><span class="text-xs text-gray-600 italic">${ee}${String(P.description).length>150?"...":""}</span>`}P.url&&(U+=`<br/><a href="${P.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(P.nature_operation||P.synthese){P.nature_operation&&(U+=`<br/><span class="text-sm text-red-700">${P.nature_operation}</span>`),P.responsable_operation&&(U+=`<br/><span class="text-xs text-gray-600">Responsable: ${P.responsable_operation}</span>`),P.date_operation&&(U+=`<br/><span class="text-xs text-gray-500">Datum: ${P.date_operation}</span>`);const ee=[];if(P.prehistoire==="Oui"&&ee.push("Prehistorie"),P.protohistoire==="Oui"&&ee.push("Protohistorie"),P.antiquite==="Oui"&&ee.push("Romeins"),P.moyen_age==="Oui"&&ee.push("Middeleeuwen"),P.temps_modernes==="Oui"&&ee.push("Moderne tijd"),ee.length>0&&(U+=`<br/><span class="text-sm text-purple-700">${ee.join(", ")}</span>`),P.adresse&&(U+=`<br/><span class="text-xs text-gray-500">${P.adresse}</span>`),P.synthese){const ne=String(P.synthese).slice(0,200);U+=`<br/><span class="text-xs text-gray-600 italic">${ne}${String(P.synthese).length>200?"...":""}</span>`}}if(P.operator&&(U+=`<br/><span class="text-sm text-gray-600">${P.operator}</span>`),P.opening_hours){const ee=ASe(String(P.opening_hours));U+=`<br/><span class="text-xs text-green-600">Open: ${ee}</span>`}if(P.website&&(U+=`<br/><a href="${P.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`),P.addr_street){const ee=[P.addr_street,P.addr_housenumber,P.addr_postcode].filter(Boolean).join(" ");U+=`<br/><span class="text-xs text-gray-500">${ee}</span>`}const re=P.description||P.omschrijving||P.descr||P.info;re&&re!==ct&&(U+=`<br/><span class="text-sm text-gray-600">${re}</span>`),sn.push(U),Nt.push({geometry:Xi(Ot),properties:P,popupHtml:U})}const tn=n.getView().getResolution()||1,Tr=await pn(Et.coordinate,tn);sn.push(...Tr);for(const ye of Tr)Nt.push(null);const je=await Mr;if(sn.length===0&&je!==null){const ye=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${je.toFixed(2)} m NAP</span>
          </div>`;sn.push(ye),Nt.push(null)}if(sn.length>0&&je!==null&&(sn[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${je.toFixed(2)} m NAP</span>
        </div>`),sn.length>0){l(sn),te(Nt),h(0),console.log(` KLIK OPGESLAGEN: [${Et.coordinate[0].toFixed(0)}, ${Et.coordinate[1].toFixed(0)}]`),v(Et.coordinate),E(!1),z(!1),Te(!1),V(""),Ee(null);const ye=En(Et.coordinate);Ge(ye),A(`https://www.google.com/maps/dir/?api=1&destination=${ye[1]},${ye[0]}`),O(`https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=${ye[1]},${ye[0]}`),m(!0)}};return n.on("click",bn),()=>{n.un("click",bn)}},[n]);const Sr=()=>{m(!1),de("half"),n&&_&&(LR(n),E(!1))},ai=(_t,pn)=>{const bn=pn.velocity.y,Et=pn.offset.y;Fe==="half"?Et<-50||bn<-500?de("full"):(Et>100||bn>500)&&Sr():(Et>50||bn>300)&&de("half")};return f.jsx(Un,{children:g&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:Sr}),f.jsxs(bt.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl overflow-hidden flex flex-col",style:{fontSize:`${14*he/100}px`,height:Fe==="full"?"90vh":"auto",maxHeight:Fe==="full"?"90vh":"50vh"},initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0,bottom:0},dragElastic:.3,onDragEnd:ai,children:[f.jsx("div",{className:"flex justify-center pt-2 pb-1 cursor-grab active:cursor-grabbing",onClick:()=>de(Fe==="half"?"full":"half"),children:f.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),f.jsxs("div",{className:"flex items-center gap-2 px-3 pb-2 border-b border-gray-100",children:[It&&f.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[f.jsx("button",{onClick:cn,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Vorige laag",children:f.jsx(wle,{size:18})}),f.jsxs("span",{className:"text-gray-500 font-medium min-w-[32px] text-center",style:{fontSize:"0.857em"},children:[c+1,"/",o.length]}),f.jsx("button",{onClick:ir,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Volgende laag",children:f.jsx(Wy,{size:18})})]}),f.jsx("span",{className:"flex-1 font-semibold text-gray-800 truncate",style:{fontSize:"1em"},children:Zt||"Info"}),Ce&&f.jsxs("div",{className:"relative",children:[f.jsx("button",{onClick:()=>z(!L),className:`p-1.5 transition-colors flex-shrink-0 border-0 outline-none bg-transparent ${j?"text-green-500":"text-orange-500 hover:text-orange-600"}`,title:"Toevoegen aan mijn laag","aria-label":"Toevoegen aan mijn laag",children:j?f.jsx(lc,{size:18}):f.jsx($a,{size:18})}),L&&f.jsxs("div",{className:"absolute right-0 top-full mt-1 z-50 bg-white rounded-lg shadow-lg border border-gray-200 py-1 min-w-[180px] max-w-[220px]",children:[f.jsx("div",{className:"px-3 py-1 text-xs text-gray-400 font-medium",children:"Toevoegen aan:"}),f.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:i.filter(_t=>!_t.archived).map(_t=>f.jsxs("button",{onClick:()=>{const pn=se;s(_t.id,{name:Zt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[Ce[0],Ce[1]],sourceLayer:Zt,geometry:pn?.geometry,sourceProperties:pn?.properties,popupContent:pn?.popupHtml}),z(!1),Ee(_t.name),setTimeout(()=>Ee(null),2e3)},className:"w-full px-3 py-1.5 text-left text-sm text-gray-700 hover:bg-blue-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[f.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:_t.color}}),f.jsx("span",{className:"truncate",children:_t.name})]},_t.id))}),f.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:Me?f.jsxs("div",{className:"px-2 py-1",children:[f.jsx("input",{type:"text",value:ie,onChange:_t=>V(_t.target.value),placeholder:"Naam nieuwe laag...",className:"w-full px-2 py-1 text-sm border border-gray-200 rounded focus:outline-none focus:border-orange-400",autoFocus:!0,onKeyDown:_t=>{if(_t.key==="Enter"&&ie.trim()){const pn=a(ie.trim()),bn=se;s(pn,{name:Zt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[Ce[0],Ce[1]],sourceLayer:Zt,geometry:bn?.geometry,sourceProperties:bn?.properties,popupContent:bn?.popupHtml}),z(!1),Te(!1),V(""),Ee(ie.trim()),setTimeout(()=>Ee(null),2e3)}else _t.key==="Escape"&&(Te(!1),V(""))}}),f.jsxs("div",{className:"flex gap-1 mt-1",children:[f.jsx("button",{onClick:()=>{if(ie.trim()){const _t=a(ie.trim()),pn=se;s(_t,{name:Zt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[Ce[0],Ce[1]],sourceLayer:Zt,geometry:pn?.geometry,sourceProperties:pn?.properties,popupContent:pn?.popupHtml}),z(!1),Te(!1),V(""),Ee(ie.trim()),setTimeout(()=>Ee(null),2e3)}},disabled:!ie.trim(),className:"flex-1 px-2 py-1 text-xs bg-orange-500 text-white rounded disabled:opacity-50",children:"Toevoegen"}),f.jsx("button",{onClick:()=>{Te(!1),V("")},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700",children:"Annuleer"})]})]}):f.jsxs("button",{onClick:()=>Te(!0),className:"w-full px-3 py-1.5 text-left text-sm text-orange-600 hover:bg-orange-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[f.jsx($a,{size:14}),f.jsx("span",{children:"Nieuwe laag maken..."})]})})]})]}),M&&f.jsx("a",{href:M,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-amber-500 hover:text-amber-600 transition-colors flex-shrink-0",title:"Open Street View","aria-label":"Open Street View",children:f.jsx(nV,{size:18})}),I&&f.jsx("a",{href:I,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-blue-500 hover:text-blue-600 transition-colors flex-shrink-0",title:"Navigeer naar locatie","aria-label":"Open in Google Maps",children:f.jsx(Au,{size:18})}),f.jsx("button",{onClick:Sr,className:"p-1.5 text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0 border-0 outline-none bg-transparent","aria-label":"Sluiten",children:f.jsx(ii,{size:18})})]}),f.jsx("div",{className:`px-4 py-3 overflow-y-auto select-text min-h-0 ${Fe==="full"?"flex-1":""}`,style:{userSelect:"text",WebkitUserSelect:"text"},dangerouslySetInnerHTML:{__html:ht}}),f.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 flex items-center gap-2 flex-shrink-0",children:[f.jsx(iV,{size:14,className:"text-gray-400 flex-shrink-0"}),f.jsx("input",{type:"range",min:"80",max:"150",value:he,onChange:_t=>Pe(parseInt(_t.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),f.jsxs("span",{className:"text-gray-400 w-8 text-right",style:{fontSize:"0.857em"},children:[he,"%"]})]}),hn&&R&&!D&&f.jsxs("div",{className:"px-4 pb-4 flex gap-2 flex-shrink-0",children:[f.jsxs("button",{onClick:()=>{const _t=r.find(pn=>pn.id===R);_t&&W(_t)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(J0,{size:16}),f.jsx("span",{children:"Bewerken"})]}),f.jsxs("button",{onClick:()=>{e(R),m(!1),N(null)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(yc,{size:16}),f.jsx("span",{children:"Verwijderen"})]})]}),D&&f.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-gray-100 pt-3 flex-shrink-0 overflow-y-auto max-h-[40vh]",children:[f.jsx("div",{className:"text-sm font-medium text-blue-600",children:"Vondst bewerken"}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Objecttype"}),f.jsx("input",{type:"text",value:D.objectType,onChange:_t=>W({...D,objectType:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Materiaal"}),f.jsx("input",{type:"text",value:D.material,onChange:_t=>W({...D,material:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Periode"}),f.jsx("input",{type:"text",value:D.period,onChange:_t=>W({...D,period:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-gray-500",children:"Notities"}),f.jsx("textarea",{value:D.notes,onChange:_t=>W({...D,notes:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50 resize-none h-16"})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>W(null),className:"flex-1 px-3 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none text-sm",children:"Annuleren"}),f.jsx("button",{onClick:()=>{t(D.id,{objectType:D.objectType,material:D.material,period:D.period,notes:D.notes}),W(null),m(!1)},className:"flex-1 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none text-sm",children:"Opslaan"})]})]}),rr&&y&&f.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:_?f.jsxs("button",{onClick:jn,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[f.jsx(Z0,{size:16}),f.jsx("span",{children:"Hoogtekaart verbergen"})]}):f.jsx("button",{onClick:Pi,disabled:T,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-white rounded-lg transition-colors border-0 outline-none ${T?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:T?f.jsxs(f.Fragment,{children:[f.jsx(AI,{size:16,className:"animate-spin"}),f.jsx("span",{children:"Laden..."})]}):f.jsxs(f.Fragment,{children:[f.jsx(Z0,{size:16}),f.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}const K5=1e-4;function MSe(n,e){return n.points.some(t=>{const r=Math.abs(t.coordinates[0]-e[0]),i=Math.abs(t.coordinates[1]-e[1]);return r<K5&&i<K5})}function NSe(){const n=pi(O=>O.map),e=wr(O=>O.openVondstForm),{openAddPointModal:t,openCreateLayerModal:r,openLayerManagerModal:i}=wr(),s=us(O=>O.layers),[a,o]=X.useState(null),[l,c]=X.useState(!1),[h,g]=X.useState(!1),[m,y]=X.useState(!1),v=X.useRef(null),_=X.useRef(null);X.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const O=n.getViewport();if(!O){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",O);const L=600,z=15,j=Te=>{if(console.log(" Touch start, touches:",Te.touches.length),Te.touches.length!==1)return;const ie=Te.touches[0];_.current={x:ie.clientX,y:ie.clientY},console.log(" Starting long press timer at:",_.current),v.current&&clearTimeout(v.current),v.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",_.current),!_.current)return;const V=window.__olMap;if(!V){console.log(" Map not available (global)");return}const Z=O.getBoundingClientRect(),te=[_.current.x-Z.left,_.current.y-Z.top],se=V.getCoordinateFromPixel(te);if(se){const he=En(se);Te.preventDefault(),o({pixel:[_.current.x,_.current.y],coordinate:he}),c(!0),g(!1),setTimeout(()=>g(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",he)}},L)},Ee=Te=>{if(!v.current||!_.current)return;const ie=Te.touches[0],V=ie.clientX-_.current.x,Z=ie.clientY-_.current.y,te=Math.sqrt(V*V+Z*Z);te>z&&(console.log(" Touch moved too much, cancelling. Distance:",te),clearTimeout(v.current),v.current=null)},Ce=()=>{console.log(" Touch end, timer active:",!!v.current),v.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(v.current),v.current=null),_.current=null},Ge=Te=>{l&&Te.preventDefault()},Le=Te=>{Te.button===0&&(console.log(" Mouse down"),_.current={x:Te.clientX,y:Te.clientY},v.current&&clearTimeout(v.current),v.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!_.current)return;const ie=window.__olMap;if(console.log(" __olMap:",ie),console.log(" __olMap constructor:",ie?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof ie?.getCoordinateAtPixel),!ie){console.log(" Map not available (global)");return}const V=O.getBoundingClientRect(),Z=[_.current.x-V.left,_.current.y-V.top];console.log(" Pixel:",Z);const te=ie.getCoordinateFromPixel(Z);if(console.log(" Coordinate:",te),te){const se=En(te);o({pixel:[_.current.x,_.current.y],coordinate:se}),c(!0),g(!1),setTimeout(()=>g(!0),300),console.log(" Long press (mouse) detected at:",se)}},L))},ce=Te=>{if(!v.current||!_.current)return;const ie=Te.clientX-_.current.x,V=Te.clientY-_.current.y;Math.sqrt(ie*ie+V*V)>z&&(console.log(" Mouse moved, cancelling"),clearTimeout(v.current),v.current=null)},Me=()=>{console.log(" Mouse up"),v.current&&(clearTimeout(v.current),v.current=null),_.current=null};return O.addEventListener("touchstart",j,{passive:!1}),O.addEventListener("touchmove",Ee,{passive:!0}),O.addEventListener("touchend",Ce),O.addEventListener("touchcancel",Ce),O.addEventListener("contextmenu",Ge),O.addEventListener("mousedown",Le),O.addEventListener("mousemove",ce),O.addEventListener("mouseup",Me),O.addEventListener("mouseleave",Me),()=>{O.removeEventListener("touchstart",j),O.removeEventListener("touchmove",Ee),O.removeEventListener("touchend",Ce),O.removeEventListener("touchcancel",Ce),O.removeEventListener("contextmenu",Ge),O.removeEventListener("mousedown",Le),O.removeEventListener("mousemove",ce),O.removeEventListener("mouseup",Me),O.removeEventListener("mouseleave",Me),v.current&&clearTimeout(v.current)}},[n,l]);const E=()=>{h&&(c(!1),o(null),g(!1),y(!1))},T=()=>{c(!1),o(null),g(!1),y(!1)},b=O=>{if(!a)return;const[L,z]=a.coordinate;t(O,{lat:z,lng:L}),T()},R=()=>{r(),T()},N=()=>{if(!a)return;const[O,L]=a.coordinate;e({lat:L,lng:O}),c(!1),o(null),g(!1)},D=()=>{if(!a)return;const[O,L]=a.coordinate,z=`https://www.google.com/maps?q=${L},${O}`;window.open(z,"_blank"),c(!1),o(null),g(!1)},W=()=>{if(!a)return;const[O,L]=a.coordinate,z=`https://www.google.com/maps?layer=c&cbll=${L},${O}`;window.open(z,"_blank"),T()},I=()=>{if(!a)return;const O=document.createElement("input");O.type="file",O.accept="image/*",O.capture="environment",O.onchange=async L=>{const z=L.target.files?.[0];if(!z)return;const[j,Ee]=a.coordinate;e({lat:Ee,lng:j},z)},O.click(),T()},A=()=>{i(),T()},M=O=>{const[L,z]=O;return`${z.toFixed(5)}N, ${L.toFixed(5)}E`};return f.jsx(Un,{children:l&&a&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:E}),f.jsxs(bt.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(a.pixel[0],window.innerWidth-220),top:Math.min(a.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[f.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:f.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[f.jsx(Ua,{size:16}),f.jsx("span",{className:"text-xs font-mono",children:M(a.coordinate)})]})}),f.jsxs("div",{className:"bg-white",children:[f.jsxs("button",{onClick:N,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(Pv,{size:20,className:"text-orange-500"}),f.jsx("span",{className:"font-medium",children:"Vondst toevoegen"})]}),f.jsxs("button",{onClick:I,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(xE,{size:20,className:"text-green-500"}),f.jsx("span",{className:"font-medium",children:"Foto maken"})]}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{onClick:()=>y(!m),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(_o,{size:20,className:"text-purple-500"}),f.jsx("span",{className:"font-medium flex-1 text-left",children:"Voeg toe aan laag..."}),f.jsx(Wy,{size:16,className:`text-gray-400 transition-transform ${m?"rotate-90":""}`})]}),f.jsx(Un,{children:m&&f.jsx(bt.div,{className:"bg-gray-50 border-t border-gray-100",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:s.length===0?f.jsxs("button",{onClick:R,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none",children:[f.jsx($a,{size:14}),f.jsx("span",{children:"Maak eerst een laag aan"})]}):f.jsxs(f.Fragment,{children:[s.map(O=>{const L=a?MSe(O,a.coordinate):!1;return f.jsxs("button",{onClick:()=>!L&&b(O.id),className:`w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm bg-transparent border-0 outline-none ${L?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,title:L?"Al toegevoegd aan deze laag":void 0,disabled:L,children:[L&&f.jsx(lc,{size:14,className:"text-green-500 flex-shrink-0"}),f.jsx("span",{className:"truncate",children:O.name}),f.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:L?"al toegevoegd":`(${O.points.length})`})]},O.id)}),f.jsxs("button",{onClick:R,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none border-t border-gray-200",children:[f.jsx($a,{size:14}),f.jsx("span",{children:"Nieuwe laag..."})]})]})})})]}),f.jsxs("button",{onClick:A,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(Uce,{size:20,className:"text-purple-500"}),f.jsx("span",{className:"font-medium",children:"Lagen beheren"})]}),f.jsxs("button",{onClick:D,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(Au,{size:20,className:"text-blue-600"}),f.jsx("span",{className:"font-medium",children:"Open in Google Maps"})]}),f.jsxs("button",{onClick:W,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[f.jsx(nV,{size:20,className:"text-yellow-600"}),f.jsx("span",{className:"font-medium",children:"Street View"})]})]}),f.jsx("div",{className:"bg-white",children:f.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[f.jsx(ii,{size:18}),f.jsx("span",{children:"Annuleren"})]})})]})]})})}const LSe={Compass:Lle,TreePalm:uue,Mountain:Z0,Waves:wue,Search:_R,Target:sue,Layers:_o,Grid:Q7},OSe={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},DSe={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},X5=["Mijn Vondsten","Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","FAMKE IJzertijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Onderzoeken","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","Runes","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Wandelroutes","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Ruiterpaden","Laarzenpaden","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],FSe=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"],jSe=[5.2913,52.1326],VSe=8;function BSe(){const n=bi(L=>L.setLayerVisibility),e=xs(L=>L.stopTracking),t=pi(L=>L.map),{presetsPanelOpen:r,togglePresetsPanel:i,closeAllPanels:s}=wr(),{presets:a,applyPreset:o,updatePreset:l,createPreset:c,resetToDefaults:h}=y9(),g=bi(L=>L.visible),m=ur(L=>L.presetPanelFontScale),y=ur(L=>L.setPresetPanelFontScale),v=ur(L=>L.showFontSliders),_=12*m/100,[E,T]=X.useState(null),[b,R]=X.useState(!1),[N,D]=X.useState(""),W=()=>{s(),X5.forEach(L=>n(L,!1)),FSe.forEach(L=>{n(L,L==="CartoDB (licht)")}),e(),t&&t.getView().animate({center:kr(jSe),zoom:VSe,duration:500}),console.log(" Reset: CartoDB, alle lagen uit, GPS uit, zoom naar Nederland")},I=L=>{o(L),s()},A=(L,z)=>{L.stopPropagation();const j=Object.entries(g).filter(([Ee,Ce])=>Ce&&X5.includes(Ee)).map(([Ee])=>Ee);l(z,{layers:j}),T(z),setTimeout(()=>T(null),2e3),console.log(" Lagen opgeslagen naar preset")},M=()=>{N.trim()&&(c(N.trim(),"Layers"),D(""),R(!1))},O=()=>{confirm("Alle presets terugzetten naar standaard? Dit verwijdert aangepaste presets.")&&h()};return f.jsxs(f.Fragment,{children:[f.jsx(bt.button,{onClick:W,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - CartoDB, alle lagen uit, GPS uit",children:f.jsx(Mce,{size:20,className:"text-gray-600"})}),f.jsx(bt.button,{onClick:i,className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?f.jsx(Z7,{size:20,className:"text-blue-600"}):f.jsx(_o,{size:20,className:"text-blue-600"})}),f.jsx(Un,{children:r&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i}),f.jsxs(bt.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[60px] left-[56px] bg-white/95 rounded-xl shadow-lg overflow-hidden w-[240px] backdrop-blur-sm z-[801]",children:[f.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",style:{fontSize:`${_}px`},children:[f.jsx("span",{className:"font-medium text-white",children:"Presets"}),v&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:m,onInput:L=>{y(parseInt(L.target.value))},onChange:L=>y(parseInt(L.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${m}%`}),f.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),f.jsx("div",{className:"p-2 max-h-[300px] overflow-y-auto",children:a.map(L=>{const z=LSe[L.icon]||_o,j=OSe[L.icon]||"text-blue-600",Ee=DSe[L.icon]||"hover:bg-blue-50",Ce=E===L.id;return f.jsxs("button",{onClick:()=>I(L.id),className:`w-full h-8 flex items-center gap-2 px-2 ${Ee} rounded text-left transition-colors border-0 outline-none bg-transparent overflow-hidden ${Ce?"bg-green-50":""}`,style:{fontSize:`${_}px`},children:[f.jsx(z,{size:14,className:`${j} flex-shrink-0`}),f.jsx("span",{className:"text-gray-700 truncate flex-1",children:L.name}),Ce?f.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:f.jsx(lc,{size:14,className:"text-green-500"})}):f.jsx("span",{onClick:Ge=>A(Ge,L.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan naar deze preset",children:f.jsx(rV,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},L.id)})}),f.jsx("div",{className:"border-t border-gray-200 p-2",children:b?f.jsxs("div",{className:"flex gap-1",children:[f.jsx("input",{type:"text",value:N,onChange:L=>D(L.target.value),onKeyDown:L=>{L.key==="Enter"&&M(),L.key==="Escape"&&R(!1)},placeholder:"Naam preset...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400",style:{fontSize:`${_}px`}}),f.jsx("button",{onClick:M,disabled:!N.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-sm disabled:opacity-50 border-0 outline-none",children:f.jsx(lc,{size:14})})]}):f.jsxs("div",{className:"flex gap-1",children:[f.jsxs("button",{onClick:()=>R(!0),className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",style:{fontSize:`${_}px`},children:[f.jsx($a,{size:14}),f.jsx("span",{children:"Nieuwe preset"})]}),f.jsx("button",{onClick:O,className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors border-0 outline-none",title:"Presets terugzetten naar standaard",children:f.jsx(Lce,{size:14})})]})})]})]})})]})}function GSe(){const n=pi(a=>a.map),[e,t]=X.useState(0),[r,i]=X.useState(!1);X.useEffect(()=>{if(!n)return;const a=n.getView(),o=()=>{const l=a.getRotation(),c=l*180/Math.PI;t(c),i(Math.abs(l)>.087)};return o(),a.on("change:rotation",o),()=>{a.un("change:rotation",o)}},[n]);const s=()=>{n&&n.getView().animate({rotation:0,duration:300})};return f.jsx(Un,{children:r&&f.jsx(bt.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},onClick:s,className:"fixed top-[60px] right-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Klik om noorden te herstellen",children:f.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",style:{transform:`rotate(${-e}deg)`},children:[f.jsx("path",{d:"M12 2 L14.5 12 L12 10 L9.5 12 Z",fill:"#EA4335"}),f.jsx("path",{d:"M12 22 L9.5 12 L12 14 L14.5 12 Z",fill:"white",stroke:"#9CA3AF",strokeWidth:"0.5"}),f.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"#374151"})]})})})}const zSe=[{name:"AHN4 Hoogtekaart Kleur",color:"blue",default:.85},{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN 0.5m",color:"blue",default:.7},{name:"TMK 1850",color:"amber",default:.8},{name:"Bonnebladen 1900",color:"amber",default:.8},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"Veengebieden",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"Terpen",color:"orange",default:.7},{name:"Essen",color:"amber",default:.6},{name:"AMK Monumenten",color:"purple",default:.45},{name:"AMK Romeins",color:"red",default:.6},{name:"AMK Steentijd",color:"amber",default:.6},{name:"AMK Vroege ME",color:"green",default:.6},{name:"AMK Late ME",color:"blue",default:.6},{name:"AMK Overig",color:"purple",default:.6},{name:"Paleokaart 9000 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 5500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 2750 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 1500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 100 n.Chr.",color:"indigo",default:.7},{name:"Paleokaart 800 n.Chr.",color:"indigo",default:.7},{name:"Verdedigingslinies",color:"red",default:.7},{name:"Inundatiegebieden",color:"red",default:.5},{name:"Gewaspercelen",color:"green",default:.6},{name:"Erfgoedlijnen",color:"purple",default:.7},{name:"Oude Kernen",color:"orange",default:.6},{name:"Relictenkaart Vlakken",color:"green",default:.5}],USe={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function $Se(){const[n,e]=X.useState(!1),[t,r]=X.useState(!1),i=bi(h=>h.visible),s=bi(h=>h.opacity),a=bi(h=>h.setLayerOpacity),o=zSe.filter(h=>i[h.name]);if(o.length===0)return null;const l=t?o:o.slice(0,3),c=o.length>3;return f.jsxs("div",{className:"fixed bottom-[112px] right-2 z-[900]",children:[f.jsxs(bt.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[f.jsx(qce,{size:22,strokeWidth:2,className:"text-gray-500"}),o.length>0&&f.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:o.length})]}),f.jsx(Un,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),f.jsxs(bt.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[f.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),f.jsx("div",{className:"space-y-3",children:l.map(h=>{const g=s[h.name]??h.default;return f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:h.name,children:h.name}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("input",{type:"range",min:"0",max:"100",value:g*100,onChange:m=>a(h.name,parseInt(m.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${USe[h.color]}`}),f.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(g*100),"%"]})]})]},h.name)})}),c&&f.jsx("button",{onClick:()=>r(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?f.jsxs(f.Fragment,{children:[f.jsx(Z7,{size:14}),"Minder tonen"]}):f.jsxs(f.Fragment,{children:[f.jsx(_E,{size:14}),o.length-3," meer..."]})})]})]})})]})}function WSe(){const n=pi(R=>R.map),[e,t]=X.useState(!1),[r,i]=X.useState(""),[s,a]=X.useState([]),[o,l]=X.useState(!1),[c,h]=X.useState(!1),g=X.useRef(null),m=X.useRef(null),y=X.useRef();X.useEffect(()=>{e&&g.current&&g.current.focus()},[e]),X.useEffect(()=>{if(!e)return;const R=N=>{m.current&&!m.current.contains(N.target)&&v()};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[e]),X.useEffect(()=>{if(!e)return;const R=N=>{N.key==="Escape"&&v()};return document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R)},[e]),X.useEffect(()=>{if(y.current&&clearTimeout(y.current),r.length<2){a([]);return}return y.current=window.setTimeout(async()=>{h(!0);try{const N=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();N.response?.docs&&a(N.response.docs)}catch(R){console.error("Search error:",R),a([])}finally{h(!1)}},300),()=>{y.current&&clearTimeout(y.current)}},[r]);const v=()=>{t(!1),i(""),a([]),l(!1)},_=async R=>{try{const D=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(R)}`)).json();if(D.response?.docs?.[0]?.centroide_ll){const I=D.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(I)return{lng:parseFloat(I[1]),lat:parseFloat(I[2])}}}catch(N){console.error("Lookup error:",N)}return null},E=async R=>{if(!n)return;const N=await _(R.id);N&&n.getView().animate({center:kr([N.lng,N.lat]),zoom:16,duration:1e3}),v()},T=async(R,N)=>{N.stopPropagation();const D=await _(R.id);if(D){const W=`https://www.google.com/maps?q=${D.lat},${D.lng}`;window.open(W,"_blank")}v()},b={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?f.jsxs("div",{ref:m,className:"fixed left-[52px] right-14 z-[850]",style:b,children:[f.jsxs(bt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[f.jsx(_R,{size:18,className:"search-icon"}),f.jsx("input",{ref:g,type:"text",value:r,onChange:R=>{i(R.target.value),l(!0)},onFocus:()=>l(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),f.jsx("button",{onClick:v,className:"search-clear",title:"Sluiten",children:f.jsx(ii,{size:18})})]}),f.jsx(Un,{children:o&&s.length>0&&f.jsx(bt.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(R=>f.jsxs("li",{className:"search-result-item",children:[f.jsx("div",{className:"search-result-content",onClick:()=>E(R),children:f.jsx("span",{className:"search-result-text",children:R.weergavenaam})}),f.jsx("button",{className:"search-navigate-btn",onClick:N=>T(R,N),title:"Open in Google Maps",children:f.jsx(Au,{size:20})})]},R.id))})}),o&&c&&f.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):f.jsx(bt.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:b,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:f.jsx(_R,{size:22,className:"text-gray-600"})})}function HSe(){const n=pi(r=>r.map),e=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i+1,duration:200})},t=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i-1,duration:200})};return f.jsxs("div",{className:"fixed top-2 left-2 z-[800] flex flex-col gap-1",children:[f.jsx(bt.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:f.jsx($a,{size:18,className:"text-gray-600"})}),f.jsx(bt.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:f.jsx(tV,{size:18,className:"text-gray-600"})})]})}const KSe="detector2024",VR="detectorapp-auth";function XSe({children:n}){const[e,t]=X.useState(!1),[r,i]=X.useState(""),[s,a]=X.useState(!1),[o,l]=X.useState(""),[c,h]=X.useState(!0);X.useEffect(()=>{localStorage.getItem(VR)==="authenticated"&&t(!0),h(!1)},[]);const g=m=>{m.preventDefault(),l(""),r===KSe?(localStorage.setItem(VR,"authenticated"),t(!0)):(l("Onjuist wachtwoord"),i(""))};return c?f.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center",children:f.jsx("div",{className:"text-white text-lg",children:"Laden..."})}):e?f.jsx(f.Fragment,{children:n}):f.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:f.jsxs(bt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[f.jsxs("div",{className:"text-center mb-6",children:[f.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:f.jsx(xR,{size:32,className:"text-blue-600"})}),f.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"DetectorApp"}),f.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Test versie - Toegang beveiligd"})]}),f.jsxs("form",{onSubmit:g,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wachtwoord"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:s?"text":"password",value:r,onChange:m=>i(m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none pr-12",placeholder:"Voer wachtwoord in",autoFocus:!0}),f.jsx("button",{type:"button",onClick:()=>a(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?f.jsx(Nv,{size:20}):f.jsx(Lv,{size:20})})]})]}),o&&f.jsx(bt.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:o}),f.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Inloggen"})]}),f.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Alleen voor testers"})]})})}function qSe(){localStorage.removeItem(VR),window.location.reload()}function YSe({isOpen:n,onClose:e}){const t=ll(l=>l.vondsten),r={total:t.length,byType:{},byMaterial:{},byPeriod:{},byCondition:{},avgDepth:0,totalWeight:0,recent:t.slice(-5).reverse()};let i=0,s=0;t.forEach(l=>{r.byType[l.objectType]=(r.byType[l.objectType]||0)+1,r.byMaterial[l.material]=(r.byMaterial[l.material]||0)+1,r.byPeriod[l.period]=(r.byPeriod[l.period]||0)+1,l.condition&&(r.byCondition[l.condition]=(r.byCondition[l.condition]||0)+1),l.depth&&(i+=l.depth,s++),l.weight&&(r.totalWeight+=l.weight)}),r.avgDepth=s>0?Math.round(i/s):0;const a=l=>Object.entries(l).sort((c,h)=>h[1]-c[1]),o=l=>Math.max(...Object.values(l),1);return f.jsx(Un,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(bt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Y7,{size:18}),f.jsx("span",{className:"font-medium",children:"Mijn Vondsten Dashboard"})]}),f.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:f.jsx(ii,{size:18})})]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:t.length===0?f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(Ua,{size:48,className:"mx-auto mb-3 opacity-30"}),f.jsx("p",{className:"font-medium",children:"Nog geen vondsten"}),f.jsx("p",{className:"text-sm mt-1",children:"Voeg je eerste vondst toe via de oranje knop of long-press op de kaart"})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[f.jsx(jT,{icon:f.jsx(Ua,{size:20}),value:r.total,label:"Totaal",color:"bg-orange-100 text-orange-700"}),f.jsx(jT,{icon:f.jsx(Xp,{size:20}),value:r.avgDepth>0?`${r.avgDepth}cm`:"-",label:"Gem. diepte",color:"bg-blue-100 text-blue-700"}),f.jsx(jT,{icon:f.jsx(Vce,{size:20}),value:r.totalWeight>0?`${r.totalWeight.toFixed(1)}g`:"-",label:"Tot. gewicht",color:"bg-green-100 text-green-700"})]}),f.jsx(Xx,{title:"Per Type",data:a(r.byType),max:o(r.byType),color:"bg-orange-500"}),f.jsx(Xx,{title:"Per Periode",data:a(r.byPeriod),max:o(r.byPeriod),color:"bg-amber-500"}),f.jsx(Xx,{title:"Per Materiaal",data:a(r.byMaterial),max:o(r.byMaterial),color:"bg-blue-500"}),Object.keys(r.byCondition).length>0&&f.jsx(Xx,{title:"Per Conditie",data:a(r.byCondition),max:o(r.byCondition),color:"bg-green-500"}),f.jsxs("div",{children:[f.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[f.jsx(TI,{size:14}),"Recente Vondsten"]}),f.jsx("div",{className:"space-y-2",children:r.recent.map(l=>f.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{children:[f.jsx("span",{className:"font-medium text-sm text-gray-800",children:l.objectType}),f.jsx("span",{className:"text-gray-400 mx-1",children:"-"}),f.jsx("span",{className:"text-sm text-gray-600",children:l.material})]}),f.jsx("span",{className:"text-xs text-gray-400",children:new Date(l.timestamp).toLocaleDateString("nl-NL")})]},l.id))})]})]})})]})]})})}function jT({icon:n,value:e,label:t,color:r}){return f.jsxs("div",{className:`rounded-lg p-3 ${r}`,children:[f.jsx("div",{className:"flex items-center gap-2 mb-1 opacity-70",children:n}),f.jsx("div",{className:"text-xl font-bold",children:e}),f.jsx("div",{className:"text-xs opacity-70",children:t})]})}function Xx({title:n,data:e,max:t,color:r}){return e.length===0?null:f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:n}),f.jsx("div",{className:"space-y-1.5",children:e.slice(0,6).map(([i,s])=>f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-24 text-xs text-gray-600 truncate",title:i,children:i}),f.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden",children:f.jsx(bt.div,{className:`h-full ${r} rounded-full`,initial:{width:0},animate:{width:`${s/t*100}%`},transition:{duration:.5,ease:"easeOut"}})}),f.jsx("div",{className:"w-6 text-xs text-gray-600 text-right font-medium",children:s})]},i))})]})}function ZSe(n){const{type:e,coordinates:t}=n,r=o=>kr(o),i=o=>o.map(r),s=o=>o.map(i),a=o=>o.map(s);switch(e){case"Point":return new gi(r(t));case"LineString":return new Ti(i(t));case"Polygon":return new Ga(s(t));case"MultiPoint":return new Id(i(t));case"MultiLineString":return new nc(s(t));case"MultiPolygon":return new ad(a(t));default:return console.warn(`Unsupported geometry type: ${e}`),null}}function JSe(n,e,t){const r=n.color,i=10,s=5,a=14;let o=i;if(t>50?o=s:t>10?o=Math.max(s,i-(t-10)/10):t<2&&(o=a),e==="Point"||e==="MultiPoint")return new mn({image:new Us({radius:o,fill:new tr({color:r}),stroke:new qn({color:"#ffffff",width:2})})});if(e==="LineString"||e==="MultiLineString")return new mn({stroke:new qn({color:r,width:3})});if(e==="Polygon"||e==="MultiPolygon"){const l=QSe(r,.3);return new mn({fill:new tr({color:l}),stroke:new qn({color:r,width:2})})}return new mn({image:new Us({radius:o,fill:new tr({color:r}),stroke:new qn({color:"#ffffff",width:2})})})}function QSe(n,e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);if(t){const r=parseInt(t[1],16),i=parseInt(t[2],16),s=parseInt(t[3],16);return`rgba(${r}, ${i}, ${s}, ${e})`}return n}function eTe(){const n=pi(r=>r.map),e=By(r=>r.layers),t=X.useRef(new Map);return X.useEffect(()=>{if(!n)return;const r=new Set;e.forEach(i=>{r.add(i.id);const s=new dc;i.features.features.forEach((o,l)=>{if(!o.geometry)return;const c=ZSe(o.geometry);if(!c)return;const h=new _r({geometry:c,...o.properties,layerType:"importedLayer",layerId:i.id,layerName:i.name,layerColor:i.color,featureIndex:l});h.setStyle((g,m)=>JSe(i,o.geometry.type,m)),s.addFeature(h)});const a=t.current.get(i.id);if(a)a.setSource(s),a.setVisible(i.visible),a.setOpacity(i.opacity);else{const o=new $u({source:s,zIndex:900,visible:i.visible,opacity:i.opacity,properties:{title:i.name,customLayerId:i.id}});n.addLayer(o),t.current.set(i.id,o)}}),t.current.forEach((i,s)=>{r.has(s)||(n.removeLayer(i),t.current.delete(s))})},[n,e]),X.useEffect(()=>()=>{n&&(t.current.forEach(r=>{n.removeLayer(r)}),t.current.clear())},[n]),null}Sn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");lB(Sn);function tTe(n){if(!n||n.length<2)return"unknown";const[e,t]=n;return e>=7e3&&e<=3e5&&t>=289e3&&t<=629e3?"RD":Math.abs(e)<=180&&Math.abs(t)<=90?"WGS84":"unknown"}function nTe(n){const[e,t]=n;return Sn("EPSG:28992","EPSG:4326",[e,t])}function UG(n,e){return typeof n[0]=="number"?e(n):n.map(t=>UG(t,e))}function rTe(n){const e=n.coordinates;return!e||Array.isArray(e)&&e.length===0?null:n.type==="Point"?e:n.type==="LineString"||n.type==="MultiPoint"?e[0]:n.type==="Polygon"||n.type==="MultiLineString"?e[0]?.[0]:n.type==="MultiPolygon"?e[0]?.[0]?.[0]:null}async function iTe(n){const e=[],t=[];try{const r=await n.text(),i=JSON.parse(r);if(!i.type)return e.push('Ongeldig GeoJSON: geen "type" veld gevonden'),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}};let s=[];i.type==="FeatureCollection"?s=i.features||[]:i.type==="Feature"?s=[i]:i.type==="GeometryCollection"?s=(i.geometries||[]).map((c,h)=>({type:"Feature",geometry:c,properties:{id:h}})):s=[{type:"Feature",geometry:i,properties:{}}],s.length===0&&t.push("Geen features gevonden in bestand");let a="unknown",o=!1;if(s.length>0&&s[0].geometry){const c=rTe(s[0].geometry);c&&(a=tTe(c))}a==="RD"&&(t.push("Rijksdriehoek coordinaten gedetecteerd, worden omgezet naar WGS84"),o=!0,s=s.map(c=>{if(!c.geometry)return c;const h=UG(c.geometry.coordinates,nTe);return{...c,geometry:{...c.geometry,coordinates:h}}}),a="WGS84");const l=[...new Set(s.filter(c=>c.geometry).map(c=>c.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:s},errors:e,warnings:t,metadata:{featureCount:s.length,geometryTypes:l,coordinateSystem:a,transformed:o}}}catch(r){return e.push(`Fout bij parsen: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function sTe(n){const e=[],t=[];try{const r=await n.text(),s=new spe({extractStyles:!1}).readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in KML bestand");const l=new UI().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,g)=>{const m={...h.properties},y=m.name||m.Name||`Feature ${g+1}`,v=m.description||m.Description||"";return{type:"Feature",geometry:h.geometry,properties:{...m,name:y,description:v}}}),c=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen KML: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function aTe(n){const e=[],t=[];try{const r=await n.text(),s=new _me().readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in GPX bestand");const l=new UI().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,g)=>{const m={...h.properties},y=m.name||m.Name||`Waypoint ${g+1}`,v=m.desc||m.description||"",_=m.time||null,E=m.ele||null;return{type:"Feature",geometry:h.geometry,properties:{...m,name:y,description:v,time:_,elevation:E}}}),c=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return c.includes("LineString")&&t.push("GPX track routes worden als lijnen weergegeven"),{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen GPX: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function vC(n){switch(n.split(".").pop()?.toLowerCase()){case"geojson":case"json":return"geojson";case"kml":case"kmz":return"kml";case"gpx":return"gpx";default:return"unsupported"}}function oTe(){return".geojson,.json,.kml,.gpx"}function wC(){return"GeoJSON, KML (Google My Maps), GPX"}async function lTe(n){switch(vC(n.name)){case"geojson":return iTe(n);case"kml":return sTe(n);case"gpx":return aTe(n);case"unsupported":default:return{success:!1,features:{type:"FeatureCollection",features:[]},errors:[`Niet-ondersteund bestandsformaat: ${n.name}. Ondersteunde formaten: ${wC()}`],warnings:[],metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function cTe(n){return n.size>10485760?{valid:!1,error:`Bestand te groot (${(n.size/1024/1024).toFixed(1)} MB). Maximum is 10 MB.`}:vC(n.name)==="unsupported"?{valid:!1,error:`Niet-ondersteund bestandsformaat. Ondersteunde formaten: ${wC()}`}:n.name.toLowerCase().endsWith(".kmz")?{valid:!1,error:"KMZ bestanden worden nog niet ondersteund. Pak het bestand uit en importeer het .kml bestand."}:{valid:!0}}function uTe({isOpen:n,onClose:e}){const t=By(A=>A.addLayer),r=X.useRef(null),[i,s]=X.useState("idle"),[a,o]=X.useState(null),[l,c]=X.useState(null),[h,g]=X.useState(""),[m,y]=X.useState(null),[v,_]=X.useState(!1),E=X.useCallback(()=>{s("idle"),o(null),c(null),g(""),y(null),r.current&&(r.current.value="")},[]),T=X.useCallback(()=>{E(),e()},[E,e]),b=X.useCallback(async A=>{const M=cTe(A);if(!M.valid){y(M.error||"Ongeldig bestand"),s("error");return}o(A),s("parsing"),y(null);const O=A.name.replace(/\.[^/.]+$/,"");g(O);try{const L=await lTe(A);if(!L.success){y(L.errors.join(`
`)),s("error");return}if(L.features.features.length===0){y("Geen features gevonden in het bestand"),s("error");return}c(L),s("preview")}catch(L){y(L instanceof Error?L.message:"Onbekende fout bij parsen"),s("error")}},[]),R=X.useCallback(A=>{const M=A.target.files?.[0];M&&b(M)},[b]),N=X.useCallback(A=>{A.preventDefault(),_(!0)},[]),D=X.useCallback(A=>{A.preventDefault(),_(!1)},[]),W=X.useCallback(A=>{A.preventDefault(),_(!1);const M=A.dataTransfer.files?.[0];M&&b(M)},[b]),I=X.useCallback(()=>{if(!l||!h.trim())return;const A=a?vC(a.name):"geojson";t({name:h.trim(),type:A==="unsupported"?"geojson":A,features:l.features,visible:!0,opacity:1,color:"",sourceFileName:a?.name||"unknown"}),T()},[l,h,a,t,T]);return f.jsx(Un,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T}),f.jsxs(bt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[80vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Hy,{size:18}),f.jsx("span",{className:"font-medium",children:"Laag Importeren"})]}),f.jsx("button",{onClick:T,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:f.jsx(ii,{size:18})})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i==="idle"&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${v?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:N,onDragLeave:D,onDrop:W,children:[f.jsx(bI,{size:40,className:"mx-auto text-gray-400 mb-3"}),f.jsx("p",{className:"text-gray-600 mb-2",children:"Sleep een bestand hierheen"}),f.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"of"}),f.jsx("button",{onClick:()=>r.current?.click(),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none",children:"Bestand kiezen"}),f.jsx("input",{ref:r,type:"file",accept:oTe(),onChange:R,className:"hidden"})]}),f.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[f.jsx("p",{className:"font-medium",children:"Ondersteunde formaten:"}),f.jsx("p",{children:wC()})]})]}),i==="parsing"&&f.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[f.jsx(AI,{size:40,className:"text-purple-500 animate-spin mb-4"}),f.jsx("p",{className:"text-gray-600",children:"Bestand verwerken..."}),f.jsx("p",{className:"text-gray-400 text-sm",children:a?.name})]}),i==="error"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 rounded-lg",children:[f.jsx(J7,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-red-700",children:"Import mislukt"}),f.jsx("p",{className:"text-sm text-red-600 mt-1 whitespace-pre-wrap",children:m})]})]}),f.jsx("button",{onClick:E,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Opnieuw proberen"})]}),i==="preview"&&l&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[f.jsx(Rle,{size:20,className:"text-green-500 flex-shrink-0 mt-0.5"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-green-700",children:"Bestand geladen"}),f.jsx("p",{className:"text-sm text-green-600",children:a?.name})]})]}),l.warnings.length>0&&f.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg",children:[f.jsx("p",{className:"font-medium text-amber-700 text-sm",children:"Let op:"}),f.jsx("ul",{className:"text-sm text-amber-600 mt-1 list-disc list-inside",children:l.warnings.map((A,M)=>f.jsx("li",{children:A},M))})]}),f.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-500",children:"Features:"}),f.jsx("span",{className:"ml-2 font-medium",children:l.metadata.featureCount})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-500",children:"Types:"}),f.jsx("span",{className:"ml-2 font-medium",children:l.metadata.geometryTypes.join(", ")||"-"})]})]})}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de laag"}),f.jsx("input",{type:"text",value:h,onChange:A=>g(A.target.value),placeholder:"Bijv. Mijn locaties",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),i==="preview"&&f.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex gap-2",children:[f.jsx("button",{onClick:E,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Annuleren"}),f.jsx("button",{onClick:I,disabled:!h.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:"Importeren"})]})]})]})})}function hTe(){const{user:n,loading:e,error:t,signInWithGoogle:r,logout:i,initAuth:s}=hE();return X.useEffect(()=>{s()},[s]),e?f.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg text-gray-500",children:[f.jsx(yR,{size:16,className:"animate-pulse"}),f.jsx("span",{className:"text-sm",children:"Laden..."})]}):n?f.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-green-50 rounded-lg",children:[n.photoURL?f.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-8 h-8 rounded-full border-2 border-green-200",referrerPolicy:"no-referrer"}):f.jsx("div",{className:"w-8 h-8 rounded-full bg-green-200 flex items-center justify-center",children:f.jsx(PI,{size:16,className:"text-green-600"})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"text-sm font-medium text-green-800 truncate",children:n.displayName||n.email}),f.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[f.jsx(yR,{size:12}),"Cloud sync actief"]})]}),f.jsx("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:f.jsx(kI,{size:16})})]}):f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg text-gray-500",children:[f.jsx(Ile,{size:16}),f.jsx("span",{className:"text-sm",children:"Alleen lokale opslag"})]}),f.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none",children:[f.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:[f.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),f.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),f.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),f.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),f.jsx("span",{className:"text-sm text-gray-700",children:"Inloggen met Google"})]}),t&&f.jsx("div",{className:"px-3 py-2 bg-red-50 text-red-700 text-xs rounded-lg",children:t})]})}const dTe="https://forms.gle/R5LCk11Bzu5XrkBj8";function fTe(){const{settingsPanelOpen:n,toggleSettingsPanel:e,vondstDashboardOpen:t,toggleVondstDashboard:r,openLayerManagerModal:i}=wr(),s=ur(),{presets:a,createPreset:o,deletePreset:l,updatePreset:c}=y9(),h=ll(Z=>Z.vondsten),g=By(Z=>Z.layers),{layers:m,updateLayer:y}=us(),{devMode:v,setDevMode:_,tier:E}=Uk(),[T,b]=X.useState(""),[R,N]=X.useState(!1),[D,W]=X.useState(!1),[I,A]=X.useState(null),[M,O]=X.useState(""),[L,z]=X.useState(null),[j,Ee]=X.useState(""),[Ce,Ge]=X.useState("algemeen"),Le=14*s.fontScale/100,ce=()=>{T.trim()&&(o(T.trim(),"Layers"),b(""),N(!1))},Me=(Z,te)=>{A(Z),O(te)},Te=Z=>{M.trim()&&(c(Z,{name:M.trim()}),console.log(` Preset hernoemd naar "${M.trim()}"`)),A(null),O("")},ie=()=>{A(null),O("")},V=[{id:"algemeen",label:"Algemeen",icon:f.jsx(Zce,{size:14})},{id:"lagen",label:"Lagen",icon:f.jsx(_o,{size:14})},{id:"vondsten",label:"Vondsten",icon:f.jsx(Ua,{size:14})}];return f.jsxs(f.Fragment,{children:[f.jsx(Un,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(bt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",style:{fontSize:`${Le}px`},children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(vR,{size:18,className:"text-white"}),f.jsx("span",{className:"font-medium text-white",children:"Instellingen"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[s.showFontSliders&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:s.fontScale,onInput:Z=>{s.setFontScale(parseInt(Z.target.value))},onChange:Z=>s.setFontScale(parseInt(Z.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${s.fontScale}%`}),f.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none ml-1",children:f.jsx(ii,{size:18,className:"text-white",strokeWidth:2.5})})]})]}),f.jsx("div",{className:"flex border-b border-gray-200",children:V.map(Z=>f.jsxs("button",{onClick:()=>Ge(Z.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${Ce===Z.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[Z.icon,Z.label]},Z.id))}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",style:{fontSize:`${Le}px`},children:[Ce==="algemeen"&&f.jsxs(f.Fragment,{children:[f.jsx(ro,{title:"Account",icon:f.jsx(PI,{size:16}),children:f.jsx(hTe,{})}),f.jsxs(ro,{title:"Kaart",icon:f.jsx(II,{size:16}),children:[f.jsx(gTe,{label:"Standaard achtergrond",children:f.jsxs("select",{value:s.defaultBackground,onChange:Z=>s.setDefaultBackground(Z.target.value),className:"px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},children:[f.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),f.jsx("option",{value:"OpenStreetMap",children:"OSM"}),f.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),f.jsx(Dl,{label:"Schaalbalk tonen",checked:s.showScaleBar,onChange:s.setShowScaleBar})]}),f.jsxs(ro,{title:"GPS",icon:f.jsx(CI,{size:16}),children:[f.jsx(Dl,{label:"GPS aan bij start",checked:s.gpsAutoStart,onChange:s.setGpsAutoStart}),f.jsx(Dl,{label:"Nauwkeurigheidscirkel",checked:s.showAccuracyCircle,onChange:s.setShowAccuracyCircle})]}),f.jsxs(ro,{title:"Feedback",icon:f.jsx(Qce,{size:16}),children:[f.jsx(Dl,{label:"Trillen bij acties",checked:s.hapticFeedback,onChange:s.setHapticFeedback}),f.jsx(Dl,{label:"Spraakfeedback vondsten",checked:s.voiceFeedbackEnabled,onChange:s.setVoiceFeedbackEnabled}),s.voiceFeedbackEnabled&&f.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:[f.jsx(_ue,{size:12,className:"inline mr-1"}),"Spreekt vondst info uit bij toevoegen"]})]}),f.jsxs(ro,{title:"Development",icon:f.jsx(Mle,{size:16}),children:[f.jsx(Dl,{label:"Dev Mode (alles ontgrendeld)",checked:v,onChange:_}),f.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:["Huidige tier: ",f.jsx("span",{className:"font-medium text-blue-600",children:E}),v&&f.jsx("span",{className:"text-green-600",children:" (alle lagen ontgrendeld)"})]})]})]}),Ce==="lagen"&&f.jsxs(f.Fragment,{children:[f.jsx(ro,{title:"Mijn lagen",icon:f.jsx(_o,{size:16}),isOwn:!0,children:f.jsxs("div",{className:"space-y-1",children:[m.filter(Z=>!Z.archived).length===0?f.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Nog geen eigen lagen aangemaakt."}):m.filter(Z=>!Z.archived).map(Z=>f.jsx("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-gray-50 rounded",children:L===Z.id?f.jsx("input",{type:"text",value:j,onChange:te=>Ee(te.target.value),onKeyDown:te=>{te.key==="Enter"?(j.trim()&&y(Z.id,{name:j.trim()}),z(null)):te.key==="Escape"&&z(null)},onBlur:()=>{j.trim()&&y(Z.id,{name:j.trim()}),z(null)},autoFocus:!0,className:"flex-1 px-1.5 py-0.5 text-sm bg-orange-50 rounded outline-none focus:ring-1 focus:ring-orange-400"}):f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"flex-1 text-sm text-gray-700 truncate",children:Z.name}),f.jsxs("span",{className:"text-xs text-gray-400",children:[Z.points.length," punten"]}),f.jsx("button",{onClick:()=>{z(Z.id),Ee(Z.name)},className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none bg-transparent",title:"Naam bewerken",children:f.jsx(J0,{size:12})})]})},Z.id)),f.jsxs("button",{onClick:()=>{i(),e()},className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx(vR,{size:14}),f.jsx("span",{children:"Lagen beheren"})]})]})}),f.jsx(ro,{title:"Lagen importeren",icon:f.jsx(Hy,{size:16}),children:f.jsxs("div",{className:"space-y-1",children:[g.length>0&&f.jsxs(f.Fragment,{children:[g.map(Z=>f.jsx(aV,{layer:Z},Z.id)),f.jsx("div",{className:"border-t border-gray-100 my-2"})]}),f.jsxs("button",{onClick:()=>W(!0),className:"flex items-center gap-2 px-2 py-1.5 text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx($a,{size:14}),f.jsx("span",{children:"Nieuwe laag importeren"})]}),f.jsx("p",{className:"text-gray-400 mt-1",style:{fontSize:"0.7em"},children:"GeoJSON, KML (Google My Maps), GPX"})]})}),f.jsx(ro,{title:"Presets",icon:f.jsx(_o,{size:16}),children:f.jsxs("div",{className:"space-y-2",children:[a.map(Z=>f.jsx("div",{className:"flex items-center justify-between py-1",children:I===Z.id?f.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[f.jsx("input",{type:"text",value:M,onChange:te=>O(te.target.value),onKeyDown:te=>{te.key==="Enter"&&Te(Z.id),te.key==="Escape"&&ie()},className:"flex-1 px-2 py-0.5 bg-blue-50 rounded border border-blue-300 outline-none",style:{fontSize:"0.9em"},autoFocus:!0}),f.jsx("button",{onClick:()=>Te(Z.id),className:"px-2 py-0.5 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:"OK"}),f.jsx("button",{onClick:ie,className:"px-2 py-0.5 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:""})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:[Z.name,Z.isBuiltIn&&f.jsx("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:"(standaard)"})]}),f.jsxs("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:["(",Z.layers.length," lagen)"]})]}),!Z.isBuiltIn&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("button",{onClick:()=>Me(Z.id,Z.name),className:"p-1 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:f.jsx(J0,{size:14})}),f.jsx("button",{onClick:()=>l(Z.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:f.jsx(yc,{size:14})})]})]})},Z.id)),R?f.jsxs("div",{className:"flex gap-2 mt-2",children:[f.jsx("input",{type:"text",value:T,onChange:Z=>b(Z.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},onKeyDown:Z=>Z.key==="Enter"&&ce(),autoFocus:!0}),f.jsx("button",{onClick:ce,className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Opslaan"}),f.jsx("button",{onClick:()=>N(!1),className:"px-2 py-1 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Annuleren"})]}):f.jsxs("button",{onClick:()=>N(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx($a,{size:14}),f.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})})]}),Ce==="vondsten"&&f.jsxs(f.Fragment,{children:[f.jsxs(ro,{title:"Vondsten",icon:f.jsx(Ua,{size:16}),isOwn:!0,children:[f.jsx(Dl,{label:"Vondsten knop tonen",checked:s.showVondstButton,onChange:s.setShowVondstButton}),f.jsx("p",{className:"text-gray-500 mt-1 py-1",style:{fontSize:"0.75em"},children:"Vondsten worden altijd lokaal op dit apparaat opgeslagen."}),f.jsxs("button",{onClick:r,className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsx(Y7,{size:14}),f.jsxs("span",{children:["Dashboard (",h.length," vondsten)"]})]}),f.jsx(mTe,{})]}),f.jsxs(ro,{title:"Route opnemen",icon:f.jsx(Ov,{size:16}),isOwn:!0,children:[f.jsx(Dl,{label:"Route knop tonen",checked:s.showRouteRecordButton,onChange:s.setShowRouteRecordButton}),f.jsx("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:"Neem je route op tijdens het detecteren of wandelen. Routes worden lokaal opgeslagen en kunnen als GPX gexporteerd worden."})]}),f.jsxs(ro,{title:"Tekstgrootte",icon:f.jsx(iV,{size:16}),children:[f.jsx(Dl,{label:"Tekstgrootte schuifjes tonen",checked:s.showFontSliders,onChange:s.setShowFontSliders}),f.jsx("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:"Toon schuifjes in menu's om de tekstgrootte aan te passen."})]})]})]}),f.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",style:{fontSize:`${Le}px`},children:[f.jsxs("a",{href:dTe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[f.jsx(q7,{size:16}),f.jsx("span",{children:"Meld een bug"})]}),f.jsxs("button",{onClick:qSe,className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[f.jsx(kI,{size:16}),f.jsx("span",{children:"Uitloggen"})]}),f.jsx("p",{className:"text-gray-400 text-center",style:{fontSize:"0.75em"},children:"Instellingen worden lokaal opgeslagen"})]})]})]})}),f.jsx(YSe,{isOpen:t,onClose:r}),f.jsx(uTe,{isOpen:D,onClose:()=>W(!1)})]})}function ro({title:n,icon:e,children:t,isOwn:r}){return f.jsxs("section",{children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[f.jsx("span",{className:r?"text-orange-600":"text-blue-600",children:e}),f.jsx("span",{className:`font-medium ${r?"text-orange-600":"text-gray-800"}`,style:{fontSize:"1em"},children:n})]}),f.jsx("div",{className:"space-y-2",children:t})]})}function gTe({label:n,children:e}){return f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),e]})}function Dl({label:n,checked:e,onChange:t}){return f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),f.jsx("button",{onClick:()=>t(!e),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${e?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gray-300"}`,children:f.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${e?"left-[22px]":"left-0.5"}`})})]})}function mTe(){const[n,e]=X.useState(!1),{vondsten:t,exportAsGeoJSON:r,exportAsCSV:i,exportAsExcel:s,exportAsGPX:a,exportAsKML:o}=ll(),l=[{label:"Excel (.xlsx)",action:s,desc:"Spreadsheet"},{label:"CSV",action:i,desc:"Comma-separated"},{label:"GeoJSON",action:r,desc:"GIS software"},{label:"GPX",action:a,desc:"GPS apparaten"},{label:"KML",action:o,desc:"Google Earth"}],c=h=>{h(),e(!1)};return t.length===0?f.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-gray-400 bg-gray-100 rounded w-full cursor-not-allowed",style:{fontSize:"0.9em"},children:[f.jsx(Mv,{size:14}),f.jsx("span",{children:"Geen vondsten om te exporteren"})]}):f.jsxs("div",{className:"relative mt-2",children:[f.jsxs("button",{onClick:()=>e(!n),className:"flex items-center justify-between gap-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Mv,{size:14}),f.jsxs("span",{children:["Exporteer vondsten (",t.length,")"]})]}),f.jsx("span",{style:{fontSize:"0.8em"},children:""})]}),n&&f.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden",children:l.map((h,g)=>f.jsxs("button",{onClick:()=>c(h.action),className:"w-full px-3 py-2 text-left hover:bg-blue-50 transition-colors border-0 outline-none flex justify-between items-center",style:{fontSize:"0.9em"},children:[f.jsx("span",{className:"text-gray-700",children:h.label}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:h.desc})]},g))})]})}const cw="2.30.32";function pTe({size:n=18}){return f.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[f.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),f.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),f.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),f.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function yTe(){const[n,e]=X.useState(!1),{user:t,loading:r,signInWithGoogle:i,logout:s}=hE(),{toggleInfoPanel:a,toggleSettingsPanel:o}=wr(),l=ur(b=>b.menuFontScale),c=ur(b=>b.setMenuFontScale),h=ur(b=>b.showFontSliders),g={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},m=()=>e(!1),y=()=>{m(),a()},v=()=>{m(),o()},_=()=>{m(),i()},E=()=>{m(),s()},T=13*l/100;return f.jsxs(f.Fragment,{children:[f.jsx(bt.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:g,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?f.jsx(ii,{size:22,className:"text-white"}):f.jsx(mce,{size:22,className:"text-gray-600"})}),f.jsx(Un,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:m}),f.jsxs(bt.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)",fontSize:`${T}px`},children:[f.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",children:[f.jsx("span",{className:"font-medium text-white",style:{fontSize:`${T}px`},children:"Menu"}),h&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:l,onInput:b=>c(parseInt(b.target.value)),onChange:b=>c(parseInt(b.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${l}%`}),f.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),r?f.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:f.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):t?f.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:f.jsxs("div",{className:"flex items-center gap-3",children:[t.photoURL?f.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):f.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:f.jsx(PI,{size:16,className:"text-white"})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"font-medium text-gray-800 truncate",style:{fontSize:"0.85em"},children:t.displayName||"Gebruiker"}),f.jsx("div",{className:"text-green-600",style:{fontSize:"0.7em"},children:"Cloud sync actief"})]}),f.jsx("button",{onClick:E,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:f.jsx(kI,{size:16})})]})}):f.jsxs("button",{onClick:_,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent",children:[f.jsx(pTe,{size:18}),f.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Inloggen met Google"})]}),f.jsx("div",{className:"py-1",children:f.jsxs("button",{onClick:y,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50",style:{fontSize:"0.95em"},children:[f.jsx(RI,{size:18,className:"text-blue-500"}),f.jsx("span",{children:"Info & handleiding"})]})}),f.jsx("div",{className:"mt-auto border-t border-gray-100",children:f.jsxs("button",{onClick:v,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50",style:{fontSize:"0.95em"},children:[f.jsx(vR,{size:18,className:"text-gray-500"}),f.jsx("span",{children:"Instellingen"})]})}),f.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400",style:{fontSize:"0.65em"},children:["DetectorApp NL v",cw]})]})]})})]})}const xTe="https://forms.gle/R5LCk11Bzu5XrkBj8";function _Te(){const{infoPanelOpen:n,toggleInfoPanel:e}=wr(),[t,r]=X.useState("info"),i=[{id:"info",label:"Info",icon:f.jsx(RI,{size:14})},{id:"functies",label:"Functies",icon:f.jsx(bI,{size:14})},{id:"handleiding",label:"Handleiding",icon:f.jsx(fle,{size:14})}];return f.jsx(Un,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(bt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",children:[f.jsxs("span",{className:"font-medium text-white",children:["DetectorApp NL v",cw]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:f.jsx(ii,{size:18,className:"text-white",strokeWidth:2.5})})]}),f.jsx("div",{className:"flex border-b border-gray-200",children:i.map(s=>f.jsxs("button",{onClick:()=>r(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&f.jsx(vTe,{}),t==="functies"&&f.jsx(wTe,{}),t==="handleiding"&&f.jsx(ETe,{}),f.jsxs("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:[f.jsxs("a",{href:xTe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",children:[f.jsx(q7,{size:14}),f.jsx("span",{className:"text-sm",children:"Meld een bug of geef feedback"})]}),f.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["DetectorApp NL v",cw," - Gratis en zonder tracking"]})]})]})]})]})})}function vTe(){return f.jsxs(f.Fragment,{children:[f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),f.jsx("p",{className:"text-gray-600",children:"DetectorApp NL is d gratis kaartapplicatie voor metaaldetectie, fossielen zoeken en archeologische verkenning in Nederland. Met 70+ kaartlagen, GPS tracking met richtingspijl, eigen lagen, cloud sync en uitgebreid vondstenbeheer."})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),f.jsxs("ul",{className:"space-y-2 text-gray-600",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"AMK Monumenten, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed, Essen, Archeo Onderzoeken"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN Hoogtekaarten, IKAW, Bodemkaart, Geomorfologie, Kadastrale Grenzen, Gewaspercelen"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Terpen, Parken, Kringloopwinkels, Musea, Speeltuinen, Strandjes"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Itiner-E / Wetenschappelijk"})," (CC BY 4.0)",f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Mindat.org"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Mineralen hotspots en vindplaatsen"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Paleontica / Fossielen data"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Fossiel hotspots en vindplaatsen"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Map5.nl / Kadaster"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Provinciale data"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Relictenkaart (Gelderland), Scheepswrakken (Zuid-Holland), Verdronken Dorpen (Zeeland)"})]}),f.jsxs("li",{children:[f.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),f.jsx("br",{}),f.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data, Expert advies, Bufferlagen"})]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy & Opslag"}),f.jsxs("div",{className:"text-gray-600 space-y-2",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Volledig anoniem mogelijk:"})," Je kunt deze app gebruiken zonder enige registratie of login. Al je data blijft dan 100% op je eigen apparaat."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Geen tracking:"})," Deze app verzamelt geen analytics, cookies, gebruiksstatistieken of persoonlijke gegevens. Er is geen server die je gedrag registreert."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Locatiegegevens:"})," Je GPS-positie wordt alleen gebruikt om je locatie op de kaart te tonen. Deze wordt niet opgeslagen of gedeeld met derden."]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Google Login - Wat betekent het?"}),f.jsxs("div",{className:"text-gray-600 space-y-2",children:[f.jsx("p",{className:"font-medium text-green-700",children:" Google login is volledig optioneel"}),f.jsx("p",{children:f.jsx("strong",{children:"Wat wordt gesynchroniseerd:"})}),f.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[f.jsx("li",{children:"Je eigen aangemaakte lagen (Mijn Lagen)"}),f.jsx("li",{children:"Je vondsten registraties"}),f.jsx("li",{children:"Je preset-instellingen"})]}),f.jsx("p",{children:f.jsx("strong",{children:"Wat NIET wordt gedeeld:"})}),f.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[f.jsx("li",{children:"Je GPS-locatie wordt niet opgeslagen in de cloud"}),f.jsx("li",{children:"Je zoekgeschiedenis wordt niet bewaard"}),f.jsx("li",{children:"Welke kaartlagen je bekijkt wordt niet geregistreerd"}),f.jsx("li",{children:"Niemand anders kan je data zien - alleen jij"})]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Waarom inloggen?"})," Alleen voor synchronisatie tussen apparaten (telefoon/tablet/PC) en als backup voor je vondsten."]}),f.jsx("p",{className:"text-xs text-gray-500 italic",children:"Tip: Gebruik de app gerust zonder login als je privacy belangrijker vindt dan synchronisatie. Alle functies werken ook offline."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zonder login (anoniem)"}),f.jsxs("div",{className:"text-gray-600 space-y-2",children:[f.jsx("p",{className:"font-medium text-blue-700",children:" 95% van de functies werkt zonder login"}),f.jsx("p",{children:f.jsx("strong",{children:"Beschikbaar zonder login:"})}),f.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[f.jsx("li",{children:"Alle 70+ kaartlagen bekijken"}),f.jsx("li",{children:"GPS tracking en navigatie"}),f.jsx("li",{children:"Vondsten registreren (lokaal opgeslagen)"}),f.jsx("li",{children:"Eigen lagen aanmaken (lokaal opgeslagen)"}),f.jsx("li",{children:"Export naar Excel/CSV/GeoJSON/GPX/KML"}),f.jsx("li",{children:"Lagen importeren"}),f.jsx("li",{children:"Alle presets en instellingen"})]}),f.jsx("p",{children:f.jsx("strong",{children:"Alleen met login:"})}),f.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[f.jsx("li",{children:"Synchronisatie tussen apparaten"}),f.jsx("li",{children:"Cloud backup van je vondsten"})]})]})]})]})}function wTe(){return f.jsxs(f.Fragment,{children:[f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(II,{size:16,className:"text-blue-600"}),"Kaartlagen (70+)"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Basis:"})," CartoDB, OpenStreetMap, PDOK Luchtfoto"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Historisch:"})," TMK 1850, Bonnebladen 1900"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Hoogtekaarten:"})," AHN4 Hillshade, Multi-Hillshade, Hoogtekaart Kleur, AHN 0.5m"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Archeologie:"})," AMK Monumenten (per periode), Archeo Onderzoeken, IKAW, Essen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Romeins:"})," Romeinse wegen, Romeinse Forten met historische info, Limesweg"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Prehistorie:"})," Hunebedden, Grafheuvels, Terpen, Paleokaarten (7 periodes)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Militair:"})," WWII Bunkers, Slagvelden, Vliegvelden, Verdedigingslinies"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Erfgoed:"})," Rijksmonumenten, Kastelen, Runes, Religieus Erfgoed"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Terrein:"})," Veengebieden, Geomorfologie, Bodemkaart"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Percelen:"})," Gewaspercelen (met bouwplantoelichting), Kadastrale Grenzen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Recreatie:"})," Parken, Musea, Kringloopwinkels, Strandjes, Wandelroutes"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Provinciaal:"})," Relictenkaart, Scheepswrakken, Verdronken Dorpen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"UIKAV:"})," Uiterwaard data, Expert advies, Vlakken, Punten, Bufferlagen"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Jle,{size:16,className:"text-purple-600"}),"Mineralen & Fossielen"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Mineralen hotspots:"})," Vindplaatsen uit Mindat.org met mineralenlijst"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Goudrivieren:"})," Bekende locaties voor goud zoeken"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Fossiel hotspots:"})," Vindplaatsen met fossieltypen en periodes"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Premium lagen:"})," Gedetailleerde data (beschikbaar met account)"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Hle,{size:16,className:"text-orange-600"}),"Mijn Lagen"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Eigen lagen:"})," Maak lagen voor vakantie, projecten, etc."]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Toevoegen:"})," Tik op + in popup om monument/locatie aan laag toe te voegen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Polygonen:"})," Hele monumentgebieden worden opgeslagen, niet alleen een punt"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Originele info:"})," Popup content blijft behouden"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Kleuren:"})," Elke laag krijgt eigen kleur (aanpasbaar)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Import:"})," Laad GeoJSON, KML of GPX bestanden"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Export:"})," Exporteer lagen als GeoJSON"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(yR,{size:16,className:"text-green-600"}),"Google Cloud Sync"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Inloggen:"})," Via hamburger menu rechtsboven"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Synchronisatie:"})," Lagen en vondsten automatisch naar cloud"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Meerdere apparaten:"})," Altijd toegang tot je data"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Veilig:"})," Alleen jij hebt toegang tot je gegevens"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(CI,{size:16,className:"text-green-600"}),"GPS & Navigatie"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsx("li",{children:"Live GPS tracking met nauwkeurigheidscirkel"}),f.jsx("li",{children:"Richtingspijl draait mee met je telefoon"}),f.jsx("li",{children:"Kaart handmatig draaien + kompasknop naar noorden"}),f.jsx("li",{children:"Schaalbalk onderaan (aan/uit in Instellingen)"}),f.jsx("li",{children:"Open locatie in Google Maps vanuit popup"}),f.jsx("li",{children:"Zoekbalk voor adressen en plaatsen"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Ua,{size:16,className:"text-orange-600"}),"Vondsten"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsx("li",{children:"Toevoegen via GPS locatie, long-press of handmatig"}),f.jsx("li",{children:"Velden: type, materiaal, periode, diepte, conditie, gewicht"}),f.jsx("li",{children:"Foto's toevoegen (link of upload)"}),f.jsx("li",{children:"Export: Excel, CSV, GeoJSON, GPX, KML"}),f.jsx("li",{children:"Dashboard met statistieken"}),f.jsx("li",{children:"Cloud sync met Google account"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(_o,{size:16,className:"text-purple-600"}),"Presets"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Standaard:"})," Detectie, Steentijd, Romeins, Middeleeuwen, WOII, Analyse, Fossielen, Mineralen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Aanpasbaar:"})," Overschrijf preset met huidige lagen (diskette-icoon)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Eigen presets:"})," Maak nieuwe via Instellingen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Tekstgrootte:"})," Aanpasbaar per panel via slider"]})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(_ce,{size:16,className:"text-cyan-600"}),"Perceelinformatie"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsx("li",{children:"Kadastrale aanduiding (gemeente, sectie, nummer)"}),f.jsx("li",{children:"Oppervlakte in m en hectare"}),f.jsx("li",{children:"Gewas en bouwplan met uitleg"}),f.jsx("li",{children:"Bodemtype met beschrijving"}),f.jsx("li",{children:"AHN hoogte in meters NAP"}),f.jsx("li",{children:"Hoogtekaart per perceel (bergje-icoon)"}),f.jsx("li",{children:"Link naar eigenaar opzoeken (Kadaster)"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Kce,{size:16,className:"text-red-600"}),"Monumenten & Erfgoed"]}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"AMK:"})," Archeologische Monumenten per periode"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Romeinse Forten:"})," Uitgebreide historische info per fort"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Rijksmonumenten:"})," Met bescherming en historie"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Verdedigingswerken:"})," Linies, forten, schansen"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Popup info:"})," Directe uitleg over archeologische waarde"]})]})]})]})}function ETe(){return f.jsxs(f.Fragment,{children:[f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),f.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[f.jsxs("li",{children:["Tik op de ",f.jsx("strong",{children:"GPS knop"})," (rechtsonder, oranje) om je locatie te zien"]}),f.jsxs("li",{children:["Kies een ",f.jsx("strong",{children:"preset"})," (linksonder, laagjes-icoon) voor een snelle start"]}),f.jsxs("li",{children:["Of open ",f.jsx("strong",{children:"Kaartlagen"})," om individuele lagen aan te zetten"]}),f.jsx("li",{children:"Tik op objecten op de kaart voor gedetailleerde informatie"})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Hamburger Menu"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsx("p",{children:"Rechtsboven vind je het menu met:"}),f.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Google Login:"})," Synchroniseer je data naar de cloud"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Vondst toevoegen:"})," Registreer een nieuwe vondst"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Info & Handleiding:"})," Dit scherm"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Instellingen:"})," Presets, export, weergave"]})]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"GPS & Navigatie"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"GPS knop (oranje):"})," Aan/uit toggle voor locatie tracking."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Richtingspijl:"})," Blauwe pijl toont de richting van je telefoon."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Kaart draaien:"})," Met twee vingers of via kompas."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Kompasknop:"})," Verschijnt rechtsboven als kaart gedraaid is. Tik om naar noorden te draaien."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Google Maps:"})," Vanuit elke popup kun je direct navigeren."]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Locaties opslaan in Mijn Lagen"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 1:"})," Tik op een object op de kaart (monument, bunker, etc.)"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 2:"})," Tik op de ",f.jsx("strong",{children:"oranje +"})," knop in de popup header"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 3:"})," Kies een bestaande laag of maak een nieuwe aan"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Resultaat:"})," De locatie inclusief vorm (polygoon) en info wordt opgeslagen!"]}),f.jsx("p",{className:"text-gray-500 italic",children:"Tip: Maak lagen voor vakantiebestemmingen, projecten of interessante locaties."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vondst registreren"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Via GPS:"})," Open menu  Vondst toevoegen. Je locatie wordt automatisch ingevuld."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Via long-press:"}),' Houd je vinger op de kaart  kies "Vondst toevoegen".']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Handmatig:"}),' In het formulier  "Kies op kaart" voor exacte locatie.']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Foto's:"})," Voeg foto-links toe of upload direct."]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Presets gebruiken"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Toepassen:"})," Linksonder  preset kiezen."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Aanpassen:"})," Zet gewenste lagen aan  tik diskette-icoon naast preset."]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Nieuw maken:"}),' Instellingen  Presets  "Huidige lagen opslaan".']})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Cloud Sync instellen"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 1:"})," Open hamburger menu rechtsboven"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 2:"}),' Tik op "Inloggen met Google"']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 3:"})," Kies je Google account"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Klaar!"})," Je lagen en vondsten worden automatisch gesynchroniseerd."]}),f.jsx("p",{className:"text-gray-500 italic",children:"Je data is veilig en alleen voor jou toegankelijk."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Lagen importeren"}),f.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 1:"})," Ga naar Instellingen (hamburger menu)"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 2:"}),' Scroll naar "Lagen importeren"']}),f.jsxs("p",{children:[f.jsx("strong",{children:"Stap 3:"})," Kies een GeoJSON, KML of GPX bestand"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Resultaat:"})," Nieuwe laag met je geimporteerde data!"]}),f.jsx("p",{className:"text-gray-500 italic",children:"Handig voor routes, waypoints of eigen datasets."})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor detectie"}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[f.jsxs("li",{children:["Gebruik ",f.jsx("strong",{children:"AHN Hillshade"})," om relif te zien (grafheuvels, wallen)"]}),f.jsxs("li",{children:["Combineer ",f.jsx("strong",{children:"AMK"})," met ",f.jsx("strong",{children:"Gewaspercelen"})," voor slimme zoeklocaties"]}),f.jsxs("li",{children:["Check ",f.jsx("strong",{children:"IKAW"})," voor archeologische verwachting"]}),f.jsxs("li",{children:["Gebruik ",f.jsx("strong",{children:"historische kaarten"})," (TMK 1850) om oude structuren te vinden"]}),f.jsxs("li",{children:["Bekijk ",f.jsx("strong",{children:"Archeo Onderzoeken"})," voor eerdere vondsten in het gebied"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Bodemkaart"})," toont of grond geschikt is (popup legt uit)"]})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor fossielen"}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[f.jsxs("li",{children:["Zet ",f.jsx("strong",{children:"Fossiel hotspots"})," aan voor bekende vindplaatsen"]}),f.jsxs("li",{children:["Bekijk ",f.jsx("strong",{children:"Paleokaarten"})," voor historische kustlijnen"]}),f.jsxs("li",{children:["Check ",f.jsx("strong",{children:"Geomorfologie"})," voor oude zeebodems en rivieren"]}),f.jsx("li",{children:"Popup toont welke fossielen op elke locatie gevonden zijn"})]})]}),f.jsxs("section",{children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor mineralen"}),f.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[f.jsxs("li",{children:["Zet ",f.jsx("strong",{children:"Mineralen hotspots"})," aan voor vindplaatsen"]}),f.jsxs("li",{children:["Bekijk ",f.jsx("strong",{children:"Goudrivieren"})," voor goudzoekmogelijkheden"]}),f.jsx("li",{children:"Popup toont welke mineralen op elke locatie voorkomen"}),f.jsx("li",{children:"Links naar Mindat.org voor gedetailleerde info"})]})]}),f.jsxs("section",{children:[f.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[f.jsx(Au,{size:16,className:"text-blue-600"}),"Handige links"]}),f.jsxs("ul",{className:"text-gray-600 space-y-2 text-xs",children:[f.jsxs("li",{children:[f.jsx("a",{href:"https://legendageomorfologie.wur.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Geomorfologie legenda (WUR)"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Uitgebreide uitleg over landvormen"})]}),f.jsxs("li",{children:[f.jsx("a",{href:"https://legenda-bodemkaart.bodemdata.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Bodemkaart legenda (BRO)"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Volledige bodemclassificatie"})]}),f.jsxs("li",{children:[f.jsx("a",{href:"https://www.mindat.org/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Mindat.org - Mineralen database"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Wereldwijde mineralen informatie"})]}),f.jsxs("li",{children:[f.jsx("a",{href:"https://www.cultureelerfgoed.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Rijksdienst voor Cultureel Erfgoed"}),f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Officile monumenten informatie"})]})]})]})]})}function $G(n,e,t,r){const s=(r-e)*Math.PI/180,a=(t-n)*Math.PI/180,o=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function VT(n){let e=0;for(let t=1;t<n.length;t++)e+=$G(n[t-1].coordinates[0],n[t-1].coordinates[1],n[t].coordinates[0],n[t].coordinates[1]);return e}const Eo=bs()(pc((n,e)=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[],visibleRouteIds:new Set,heatmapEnabled:!1,gridEnabled:!1,gridCenter:null,gridSize:20,gridCount:10,gridColor:"rgba(139, 92, 246, 0.6)",autoPauseEnabled:!1,autoPauseSeconds:120,startRecording:()=>{n({state:"recording",currentPoints:[],startTime:Date.now(),pauseStartTime:null,totalPausedTime:0})},pauseRecording:()=>{const{state:t}=e();t==="recording"&&n({state:"paused",pauseStartTime:Date.now()})},resumeRecording:()=>{const{state:t,pauseStartTime:r,totalPausedTime:i}=e();if(t!=="paused"||!r)return;const s=Date.now()-r;n({state:"recording",pauseStartTime:null,totalPausedTime:i+s})},stopRecording:t=>{const{state:r,currentPoints:i,startTime:s,totalPausedTime:a,pauseStartTime:o}=e();if(r==="idle"||!s||i.length<2)return n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0}),null;const l=Date.now();let c=a;o&&(c+=l-o);const h=l-s-c,g=VT(i),m={id:crypto.randomUUID(),name:t||`Route ${new Date().toLocaleDateString("nl-NL")} ${new Date().toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,points:i,startTime:s,endTime:l,totalDistance:g,totalDuration:h,pausedDuration:c,createdAt:new Date().toISOString()};return n(y=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[m,...y.savedRoutes]})),m},cancelRecording:()=>{n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0})},addPoint:(t,r,i)=>{const{state:s,currentPoints:a}=e();if(s!=="recording")return;if(a.length>0){const l=a[a.length-1];if($G(l.coordinates[0],l.coordinates[1],t,r)<2)return}const o={coordinates:[t,r],timestamp:Date.now(),accuracy:i};n({currentPoints:[...a,o]})},deleteRoute:t=>{n(r=>({savedRoutes:r.savedRoutes.filter(i=>i.id!==t)}))},renameRoute:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,name:r}:s)}))},clearAllRoutes:()=>{n({savedRoutes:[],visibleRouteIds:new Set})},toggleRouteVisibility:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.has(t)?i.delete(t):i.add(t),{visibleRouteIds:i}})},showRoute:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.add(t),{visibleRouteIds:i}})},hideRoute:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.delete(t),{visibleRouteIds:i}})},showAllRoutes:()=>{n(t=>({visibleRouteIds:new Set(t.savedRoutes.map(r=>r.id))}))},hideAllRoutes:()=>{n({visibleRouteIds:new Set})},toggleHeatmap:()=>{n(t=>({heatmapEnabled:!t.heatmapEnabled}))},setHeatmapEnabled:t=>{n({heatmapEnabled:t})},toggleGrid:()=>{n(t=>({gridEnabled:!t.gridEnabled}))},setGridEnabled:t=>{n({gridEnabled:t})},setGridCenter:t=>{n({gridCenter:t})},setGridSize:t=>{n({gridSize:t})},setGridCount:t=>{n({gridCount:t})},setGridColor:t=>{n({gridColor:t})},centerGridOnCurrentLocation:()=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(t=>{n({gridCenter:[t.coords.longitude,t.coords.latitude],gridEnabled:!0})},t=>{console.error("Could not get location:",t)})},setAutoPauseEnabled:t=>{n({autoPauseEnabled:t})},setAutoPauseSeconds:t=>{n({autoPauseSeconds:t})},importRouteFromGPX:(t,r)=>{try{const s=new DOMParser().parseFromString(t,"application/xml");if(s.querySelector("parsererror"))return{success:!1,error:"Ongeldig XML formaat"};const o=s.querySelectorAll("trkpt");if(o.length<2&&s.querySelectorAll("wpt").length<2)return{success:!1,error:"Geen route punten gevonden in GPX bestand"};const l=[];if((o.length>0?o:s.querySelectorAll("wpt")).forEach(E=>{const T=parseFloat(E.getAttribute("lat")||"0"),b=parseFloat(E.getAttribute("lon")||"0"),R=E.querySelector("time"),N=R?new Date(R.textContent||"").getTime():Date.now();!isNaN(T)&&!isNaN(b)&&l.push({coordinates:[b,T],timestamp:isNaN(N)?Date.now():N})}),l.length<2)return{success:!1,error:"Niet genoeg geldige punten in GPX bestand"};const h=s.querySelector("trk > name")?.textContent||s.querySelector("metadata > name")?.textContent||r||`Import ${new Date().toLocaleDateString("nl-NL")}`,g=VT(l),m=l[0].timestamp,y=l[l.length-1].timestamp,v=y-m,_={id:crypto.randomUUID(),name:h,points:l,startTime:m,endTime:y,totalDistance:g,totalDuration:v>0?v:0,pausedDuration:0,createdAt:new Date().toISOString()};return n(E=>({savedRoutes:[_,...E.savedRoutes]})),{success:!0,routeId:_.id}}catch(i){return console.error("GPX import error:",i),{success:!1,error:"Fout bij importeren van GPX bestand"}}},updateRouteNotes:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,notes:r}:s)}))},addPhotoToRoute:(t,r)=>{const i={...r,id:crypto.randomUUID(),timestamp:new Date().toISOString()};n(s=>({savedRoutes:s.savedRoutes.map(a=>a.id===t?{...a,photos:[...a.photos||[],i]}:a)}))},removePhotoFromRoute:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,photos:(s.photos||[]).filter(a=>a.id!==r)}:s)}))},getCurrentDistance:()=>{const{currentPoints:t}=e();return VT(t)},getCurrentDuration:()=>{const{state:t,startTime:r,totalPausedTime:i,pauseStartTime:s}=e();if(!r)return 0;const a=Date.now();let o=i;return t==="paused"&&s&&(o+=a-s),a-r-o},getAverageSpeed:()=>{const t=e().getCurrentDistance(),r=e().getCurrentDuration();return r===0?0:t/1e3/(r/36e5)}}),{name:"detectorapp-route-recording",version:2,partialize:n=>({savedRoutes:n.savedRoutes,visibleRouteIds:Array.from(n.visibleRouteIds),heatmapEnabled:n.heatmapEnabled,gridEnabled:n.gridEnabled,gridCenter:n.gridCenter,gridSize:n.gridSize,gridCount:n.gridCount,gridColor:n.gridColor,autoPauseEnabled:n.autoPauseEnabled,autoPauseSeconds:n.autoPauseSeconds}),merge:(n,e)=>({...e,...n,visibleRouteIds:new Set(n?.visibleRouteIds||[])})}));function WG(n){const e=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL"
  xmlns="http://www.topografix.com/GPX/1/1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">
  <metadata>
    <name>${n.name}</name>
    <time>${new Date(n.startTime).toISOString()}</time>
  </metadata>
  <trk>
    <name>${n.name}</name>
    <trkseg>
${n.points.map(s=>`      <trkpt lat="${s.coordinates[1]}" lon="${s.coordinates[0]}">
        <time>${new Date(s.timestamp).toISOString()}</time>
      </trkpt>`).join(`
`)}
    </trkseg>
  </trk>
</gpx>`,t=new Blob([e],{type:"application/gpx+xml"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=`${n.name.replace(/[^a-zA-Z0-9]/g,"-")}.gpx`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}let xu=null,hp=null;function HG(){if(typeof window>"u"||!("speechSynthesis"in window))return!1;xu=window.speechSynthesis;const n=()=>{const e=xu?.getVoices()||[];hp=e.find(t=>t.lang.startsWith("nl")||t.name.toLowerCase().includes("dutch")||t.name.toLowerCase().includes("nederland"))||null,!hp&&e.length>0&&(hp=e[0])};return n(),xu&&(xu.onvoiceschanged=n),!0}function STe(n,e){if(!xu&&!HG()||!xu)return;xu.cancel();const t=new SpeechSynthesisUtterance(n);hp&&(t.voice=hp),t.lang="nl-NL",t.rate=e?.rate,t.pitch=e?.pitch??1,t.volume=e?.volume??1,xu.speak(t)}function TTe(n){const e=[];e.push(`${n.type} toegevoegd`),n.material&&n.material!=="Onbekend"&&e.push(`Materiaal: ${n.material}`),n.period&&n.period!=="Onbekend"&&e.push(`Periode: ${n.period}`),n.layerName&&n.layerName!=="Vondsten"&&e.push(`Opgeslagen in ${n.layerName}`);const t=e.join(". ");STe(t,{rate:1.1})}HG();function BT({label:n,value:e,onChange:t,options:r,required:i=!1,placeholder:s="Typ hier..."}){const[a,o]=X.useState(!1),[l,c]=X.useState(!1),[h,g]=X.useState(""),m=e&&!r.includes(e),y=()=>{c(!0),g(m?e:""),o(!1)},v=()=>{h.trim()&&t(h.trim()),c(!1)};return l?f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&f.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),f.jsx("input",{type:"text",value:h,onChange:_=>g(_.target.value),onKeyDown:_=>{_.key==="Enter"&&(_.preventDefault(),v()),_.key==="Escape"&&c(!1)},onBlur:v,placeholder:s,autoFocus:!0,className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}):f.jsxs("div",{className:"relative",children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&f.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),f.jsxs("button",{type:"button",onClick:()=>o(!a),className:"w-full flex items-center justify-between px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-left",style:{border:"none",outline:"none"},children:[f.jsxs("span",{className:e?"":"text-gray-400",children:[e||"Selecteer...",m&&f.jsx(PO,{size:12,className:"inline ml-1 text-orange-500"})]}),f.jsx(_E,{size:16,className:`text-gray-400 transition-transform ${a?"rotate-180":""}`})]}),a&&f.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[f.jsxs("button",{type:"button",onClick:y,className:"w-full px-3 py-2 text-left text-sm text-orange-600 hover:bg-orange-50 transition-colors flex items-center gap-2",style:{border:"none",outline:"none"},children:[f.jsx(PO,{size:12}),"Eigen invoer..."]}),f.jsx("div",{className:"border-t border-gray-100"}),r.map(_=>f.jsx("button",{type:"button",onClick:()=>{t(_),o(!1)},className:`w-full px-3 py-2 text-left text-sm transition-colors ${_===e?"bg-orange-50 text-orange-600":"text-gray-600 hover:bg-gray-50"}`,style:{border:"none",outline:"none"},children:_},_))]})]})}function KG({onClose:n,initialLocation:e}){const t=xs(Be=>Be.position),r=pi(Be=>Be.map),i=wr(Be=>Be.vondstFormPhoto),s=us(Be=>Be.layers),a=us(Be=>Be.addPoint),o=ur(Be=>Be.voiceFeedbackEnabled),l=Eo(Be=>Be.state),c=Eo(Be=>Be.startTime);Eo(Be=>Be.savedRoutes);const h=()=>l==="idle"||!c?null:`Route ${new Date(c).toLocaleDateString("nl-NL")} ${new Date(c).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,g=l==="recording"||l==="paused",m=h(),[y,v]=X.useState(""),[_,E]=X.useState(""),[T,b]=X.useState(""),[R,N]=X.useState(""),[D,W]=X.useState(!1),[I,A]=X.useState(void 0),[M,O]=X.useState(void 0),[L,z]=X.useState(oo),[j,Ee]=X.useState(i),[Ce,Ge]=X.useState(null);X.useEffect(()=>{if(j){const Be=URL.createObjectURL(j);return Ge(Be),()=>URL.revokeObjectURL(Be)}else Ge(null)},[j]);const[Le,ce]=X.useState(e?"map-pick":t?"gps":"map-center"),[Me,Te]=X.useState(e||null),[ie,V]=X.useState(!1),Z=()=>{if(Le==="gps"&&t)return{lat:t.lat,lng:t.lng};if(Le==="map-pick"&&Me)return Me;if(r){const Be=r.getView().getCenter();if(Be){const[It,Wt]=En(Be);return{lat:Wt,lng:It}}}return null},te=Z();X.useEffect(()=>{if(!ie||!r)return;const Be=It=>{const[Wt,Dt]=En(It.coordinate);Te({lat:Dt,lng:Wt}),ce("map-pick"),V(!1)};return r.on("click",Be),()=>r.un("click",Be)},[ie,r]);const se=()=>V(!0),he=()=>{t&&(ce("gps"),Te(null))},Ae=()=>{const Be=document.createElement("input");Be.type="file",Be.accept="image/*",Be.capture="environment",Be.onchange=It=>{const Wt=It.target.files?.[0];Wt&&Ee(Wt)},Be.click()},Fe=()=>Ee(null),de=async Be=>{Be.preventDefault();const It=Z();if(!It){alert("Geen locatie beschikbaar");return}if(!_){alert("Vul een naam/type in");return}W(!0);try{let Wt=y||"";if(L===oo){const Zt=[];T&&Zt.push(`Materiaal: ${T}`),R&&Zt.push(`Periode: ${R}`),I&&Zt.push(`Gewicht: ${I}g`),M&&Zt.push(`Lengte: ${M}mm`),Zt.length>0&&(Wt=Zt.join(" | ")+(y?` | ${y}`:""))}a(L,{coordinates:[It.lng,It.lat],name:_,category:L===oo?_:"Overig",notes:Wt||"",...g&&c?{routeId:`recording-${c}`,routeName:m||void 0}:{}});const Dt=s.find(Zt=>Zt.id===L)?.name||"Vondsten";o&&TTe({type:_,material:T||void 0,period:R||void 0,layerName:Dt}),alert(`Toegevoegd aan ${Dt}! `),n()}catch(Wt){alert("Fout bij opslaan: "+Wt.message)}finally{W(!1)}},Pe=X.useMemo(()=>s.map(Be=>({id:Be.id,name:Be.name,color:Be.color})),[s]);return ie?f.jsx(bt.div,{className:"fixed bottom-0 left-0 right-0 z-[2000] p-4",initial:{y:100},animate:{y:0},exit:{y:100},children:f.jsxs("div",{className:"bg-orange-500 text-white rounded-xl shadow-xl p-4 flex items-center justify-between max-w-md mx-auto",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Pv,{size:24,className:"animate-pulse"}),f.jsxs("div",{children:[f.jsx("div",{className:"font-medium",children:"Tik op de kaart"}),f.jsx("div",{className:"text-sm opacity-90",children:"om locatie te kiezen"})]})]}),f.jsx("button",{onClick:()=>V(!1),className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"})]})}):f.jsx(bt.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:f.jsxs(bt.div,{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[f.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white px-5 py-4 flex justify-between items-center flex-shrink-0",children:[f.jsx("h2",{className:"text-lg font-semibold",children:"Nieuwe Vondst"}),f.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:f.jsx(ii,{size:20})})]}),f.jsxs("form",{onSubmit:de,className:"flex-1 overflow-y-auto",children:[f.jsxs("div",{className:"p-5 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto"}),Ce?f.jsxs("div",{className:"relative",children:[f.jsx("img",{src:Ce,alt:"Vondst",className:"w-full h-40 object-cover rounded-xl"}),f.jsx("button",{type:"button",onClick:Fe,className:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors border-0 outline-none shadow-lg",children:f.jsx(yc,{size:16})})]}):f.jsxs("button",{type:"button",onClick:Ae,className:"w-full h-32 bg-gray-50 rounded-xl flex flex-col items-center justify-center gap-2 hover:bg-gray-100 transition-colors text-gray-500 border-2 border-dashed border-gray-200",style:{outline:"none"},children:[f.jsx(xE,{size:32}),f.jsx("span",{className:"text-sm",children:"Maak een foto"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Locatie"}),te&&f.jsxs("div",{className:"bg-orange-50 rounded-xl px-4 py-3 mb-2",children:[f.jsxs("div",{className:"text-sm text-orange-800 font-mono",children:[te.lat.toFixed(6),"N, ",te.lng.toFixed(6),"E"]}),f.jsx("div",{className:"text-xs text-orange-600 mt-1",children:Le==="gps"?" GPS locatie":Le==="map-pick"?" Gekozen op kaart":" Kaart midden"})]}),!te&&f.jsx("div",{className:"bg-red-50 rounded-xl px-4 py-3 mb-2",children:f.jsx("div",{className:"text-sm text-red-600",children:"Geen locatie beschikbaar"})}),f.jsxs("div",{className:"flex gap-2",children:[t&&Le!=="gps"&&f.jsxs("button",{type:"button",onClick:he,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors border-0 outline-none",children:[f.jsx(CI,{size:16}),"GPS"]}),f.jsxs("button",{type:"button",onClick:se,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors border-0 outline-none",children:[f.jsx(Pv,{size:16}),"Kies op kaart"]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opslaan naar"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:Pe.map(Be=>f.jsx("button",{type:"button",onClick:()=>z(Be.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all border-0 outline-none ${L===Be.id?"bg-gray-800 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:Be.name},Be.id))})]}),L===oo&&f.jsx(BT,{label:"Type vondst",value:_,onChange:E,options:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],required:!0,placeholder:"Typ type vondst..."}),L!==oo&&f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Naam",f.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),f.jsx("input",{type:"text",value:_,onChange:Be=>E(Be.target.value),placeholder:"Naam van het punt...",className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}),L===oo&&f.jsxs(f.Fragment,{children:[f.jsx(BT,{label:"Materiaal",value:T,onChange:b,options:["Brons","IJzer","Zilver","Goud","Koper","Lood","Tin","Keramiek","Steen","Glas","Bot","Hout","Leer","Onbekend"],placeholder:"Typ materiaal..."}),f.jsx(BT,{label:"Periode",value:R,onChange:N,options:["Steentijd","Bronstijd","IJzertijd","Romeins","Middeleeuws","Nieuwetijd","Modern","Onbekend"],placeholder:"Typ periode..."}),f.jsxs("div",{className:"flex gap-3",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Gewicht (g)"}),f.jsx("input",{type:"number",value:I??"",onChange:Be=>A(Be.target.value?parseFloat(Be.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]}),f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Lengte (mm)"}),f.jsx("input",{type:"number",value:M??"",onChange:Be=>O(Be.target.value?parseFloat(Be.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Notities"}),f.jsx("textarea",{value:y,onChange:Be=>v(Be.target.value),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all resize-none h-20",style:{border:"none",outline:"none"},placeholder:"Beschrijving, context, vindplaats details..."})]}),f.jsx("div",{className:"rounded-xl px-4 py-3 bg-orange-50",children:f.jsx("p",{className:"text-sm text-orange-700",children:' Opgeslagen in "Mijn Lagen" op dit apparaat'})})]}),f.jsxs("div",{className:"p-5 pt-0 flex gap-3",children:[f.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors font-medium border-0 outline-none",children:"Annuleren"}),f.jsx("button",{type:"submit",disabled:D||!te||ie||!_,className:"flex-1 px-4 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium border-0 outline-none",children:D?"Opslaan...":"Opslaan"})]})]})]})})}function bTe(){const{user:n,setUser:e,setLoading:t}=hE();return X.useEffect(()=>{const s=Fj(Uh,a=>{e(a),t(!1)});return()=>s()},[e,t]),{user:n,loginAnonymous:async()=>{try{await zZ(Uh)}catch(s){console.error("Login failed:",s)}},logout:async()=>{try{await jj(Uh)}catch(s){console.error("Logout failed:",s)}},isAuthenticated:!!n}}function RTe(){const{isAuthenticated:n,loginAnonymous:e}=bTe(),t=ur(c=>c.vondstenLocalOnly),r=ur(c=>c.showVondstButton),i=wr(c=>c.vondstFormOpen),s=wr(c=>c.vondstFormLocation),a=wr(c=>c.openVondstForm),o=wr(c=>c.closeVondstForm);if(!r)return null;const l=()=>{if(t){a();return}if(!n){confirm("Je moet ingelogd zijn om vondsten in de cloud op te slaan. Anoniem inloggen?")&&e();return}a()};return f.jsxs(f.Fragment,{children:[f.jsx(bt.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:l,title:"Vondst toevoegen",children:f.jsx(Ua,{size:22,strokeWidth:2})}),f.jsx(Un,{children:i&&f.jsx(KG,{onClose:o,initialLocation:s||void 0})})]})}function ATe(){const n=ur(Ae=>Ae.showRouteRecordButton),e=wr(Ae=>Ae.toggleRouteDashboard),{state:t,startRecording:r,pauseRecording:i,resumeRecording:s,stopRecording:a,cancelRecording:o,addPoint:l,getCurrentDistance:c,getCurrentDuration:h,getAverageSpeed:g,currentPoints:m,savedRoutes:y,autoPauseEnabled:v,autoPauseSeconds:_}=Eo(),[E,T]=X.useState(!1),[b,R]=X.useState(""),[N,D]=X.useState(!1),[W,I]=X.useState(!1),A=X.useRef(null),M=X.useRef(null),O=X.useRef(null),L=Ae=>{const Fe=Math.floor(Ae/1e3),de=Math.floor(Fe/3600),Pe=Math.floor(Fe%3600/60),Be=Fe%60;return de>0?`${de}:${Pe.toString().padStart(2,"0")}:${Be.toString().padStart(2,"0")}`:`${Pe}:${Be.toString().padStart(2,"0")}`},z=Ae=>Ae<1e3?`${Math.round(Ae)} m`:`${(Ae/1e3).toFixed(2)} km`,j=Ae=>`${Ae.toFixed(1)} km/h`,Ee=(Ae,Fe,de,Pe)=>{const It=(Pe-Fe)*Math.PI/180,Wt=(de-Ae)*Math.PI/180,Dt=Math.sin(It/2)*Math.sin(It/2)+Math.cos(Fe*Math.PI/180)*Math.cos(Pe*Math.PI/180)*Math.sin(Wt/2)*Math.sin(Wt/2);return 6371e3*(2*Math.atan2(Math.sqrt(Dt),Math.sqrt(1-Dt)))};if(X.useEffect(()=>(t==="recording"?(I(!1),"geolocation"in navigator&&A.current===null&&(A.current=navigator.geolocation.watchPosition(Ae=>{const Fe=Ae.coords.longitude,de=Ae.coords.latitude,Pe=Date.now();l(Fe,de,Ae.coords.accuracy),v&&M.current?Ee(M.current.lon,M.current.lat,Fe,de)>3?(M.current={lon:Fe,lat:de,time:Pe},O.current&&(clearTimeout(O.current),O.current=null)):Pe-M.current.time>=_*1e3&&(i(),I(!0),M.current=null):M.current={lon:Fe,lat:de,time:Pe}},Ae=>{console.error("GPS error:",Ae)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:1e3}))):(A.current!==null&&(navigator.geolocation.clearWatch(A.current),A.current=null),O.current&&(clearTimeout(O.current),O.current=null)),()=>{A.current!==null&&(navigator.geolocation.clearWatch(A.current),A.current=null),O.current&&(clearTimeout(O.current),O.current=null)}),[t,l,v,_,i]),!n)return null;const Ce=()=>{r(),D(!0)},Ge=()=>{i()},Le=()=>{s()},ce=()=>{R(`Route ${new Date().toLocaleDateString("nl-NL")}`),T(!0)},Me=()=>{const Ae=a(b);T(!1),D(!1),R(""),Ae&&confirm(`Route "${Ae.name}" opgeslagen! (${z(Ae.totalDistance)})

Direct exporteren als GPX?`)&&WG(Ae)},Te=()=>{m.length>2&&!confirm("Weet je zeker dat je de opname wilt annuleren? De route wordt niet opgeslagen.")||(o(),T(!1),D(!1))},ie=c(),V=h(),Z=g(),te=Ae=>{switch(Ae){case"recording":return"bg-red-500 hover:bg-red-600";case"paused":return"bg-yellow-500 hover:bg-yellow-600";default:return"bg-purple-500 hover:bg-purple-600"}},se=Ae=>{switch(Ae){case"recording":return f.jsx(Ece,{size:22,strokeWidth:2});case"paused":return f.jsx(Ice,{size:22,strokeWidth:2});default:return f.jsx(Ov,{size:22,strokeWidth:2})}},he=()=>{switch(t){case"idle":Ce();break;case"recording":Ge();break;case"paused":Le();break}};return f.jsxs(f.Fragment,{children:[f.jsxs(bt.button,{className:`fixed bottom-2 right-[114px] z-[1000] w-11 h-11 ${te(t)} text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm`,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:he,title:t==="idle"?"Route opnemen":t==="recording"?"Pauzeren":"Hervatten",children:[se(t),t==="recording"&&f.jsx(bt.div,{className:"absolute inset-0 rounded-xl bg-red-400",animate:{opacity:[.5,0,.5]},transition:{duration:1.5,repeat:1/0}})]}),f.jsx(Un,{children:t==="idle"&&y.length>0&&f.jsxs(bt.button,{className:"fixed bottom-2 right-[168px] z-[1000] w-11 h-11 bg-purple-400 hover:bg-purple-500 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none",initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:e,title:`Mijn routes (${y.length})`,children:[f.jsx(eV,{size:18,strokeWidth:2}),f.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-white text-purple-600 text-xs font-bold rounded-full flex items-center justify-center shadow-sm",children:y.length})]})}),f.jsx(Un,{children:(t==="recording"||t==="paused")&&f.jsx(bt.button,{className:"fixed bottom-2 right-[168px] z-[1000] w-11 h-11 bg-gray-700 hover:bg-gray-800 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none",initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:ce,title:"Stoppen en opslaan",children:f.jsx(tue,{size:18,strokeWidth:2,fill:"currentColor"})})}),f.jsx(Un,{children:N&&t!=="idle"&&f.jsxs(bt.div,{className:"fixed bottom-16 right-2 z-[999] bg-white/95 backdrop-blur-sm rounded-xl shadow-lg p-3 min-w-[180px]",initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:t==="recording"?" Opname":W?" Auto-pauze":" Gepauzeerd"}),f.jsx("button",{onClick:()=>D(!1),className:"p-0.5 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:f.jsx(ii,{size:14})})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Xp,{size:16,className:"text-purple-500"}),f.jsx("span",{className:"text-lg font-semibold text-gray-800",children:z(ie)})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Cv,{size:16,className:"text-blue-500"}),f.jsx(kTe,{duration:V,recordingState:t,formatTime:L})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Yle,{size:16,className:"text-green-500"}),f.jsx("span",{className:"text-sm text-gray-600",children:j(Z)})]}),f.jsxs("div",{className:"text-xs text-gray-400 pt-1 border-t border-gray-100",children:[m.length," punten opgenomen"]})]})]})}),f.jsx(Un,{children:E&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[1500] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>T(!1)}),f.jsxs(bt.div,{className:"fixed left-4 right-4 top-1/2 z-[1501] bg-white rounded-xl shadow-2xl p-4 max-w-sm mx-auto",initial:{opacity:0,scale:.9,y:"-40%"},animate:{opacity:1,scale:1,y:"-50%"},exit:{opacity:0,scale:.9,y:"-40%"},children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Route opslaan"}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 space-y-1",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Afstand:"}),f.jsx("span",{className:"font-medium",children:z(ie)})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Duur:"}),f.jsx("span",{className:"font-medium",children:L(V)})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Gem. snelheid:"}),f.jsx("span",{className:"font-medium",children:j(Z)})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Punten:"}),f.jsx("span",{className:"font-medium",children:m.length})]})]}),f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de route"}),f.jsx("input",{type:"text",value:b,onChange:Ae=>R(Ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Route naam...",autoFocus:!0})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:Te,className:"flex-1 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"}),f.jsxs("button",{onClick:Me,disabled:m.length<2,className:"flex-1 px-4 py-2 bg-purple-500 hover:bg-purple-600 disabled:bg-gray-300 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[f.jsx(rV,{size:16}),"Opslaan"]})]}),m.length<2&&f.jsx("p",{className:"text-xs text-red-500 text-center mt-2",children:"Minimaal 2 punten nodig om op te slaan"})]})]})})]})}function kTe({duration:n,recordingState:e,formatTime:t}){const[r,i]=X.useState(n);return X.useEffect(()=>{if(e!=="recording"){i(n);return}const s=setInterval(()=>{i(a=>a+1e3)},1e3);return()=>clearInterval(s)},[e,n]),X.useEffect(()=>{i(n)},[n]),f.jsx("span",{className:"text-lg font-semibold text-gray-800",children:t(r)})}function ITe(){const n=pi(s=>s.map),{currentPoints:e,state:t}=Eo(),r=X.useRef(null),i=X.useRef(null);return X.useEffect(()=>{if(!n)return;const s=new dc;i.current=s;const a=new $u({source:s,zIndex:999,properties:{name:"route-recording-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),X.useEffect(()=>{if(!i.current||(i.current.clear(),t==="idle"||e.length===0))return;const s=e.map(a=>kr(a.coordinates));if(s.length>=2){const a=new _r({geometry:new Ti(s)});a.setStyle(new mn({stroke:new qn({color:t==="paused"?"rgba(234, 179, 8, 0.8)":"rgba(168, 85, 247, 0.8)",width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(a)}if(s.length>=1){const a=new _r({geometry:new gi(s[0])});a.setStyle(new mn({image:new Us({radius:8,fill:new tr({color:"rgba(34, 197, 94, 1)"}),stroke:new qn({color:"white",width:2})})})),i.current.addFeature(a)}if(s.length>=1){const a=new _r({geometry:new gi(s[s.length-1])});a.setStyle(new mn({image:new Us({radius:6,fill:new tr({color:t==="paused"?"rgba(234, 179, 8, 1)":"rgba(168, 85, 247, 1)"}),stroke:new qn({color:"white",width:2})})})),i.current.addFeature(a)}},[e,t]),null}const q5=["#a855f7","#3b82f6","#22c55e","#f97316","#ec4899","#14b8a6","#eab308","#8b5cf6"];function CTe(){const n=pi(s=>s.map),{savedRoutes:e,visibleRouteIds:t}=Eo(),r=X.useRef(null),i=X.useRef(null);return X.useEffect(()=>{if(!n)return;const s=new dc;i.current=s;const a=new $u({source:s,zIndex:998,properties:{name:"saved-routes-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),X.useEffect(()=>{if(!i.current)return;i.current.clear(),e.filter(a=>t.has(a.id)).forEach((a,o)=>{const l=q5[o%q5.length],c=a.points.map(_=>kr(_.coordinates));if(c.length<2)return;const h=new _r({geometry:new Ti(c),routeId:a.id,routeName:a.name});h.setStyle(new mn({stroke:new qn({color:l,width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(h);const g=new _r({geometry:new gi(c[0]),routeId:a.id,type:"start"});g.setStyle(new mn({image:new Us({radius:8,fill:new tr({color:"#22c55e"}),stroke:new qn({color:"white",width:2})}),text:new yo({text:"S",font:"bold 10px sans-serif",fill:new tr({color:"white"}),offsetY:1})})),i.current.addFeature(g);const m=new _r({geometry:new gi(c[c.length-1]),routeId:a.id,type:"end"});m.setStyle(new mn({image:new Us({radius:8,fill:new tr({color:"#ef4444"}),stroke:new qn({color:"white",width:2})}),text:new yo({text:"E",font:"bold 10px sans-serif",fill:new tr({color:"white"}),offsetY:1})})),i.current.addFeature(m);const y=Math.floor(c.length/2),v=new _r({geometry:new gi(c[y]),routeId:a.id,type:"label"});v.setStyle(new mn({text:new yo({text:a.name,font:"12px sans-serif",fill:new tr({color:"#1f2937"}),stroke:new qn({color:"white",width:3}),offsetY:-15})})),i.current.addFeature(v)})},[e,t]),null}function PTe(){const n=pi(a=>a.map),{savedRoutes:e,visibleRouteIds:t,heatmapEnabled:r}=Eo(),i=X.useRef(null),s=X.useRef(null);return X.useEffect(()=>{if(!n)return;const a=new dc;s.current=a;const o=new DK({source:a,blur:15,radius:10,weight:()=>1,gradient:["#00f","#0ff","#0f0","#ff0","#f00"],opacity:.6,zIndex:90});return i.current=o,n.addLayer(o),()=>{n&&i.current&&n.removeLayer(i.current)}},[n]),X.useEffect(()=>{if(!s.current||!i.current)return;if(s.current.clear(),!r){i.current.setVisible(!1);return}const a=e.filter(l=>t.has(l.id)),o=[];for(const l of a)for(const c of l.points){const h=new _r({geometry:new gi(kr(c.coordinates))});o.push(h)}s.current.addFeatures(o),i.current.setVisible(o.length>0)},[e,t,r]),null}function MTe(n,e,t,r){const i=[],s=e/111e3,a=e/(111e3*Math.cos(n[1]*Math.PI/180)),o=Math.floor(t/2),l=n[0]-o*a,c=n[0]+o*a,h=n[1]-o*s,g=n[1]+o*s;for(let _=-o;_<=o;_++){const E=n[0]+_*a,T=[kr([E,h]),kr([E,g])],b=new _r({geometry:new Ti(T),type:"grid-line"});b.setStyle(new mn({stroke:new qn({color:r,width:_===0?2:1,lineDash:_===0?void 0:[5,5]})})),i.push(b)}for(let _=-o;_<=o;_++){const E=n[1]+_*s,T=[kr([l,E]),kr([c,E])],b=new _r({geometry:new Ti(T),type:"grid-line"});b.setStyle(new mn({stroke:new qn({color:r,width:_===0?2:1,lineDash:_===0?void 0:[5,5]})})),i.push(b)}const m="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let _=-o;_<o;_++)for(let E=-o;E<o;E++){const T=n[0]+(E+.5)*a,b=n[1]+(_+.5)*s,R=_+o,N=E+o;if(R>=0&&R<m.length){const D=`${m[R]}${N+1}`,W=new _r({geometry:new Ti([kr([T,b]),kr([T,b])]),type:"grid-label"});W.setStyle(new mn({text:new yo({text:D,font:"12px sans-serif",fill:new tr({color:r}),stroke:new qn({color:"rgba(255,255,255,0.8)",width:3})})})),i.push(W)}}const y=new _r({geometry:new Ti([kr([n[0]-a*.2,n[1]]),kr([n[0]+a*.2,n[1]])]),type:"grid-center"});y.setStyle(new mn({stroke:new qn({color:"#ef4444",width:3})})),i.push(y);const v=new _r({geometry:new Ti([kr([n[0],n[1]-s*.2]),kr([n[0],n[1]+s*.2])]),type:"grid-center"});return v.setStyle(new mn({stroke:new qn({color:"#ef4444",width:3})})),i.push(v),i}function NTe(){const n=pi(l=>l.map),{gridEnabled:e,gridCenter:t,gridSize:r,gridCount:i,gridColor:s}=Eo(),a=X.useRef(null),o=X.useRef(null);return X.useEffect(()=>{if(!n)return;const l=new dc;o.current=l;const c=new $u({source:l,zIndex:85,properties:{name:"grid-overlay-layer"}});return a.current=c,n.addLayer(c),()=>{a.current&&n&&n.removeLayer(a.current)}},[n]),X.useEffect(()=>{if(!o.current||!a.current)return;if(o.current.clear(),!e||!t){a.current.setVisible(!1);return}const l=MTe(t,r,i,s);o.current.addFeatures(l),a.current.setVisible(!0)},[e,t,r,i,s]),null}function LTe(n){const e=[];let t=0;return n.points.forEach((r,i)=>{if(i>0){const o=n.points[i-1],l=6371e3,c=(r.coordinates[1]-o.coordinates[1])*Math.PI/180,h=(r.coordinates[0]-o.coordinates[0])*Math.PI/180,g=Math.sin(c/2)*Math.sin(c/2)+Math.cos(o.coordinates[1]*Math.PI/180)*Math.cos(r.coordinates[1]*Math.PI/180)*Math.sin(h/2)*Math.sin(h/2),m=2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g));t+=l*m}const s=5,a=Math.sin(t/50)*2+Math.sin(t/120)*1.5+Math.sin(t/30+r.coordinates[0]*1e3)*.5;e.push({distance:t,elevation:Math.max(0,s+a)})}),e}function OTe({route:n,onClose:e}){const t=X.useRef(null),[r,i]=X.useState([]),[s,a]=X.useState({min:0,max:0,gain:0,loss:0});X.useEffect(()=>{const l=LTe(n);if(i(l),l.length>0){const c=l.map(v=>v.elevation),h=Math.min(...c),g=Math.max(...c);let m=0,y=0;for(let v=1;v<l.length;v++){const _=l[v].elevation-l[v-1].elevation;_>0?m+=_:y+=Math.abs(_)}a({min:h,max:g,gain:m,loss:y})}},[n]),X.useEffect(()=>{const l=t.current;if(!l||r.length<2)return;const c=l.getContext("2d");if(!c)return;const h=l.width,g=l.height,m={top:20,right:20,bottom:30,left:40};c.fillStyle="#f9fafb",c.fillRect(0,0,h,g);const y=Math.max(...r.map(D=>D.distance)),v=Math.min(...r.map(D=>D.elevation))-1,_=Math.max(...r.map(D=>D.elevation))+1,E=D=>m.left+D/y*(h-m.left-m.right),T=D=>g-m.bottom-(D-v)/(_-v)*(g-m.top-m.bottom);c.strokeStyle="#e5e7eb",c.lineWidth=1;const b=5;for(let D=0;D<=b;D++){const W=v+(_-v)*(D/b),I=T(W);c.beginPath(),c.moveTo(m.left,I),c.lineTo(h-m.right,I),c.stroke(),c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="right",c.fillText(`${W.toFixed(1)}m`,m.left-5,I+3)}const R=5;for(let D=0;D<=R;D++){const W=y/R*D,I=E(W);c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="center",c.fillText(W<1e3?`${Math.round(W)}m`:`${(W/1e3).toFixed(1)}km`,I,g-10)}c.beginPath(),c.moveTo(E(r[0].distance),g-m.bottom),r.forEach(D=>{c.lineTo(E(D.distance),T(D.elevation))}),c.lineTo(E(r[r.length-1].distance),g-m.bottom),c.closePath();const N=c.createLinearGradient(0,m.top,0,g-m.bottom);N.addColorStop(0,"rgba(139, 92, 246, 0.3)"),N.addColorStop(1,"rgba(139, 92, 246, 0.05)"),c.fillStyle=N,c.fill(),c.strokeStyle="#8b5cf6",c.lineWidth=2,c.lineJoin="round",c.lineCap="round",c.beginPath(),r.forEach((D,W)=>{const I=E(D.distance),A=T(D.elevation);W===0?c.moveTo(I,A):c.lineTo(I,A)}),c.stroke()},[r]);const o=l=>l<1e3?`${Math.round(l)} m`:`${(l/1e3).toFixed(2)} km`;return f.jsxs(bt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed inset-4 z-[1700] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[70vh]",children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Z0,{size:20}),f.jsx("span",{className:"font-medium",children:"Hoogteprofiel"})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:f.jsx(ii,{size:18})})]}),f.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100",children:[f.jsx("h3",{className:"font-medium text-gray-800 truncate",children:n.name}),f.jsx("p",{className:"text-xs text-gray-500",children:o(n.totalDistance)})]}),f.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 border-b border-gray-100",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-blue-500 mb-1",children:f.jsx(tV,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Min"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.min.toFixed(1),"m"]})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-purple-500 mb-1",children:f.jsx(Z0,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Max"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.max.toFixed(1),"m"]})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-green-500 mb-1",children:f.jsx(gue,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Stijging"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.gain.toFixed(1),"m"]})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"flex items-center justify-center text-red-500 mb-1",children:f.jsx(due,{size:14})}),f.jsx("div",{className:"text-xs text-gray-500",children:"Daling"}),f.jsxs("div",{className:"text-sm font-medium",children:[s.loss.toFixed(1),"m"]})]})]}),f.jsx("div",{className:"flex-1 p-3",children:f.jsx("canvas",{ref:t,width:350,height:200,className:"w-full h-full"})}),f.jsx("div",{className:"px-4 py-2 bg-yellow-50 border-t border-yellow-100",children:f.jsxs("p",{className:"text-xs text-yellow-700",children:[f.jsx("strong",{children:"Let op:"})," Dit zijn gesimuleerde hoogtewaarden. Koppeling met AHN-data komt binnenkort."]})})]})}const DTe=n=>n<1e3?`${Math.round(n)} m`:`${(n/1e3).toFixed(2)} km`,FTe=n=>{const e=Math.floor(n/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60);return t>0?`${t}u ${r}m`:`${r} min`},Y5=n=>new Date(n).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});function jTe({route:n,onClose:e}){const{updateRouteNotes:t,addPhotoToRoute:r,removePhotoFromRoute:i}=Eo(),[s,a]=X.useState(n.notes||""),[o,l]=X.useState("info"),c=X.useRef(null),h=()=>{t(n.id,s)},g=async v=>{const _=v.target.files?.[0];if(!_)return;const E=URL.createObjectURL(_);r(n.id,{url:E,caption:_.name}),c.current&&(c.current.value="")},m=v=>{confirm("Foto verwijderen?")&&i(n.id,v)},y=Eo(v=>v.savedRoutes.find(_=>_.id===n.id))||n;return f.jsxs(bt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[1700] flex items-center justify-center p-4",children:[f.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),f.jsxs(bt.div,{initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},className:"relative bg-white rounded-xl shadow-2xl overflow-hidden w-full max-w-md max-h-[85vh] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("h3",{className:"font-medium truncate",children:y.name}),f.jsx("p",{className:"text-xs text-purple-200",children:Y5(y.createdAt)})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none ml-2",children:f.jsx(ii,{size:18})})]}),f.jsxs("div",{className:"flex border-b border-gray-200",children:[f.jsxs("button",{onClick:()=>l("info"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="info"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[f.jsx(Ua,{size:16,className:"inline mr-1"}),"Info"]}),f.jsxs("button",{onClick:()=>l("photos"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="photos"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[f.jsx(xE,{size:16,className:"inline mr-1"}),"Foto's (",y.photos?.length||0,")"]}),f.jsxs("button",{onClick:()=>l("notes"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="notes"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[f.jsx(bI,{size:16,className:"inline mr-1"}),"Notities"]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[o==="info"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-purple-600 mb-1",children:[f.jsx(Xp,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Afstand"})]}),f.jsx("p",{className:"text-lg font-semibold",children:DTe(y.totalDistance)})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[f.jsx(Cv,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Duur"})]}),f.jsx("p",{className:"text-lg font-semibold",children:FTe(y.totalDuration)})]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[f.jsx(Ua,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Punten"})]}),f.jsxs("p",{className:"text-lg font-semibold",children:[y.points.length," GPS punten"]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-orange-600 mb-1",children:[f.jsx(TI,{size:16}),f.jsx("span",{className:"text-xs text-gray-500",children:"Aangemaakt"})]}),f.jsx("p",{className:"text-sm",children:Y5(y.createdAt)})]})]}),o==="photos"&&f.jsxs("div",{className:"space-y-4",children:[f.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:g,className:"hidden"}),f.jsxs("button",{onClick:()=>c.current?.click(),className:"w-full py-8 border-2 border-dashed border-purple-300 rounded-lg text-purple-500 hover:bg-purple-50 transition-colors flex flex-col items-center gap-2",children:[f.jsx($a,{size:24}),f.jsx("span",{className:"text-sm",children:"Foto toevoegen"})]}),y.photos&&y.photos.length>0?f.jsx("div",{className:"grid grid-cols-2 gap-2",children:y.photos.map(v=>f.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100",children:[f.jsx("img",{src:v.url,alt:v.caption||"Route foto",className:"w-full h-full object-cover"}),f.jsx("button",{onClick:()=>m(v.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors border-0 outline-none",children:f.jsx(yc,{size:12})}),v.caption&&f.jsx("div",{className:"absolute bottom-0 left-0 right-0 px-2 py-1 bg-black/50 text-white text-xs truncate",children:v.caption})]},v.id))}):f.jsx("p",{className:"text-center text-gray-400 text-sm py-4",children:"Nog geen foto's toegevoegd"})]}),o==="notes"&&f.jsxs("div",{className:"space-y-4",children:[f.jsx("textarea",{value:s,onChange:v=>a(v.target.value),placeholder:"Voeg notities toe over deze route...",className:"w-full h-48 p-3 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"}),f.jsx("button",{onClick:h,className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors border-0 outline-none",children:"Notities opslaan"})]})]})]})]})}function VTe({route:n,size:e=80}){const t=X.useRef(null);return X.useEffect(()=>{const r=t.current;if(!r||n.points.length<2)return;const i=r.getContext("2d");if(!i)return;i.fillStyle="#f3f4f6",i.fillRect(0,0,e,e);const s=n.points.map(N=>N.coordinates[0]),a=n.points.map(N=>N.coordinates[1]),o=Math.min(...s),l=Math.max(...s),c=Math.min(...a),h=Math.max(...a),g=8,m=e-g*2,y=e-g*2,v=N=>l===o?e/2:g+(N-o)/(l-o)*m,_=N=>h===c?e/2:g+y-(N-c)/(h-c)*y;i.strokeStyle="#a855f7",i.lineWidth=2,i.lineCap="round",i.lineJoin="round",i.beginPath(),n.points.forEach((N,D)=>{const W=v(N.coordinates[0]),I=_(N.coordinates[1]);D===0?i.moveTo(W,I):i.lineTo(W,I)}),i.stroke();const E=v(n.points[0].coordinates[0]),T=_(n.points[0].coordinates[1]);i.fillStyle="#22c55e",i.beginPath(),i.arc(E,T,4,0,Math.PI*2),i.fill();const b=v(n.points[n.points.length-1].coordinates[0]),R=_(n.points[n.points.length-1].coordinates[1]);i.fillStyle="#ef4444",i.beginPath(),i.arc(b,R,4,0,Math.PI*2),i.fill()},[n,e]),n.points.length<2?f.jsx("div",{className:"bg-gray-100 rounded flex items-center justify-center text-gray-400",style:{width:e,height:e},children:f.jsx(Ua,{size:20})}):f.jsx("canvas",{ref:t,width:e,height:e,className:"rounded"})}const GT=n=>n<1e3?`${Math.round(n)} m`:`${(n/1e3).toFixed(2)} km`,zT=n=>{const e=Math.floor(n/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60);return t>0?`${t}u ${r}m`:`${r} min`},Z5=n=>new Date(n).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric"});function BTe({isOpen:n,onClose:e,onViewRoute:t}){const{savedRoutes:r,deleteRoute:i,renameRoute:s,clearAllRoutes:a,visibleRouteIds:o,toggleRouteVisibility:l,showAllRoutes:c,hideAllRoutes:h,heatmapEnabled:g,toggleHeatmap:m,gridEnabled:y,toggleGrid:v,centerGridOnCurrentLocation:_,gridSize:E,setGridSize:T,autoPauseEnabled:b,setAutoPauseEnabled:R,autoPauseSeconds:N,setAutoPauseSeconds:D,importRouteFromGPX:W}=Eo(),[I,A]=X.useState(null),[M,O]=X.useState(""),[L,z]=X.useState(!1),[j,Ee]=X.useState(!1),[Ce,Ge]=X.useState(null),[Le,ce]=X.useState(null),Me=X.useRef(null),Te=async de=>{const Pe=` ${de.name}

 Afstand: ${GT(de.totalDistance)}
 Duur: ${zT(de.totalDuration)}
 ${de.points.length} GPS punten
 ${Z5(de.createdAt)}

Opgenomen met DetectorApp NL`;if(navigator.share)try{await navigator.share({title:de.name,text:Pe});return}catch(Be){Be.name!=="AbortError"&&console.error("Share failed:",Be)}try{await navigator.clipboard.writeText(Pe),alert("Route info gekopieerd naar klembord!")}catch{prompt("Kopieer de route info:",Pe)}},ie=async de=>{const Pe=de.target.files?.[0];if(Pe){try{const Be=await Pe.text(),It=W(Be,Pe.name.replace(".gpx",""));It.success?alert(`Route gemporteerd: ${Pe.name}`):alert(`Import mislukt: ${It.error}`)}catch{alert("Fout bij lezen van bestand")}Me.current&&(Me.current.value="")}},V=de=>{A(de.id),O(de.name)},Z=de=>{M.trim()&&s(de,M.trim()),A(null),O("")},te=de=>{confirm(`Weet je zeker dat je "${de.name}" wilt verwijderen?`)&&i(de.id)},se=()=>{r.length!==0&&confirm(`Weet je zeker dat je alle ${r.length} routes wilt verwijderen? Dit kan niet ongedaan worden gemaakt.`)&&a()},he=de=>{l(de);const Pe=r.find(Be=>Be.id===de);Pe&&t&&t(Pe)},Ae=r.reduce((de,Pe)=>de+Pe.totalDistance,0),Fe=r.reduce((de,Pe)=>de+Pe.totalDuration,0);return f.jsxs(f.Fragment,{children:[f.jsx(Un,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),f.jsxs(bt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Ov,{size:20}),f.jsx("span",{className:"font-medium",children:"Mijn Routes"}),f.jsxs("span",{className:"text-purple-200 text-sm",children:["(",r.length,")"]})]}),f.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:f.jsx(ii,{size:18})})]}),r.length>0&&f.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100 flex items-center justify-between text-sm",children:[f.jsxs("div",{className:"flex gap-4",children:[f.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[f.jsx(Xp,{size:14}),f.jsxs("span",{children:["Totaal: ",GT(Ae)]})]}),f.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[f.jsx(Cv,{size:14}),f.jsx("span",{children:zT(Fe)})]})]}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx("button",{onClick:()=>Ee(!j),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${b?"bg-green-100 text-green-600":"text-purple-600 hover:bg-purple-100"}`,title:b?"Auto-pauze uit":"Auto-pauze aan",children:f.jsx(oue,{size:14})}),f.jsx("button",{onClick:()=>z(!L),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${y?"bg-blue-100 text-blue-600":"text-purple-600 hover:bg-purple-100"}`,title:y?"Grid verbergen":"Grid tonen",children:f.jsx(Q7,{size:14})}),f.jsx("button",{onClick:m,className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${g?"bg-orange-100 text-orange-600":"text-purple-600 hover:bg-purple-100"}`,title:g?"Heatmap verbergen":"Heatmap tonen",children:f.jsx(zle,{size:14})}),f.jsx("button",{onClick:c,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle tonen",children:f.jsx(Lv,{size:14})}),f.jsx("button",{onClick:h,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle verbergen",children:f.jsx(Nv,{size:14})})]})]}),f.jsx(Un,{children:L&&f.jsx(bt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:f.jsxs("div",{className:"px-4 py-3 bg-blue-50 space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Grid Assistent"}),f.jsx("button",{onClick:v,className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${y?"bg-blue-500 text-white":"bg-blue-200 text-blue-700"}`,children:y?"Aan":"Uit"})]}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsxs("button",{onClick:_,className:"flex-1 px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[f.jsx(Pv,{size:14}),"Centreer op mijn locatie"]})}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("label",{className:"text-xs text-blue-700",children:["Celgrootte: ",E,"m"]}),f.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:E,onChange:de=>T(Number(de.target.value)),className:"w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer"}),f.jsxs("div",{className:"flex justify-between text-xs text-blue-600",children:[f.jsx("span",{children:"5m"}),f.jsx("span",{children:"50m"})]})]}),f.jsx("p",{className:"text-xs text-blue-600",children:"Gebruik het grid om systematisch een veld af te zoeken. Elk vak heeft een label (A1, B2, etc.) voor referentie."})]})})}),f.jsx(Un,{children:j&&f.jsx(bt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:f.jsxs("div",{className:"px-4 py-3 bg-green-50 space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-sm font-medium text-green-800",children:"Auto-pauze"}),f.jsx("button",{onClick:()=>R(!b),className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${b?"bg-green-500 text-white":"bg-green-200 text-green-700"}`,children:b?"Aan":"Uit"})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("label",{className:"text-xs text-green-700",children:["Pauze na: ",N<60?`${N}s`:`${Math.floor(N/60)}m ${N%60}s`]}),f.jsx("input",{type:"range",min:"30",max:"300",step:"30",value:N,onChange:de=>D(Number(de.target.value)),className:"w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer"}),f.jsxs("div",{className:"flex justify-between text-xs text-green-600",children:[f.jsx("span",{children:"30s"}),f.jsx("span",{children:"5min"})]})]}),f.jsxs("p",{className:"text-xs text-green-600",children:["De opname pauzeert automatisch als je langer dan ",N<60?`${N} seconden`:`${Math.floor(N/60)} minuten`," stilstaat. Ideaal voor pauzes tijdens het detecteren."]})]})})}),f.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:r.length===0?f.jsxs("div",{className:"text-center py-12 text-gray-500",children:[f.jsx(Ov,{size:48,className:"mx-auto mb-3 text-gray-300"}),f.jsx("p",{className:"font-medium",children:"Nog geen routes"}),f.jsx("p",{className:"text-sm mt-1",children:"Start een opname om je eerste route vast te leggen"})]}):r.map(de=>f.jsxs(bt.div,{layout:!0,className:"bg-gray-50 rounded-lg p-3 flex gap-3",children:[f.jsx(VTe,{route:de,size:70}),f.jsxs("div",{className:"flex-1 min-w-0",children:[I===de.id?f.jsx("input",{type:"text",value:M,onChange:Pe=>O(Pe.target.value),onKeyDown:Pe=>{Pe.key==="Enter"&&Z(de.id),Pe.key==="Escape"&&A(null)},onBlur:()=>Z(de.id),className:"w-full px-2 py-1 text-sm bg-white border border-purple-300 rounded outline-none focus:ring-2 focus:ring-purple-400",autoFocus:!0}):f.jsx("h3",{className:"font-medium text-gray-800 truncate",children:de.name}),f.jsx("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(TI,{size:12}),Z5(de.createdAt)]})}),f.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-600",children:[f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(Xp,{size:12}),GT(de.totalDistance)]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(Cv,{size:12}),zT(de.totalDuration)]}),f.jsxs("span",{children:[de.points.length," punten"]})]})]}),f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("button",{onClick:()=>he(de.id),className:`p-1.5 rounded transition-colors border-0 outline-none ${o.has(de.id)?"bg-purple-100 text-purple-600":"text-gray-400 hover:text-purple-600 hover:bg-purple-50"}`,title:o.has(de.id)?"Verbergen op kaart":"Tonen op kaart",children:o.has(de.id)?f.jsx(Lv,{size:16}):f.jsx(Nv,{size:16})}),f.jsx("button",{onClick:()=>V(de),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:f.jsx(J0,{size:16})}),f.jsx("button",{onClick:()=>ce(de),className:"p-1.5 text-gray-400 hover:text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none",title:"Details & foto's",children:f.jsx(RI,{size:16})}),f.jsx("button",{onClick:()=>Ge(de),className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Hoogteprofiel",children:f.jsx(Z0,{size:16})}),f.jsx("button",{onClick:()=>Te(de),className:"p-1.5 text-gray-400 hover:text-pink-600 hover:bg-pink-50 rounded transition-colors border-0 outline-none",title:"Delen",children:f.jsx(Wce,{size:16})}),f.jsx("button",{onClick:()=>WG(de),className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteer als GPX",children:f.jsx(Mv,{size:16})}),f.jsx("button",{onClick:()=>te(de),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:f.jsx(yc,{size:16})})]})]},de.id))}),f.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",children:[f.jsx("input",{ref:Me,type:"file",accept:".gpx",onChange:ie,className:"hidden"}),f.jsxs("button",{onClick:()=>Me.current?.click(),className:"w-full px-3 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border-0 outline-none text-sm flex items-center justify-center gap-2",children:[f.jsx(Hy,{size:16}),"GPX bestand importeren"]}),r.length>0&&f.jsx("button",{onClick:se,className:"w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none text-sm",children:"Alle routes verwijderen"})]})]})]})}),f.jsx(Un,{children:Ce&&f.jsx(OTe,{route:Ce,onClose:()=>Ge(null)})}),f.jsx(Un,{children:Le&&f.jsx(jTe,{route:Le,onClose:()=>ce(null)})})]})}const J5={Munt:"#f59e0b",Aardewerk:"#a16207",Gesp:"#6b7280",Fibula:"#8b5cf6",Ring:"#ec4899",Speld:"#6366f1",Sieraad:"#f43f5e",Gereedschap:"#64748b",Wapen:"#ef4444",Anders:"#3b82f6"},GTe={Munt:"M",Aardewerk:"A",Gesp:"G",Fibula:"F",Ring:"R",Speld:"S",Sieraad:"Si",Gereedschap:"Gr",Wapen:"W",Anders:"?"};function zTe(){const n=pi(i=>i.map),e=ll(i=>i.vondsten),t=ur(i=>i.showLocalVondsten),r=X.useRef(null);return X.useEffect(()=>{if(!n)return;const i=new dc;return e.forEach(s=>{const a=new _r({geometry:new gi(kr([s.location.lng,s.location.lat])),vondst:s}),o=J5[s.objectType]||J5.Anders,l=GTe[s.objectType]||"?";a.setStyle((c,h)=>{let v=12;h>50?v=6:h>10?v=Math.max(6,12-(h-10)/10):h<2&&(v=14);const _=Math.max(8,Math.min(12,v-2));return new mn({image:new Us({radius:v,fill:new tr({color:o}),stroke:new qn({color:"#ffffff",width:v>8?2:1})}),text:v>=8?new yo({text:l,font:`bold ${_}px sans-serif`,fill:new tr({color:"#ffffff"}),offsetY:1}):void 0})}),i.addFeature(a)}),r.current?r.current.setSource(i):(r.current=new $u({source:i,zIndex:1e3,properties:{title:"Mijn Vondsten"}}),r.current.setVisible(t),n.addLayer(r.current)),()=>{r.current&&n&&(n.removeLayer(r.current),r.current=null)}},[n,e]),X.useEffect(()=>{r.current&&r.current.setVisible(t)},[t]),null}const UTe={Mineraal:"M",Fossiel:"F",Erfgoed:"E",Monument:"Mo",Overig:""};function $Te(n){const{type:e,coordinates:t}=n,r=s=>typeof s[0]=="number"?kr(s):s.map(r),i=r(t);switch(e){case"Point":return new gi(i);case"LineString":return new Ti(i);case"Polygon":return new Ga(i);case"MultiPoint":return new Id(i);case"MultiLineString":return new nc(i);case"MultiPolygon":return new ad(i);default:return new gi(kr(t))}}function WTe(){const n=pi(i=>i.map),e=us(i=>i.layers),t=ur(i=>i.showCustomPointLayers),r=X.useRef(new Map);return X.useEffect(()=>{if(!n)return;const i=new Set(e.map(s=>s.id));return r.current.forEach((s,a)=>{i.has(a)||(n.removeLayer(s),r.current.delete(a))}),e.forEach(s=>{const a=new dc;s.points.forEach(l=>{let c;const h=l.geometry&&l.geometry.type!=="Point";l.geometry?c=$Te(l.geometry):c=new gi(kr(l.coordinates));const g=new _r({geometry:c,layerType:"customPoint",customPoint:l,customLayerId:s.id,customLayerName:s.name,customLayerColor:s.color}),m=UTe[l.category]||l.category.charAt(0).toUpperCase();if(h){const y=l.geometry.type;g.setStyle(()=>y==="Polygon"||y==="MultiPolygon"?new mn({fill:new tr({color:s.color+"40"}),stroke:new qn({color:s.color,width:2})}):y==="LineString"||y==="MultiLineString"?new mn({stroke:new qn({color:s.color,width:3})}):new mn({image:new Us({radius:8,fill:new tr({color:s.color}),stroke:new qn({color:"#ffffff",width:2})})}))}else g.setStyle((y,v)=>{let b=12;v>50?b=6:v>10?b=Math.max(6,12-(v-10)/10):v<2&&(b=14);const R=Math.max(8,Math.min(12,b-2));return new mn({image:new Us({radius:b,fill:new tr({color:s.color}),stroke:new qn({color:"#ffffff",width:b>8?2:1})}),text:b>=8?new yo({text:m,font:`bold ${R}px sans-serif`,fill:new tr({color:"#ffffff"}),offsetY:1}):void 0})});a.addFeature(g)});const o=r.current.get(s.id);if(o)o.setSource(a),o.setVisible(t&&s.visible);else{const l=new $u({source:a,zIndex:950,properties:{title:s.name,customPointLayerId:s.id},visible:t&&s.visible});n.addLayer(l),r.current.set(s.id,l)}}),()=>{r.current.forEach(s=>{n&&n.removeLayer(s)}),r.current.clear()}},[n,e,t]),null}function HTe(){const{createLayerModalOpen:n,closeCreateLayerModal:e}=wr(),{addLayer:t}=us(),r=ur(),[i,s]=X.useState(""),[a,o]=X.useState([...nu]),[l,c]=X.useState(""),h=14*r.fontScale/100,g=()=>{const E=l.trim();E&&!a.includes(E)&&(o([...a,E]),c(""))},m=E=>{o(a.filter(T=>T!==E))},y=E=>{a.includes(E)?o(a.filter(T=>T!==E)):o([...a,E])},v=()=>{i.trim()&&(t(i.trim(),a),s(""),o([...nu]),c(""),e())},_=()=>{s(""),o([...nu]),c(""),e()};return f.jsx(Un,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:_}),f.jsxs(bt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(_o,{size:18}),f.jsx("span",{className:"font-medium",children:"Nieuwe laag"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:r.fontScale,onChange:E=>r.setFontScale(parseInt(E.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${r.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:_,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(ii,{size:18})})]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{fontSize:`${h}px`},children:[f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam van de laag"}),f.jsx("input",{type:"text",value:i,onChange:E=>s(E.target.value),placeholder:"bijv. Vakantie Frankrijk 2026",className:"w-full px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Categorien"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:nu.map(E=>f.jsx("button",{onClick:()=>y(E),className:`px-3 py-1 rounded-full transition-colors border-0 outline-none ${a.includes(E)?"bg-orange-500 text-white":"bg-white text-gray-600 hover:bg-blue-50"}`,style:{fontSize:"0.9em"},children:E},E))})]}),a.filter(E=>!nu.includes(E)).length>0&&f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Eigen categorien"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:a.filter(E=>!nu.includes(E)).map(E=>f.jsxs("div",{className:"flex items-center",children:[f.jsx("button",{onClick:()=>y(E),className:"px-3 py-1 rounded-l-full bg-orange-500 text-white hover:bg-orange-600 transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:E}),f.jsx("button",{onClick:()=>m(E),className:"px-2 py-1 rounded-r-full bg-orange-600 text-white hover:bg-orange-700 transition-colors border-0 outline-none",title:"Verwijder categorie",children:f.jsx(yc,{size:12})})]},E))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Eigen categorie toevoegen"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",value:l,onChange:E=>c(E.target.value),placeholder:"bijv. Grot, Bron, ...",className:"flex-1 px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},onKeyDown:E=>E.key==="Enter"&&g()}),f.jsx("button",{onClick:g,disabled:!l.trim(),className:"px-3 py-2 bg-white hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors border-0 outline-none text-gray-600",children:f.jsx($a,{size:20})})]})]})]}),f.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${h}px`},children:[f.jsx("button",{onClick:_,className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),f.jsx("button",{onClick:v,disabled:!i.trim(),className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Aanmaken"})]})]})]})})}const XG=200,KTe=.7;async function XTe(n,e=XG){return new Promise((t,r)=>{const i=new Image,s=document.createElement("canvas"),a=s.getContext("2d");i.onload=()=>{let o=i.width,l=i.height;o>l?o>e&&(l=Math.round(l*e/o),o=e):l>e&&(o=Math.round(o*e/l),l=e),s.width=o,s.height=l,a?.drawImage(i,0,0,o,l),s.toBlob(c=>{c?t(c):r(new Error("Failed to create blob from canvas"))},"image/jpeg",KTe)},i.onerror=()=>r(new Error("Failed to load image")),i.src=URL.createObjectURL(n)})}function qTe(n){return new Promise((e,t)=>{const r=new FileReader;r.onloadend=()=>{typeof r.result=="string"?e(r.result):t(new Error("Failed to convert blob to base64"))},r.onerror=()=>t(new Error("Failed to read blob")),r.readAsDataURL(n)})}async function YTe(n){const e=await XTe(n,XG),t=await qTe(e);return{thumbnailBlob:e,thumbnailBase64:t}}function ZTe(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const UT=5;function JTe({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:r}){const i=X.useRef(null),s=X.useRef(null),a=async l=>{const c=l.target.files;if(!c||c.length===0)return;const h=UT-n.length,g=Array.from(c).slice(0,h);for(const m of g)try{const{thumbnailBase64:y}=await YTe(m),v={id:ZTe(),thumbnailBase64:y,createdAt:new Date().toISOString(),pendingUpload:!0};e(v)}catch(y){console.error("Failed to process image:",y)}l.target.value=""},o=n.length<UT;return f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",UT,")"]}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(l=>f.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[f.jsx("img",{src:l.thumbnailUrl||l.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!r&&f.jsx("button",{type:"button",onClick:()=>t(l.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:f.jsx(ii,{size:12,className:"text-white"})}),l.pendingUpload&&f.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-orange-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Wacht..."})]},l.id)),o&&!r&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[f.jsx(xE,{size:20,className:"text-gray-400"}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),f.jsxs("button",{type:"button",onClick:()=>i.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[f.jsx(rce,{size:20,className:"text-gray-400"}),f.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),f.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:a,className:"hidden"}),f.jsx("input",{ref:i,type:"file",accept:"image/*",multiple:!0,onChange:a,className:"hidden"})]})}function QTe(){const{addPointModalOpen:n,addPointModalLayerId:e,addPointModalLocation:t,closeAddPointModal:r}=wr(),{addPoint:i,getLayer:s}=us(),a=ur(),[o,l]=X.useState(""),[c,h]=X.useState(""),[g,m]=X.useState(""),[y,v]=X.useState([]),_=e?s(e):null,E=14*a.fontScale/100,T=()=>{!o.trim()||!e||!t||(i(e,{name:o.trim(),category:"Overig",notes:c.trim(),url:g.trim()||void 0,coordinates:[t.lng,t.lat],photos:y.length>0?y:void 0}),l(""),h(""),m(""),v([]),r())},b=()=>{l(""),h(""),m(""),v([]),r()};return _?f.jsx(Un,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b}),f.jsxs(bt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Ua,{size:18}),f.jsx("span",{className:"font-medium",children:"Punt toevoegen"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:a.fontScale,onChange:R=>a.setFontScale(parseInt(R.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:b,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(ii,{size:18})})]})]}),f.jsx("div",{className:"px-4 py-1.5",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:_.color}}),f.jsx("span",{className:"text-sm text-gray-600",children:_.name})]})}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{fontSize:`${E}px`},children:[f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam *"}),f.jsx("input",{type:"text",value:o,onChange:R=>l(R.target.value),className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),f.jsx(JTe,{photos:y,onAddPhoto:R=>v([...y,R]),onRemovePhoto:R=>v(y.filter(N=>N.id!==R))}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Notities"}),f.jsx("textarea",{value:c,onChange:R=>h(R.target.value),placeholder:"Beschrijving, tips, opmerkingen...",rows:2,className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors resize-none",style:{fontSize:"1em"}})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Link"}),f.jsx("input",{type:"url",value:g,onChange:R=>m(R.target.value),placeholder:"https://...",className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"}})]})]}),f.jsxs("div",{className:"p-3 flex gap-3",style:{fontSize:`${E}px`},children:[f.jsx("button",{onClick:b,className:"flex-1 px-4 py-1.5 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),f.jsx("button",{onClick:T,disabled:!o.trim(),className:"flex-1 px-4 py-1.5 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Toevoegen"})]})]})]})}):null}function ebe(){const{layerManagerModalOpen:n,closeLayerManagerModal:e,openCreateLayerModal:t,openLayerDashboard:r}=wr(),{layers:i,removeLayer:s,toggleVisibility:a,toggleArchived:o,exportLayerAsGeoJSON:l,importLayerFromGeoJSON:c}=us(),h=ur(),g=14*h.fontScale/100,[m,y]=X.useState(null),[v,_]=X.useState(null),[E,T]=X.useState(null),[b,R]=X.useState(!1),N=i.filter(j=>!j.archived),D=i.filter(j=>j.archived),W=b?D:N,I=j=>{v===j?(s(j),_(null)):(_(j),setTimeout(()=>_(null),3e3))},A=j=>{l(j)},M=async j=>{const Ee=j.target.files?.[0];if(Ee){try{const Ce=await Ee.text(),Ge=c(Ce);Ge.success||(T(Ge.error||"Import mislukt"),setTimeout(()=>T(null),3e3))}catch{T("Kon bestand niet lezen"),setTimeout(()=>T(null),3e3)}j.target.value=""}},O=()=>{y(null),_(null),T(null),R(!1),e()},L=j=>{r(j)},z=()=>{O(),t()};return f.jsx(Un,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:O}),f.jsxs(bt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(_o,{size:18}),f.jsx("span",{className:"font-medium",children:"Mijn Lagen beheren"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:h.fontScale,onChange:j=>h.setFontScale(parseInt(j.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${h.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:O,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(ii,{size:18})})]})]}),f.jsxs("div",{className:"flex border-b border-gray-100",children:[f.jsxs("button",{onClick:()=>R(!1),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${b?"text-gray-500 hover:text-gray-700 hover:bg-gray-50":"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50"}`,children:["Actief (",N.length,")"]}),f.jsxs("button",{onClick:()=>R(!0),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none flex items-center justify-center gap-1 ${b?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[f.jsx(X7,{size:14}),"Archief (",D.length,")"]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${g}px`},children:[W.length===0?f.jsx("div",{className:"p-8 text-center text-gray-500",children:b?f.jsx("p",{style:{fontSize:"1em"},children:"Geen gearchiveerde lagen."}):f.jsxs(f.Fragment,{children:[f.jsx("p",{className:"mb-4",style:{fontSize:"1em"},children:"Je hebt nog geen eigen lagen."}),f.jsxs("button",{onClick:z,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:[f.jsx($a,{size:16,className:"inline mr-2"}),"Nieuwe laag aanmaken"]})]})}):f.jsx("div",{className:"divide-y divide-gray-100",children:W.map(j=>f.jsx(nbe,{layer:j,isExpanded:m===j.id,onToggleExpand:()=>y(m===j.id?null:j.id),onToggleVisibility:()=>a(j.id),onToggleArchived:()=>o(j.id),onOpenDashboard:()=>L(j.id),onExport:()=>A(j.id),onDelete:()=>I(j.id),confirmDelete:v===j.id,onRename:Ee=>us.getState().updateLayer(j.id,{name:Ee}),onChangeColor:Ee=>us.getState().updateLayer(j.id,{color:Ee})},j.id))}),E&&f.jsx("div",{className:"mx-4 my-2 p-3 bg-red-50 text-red-700 text-sm rounded-lg",children:E})]}),f.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${g}px`},children:[f.jsxs("label",{className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors cursor-pointer flex items-center justify-center gap-2 border-0 outline-none text-gray-600",children:[f.jsx(Hy,{size:16}),f.jsx("span",{style:{fontSize:"1em"},children:"Importeren"}),f.jsx("input",{type:"file",accept:".geojson,.json",onChange:M,className:"hidden"})]}),f.jsxs("button",{onClick:z,className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",style:{fontSize:"1em"},children:[f.jsx($a,{size:16}),f.jsx("span",{children:"Nieuwe laag"})]})]})]})]})})}const tbe=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"];function nbe({layer:n,isExpanded:e,onToggleExpand:t,onToggleVisibility:r,onToggleArchived:i,onOpenDashboard:s,onExport:a,onDelete:o,confirmDelete:l,onRename:c,onChangeColor:h}){const[g,m]=X.useState(!1),[y,v]=X.useState(n.name),[_,E]=X.useState(!1),T=X.useRef(null);X.useEffect(()=>{g&&T.current&&(T.current.focus(),T.current.select())},[g]);const b=()=>{v(n.name),m(!0)},R=()=>{const A=y.trim();A&&A!==n.name&&c(A),m(!1)},N=()=>{v(n.name),m(!1)},D=A=>{A.key==="Enter"?R():A.key==="Escape"&&N()},W=n.points.filter(A=>A.status==="completed").length,I=n.points.length;return f.jsxs("div",{className:"bg-white",children:[f.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[f.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors border-0 outline-none bg-transparent",children:e?f.jsx(_E,{size:16}):f.jsx(Wy,{size:16})}),f.jsxs("div",{className:"relative",children:[f.jsx("button",{onClick:()=>E(!_),className:"w-5 h-5 rounded-full flex-shrink-0 border-2 border-white shadow-sm hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),_&&f.jsx("div",{className:"absolute top-7 left-0 z-50 bg-white rounded-lg shadow-lg p-2 flex flex-wrap gap-1 w-24",children:tbe.map(A=>f.jsx("button",{onClick:()=>{h(A),E(!1)},className:`w-5 h-5 rounded-full border-2 hover:scale-110 transition-transform ${A===n.color?"border-gray-800":"border-white"}`,style:{backgroundColor:A}},A))})]}),g?f.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[f.jsx("input",{ref:T,type:"text",value:y,onChange:A=>v(A.target.value),onKeyDown:D,onBlur:R,className:"flex-1 px-2 py-1 text-gray-800 font-medium bg-orange-50 rounded outline-none focus:ring-2 focus:ring-orange-400"}),f.jsx("button",{onClick:R,className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Opslaan",children:f.jsx(lc,{size:16})})]}):f.jsxs("button",{onClick:s,className:"flex-1 min-w-0 text-left border-0 outline-none bg-transparent hover:bg-orange-50 rounded px-2 py-1 -ml-2 transition-colors",title:"Bekijk dashboard",children:[f.jsx("div",{className:"font-medium text-gray-800 truncate hover:text-orange-600",children:n.name}),f.jsx("div",{className:"text-xs text-gray-500",children:I>0?f.jsxs("span",{className:W===I?"text-green-600":"",children:[W,"/",I," voltooid"]}):"Geen punten"})]}),!g&&f.jsx("button",{onClick:b,className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam bewerken",children:f.jsx(J0,{size:16})}),f.jsx("button",{onClick:s,className:"p-2 text-orange-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Open dashboard",children:f.jsx(eV,{size:18})}),!n.archived&&f.jsx("button",{onClick:r,className:`p-2 rounded transition-colors border-0 outline-none ${n.visible?"text-blue-500 hover:bg-blue-50":"text-gray-400 hover:bg-gray-100"}`,title:n.visible?"Verbergen":"Tonen",children:n.visible?f.jsx(Lv,{size:18}):f.jsx(Nv,{size:18})}),f.jsx("button",{onClick:i,className:`p-2 rounded transition-colors border-0 outline-none ${n.archived?"text-green-500 hover:text-green-600 hover:bg-green-50":"text-gray-400 hover:text-amber-600 hover:bg-amber-50"}`,title:n.archived?"Herstellen":"Archiveren",children:n.archived?f.jsx(lle,{size:18}):f.jsx(X7,{size:18})}),f.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteren als GeoJSON",children:f.jsx(Mv,{size:18})}),f.jsx("button",{onClick:o,className:`p-2 rounded transition-colors border-0 outline-none ${l?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:l?"Klik nogmaals om te verwijderen":"Verwijderen",children:f.jsx(yc,{size:18})})]}),f.jsx(Un,{children:e&&f.jsx(bt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:f.jsxs("div",{className:"px-4 pb-3 pl-12 space-y-2",children:[n.categories.length>0&&f.jsx("div",{className:"flex flex-wrap gap-1",children:n.categories.map(A=>f.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:A},A))}),n.points.length>0&&f.jsxs("div",{className:"text-xs text-gray-500 space-y-1 max-h-32 overflow-y-auto",children:[n.points.slice(0,5).map(A=>f.jsx("div",{className:"flex items-center gap-2",children:f.jsx("span",{className:`font-medium ${A.status==="completed"?"text-green-600 line-through":A.status==="skipped"?"text-gray-400 line-through":"text-gray-700"}`,children:A.name})},A.id)),n.points.length>5&&f.jsxs("div",{className:"text-gray-400",children:["...en ",n.points.length-5," meer"]})]}),f.jsxs("div",{className:"text-xs text-gray-400",children:["Aangemaakt: ",new Date(n.createdAt).toLocaleDateString("nl-NL")]})]})})})]})}function rbe(){const{layerDashboardOpen:n,layerDashboardLayerId:e,closeLayerDashboard:t}=wr(),{getLayer:r,setPointStatus:i,updatePoint:s,removePoint:a}=us(),o=ur(),[l,c]=X.useState("all"),[h,g]=X.useState(null),[m,y]=X.useState(""),[v,_]=X.useState(null),E=e?r(e):null,T=14*o.fontScale/100;if(!E)return null;const b=E.points.filter(L=>l==="all"?!0:L.status===l),R=E.points.length,N=E.points.filter(L=>L.status==="completed").length,D=E.points.filter(L=>L.status==="todo").length,W=E.points.filter(L=>L.status==="skipped").length,I=(L,z)=>{i(E.id,L,z)},A=L=>{s(E.id,L,{notes:m}),g(null),y("")},M=L=>{v===L?(a(E.id,L),_(null)):(_(L),setTimeout(()=>_(null),3e3))},O=()=>{g(null),_(null),t()};return f.jsx(Un,{children:n&&f.jsxs(f.Fragment,{children:[f.jsx(bt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:O}),f.jsxs(bt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/50",style:{backgroundColor:E.color}}),f.jsx("span",{className:"font-medium truncate",children:E.name})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),f.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:o.fontScale,onChange:L=>o.setFontScale(parseInt(L.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o.fontScale}%`}),f.jsx("span",{className:"text-xs opacity-70",children:"T"}),f.jsx("button",{onClick:O,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:f.jsx(ii,{size:18})})]})]}),f.jsxs("div",{className:"px-4 py-2 bg-orange-50 flex items-center justify-between text-sm",children:[f.jsxs("span",{className:"text-orange-800 font-medium",children:[N,"/",R," voltooid"]}),f.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[f.jsxs("span",{className:"text-orange-600",children:[D," te doen"]}),W>0&&f.jsxs("span",{className:"text-gray-500",children:[W," overgeslagen"]})]})]}),f.jsx("div",{className:"flex border-b border-gray-100",children:["all","todo","completed","skipped"].map(L=>f.jsxs("button",{onClick:()=>c(L),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${l===L?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[L==="all"&&"Alles",L==="todo"&&"Te doen",L==="completed"&&"Voltooid",L==="skipped"&&"Overgeslagen"]},L))}),f.jsx("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${T}px`},children:b.length===0?f.jsx("div",{className:"p-8 text-center text-gray-500",children:f.jsx("p",{children:"Geen punten gevonden"})}):f.jsx("div",{className:"divide-y divide-gray-100",children:b.map(L=>f.jsx("div",{className:"p-3",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsxs("div",{className:"flex flex-col gap-1 pt-0.5",children:[f.jsx("button",{onClick:()=>I(L.id,L.status==="completed"?"todo":"completed"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${L.status==="completed"?"bg-green-100 hover:bg-green-200":"bg-gray-100 hover:bg-green-100"}`,title:L.status==="completed"?"Markeer als te doen":"Markeer als voltooid",children:f.jsx(lc,{size:14,className:L.status==="completed"?"text-green-600":"text-gray-400"})}),f.jsx("button",{onClick:()=>I(L.id,L.status==="skipped"?"todo":"skipped"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${L.status==="skipped"?"bg-gray-200 hover:bg-gray-300":"bg-gray-100 hover:bg-gray-200"}`,title:L.status==="skipped"?"Markeer als te doen":"Overslaan",children:f.jsx(hle,{size:14,className:L.status==="skipped"?"text-gray-600":"text-gray-400"})})]}),L.photos&&L.photos.length>0&&f.jsxs("div",{className:"relative flex-shrink-0",children:[f.jsx("img",{src:L.photos[0].thumbnailUrl||L.photos[0].thumbnailBase64,alt:"Foto",className:"w-12 h-12 object-cover rounded border border-gray-200"}),L.photos.length>1&&f.jsxs("span",{className:"absolute -bottom-1 -right-1 bg-orange-500 text-white text-[9px] px-1 rounded-full",children:["+",L.photos.length-1]})]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:`font-medium truncate ${L.status==="completed"?"text-green-700 line-through":L.status==="skipped"?"text-gray-400 line-through":"text-gray-800"}`,children:L.name}),L.sourceLayer&&f.jsxs("span",{className:"text-xs text-gray-400 truncate",children:["via ",L.sourceLayer]})]}),h===L.id?f.jsxs("div",{className:"mt-2",children:[f.jsx("textarea",{value:m,onChange:z=>y(z.target.value),placeholder:"Notities...",rows:2,className:"w-full px-2 py-1 bg-white rounded border-0 outline-none hover:bg-blue-50 transition-colors resize-none text-sm",autoFocus:!0}),f.jsxs("div",{className:"flex gap-2 mt-1",children:[f.jsx("button",{onClick:()=>A(L.id),className:"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 border-0 outline-none",children:"Opslaan"}),f.jsx("button",{onClick:()=>{g(null),y("")},className:"px-2 py-1 text-xs bg-white text-gray-600 rounded hover:bg-blue-50 border-0 outline-none",children:"Annuleren"})]})]}):L.notes?f.jsx("p",{className:"text-sm text-gray-600 mt-1",children:L.notes}):null,L.url&&f.jsxs("a",{href:L.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-500 hover:text-blue-700 mt-1",children:[f.jsx(Au,{size:12}),"Link"]})]}),f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("button",{onClick:()=>{g(L.id),y(L.notes)},className:"w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded border-0 outline-none",title:"Notities bewerken",children:f.jsx(bce,{size:14})}),f.jsx("button",{onClick:()=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${L.coordinates[1]},${L.coordinates[0]}`,"_blank")},className:"w-6 h-6 flex items-center justify-center text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded border-0 outline-none",title:"Navigeer naar",children:f.jsx(Ua,{size:14})}),f.jsx("button",{onClick:()=>M(L.id),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none ${v===L.id?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:v===L.id?"Klik nogmaals":"Verwijderen",children:f.jsx(yc,{size:14})})]})]})},L.id))})})]})]})})}class Q5{buffer=[];size;weights;constructor(e=8){this.size=e,this.weights=Array.from({length:e},(r,i)=>Math.pow(2,i));const t=this.weights.reduce((r,i)=>r+i,0);this.weights=this.weights.map(r=>r/t)}add(e){if(this.buffer.length>0){const t=this.buffer[this.buffer.length-1];let r=e-t;r>180&&(e-=360),r<-180&&(e+=360)}this.buffer.push(e),this.buffer.length>this.size&&this.buffer.shift()}getSmoothed(){if(this.buffer.length===0)return null;if(this.buffer.length===1)return this.normalizeHeading(this.buffer[0]);let e=0,t=0;const r=this.size-this.buffer.length;for(let i=0;i<this.buffer.length;i++){const s=this.weights[r+i];e+=this.buffer[i]*s,t+=s}return this.normalizeHeading(e/t)}normalizeHeading(e){return(e%360+360)%360}clear(){this.buffer=[]}}function ibe(){const n=xs(c=>c.tracking),e=xs(c=>c.headingSource);xs(c=>c.speed);const t=xs(c=>c.setSmoothedHeading),r=X.useRef(new Q5(6)),i=X.useRef(new Q5(10)),s=X.useRef(0),a=X.useRef(null),o=33,l=X.useCallback((c,h)=>{const g=performance.now();if(g-s.current<o)return;const m=h==="gps"?r.current:i.current;m.add(c);const y=m.getSmoothed();y!==null&&(s.current=g,t(y))},[t]);X.useEffect(()=>{if(!n)return;const c=g=>{g.coords.heading!==null&&g.coords.speed!==null&&g.coords.speed>.8&&g.coords.accuracy<20&&l(g.coords.heading,"gps")},h=navigator.geolocation.watchPosition(c,()=>{},{enableHighAccuracy:!0,maximumAge:500,timeout:1e4});return()=>navigator.geolocation.clearWatch(h)},[n,l]),X.useEffect(()=>{if(!n||e!=="compass")return;let c=0;const h=50,g=y=>{const v=performance.now();if(!(v-c<h)&&(c=v,y.alpha!==null)){const _=(360-y.alpha)%360;l(_,"compass")}},m=y=>{const v=performance.now();v-c<h||(c=v,y.webkitCompassHeading!==void 0&&l(y.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",g),window.addEventListener("deviceorientation",m),()=>{window.removeEventListener("deviceorientationabsolute",g),window.removeEventListener("deviceorientation",m)}},[n,e,l]),X.useEffect(()=>{n||(r.current.clear(),i.current.clear())},[n]),X.useEffect(()=>()=>{a.current&&cancelAnimationFrame(a.current)},[])}function sbe(){const n=pi(i=>i.map),e=bi(i=>i.setLayerOpacity),t=bi(i=>i.visible),r=X.useRef(null);X.useEffect(()=>{if(!n)return;const i=()=>{const s=n.getView().getZoom();if(!s||r.current!==null&&Math.abs(s-r.current)<.5)return;r.current=s;const a=t["AHN 0.5m"],o=t["AHN4 Multi-Hillshade NL"];!a&&!o||(a&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),o&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return n.on("moveend",i),i(),()=>{n.un("moveend",i)}},[n,t,e])}const eD=2e3;function abe(){const n=hE(m=>m.user),{layers:e,clearAll:t}=us(),{vondsten:r,clearAll:i}=ll(),s=X.useRef(null),a=X.useRef(!0),o=X.useRef(""),l=X.useRef(""),c=X.useCallback(async m=>{if(n)try{const y=y0(gu,"users",n.uid);await i3(y,{layers:m,layersUpdatedAt:s3()},{merge:!0}),console.log(" Lagen gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren lagen:",y)}},[n]),h=X.useCallback(async m=>{if(n)try{const y=y0(gu,"users",n.uid);await i3(y,{vondsten:m,vondstenUpdatedAt:s3()},{merge:!0}),console.log(" Vondsten gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren vondsten:",y)}},[n]),g=X.useCallback(async()=>{if(n)try{const m=y0(gu,"users",n.uid),y=await Bne(m);if(y.exists()){const v=y.data();if(v.layers&&Array.isArray(v.layers)){const _=v.layers,E=us.getState().layers,T=[..._],b=new Set(_.map(R=>R.id));E.forEach(R=>{b.has(R.id)||T.push(R)}),us.setState({layers:T}),o.current=JSON.stringify(T),console.log(` ${_.length} lagen geladen uit cloud`)}if(v.vondsten&&Array.isArray(v.vondsten)){const _=v.vondsten,E=ll.getState().vondsten,T=[..._],b=new Set(_.map(R=>R.id));E.forEach(R=>{b.has(R.id)||T.push(R)}),ll.setState({vondsten:T}),l.current=JSON.stringify(T),console.log(` ${_.length} vondsten geladen uit cloud`)}}else console.log(" Geen cloud data gevonden, lokale data wordt gesynchroniseerd..."),await c(e),await h(r);a.current=!1}catch(m){console.error(" Fout bij laden uit cloud:",m),a.current=!1}},[n,e,r,c,h]);return X.useEffect(()=>{n?(a.current=!0,g()):(a.current=!0,o.current="",l.current="")},[n?.uid]),X.useEffect(()=>{if(!n||a.current)return;const m=JSON.stringify(e);if(m!==o.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{o.current=m,c(e)},eD),()=>{s.current&&clearTimeout(s.current)}},[n,e,c]),X.useEffect(()=>{if(!n||a.current)return;const m=JSON.stringify(r);if(m!==l.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{l.current=m,h(r)},eD),()=>{s.current&&clearTimeout(s.current)}},[n,r,h]),{isLoggedIn:!!n,syncLayersToCloud:c,syncVondstenToCloud:h}}function obe(){ibe(),sbe(),abe();const e=14*ur(o=>o.fontScale)/100,t=wr(o=>o.vondstFormOpen),r=wr(o=>o.vondstFormLocation),i=wr(o=>o.closeVondstForm),s=wr(o=>o.routeDashboardOpen),a=wr(o=>o.toggleRouteDashboard);return f.jsx(XSe,{children:f.jsxs("div",{style:{fontSize:`${e}px`},children:[f.jsx(Ire,{}),f.jsx(Rue,{}),f.jsx(zTe,{}),f.jsx(eTe,{}),f.jsx(WTe,{}),f.jsx(ITe,{}),f.jsx(CTe,{}),f.jsx(PTe,{}),f.jsx(NTe,{}),f.jsx(PSe,{}),f.jsx(NSe,{}),f.jsx(WSe,{}),f.jsx(Tue,{}),f.jsx(RTe,{}),f.jsx(ATe,{}),f.jsx(HSe,{}),f.jsx(kue,{}),f.jsx(Nue,{}),f.jsx($Se,{}),f.jsx(yTe,{}),f.jsx(BSe,{}),f.jsx(_Te,{}),f.jsx(GSe,{}),f.jsx(fTe,{}),f.jsx(HTe,{}),f.jsx(QTe,{}),f.jsx(ebe,{}),f.jsx(rbe,{}),f.jsx(BTe,{isOpen:s,onClose:a}),f.jsx(Un,{children:t&&f.jsx(KG,{onClose:i,initialLocation:r||void 0})})]})})}console.log(`%c DetectorApp v${cw}`,"background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");uU.createRoot(document.getElementById("root")).render(f.jsx(obe,{}));export{Us as C,_r as F,UI as G,BK as I,Ti as L,gi as P,mn as S,Sh as T,dc as V,wX as a,fX as b,$u as c,qn as d,xy as e,tr as f,yo as g,kr as h,Sn as p,lB as r};
//# sourceMappingURL=index-CvoBsdhm.js.map
